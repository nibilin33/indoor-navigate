!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.navigation=e():t.navigation=e()}(this,function(){return n=[function(t,e,n){t.exports=n(151)},function(t,e){function n(t){return t&&t.__esModule?t:{default:t}}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var r=n(0);function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r(t,i.key,i)}}function o(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}t.exports=o,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t=t.exports={version:"2.6.12"},"number"==typeof __e&&(__e=t)},function(t,e,n){var i=n(83)("wks"),r=n(47),o=n(8).Symbol,s="function"==typeof o,t=t.exports=function(t){return i[t]||(i[t]=s&&o[t]||(s?o:r)("Symbol."+t))};t.store=i},function(t,e,n){var _=n(9),v=n(4),y=n(67),g=n(34),I=n(28),T="prototype",x=function(t,e,n){var i,r,o,s=t&x.F,a=t&x.G,u=t&x.S,l=t&x.P,d=t&x.B,h=t&x.W,f=a?v:v[e]||(v[e]={}),c=f[T],p=a?_:u?_[e]:(_[e]||{})[T];for(i in a&&(n=e),n)r=!s&&p&&void 0!==p[i],r&&I(f,i)||(o=(r?p:n)[i],f[i]=a&&"function"!=typeof p[i]?n[i]:d&&r?y(o,_):h&&p[i]==o?function(i){var t=function(t,e,n){if(this instanceof i){switch(arguments.length){case 0:return new i;case 1:return new i(t);case 2:return new i(t,e)}return new i(t,e,n)}return i.apply(this,arguments)};return t[T]=i[T],t}(o):l&&"function"==typeof o?y(Function.call,o):o,l&&((f.virtual||(f.virtual={}))[i]=o,t&x.R&&c&&!c[i]&&g(c,i,o)))};x.F=1,x.G=2,x.S=4,x.P=8,x.B=16,x.W=32,x.U=64,x.R=128,t.exports=x},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=t)},function(t,e){t=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=t)},function(t,e,n){t.exports=!n(7)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(73)("wks"),r=n(55),o=n(9).Symbol,s="function"==typeof o,t=t.exports=function(t){return i[t]||(i[t]=s&&o[t]||(s?o:r)("Symbol."+t))};t.store=i},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(16),n(26);var o=r(n(2)),s=r(n(3)),v=1e-5,c=1e-5,g=.001,a=.01,n=function(){function y(){(0,o.default)(this,y)}return(0,s.default)(y,null,[{key:"epsilon",value:function(){return g}},{key:"isZero",value:function(t){return t<v&&-v<t}},{key:"gtZero",value:function(t){return v<t}},{key:"ltZero",value:function(t){return t<-v}},{key:"pointDistanceToLine",value:function(t,e,n,i){var r=e.x,o=e.y,s=n.x,a=n.y,u=t.x,l=t.y,d=s-r,h=a-o,f=Math.sqrt(d*d+h*h),c=u-r,p=l-o,t=Math.sqrt(c*c+p*p),t=y.isZero(f)?(i.x=e.x,i.y=e.y,y.isZero(t)?0:t):(d/=f,h/=f,p=d*c+h*p,y.gtZero(p)?y.ltZero(p-f)?(d=r+p*d,h=o+p*h,u-=d,l-=h,l=Math.sqrt(u*u+l*l),i.x=d,i.y=h,l):(s=u-s,a=l-a,a=Math.sqrt(s*s+a*a),i.x=n.x,i.y=n.y,a):(i.x=e.x,i.y=e.y,t));return t}},{key:"distanceOfTwoPoints",value:function(t,e){return t&&e?Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)):Number.NaN}},{key:"isSamePoint",value:function(t,e){return Math.abs(t.x-e.x)<=c&&Math.abs(t.y-e.y)<=c}},{key:"isNearlySamePoint",value:function(t,e){return Math.abs(t.x-e.x)<=a&&Math.abs(t.y-e.y)<=a}},{key:"getPolygonInnerPoint",value:function(t){if(t&&0==t.length)return{x:0,y:0};var e=t.length;if(e<3)return t[0];var n=t[0],e=t[1],i={x:(n.x+e.x)/2,y:(n.y+e.y)/2},r=Math.atan2(e.y-n.y,e.x-n.x);r-=Math.PI/2;for(var o=3;.5<o;){var s={x:i.x+o*Math.cos(r),y:i.y+o*Math.sin(r)};if(y.isInPolygon(s,t))return s;o/=2}for(r+=Math.PI,o=3;.5<o;){var a={x:i.x+o*Math.cos(r),y:i.y+o*Math.sin(r)};if(y.isInPolygon(a,t))return a;o/=2}return{x:0,y:0}}},{key:"isInPolygon",value:function(t,e){for(var n=!1,i=e.length,r=0,o=i-1;r<i;o=r,++r){var s=e[r].x,a=e[r].y,u=e[o].x,l=e[o].y;if(s==t.x&&a==t.y||u==t.x&&l==t.y)return!0;if(a<t.y&&l>=t.y||a>=t.y&&l<t.y){if(a=s+(t.y-a)*(u-s)/(l-a),a==t.x)return!0;a>t.x&&(n=!n)}}return n}},{key:"isInCircle",value:function(t,e,n,i){if(t.x<i[0]&&t.x>i[1])return!1;if(t.y<i[2]&&t.y>i[3])return!1;var r=n*n,i=t.x,n=t.y,t=e.x,e=e.y,i=t-i,n=e-n,n=i*i+n*n;return n<r}},{key:"isRectCross",value:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y))}},{key:"pointIsInRect",value:function(t,e,n,i){return Math.abs(t.x-e.x)<n&&Math.abs(t.y-e.y)<i}},{key:"pointIsInRect1",value:function(t,e,n){var i=Math.min(e.x,n.x),r=Math.max(e.x,n.x),o=Math.min(e.y,n.y),n=Math.max(e.y,n.y);return!(t.x<i||t.x>r||t.y<o||t.y>n)}},{key:"cross",value:function(t,e,n){return(t.x-n.x)*(e.y-n.y)-(e.x-n.x)*(t.y-n.y)}},{key:"isLineSegmentCross",value:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y)||y.cross(n,e,t)*y.cross(e,i,t)<0||y.cross(t,i,n)*y.cross(i,e,n)<0)}},{key:"rayCrossSegment",value:function(t,e,n,i,r){var o=Math.min(t.x,n.x,i.x),s=Math.max(t.x,n.x,i.x),a=Math.min(t.y,n.y,i.y),u=Math.max(t.y,n.y,i.y),u=Math.sqrt((s-o)*(s-o)+(u-a)*(u-a)),a=e/180*Math.PI,e=u*Math.cos(a)+t.x,a=u*Math.sin(a)+t.y;return 1==this.calcCrossPoint(t,{x:e,y:a},n,i,r)}},{key:"calcCrossPoint",value:function(t,e,n,i,r){if(1!=y.isLineSegmentCross(t,e,n,i))return 0;var o=(i.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-i.y),s=(t.y-n.y)*(e.x-t.x)*(i.x-n.x)+n.x*(i.y-n.y)*(e.x-t.x)-t.x*(e.y-t.y)*(i.x-n.x);return r.x=s/o,o=(t.x-e.x)*(i.y-n.y)-(e.y-t.y)*(n.x-i.x),s=e.y*(t.x-e.x)*(i.y-n.y)+(i.x-e.x)*(i.y-n.y)*(t.y-e.y)-i.y*(n.x-i.x)*(e.y-t.y),r.y=s/o,1}},{key:"pointInPolygon2d",value:function(t,e,n){for(var i=!1,r=null,o=null,s=0;s<n;s++)r=t[s],o=t[(s+1)%n],(r.y<e.y&&o.y>=e.y||o.y<e.y&&r.y>=e.y)&&(r.x<=e.x||o.x<=e.x)&&r.x+(e.y-r.y)/(o.y-r.y)*(o.x-r.x)<e.x&&(i=!i);return i}},{key:"pointInPolygon2d1",value:function(t,e,n){for(var i=0,r=null,o=null,s=null,a=0;a<n;a++)if(r=t[a],o=t[(a+1)%n],(r.y<e.y&&o.y>=e.y||o.y<e.y&&r.y>=e.y)&&(r.x<=e.x||o.x<=e.x)){if(s=r.x+(e.y-r.y)/(o.y-r.y)*(o.x-r.x),Math.abs(s-e.x)<=g)return 2;s<e.x&&(i=!i)}return i}},{key:"pointInPolygonVector2d",value:function(t,e,n){for(var i=!1,r=null,o=null,s=0,a=n/2,u=0;u<a;u++)s=2*u,r={x:t[s],y:t[s+1]},o={x:t[(s+2)%n],y:t[(s+3)%n]},(r.y<e.y&&o.y>=e.y||o.y<e.y&&r.y>=e.y)&&(r.x<=e.x||o.x<=e.x)&&r.x+(e.y-r.y)/(o.y-r.y)*(o.x-r.x)<e.x&&(i=!i);return i}},{key:"pointToSegmentDistance",value:function(t,e,n){var i=t.x,r=t.y,o=e.x,s=e.y,a=n.x,t=n.y,e=(a-o)*(i-o)+(t-s)*(r-s);return e<=0?Math.sqrt((i-o)*(i-o)+(r-s)*(r-s)):(n=(a-o)*(a-o)+(t-s)*(t-s),n<=e?Math.sqrt((i-a)*(i-a)+(r-t)*(r-t)):(n=e/n,o+=(a-o)*n,n=s+(t-s)*n,Math.sqrt((i-o)*(i-o)+(n-r)*(n-r))))}},{key:"pointToPolygon2d",value:function(t,e,n){for(var i=null,r=null,o=Number.MAX_VALUE,s=0;s<n;s++){var i=t[s],r=t[(s+1)%n],a=y.pointToSegmentDistance(e,i,r);a<o&&(o=a)}return o}},{key:"lineInCircle2d",value:function(t,e,n,i,r){if(t.x<r[0]&&e.x<r[0])return!1;if(t.x>r[1]&&e.x>r[1])return!1;if(t.y<r[2]&&e.y<r[2])return!1;if(t.y>r[3]&&e.y>r[3])return!1;var o=i*i,s=t.x,a=t.y,u=e.x,l=e.y,d=n.x,h=n.y,f=u-s,r=l-a,i=f*f+r*r,t=d-s,e=h-a,n=t*t+e*e;return y.isZero(i)?!!y.isZero(n)||n<o:(i=Math.sqrt(i),f/=i,r/=i,e=f*t+r*e,y.gtZero(e)?y.ltZero(e-i)?(f=s+e*f,r=a+e*r,f=d-f,r=h-r,r=f*f+r*r,r<o):(u=d-u,l=h-l,l=u*u+l*l,l<o):n<o)}},{key:"lineInPolygon2d",value:function(t,e,n,i){if(t.x<i[0]&&e.x<i[0])return!1;if(t.x>i[1]&&e.x>i[1])return!1;if(t.y<i[2]&&e.y<i[2])return!1;if(t.y>i[3]&&e.y>i[3])return!1;var r=n.length;if(y.pointInPolygon2d(n,t,r))return!0;if(y.pointInPolygon2d(n,e,r))return!0;for(var o=0;o<r;o++){var s=(o+1)%r;if(y.isLineSegmentCross(t,e,n[o],n[s]))return!0}return!1}},{key:"calcLineCircleCrossPoints2d",value:function(t,e,n,i,r){if(t.x<r[0]&&e.x<r[0])return null;if(t.x>r[1]&&e.x>r[1])return null;if(t.y<r[2]&&e.y<r[2])return null;if(t.y>r[3]&&e.y>r[3])return null;var o={isContain:!1,crossPoints:[]},s=i*i,a=t.x,u=t.y,l=e.x,d=e.y,h=n.x,f=n.y,c=l-a,p=d-u,_=c*c+p*p,r=h-a,i=f-u,n=r*r+i*i,l=h-l,d=f-d,d=l*l+d*d;return y.isZero(_)?((y.isZero(n)||n<s)&&(o.isContain=!0,o.crossPoints=[t,e]),o):n<s&&d<s?(o.isContain=!0,o.crossPoints=[t,e],o):(t=Math.sqrt(_),e=c/t,_=p/t,c=r*e+i*_,p=c*c,i=r*r+i*i,s-i+p<0?null:(i=Math.sqrt(s-i+p),p=c-i,-v<+p&&p-t<v&&o.crossPoints.push({x:a+p*e,y:u+p*_}),p=c+i,-v<+p&&p-t<v&&o.crossPoints.push({x:a+p*e,y:u+p*_}),o))}},{key:"calcLinePolygonCrossPoints2d",value:function(t,e,n,i){if(t.x<i[0]&&e.x<i[0])return null;if(t.x>i[1]&&e.x>i[1])return null;if(t.y<i[2]&&e.y<i[2])return null;if(t.y>i[3]&&e.y>i[3])return null;var r={containType:0,crossPoints:[]},o=n.length;y.pointInPolygon2d(n,t,o)&&(r.containType|=1),y.pointInPolygon2d(n,e,o)&&(r.containType|=2);for(var s=[],a=0;a<o;a++){var u,l=(a+1)%o,d={};y.calcCrossPoint(t,e,n[a],n[l],d)&&(u=d.x-t.x,l=d.y-t.y,s.push({dis2:u*u+l*l,point:d}))}if(0==s.length)return null;s.sort(function(t,e){return e.dis2-t.dis2});for(var h=0;h<s.length;h++)r.crossPoints.push(s[h].point);return r}},{key:"calcCenterOfGravityPoint",value:function(t,e){for(var n=0,i=0,r=0,o=0;o<e;o++){var s=t[o],a=t[(o+1)%e],u=(s.x*a.y-s.y*a.x)/2;n+=u,i+=u*(s.x+a.x)/3,r+=u*(s.y+a.y)/3}return i/=n,r/=n,{x:i,y:r}}},{key:"calcPolygonArea2d",value:function(t){var e=t.length;if(e<3)return 0;for(var n=0,i=0;i<e;++i){var r=t[i],o=t[(i+1)%e];n+=r.x*o.y-r.y*o.x}return Math.abs(n/2)}},{key:"quickRayIntersect",value:function(t,e,n,i,r){var o=Math.min(n.x,i.x),s=Math.max(n.x,i.x),a=Math.min(n.y,i.y),u=Math.max(n.y,i.y),l=t.x,d=t.y,h=n.x,f=n.y,c=i.x,p=i.y;if(90==e){if(t.x<o||t.x>s)return!1;var _=(p-f)/(c-h),_=_*(l-h)+f;return r.y=_,r.x=l,!(_<d||!y.pointIsInRect1(r,n,i))}if(270==e)return!(t.x<o||t.x>s||(t=(p-f)/(c-h),t=t*(l-h)+f,r.y=t,r.x=l,d<t||!y.pointIsInRect1(r,n,i)));if(270!=e&&90!=e&&s-o<g&&(s=o,o=Math.tan(e/180*Math.PI),o=o*(s-l)+d,r.y=o,r.x=s,y.pointIsInRect1(r,n,i)))return s-=l,o-=d,s/=Math.sqrt(s*s+o*o),o=Math.cos(e/180*Math.PI),0<s*o;if(u-a<=1e-6){if(u=a,a=Math.tan(e/180*Math.PI),a=1/a*(u-d)+l,r.x=a,r.y=u,y.pointIsInRect1(r,n,i)){var a=a-l,v=u-d,a=a/Math.sqrt(a*a+v*v),v=Math.cos(e/180*Math.PI);return 0<a*v}return!1}return v=Math.tan(e/180*Math.PI),c=(p-f)/(c-h),c=(f-d-(c*h-v*l))/(v-c),v=d+v*(c-l),r.x=c,r.y=v,!!y.pointIsInRect1(r,n,i)&&(l=c-l,d=v-d,d=l/Math.sqrt(l*l+d*d),e=Math.cos(e/180*Math.PI),0<d*e)}},{key:"calcFootOfUpright",value:function(t,e,n,i){var r=Math.min(e.x,n.x),o=Math.max(e.x,n.x),s=Math.min(e.y,n.y),a=Math.max(e.y,n.y),u=t.x,l=t.y,d=e.x,h=e.y,f=n.x,t=n.y;return Math.abs(d-f)<c?(i.x=d,i.y=l,s<=l&&l<=a):Math.abs(h-t)<c?(i.x=u,i.y=h,r<=u&&u<=o):(o=(t-h)/(f-d),o=-1/o,f=(t-h)/(f-d),f=(h-l-(f*d-o*u))/(o-f),u=l+o*(f-u),i.x=f,i.y=u,!!y.pointIsInRect1(i,e,n))}},{key:"vectorCross",value:function(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}}},{key:"vectorDot",value:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}},{key:"vectorLength",value:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)}},{key:"vector2DDot",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"vector2DLength",value:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)}},{key:"calcRotateAngle",value:function(t,e){if(0==t.x&&0==t.y||0==e.x&&0==e.y)return 0;var n={x:t.x,y:t.y,z:0},i={x:e.x,y:e.y,z:0},n=y.vectorCross(n,i),i=y.vector2DDot(t,e),e=Math.acos(i/(y.vector2DLength(t)*y.vector2DLength(e)));return 0<n.z?e/Math.PI*180:360-e/Math.PI*180}},{key:"isPointOnSegment",value:function(t,e,n){return(t.x-e.x)*(n.y-e.y)==(n.x-e.x)*(t.y-e.y)&&Math.min(e.x,n.x)<=t.x&&t.x<=Math.max(e.x,n.x)&&Math.min(e.y,n.y)<=t.y&&t.y<=Math.max(e.y,n.y)}},{key:"segCrossPolygon",value:function(t,e,n,i){for(var r=0;r<n.length;r++){var o=n[r],s=n[(r+1)%n.length];if(1==this.calcCrossPoint(t,e,o,s,i))return!0}return!1}}]),y}(),n=n;e.default=n},function(t,e,n){var i=n(23),r=n(59);t.exports=n(10)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){t.exports=!n(20)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){t.exports=n(155)},function(t,e,n){"use strict";var i=n(8),r=n(30),o=n(36),s=n(190),l=n(61),a=n(7),u=n(81).f,d=n(80).f,h=n(23).f,f=n(193).trim,c="Number",p=i[c],_=p,v=p.prototype,y=o(n(85)(v))==c,g="trim"in String.prototype,I=function(t){var e=l(t,!1);if("string"==typeof e&&2<e.length){var n,i,e=g?e.trim():f(e,3),r=e.charCodeAt(0);if(43===r||45===r){if(t=e.charCodeAt(2),88===t||120===t)return NaN}else if(48===r){switch(e.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+e}for(var o,s=e.slice(2),a=0,u=s.length;a<u;a++)if(o=s.charCodeAt(a),o<48||i<o)return NaN;return parseInt(s,n)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){for(var T,p=function(t){var t=arguments.length<1?0:t,e=this;return e instanceof p&&(y?a(function(){v.valueOf.call(e)}):o(e)!=c)?s(new _(I(t)),e,p):I(t)},x=n(10)?u(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;x.length>N;N++)r(_,T=x[N])&&!r(p,T)&&h(p,T,d(_,T));p.prototype=v,v.constructor=p,n(25)(i,c,p)}},function(t,e,n){var i=n(38),r=Math.min;t.exports=function(t){return 0<t?r(i(t),9007199254740991):0}},function(t,e,n){var i=n(27),r=n(98),o=n(69),s=Object.defineProperty;e.f=n(14)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var i=n(21);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){var i=n(22),r=n(117),o=n(61),s=Object.defineProperty;e.f=n(10)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var p=n(8),_=n(62),v=n(13),y=n(25),g=n(58),I="prototype",T=function(t,e,n){var i,r,o,s=t&T.F,a=t&T.G,u=t&T.S,l=t&T.P,d=t&T.B,h=a?p:u?p[e]||(p[e]={}):(p[e]||{})[I],f=a?_:_[e]||(_[e]={}),c=f[I]||(f[I]={});for(i in a&&(n=e),n)o=!s&&h&&void 0!==h[i],r=(o?h:n)[i],o=d&&o?g(r,p):l&&"function"==typeof r?g(Function.call,r):r,h&&y(h,i,r,t&T.U),f[i]!=r&&v(f,i,o),l&&c[i]!=r&&(c[i]=r)};p.core=_,T.F=1,T.G=2,T.S=4,T.P=8,T.B=16,T.W=32,T.U=64,T.R=128,t.exports=T},function(t,e,n){var o=n(8),s=n(13),a=n(30),u=n(47)("src"),i=n(194),r="toString",l=(""+i).split(r);n(62).inspectSource=function(t){return i.call(t)},(t.exports=function(t,e,n,i){var r="function"==typeof n;r&&(a(n,"name")||s(n,"name",e)),t[e]!==n&&(r&&(a(n,u)||s(n,u,t[e]?""+t[e]:l.join(String(e)))),t===o?t[e]=n:i?t[e]?t[e]=n:s(t,e,n):(delete t[e],s(t,e,n)))})(Function.prototype,r,function(){return"function"==typeof this&&this[u]||i.call(this)})},function(t,e,n){"use strict";var i=n(24),r=n(79),o=n(39),s=n(7),a=[].sort,u=[1,2,3];i(i.P+i.F*(s(function(){u.sort(void 0)})||!s(function(){u.sort(null)})||!n(197)(a)),"Array",{sort:function(t){return void 0===t?a.call(o(this)):a.call(o(this),r(t))}})},function(t,e,n){var i=n(19);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(162),r=n(163),o=n(188),s=n(189);function a(t){return i(t)||r(t)||o(t)||s()}t.exports=a,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";var i=n(131),r=n(208),o=n(40),s=n(60);t.exports=n(209)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e,n){"use strict";var i=n(64),r={};r[n(5)("toStringTag")]="z",r+""!="[object z]"&&n(25)(Object.prototype,"toString",function(){return"[object "+i(this)+"]"},!0)},function(t,e,n){"use strict";n=n(0),n(e,"__esModule",{value:!0}),e.default=void 0,n={NaviNodeType_NULL:-1,NaviNodeType_COMMON:0,NaviNodeType_SIDE:1,NaviNodeType_FLOOR:2,NaviNodeType_EXTENT:3,NaviLiftType_NULL:0,NaviLiftType_Lift:1,NaviLiftType_Stair:2,NaviLiftType_Escalator:3,NaviLiftType_Accessible:4,NaviLiftEntry_BOTH:0,NaviLiftEntry_UP:1,NaviLiftEntry_DOWN:2,NaviLiftEntry_FORBID:3,NaviEntranceType_NULL:0,NaviEntranceType_EXIT:1,NaviEntranceType_ENTRANCE:2,NaviEntranceType_ACCESS:3,NaviRoadRank_MAIN:1,NaviRoadRank_MINOR:2,NaviRoadRank_NARROW:3,NaviRoadEntry_BOTH:0,NaviRoadEntry_FORWARD:1,NaviRoadEntry_BACK:2,NaviRoadEntry_FORBID:3,NaviRoadPass_NULL:-1,NaviRoadPass_NOT_THROUGH:0,NaviRoadPass_THROUGH:1,NaviZoneType_NULL:-1,NaviZoneType_PASS_UNRESTRAINT:0,NaviZoneType_PASS_THROUGH:1,NaviZoneType_PASS_NOT_THROUGH:2,NaviZoneType_NO_ENTRY:3,NaviZoneType_CORRIDOR:4,NaviModelPassType_PASS_THROUGH:0,NaviModelPassType_PASS_NOT_THROUGH:1,NaviModelPassType_NOT_PASS:2,NaviModelPassType_DECORATE:3,NaviRoadHinderType_HINDER_GENERAL:0,NaviRoadHinderType_HINDER_HIGH:1,NaviObstructType_MODEL:0,NaviObstructType_EXTENT:1},e.default=n},function(t,e,n){var i=n(18),r=n(43);t.exports=n(14)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(101),r=n(53);t.exports=function(t){return i(r(t))}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(0<t?i:n)(t)}},function(t,e,n){var i=n(37);t.exports=function(t){return Object(i(t))}},function(t,e){t.exports={}},function(t,e,n){"use strict";n=n(0),n(e,"__esModule",{value:!0}),e.default=void 0,n={MODULE_SHORTEST:1,MODULE_BEST:2},e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(15)),s=r(n(2)),a=r(n(3)),u=(r(n(135)),r(n(33))),n=function(){function t(){(0,s.default)(this,t),this.Id=0,this.point={},this._type=0,this.liftFloors=[],this.segLinks=[],this.liftFlag=0,this.relatedLiftNodes=[],this.treatHead=!1,this.treatTail=!1,this._dist=0,this._visited=!1,this._vPre=[]}return(0,a.default)(t,[{key:"nodeType",get:function(){return 3&this._type},set:function(t){-1!=t&&(this._type|=t)}},{key:"liftType",get:function(){return this._type>>2&7},set:function(t){this._type|=t<<2}},{key:"liftEntry",get:function(){return this._type>>5&3},set:function(t){this._type|=t<<5}},{key:"entranceType",get:function(){return this._type>>7&3},set:function(t){this._type|=t<<7}},{key:"tempType",get:function(){return _type>>9&3},set:function(t){this._type|=t<<9}},{key:"init",value:function(t){this.Id=t,this.point={x:0,y:0},this._type=0,this.liftFlag=0,this.treatHead=!1,this.treatTail=!1}},{key:"equals",value:function(t){return this.Id==t.Id}},{key:"setNode",value:function(t){this.Id=t.Id,this.point=(0,o.default)({},t.point),this._type=t._type,this.liftFloors=[];for(var e=0;e<t.liftFloors.length;e++)this.liftFloors[e]=t.liftFloors[e];this.segLinks=[];for(var n=0;n<t.segLinks.length;n++)this.segLinks[n]=t.segLinks[n];this.liftFlag=t.liftFlag,this.relatedLiftNodes=[];for(var i=0;i<t.relatedLiftNodes.length;i++)this.relatedLiftNodes[i]=t.relatedLiftNodes[i];this.treatHead=t.treatHead,this.treatTail=t.treatTail}},{key:"getLiftFloorsLength",value:function(){return this.liftFloors.length}},{key:"getSegLinksLength",value:function(){return this.segLinks.length}},{key:"contansFloor",value:function(t){if(this.liftType==u.default.NaviLiftType_Stair)return!0;for(var e=this.liftFloors.length-1;0<=e;e--)if(this.liftFloors[e]==t)return!0;return!1}}]),t}(),n=n;e.default=n},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(53);t.exports=function(t){return Object(i(t))}},function(t,e){t.exports={}},function(t,e,n){var i=n(38),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e,n){t.exports=n(218)},function(t,e,n){"use strict";n=n(0),n(e,"__esModule",{value:!0}),e.default=void 0,n={ROUTE_SUCCESS:1,ROUTE_FAILED_NO_FMDBDATA:2,ROUTE_FAILED_TOO_CLOSE:3,ROUTE_FAILED_NO_DATA_START:4,ROUTE_FAILED_NO_DATA_END:5,ROUTE_FAILED_NO_STAIR:6,ROUTE_FAILED_NOTSUPPORT:7,ROUTE_FAILED_CANNOT_CALCULATE:8,ROUTE_FAILED_CANNOT_ARRIVE:9,ROUTE_FAILED_WAYPOINT_CALCULATE_ERROR:10,ROUTE_FAILED_NO_START_ARRIVAL:11,ROUTE_FAILED_NO_END_ARRIVAL:12,ROUTE_FAILED_OUTLINE:13,ROUTE_FAILED_NO_DOOR_START:14,ROUTE_FAILED_NO_DOOR_END:15},e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(32),n(31),n(51),n(26);var o=r(n(2)),s=r(n(3)),n=function(){function t(){(0,o.default)(this,t),this.keys=[],this.data={}}return(0,s.default)(t,[{key:"clear",value:function(){this.keys=[],this.data={}}},{key:"put",value:function(t,e){null==this.data[t]&&this.keys.push(t),this.data[t]=e}},{key:"get",value:function(t){return this.data[t]}},{key:"has",value:function(t){for(var e=this.keys.length,n=0;n<e;n++){var i=this.keys[n];if(i==t)return!0}return!1}},{key:"remove",value:function(t){var e=this.keys.indexOf(t);-1!=e&&(this.keys.splice(e,1),this.data[t]=null)}},{key:"each",value:function(t){if("function"==typeof t)for(var e=this.keys.length,n=0;n<e;n++){var i=this.keys[n];t(i,this.data[i],n)}}},{key:"entrys",value:function(){for(var t=this.keys.length,e=new Array(t),n=0;n<t;n++)e[n]={key:this.keys[n],value:this.data[n]};return e}},{key:"isEmpty",value:function(){return 0==this.keys.length}},{key:"size",value:function(){return this.keys.length}},{key:"toString",value:function(){for(var t="{",e=0;e<this.keys.length;e++,t+=","){var n=this.keys[e];t+=n+"="+this.data[n]}return t+="}",t}},{key:"sort",value:function(){this.keys.sort(function(t,e){return t-e})}}]),t}(),n=n;e.default=n},function(t,e,n){for(var i=n(31),r=n(121),o=n(25),s=n(8),a=n(13),u=n(40),n=n(5),l=n("iterator"),d=n("toStringTag"),h=u.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},c=r(f),p=0;p<c.length;p++){var _,v=c[p],y=f[v],g=s[v],I=g&&g.prototype;if(I&&(I[l]||a(I,l,h),I[d]||a(I,d,v),u[v]=h,y))for(_ in i)I[_]||o(I,_,i[_],!0)}},function(t,e,n){var i=n(100),r=n(74);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports=!0},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,r){var i=r(27),o=r(108),s=r(74),a=r(72)("IE_PROTO"),u=function(){},l="prototype",d=function(){var t=r(99)("iframe"),e=s.length,n="<",i=">";for(t.style.display="none",r(168).appendChild(t),t.src="javascript:",t=t.contentWindow.document,t.open(),t.write(n+"script"+i+"document.F=Object"+n+"/script"+i),t.close(),d=t.F;e--;)delete d[l][s[e]];return d()};t.exports=Object.create||function(t,e){var n;return null!==t?(u[l]=i(t),n=new u,u[l]=null,n[a]=t):n=d(),void 0===e?n:o(n,e)}},function(t,e,n){var o=n(79);t.exports=function(i,r,t){if(o(i),void 0===r)return i;switch(t){case 1:return function(t){return i.call(r,t)};case 2:return function(t,e){return i.call(r,t,e)};case 3:return function(t,e,n){return i.call(r,t,e,n)}}return function(){return i.apply(r,arguments)}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(116),r=n(37);t.exports=function(t){return i(r(t))}},function(t,e,n){var r=n(21);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t=t.exports={version:"2.6.12"},"number"==typeof __e&&(__e=t)},function(t,e){t.exports=!1},function(t,e,n){var i=n(36),r=n(5)("toStringTag"),o="Arguments"==i(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(t=s(e=Object(t),r))?t:o?i(e):"Object"==(t=i(e))&&"function"==typeof e.callee?"Arguments":t}},function(t,e,n){"use strict";n=n(0),n(e,"__esModule",{value:!0}),e.default=void 0,n={PRIORITY_DEFAULT:1,PRIORITY_LIFTFIRST:2,PRIORITY_ESCALATORFIRST:3,PRIORITY_STAIRFIRST:4,PRIORITY_LIFTONLY:5,PRIORITY_ESCALATORONLY:6,PRIORITY_STAIRONLY:7,PRIORITY_ACCESSIBLEONLY:8,PRIORITY_LIFTFIRST1:9,PRIORITY_ESCALATORFIRST1:10,PRIORITY_STAIRFIRST1:11},e.default=n},function(t,e,n){"use strict";var i=n(24),r=n(129)(5),o="find",s=!0;o in[]&&Array(1)[o](function(){s=!1}),i(i.P+i.F*s,"Array",{find:function(t){return r(this,t,1<arguments.length?arguments[1]:void 0)}}),n(131)(o)},function(t,e,n){var o=n(68);t.exports=function(i,r,t){if(o(i),void 0===r)return i;switch(t){case 1:return function(t){return i.call(r,t)};case 2:return function(t,e){return i.call(r,t,e)};case 3:return function(t,e,n){return i.call(r,t,e,n)}}return function(){return i.apply(r,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(19);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(0<t?i:n)(t)}},function(t,e,n){var i=n(73)("keys"),r=n(55);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(4),r=n(9),o="__core-js_shared__",s=r[o]||(r[o]={});(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(54)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(18).f,r=n(28),o=n(11)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){e.f=n(11)},function(t,e,n){var i=n(9),r=n(4),o=n(54),s=n(77),a=n(18).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=!o&&i.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(192),r=n(59),o=n(60),s=n(61),a=n(30),u=n(117),l=Object.getOwnPropertyDescriptor;e.f=n(10)?l:function(t,e){if(t=o(t),e=s(e,!0),u)try{return l(t,e)}catch(t){}if(a(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){var i=n(119),r=n(84).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(83)("keys"),r=n(47);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(62),r=n(8),o="__core-js_shared__",s=r[o]||(r[o]={});(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(63)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,r){var i=r(22),o=r(196),s=r(84),a=r(82)("IE_PROTO"),u=function(){},l="prototype",d=function(){var t=r(118)("iframe"),e=s.length,n="<",i=">";for(t.style.display="none",r(122).appendChild(t),t.src="javascript:",t=t.contentWindow.document,t.open(),t.write(n+"script"+i+"document.F=Object"+n+"/script"+i),t.close(),d=t.F;e--;)delete d[l][s[e]];return d()};t.exports=Object.create||function(t,e){var n;return null!==t?(u[l]=i(t),n=new u,u[l]=null,n[a]=t):n=d(),void 0===e?n:o(n,e)}},function(t,e,n){"use strict";var _,v,y,g,I,i,h,T,r,x,o,s,N,m,a,u,l,R,E,f,c,M,k,P,p,d,L,A,O,S,b,w,C,D,F,z,V,j,G,U,B,Z,H,Y,q,X,W,K,Q,J,$,tt,et,nt,it,rt,ot,st,at,ut,lt,dt,ht,ft,ct,pt,_t,vt,yt,gt,It,Tt,xt,Nt,mt,Rt,Et,Mt,kt,Pt,Lt,At,Ot,St,bt,wt,Ct,Dt,Ft,zt,Vt,jt,Gt;n(10)?(_=n(63),v=n(8),y=n(7),g=n(24),I=n(123),i=n(202),h=n(58),T=n(125),r=n(59),x=n(13),o=n(124),s=n(38),N=n(17),m=n(126),a=n(46),u=n(61),l=n(30),R=n(64),E=n(21),f=n(39),c=n(203),M=n(85),k=n(128),P=n(81).f,p=n(204),Vt=n(47),Lt=n(5),jt=n(129),d=n(120),L=n(130),A=n(31),O=n(40),S=n(211),b=n(212),w=n(127),C=n(213),D=n(23),F=n(80),z=D.f,V=F.f,j=v.RangeError,G=v.TypeError,U=v.Uint8Array,B="ArrayBuffer",Z="Shared"+B,H="BYTES_PER_ELEMENT",Y="prototype",n=Array[Y],q=i.ArrayBuffer,X=i.DataView,W=jt(0),K=jt(2),Q=jt(3),J=jt(4),$=jt(5),tt=jt(6),et=d(!0),nt=d(!1),it=A.values,rt=A.keys,ot=A.entries,st=n.lastIndexOf,at=n.reduce,ut=n.reduceRight,lt=n.join,dt=n.sort,ht=n.slice,ft=n.toString,ct=n.toLocaleString,pt=Lt("iterator"),_t=Lt("toStringTag"),vt=Vt("typed_constructor"),yt=Vt("def_constructor"),n=I.CONSTR,gt=I.TYPED,It=I.VIEW,Tt="Wrong length!",xt=jt(1,function(t,e){return Mt(L(t,t[yt]),e)}),Nt=y(function(){return 1===new U(new Uint16Array([1]).buffer)[0]}),mt=!!U&&!!U[Y].set&&y(function(){new U(1).set({})}),Rt=function(t,e){if(t=s(t),t<0||t%e)throw j("Wrong offset!");return t},Et=function(t){if(E(t)&&gt in t)return t;throw G(t+" is not a typed array!")},Mt=function(t,e){if(!(E(t)&&vt in t))throw G("It is not a typed array constructor!");return new t(e)},kt=function(t,e){return Pt(L(t,t[yt]),e)},Pt=function(t,e){for(var n=0,i=e.length,r=Mt(t,i);n<i;)r[n]=e[n++];return r},Lt=function(t,e,n){z(t,e,{get:function(){return this._d[n]}})},At=function(t){var e,n,i,r,o,s,a=f(t),u=arguments.length,l=1<u?arguments[1]:void 0,d=void 0!==l,t=p(a);if(null!=t&&!c(t)){for(s=t.call(a),i=[],e=0;!(o=s.next()).done;e++)i.push(o.value);a=i}for(d&&2<u&&(l=h(l,arguments[2],2)),e=0,n=N(a.length),r=Mt(this,n);e<n;e++)r[e]=d?l(a[e],e):a[e];return r},Ot=function(){for(var t=0,e=arguments.length,n=Mt(this,e);t<e;)n[t]=arguments[t++];return n},St=!!U&&y(function(){ct.call(new U(1))}),bt=function(){return ct.apply(St?ht.call(Et(this)):Et(this),arguments)},wt={copyWithin:function(t,e){return C.call(Et(this),t,e,2<arguments.length?arguments[2]:void 0)},every:function(t){return J(Et(this),t,1<arguments.length?arguments[1]:void 0)},fill:function(t){return w.apply(Et(this),arguments)},filter:function(t){return kt(this,K(Et(this),t,1<arguments.length?arguments[1]:void 0))},find:function(t){return $(Et(this),t,1<arguments.length?arguments[1]:void 0)},findIndex:function(t){return tt(Et(this),t,1<arguments.length?arguments[1]:void 0)},forEach:function(t){W(Et(this),t,1<arguments.length?arguments[1]:void 0)},indexOf:function(t){return nt(Et(this),t,1<arguments.length?arguments[1]:void 0)},includes:function(t){return et(Et(this),t,1<arguments.length?arguments[1]:void 0)},join:function(t){return lt.apply(Et(this),arguments)},lastIndexOf:function(t){return st.apply(Et(this),arguments)},map:function(t){return xt(Et(this),t,1<arguments.length?arguments[1]:void 0)},reduce:function(t){return at.apply(Et(this),arguments)},reduceRight:function(t){return ut.apply(Et(this),arguments)},reverse:function(){for(var t,e=this,n=Et(e).length,i=Math.floor(n/2),r=0;r<i;)t=e[r],e[r++]=e[--n],e[n]=t;return e},some:function(t){return Q(Et(this),t,1<arguments.length?arguments[1]:void 0)},sort:function(t){return dt.call(Et(this),t)},subarray:function(t,e){var n=Et(this),i=n.length,t=a(t,i);return new(L(n,n[yt]))(n.buffer,n.byteOffset+t*n.BYTES_PER_ELEMENT,N((void 0===e?i:a(e,i))-t))}},Ct=function(t,e){return kt(this,ht.call(Et(this),t,e))},Dt=function(t){Et(this);var e=Rt(arguments[1],1),n=this.length,i=f(t),r=N(i.length),o=0;if(n<r+e)throw j(Tt);for(;o<r;)this[e+o]=i[o++]},Ft={entries:function(){return ot.call(Et(this))},keys:function(){return rt.call(Et(this))},values:function(){return it.call(Et(this))}},zt=function(t,e){return E(t)&&t[gt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Vt=function(t,e){return zt(t,e=u(e,!0))?r(2,t[e]):V(t,e)},jt=function(t,e,n){return!(zt(t,e=u(e,!0))&&E(n)&&l(n,"value"))||l(n,"get")||l(n,"set")||n.configurable||l(n,"writable")&&!n.writable||l(n,"enumerable")&&!n.enumerable?z(t,e,n):(t[e]=n.value,t)},n||(F.f=Vt,D.f=jt),g(g.S+g.F*!n,"Object",{getOwnPropertyDescriptor:Vt,defineProperty:jt}),y(function(){ft.call({})})&&(ft=ct=function(){return lt.call(this)}),Gt=o({},wt),o(Gt,Ft),x(Gt,pt,Ft.values),o(Gt,{slice:Ct,set:Dt,constructor:function(){},toString:ft,toLocaleString:bt}),Lt(Gt,"buffer","b"),Lt(Gt,"byteOffset","o"),Lt(Gt,"byteLength","l"),Lt(Gt,"length","e"),z(Gt,_t,{get:function(){return this[gt]}}),t.exports=function(t,l,e,i){i=!!i;var d=t+(i?"Clamped":"")+"Array",n="get"+t,r="set"+t,h=v[d],o=h||{},s=h&&k(h),a=!h||!I.ABV,t={},u=h&&h[Y],f=function(t,e){return t=t._d,t.v[n](e*l+t.o,Nt)},c=function(t,e,n){t=t._d,i&&(n=(n=Math.round(n))<0?0:255<n?255:255&n),t.v[r](e*l+t.o,n,Nt)},p=function(t,e){z(t,e,{get:function(){return f(this,e)},set:function(t){return c(this,e,t)},enumerable:!0})};a?(h=e(function(t,e,n,i){T(t,h,d,"_d");var r,o,s=0,a=0;if(E(e)){if(!(e instanceof q||(u=R(e))==B||u==Z))return gt in e?Pt(h,e):At.call(h,e);var u=e,a=Rt(n,l),n=e.byteLength;if(void 0===i){if(n%l)throw j(Tt);if(r=n-a,r<0)throw j(Tt)}else if(r=N(i)*l,n<r+a)throw j(Tt);o=r/l}else o=m(e),r=o*l,u=new q(r);for(x(t,"_d",{b:u,o:a,l:r,e:o,v:new X(u)});s<o;)p(t,s++)}),u=h[Y]=M(Gt),x(u,"constructor",h)):y(function(){h(1)})&&y(function(){new h(-1)})&&S(function(t){new h,new h(null),new h(1.5),new h(t)},!0)||(h=e(function(t,e,n,i){var r;return T(t,h,d),E(e)?e instanceof q||(r=R(e))==B||r==Z?void 0!==i?new o(e,Rt(n,l),i):void 0!==n?new o(e,Rt(n,l)):new o(e):gt in e?Pt(h,e):At.call(h,e):new o(m(e))}),W(s!==Function.prototype?P(o).concat(P(s)):P(o),function(t){t in h||x(h,t,o[t])}),h[Y]=u,_||(u.constructor=h)),a=u[pt],e=!!a&&("values"==a.name||null==a.name),s=Ft.values,x(h,vt,!0),x(u,gt,d),x(u,It,!0),x(u,yt,h),(i?new h(1)[_t]==d:_t in u)||z(u,_t,{get:function(){return d}}),t[d]=h,g(g.G+g.W+g.F*(h!=o),t),g(g.S,d,{BYTES_PER_ELEMENT:l}),g(g.S+g.F*y(function(){o.of.call(h,1)}),d,{from:At,of:Ot}),H in u||x(u,H,l),g(g.P,d,wt),b(d),g(g.P+g.F*mt,d,{set:Dt}),g(g.P+g.F*!e,d,Ft),_||u.toString==ft||(u.toString=ft),g(g.P+g.F*y(function(){new h(1).slice()}),d,{slice:Ct}),g(g.P+g.F*(y(function(){return[1,2].toLocaleString()!=new h([1,2]).toLocaleString()})||!y(function(){u.toLocaleString.call([1,2])})),d,{toLocaleString:bt}),O[d]=e?a:s,_||e||x(u,pt,s)}):t.exports=function(){}},function(t,e,n){var i=n(23).f,r=n(30),o=n(5)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){"use strict";n(215)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";var i=n(22);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(3)),n=function(){function r(t,e,n,i){(0,o.default)(this,r),this._groupId=t,this._length=e,this._pointList=n||[],this._nodeList=i||[]}return(0,s.default)(r,[{key:"dispose",value:function(){this._pointList=[],this._nodeList=[]}},{key:"groupId",get:function(){return this._groupId}},{key:"GroupId",get:function(){return this._groupId}},{key:"length",get:function(){return this._length}},{key:"Length",get:function(){return this._length}},{key:"pointList",get:function(){return this.getPointList()}},{key:"PointList",get:function(){return this.getPointList()}},{key:"getPointList",value:function(){for(var t=[],e=0,n=this._pointList.length;e<n;e++)t.push({x:this._pointList[e].x,y:this._pointList[e].y,groupId:this._groupId});return t}}]),r}(),n=n;e.default=n},function(t,e,n){"use strict";var h=n(224),y=n(22),g=n(130),I=n(225),T=n(17),x=n(227),f=n(93),i=n(7),N=Math.min,c=[].push,s="split",m="length",R="lastIndex",E=4294967295,M=!i(function(){RegExp(E,"y")});n(228)("split",2,function(r,o,p,_){var v="c"=="abbc"[s](/(b)*/)[1]||4!="test"[s](/(?:)/,-1)[m]||2!="ab"[s](/(?:ab)*/)[m]||4!="."[s](/(.?)(.?)/)[m]||1<"."[s](/()()/)[m]||""[s](/.?/)[m]?function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!h(t))return p.call(n,t,e);for(var i,r,o,s=[],a=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),u=0,l=void 0===e?E:e>>>0,d=new RegExp(t.source,a+"g");(i=f.call(d,n))&&(r=d[R],!(u<r&&(s.push(n.slice(u,i.index)),1<i[m]&&i.index<n[m]&&c.apply(s,i.slice(1)),o=i[0][m],u=r,s[m]>=l)));)d[R]===i.index&&d[R]++;return u===n[m]?!o&&d.test("")||s.push(""):s.push(n.slice(u)),s[m]>l?s.slice(0,l):s}:"0"[s](void 0,0)[m]?function(t,e){return void 0===t&&0===e?[]:p.call(this,t,e)}:p;return[function(t,e){var n=r(this),i=null==t?void 0:t[o];return void 0!==i?i.call(t,n,e):v.call(String(n),t,e)},function(t,e){var n=_(v,t,this,e,v!==p);if(n.done)return n.value;var i=y(t),r=String(this),n=g(i,RegExp),o=i.unicode,t=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(M?"y":"g"),s=new n(M?i:"^(?:"+i.source+")",t),a=void 0===e?E:e>>>0;if(0===a)return[];if(0===r.length)return null===x(s,r)?[r]:[];for(var u=0,l=0,d=[];l<r.length;){s.lastIndex=M?l:0;var h,f=x(s,M?r:r.slice(l));if(null===f||(h=N(T(s.lastIndex+(M?0:l)),r.length))===u)l=I(r,l,o);else{if(d.push(r.slice(u,l)),d.length===a)return d;for(var c=1;c<=f.length-1;c++)if(d.push(f[c]),d.length===a)return d;l=u=h}}return d.push(r.slice(u)),d}]})},function(t,e,n){"use strict";var i,s=n(89),a=RegExp.prototype.exec,u=String.prototype.replace,r=a,l="lastIndex",d=(i=/a/,n=/b*/g,a.call(i,"a"),a.call(n,"a"),0!==i[l]||0!==n[l]),h=void 0!==/()??/.exec("")[1],n=d||h;n&&(r=function(t){var e,n,i,r,o=this;return h&&(n=new RegExp("^"+o.source+"$(?!\\s)",s.call(o))),d&&(e=o[l]),i=a.call(o,t),d&&i&&(o[l]=o.global?i.index+i[0].length:e),h&&i&&1<i.length&&u.call(i[0],n,function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)}),i}),t.exports=r},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(15)),s=r(n(2)),a=r(n(3)),u=r(n(12)),n=(r(n(135)),function(){function t(){(0,s.default)(this,t),this.Id=0,this.startId=-1,this.startPoint={},this.endId=-1,this.endPoint={},this.length=0,this._type=0,this.pointVector=[],this.extentId=-1,this._isInAdj=!1,this._info=0}return(0,a.default)(t,[{key:"roadRank",get:function(){return 3&this._type},set:function(t){this._type|=t}},{key:"roadEntry",get:function(){return this._type>>2&3},set:function(t){this._type|=t<<2}},{key:"tempType",get:function(){return this._type>>4&3},set:function(t){this._type|=t<<4}},{key:"through",get:function(){return 16&this._type?1:0},set:function(t){t?this._type|=16:this._type&=-17}},{key:"setRoad",value:function(t){this.Id=t.Id,this.startId=t.startId,this.startPoint=(0,o.default)({},t.startPoint),this.endId=t.endId,this.endPoint=(0,o.default)({},t.endPoint),this.length=t.length,this._type=t._type,this.pointVector=[],this.extentId=t.extentId;for(var e=0;e<t.pointVector.length;e++)this.pointVector[e]=t.pointVector[e]}},{key:"calcLength",value:function(){this.length=u.default.distanceOfTwoPoints(this.startPoint,this.endPoint)}},{key:"calcManhattanDistance",value:function(){var t=this.startPoint.x-this.endPoint.x,e=this.startPoint.y-this.endPoint.y;this.length=Math.abs(t)+Math.abs(e)}},{key:"calcMiddlePoint",value:function(){var t={};return t.x=(this.startPoint.x+this.endPoint.x)/2,t.y=(this.startPoint.y+this.endPoint.y)/2,t}}]),t}()),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.NodeDistance=e.default=void 0;var d=r(n(134)),o=r(n(48));n(16),n(26),n(32),n(31),n(51),n(66);var s=r(n(29)),a=r(n(3)),u=r(n(2)),_=r(n(12)),v=r(n(42)),y=r(n(33)),l=r(n(50)),h=function t(){(0,u.default)(this,t),this.distance=Number.MAX_VALUE,this.node=null};e.NodeDistance=h,n=function(){function f(t,e,n,i){(0,u.default)(this,f),this.groupId=0,this._type=i,this.nodeVector=t,this.roadVector=e,this.obstructModels=[],this.obstructExtents=[],this.obstructLines=[],this.zones=[],this.zoneIDMap=new l.default,this.vertexLen=[],this.adjList=new l.default,this.nextFloorMap=new l.default,this._needVertex=n,this._roadDiffusion=[],this._nodeMap=new l.default,this._roadMap=new l.default,this._maxNodeId=0,this._maxRoadId=0,this.simplify(),this._init()}return(0,a.default)(f,[{key:"dispose",value:function(){this.nodeVector=null,this.roadVector=null,this.obstructModels=null,this.obstructExtents=null,this.obstructLines=null,this.zones=null,null!=this.zoneIDMap&&(this.zoneIDMap.clear(),this.zoneIDMap=null),null!=this.adjList&&(this.adjList.clear(),this.adjList=null),this.vertexLen=null,null!=this.nextFloorMap&&(this.nextFloorMap.clear(),this.nextFloorMap=null),this._roadDiffusion=null,null!=this._nodeMap&&(this._nodeMap.clear(),this._nodeMap=null),null!=this._roadMap&&(this._roadMap.clear(),this._roadMap=null)}},{key:"initVertexLen",value:function(t){for(var e,n,i=Number.MAX_VALUE,r=0;r<this.roadVector.length;r++)0!=this.needVertex&&(e=this.roadVector[r],1==t?i=e.length:2==t&&(i=e.length*e.roadRank),n=e.roadEntry,n!=y.default.NaviRoadEntry_BOTH&&n!=y.default.NaviRoadEntry_FORWARD||(this.vertexLen[e.startId][e.endId]=i),n!=y.default.NaviRoadEntry_BOTH&&n!=y.default.NaviRoadEntry_BACK||(this.vertexLen[e.endId][e.startId]=i))}},{key:"invalide",value:function(){return 0==this.nodeVector.length||0==this.roadVector.length}},{key:"reset",value:function(){for(var t=0;t<this.nodeVector.length;t++)this.nodeVector[t]._treatHead=!1;if(1==this._needVertex)for(var e=this.nodeVector.length+1,n=0;n<e;n++)for(var i=0;i<e;i++)void 0!==this.vertexLen[n]&&void 0!==this.vertexLen[n][i]&&(this.vertexLen[n][i]=Number.MAX_VALUE)}},{key:"obstructsToZones",value:function(){this.zones=[];for(var t=0;t<this.obstructExtents.length;t++){var e=this.obstructExtents[t],e=e.toZone();this.zones.push(e)}for(var n=0;n<this.obstructModels.length;n++){var i=this.obstructExtents[n],i=i.toZone();this.zones.push(i)}}},{key:"getZone",value:function(t){for(var e=0;e<this.zones.length;e++){var n=this.zones[e];if(n&&n.Id==t)return n}return null}},{key:"queryZoneByPoint",value:function(t){for(var e=0;e<this.zones.length;e++){var n=this.zones[e];if(n&&1==n.contain(t))return n}return null}},{key:"transpose",value:function(){}},{key:"queryEntranceCoordByPoint",value:function(t,e){var n=null;if(this.nodeVector.length<=0||this.roadVector.length<=0)return n;for(var i=[],r=0,o=this.nodeVector.length;r<o;r++){var s=this.nodeVector[r],a=s.entranceType;a!=e&&a!=y.default.NaviEntranceType_ACCESS||(a=new h,a.node=s,a.distance=_.default.distanceOfTwoPoints(t,s.point),i.push(a))}return 0==i.length||(i=i.sort(this._nodeDistanceFunc),n=i[0].node.point),n}},{key:"queryEntranceCoords",value:function(t){var e=[];if(this.nodeVector.length<=0||this.roadVector.length<=0)return e;for(var n=0,i=this.nodeVector.length;n<i;n++){var r=this.nodeVector[n],o=r.entranceType;o!=t&&o!=y.default.NaviEntranceType_ACCESS||e.push(r.point)}return e}},{key:"nodesAccess",value:function(t,e){if(this.nodeVector.length<=0||this.roadVector.length<=0)return!1;if(t.Id==e.Id)return!0;this._resetRoadDiffusion();var n=[];n.push(t.Id);for(var i=null,r=null,o=0,s=o;o!=n.length;)for(var s=o,o=n.length,a=s;a<n.length;a++)for(var u=0;u<this.roadVector.length;u++)if(1!=this._roadDiffusion[u]){if(i=this.roadVector[u],r=i.roadEntry,i.startId==n[a]&&(r==y.default.NaviRoadEntry_BOTH||r==y.default.NaviRoadEntry_FORWARD)){if(i.endId==e.Id)return!0;n.push(i.endId),this._roadDiffusion[u]=!0}if(i.endId==n[a]&&(r==y.default.NaviRoadEntry_BOTH||r==y.default.NaviRoadEntry_BACK)){if(i.startId==e.Id)return!0;n.push(i.startId),this._roadDiffusion[u]=!0}}return!1}},{key:"querySameExtentLiftNodesByGeoPoint",value:function(t,e,n,i){if(this.nodeVector.length<=0||this.roadVector.length<=0)return[];var r=this.queryContainExtentId(t);if(0==r)return!1;for(var o=[],s=0;s<this.nodeVector.length;s++){var a=this.nodeVector[s],u=this.queryContainExtentId(a.point);!a.contansFloor(e)||u!=r&&0!=r||(u=new h,u.node=a,u.distance=_.default.distanceOfTwoPoints(t,a.point),u.distance=(0,d.default)(u.distance).toFixed(4),o.push(u))}if(!o||0==o.length)return[];for(var o=o.sort(this._nodeDistanceFunc),l=0;l<o.length;l++)n[l]=new v.default,n[l].setNode(o[l].node),i[l]=(0,d.default)(o[l].distance);return n}},{key:"queryLiftNodeByFLAGID",value:function(t,e){if(!this.nodeVector||this.nodeVector.length<=0||!this.roadVector||this.roadVector.length<=0)return!1;for(var n=0;n<this.nodeVector.length;n++){var i=this.nodeVector[n];if(i.nodeType==y.default.NaviNodeType_FLOOR){var r=i.liftFlag;if(r==t)return e.setNode(i),!0}}return!1}},{key:"queryLiftNodesByType",value:function(t,e){if(!this.nodeVector||this.nodeVector.length<=0||!this.roadVector||this.roadVector.length<=0)return!1;for(var n=0;n<this.nodeVector.length;n++){var i=this.nodeVector[n];i.liftType==t&&(e[n]=i)}return 0!=e.length}},{key:"queryContainExtentId",value:function(t){if(0==this.obstructExtents.length||!t)return 0;for(var e=0,n=this.obstructExtents.length;e<n;e++){var i=this.obstructExtents[e];if(i.contain(t))return i.Id}return 0}},{key:"isLineObstruct",value:function(t,e){if(0==this.obstructLines.length||!t||!e)return!1;for(var n=0;n<this.obstructLines.length;n++)if(this.obstructLines[n].isCross(t,e))return!0;return!1}},{key:"queryNearestSameExtentElementByGeoPoint",value:function(t,e,n,i,r){var o=Number.MAX_VALUE,s={};if(new v.default,this.nodeVector.length<=0||this.roadVector.length<=0)return!1;var a=this.queryContainExtentId(t);if(0==a)return!1;for(var u=0,l=this.roadVector.length;u<l;u++){var d,h=this.roadVector[u];h&&a==this.queryContainExtentId(h.startPoint)&&(d=_.default.pointDistanceToLine(t,h.startPoint,h.endPoint,s),this.isLineObstruct(s,t)||d<o&&(o=d,e.setRoad(h),i.x=s.x,i.y=s.y))}if(!e||e.roadEntry==y.default.NaviRoadEntry_FORBID)return!1;for(var f=e.roadEntry==y.default.NaviRoadEntry_BACK||e.roadEntry!=y.default.NaviRoadEntry_FORWARD&&_.default.distanceOfTwoPoints(e.startPoint,i)<=_.default.distanceOfTwoPoints(e.endPoint,i)?e.startId:e.endId,c=0;c<this.nodeVector.length;c++){var p=this.nodeVector[c];if(p.Id==f){n.setNode(p);break}}return!0}},{key:"queryNearestSameExtentElementByGeoPointProcessForbid",value:function(t,e,n,i){var r=Number.MAX_VALUE,o={};if(new v.default,this.nodeVector.length<=0||this.roadVector.length<=0)return!1;var s=this.queryContainExtentId(t);if(0==s)return!1;for(var a=0;a<this.roadVector.length;a++){var u,l=this.roadVector[a];y.default.NaviRoadEntry_BOTH==l.roadEntry&&(s!=this.queryContainExtentId(l.startPoint)&&0!=s||(u=_.default.pointDistanceToLine(t,l.startPoint,l.endPoint,o),this.isLineObstruct(o,t)||u<r&&(r=u,e.setRoad(l),i.x=o.x,i.y=o.y)))}if(-1==e.Id)return!1;for(var d=_.default.distanceOfTwoPoints(e.startPoint,i)<=_.default.distanceOfTwoPoints(e.endPoint,i)?e.startId:e.endId,h=0;h<this.nodeVector.length;h++){var f=this.nodeVector[h];if(f.Id==d){n.setNode(f);break}}return-1!=n.Id}},{key:"simplify",value:function(){this._maxNodeId=0,this._maxRoadId=0;for(var t=0;t<this.roadVector.length;)null==this.roadVector[t]?this.roadVector.splice(t,1):(this.roadVector[t].Id>this._maxRoadId&&(this._maxRoadId=this.roadVector[t].Id),t++);for(var e=0;e<this.nodeVector.length;)null==this.nodeVector[e]?this.nodeVector.splice(e,1):(this.nodeVector[e].Id>this._maxNodeId&&(this._maxNodeId=this.nodeVector[e].Id),e++)}},{key:"consoleAdjList",value:function(t){if(t){var e,n=this.adjList,i=(this.nodeVector,this),r=(naviMap.size(),"*********  ADJLIST   ************\n");for(e in n.keys)for(var o=n.keys[e],s=o,a=n.get(o),u=0;u<a.length;u++){var l=a[u],d=l.nodeId,l=this._naviGraph.getIndexByNodeID(s),d=(this._naviGraph.getIndexByNodeID(d),i.nodeVector[l]),l=i.nodeVector[endidx],r=r+d.Id+","+d.point.x+","+d.point.y;r+=",",r=r+l.Id+","+l.point.x+","+l.point.y,r+="\n"}r+="*********** END **************"}}},{key:"consoleNodeInfos",value:function(t){if(t){var e=[];e.push.apply(e,(0,s.default)(this.nodeVector)),e.sort(function(t,e){return t.Id-e.Id});for(var n=0;n<e.length;n++)for(var i=e[n],r=(i.Id,0);r<i.segLinks.length;r++)i.segLinks[r]}}},{key:"consoleNodePres",value:function(t){if(t)for(var e=0;e<this.nodeVector.length;e++)for(var n=this.nodeVector[e],i=(n.Id,0);i<n._vPre.length;i++)n._vPre[i]}},{key:"consoleRoadInfos",value:function(t){if(t){var e=[];e.push.apply(e,(0,s.default)(this.roadVector)),e.sort(function(t,e){return t.Id-e.Id});for(var n=0;n<e.length;n++){var i=e[n];i.Id,i.startId,i.endId}}}},{key:"consoleAdjInfos",value:function(t){t&&(this.adjList.sort(),this.adjList.each(function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.nodeId,i.length.toFixed(6)}}))}},{key:"getIndexByNodeID",value:function(t){return t=this._nodeMap.get(t),void 0===t?null:t}},{key:"getIndexByRoadID",value:function(t){return t=this._roadMap.get(t),void 0===t?null:t}},{key:"findObstruct",value:function(t){for(var e=Number.MAX_VALUE,n=null,i=0;i<this.obstructExtents.length;++i){var r=this.obstructExtents[i],o=r.contain(t);o&&r.area<e&&(e=cur_area,n=r)}for(var s=0;s<this.obstructModels.size();++s){var a=this.obstructModels[s],u=a.contain(t);u&&a.area<e&&(e=cur_area,n=a)}return n||null}},{key:"findModel",value:function(t){for(var e=Number.MAX_VALUE,n=null,i=0;i<this.obstructModels.length;++i){var r=this.obstructModels[i],o=r.contain(t);o&&r.area<e&&(e=r.area,n=r)}return n||null}},{key:"generateNodeId",value:function(){return++this._maxNodeId}},{key:"generateRoadId",value:function(){return++this._maxRoadId}},{key:"setBaseNodeId",value:function(t){this._maxNodeId=t}},{key:"setBaseRoadId",value:function(t){this._maxRoadId=t}},{key:"createNodeMap",value:function(){for(var t=0;t<this.nodeVector.length;t++){var e=this.nodeVector[t];e&&this._nodeMap.put(e.Id,t)}}},{key:"createRoadMap",value:function(){for(var t=0;t<this.roadVector.length;t++){var e=this.roadVector[t];e&&this._roadMap.put(e.Id,t)}}},{key:"clearNodeCache",value:function(){var n=this;this._nodeMap.each(function(t,e){e=n.nodeVector[e],e._vPre=[]})}},{key:"makeUpAdjList",value:function(){var r=this;this.adjList.clear();for(var o,t=function(t){var e=r.roadVector[t];if(null==e)return"continue";var n,i=e.roadEntry;y.default.NaviRoadEntry_BOTH!=i&&y.default.NaviRoadEntry_FORWARD!=i||(t=e.startId,n=r.adjList.get(t),n||(n=[],r.adjList.put(t,n)),o=n.find(function(t){return t.nodeId==e.endId}),null==o&&n.push({nodeId:e.endId,length:e.length})),y.default.NaviRoadEntry_BOTH!=i&&y.default.NaviRoadEntry_BACK!=i||(n=e.endId,i=r.adjList.get(n),i||(i=[],r.adjList.put(n,i)),o=i.find(function(t){return t.nodeId==e.startId}),null==o&&i.push({nodeId:e.startId,length:e.length}))},e=0;e<this.roadVector.length;e++)t(e)}},{key:"getIdxByNodeId",value:function(t){for(var e=9;e<this.nodeVector.length;e++)if(this.nodeVector[e].Id==t)return e;return-1}},{key:"getIdxByRoadId",value:function(t){for(var e=9;e<this.roadVector.length;e++)if(this.roadVector[e].Id==t)return e;return-1}},{key:"queryRoadsByPolygon",value:function(t){for(var e=[],n=this.roadVector,i=0;i<n.length;i++){var r=n[i].startPoint,o=n[i].endPoint,s=[];_.default.segCrossPolygon(r,o,t,s)?(s.sort(function(t,e){return t=_.default.distanceOfTwoPoints(r,t),e=_.default.distanceOfTwoPoints(r,e),t-e}),e.push({road:n[i],crss:s})):_.default.pointInPolygon2d(t,r,t.length)&&e.push({road:n[i],crss:[]})}return e}},{key:"getModelByPoint",value:function(t){for(var e=null,n=1/0,i=0;i<this.obstructModels.length;i++){var r=this.obstructModels[i];r.Id,r.fid,_.default.pointInPolygon2d(r.points,t,r.points.length)&&n>_.default.calcPolygonArea2d(r.points)&&(e=r,n=_.default.calcPolygonArea2d(r.points))}return e}},{key:"getZoneIdByPoint",value:function(t){for(var e=-1,n=0;n<this.zones.length;n++){var i=this.zones[n];if(_.default.pointInPolygon2d(i.points,t,i.points.length)){e=i.Id;break}}return e}},{key:"getRandomModel",value:function(){var t=this.obstructModels.length,t=(0,o.default)(Math.random()*t);return this.obstructModels[t]}},{key:"_init",value:function(){if(1==this._needVertex)for(var t=null,e=0;e<this.roadVector.length;e++)t=this.roadVector[e],void 0===this.vertexLen[t.startId]&&(this.vertexLen[t.startId]=new Array),this.vertexLen[t.startId][t.endId]=Number.MAX_VALUE,void 0===this.vertexLen[t.endId]&&(this.vertexLen[t.endId]=new Array),this.vertexLen[t.endId][t.startId]=Number.MAX_VALUE;for(var n=0;n<this.roadVector.length;n++)this._roadDiffusion[n]=!1}},{key:"_resetRoadDiffusion",value:function(){for(var t=0;t<this._roadDiffusion.length;t++)this._roadDiffusion[t]=!1}},{key:"_nodeDistanceFunc",value:function(t,e){return(0,d.default)(t.distance)-(0,d.default)(e.distance)}},{key:"getLifts",value:function(){for(var t=[],e=0;e<this.nodeVector.length;e++){var n=this.nodeVector[e];n.liftType==y.default.NaviLiftType_Lift&&t.push(n)}return t}},{key:"getNodeByFlag",value:function(t){for(var e=0;e<this.nodeVector.length;e++)if(this.nodeVector[e].liftFlag==t)return this.nodeVector[e];return null}},{key:"getEscalators",value:function(){}},{key:"getStaris",value:function(){}},{key:"getAllLifts",value:function(){for(var t=[],e=0;e<this.nodeVector.length;e++){var n=this.nodeVector[e];n.liftType!=y.default.NaviLiftType_NULL&&t.push(n)}return t}},{key:"getGraphByEid",value:function(t){for(var e=null,n=0;n<this.obstructExtents.length;n++)if(t==this.obstructExtents[n].Id){e=this.obstructExtents[n];break}if(!e)return null;for(var i=[],r=0;r<this.nodeVector.length;r++){var o=this.nodeVector[r];_.default.pointInPolygon2d(e.points,o.point,e.points.length)&&i.push(o)}for(var s=[],a=0;a<this.roadVector.length;a++){var u=this.roadVector[a];_.default.pointInPolygon2d(e.points,u.startPoint,e.points.length)&&s.push(u)}for(var l=[],n=0;n<this.obstructModels.length;n++){var d=this.obstructModels[n];_.default.pointInPolygon2d(e.points,d.center,e.points.length)&&l.push(d)}var h=new f(i,s,!0,1);return h.obstructModels=l,h.obstructExtents=[e],h}}]),f}(),e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(16),n(26);var o=r(n(2)),s=r(n(3)),a=r(n(41)),u=r(n(49)),n=function(){function e(t){(0,o.default)(this,e),this._naviGraph=t,this._startNode=null,this._endNode=null,this._startNodeID=-1,this._endNodeID=-1,this._mode=a.default.MODULE_SHORTEST,this._naviGraph.createNodeMap(),this._naviGraph.createRoadMap(),this._naviGraph.makeUpAdjList(),this._kEPSILON_VALUE=5e-4}return(0,s.default)(e,[{key:"routeMultiDestinations",value:function(t,e,n){if(this._switchToMode(n),this._destIds=e,t=this._naviGraph.getIndexByNodeID(t),-1==t)return u.default.ROUTE_FAILED_CANNOT_CALCULATE;this.endIdxs=[];for(var i=0;i<e.length;i++){var r=this._naviGraph.getIndexByNodeID(e[i]);this.endIdxs.push(r)}return t=this._dijkstraAssist_1vN(this._naviGraph,t,this.endIdxs),this._naviGraph.consoleNodePres(),!!t}},{key:"getMultiRoute",value:function(t){for(var e=0;e<this.endIdxs.length;e++){var n=[];this._getOneRoute(this.endIdxs[e],n),n.reverse(),t.push(n)}}},{key:"_getOneRoute",value:function(t,e){t=this._naviGraph.nodeVector[t],e.push(t),t=t._vPre[0],null!=t&&this._getOneRoute(t,e)}},{key:"routeCalculate",value:function(t,e,n){return this._switchToMode(n),this._startNode=t,this._endNode=e,this._startNodeID=t.Id,this._endNodeID=e.Id,n=this._naviGraph.getIndexByNodeID(this._startNodeID),-1==n?u.default.ROUTE_FAILED_CANNOT_CALCULATE:(t=this._naviGraph.getIndexByNodeID(e.Id),-1==t?u.default.ROUTE_FAILED_CANNOT_CALCULATE:(e=[],e.push(t),e=this._dijkstraAssist_1vN(this._naviGraph,n,e),this._naviGraph.consoleNodePres(),e?u.default.ROUTE_SUCCESS:u.default.ROUTE_FAILED_CANNOT_ARRIVE))}},{key:"getRouteCalculateResult",value:function(){var t=[],e=this._naviGraph.getIndexByNodeID(this._endNodeID),n=[];n.push(e);var i=[],e=[];return this._multiPathNodeVector(n,this._naviGraph.nodeVector,i,e),t.push.apply(t,i),t}},{key:"dispose",value:function(){this._naviGraph.dispose(),this._naviGraph=null,this._startNode=null,this._endNode=null}},{key:"_dijkstraAssist_1vN",value:function(t,e,n){if(null==t)return!1;var i=t.nodeVector.length;if(e<0||i<=e)return!1;this._removeArrayAll(n,e);for(var r=0;r<i;++r)t.nodeVector[r]._dist=Number.MAX_VALUE,t.nodeVector[r]._visited=!1,t.nodeVector[r]._vPre=[];t.nodeVector[e]._dist=0;var o=n.length,s=0,a=[];a.push(t.nodeVector[e]);for(var u=this._nodeDistCompareFunc.bind(this);0<a.length;){var l=a[0].Id;a.splice(0,1);var d=t.getIndexByNodeID(l);if(null!=d){var h=t.nodeVector[d];if(!h._visited){h._visited=!0;var f=n.indexOf(d);if(-1!=f&&(++s,s==o))return!0;if(0!=t.adjList.size()){var c=t.adjList.get(l);if(c)for(var p=0;p<c.length;p++){var _=c[p],v=_.nodeId,y=t.getIndexByNodeID(v);null!=y&&(v=_.length,_=t.nodeVector[y],_._visited||(_._dist>v+h._dist?(_._dist=v+h._dist,_._vPre=[],_._vPre.push(d),a.push(t.nodeVector[y]),a.sort(u)):Math.abs(_._dist-(v+h._dist))<1e-12&&-1!=_._vPre.indexOf(d)&&_._vPre.push(d)))}}}}}return!(s<o)}},{key:"_nodeDistCompareFunc",value:function(t,e){return t._dist-(e._dist+this._kEPSILON_VALUE)}},{key:"_removeArrayAll",value:function(t,e){for(var n=t.indexOf(e);-1!=n;)t.splice(n,1),n=t.indexOf(e)}},{key:"_switchToMode",value:function(t){this._mode!=t&&(a.default.MODULE_SHORTEST==t?this._naviGraph.roadVector.forEach(function(t){t.length=t.length/t.roadRank}):a.default.MODULE_BEST==t&&this._naviGraph.roadVector.forEach(function(t){t.length=t.length*t.roadRank}),this._naviGraph.makeUpAdjList(),this._mode=t)}},{key:"_pathNodeVector",value:function(t,e,n,i){0!=e[t]._vPre.length&&(t=e[t]._vPre[0],n.push(e[t]),i.count++,this._pathNodeVector(t,e,n,i))}},{key:"_multiPathNodeVector",value:function(t,e,n,i){for(var r=0;r<t.length;r++){var o=t[r];n.push(e[o]);var s={count:1};this._pathNodeVector(o,e,n,s),i.push(s.count)}}}]),e}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0);i(e,"__esModule",{value:!0}),e._Math=void 0,n(32),n(132);var r={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var r=[],t=0;t<256;t++)r[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,i=r[255&t]+r[t>>8&255]+r[t>>16&255]+r[t>>24&255]+"-"+r[255&e]+r[e>>8&255]+"-"+r[e>>16&15|64]+r[e>>24&255]+"-"+r[63&n|128]+r[n>>8&255]+"-"+r[n>>16&255]+r[n>>24&255]+r[255&i]+r[i>>8&255]+r[i>>16&255]+r[i>>24&255];return i.toUpperCase()}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e),t*t*(3-2*t))},smootherstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e),t*t*t*(t*(6*t-15)+10))},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*r.DEG2RAD},radToDeg:function(t){return t*r.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};e._Math=r},function(t,e,n){t.exports=!n(14)&&!n(20)(function(){return 7!=Object.defineProperty(n(99)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(19),r=n(9).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){var s=n(28),a=n(35),u=n(158)(!1),l=n(72)("IE_PROTO");t.exports=function(t,e){var n,i=a(t),r=0,o=[];for(n in i)n!=l&&s(i,n)&&o.push(n);for(;e.length>r;)s(i,n=e[r++])&&(~u(o,n)||o.push(n));return o}},function(t,e,n){var i=n(70);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){var i=n(71),r=Math.min;t.exports=function(t){return 0<t?r(i(t),9007199254740991):0}},function(t,e,n){t.exports=n(160)},function(t,e,n){var i=n(70);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e){function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){t.exports=n(164)},function(t,e,n){t.exports=n(34)},function(t,e,n){var s=n(18),a=n(27),u=n(52);t.exports=n(14)?Object.defineProperties:function(t,e){a(t);for(var n,i=u(e),r=i.length,o=0;o<r;)s.f(t,n=i[o++],e[n]);return t}},function(t,e,n){var i=n(100),r=n(74).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(56),r=n(43),o=n(35),s=n(69),a=n(28),u=n(98),l=Object.getOwnPropertyDescriptor;e.f=n(14)?l:function(t,e){if(t=o(t),e=s(e,!0),u)try{return l(t,e)}catch(t){}if(a(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){t.exports=n(173)},function(t,e,n){"use strict";var i=n(174)(!0);n(113)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t=this._t,e=this._i;return e>=t.length?{value:void 0,done:!0}:(e=i(t,e),this._i+=e.length,{value:e,done:!1})})},function(t,e,n){"use strict";var y=n(54),g=n(6),I=n(107),T=n(34),x=n(45),N=n(175),m=n(76),R=n(114),E=n(11)("iterator"),M=!([].keys&&"next"in[].keys()),k="@@iterator",P="keys",L="values",A=function(){return this};t.exports=function(t,e,n,i,r,o,s){N(n,e,i);var a,u,l=function(t){if(!M&&t in c)return c[t];switch(t){case P:case L:return function(){return new n(this,t)}}return function(){return new n(this,t)}},d=e+" Iterator",h=r==L,f=!1,c=t.prototype,p=c[E]||c[k]||r&&c[r],_=p||l(r),v=r?h?l("entries"):_:void 0,i="Array"==e&&c.entries||p;if(i&&(t=R(i.call(new t)),t!==Object.prototype&&t.next&&(m(t,d,!0),y||"function"==typeof t[E]||T(t,E,A))),h&&p&&p.name!==L&&(f=!0,_=function(){return p.call(this)}),y&&!s||!M&&!f&&c[E]||T(c,E,_),x[e]=_,x[d]=A,r)if(a={values:h?_:l(L),keys:o?_:l(P),entries:v},s)for(u in a)u in c||I(c,u,a[u]);else g(g.P+g.F*(M||f),e,a);return a}},function(t,e,n){var i=n(28),r=n(44),o=n(72)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){t.exports=n(180)},function(t,e,n){var i=n(36);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){t.exports=!n(10)&&!n(7)(function(){return 7!=Object.defineProperty(n(118)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(21),r=n(8).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){var s=n(30),a=n(60),u=n(120)(!1),l=n(82)("IE_PROTO");t.exports=function(t,e){var n,i=a(t),r=0,o=[];for(n in i)n!=l&&s(i,n)&&o.push(n);for(;e.length>r;)s(i,n=e[r++])&&(~u(o,n)||o.push(n));return o}},function(t,e,n){var u=n(60),l=n(17),d=n(46);t.exports=function(a){return function(t,e,n){var i,r=u(t),o=l(r.length),s=d(n,o);if(a&&e!=e){for(;s<o;)if(i=r[s++],i!=i)return!0}else for(;s<o;s++)if((a||s in r)&&r[s]===e)return a||s||0;return!a&&-1}}},function(t,e,n){var i=n(119),r=n(84);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e,n){n=n(8).document,t.exports=n&&n.documentElement},function(t,e,n){for(var i,r=n(8),o=n(13),n=n(47),s=n("typed_array"),a=n("view"),n=!(!r.ArrayBuffer||!r.DataView),u=n,l=0,d=9,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<d;)(i=r[h[l++]])?(o(i.prototype,s,!0),o(i.prototype,a,!0)):u=!1;t.exports={ABV:n,CONSTR:u,TYPED:s,VIEW:a}},function(t,e,n){var r=n(25);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(38),r=n(17);t.exports=function(t){if(void 0===t)return 0;var e=i(t),t=r(e);if(e!==t)throw RangeError("Wrong length!");return t}},function(t,e,n){"use strict";var s=n(39),a=n(46),u=n(17);t.exports=function(t){for(var e=s(this),n=u(e.length),i=arguments.length,r=a(1<i?arguments[1]:void 0,n),i=2<i?arguments[2]:void 0,o=void 0===i?n:a(i,n);r<o;)e[r++]=t;return e}},function(t,e,n){var i=n(30),r=n(39),o=n(82)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){var I=n(58),T=n(116),x=n(39),N=n(17),i=n(205);t.exports=function(h,t){var f=1==h,c=2==h,p=3==h,_=4==h,v=6==h,y=5==h||v,g=t||i;return function(t,e,n){for(var i,r,o=x(t),s=T(o),a=I(e,n,3),u=N(s.length),l=0,d=f?g(t,u):c?g(t,0):void 0;l<u;l++)if((y||l in s)&&(i=s[l],r=a(i,l,o),h))if(f)d[l]=r;else if(r)switch(h){case 3:return!0;case 5:return i;case 6:return l;case 2:d.push(i)}else if(_)return!1;return v?-1:p||_?_:d}}},function(t,e,n){var i=n(22),r=n(79),o=n(5)("species");t.exports=function(t,e){var n,t=i(t).constructor;return void 0===t||null==(n=i(t)[o])?e:r(n)}},function(t,e,n){var i=n(5)("unscopables"),r=Array.prototype;null==r[i]&&n(13)(r,i,{}),t.exports=function(t){r[i][t]=!0}},function(t,e,n){"use strict";n(217);var i=n(22),r=n(89),o=n(10),s="toString",a=/./[s],u=function(t){n(25)(RegExp.prototype,s,t,!0)};n(7)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?u(function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?r.call(t):void 0)}):a.name!=s&&u(function(){return a.call(this)})},function(t,e,n){var o=n(6),i=n(53),s=n(20),a=n(90),n="["+a+"]",u="​",r=RegExp("^"+n+n+"*"),l=RegExp(n+n+"*$"),n=function(t,e,n){var i={},r=s(function(){return!!a[t]()||u[t]()!=u}),e=i[t]=r?e(d):a[t];n&&(i[n]=e),o(o.P+o.F*r,"String",i)},d=n.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(r,"")),2&e&&(t=t.replace(l,"")),t};t.exports=n},function(t,e,n){t.exports=n(232)},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(3)),n=function(){function t(){(0,o.default)(this,t),this.x=void 0,this.y=void 0,this.z=void 0,this.gid=void 0}return(0,s.default)(t,[{key:"setGeoPoint",value:function(t){this.x=t.x,this.y=t.y}}]),t}(),n=n;e.default=n},function(t,e,n){t.exports=n(237)},function(t,e,n){var i=n(241),r=n(244);function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=i(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}t.exports=o,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){t.exports=n(245)},function(t,e,n){var i=n(248).default,r=n(249);function o(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?r(t):e}t.exports=o,t.exports.default=t.exports,t.exports.__esModule=!0},function(e,t,n){var i=n(138),r=n(250);function o(t){return e.exports=o=i?r:function(t){return t.__proto__||r(t)},e.exports.default=e.exports,e.exports.__esModule=!0,o(t)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(3)),a=r(n(12)),u=r(n(142)),n=function(){function r(t,e,n,i){(0,o.default)(this,r),this.Id=t,this.groupId=e,this._type=n,this.points=i,this.pointCount=i&&i.length?i.length:0,this._level=-1,this.inId=0,this._parent=null,this._child=null,this._brothers=[],this._linkAccessNodes=[],this._area=null,this.bb=new u.default,this.refreshBB()}return(0,s.default)(r,[{key:"pass",get:function(){return 3&this._type},set:function(t){this._type|=t}},{key:"level",get:function(){return 31&this._level},set:function(t){this._level=31&t}},{key:"area",get:function(){return this._area||(this._area=a.default.calcPolygonArea2d()),this._area}},{key:"contain",value:function(t){return a.default.pointInPolygon2d1(this.points,t,this.points.length-1)}},{key:"calcCrossPoint",value:function(t,e){for(var n={},i=0;i<this.pointCount;i++){var r=this.points[i],o=this.points[(i+1)%this.pointCount];if(1==a.default.calcCrossPoint(r,o,t,e,n))break}return n}},{key:"refreshBB",value:function(){this.bb.init();for(var t=0;t<this.pointCount;t++)this.bb.expandBy({x:this.points[t].x,y:this.points[t].y})}}]),r}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(16);var o=r(n(2)),s=r(n(3)),n=function(){function t(){(0,o.default)(this,t),this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE}return(0,s.default)(t,[{key:"init",value:function(){this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE}},{key:"expandBy",value:function(t){t&&t.x&&t.y&&(this.minX>t.x&&(this.minX=t.x),this.maxX<t.x&&(this.maxX=t.x),this.minY>t.y&&(this.minY=t.y),this.maxY<t.y&&(this.maxY=t.y))}},{key:"isSeparate",value:function(t){return this.minX>t.maxX||this.minY>t.maxY||this.maxX<t.minX||this.maxY<t.minY}}]),t}(),n=n;e.default=n},function(t,e,n){n(86)("Int8",1,function(i){return function(t,e,n){return i(this,t,e,n)}})},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(33)),n=function t(){(0,o.default)(this,t),this.cross=null,this.road=null,this.model=null,this.distance=0,this.toDistance=0,this.stickToRoad=!1,this.obstructType=s.default.NaviObstructType_MODEL},n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(48));n(92);var s=r(n(2)),a=r(n(3)),n=function(){function t(){(0,s.default)(this,t)}return(0,a.default)(t,null,[{key:"toColor",value:function(t){if("number"==typeof t)return t;var e=t.split(",");return 3<=e.length?(0,o.default)(e[0])<<16|(0,o.default)(e[1])<<8|(0,o.default)(e[2]):(console.error("color format error",t),0)}},{key:"toRgba",value:function(t){if("number"==typeof t)return"rgba("+(0,o.default)(255*new fm.Color(t).r)+","+(0,o.default)(255*new fm.Color(t).g)+","+(0,o.default)(255*new fm.Color(t).b)+",1)";var e=t.split(",");return 3<=e.length?"rgba("+(0,o.default)(e[0])+","+(0,o.default)(e[1])+","+(0,o.default)(e[2])+",1)":t}},{key:"bindEvent",value:function(t,o,e,s){t.addEventListener(e,function(t){var e,n=t||window.event,i=n.target||n.srcElement,r=n.currentTarget;for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;0<=--n&&e.item(n)!==this;);return-1<n});i!==r;)i.matches(o)&&(e=i,s.call(e,n)),i=i.parentNode})}},{key:"toSceneCoord",value:function(t,e){var n=0;return e.groupID&&(n=t.getFMGroup(e.groupID).height),new fm.Vector3(e.x-t.center.x,t.center.y+n,-e.y+t.center.y)}},{key:"removeFormArray",value:function(t,e){e=t.indexOf(e),-1<e&&t.splice(e,1)}},{key:"scrollTopAnFun",value:function(){var _,v=!1;return function e(n){var i=n.el,r=n.to,t=n.form,o=(n.time,r<t?"up":"bottom"),s=t<r?r-t:r==t?0:t-r,a=10,u=s/a,l=0,d=function(t){var e=t.val,n=t.nbak,i=t.n,t=t.elTop;return"up"==o?t+(n-i)*e:t-(n-i)*e};function h(){_=0,window.setTimeout(function(){var t=Object(n,{to:i.scrollTop});v=!1,e(t)},a+1)}var f=function(){v=!1,_=!1,0==t&&(i.scrollTop=0)},c=function t(){var e;_--,_<=0?f():(e=function(){!1!==_&&(l=d({val:a,nbak:u,n:_,elTop:r,VDIRECTIONE:o}),l&&(i.scrollTop=l),t())},window.setTimeout(e,a))};function p(){v?h():(v=!0,_=u,c())}p()}}},{key:"toVector",value:function(t){return t.hasOwnProperty("z")?new fm.Vector3(t.x,t.y,t.z):new fm.Vector2(t.x,t.y)}},{key:"sleep",value:function(t){for(var e=(new Date).getTime(),n=0;n<1e7&&!((new Date).getTime()-e>t);n++);}}]),t}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(3)),a=r(n(260)),c=function(){function e(t){(0,o.default)(this,e),this._wayPoints=t||[]}return(0,s.default)(e,[{key:"drop",value:function(t){for(var e=-1,n=0;n<this._wayPoints.length;n++)if(this[n]==t){e=n;break}e<0||this._wayPoints.splice(e,1)}},{key:"cloneDrop",value:function(t){for(var e=[],n=0;n<this._wayPoints.length;n++)e.push(this._wayPoints[n]);for(var i=-1,r=0;r<e.length;r++)if(e[r]==t){i=r;break}if(!(i<0))return e.splice(i,1),e}},{key:"toArray",value:function(){for(var t=[],e=0;e<this._wayPoints.length;e++)t.push(this._wayPoints[e]);return t}},{key:"len",value:function(){return this._wayPoints.length}}]),e}(),n=function(){function e(t){(0,o.default)(this,e),0!=t.length&&(this._adjTable=new a.default(t))}return(0,s.default)(e,[{key:"setSId",value:function(t){return this._sId=t,this}},{key:"setEId",value:function(t){return this._eId=t,this}},{key:"setWayNodes",value:function(t){return this._wayPoints=t,this}},{key:"route",value:function(){this._result=this._route(this._sId,this._eId,this._wayPoints)}},{key:"getResult",value:function(){return this._result}},{key:"_route",value:function(t,e,n){if(0==n.length){if(t==e)return{route:[t],dist:0};var i=this._adjTable.lookup(t,e);if(null!=i)return{route:[t,e],dist:i};var r=this._adjTable.enhance(t,e,this._wayPoints);return{route:[t,r.transit,e],dist:r.dist}}for(var o=new c(n),s=o.toArray(),a=1/0,u=[],l=0;l<o.len();l++){var d,h=s[l],f=this._route(t,h,o.cloneDrop(h));null!=f.dist&&(d=this._adjTable.lookup(h,e),null==d?(r=this._adjTable.enhance(h,e,this._wayPoints),d=r.dist,d+f.dist<a&&(a=d+f.dist,f.route.push(r.transit),f.route.push(e),u=f.route)):d+f.dist<a&&(a=d+f.dist,f.route.push(e),u=f.route))}return{route:u,dist:a}}}]),e}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.SmallQueue=a,e.Queue=void 0,n(262);var o=r(n(2)),s=r(n(3)),n=function(){function t(){(0,o.default)(this,t),this.items=[]}return(0,s.default)(t,[{key:"enqueue",value:function(t){this.items.push(t)}},{key:"dequeue",value:function(){return this.isEmpty()?"Underflow":this.items.shift()}},{key:"front",value:function(){return this.isEmpty()?"No elements in Queue":this.items[0]}},{key:"isEmpty",value:function(){return 0==this.items.length}},{key:"printQueue",value:function(){for(var t="",e=0;e<this.items.length;e++)t+=this.items[e]+" ";return t}}]),t}();function a(){var e=[],n=0;this.getLength=function(){return e.length-n},this.isEmpty=function(){return 0==e.length},this.enqueue=function(t){e.push(t)},this.dequeue=function(){if(0!=e.length){var t=e[n];return 2*++n>=e.length&&(e=e.slice(n),n=0),t}},this.peek=function(){return 0<e.length?e[n]:void 0}}e.Queue=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.Vector3=d,n(88);var o,s,a,u,r=r(n(15)),l=n(97),n=n(149);function d(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}(0,r.default)(d.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:(u=new n.Quaternion,function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(u.setFromEuler(t))}),applyAxisAngle:(a=new n.Quaternion,function(t,e){return this.applyQuaternion(a.setFromAxisAngle(t,e))}),applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,t=t.elements;return this.x=t[0]*e+t[3]*n+t[6]*i,this.y=t[1]*e+t[4]*n+t[7]*i,this.z=t[2]*e+t[5]*n+t[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements,t=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*t,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*t,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*t,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,s=t.z,a=t.w,u=a*e+o*i-s*n,l=a*n+s*e-r*i,t=a*i+r*n-o*e,i=-r*e-o*n-s*i;return this.x=u*a+i*-r+l*-s-t*-o,this.y=l*a+i*-o+t*-r-u*-s,this.z=t*a+i*-s+u*-o-l*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,i=this.z,t=t.elements;return this.x=t[0]*e+t[4]*n+t[8]*i,this.y=t[1]*e+t[5]*n+t[9]*i,this.z=t[2]*e+t[6]*n+t[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,o=e.x,t=e.y,e=e.z;return this.x=i*e-r*t,this.y=r*o-n*e,this.z=n*t-i*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:(s=new d,function(t){return s.copy(this).projectOnVector(t),this.sub(s)}),reflect:(o=new d,function(t){return this.sub(o.copy(t).multiplyScalar(2*this.dot(t)))}),angleTo:function(t){return t=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq()),Math.acos(l._Math.clamp(t,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,t=this.z-t.z;return e*e+n*n+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}})},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.Quaternion=s;var e=r(n(15)),_=r(n(265)),r=r(n(268)),o=n(97);function s(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1}(0,e.default)(s,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,o,s){var a=n[i+0],u=n[i+1],l=n[i+2],d=n[i+3],h=r[o+0],f=r[o+1],c=r[o+2],p=r[o+3];d===p&&a===h&&u===f&&l===c||(n=1-s,i=a*h+u*f+l*c+d*p,r=0<=i?1:-1,o=1-i*i,o>_.default&&(o=Math.sqrt(o),i=Math.atan2(o,i*r),n=Math.sin(n*i)/o,s=Math.sin(s*i)/o),r*=s,a=a*n+h*r,u=u*n+f*r,l=l*n+c*r,d=d*n+p*r,n===1-s&&(s=1/Math.sqrt(a*a+u*u+l*l+d*d),a*=s,u*=s,l*=s,d*=s)),t[e]=a,t[e+1]=u,t[e+2]=l,t[e+3]=d}}),(0,r.default)(s.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),(0,e.default)(s.prototype,{isQuaternion:!0,set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,i=t._y,r=t._z,o=t.order,s=Math.cos,a=Math.sin,u=s(n/2),t=s(i/2),s=s(r/2),n=a(n/2),i=a(i/2),r=a(r/2);return"XYZ"===o?(this._x=n*t*s+u*i*r,this._y=u*i*s-n*t*r,this._z=u*t*r+n*i*s,this._w=u*t*s-n*i*r):"YXZ"===o?(this._x=n*t*s+u*i*r,this._y=u*i*s-n*t*r,this._z=u*t*r-n*i*s,this._w=u*t*s+n*i*r):"ZXY"===o?(this._x=n*t*s-u*i*r,this._y=u*i*s+n*t*r,this._z=u*t*r+n*i*s,this._w=u*t*s-n*i*r):"ZYX"===o?(this._x=n*t*s-u*i*r,this._y=u*i*s+n*t*r,this._z=u*t*r-n*i*s,this._w=u*t*s+n*i*r):"YZX"===o?(this._x=n*t*s+u*i*r,this._y=u*i*s+n*t*r,this._z=u*t*r-n*i*s,this._w=u*t*s-n*i*r):"XZY"===o&&(this._x=n*t*s-u*i*r,this._y=u*i*s-n*t*r,this._z=u*t*r+n*i*s,this._w=u*t*s+n*i*r),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,e=Math.sin(n);return this._x=t.x*e,this._y=t.y*e,this._z=t.z*e,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,i=n[0],r=n[4],o=n[8],s=n[1],a=n[5],u=n[9],l=n[2],d=n[6],t=n[10],n=i+a+t;return 0<n?(e=.5/Math.sqrt(n+1),this._w=.25/e,this._x=(d-u)*e,this._y=(o-l)*e,this._z=(s-r)*e):a<i&&t<i?(e=2*Math.sqrt(1+i-a-t),this._w=(d-u)/e,this._x=.25*e,this._y=(r+s)/e,this._z=(o+l)/e):t<a?(e=2*Math.sqrt(1+a-i-t),this._w=(o-l)/e,this._x=(r+s)/e,this._y=.25*e,this._z=(u+d)/e):(e=2*Math.sqrt(1+t-i-a),this._w=(s-r)/e,this._x=(o+l)/e,this._y=(u+d)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=1e-6,i=t.dot(e)+1;return i<n?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x),this._w=i,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(o._Math.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);return 0===n||(n=Math.min(1,e/n),this.slerp(t,n)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z,o=t._w,s=e._x,a=e._y,t=e._z,e=e._w;return this._x=n*e+o*s+i*t-r*a,this._y=i*e+o*a+r*s-n*t,this._z=r*e+o*t+n*a-i*s,this._w=o*e-n*s-i*a-r*t,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,o=this._w,s=o*t._w+n*t._x+i*t._y+r*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),1<=s)return this._w=o,this._x=n,this._y=i,this._z=r,this;if(t=1-s*s,t<=_.default){var a=1-e;return this._w=a*o+e*this._w,this._x=a*n+e*this._x,this._y=a*i+e*this._y,this._z=a*r+e*this._z,this.normalize(),this._onChangeCallback(),this}return a=Math.sqrt(t),t=Math.atan2(a,s),s=Math.sin((1-e)*t)/a,a=Math.sin(e*t)/a,this._w=o*s+this._w*a,this._x=n*s+this._x*a,this._y=i*s+this._y*a,this._z=r*s+this._z*a,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}})},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o,s=r(n(153)),a=r(n(154)),u=r(n(41)),l=r(n(65)),d=n(148),h=n(97),f=n(271),i=n(149),n=r(n(272)),c=window.fengmap||{},p={VERSION:s.default.VERSION,BUILD:s.default.BUILD,FMNaviAnalyser:a.default,FMNaviMode:u.default,FMNaviPriority:l.default};for(o in p)p.hasOwnProperty(o)&&(c[o]=p[o]);window.fengmap=c,window.DEBUG=!1,window.Geo=window.Geo||{Vector3:d.Vector3,_Math:h._Math,Matrix4:f.Matrix4,Quaternion:i.Quaternion,Centroid:n.default},window.Calculator=window.Geo,n=c,e.default=n},function(t,e,n){n(152);var i=n(4).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},function(t,e,n){var i=n(6);i(i.S+i.F*!n(14),"Object",{defineProperty:n(18).f})},function(t,e,n){"use strict";n=n(0),n(e,"__esModule",{value:!0}),e.default=void 0,n={VERSION:"2.7.3",BUILD:7},e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var l=r(n(15)),o=r(n(103)),s=r(n(29)),a=r(n(2)),u=r(n(3)),d=r(n(12)),h=n(198),f=r(n(199)),c=r(n(41)),p=r(n(65)),_=r(n(91)),v=r(n(49)),y=r(n(221));n(145),n=function(){function e(t){(0,a.default)(this,e),this._options={},this._navi=null,this._naviResults=[],"function"==typeof h.FMMap&&t instanceof h.FMMap&&(this._map=null,this.init(t)),this._endDoor=null}return(0,u.default)(e,[{key:"navi",get:function(){this._navi}},{key:"passPts",set:function(t){this._navi.passPts=t}},{key:"routePassingPoints",value:function(t,e){e=this._navi.routePassingPoints(t,e),e==v.default.ROUTE_SUCCESS?(this._naviResults=this._navi.getRouteResult(),this.failedInsertedPts=this._navi.failedInsertedPts):this._naviResults=[]}},{key:"naviToDoor",get:function(){return this._navi.naviToDoor},set:function(t){this._navi.naviToDoor=t}},{key:"analyzeNavi",value:function(t,e,n,i,r,o){return o=this._navi.route(t,e,n,i,r||c.default.MODULE_SHORTEST,o||p.default.PRIORITY_DEFAULT),o==v.default.ROUTE_SUCCESS?(this._naviResults=this._navi.getRouteResult(),this._endDoor=this._navi._endDoor):this._naviResults=[],o}},{key:"init",value:function(t){this._map=t,this._navi=new y.default({}),this._navi.initByMap(t)}},{key:"initByOptions",value:function(t){this._navi=new y.default({}),this._navi.initByOptions(t)}},{key:"initByScene",value:function(t){this._navi=new y.default({}),this._navi.initByScene(t)}},{key:"dispose",value:function(){this._map=null;for(var t=0;t<this._naviResults.length;t++){var e=this._naviResults[t];e.dispose(),e=null}this._naviResults=[],this._navi&&(this._navi.dispose(),this._navi=null)}},{key:"getNaviResults",value:function(){return this._naviResults}},{key:"getNaviResult",value:function(t){return this.getNaviResults()}},{key:"getRouteAllPoints",value:function(t){var e=t||this._naviResults;if(!this._isNaviResultsValide(e))return[];var n,i=[];for(n in e)e[n].getPointList&&i.push.apply(i,(0,s.default)(e[n].getPointList()));return i}},{key:"getRouteLineSegments",value:function(t){var e=t||this._naviResults;if(!this._isNaviResultsValide(e))return[];for(var n=[],i=0;i<e.length;i++){var r=e[i],o=r.groupId,s=r.pointList,a=new f.default;a.groupId=o,a.points=[];for(var u=0;u<s.length;u++)a.points.push((0,l.default)({},s[u]));n.push(a)}return n}},{key:"getRouteDistance",value:function(t){if(t=t||this._naviResults,!this._isNaviResultsValide(t))return 0;var e=this.getRouteAllPoints(t);if(0==e.length)return 0;for(var n=0,i=0;i<e.length-1;i++)n+=d.default.distanceOfTwoPoints(e[i],e[i+1]);return n}},{key:"getRouteGroupIds",value:function(t){var e=t||this._naviResults;if(!this._isNaviResultsValide(e))return[];var n,i=[];for(n in e)!e[n].groupId||0!=n&&i[i.length-1]==e[n].groupId||i.push(e[n].groupId);return i}},{key:"getRouteGroupPoints",value:function(t,e){var n=e||this._naviResults;if(!this._isNaviResultsValide(n))return[];var i,r=[];for(i in n)n[i].groupId&&n[i].groupId==t&&(r=r.concat(n[i].getPointList()));return r}},{key:"pathConstraint",value:function(t,e){return this._navi?this._navi.pathConstraint(t,e):null}},{key:"losedPoints",get:function(){return this._navi.failedInsertedPts}},{key:"_getNaviResults",value:function(t){for(var e,n=[],i=0;i<t.length;i++)null!=t[i].groupId&&(e=new _.default(t[i].groupId,t[i].length,t[i].pointVector,t[i].nodeVector),n.push(e));return n}},{key:"_isNaviResultsValide",value:function(t){if(!(0,o.default)(t))return!1;if(0==t.length)return!1;for(var e=0;e<t.length;e++)if(!t[e]instanceof _.default)return!1;return!0}}]),e}(),e.default=n},function(t,e,n){n(156),t.exports=n(4).Object.assign},function(t,e,n){var i=n(6);i(i.S+i.F,"Object",{assign:n(157)})},function(t,e,n){"use strict";var f=n(14),c=n(52),p=n(75),_=n(56),v=n(44),y=n(101),r=Object.assign;t.exports=!r||n(20)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=r({},t)[n]||Object.keys(r({},e)).join("")!=i})?function(t,e){for(var n=v(t),i=arguments.length,r=1,o=p.f,s=_.f;r<i;)for(var a,u=y(arguments[r++]),l=o?c(u).concat(o(u)):c(u),d=l.length,h=0;h<d;)a=l[h++],f&&!s.call(u,a)||(n[a]=u[a]);return n}:r},function(t,e,n){var u=n(35),l=n(102),d=n(159);t.exports=function(a){return function(t,e,n){var i,r=u(t),o=l(r.length),s=d(n,o);if(a&&e!=e){for(;s<o;)if(i=r[s++],i!=i)return!0}else for(;s<o;s++)if((a||s in r)&&r[s]===e)return a||s||0;return!a&&-1}}},function(t,e,n){var i=n(71),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},function(t,e,n){n(161),t.exports=n(4).Array.isArray},function(t,e,n){var i=n(6);i(i.S,"Array",{isArray:n(104)})},function(t,e,n){var i=n(103),r=n(105);function o(t){if(i(t))return r(t)}t.exports=o,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var i=n(106),r=n(111),o=n(115);function s(t){if(void 0!==i&&null!=t[r]||null!=t["@@iterator"])return o(t)}t.exports=s,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){n(165),n(170),n(171),n(172),t.exports=n(4).Symbol},function(t,e,n){"use strict";var i=n(9),s=n(28),r=n(14),o=n(6),a=n(107),u=n(166).KEY,l=n(20),d=n(73),h=n(76),f=n(55),c=n(11),p=n(77),_=n(78),v=n(167),y=n(104),g=n(27),I=n(19),T=n(44),x=n(35),N=n(69),m=n(43),R=n(57),E=n(169),M=n(110),k=n(75),P=n(18),L=n(52),A=M.f,O=P.f,S=E.f,b=i.Symbol,w=i.JSON,C=w&&w.stringify,D="prototype",F=c("_hidden"),z=c("toPrimitive"),V={}.propertyIsEnumerable,j=d("symbol-registry"),G=d("symbols"),U=d("op-symbols"),B=Object[D],Z="function"==typeof b&&!!k.f,H=i.QObject,Y=!H||!H[D]||!H[D].findChild,q=r&&l(function(){return 7!=R(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=A(B,e);i&&delete B[e],O(t,e,n),i&&t!==B&&O(B,e,i)}:O,X=function(t){var e=G[t]=R(b[D]);return e._k=t,e},W=Z&&"symbol"==typeof b.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof b},K=function(t,e,n){return t===B&&K(U,e,n),g(t),e=N(e,!0),g(n),s(G,e)?(n.enumerable?(s(t,F)&&t[F][e]&&(t[F][e]=!1),n=R(n,{enumerable:m(0,!1)})):(s(t,F)||O(t,F,m(1,{})),t[F][e]=!0),q(t,e,n)):O(t,e,n)},Q=function(t,e){g(t);for(var n,i=v(e=x(e)),r=0,o=i.length;r<o;)K(t,n=i[r++],e[n]);return t},J=function(t,e){return void 0===e?R(t):Q(R(t),e)},$=function(t){var e=V.call(this,t=N(t,!0));return!(this===B&&s(G,t)&&!s(U,t))&&(!(e||!s(this,t)||!s(G,t)||s(this,F)&&this[F][t])||e)},tt=function(t,e){if(t=x(t),e=N(e,!0),t!==B||!s(G,e)||s(U,e)){var n=A(t,e);return!n||!s(G,e)||s(t,F)&&t[F][e]||(n.enumerable=!0),n}},d=function(t){for(var e,n=S(x(t)),i=[],r=0;n.length>r;)s(G,e=n[r++])||e==F||e==u||i.push(e);return i},H=function(t){for(var e,n=t===B,i=S(n?U:x(t)),r=[],o=0;i.length>o;)!s(G,e=i[o++])||n&&!s(B,e)||r.push(G[e]);return r};Z||(b=function(){if(this instanceof b)throw TypeError("Symbol is not a constructor!");var e=f(0<arguments.length?arguments[0]:void 0),n=function(t){this===B&&n.call(U,t),s(this,F)&&s(this[F],e)&&(this[F][e]=!1),q(this,e,m(1,t))};return r&&Y&&q(B,e,{configurable:!0,set:n}),X(e)},a(b[D],"toString",function(){return this._k}),M.f=tt,P.f=K,n(109).f=E.f=d,n(56).f=$,k.f=H,r&&!n(54)&&a(B,"propertyIsEnumerable",$,!0),p.f=function(t){return X(c(t))}),o(o.G+o.W+o.F*!Z,{Symbol:b});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)c(et[nt++]);for(var it=L(c.store),rt=0;it.length>rt;)_(it[rt++]);o(o.S+o.F*!Z,"Symbol",{for:function(t){return s(j,t+="")?j[t]:j[t]=b(t)},keyFor:function(t){if(!W(t))throw TypeError(t+" is not a symbol!");for(var e in j)if(j[e]===t)return e},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),o(o.S+o.F*!Z,"Object",{create:J,defineProperty:K,defineProperties:Q,getOwnPropertyDescriptor:tt,getOwnPropertyNames:d,getOwnPropertySymbols:H}),H=l(function(){k.f(1)}),o(o.S+o.F*H,"Object",{getOwnPropertySymbols:function(t){return k.f(T(t))}}),w&&o(o.S+o.F*(!Z||l(function(){var t=b();return"[null]"!=C([t])||"{}"!=C({a:t})||"{}"!=C(Object(t))})),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;r<arguments.length;)i.push(arguments[r++]);if(n=e=i[1],(I(e)||void 0!==t)&&!W(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!W(e))return e}),i[1]=e,C.apply(w,i)}}),b[D][z]||n(34)(b[D],z,b[D].valueOf),h(b,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){var i=n(55)("meta"),r=n(19),o=n(28),s=n(18).f,a=0,u=Object.isExtensible||function(){return!0},l=!n(20)(function(){return u(Object.preventExtensions({}))}),d=function(t){s(t,i,{value:{i:"O"+ ++a,w:{}}})},h=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!u(t))return"F";if(!e)return"E";d(t)}return t[i].i},f=function(t,e){if(!o(t,i)){if(!u(t))return!0;if(!e)return!1;d(t)}return t[i].w},n=function(t){return l&&c.NEED&&u(t)&&!o(t,i)&&d(t),t},c=t.exports={KEY:i,NEED:!1,fastKey:h,getWeak:f,onFreeze:n}},function(t,e,n){var a=n(52),u=n(75),l=n(56);t.exports=function(t){var e=a(t),n=u.f;if(n)for(var i,r=n(t),o=l.f,s=0;r.length>s;)o.call(t,i=r[s++])&&e.push(i);return e}},function(t,e,n){n=n(9).document,t.exports=n&&n.documentElement},function(t,e,n){var i=n(35),r=n(109).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(t){try{return r(t)}catch(t){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?a(t):r(i(t))}},function(t,e){},function(t,e,n){n(78)("asyncIterator")},function(t,e,n){n(78)("observable")},function(t,e,n){n(112),n(176),t.exports=n(77).f("iterator")},function(t,e,n){var s=n(71),a=n(53);t.exports=function(o){return function(t,e){var n,i=String(a(t)),r=s(e),t=i.length;return r<0||t<=r?o?"":void 0:(e=i.charCodeAt(r),e<55296||56319<e||r+1===t||(n=i.charCodeAt(r+1))<56320||57343<n?o?i.charAt(r):e:o?i.slice(r,r+2):n-56320+(e-55296<<10)+65536)}}},function(t,e,n){"use strict";var i=n(57),r=n(43),o=n(76),s={};n(34)(s,n(11)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(s,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){n(177);for(var i=n(9),r=n(34),o=n(45),s=n(11)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<a.length;u++){var l=a[u],d=i[l],d=d&&d.prototype;d&&!d[s]&&r(d,s,l),o[l]=o.Array}},function(t,e,n){"use strict";var i=n(178),r=n(179),o=n(45),s=n(35);t.exports=n(113)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){n(112),n(181),t.exports=n(4).Array.from},function(t,e,n){"use strict";var h=n(67),i=n(6),f=n(44),c=n(182),p=n(183),_=n(102),v=n(184),y=n(185);i(i.S+i.F*!n(187)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,r,o=f(t),s="function"==typeof this?this:Array,a=arguments.length,u=1<a?arguments[1]:void 0,l=void 0!==u,d=0,t=y(o);if(l&&(u=h(u,2<a?arguments[2]:void 0,2)),null==t||s==Array&&p(t))for(e=_(o.length),n=new s(e);d<e;d++)v(n,d,l?u(o[d],d):o[d]);else for(r=t.call(o),n=new s;!(i=r.next()).done;d++)v(n,d,l?c(r,u,[i.value,d],!0):i.value);return n.length=d,n}})},function(t,e,n){var r=n(27);t.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){throw n=e.return,void 0!==n&&r(n.call(e)),t}}},function(t,e,n){var i=n(45),r=n(11)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){"use strict";var i=n(18),r=n(43);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},function(t,e,n){var i=n(186),r=n(11)("iterator"),o=n(45);t.exports=n(4).getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e,n){var i=n(70),r=n(11)("toStringTag"),o="Arguments"==i(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(t=s(e=Object(t),r))?t:o?i(e):"Object"==(t=i(e))&&"function"==typeof e.callee?"Arguments":t}},function(t,e,n){var o=n(11)("iterator"),s=!1;try{var i=[7][o]();i.return=function(){s=!0},Array.from(i,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var n=!1;try{var i=[7],r=i[o]();r.next=function(){return{done:n=!0}},i[o]=function(){return r},t(i)}catch(t){}return n}},function(t,e,n){var i=n(115),r=n(105);function o(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?i(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}t.exports=o,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var r=n(21),o=n(191).set;t.exports=function(t,e,n){var i,e=e.constructor;return e!==n&&"function"==typeof e&&(i=e.prototype)!==n.prototype&&r(i)&&o&&o(t,i),t}},function(t,e,r){var n=r(21),i=r(22),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,i){try{i=r(58)(Function.call,r(80).f(Object.prototype,"__proto__").set,2),i(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,e){return o(t,e),n?t.__proto__=e:i(t,e),t}}({},!1):void 0),check:o}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var o=n(24),i=n(37),s=n(7),a=n(195),n="["+a+"]",u="​",r=RegExp("^"+n+n+"*"),l=RegExp(n+n+"*$"),n=function(t,e,n){var i={},r=s(function(){return!!a[t]()||u[t]()!=u}),e=i[t]=r?e(d):a[t];n&&(i[n]=e),o(o.P+o.F*r,"String",i)},d=n.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(r,"")),2&e&&(t=t.replace(l,"")),t};t.exports=n},function(t,e,n){t.exports=n(83)("native-function-to-string",Function.toString)},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var s=n(23),a=n(22),u=n(121);t.exports=n(10)?Object.defineProperties:function(t,e){a(t);for(var n,i=u(e),r=i.length,o=0;o<r;)s.f(t,n=i[o++],e[n]);return t}},function(t,e,n){"use strict";var i=n(7);t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){"use strict";var i=n(0);i(e,"__esModule",{value:!0}),e.BoundingBox=e.FMMapCoord=e.NaviService=e.NaviDataType=e.FMLanguageType=e.FMLocationMarker=e.FMLineMarker=e.FMImageMarker=e.FMUtil=e.DataManager=e.EventDispatcher=e.FMRouteCalcuResult=e.FMNaviPriority=e.FMNaviMode=e.FMSegment=e.FMMap=e.Map=e.Graphics=void 0;var r={},n={};window.fengmap&&(n=window.fengmap,r=window.fengmap.inner||{}),i=r.Graphics||{},e.Graphics=i,i=n.FMMap||{},e.FMMap=i,n=n.Map||{},e.Map=n,n=r.FMSegment||{},e.FMSegment=n,n=r.FMNaviMode||{},e.FMNaviMode=n,n=r.FMNaviPriority||{},e.FMNaviPriority=n,n=r.FMRouteCalcuResult||{},e.FMRouteCalcuResult=n,n=r.EventDispatcher||{},e.EventDispatcher=n,n=r.DataManager||{},e.DataManager=n,n=r.FMUtil||{},e.FMUtil=n,n=r.FMImageMarker||{},e.FMImageMarker=n,n=r.FMLineMarker||{},e.FMLineMarker=n,n=r.FMLocationMarker||{},e.FMLocationMarker=n,n=r.FMLanguageType||{},e.FMLanguageType=n,n=r.NaviDataType||{},e.NaviDataType=n,n=r.NaviService||{},e.NaviService=n,n=r.FMMapCoord||{},e.FMMapCoord=n,r=r.BoundingBox||{},e.BoundingBox=r},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(29)),o=r(n(2)),s=r(n(3)),u=r(n(200)),l=r(n(12)),n=function(){function e(t){(0,o.default)(this,e),this._points=t||null,this._groupId=0,this._lineDis=[],this._linePoints=null,this._screenPoints=[],this._screenDis=[],this._radiusPoint=[],this._radiuInit=!1,this._uvys=null,this._minRadius=1,this.needSmooth=!0}return(0,s.default)(e,[{key:"initSegement",value:function(t,e){"number"!=typeof e&&(e=this._minRadius),this._linePoints=this.pointsToLinePnts(t,e),this._uvys=this.computerUVY()}},{key:"pointsToRadius",value:function(t){for(var e,n,i=[],r=new u.default,o=0;o<this._points.length;o++)0<o&&o<this._points.length-1?(n=l.default.distanceOfTwoPoints(i[i.length-1],this._points[o]),e=l.default.distanceOfTwoPoints(this._points[o],this._points[o+1]),e=.5*(e<n?e:n),n=t,e<n&&(n=e),i.push.apply(i,(0,a.default)(r.computerArcLineByPoints(i[i.length-1],this._points[o],this._points[o+1],n||1,12)))):i.push(this._points[o]);this._radiusPoint=i,this._radiuInit=!0}},{key:"pointsToLinePnts",value:function(t,e){this.needSmooth?this._radiuInit||this.pointsToRadius(e):(e=[],e.push.apply(e,(0,a.default)(this._points)),this._radiusPoint=e);for(var n=[],i=0;i<this._radiusPoint.length;i++){var r=this._radiusPoint[i].x-t.x,o=this._radiusPoint[i].z,s=-this._radiusPoint[i].y+t.y;n.push(r,o,s),0!==i&&(o=new fm.Vector3(this._radiusPoint[i].x,this._radiusPoint[i].y,this._radiusPoint[i].z),s=new fm.Vector3(this._radiusPoint[i-1].x,this._radiusPoint[i-1].y,this._radiusPoint[i-1].z),this._lineDis.push(o.distanceTo(s)))}return n}},{key:"getIndexDis",value:function(t){for(var e=0,n=0;n<this._lineDis.length;n++)n<t&&(e+=this._lineDis[n]);return e}},{key:"computerUVY",value:function(){for(var t,e=[],n=this.getIndexDis(this._lineDis.length),i=0;i<this._radiusPoint.length;i++)0===i?e.push(0):i===this._radiusPoint.length-1?e.push(1):(t=this.getIndexDis(i)/n,e.push(t),e.push(t));return e}},{key:"computeScreenCoord",value:function(t,e,n,i){for(var r=[],o=0,s=[],a=t.matrixWorldInverse,u=0;u<this._linePoints.length;u+=3){var l=this._linePoints[u],d=this._linePoints[u+1],h=this._linePoints[u+2],h=new fm.Vector3(l+i.x,d+i.y,h+i.z),h=h.applyMatrix4(a);h.z,t.near,h=h.applyMatrix4(t.projectionMatrix),h=new fm.Vector2(e/2+e/2*h.x,n/2-n/2*h.y),r.push(h),2<u&&(h=h.distanceTo(r[Math.round(u/3)-1]),o+=h,s.push(h))}return this._screenPoints=r,this._screenDis=s,o}},{key:"_calcMinRadius",value:function(){if(this.points){this._minRadius=1;for(var t=0;t<this._points.length-1;t++){var e=this._points[t],n=this._points[t+1],n=.368*l.default.distanceOfTwoPoints(e,n);this._minRadius>n&&(this._minRadius=n)}}}},{key:"points",get:function(){return this._points},set:function(t){this._points=t}},{key:"groupId",get:function(){return this._groupId},set:function(t){this._groupId=t}},{key:"allLength",get:function(){return this.getIndexDis(this._lineDis.length)}},{key:"linePoints",get:function(){return this._linePoints}},{key:"uvys",get:function(){return this._uvys}}]),e}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(201),n(214),n(88);var o=r(n(2)),s=r(n(3)),n=(r(n(216)),function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,[{key:"createGeometry",value:function(t,e,n,i){for(var r=new Float32Array((e+1)*n*3),o=new Float32Array((e+1)*n*2),s=new Uint16Array(e*n*2*3),a=0;a<e+1;a++)for(var u=a/e*t,l=4/Math.sqrt(2*Math.PI)*Math.exp(-u*u/2/i)/Math.sqrt(i),d=0;d<n;d++){var h=d/n*Math.PI*2,f=u*Math.sin(h),c=u*Math.cos(h),p=a*n*3+3*d;r[p]=c,r[p+1]=l,r[p+2]=f;var _=a*n*2+2*d;o[_]=d/n,o[_+1]=a/e,a<e&&(h=void 0,c=void 0,p=void 0,f=void 0,_=a*n*6+6*d,h=a*n+d,c=d+1===n?a*n:h+1,p=h+n,f=c+n,s[_]=h,s[_+1]=c,s[_+2]=p,s[_+3]=c,s[_+4]=f,s[_+5]=p)}return{index:s,uv:o,vertice:r}}},{key:"computerArcLineByPoints",value:function(t,e,n,i,r){var o=(new fm.Vector3).copy(t).distanceTo(e),s=(new fm.Vector3).copy(n).distanceTo(e),a=(new fm.Vector3).copy(t),u=(new fm.Vector3).copy(t),l=[];i<o&&(a=(new fm.Vector3).copy(e).add((new fm.Vector3).copy(t).sub(e).normalize().multiplyScalar(i)),l.push(a)),i<s&&(u=(new fm.Vector3).copy(e).add((new fm.Vector3).copy(n).sub(e).normalize().multiplyScalar(i)));for(var d=new fm.QuadraticBezierCurve3(a,e,u),h=0;h<r-1;h++){var f=(h+1)/r,f=d.getPoint(f);l.push(f)}return i<s&&l.push(u),l}}]),t}()),n=n;e.default=n},function(t,e,n){n(86)("Float32",4,function(i){return function(t,e,n){return i(this,t,e,n)}})},function(t,e,n){"use strict";var i=n(8),r=n(10),o=n(63),s=n(123),a=n(13),u=n(124),l=n(7),d=n(125),h=n(38),f=n(17),c=n(126),p=n(81).f,_=n(23).f,v=n(127),y=n(87),g="ArrayBuffer",I="DataView",T="prototype",x="Wrong length!",N="Wrong index!",m=i[g],R=i[I],E=i.Math,M=i.RangeError,k=i.Infinity,P=m,L=E.abs,A=E.pow,O=E.floor,S=E.log,b=E.LN2,n="buffer",i="byteLength",E="byteOffset",w=r?"_b":n,C=r?"_l":i,D=r?"_o":E;function F(t,e,n){var i,r,o=new Array(n),s=8*n-e-1,a=(1<<s)-1,u=a>>1,l=23===e?A(2,-24)-A(2,-77):0,d=0,h=t<0||0===t&&1/t<0?1:0;for(t=L(t),t!=t||t===k?(r=t!=t?1:0,i=a):(i=O(S(t)/b),t*(n=A(2,-i))<1&&(i--,n*=2),t+=1<=i+u?l/n:l*A(2,1-u),2<=t*n&&(i++,n/=2),a<=i+u?(r=0,i=a):1<=i+u?(r=(t*n-1)*A(2,e),i+=u):(r=t*A(2,u-1)*A(2,e),i=0));8<=e;o[d++]=255&r,r/=256,e-=8);for(i=i<<e|r,s+=e;0<s;o[d++]=255&i,i/=256,s-=8);return o[--d]|=128*h,o}function z(t,e,n){var i,r=8*n-e-1,o=(1<<r)-1,s=o>>1,a=r-7,u=n-1,n=t[u--],l=127&n;for(n>>=7;0<a;l=256*l+t[u],u--,a-=8);for(i=l&(1<<-a)-1,l>>=-a,a+=e;0<a;i=256*i+t[u],u--,a-=8);if(0===l)l=1-s;else{if(l===o)return i?NaN:n?-k:k;i+=A(2,e),l-=s}return(n?-1:1)*i*A(2,l-e)}function V(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function j(t){return[255&t]}function G(t){return[255&t,t>>8&255]}function U(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function B(t){return F(t,52,8)}function Z(t){return F(t,23,4)}function H(t,e,n){_(t[T],e,{get:function(){return this[n]}})}function Y(t,e,n,i){var r=+n,n=c(r);if(n+e>t[C])throw M(N);return r=t[w]._b,t=n+t[D],e=r.slice(t,t+e),i?e:e.reverse()}function q(t,e,n,i,r,o){if(n=+n,n=c(n),n+e>t[C])throw M(N);for(var s=t[w]._b,a=n+t[D],u=i(+r),l=0;l<e;l++)s[a+l]=u[o?l:e-l-1]}if(s.ABV){if(!l(function(){m(1)})||!l(function(){new m(-1)})||l(function(){return new m,new m(1.5),new m(NaN),m.name!=g})){for(var X,m=function(t){return d(this,m),new P(c(t))},W=m[T]=P[T],K=p(P),Q=0;K.length>Q;)(X=K[Q++])in m||a(m,X,P[X]);o||(W.constructor=m)}var W=new R(new m(2)),J=R[T].setInt8;W.setInt8(0,2147483648),W.setInt8(1,2147483649),!W.getInt8(0)&&W.getInt8(1)||u(R[T],{setInt8:function(t,e){J.call(this,t,e<<24>>24)},setUint8:function(t,e){J.call(this,t,e<<24>>24)}},!0)}else m=function(t){d(this,m,g),t=c(t),this._b=v.call(new Array(t),0),this[C]=t},R=function(t,e,n){d(this,R,I),d(t,m,I);var i=t[C],e=h(e);if(e<0||i<e)throw M("Wrong offset!");if(n=void 0===n?i-e:f(n),i<e+n)throw M(x);this[w]=t,this[D]=e,this[C]=n},r&&(H(m,i,"_l"),H(R,n,"_b"),H(R,i,"_l"),H(R,E,"_o")),u(R[T],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){return t=Y(this,2,t,arguments[1]),(t[1]<<8|t[0])<<16>>16},getUint16:function(t){return t=Y(this,2,t,arguments[1]),t[1]<<8|t[0]},getInt32:function(t){return V(Y(this,4,t,arguments[1]))},getUint32:function(t){return V(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return z(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return z(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){q(this,1,t,j,e)},setUint8:function(t,e){q(this,1,t,j,e)},setInt16:function(t,e){q(this,2,t,G,e,arguments[2])},setUint16:function(t,e){q(this,2,t,G,e,arguments[2])},setInt32:function(t,e){q(this,4,t,U,e,arguments[2])},setUint32:function(t,e){q(this,4,t,U,e,arguments[2])},setFloat32:function(t,e){q(this,4,t,Z,e,arguments[2])},setFloat64:function(t,e){q(this,8,t,B,e,arguments[2])}});y(m,g),y(R,I),a(R[T],s.VIEW,!0),e[g]=m,e[I]=R},function(t,e,n){var i=n(40),r=n(5)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){var i=n(64),r=n(5)("iterator"),o=n(40);t.exports=n(62).getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e,n){var i=n(206);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){var i=n(21),r=n(207),o=n(5)("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&(e=e[o],null===e&&(e=void 0))),void 0===e?Array:e}},function(t,e,n){var i=n(36);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var y=n(63),g=n(24),I=n(25),T=n(13),x=n(40),N=n(210),m=n(87),R=n(128),E=n(5)("iterator"),M=!([].keys&&"next"in[].keys()),k="@@iterator",P="keys",L="values",A=function(){return this};t.exports=function(t,e,n,i,r,o,s){N(n,e,i);var a,u,l=function(t){if(!M&&t in c)return c[t];switch(t){case P:case L:return function(){return new n(this,t)}}return function(){return new n(this,t)}},d=e+" Iterator",h=r==L,f=!1,c=t.prototype,p=c[E]||c[k]||r&&c[r],_=p||l(r),v=r?h?l("entries"):_:void 0,i="Array"==e&&c.entries||p;if(i&&(t=R(i.call(new t)),t!==Object.prototype&&t.next&&(m(t,d,!0),y||"function"==typeof t[E]||T(t,E,A))),h&&p&&p.name!==L&&(f=!0,_=function(){return p.call(this)}),y&&!s||!M&&!f&&c[E]||T(c,E,_),x[e]=_,x[d]=A,r)if(a={values:h?_:l(L),keys:o?_:l(P),entries:v},s)for(u in a)u in c||I(c,u,a[u]);else g(g.P+g.F*(M||f),e,a);return a}},function(t,e,n){"use strict";var i=n(85),r=n(59),o=n(87),s={};n(13)(s,n(5)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(s,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var o=n(5)("iterator"),s=!1;try{var i=[7][o]();i.return=function(){s=!0},Array.from(i,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var n=!1;try{var i=[7],r=i[o]();r.next=function(){return{done:n=!0}},i[o]=function(){return r},t(i)}catch(t){}return n}},function(t,e,n){"use strict";var i=n(8),r=n(23),o=n(10),s=n(5)("species");t.exports=function(t){t=i[t],o&&t&&!t[s]&&r.f(t,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){"use strict";var u=n(39),l=n(46),d=n(17);t.exports=[].copyWithin||function(t,e){var n=u(this),i=d(n.length),r=l(t,i),o=l(e,i),e=2<arguments.length?arguments[2]:void 0,s=Math.min((void 0===e?i:l(e,i))-o,i-r),a=1;for(o<r&&r<o+s&&(a=-1,o+=s-1,r+=s-1);0<s--;)o in n?n[r]=n[o]:delete n[r],r+=a,o+=a;return n}},function(t,e,n){n(86)("Uint16",2,function(i){return function(t,e,n){return i(this,t,e,n)}})},function(t,e,n){var i=n(24),r=n(7),o=n(37),s=/"/g,a=function(t,e,n,i){var r=String(o(t)),t="<"+e;return""!==n&&(t+=" "+n+'="'+String(i).replace(s,"&quot;")+'"'),t+">"+r+"</"+e+">"};t.exports=function(e,t){var n={};n[e]=t(a),i(i.P+i.F*r(function(){var t=""[e]('"');return t!==t.toLowerCase()||3<t.split('"').length}),"String",n)}},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(32),n(132);var o,s,p,_,v,y,g,I,T,x,N,a=r(n(48)),n=(o=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],s=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],p=0,_=0,v=[2,0,0,0],y=function(t,e){for(var n=0,i=0,r=0,i=0;i<8;i++)1&e&&(n^=t),r=128&t,t<<=1,r&&(t^=27),e>>=1;return n},g=function(t,e,n){for(var i=0;i<4;i++)t[0+i]^=e[16*n+4*i],t[4+i]^=e[16*n+4*i+1],t[8+i]^=e[16*n+4*i+2],t[12+i]^=e[16*n+4*i+3]},I=function(t){for(var e,n,i,r=1;r<4;r++)for(n=0;n<r;){for(i=t[4*r+4-1],e=3;0<e;e--)t[4*r+e]=t[4*r+e-1];t[4*r+0]=i,n++}},T=function(t){for(var e,n,i,r=0;r<4;r++)for(e=0;e<4;e++)n=(240&t[4*r+e])>>4,i=15&t[4*r+e],t[4*r+e]=s[16*n+i]},x=function(t){for(var e=0;e<4;e++)t[e]=o[16*((240&t[e])>>4)+(15&t[e])]},N=function(t){return(0,a.default)(t,16)},{decryption:function(t,e){for(var n=Array(16),i=0;i<16;i++)n[i]=16*N(e.substr(2*i,1))+N(e.substr(2*i+1,1));for(var r=Array(16),i=0;i<16;i++)r[i]=16*N(t.substr(2*i,1))+N(t.substr(2*i+1,1));var o=Array(16);switch(i=[],n.length){default:case 16:p=4,_=10;break;case 24:p=6,_=12;break;case 32:p=8,_=14}for(var s=i=Array(16*(_+1)),a=Array(4),u=4*(_+1),l=0;l<p;l++)s[4*l+0]=n[4*l+0],s[4*l+1]=n[4*l+1],s[4*l+2]=n[4*l+2],s[4*l+3]=n[4*l+3];for(l=p;l<u;l++){if(a[0]=s[4*(l-1)+0],a[1]=s[4*(l-1)+1],a[2]=s[4*(l-1)+2],a[3]=s[4*(l-1)+3],0==l%p){for(var n=a,d=void 0,h=void 0,d=n[0],h=0;h<3;h++)n[h]=n[h+1];if(n[3]=d,x(a),n=l/p,1==n)v[0]=1;else if(1<n)for(v[0]=2,n--;0<n-1;)v[0]=y(v[0],2),n--;n=a,d=v,h=a,h[0]=n[0]^d[0],h[1]=n[1]^d[1],h[2]=n[2]^d[2],h[3]=n[3]^d[3]}else 6<p&&4==l%p&&x(a);s[4*l+0]=s[4*(l-p)+0]^a[0],s[4*l+1]=s[4*(l-p)+1]^a[1],s[4*l+2]=s[4*(l-p)+2]^a[2],s[4*l+3]=s[4*(l-p)+3]^a[3]}for(s=Array(16),a=0;a<4;a++)for(l=0;l<4;l++)s[4*a+l]=r[a+4*l];for(g(s,i,_),r=_-1;1<=r;r--)for(I(s),T(s),g(s,i,r),a=s,l=[14,9,13,11],u=h=void 0,n=Array(4),d=Array(4),u=0;u<4;u++){for(h=0;h<4;h++)n[h]=a[4*h+u];var h=l,f=n,c=d;for(c[0]=y(h[0],f[0])^y(h[3],f[1])^y(h[2],f[2])^y(h[1],f[3]),c[1]=y(h[1],f[0])^y(h[0],f[1])^y(h[3],f[2])^y(h[2],f[3]),c[2]=y(h[2],f[0])^y(h[1],f[1])^y(h[0],f[2])^y(h[3],f[3]),c[3]=y(h[3],f[0])^y(h[2],f[1])^y(h[1],f[2])^y(h[0],f[3]),h=0;h<4;h++)a[4*h+u]=d[h]}for(I(s),T(s),g(s,i,0),a=0;a<4;a++)for(l=0;l<4;l++)o[a+4*l]=s[4*a+l];for(r="",i=0;i<16;++i)s=o[i].toString(16),s.length<2&&(s="0"+s),r+=s;return r}}),n=n;e.default=n},function(t,e,n){n(10)&&"g"!=/./g.flags&&n(23).f(RegExp.prototype,"flags",{configurable:!0,get:n(89)})},function(t,e,n){n(219),t.exports=n(4).parseInt},function(t,e,n){var i=n(6),n=n(220);i(i.G+i.F*(parseInt!=n),{parseInt:n})},function(t,e,n){var i=n(9).parseInt,r=n(133).trim,n=n(90),o=/^[-+]?0[xX]/;t.exports=8!==i(n+"08")||22!==i(n+"0x16")?function(t,e){return t=r(String(t),3),i(t,e>>>0||(o.test(t)?16:10))}:i},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var s=r(n(48)),l=r(n(15));n(26),n(16),n(88),n(66);var x=r(n(29)),o=r(n(2)),a=r(n(3)),y=r(n(12)),u=r(n(41)),N=r(n(65)),m=r(n(49)),_=r(n(91)),d=r(n(222)),h=r(n(223)),p=r(n(50)),R=r(n(33)),v=r(n(42)),f=r(n(236)),c=r(n(94)),g=r(n(141)),I=r(n(254)),T=r(n(95)),E=r(n(255)),M=r(n(96)),k=r(n(256)),P=r(n(145)),L=r(n(258)),A=r(n(263)),n=function(){function e(t){(0,o.default)(this,e),this._options=new d.default(t),this._naviService=new h.default(this._options),this._startPoint=null,this._startGroupId=null,this._endPoint=null,this._endGroupId=null,this._startZone=null,this._mode=u.default.MODULE_SHORTEST,this._priority=N.default.PRIORITY_DEFAULT,this._graphs=new p.default,this._outlineAnalyseDijkstra=null,this._multiFloorDijkstraMap=new p.default,this._groupLiftNodes=new p.default,this._extentNodes=[],this._extentRoads=[],this._predictExtentNodes=[],this._predictLiftNodes=[],this._result=[],this._weightBias=1,this._liftLessWeightGain=.1,this._liftWeightGain=1,this._liftGreaterWightGain=10,this._escalatorLessWightGain=.1,this._escalatorWeightGain=1,this._escalatorGreaterWightGain=10,this._stairLessWeightGain=.1,this._stairWeightGain=1,this._stairGreaterWeightGain=10,this._scene=null,this._eDijKCollection=null,this._naviToDoor=!1,this._startModel=null,this._endModel=null,this._endDoor=null,this._assignedInfos=[]}return(0,a.default)(e,[{key:"initByMap",value:function(t){t&&t._currentSceneId&&t.dataManager&&(t=t.dataManager._sceneDecodeData[t._currentSceneId],t&&(this._naviService.setScene(t),this._scene=t,t=t.floors,0!=t.length&&(this._initNaviGraphs(t),this._initDijkstras(),this._eDijKCollection=new L.default,this._eDijKCollection.loadGraphs(this._graphs))))}},{key:"initByOptions",value:function(t){}},{key:"initByScene",value:function(t){t&&(this._scene=t,this._naviService.setScene(t),t=t.floors,0!=t.length&&(this._initNaviGraphs(t),this._initDijkstras()))}},{key:"initByNaviGraphs",value:function(t){t&&(this._initNaviGraphs(t),this._initDijkstras())}},{key:"dispose",value:function(){this._options=null,this._naviService=null,this._graphs.each(function(t,e){e.dispose()}),this._graphs.clear(),this._graphs=null,this._outlineAnalyseDijkstra.dispose(),this._outlineAnalyseDijkstra=null,this._multiFloorDijkstraMap.each(function(t,e){e.dispose()}),this._multiFloorDijkstraMap.clear(),this._multiFloorDijkstraMap=null,this._groupLiftNodes.clear(),this._groupLiftNodes=null,this._extentNodes=null,this._extentRoads=null,this._predictExtentNodes=null,this._predictLiftNodes=null,this._result=null}},{key:"assginedInfos",get:function(){return this._assignedInfos},set:function(t){this._assignedInfos=t}},{key:"passPts",set:function(t){this._passPts=t}},{key:"routePassingPoints",value:function(t,e){return this.naviAdapter=new A.default(t,e,this._passPts,this._eDijKCollection),this.naviAdapter.executeCalculation(),this._result=this.naviAdapter.routes,this._failedInsertedPts=this.naviAdapter.failInsertedPts,m.default.ROUTE_SUCCESS}},{key:"failedInsertedPts",get:function(){return this._failedInsertedPts}},{key:"calc_outlines_dist",value:function(t){for(var e=0,n=0;n<t.length-1;n++)e+=Math.abs(t[n].groupId-t[n+1].groupId);return{dist:e,seq:t}}},{key:"calc_sort_outlines_dist",value:function(t){for(var e=[],n=0;n<t.length;n++)e.push(this.calc_outlines_dist(t[n]));return e.sort(function(t,e){return t.dist-e.dist}),e}},{key:"sort_outlineinfos_length",value:function(t){t.sort(function(t,e){return t.seq.length-e.seq.length})}},{key:"naviToDoor",get:function(){return this._naviToDoor},set:function(t){this._naviToDoor=t}},{key:"routeAssigned",value:function(){for(var t in this._assignedInfos){var e=(0,s.default)(t),t=this._multiFloorDijkstraMap.get(e);t.assignedPts=this._assignedInfos[e],t.routeAssigned(),this._result.push({groupId:e,result:t.getRouteCalculateResult()})}}},{key:"route",value:function(t,f,e,c,p,n){var _=this;this.reset();var i=this._multiFloorDijkstraMap.get(t);if(!i)return m.default.ROUTE_FAILED_NO_DATA_START;var r=i._calcPointReachable(f);if(!r)return m.default.ROUTE_FAILED_NO_DATA_START;if(this._startModel=r.model,i=this._multiFloorDijkstraMap.get(e),!i)return m.default.ROUTE_FAILED_NO_DATA_END;if(i=i._calcPointReachable(c),!i)return m.default.ROUTE_FAILED_NO_DATA_END;this._endModel=i.model,this._result=[],this._startGroupId=t,this._startPoint=f,this._endGroupId=e,this._endPoint=c;var o=r.extentId,s=i.extentId,v=r.model,y=i.model;if(0==o||0==s)return m.default.ROUTE_FAILED_CANNOT_ARRIVE;var g=null;this._mode=p,this._switchToPriority(n);var a=function(){_._result=[];for(var t=[],e=[_._startPoint],n=0;n<_._predictExtentNodes.length-1;n++){var i=[],r=[];if(!_._calcPredictLiftNodes(_._predictExtentNodes[n],_._predictExtentNodes[n+1],e[e.length-1],i,r))return m.default.ROUTE_FAILED_CANNOT_ARRIVE;for(var o=!1,s=0;s<i.length;s++){var a,u=i[s]._wrappedNode,l=r[s]._wrappedNode,d=i[s].groupId,h=r[s].groupId;if(g=0==n?(a=_._multiFloorDijkstraMap.get(d),a._startModel=v,a.routeCalculate(f,u,p)):(a=_._multiFloorDijkstraMap.get(d),a.routeCalculate(t[t.length-1],u,p)),m.default.ROUTE_SUCCESS==g){if(u=_._multiFloorDijkstraMap.get(d),u=u.getRouteCalculateResult(),_._result.push({groupId:d,result:u}),t.push(l),e.push(l.point),o=!0,_._predictExtentNodes.length-2==n){if(u=_._multiFloorDijkstraMap.get(h),u._endModel=y,g=u.routeCalculate(l,c,p),m.default.ROUTE_SUCCESS!=g){_._result.splice(_._result.length-1,1),o=!1,e.splice(e.length-1,1),t.splice(t.length-1,1);continue}u=u.getRouteCalculateResult(),_._result.push({groupId:h,result:u})}if(m.default.ROUTE_SUCCESS==g)break}}if(!o)return m.default.ROUTE_FAILED_CANNOT_ARRIVE}return m.default.ROUTE_SUCCESS};if(t==e&&o==s){var u=this._multiFloorDijkstraMap.get(t);if(u._startModel=v,u._endModel=y,g=u.routeCalculate(f,c,p),g!=m.default.ROUTE_SUCCESS){for(var l=[],d=0;d<this._extentNodes.length;d++)this._extentNodes[d].groupId==t&&this._extentNodes[d].extentId==o&&l.push(this._extentNodes[d]);var h=this._enlarge_connected_nodes_num(l,l[0],1);if(0==h.length)return m.default.ROUTE_FAILED_OUTLINE;for(var I=this.calc_sort_outlines_dist(h),d=0;d<I.length;d++){this._predictExtentNodes=I[d].seq;var T=a();if(T==m.default.ROUTE_SUCCESS)return T}return m.default.ROUTE_FAILED_CANNOT_ARRIVE}u=u.getRouteCalculateResult(),this._result.push({groupId:t,result:u})}else{if(u=this._calcPredictExtentNodes(t,o,e,s),u!=m.default.ROUTE_SUCCESS)return m.default.ROUTE_FAILED_OUTLINE;if(this._predictExtentNodes.reverse(),u=a(),m.default.ROUTE_SUCCESS!=u){for(var x=null,N=null,d=0;d<this._extentNodes.length;d++)this._extentNodes[d].groupId==t&&this._extentNodes[d].extentId==o&&(x=this._extentNodes[d]),this._extentNodes[d].groupId==e&&this._extentNodes[d].extentId==s&&(N=this._extentNodes[d]);if(h=[],h.push([x]),this._enlarge_connected_nodes_norepeat(x,N,h),0==h.length)return m.default.ROUTE_FAILED_OUTLINE;for(I=this.calc_sort_outlines_dist(h),this.sort_outlineinfos_length(I),d=0;d<I.length;d++)if(this._predictExtentNodes=I[d].seq,T=a(),T==m.default.ROUTE_SUCCESS)return T;return m.default.ROUTE_FAILED_CANNOT_ARRIVE}}return m.default.ROUTE_SUCCESS}},{key:"getRouteResult",value:function(){if(this._naviToDoor&&(this._endDoor=null,this._endModel&&0<this._result.length)){for(var t,e=this._result[this._result.length-1],n=e.result,i={x:-1,y:-1},r=n.length-1;0<r;r--){var o=n[r],s=n[r-1];if(y.default.segCrossPolygon(o.point,s.point,this._endModel.points,i)){t=r;break}}n.splice(t),e=new v.default,e.Id=-1,e.point=i,n.push(e),this._endDoor=i}for(var a=[],u=0;u<this._result.length;u++){this._simplifyRouteResult(this._result[u]);for(var l=this._result[u],d=l.groupId,h=l.result,f=[],c=0,p=0;p<h.length;p++)f.push(h[p].point),p!=h.length-1&&(c+=y.default.distanceOfTwoPoints(h[p].point,h[p+1].point));l=new _.default,l._groupId=d,l._nodeList=h,l._pointList=f,l._length=c,a.push(l),u!=this._result.length-1&&(d=this._getBeginTransitionRoute(this._result[u]),l=this._getEndTransitionRoute(this._result[u+1]),a.push(d),a.push(l))}return a}},{key:"setBannedPoltyons",value:function(t){for(var e in t){var n=(0,s.default)(e),n=this._multiFloorDijkstraMap.get(n);n.setBannedPoltyons(t[e])}}},{key:"clearBannedAreas",value:function(){this._multiFloorDijkstraMap.each(function(t,e,n){n.clearBannedArea()})}},{key:"refreshBannedArea",value:function(){this._multiFloorDijkstraMap.each(function(t,e,n){e._zoneIdSimpleDijkstraMap.get(-1).refreshAdjList()})}},{key:"_simplifyRouteResult",value:function(t){if(t&&t.result){var e=t.result,n=e.length;if(n&&!(n<2)){var i=[];i.push(e[0]);var r=e[0],o=e[n-1];y.default.distanceOfTwoPoints(r.point,o.point),y.default.epsilon();for(var s=1;s<n-1;s++){var a=e[s];null!=r&&y.default.distanceOfTwoPoints(r.point,a.point)<y.default.epsilon()||null!=o&&y.default.distanceOfTwoPoints(o.point,a.point)<y.default.epsilon()||i.push(a)}i.push(o);for(var n=i.length,u=new Array(n),l=0;l<n;l++)u[l]=0;for(var d=1;d<n-1;d++){for(var h=i[d],f=d-1;0!=u[f];)f--;var c=i[f],p=i[d+1];y.default.isPointOnSegment(h.point,c.point,p.point)&&(u[d]=1)}for(var _=[],v=0;v<n;v++)0==u[v]&&_.push(i[v]);t.result=_}}}},{key:"resetBanned",value:function(){this._multiFloorDijkstraMap.each(function(t,e){e.resetBanned()})}},{key:"reset",value:function(){this._predictExtentNodes=[],this._predictLiftNodes=[],this._multiFloorDijkstraMap.each(function(t,e){e.reset()})}},{key:"pathConstraint",value:function(n,i){var r=this;if(this._multiFloorDijkstraMap.size()<=0)return null;var t=this._multiFloorDijkstraMap.get(n.groupID);if(!t)return null;var e=t._naviGraph;if(!e)return null;var o=[];o.push.apply(o,(0,x.default)(e.roadVector)),t._zoneIdGraph.each(function(t,e){o.push.apply(o,(0,x.default)(e.roadVector))});var s={},a=e.queryContainExtentId(n),u={distance:Number.MAX_VALUE,road:null,coord:{groupID:n.groupID}},e=null;return o.length&&(o.forEach(function(t){var e;t.roadEntry!=R.default.NaviRoadEntry_FORBID&&(i?0<=i.indexOf(t.roadRank)&&a==t.extentId&&(e=y.default.pointDistanceToLine(n,t.startPoint,t.endPoint,s),e<u.distance&&(u.distance=e,u.road=t,u.angle=r._getRouteAngle(t.startPoint,t.endPoint),(0,l.default)(u.coord,s))):a==t.extentId&&(e=y.default.pointDistanceToLine(n,t.startPoint,t.endPoint,s),e<u.distance&&(u.distance=e,u.road=t,u.angle=r._getRouteAngle(t.startPoint,t.endPoint),(0,l.default)(u.coord,s))))}),e=u),e}},{key:"_getRouteAngle",value:function(t,e){var n=new Geo.Vector3(0,0,1),t=new Geo.Vector3(t.x,0,t.y),e=new Geo.Vector3(e.x,0,e.y),e=e.clone().sub(t).normalize(),t=e.angleTo(n)*Geo._Math.RAD2DEG,n=0<e.clone().cross(n).y;return n?360-t:t}},{key:"_initNaviGraphs",value:function(t){for(var e in this._graphs=new p.default,t){var n=t[e].gid;if(null!=n){var i=t[e].geo[0],r=t[e].biz[0],o=t[e].navi[0],s=this._naviService.convertToGroup(n,i,r,o),a=new p.default,u=this._initNaviNodes(s,a),l=this._initNaviRoads(s),e=this._initNaviZones(s),i=this._initNaviObstructExtents(s),r=this._initNaviObstructModels(s);this._processNaviObstructModels(r,u,o,a);var d=new T.default(u,l,!0,1);d.groupId=n,0!=i.length&&(d.obstructExtents=i),0!=e.length&&(d.zones=e),0!=r.length&&(d.obstructModels=r);for(var h=0;h<l.length;h++)l[h].extentId=d.queryContainExtentId(l[h].startPoint);this._graphs.put(s.gid,d)}}}},{key:"_initNaviNodes",value:function(i,r){var t,o=[],e=function(t){var e=i.naviNodes[t];if(null==e.nodeId)return"continue";var n=new v.default;n.Id=e.nodeId,n.point=e.geoArr,n.nodeType=e.nodeType,n.liftType=e.liftType,n.liftFlag=e.liftFlag,n.liftEntry=e.liftEntry,e.linkSegArr.forEach(function(t){n.segLinks.push((0,s.default)(t))}),e.liftFloorArr.forEach(function(t){n.liftFloors.push((0,s.default)(t))}),o.push(n),r.put(e.nodeId,t)};for(t in i.naviNodes)e(t);return o}},{key:"_initNaviRoads",value:function(t){var e,n=[];for(e in t.naviSegments){var i,r=t.naviSegments[e],o=r.geoArr;o&&(i=new c.default,i.Id=r.segmentId,i.startId=r.snode,i.startPoint=o[0],i.endId=r.enode,i.endPoint=o[1],i.length=r.length,i.roadEntry=r.entry,i.roadRank=r.rank,n.push(i))}return n}},{key:"_initNaviObstructExtents",value:function(t){for(var e=[],n=0,i=t.extentLayer.length;n<i;n++){var r=t.extentLayer[n],o=r.geoArr,o=o||[],o=new I.default(r.eid,t.gid,0,o,r.center,r.holes);o.fid=r.fid,e.push(o)}return e}},{key:"_initNaviObstructModels",value:function(t){for(var e=[],n=0,i=t.modelLayer.length;n<i;n++){var r=t.modelLayer[n],o=r.geoArr,o=o||[],o=new I.default(r.eid,t.gid,0,o,r.center,r.holes);o.fid=r.fid,o.pass=r.pass,e.push(o)}return e}},{key:"_initNaviZones",value:function(t){for(var e=[],n=0,i=t.naviZones.length;n<i;n++){var r=t.naviZones[n],r=new g.default(r.id,t.gid,r.type,r.geoArr);e.push(r)}return e}},{key:"_processNaviObstructModels",value:function(t,e,n,i){for(var r=new p.default,o=0;o<t.length;o++){var s=t[o];r.put(s.Id,o)}for(var a=0;a<n.naviModels.length;a++)for(var u=n.naviModels[a],l=u.id,d=t[r.get(l)],h=0;h<u.doorids.length;h++){var f=u.doorids[h],c=e[i.get(f)];d.doors.push(c),f=u.nodetypes[h],c=u.entrytypes[h],d.doorTypes.push(f),d.doorEntrys.push(c)}}},{key:"_processLiftFloors",value:function(){var s;this._graphs.size()<=0||(s={},this._graphs.each(function(t,e){var n,i=[];for(n in e.queryLiftNodesByType(R.default.NaviLiftType_Escalator,i),i){var r,o=i[n];o.liftFlag&&(r=o.liftFlag,s[r]?s[r]=s[r].concat(o.liftFloors):s[r]=o.liftFloors)}}),this._graphs.each(function(t,e){var n,i=[];for(n in e.queryLiftNodesByType(R.default.NaviLiftType_Escalator,i),i){var r,o=i[n];o.liftFlag&&(r=o.liftFlag,s[r]&&(o.liftFloors=s[r]))}}))}},{key:"_initDijkstras",value:function(){var t,n=this;!this._graphs||!this._graphs instanceof p.default||(this._initExtentNodes(),this._initExtentRoads(),t=new T.default(this._extentNodes,this._extentRoads),this._outlineAnalyzeDijkstra=new M.default(t),this._graphs.each(function(t,e){n._multiFloorDijkstraMap.put(t,new k.default(e))}))}},{key:"_initExtentNodes",value:function(){var d=this;this._extentNodes=[];var h=0;this._graphs.each(function(t,e){for(var n=e.obstructExtents,i=0;i<n.length;i++){var r=n[i],o=new E.default;o.Id=h++,o.groupId=t,o.extentId=r.Id,o.extent=r;for(var s=0;s<e.nodeVector.length;s++){var a,u,l=e.nodeVector[s];l.liftType!=R.default.NaviLiftType_NULL&&y.default.pointInPolygon2d(r.points,l.point,r.pointCount)&&(a=new f.default,u=e.queryZoneByPoint(l.point),a.zone=u,a.setNode(l),a.groupId=t,a._wrappedNode=l,a._liftType=l.liftType,o.liftNodes.push(a))}d._extentNodes.push(o)}})}},{key:"_initExtentRoads",value:function(){this._extentRoads=[];for(var t=0;t<this._extentNodes.length;t++)for(var e=this._extentNodes[t],n=0;n<this._extentNodes.length;n++){var i,r,o=this._extentNodes[n];t!=n&&(i=this._checkConnection(e,o),null!=i&&(r=Math.abs(e.groupId-o.groupId),i*=0==r?1:r,r=new c.default,r.startId=e.Id,r.endId=o.Id,r.entryType=R.default.NaviRoadEntry_FORWARD,r.length=i,this._extentRoads.push(r)))}}},{key:"_checkConnection",value:function(t,e){for(var n=Number.MAX_VALUE,i=!1,r=t.groupId,o=e.groupId,s=r<o?R.default.NaviLiftEntry_DOWN:R.default.NaviLiftEntry_UP,a=0;a<t.liftNodes.length;a++){var u=t.liftNodes[a],l=u.liftEntry;if(l!=R.default.NaviLiftEntry_FORBID&&l!=s){var d=u.liftType;if(N.default.PRIORITY_LIFTONLY==this._priority){if(R.default.NaviLiftType_Lift!=d)continue}else if(N.default.PRIORITY_ESCALATORONLY==this._priority){if(R.default.NaviLiftType_Escalator!=d)continue}else if(N.default.PRIORITY_STAIRONLY==this._priority){if(R.default.NaviLiftType_Stair!=d)continue}else if(N.default.PRIORITY_ACCESSIBLEONLY==this._priority&&R.default.NaviLiftType_Accessible!=d)continue;if(d==R.default.NaviLiftType_Stair||-1!=u.liftFloors.indexOf(o))for(var h=0;h<e.liftNodes.length;h++){var f=e.liftNodes[h];if(null!=f&&u.liftFlag==f.liftFlag)if(t.Id,e.Id,u.liftFlag,N.default.PRIORITY_LIFTFIRST==this._priority||N.default.PRIORITY_DEFAULT==this._priority){if(R.default.NaviLiftType_Lift==d||R.default.NaviLiftType_Accessible==d)return f=this._liftLessWeightGain,f;if(R.default.NaviLiftType_Escalator==d){var c=this._escalatorWeightGain;c<n&&(n=c),i=!0;break}if(R.default.NaviLiftType_Stair==d){c=this._stairGreaterWeightGain,c<n&&(n=c),i=!0;break}}else if(N.default.PRIORITY_ESCALATORFIRST==this._priority){if(R.default.NaviLiftType_Lift==d||R.default.NaviLiftType_Accessible==d){var p=this._liftWeightGain;p<n&&(n=p),i=!0;break}if(R.default.NaviLiftType_Escalator==d)return p=this._escalatorLessWightGain,p;if(R.default.NaviLiftType_Stair==d){var _=this._stairGreaterWeightGain;_<n&&(n=_),i=!0;break}}else if(N.default.PRIORITY_STAIRFIRST==this._priority){if(R.default.NaviLiftType_Lift==d){_=this._liftWeightGain,_<n&&(n=_),i=!0;break}if(R.default.NaviLiftType_Escalator==d||R.default.NaviLiftType_Accessible==d){var v=this._escalatorGreaterWeightGain;v<n&&(n=v),i=!0;break}if(R.default.NaviLiftType_Stair==d)return v=this._stairLessWeightGain,v}else{if(N.default.PRIORITY_LIFTFIRST1==this._priority||N.default.PRIORITY_STAIRFIRST1==this._priority||N.default.PRIORITY_ESCALATORFIRST1==this._priority)return this._weightBias;if(N.default.PRIORITY_LIFTONLY==this._priority||N.default.PRIORITY_ESCALATORONLY==this._priority||N.default.PRIORITY_STAIRONLY==this._priority||N.default.PRIORITY_ACCESSIBLEONLY==this._priority)return this._weightBias}}}}return i?n:null}},{key:"_getLiftNode",value:function(t,e){for(var n=0;n<e.length;n++)if(e[n].liftFlag==t)return e[n];return null}},{key:"_switchToPriority",value:function(t){this._priority==t&&this._outlineAnalyseDijkstra||(this._priority=t,this._initExtentRoads(),t=new T.default(this._extentNodes,this._extentRoads),this._outlineAnalyseDijkstra=new M.default(t))}},{key:"_getEndTransitionRoute",value:function(t){var e=t.result,n=new _.default;return n._groupId=t.groupId,n._nodeList.push(e[0]),n._pointList.push(e[0].point),n._length=0,n}},{key:"_getBeginTransitionRoute",value:function(t){var e=t.result,n=new _.default;return n._groupId=t.groupId,n._nodeList.push(e[e.length-1]),n._pointList.push(e[e.length-1].point),n._length=0,n}},{key:"_getExtentNode",value:function(t,e){for(var n=0;n<this._extentNodes.length;n++)if(this._extentNodes[n].groupId==t&&this._extentNodes[n].extentId==e)return this._extentNodes[n];return null}},{key:"_calcPredictExtentNodes",value:function(t,e,n,i){if(e=this._getExtentNode(t,e),i=this._getExtentNode(n,i),i=this._outlineAnalyseDijkstra.routeCalculate(e,i),i!=m.default.ROUTE_SUCCESS)return i;var r=this._outlineAnalyseDijkstra.getRouteCalculateResult();this._predictExtentNodes=[];for(var o=0;o<r.length;o++)this._predictExtentNodes.push(r[o]);return i}},{key:"_compareLiftFirstFunc",value:function(t,e){return t.liftType==R.default.NaviLiftType_Lift&&e.liftType==R.default.NaviLiftType_Lift?t._dist-e._dist:t.liftType==R.default.NaviLiftType_Lift?-1:e.liftType==R.default.NaviLiftType_Lift?1:t._dist-e._dist}},{key:"_compareEscalatorFirstFunc",value:function(t,e){return t.liftType==R.default.NaviLiftType_Escalator&&e.liftType==R.default.NaviLiftType_Escalator?t._dist-e._dist:t.liftType==R.default.NaviLiftType_Escalator?-1:e.liftType==R.default.NaviLiftType_Escalator?1:t._dist-e._dist}},{key:"_compareStairFirstFunc",value:function(t,e){return t.liftType==R.default.NaviLiftType_Stair&&e.liftType==R.default.NaviLiftType_Stair?t._dist-e._dist:t.liftType==R.default.NaviLiftType_Stair?-1:e.liftType==R.default.NaviLiftType_Stair?1:t._dist-e._dist}},{key:"_has_extent_node",value:function(t,e){if(null==t)return!1;for(var n=0;n<t.length;n++)if(t[n].Id==e.Id)return!0;return!1}},{key:"_has_adj_nodeId",value:function(t,e){if(null==t)return!1;for(var n=0;n<t.length;n++)if(t[n].nodeId==e.Id)return!0;return!1}},{key:"_enlarge_connected_nodes_num",value:function(t,e,n){var i=this._outlineAnalyseDijkstra._naviGraph.adjList;if(0==i.size())return[];var r=t.length-1,o=i.get(t[r].Id);if(null==o)return[];if(0==n)return this._has_adj_nodeId(o,e)?(t.push(e),t):[];for(var s=[],a=0;a<o.length;a++){var u,l=o[a];this._has_extent_node(t,l)||l.nodeId==e.Id||(u=t.concat(),l=this._outlineAnalyseDijkstra._naviGraph.getIndexByNodeID(l.nodeId),u.push(this._outlineAnalyseDijkstra._naviGraph.nodeVector[l]),u=this._enlarge_connected_nodes_num(u,e,n-1),0!=u.length&&s.push(u))}return s}},{key:"_enlarge_connected_nodes_norepeat",value:function(t,e,n){var i=this._outlineAnalyseDijkstra._naviGraph.adjList;if(0!=i.size()){for(var r=-1,o=0;o<n.length;o++)n[o].indexOf(t)==n[o].length-1&&(r=o);if(-1!=r){var s=n[r];n.splice(r,1);var a=i.get(t.Id);if(null!=a)for(var u=0;u<a.length;u++){var l,d=this._extentNodes[a[u].nodeId];this._has_extent_node(s,d)||(l=[],l.push.apply(l,(0,x.default)(s)),l.push(d),n.push(l),d.Id!=e.Id&&this._enlarge_connected_nodes_norepeat(d,e,n))}}}}},{key:"_calcPredictConnectedLift",value:function(t,e,n){for(var i=t.liftNodes,r=n.liftNodes,o=0;o<i.length;o++){var s=i[o];s._dist=y.default.distanceOfTwoPoints(s.point,e)}N.default.PRIORITY_DEFAULT==this._priority||N.default.PRIORITY_LIFTONLY==this._priority||N.default.PRIORITY_LIFTONLY==this._priority?i.sort(this._compareLiftFirstFunc):N.default.PRIORITY_ESCALATORFIRST==this._priority||N.default.PRIORITY_ESCALATORONLY==this._priority?i.sort(this._compareEscalatorFirstFunc):N.default.PRIORITY_STAIRFIRST!=this._priority&&N.default.PRIORITY_STAIRONLY!=this._priority||i.sort(this._compareLiftFirstFunc);for(var a=null,u=null,l=!1,d=0;d<i.length;d++){for(var h=i[d],f=h.liftFlag,c=(h.liftFloors,0);c<r.length;c++)if(r[c].liftFlag==f){a=h,u=r[c],l=!0;break}if(l)break}return null==a||null==u?null:{startLiftNodes:a,endLiftNodes:u}}},{key:"_calcPredictLiftNodesBak",value:function(t,e,n,i,r){this._startZone=this._multiFloorDijkstraMap.get(t.groupId)._naviGraph.queryZoneByPoint(n);for(var o=t.queryLiftNodes(this._startZone,n,this._endPoint,this._priority),s=0;s<o.length;s++){var a=o[s];if(R.default.NaviLiftType_Stair!=a.liftType){var u=a.liftFloors;if(-1==u.indexOf(e.groupId))continue}for(var l=0;l<e.liftNodes.length;l++){var d=e.liftNodes[l];if(a.liftFlag==d.liftFlag){i.push(a),r.push(d);break}}}return 0==i.length}},{key:"_calcPredictLiftNodes",value:function(n,e,t,i,r){this._startZone=this._multiFloorDijkstraMap.get(n.groupId)._naviGraph.queryZoneByPoint(t);var o=[];function s(t,e){t=n.queryLifts(t,e),(e=o).push.apply(e,(0,x.default)(t))}for(var a=n.liftNodes,u=0;u<a.length;u++){var l=a[u],d=P.default.toVector(l.point),h=P.default.toVector(this._endPoint),f=P.default.toVector(t);l._dist=h.sub(d).length()+d.sub(f).length()}var c=n.extent.bb,p=c.maxX-c.minX+(c.maxY-c.minY);N.default.PRIORITY_LIFTONLY!=this._priority&&N.default.PRIORITY_ESCALATORONLY!=this._priority&&N.default.PRIORITY_STAIRONLY!=this._priority&&N.default.PRIORITY_ACCESSIBLEONLY!=this._priority||(c=null,N.default.PRIORITY_LIFTONLY==this._priority&&(c=R.default.NaviLiftType_Lift),N.default.PRIORITY_ESCALATORONLY==this._priority&&(c=R.default.NaviLiftType_Escalator),N.default.PRIORITY_STAIRONLY==this._priority&&(c=R.default.NaviLiftType_Stair),N.default.PRIORITY_ACCESSIBLEONLY==this._priority&&(c=R.default.NaviLiftType_Accessible),o=n.queryLifts(c)),N.default.PRIORITY_LIFTFIRST!=this._priority&&N.default.PRIORITY_ESCALATORFIRST!=this._priority&&N.default.PRIORITY_STAIRFIRST!=this._priority&&N.default.PRIORITY_DEFAULT!=this._priority||(N.default.PRIORITY_LIFTFIRST!=this._priority&&N.default.PRIORITY_DEFAULT!=this._priority||(s(R.default.NaviLiftType_Lift,-15),s(R.default.NaviLiftType_Escalator,-8),s(R.default.NaviLiftType_Stair,0)),N.default.PRIORITY_ESCALATORFIRST==this._priority&&(s(R.default.NaviLiftType_Lift,-8),s(R.default.NaviLiftType_Escalator,-15),s(R.default.NaviLiftType_Stair,0)),N.default.PRIORITY_STAIRFIRST==this._priority&&(s(R.default.NaviLiftType_Lift,-8),s(R.default.NaviLiftType_Escalator,0),s(R.default.NaviLiftType_Stair,-15))),N.default.PRIORITY_LIFTFIRST1!=this._priority&&N.default.PRIORITY_ESCALATORFIRST1!=this._priority&&N.default.PRIORITY_STAIRFIRST1!=this._priority||(N.default.PRIORITY_LIFTFIRST1==this._priority&&(s(R.default.NaviLiftType_Lift,-p),s(R.default.NaviLiftType_Escalator,0),s(R.default.NaviLiftType_Stair,0)),N.default.PRIORITY_ESCALATORFIRST1==this._priority&&(s(R.default.NaviLiftType_Lift,0),s(R.default.NaviLiftType_Escalator,-p),s(R.default.NaviLiftType_Stair,0)),N.default.PRIORITY_STAIRFIRST1==this._priority&&(s(R.default.NaviLiftType_Lift,0),s(R.default.NaviLiftType_Escalator,0),s(R.default.NaviLiftType_Stair,-p)));var _=this;o.sort(function(t,e){if(t.zone!=e.zone){if(t.zone==_._startZone)return-1;if(e.zone==_._startZone)return 1}return t._dist-e._dist});for(var v=0;v<o.length;v++){var y,g=o[v];if(R.default.NaviLiftType_Stair!=g._liftType&&(y=g._wrappedNode.liftFloors,y.find(function(t){return t==e.groupId})),!(1==g.liftEntry&&e.groupId<n.groupId||2==g.liftEntry&&e.groupId>n.groupId))for(var I=0;I<e.liftNodes.length;I++){var T=e.liftNodes[I];if(g.liftFlag==T.liftFlag){i.push(g),r.push(T);break}}}return 0!=i.length}}]),e}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(3)),n=function(){function e(t){(0,o.default)(this,e),this._options=t,this._options.hasOwnProperty("naviServerURL")&&null!=this._options.naviServerURL||(this._options.naviServerURL=".http://source.fengmap.com/newmap"),void 0===this._options.useStatic&&(this._options.useStatic=!1)}return(0,s.default)(e,[{key:"naviServerURL",get:function(){return this._options.naviServerURL}},{key:"useStatic",get:function(){return this._options.useStatic}}]),e}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(92);var o=r(n(2)),s=r(n(3)),l=r(n(230)),a=r(n(231)),u=r(n(235)),n=function(){function e(t){(0,o.default)(this,e),this._options=t,this._staticNaviScene=null,this._wktReader=new a.default,this._scene=null}return(0,s.default)(e,[{key:"setScene",value:function(t){this._scene=t}},{key:"queryScene",value:function(t,e,n){var i,r=this;this._options.useStatic?(i=this._options.naviServerURL+"/"+t+".fmap",new l.default(i,function(t){t=r._convertStatic1(t),e(t.scene_data)},!0)):(i=this._options.naviServerURL+"/"+t,new l.default(i,function(t){t=r._convertSite1(t),e(t.scene_data)},!0))}},{key:"queryNaviData",value:function(t,e,n,i){var r,o,s,a,u=this;this._options.useStatic?(r=u._convertStatic2(e),n(r)):(o=null,s=null,a=null,u=this,new l.default(this._options.naviServerURL+"/group_v2/"+t+"/"+e+"/geo",function(t){o=t,null!=o&&null!=s&&null!=a&&(t=u._convertSite2(e,o,s,a),n(t))},!0),new l.default(this._options.naviServerURL+"/group_v2/"+t+"/"+e+"/biz",function(t){s=t,null!=o&&null!=s&&null!=a&&(t=u._convertSite2(e,o,s,a),n(t))},!0),new l.default(this._options.naviServerURL+"/group_v2/"+t+"/"+e+"/navi",function(t){a=t,null!=o&&null!=s&&null!=a&&(t=u._convertSite2(e,o,s,a),n(t))},!0))}},{key:"convertToGroup",value:function(t,e,n,i){return this._convertToGroup(t,e,n,i)}},{key:"convertGeo2Geometry",value:function(t,e){return this._convertGeo2Geometry(t,e)}},{key:"convertArray2Geometry",value:function(t,e){return this._convertArray2Geometry(t,e)}},{key:"_convertSite1",value:function(t){var e=fmSceneDecode(t),t={scene_data:e};return t}},{key:"_convertSite2",value:function(t,e,n,i){return e=fmFloorGeoDecode(e),n=fmFloorBizDecode(n),i=fmFloorNaviDecode(i),this._convertToGroup(t,e,n,i)}},{key:"_convertGeo2Geometry",value:function(t,e){return t=this._wktReader.parse(t),{points:t._points,holes:t._holes}}},{key:"_convertArray2Geometry",value:function(t,e){return e=(new u.default).parseGeometry(t,e),{points:e._points,holes:e._holes}}},{key:"_tempFlipX",value:function(t){if(t&&"string"!=typeof t)for(var e in t){var n=t[e];if("vertices"==e||"vertex"==e)for(var i in n)i%2==0&&(n[i]=-n[i]);else"scene_data"==e?(n.x=-n.x,n.defCenX=-n.defCenX):this._tempFlipX(n)}}},{key:"_convertStringToArray",value:function(t){if(""==t||!t)return[];var e=[],n=t,t=[];return 0<=n.indexOf("|")||0<=n.indexOf("-")||0<=n.indexOf(",")?(t=n.split(/[|,-]/),e.push.apply(e,t)):e.push(n),e}},{key:"_convertStatic1",value:function(t){return this._staticNaviScene=fmMapDecode(t,!1),t={scene_data:this._staticNaviScene.scene},t}},{key:"_convertStatic2",value:function(t){for(var e=this._staticNaviScene.floors,n=0;n<e.length;n++){var i=e[n];if(i.gid==t)return this._convertToGroup(t,i.geo[0],i.biz[0],i.navi[0])}return null}},{key:"_convertToGroup",value:function(t,e,n,i){for(var r={},o=[],s=[],a=[],u=[],l=[],d=this._scene.scene.file_ver,h=0,f=e.extentLayer.length;h<f;h++){var c=e.extentLayer[h],p=null,p=1===d?this._convertGeo2Geometry(c.geo):this._convertArray2Geometry(c.idxs,c.pts);c.geoArr=p.points,c.holes=p.holes,s.push(c)}for(var _=0,v=e.labelLayer.length;_<v;_++)r[e.labelLayer[_].eid]=e.labelLayer[_];for(var y=0,g=e.modelLayer.length;y<g;y++){var I=e.modelLayer[y],T=n.modelLayer[y],x={};x.fid=T.fid,x.eid=I.eid,x.pass=T.pass,x.center=(1===d?this._convertGeo2Geometry(r[I.eid].geo):this._convertArray2Geometry(r[I.eid].idxs,r[I.eid].pts)).points[0],T=null,T=1===d?this._convertGeo2Geometry(I.geo):this._convertArray2Geometry(I.idxs,I.pts),x.geoArr=T.points,x.holes=T.holes,o.push(x)}for(var N=0,m=i.naviNodes.length;N<m;N++){var R=i.naviNodes[N];R.geoArr=(1===d?this._convertGeo2Geometry(R.geo):this._convertArray2Geometry(R.idxs,R.pts)).points[0],R.linkSegArr=this._convertStringToArray(R.linkSeg),R.liftFloorArr=this._convertStringToArray(R.liftFloor),a.push(R)}for(var E=0,M=i.naviSegments.length;E<M;E++){var k=i.naviSegments[E];k.geoArr=(1===d?this._convertGeo2Geometry(k.geo):this._convertArray2Geometry(k.idxs,k.pts)).points,k.m_Id=i.mid,u.push(k)}if(i.naviZones)for(var P=0,M=i.naviZones.length;P<M;P++){var L=i.naviZones[P],A=null,A=1===d?this._convertGeo2Geometry(L.geo):this._convertArray2Geometry(L.idxs,L.pts);L.geoArr=A.points,L.holes=A.holes,L.m_Id=i.mid,l.push(L)}return t={gid:t,extentLayer:s,modelLayer:o,naviSegments:u,naviNodes:a,naviZones:l},t}}]),e}(),n=n;e.default=n},function(t,e,n){var i=n(21),r=n(36),o=n(5)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},function(t,e,n){"use strict";var i=n(226)(!0);t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},function(t,e,n){var s=n(38),a=n(37);t.exports=function(o){return function(t,e){var n,i=String(a(t)),r=s(e),t=i.length;return r<0||t<=r?o?"":void 0:(e=i.charCodeAt(r),e<55296||56319<e||r+1===t||(n=i.charCodeAt(r+1))<56320||57343<n?o?i.charAt(r):e:o?i.slice(r,r+2):n-56320+(e-55296<<10)+65536)}}},function(t,e,n){"use strict";var i=n(64),r=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){if(n=n.call(t,e),"object"!=typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},function(t,e,n){"use strict";n(229);var i,u=n(25),l=n(13),d=n(7),h=n(37),f=n(5),c=n(93),p=f("species"),_=!d(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),v=(n=/(?:)/,i=n.exec,n.exec=function(){return i.apply(this,arguments)},n="ab".split(n),2===n.length&&"a"===n[0]&&"b"===n[1]);t.exports=function(n,t,e){var o,i,r=f(n),s=!d(function(){var t={};return t[r]=function(){return 7},7!=""[n](t)}),a=s?!d(function(){var t=!1,e=/a/;return e.exec=function(){return t=!0,null},"split"===n&&(e.constructor={},e.constructor[p]=function(){return e}),e[r](""),!t}):void 0;s&&a&&("replace"!==n||_)&&("split"!==n||v)||(o=/./[r],a=e(h,r,""[n],function(t,e,n,i,r){return e.exec===c?s&&!r?{done:!0,value:o.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}}),e=a[0],i=a[1],u(String.prototype,n,e),l(RegExp.prototype,r,2==t?function(t,e){return i.call(t,this,e)}:function(t){return i.call(t,this)}))}},function(t,e,n){"use strict";var i=n(93);n(24)({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(3)),n=function(){function t(){(0,o.default)(this,t),this.requestMethod="GET",this._requestHeader={},this.sendData=null}return(0,s.default)(t,[{key:"getFile",value:function(t,n,i,e,r){void 0!==this._path&&(t=this._path+t);var o,s=new XMLHttpRequest;for(o in s.open(this.requestMethod,t,!0),s.addEventListener("load",function(t){var e=this.response;200===this.status||0===this.status||201===this.status?(0===this.status&&console.warn("FMMap FileLoader: HTTP Status 0 received."),n(e)):i(e)},!1),s.addEventListener("progress",function(t){e&&e()},!1),s.addEventListener("error",function(t){i()},!1),s.addEventListener("abort",function(t){r&&r()},!1),void 0!==this._responseType&&(s.responseType=this._responseType),void 0!==this._withCredentials&&(s.withCredentials=this._withCredentials),s.overrideMimeType&&s.overrideMimeType(void 0!==this._mimeType?this._mimeType:"text/plain"),this._requestHeader)s.setRequestHeader(o,this._requestHeader[o]);s.send(this.sendData)}},{key:"setPath",value:function(t){return this._path=t,this}},{key:"setResponseType",value:function(t){return this._responseType=t,this}},{key:"setWithCredentials",value:function(t){return this._withCredentials=t,this}},{key:"setMimeType",value:function(t){return this._mimeType=t,this}},{key:"setRequestHeader",value:function(t){return t&&(this._requestHeader=t),this}}]),t}(),n=n;e.default=n},function(e,n,i){"use strict";var r=i(0),o=i(1);r(n,"__esModule",{value:!0}),n.default=void 0;var a=o(i(134));i(92);var s=o(i(2)),u=o(i(3)),l=l||{};l.GLEN1="MULTIPOLYGON(((".length,l.GLEN2="POINT(".length,l.GLEN3="MULTILINESTRING((".length,i=function(){function e(){(0,s.default)(this,e),this._points,this._holes}return(0,u.default)(e,[{key:"parse",value:function(t){if(this._points=[],this._holes=[],0==t.indexOf("MULTIPOLYGON((("))for(var e=t.substring(l.GLEN1,t.length-3).split(/\),\(/),n=0;n<e.length;n++){var i=e[n].split(/,/);if(0==n)for(var r=0;r<i.length;r++){var o=i[r].split(" ");this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])})}else{for(var s=[],r=0;r<i.length;r++)o=i[r].split(" "),s.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});this._holes.push(s)}}else if(0==t.indexOf("POINT("))o=t.substring(l.GLEN2,t.length-1).split(" "),this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});else if(0==t.indexOf("MULTILINESTRING(("))for(i=t.substring(l.GLEN3,t.length-2).split(","),r=0;r<i.length;r++)o=i[r].split(" "),this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});return this}},{key:"toFixed",value:function(t){return+t.toFixed(2)}},{key:"parsePnt",value:function(t){if(this._points=[],0==t.indexOf("MULTIPOLYGON((("))for(var e=t.substring(l.GLEN1,t.length-3).split(","),n=0;n<e.length;n++){var i=e[n].split(" ");this._points.push({x:(0,a.default)(i[0]),y:(0,a.default)(i[1])})}else if(0==t.indexOf("POINT("))i=t.substring(l.GLEN2,t.length-1).split(" "),this._points.push({x:(0,a.default)(i[0]),y:(0,a.default)(i[1])});else if(0==t.indexOf("MULTILINESTRING(("))for(e=t.substring(l.GLEN3,t.length-2).split(","),n=0;n<e.length;n++)i=e[n].split(" "),this._points.push({x:(0,a.default)(i[0]),y:(0,a.default)(i[1])});return this}},{key:"toPntStrip",value:function(t){var e=[],n=this._points.length;if(!0===t){if(1<=n)for(var i=0;i<n-1;i++){var r=this._points[i];e.push(r.x,r.y)}}else for(i=0;i<n;i++)r=this._points[i],e.push(r.x,r.y);return e}},{key:"mergePnts",value:function(t){for(var e=[],n=t.length,i=0;i<n;i++){for(var r=t[i],o={x:this.toFixed(r.x),y:this.toFixed(r.y)},s=e.length,a=!1,u=0;u<s;u++){var l=e[u];if(l.x==o.x&&l.y==o.y){a=!0;break}}a||e.push(o)}return e}},{key:"toStrip",value:function(e){var n=[],i=this._points.length;if(i<=0)return n;for(var i=this._points.splice(i-1,1)[0],r=this.mergePnts(this._points),o=r.length,s=0;s<o;s++){var a=r[s];n.push(a.x,a.y)}return!0===e||(t={x:this.toFixed(i.x),y:this.toFixed(i.y)},n.push(t.x,t.y),this._points.push(i)),n}},{key:"hasHoles",value:function(){return null!=this._holes&&0<this._holes.length}},{key:"toStripHoles",value:function(e){for(var n=[],i=0;i<this._holes.length;i++){for(var r=this._holes[i],o=[],s=r.length,s=r.splice(s-1,1)[0],a=this.mergePnts(r),u=a.length,l=0;l<u;l++){var d=a[l];o.push(d.x,d.y)}!0===e||(t={x:this.toFixed(s.x),y:this.toFixed(s.y)},o.push(t.x,t.y)),n.push(o)}return n}},{key:"holes",get:function(){return this._holes},set:function(t){this._holes=t}},{key:"points",get:function(){return this._points},set:function(t){this._points=t}}]),e}(),n.default=i},function(t,e,n){n(233),t.exports=n(4).parseFloat},function(t,e,n){var i=n(6),n=n(234);i(i.G+i.F*(parseFloat!=n),{parseFloat:n})},function(t,e,n){var i=n(9).parseFloat,r=n(133).trim;t.exports=1/i(n(90)+"-0")!=-1/0?function(t){var e=r(String(t),3),t=i(e);return 0===t&&"-"==e.charAt(0)?-0:t}:i},function(e,n,i){"use strict";var r=i(0),o=i(1);r(n,"__esModule",{value:!0}),n.default=void 0;var s=o(i(2)),a=o(i(3)),i=function(){function e(){(0,s.default)(this,e),this._points,this._holes}return(0,a.default)(e,[{key:"parse",value:function(t,e){this._points=[],this._holes=[];for(var n=0,i=0;i<t.length;i++){var r=t[i].idxs,r=r||t[i];if("number"==typeof r)for(;n<r;)this._points.push({x:e[n],y:e[n+1]}),n+=2;else for(var o=0;o<r.length;o++)for(var s=r[o];n<s;)this._points.push({x:e[n],y:e[n+1]}),n+=2}return this}},{key:"parseGeometry",value:function(t,e){this._points=[],this._holes=[];for(var n=0,i=0;i<t.length;i++){var r=t[i].idxs,r=r||t[i];if("number"==typeof r)for(;n<r;)this._points.push({x:e[n],y:e[n+1]}),n+=2;else for(var o=0;o<r.length;o++)if(0===o)for(var s=r[o];n<s;)this._points.push({x:e[n],y:e[n+1]}),n+=2;else{for(var a=[],u=r[o];n<u;)a.push({x:e[n],y:e[n+1]}),n+=2;this._holes.push(a)}}return this}},{key:"mergePnts",value:function(t){for(var e=[],n=t.length,i=0;i<n;i++){for(var r=t[i],o={x:this.toFixed(r.x),y:this.toFixed(r.y)},s=e.length,a=!1,u=0;u<s;u++){var l=e[u];if(l.x==o.x&&l.y==o.y){a=!0;break}}a||e.push(o)}return e}},{key:"toStrip",value:function(e){var n=[],i=this._points.length;if(i<=0)return n;for(var i=this._points.splice(i-1,1)[0],r=this._points,o=r.length,s=0;s<o;s++){var a=r[s];n.push(a.x,a.y)}return!0===e||(t={x:this.toFixed(i.x),y:this.toFixed(i.y)},n.push(t.x,t.y),this._points.push(i)),n}},{key:"toFixed",value:function(t){return+t.toFixed(2)}},{key:"hasHoles",value:function(){return null!=this._holes&&0<this._holes.length}},{key:"toStripHoles",value:function(e){for(var n=[],i=0;i<this._holes.length;i++){for(var r=this._holes[i],o=[],s=r.length,s=r.splice(s-1,1)[0],a=this.mergePnts(r),u=a.length,l=0;l<u;l++){var d=a[l];o.push(d.x,d.y)}!0===e||(t={x:this.toFixed(s.x),y:this.toFixed(s.y)},o.push(t.x,t.y)),n.push(o)}return n}},{key:"holes",get:function(){return this._holes},set:function(t){this._holes=t}},{key:"points",get:function(){return this._points},set:function(t){this._points=t}}]),e}(),i=i;n.default=i},function(t,e,n){"use strict";var r=n(136),i=n(0),o=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var s=o(n(2)),a=o(n(137)),u=o(n(139)),l=o(n(140)),n=o(n(42));function d(n){var i=h();return function(){var t,e=(0,l.default)(n),e=i?(t=(0,l.default)(this).constructor,r(e,arguments,t)):e.apply(this,arguments);return(0,u.default)(this,e)}}function h(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],function(){})),!0}catch(t){return!1}}n=function(t){(0,a.default)(n,t);var e=d(n);function n(){var t;return(0,s.default)(this,n),t=e.call(this),t.liftId=0,t.groupId=0,t.zone=null,t._dist=0,t._wrappedNode=null,t._liftType=null,t}return n}(n.default),e.default=n},function(t,e,n){n(238),t.exports=n(4).Reflect.construct},function(t,e,n){var i=n(6),r=n(57),o=n(68),s=n(27),a=n(19),u=n(20),l=n(239),d=(n(9).Reflect||{}).construct,h=u(function(){function t(){}return!(d(function(){},[],t)instanceof t)}),f=!u(function(){d(function(){})});i(i.S+i.F*(h||f),"Reflect",{construct:function(t,e){o(t),s(e);var n=arguments.length<3?t:o(arguments[2]);if(f&&!h)return d(t,e,n);if(t!=n)return i=n.prototype,n=r(a(i)?i:Object.prototype),i=Function.apply.call(t,n,e),a(i)?i:n;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return i.push.apply(i,e),new(l.apply(t,i))}})},function(t,e,n){"use strict";var o=n(68),s=n(19),a=n(240),u=[].slice,l={},d=function(t,e,n){if(!(e in l)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";l[e]=Function("F,a","return new F("+i.join(",")+")")}return l[e](t,n)};t.exports=Function.bind||function(e){var n=o(this),i=u.call(arguments,1),r=function(){var t=i.concat(u.call(arguments));return this instanceof r?d(n,t.length,t):a(n,t,e)};return s(n.prototype)&&(r.prototype=n.prototype),r}},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){t.exports=n(242)},function(t,e,n){n(243);var i=n(4).Object;t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){var i=n(6);i(i.S,"Object",{create:n(57)})},function(n,t,e){var i=e(138);function r(t,e){return n.exports=r=i||function(t,e){return t.__proto__=e,t},n.exports.default=n.exports,n.exports.__esModule=!0,r(t,e)}n.exports=r,n.exports.default=n.exports,n.exports.__esModule=!0},function(t,e,n){n(246),t.exports=n(4).Object.setPrototypeOf},function(t,e,n){var i=n(6);i(i.S,"Object",{setPrototypeOf:n(247).set})},function(t,e,r){var n=r(19),i=r(27),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,i){try{i=r(67)(Function.call,r(110).f(Object.prototype,"__proto__").set,2),i(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,e){return o(t,e),n?t.__proto__=e:i(t,e),t}}({},!1):void 0),check:o}},function(e,t,n){var i=n(106),r=n(111);function o(t){return e.exports=o="function"==typeof i&&"symbol"==typeof r?function(t){return typeof t}:function(t){return t&&"function"==typeof i&&t.constructor===i&&t!==i.prototype?"symbol":typeof t},e.exports.default=e.exports,e.exports.__esModule=!0,o(t)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(t,e){function n(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){t.exports=n(251)},function(t,e,n){n(252),t.exports=n(4).Object.getPrototypeOf},function(t,e,n){var i=n(44),r=n(114);n(253)("getPrototypeOf",function(){return function(t){return r(i(t))}})},function(t,e,n){var r=n(6),o=n(4),s=n(20);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],i={};i[t]=e(n),r(r.S+r.F*s(function(){n(1)}),"Object",i)}},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(2)),o=r(n(3)),u=r(n(142)),l=r(n(12)),d=r(n(141)),n=function(){function s(t,e,n,i,r,o){(0,a.default)(this,s),this.Id=t,this.fid="",this.points=i,this.pointCount=i&&i.length?i.length:0,this.center=r,this.holes=o,this._type=n,this.groupID=e,this.doors=[],this.doorTypes=[],this.doorEntrys=[],this.parent=null,this.child=null,this.brothers=[],this.level=0,this.inId=0,this._area=null,this.isExtent=!1,this.bb=new u.default,this.refreshBB()}return(0,o.default)(s,[{key:"pass",get:function(){return 3&this._type},set:function(t){this._type|=t}},{key:"level",get:function(){return 31&_level},set:function(t){this._level=31&t}},{key:"area",get:function(){return null==this._area&&(this._area=l.default.calcPolygonArea2d(this.points)),this._area}},{key:"contain",value:function(t){return l.default.pointInPolygon2d(this.points,t,this.points.length-1)}},{key:"refreshBB",value:function(){this.bb.init();for(var t=0;t<this.pointCount;t++)this.bb.expandBy({x:this.points[t].x,y:this.points[t].y})}},{key:"toZone",value:function(){var t=new d.default(this.isExtent?-this.Id:this.Id,this.groupID,this._type,this.points);return t.pass=this.pass,t.level=this.level,t.inId=this.inId,pZone}}]),s}(),n=n;e.default=n},function(t,e,n){"use strict";var r=n(136),i=n(0),o=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(26);var a=o(n(29)),s=o(n(2)),u=o(n(3)),l=o(n(137)),d=o(n(139)),h=o(n(140)),i=o(n(42)),f=o(n(33)),c=o(n(65)),p=o(n(12));function _(n){var i=v();return function(){var t,e=(0,h.default)(n),e=i?(t=(0,h.default)(this).constructor,r(e,arguments,t)):e.apply(this,arguments);return(0,d.default)(this,e)}}function v(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],function(){})),!0}catch(t){return!1}}i=function(t){(0,l.default)(n,t);var e=_(n);function n(){var t;return(0,s.default)(this,n),t=e.call(this),t.groupId=0,t.extentId=0,t.liftNodes=[],t._zone=null,t._firstPriorityOffset=15,t._secondPriorityOffset=8,t}return(0,u.default)(n,[{key:"queryLifts",value:function(t,e){if(!t)return[];for(var n=[],i=0;i<this.liftNodes.length;i++){var r=this.liftNodes[i];t==r._liftType&&(e&&(r._dist=r._dist+e),n.push(r))}return n}},{key:"queryLiftNodes",value:function(t,e,n,i){this._zone=t;var r=[];r.push.apply(r,(0,a.default)(this.liftNodes));for(var o=0;o<r.length;o++){var s=r[o];s._dist=p.default.distanceOfTwoPoints(n,s.point)+p.default.distanceOfTwoPoints(s.point,e)}return this._liftNodeSort(r,i)}},{key:"_liftNodeSort",value:function(t,e){if(e==c.default.PRIORITY_LIFTFIRST1){var n=this._sortLiftFirst.bind(this);t.sort(n)}else if(e==c.default.PRIORITY_ESCALATORFIRST1){var i=this._sortEscalatorFirst.bind(this);t.sort(i)}else if(e!=c.default.PRIORITY_STAIRFIRST1)i=this._sortStairFirst.bind(this),t.sort(i);else{this._modifyDistance(t,e);for(var r=[],o=0;o<t.length;o++)t[o]._dist&&r.push(t[o]);t=[],(e=t).push.apply(e,r),e=this._sortDistFunc.bind(this),t.sort(e)}return t}},{key:"_sortLiftFirst",value:function(t,e){if(t.zone!=e.zone){if(this._zone==t.zone)return-1;if(this._zone==e.zone)return 1}return t.liftType!=f.default.NaviLiftType_Lift&&t.liftType!=f.default.NaviLiftType_Accessible||e.liftType!=f.default.NaviLiftType_Lift&&e.liftType!=f.default.NaviLiftType_Accessible?t.liftType==f.default.NaviLiftType_Lift||t.liftType==f.default.NaviLiftType_Accessible?-1:e.liftType==f.default.NaviLiftType_Lift||e.liftType==f.default.NaviLiftType_Accessible?1:t._dist-e._dist:t._dist<e._dist}},{key:"_sortEscalatorFirst",value:function(t,e){if(t.zone!=e.zone){if(this._zone==t.zone)return-1;if(this._zone==e.zone)return 1}return t.liftType==f.default.NaviLiftType_Escalator&&e.liftType==f.default.NaviLiftType_Escalator?t._dist<e._dist:t.liftType==f.default.NaviLiftType_Escalator?-1:e.liftType==f.default.NaviLiftType_Escalator?1:t._dist-e._dist}},{key:"_sortStairFirst",value:function(t,e){if(t.zone!=e.zone){if(this._zone==t.zone)return-1;if(this._zone==e.zone)return 1}return t.liftType==f.default.NaviLiftType_Stair&&e.liftType==f.default.NaviLiftType_Stair?t._dist<e._dist:t.liftType==f.default.NaviLiftType_Stair?-1:e.liftType==f.default.NaviLiftType_Stair?1:t._dist-e._dist}},{key:"_sortDistFunc",value:function(t,e){if(t.zone!=e.zone){if(this._zone==t.zone)return-1;if(this._zone==e.zone)return 1}return t._dist-e._dist}},{key:"_modifyDistance",value:function(t,e){if(e==c.default.PRIORITY_DEFAULT)for(var n=0;n<t.length;n++)t[n].liftType==f.default.NaviLiftType_Escalator?t[n]._dist-=this._firstPriorityOffset:t[n].liftType!=f.default.NaviLiftType_Lift&&t[n].liftType!=f.default.NaviLiftType_Accessible||(t[n]._dist-=this._secondPriorityOffset);else if(e==c.default.PRIORITY_STAIRFIRST)for(var i=0;i<t.length;i++)t[i].liftType==f.default.NaviLiftType_Stair?t[i]._dist-=this._firstPriorityOffset:t[i].liftType==f.default.NaviLiftType_Escalator&&(t[i]._dist-=this._secondPriorityOffset);else if(e==c.default.PRIORITY_ESCALATORFIRST)for(var r=0;r<t.length;r++)t[r].liftType==f.default.NaviLiftType_Escalator?t[r]._dist-=this._firstPriorityOffset:t[r].liftType!=f.default.NaviLiftType_Lift&&t[r].liftType!=f.default.NaviLiftType_Accessible||(t[r]._dist-=this._secondPriorityOffset);else if(e==c.default.PRIORITY_LIFTFIRST)for(var o=0;o<t.length;o++)t[o].liftType==f.default.NaviLiftType_Lift||t[o].liftType==f.default.NaviLiftType_Accessible?t[o]._dist-=this._firstPriorityOffset:t[o].liftType==f.default.NaviLiftType_Escalator&&(t[o]._dist-=this._secondPriorityOffset);else if(e==c.default.PRIORITY_STAIRONLY)for(var s=0;s<t.length;s++)t[s].liftType!=f.default.NaviLiftType_Stair&&(t[s]._dist=null);else if(e==c.default.PRIORITY_ESCALATORONLY)for(var a=0;a<t.length;a++)t[a].liftType!=f.default.NaviLiftType_Escalator&&(t[a]._dist=null);else if(e==c.default.PRIORITY_LIFTONLY)for(var u=0;u<t.length;u++)t[u].liftType!=f.default.NaviLiftType_Lift&&t[u].liftType!=f.default.NaviLiftType_Accessible&&(t[u]._dist=null);else if(e==c.default.PRIORITY_ACCESSIBLEONLY)for(var l=0;l<t.length;l++)t[l].liftType!=f.default.NaviLiftType_Accessible&&(t[l]._dist=null)}}]),n}(i.default),e.default=i},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var w=r(n(15));n(16),n(143),n(66),n(32),n(31),n(51),n(26);var f=r(n(29)),o=r(n(2)),s=r(n(3)),A=r(n(12)),C=r(n(33)),a=r(n(41)),l=r(n(144)),D=r(n(42)),F=r(n(94)),d=r(n(50)),u=r(n(96)),z=r(n(95)),c=r(n(49)),h=(r(n(91)),r(n(257)));n=function(){function e(t){(0,o.default)(this,e),this._startModel=null,this._endModel=null,this._naviGraph=t,this._zoneMap=new d.default,this._zoneIdGraph=new d.default,this._originDijkstra=null,this._zoneIdSimpleDijkstraMap=new d.default,this._resultVector=[],this._startZoneId=Number.INT_MIN,this._endZoneId=Number.INT_MIN,this._tmpId=-1,this._startNode=null,this._endNode=null,this._mode=a.default.MODULE_SHORTEST,this._zonePNTModelsMap=new d.default,this._zoneNPModelsMap=new d.default,this._modelIdRoadsMap=new d.default,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[],this._kScaleVariable=100,this._kRemainedZoneId=-1,this._kMinModelAngle=15,this._kDoorToler=.1,this._tmpAdjNodeIds=[],this._assignedPts=[],this._newTempRoads=[],this._bannedPolys=[],this._assignedNodes=[],this._segmentByZones(),this._assemblePassNotThroughModels(),this._assembleNotPassModels(),this._fitVariableRoadsToModel(),this._adjustNPModelRoads()}return(0,s.default)(e,[{key:"routeCalculate",value:function(t,e,n){if(this._startZoneId=t instanceof D.default?this._calcZoneIdByCoord(t.point):this._calcZoneIdByCoord(t),this._endZoneId=e instanceof D.default?this._calcZoneIdByCoord(e.point):this._calcZoneIdByCoord(e),n&&(this._mode=n),this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),t instanceof D.default)this._startNode=t;else if(c.default.ROUTE_FAILED_NO_DATA_START==this._processStartPoint(t,t))return c.default.ROUTE_FAILED_NO_DATA_START;if(this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),e instanceof D.default)this._endNode=e;else if(c.default.ROUTE_FAILED_NO_DATA_END==this._processEndPoint(e,t instanceof D.default?t.point:t))return c.default.ROUTE_FAILED_NO_DATA_END;return this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),null==this._startNode?c.default.ROUTE_FAILED_NO_DATA_START:null==this._endNode?c.default.ROUTE_FAILED_NO_DATA_END:(this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),this._naviGraph.consoleAdjInfos(),this._routeCalculate())}},{key:"routeAssigned",value:function(){var t;this._assignedNodes=[];for(var e=0;e<this._assignedPts.length;e++){var n=this._assignedPts[e],n={x:n[0],y:n[1]},i=this._calcZoneIdByCoord(n),n=this._insertTmpIsolatedNode(i,n);this._assignedNodes.push(n)}(t=this._resultVector).push.apply(t,(0,f.default)(this._assignedNodes))}},{key:"assignedPts",get:function(){return this._assignedPts},set:function(t){this._assignedPts=t}},{key:"getRouteCalculateResult",value:function(){return this._resultVector}},{key:"dispose",value:function(){this._startModel=null,this._endModel=null,this._naviGraph.dispose(),this._naviGraph=null,this._zoneMap.clear(),this._zoneMap=null,this._zoneIdGraph.each(function(t,e){e.dispose()}),this._zoneIdGraph.clear(),this._zoneIdGraph=null,null!=this._originDijkstra&&(this._originDijkstra.dispose(),this._originDijkstra=null),this._zoneIdSimpleDijkstraMap.each(function(t,e){e.dispose()}),this._zoneIdSimpleDijkstraMap.clear(),this._zoneIdSimpleDijkstraMap=null,this._resultVector=[],this._startNode=null,this._endNode=null,this._zonePNTModelsMap.clear(),this._zonePNTModelsMap=null,this._zoneNPModelsMap.clear(),this._zoneNPModelsMap=null,this._modelIdRoadsMap.clear(),this.__zoneNPModelsMap=null,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"reset",value:function(){this._resultVector=[],this._clearTempElements(-1),this._clearTempElements(this._startZoneId),this._startZoneId=Number.INT_MIN,this._clearTempElements(this._endZoneId),this._endZoneId=Number.INT_MIN,this._clearTempAdjList(),this._tmpAdjNodeIds=[];var t=this._naviGraph.roadVector.length;this._tmpId<-2*t&&(this._tmpId=-1);for(var e=0;e<this._variableModelPairs.length;e++){var n=this._variableModelPairs[e];this._switchVariableHinderTo(n.zoneId,n.model,C.default.NaviRoadHinderType_HINDER_HIGH)}this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"resetBanned",value:function(){this._newTempRoads=[];for(var t=0;t<this._noEntryRoads.length;t++){var e=this._noEntryRoads[t];e.road.roadEntry=e.originEntry}this._noEntryRoads=[],this._clearTempElements(-1);var n=this._zoneIdSimpleDijkstraMap.get(-1)._naviGraph;n.makeUpAdjList()}},{key:"setBannedPoltyons",value:function(t){this.resetBanned(),0!=t.length&&(this._bannedPolys=t,this._dealBannedAreas())}},{key:"clearBannedArea",value:function(){}},{key:"_dealBannedAreas",value:function(){for(var t=0;t<this._bannedPolys.length;t++)this._banBySinglePolygon(this._bannedPolys[t])}},{key:"_insertNewTempRoad",value:function(t,e,n,i,r){var o,s;t instanceof D.default?o=t:(o=new D.default,o.Id=e,o.point=t,this._naviGraph.nodeVector.push(o)),n instanceof D.default?s=n:(s=new D.default,s.Id=i,s.point=n,this._naviGraph.nodeVector.push(s)),n=new F.default,n.Id=this._tmpId--,n.startId=o.Id,n.startPoint=o.point,n.endId=s.Id,n.endPoint=s.point,n.roadEntry=r,this._naviGraph.roadVector.push(n)}},{key:"_banBySinglePolygon",value:function(t){for(var e=this._naviGraph.queryRoadsByPolygon(t),n=0;n<e.length;n++){var i=e[n],r=i.road,o=r.roadEntry;this._noEntryRoads.push({road:r,originEntry:o}),r.roadEntry=C.default.NaviRoadEntry_FORBID,1==i.crss.length&&(1==A.default.pointInPolygon2d(t,r.startPoint,t.length)?this._insertNewTempRoad(i.crss[0],this._tmpId--,r.endPoint,this._tmpId--,o):this._insertNewTempRoad(r.startPoint,this._tmpId--,i.crss[0],this._tmpId--,o)),2==i.crss.length&&(this._insertNewTempRoad(r.startPoint,this._newTempId(),i.crss[0],this._newTempId(),o),this._insertNewTempRoad(i.crss[1],this._newTempId(),r.endPoint,this._newTempId(),o))}var s=new NaviModel;s.Id=this._tmpId--,s.points=t,s.points.push(t[0]),s.pass=C.default.NaviModelPassType_NOT_PASS,this._naviGraph.obstructModels.push(s)}},{key:"_newTempId",value:function(){return this._tmpId--}},{key:"_calcPointReachable",value:function(t){var e=this._naviGraph.queryContainExtentId(t);if(-1==e)return null;var n=this._calcZoneIdByCoord(t),i=-0,r=this._zoneIdGraph.get(n).findModel(t,i);if(null==r)return{extentId:e,model:null};if(r.pass==C.default.NaviModelPassType_PASS_THROUGH||r.pass==C.default.NaviModelPassType_PASS_NOT_THROUGH){if(0<r.doors.length)return{extentId:e,model:r};for(var o={},s=[],a=[],i=this._zoneIdGraph.get(n),u=i.roadVector,l=!0,d=r.points.length,h=0;h<d-1;h++)for(var f=r.points[h],c=r.points[h+1],p=0;p<u.length;p++){var _=u[p];1==A.default.calcCrossPoint(f,c,_.startPoint,_.endPoint,o)&&(l=!1,C.default.NaviRoadEntry_FORBID!=_.roadEntry&&(_=new Object,_.x=o.x,_.y=o.y,s.push(_),a.push(u[p])))}if(l)return{extentId:e,model:r};if(0==s.length)return null;r.doors=[],r.doorEntrys=[],r.doorTypes=[];for(var v=0;v<s.length;v++){var y=s[v],g=a[v],y=this._insertNodeToRoad(n,y,g);y.nodeType=C.default.NaviNodeType_COMMON,g.roadEntry==C.default.NaviRoadEntry_BOTH?y.entranceType=C.default.NaviEntranceType_ACCESS:A.default.pointInPolygon2d(r.points,g.startPoint,r.points.length-1)?(g.roadEntry==C.default.NaviRoadEntry_FORWARD&&(y.entranceType=C.default.NaviEntranceType_EXIT),g.roadEntry==C.default.NaviRoadEntry_BACK&&(y.entranceType=C.default.NaviEntranceType_ENTRANCE)):(g.roadEntry==C.default.NaviRoadEntry_FORWARD&&(y.entranceType=C.default.NaviEntranceType_ENTRANCE),g.roadEntry==C.default.NaviRoadEntry_BACK&&(y.entranceType=C.default.NaviEntranceType_EXIT)),r.doors.push(y),r.doorEntrys.push(y.entranceType),r.doorTypes.push(y.nodeType)}}return r.pass!=C.default.NaviModelPassType_NOT_PASS?{extentId:e,model:r}:null}},{key:"_processStartPoint",value:function(i,t){var r=this;this._startNode=this._insertTmpIsolatedNode(this._startZoneId,i);var e=null,o=!0,e=null!=this._startModel&&this._startModel.pass==C.default.NaviModelPassType_PASS_THROUGH&&0==this._startModel.doors.length?this._seekNearRoads(this._startZoneId,i,t,30,this._startModel):this._seekNearRoads(this._startZoneId,i,t);if(null==this._startModel&&(o=!1),0<e.size()){o=!1,e.each(function(t,e,n){for(n=0;n<e.length;n++)0!=e[n].road.roadEntry&&(o=!0)});var s=0,a=!1,u=[];if(e.each(function(t,e){var n=e[0].road,e=r._exploreUprightLikelyJoints(r._startZoneId,i,n,e,r._startModel);0==e.length?s++:Math.abs(e[0].rotateAngle)>A.default.epsilon()?u.push.apply(u,(0,f.default)(e)):(a=!0,e=r._insertTempNodeToRoad(r._startZoneId,e[0].cross,e[0].road),r._joinTwoNodes(r._startZoneId,r._startNode,e))}),a||u.forEach(function(t){t=r._insertTempNodeToRoad(r._startZoneId,t.cross,t.road),r._joinTwoNodes(r._startZoneId,r._startNode,t)}),s==e.size())return c.default.ROUTE_FAILED_NO_DATA_START}if(o&&null!=this._startModel&&0<this._startModel.doors.length){for(var n=null,l=!1,d=0;d<this._startModel.doors.length;d++){var n=this._startModel.doors[d],h=this._startModel.doorEntrys[d];h!=C.default.NaviEntranceType_EXIT&&h!=C.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._startZoneId,this._startNode,n),l=!0)}if(!l)return c.default.ROUTE_FAILED_NO_DATA_START}}},{key:"_processEndPoint",value:function(i,t){var r=this;this._endNode=this._insertTmpIsolatedNode(this._endZoneId,i);var e=null,o=!0,e=null!=this._endModel&&this._endModel.pass==C.default.NaviModelPassType_PASS_THROUGH&&0==this._endModel.doors.length?this._seekNearRoads(this._endZoneId,i,t,30,this._endModel):this._seekNearRoads(this._endZoneId,i,t);if(null==this._endModel&&(o=!1),0<e.size()){o=!1,e.each(function(t,e,n){for(n=0;n<e.length;n++)0!=e[n].road.roadEntry&&(o=!0)});var s=0,a=!1,u=[];if(e.each(function(t,e){var n=e[0].road,e=r._exploreUprightLikelyJoints(r._endZoneId,i,n,e,r._endModel);0==e.length?s++:Math.abs(e[0].rotateAngle)>A.default.epsilon()?u.push.apply(u,(0,f.default)(e)):(a=!0,e=r._insertTempNodeToRoad(r._endZoneId,e[0].cross,e[0].road),r._joinTwoNodes(r._endZoneId,r._endNode,e))}),a||u.forEach(function(t){t=r._insertTempNodeToRoad(r._endZoneId,t.cross,t.road),r._joinTwoNodes(r._endZoneId,r._endNode,t)}),s==e.size())return c.default.ROUTE_FAILED_NO_DATA_END}if(o&&null!=this._endModel&&0<this._endModel.doors.length){for(var n=null,l=!1,d=0;d<this._endModel.doors.length;d++){var n=this._endModel.doors[d],h=this._endModel.doorEntrys[d];h!=C.default.NaviEntranceType_ENTRANCE&&h!=C.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._endZoneId,this._endNode,n),l=!0)}if(!l)return c.default.ROUTE_FAILED_NO_DATA_END}}},{key:"_routeCalculate",value:function(){window.DEBUG&&h.default.printRoads(this._naviGraph);var t=this._isPointInPNTModel(this._startNode.point);if(t&&(this._switchVariableHinderTo(this._startZoneId,t,C.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._startZoneId,model:t})),t=this._isPointInPNTModel(this._endNode.point),t&&(this._switchVariableHinderTo(this._endZoneId,t,C.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._endZoneId,model:t})),this._resultVector=[],this._startZoneId==this._endZoneId){var e=this._zoneIdSimpleDijkstraMap.get(this._startZoneId),n=e.routeCalculate(this._startNode,this._endNode,this._mode);if(n!=c.default.ROUTE_SUCCESS)return n;var i=e.getRouteCalculateResult();this._resultVector=[],i.reverse(),(n=this._resultVector).push.apply(n,(0,f.default)(i))}else{if(-1!=this._startZoneId&&-1==this._endZoneId){if(e=this._findNearZoneDoor(this._startNode.point,this._startZoneId,C.default.NaviEntranceType_EXIT),n=this._zoneIdSimpleDijkstraMap.get(this._startZoneId),i=n.routeCalculate(this._startNode,e,this._mode),i!=c.default.ROUTE_SUCCESS)return i;var r=n.getRouteCalculateResult(r),n=this._zoneIdSimpleDijkstraMap.get(-1),i=n.routeCalculate(e,this._endNode,this._mode);if(i!=c.default.ROUTE_SUCCESS)return i;i=n.getRouteCalculateResult(),r.reverse(),i.reverse(),(n=this._resultVector).push.apply(n,(0,f.default)(r)),(r=this._resultVector).push.apply(r,(0,f.default)(i))}if(-1==this._startZoneId&&-1!=this._endZoneId){var o=this._findNearZoneDoor(this._endNode.point,this._endZoneId,C.default.NaviEntranceType_ENTRANCE),s=this._zoneIdSimpleDijkstraMap.get(this._endZoneId),a=s.routeCalculate(o,this._endNode,this._mode);if(a!=c.default.ROUTE_SUCCESS)return a;var u=s.getRouteCalculateResult(),s=this._zoneIdSimpleDijkstraMap.get(-1),a=s.routeCalculate(this._startNode,o,this._mode);if(a!=c.default.ROUTE_SUCCESS)return a;o=s.getRouteCalculateResult(),o.reverse(),u.reverse(),(a=this._resultVector).push.apply(a,(0,f.default)(o)),(s=this._resultVector).push.apply(s,(0,f.default)(u))}if(-1!=this._startZoneId&&-1!=this._endZoneId){if(a=this._findNearZoneDoor(this._startNode.point,this._startZoneId,C.default.NaviEntranceType_EXIT),o=this._zoneIdSimpleDijkstraMap.get(this._startZoneId),s=o.routeCalculate(this._startNode,a,this._mode),s!=c.default.ROUTE_SUCCESS)return s;var l=o.getRouteCalculateResult(l),u=this._findNearZoneDoor(this._endNode.point,this._endZoneId,C.default.NaviEntranceType_ENTRANCE),o=this._zoneIdSimpleDijkstraMap.get(this._endZoneId),s=o.routeCalculate(u,this._endNode,this._mode);if(s!=c.default.ROUTE_SUCCESS)return s;var d=o.getRouteCalculateResult(d),o=this._zoneIdSimpleDijkstraMap.get(-1);if(s=o.routeCalculate(a,u,this._mode),s!=c.default.ROUTE_SUCCESS)return s;s=o.getRouteCalculateResult(),l.reverse(),s.reverse(),d.reverse(),(o=this._resultVector).push.apply(o,(0,f.default)(l)),(l=this._resultVector).push.apply(l,(0,f.default)(s)),(s=this._resultVector).push.apply(s,(0,f.default)(d))}}return c.default.ROUTE_SUCCESS}},{key:"_getIndexFormID",value:function(t,e,n){for(var i=0;i<e;i++)if(null!=t[i]&&t[i].Id==n)return i;return-1}},{key:"_calcZoneIdByCoord",value:function(t){for(var e=this._naviGraph.zones,n=0;n<e.length;n++){var i=e[n];if(i.contain(t))return i.Id}return-1}},{key:"_segmentByZones",value:function(){for(var n=this,t=this._naviGraph.zones,e=0;e<t.length;e++){var i=t[e],r=this._sliceGraph(this._naviGraph,i);this._zoneIdGraph.put(i.Id,r)}this._zoneIdGraph.put(-1,this._naviGraph),this._zoneIdGraph.each(function(t,e){e.simplify(),n._zoneIdSimpleDijkstraMap.put(t,new u.default(e))}),this._zoneIdGraph.each(function(t,e){e.consoleNodeInfos(),e.consoleRoadInfos()})}},{key:"_sliceGraph",value:function(t,e){if(t&&e){for(var n,i=0,r=0,o=t.roadVector.length,s=t.nodeVector.length,a=t.roadVector,u=t.nodeVector,l=0,d=new Int8Array(o),h=0;h<o;h++)a[h]&&a[h].roadEntry!=C.default.NaviRoadEntry_FORBID&&(n=a[h],i=e.contain(n.startPoint),r=e.contain(n.endPoint),0==i&&0==r||(l=!0),1==i&&1==r&&(d[h]=1),1==i&&0==r&&(d[h]=2),0==i&&1==r&&(d[h]=3),0==i&&0==r&&(d[h]=4),2==i&&0==r&&(d[h]=6),2==i&&1==r&&(d[h]=7),0==i&&2==r&&(d[h]=8),1==i&&2==r&&(d[h]=9));if(0==l)return null;for(var f,c,p,_,v,y,g=new Array(s),I=new Array(o),T=0,x=new Int8Array(s),N=d.length,m=0,R=N;m<R;m++)0!=d[m]&&6!=d[m]&&8!=d[m]&&1!=d[m]&&a[m]&&(f=a[m],c=f.roadEntry,v=[f.Id],2==d[m]||9==d[m]?(p=null,p=2==d[m]?e.calcCrossPoint(f.startPoint,f.endPoint):(0,w.default)({},f.endPoint),y=new D.default,y.Id=this._naviGraph.generateNodeId(),y.nodeType=C.default.NaviNodeType_COMMON,y.liftType=C.default.NaviLiftType_NULL,y.entranceType=C.default.NaviEntranceType_ACCESS,y.point=(0,w.default)({},p),_=new F.default,_.setRoad(f),_.Id=this._naviGraph.generateRoadId(),v.push(_.Id),y.segLinks=v,p=new D.default,p.setNode(y),c==C.default.NaviRoadEntry_FORWARD?p.entranceType=C.default.NaviEntranceType_EXIT:c==C.default.NaviRoadEntry_BACK&&(p.entranceType=C.default.NaviEntranceType_ENTRANCE),e._linkAccessNodes.push(p),T=this._getIndexFormID(u,s,_.endId),_.endPoint=(0,w.default)({},p.point),_.pointVector[1]=(0,w.default)({},p.point),_.endId=p.Id,_.calcLength(),I[m]=_,g[T]=p,T=this._getIndexFormID(u,s,_.startId),g[T]=u[T],g[T].segLinks.splice(g[T].segLinks.indexOf(f.Id),1,_.Id),_=new D.default,_.setNode(y),f.startId=_.Id,f.startPoint=(0,w.default)({},_.point),f.pointVector[0]=(0,w.default)({},_.point),f.calcLength(),u[T].segLinks.splice(u[T].segLinks.indexOf(f.Id),1),u.push(_),x[T]=2):3!=d[m]&&7!=d[m]||(y=null,y=3==d[m]?e.calcCrossPoint(f.startPoint,f.endPoint):(0,w.default)({},f.startPoint),_=new D.default,_.Id=this._naviGraph.generateNodeId(),_.nodeType=C.default.NaviNodeType_COMMON,_.liftType=C.default.NaviLiftType_NULL,_.entranceType=C.default.NaviEntranceType_ACCESS,_.point=(0,w.default)({},y),y=new F.default,y.setRoad(f),y.Id=this._naviGraph.generateRoadId(),v.push(y.Id),_.segLinks=v,v=new D.default,v.setNode(_),c==C.default.NaviRoadEntry_FORWARD?v.entranceType=C.default.NaviEntranceType_ENTRANCE:c==C.default.NaviRoadEntry_BACK&&(v.entranceType=C.default.NaviEntranceType_EXIT),e._linkAccessNodes.push(v),T=this._getIndexFormID(u,s,y.startId),y.startPoint=(0,w.default)({},v.point),y.pointVector[0]=(0,w.default)({},v.point),y.startId=v.Id,y.calcLength(),I[m]=y,g[T]=v,T=this._getIndexFormID(u,s,y.endId),g[T]=u[T],g[T].segLinks.splice(g[T].segLinks.indexOf(f.Id),1,y.Id),y=new D.default,y.setNode(_),f.endId=y.Id,f.endPoint=(0,w.default)({},y.point),f.pointVector[1]=(0,w.default)({},y.point),f.calcLength(),u[T].segLinks.splice(u[T].segLinks.indexOf(f.Id),1),u.push(y),x[T]=2));for(var E,M=0,k=N;M<k;M++)1==d[M]&&(E=a[M],E&&(I[M]=E,T=this._getIndexFormID(u,s,E.startId),2!=x[T]&&(g[T]=u[T],x[T]=1),T=this._getIndexFormID(u,s,E.endId),2!=x[T]&&(g[T]=u[T],x[T]=1),a[M]=null));for(var P=0;P<s;P++)1==x[P]&&(u[P]=null);for(var N=new z.default(g,I,!0,1),L=[],A=t.obstructModels,O=0;O<A.length;O++){var S,b=A[O];b&&(S=this._modelInZone(b,e),S&&L.push(b))}return(t=N.obstructModels).push.apply(t,L),N}}},{key:"_assemblePassNotThroughModels",value:function(){var s=this;this._zoneIdGraph.each(function(t,e){for(var n=e.obstructModels,i=0;i<n.length;i++){var r,o=n[i];C.default.NaviModelPassType_PASS_NOT_THROUGH==o.pass&&(r=s._zonePNTModelsMap.get(t),r||(r=[],s._zonePNTModelsMap.put(t,r)),r.push(o))}}),this._zonePNTModelsMap.each(function(t,e){for(var n=0;n<e.length;n++)e[n].fid})}},{key:"_assembleNotPassModels",value:function(){var s=this;this._zoneIdGraph.each(function(t,e){for(var n=e.obstructModels,i=0;i<n.length;i++){var r,o=n[i];C.default.NaviModelPassType_NOT_PASS==o.pass&&(r=s._zoneNPModelsMap.get(t),r||(r=[],s._zoneNPModelsMap.put(t,r)),r.push(o))}}),this._zoneNPModelsMap.each(function(t,e){for(var n=0;n<e.length;n++)e[n].fid})}},{key:"_fitVariableRoadsToModel",value:function(){var a=this;this._zonePNTModelsMap.each(function(t,e){for(var n=a._zoneIdGraph.get(t).roadVector,i=0;i<e.length;i++){for(var r=e[i],o=0;o<n.length;o++){var s=n[o].calcMiddlePoint();A.default.pointInPolygon2d(r.points,s,r.pointCount)&&(n[o].length=n[o].length*a._kScaleVariable,s=a._modelIdRoadsMap.get(r.Id),s||(s=[],a._modelIdRoadsMap.put(r.Id,s)),s.push(n[o]))}a._switchVariableHinderTo(t,r,C.default.NaviRoadHinderType_HINDER_HIGH)}})}},{key:"_adjustNPModelRoads",value:function(){var p=this;this._zoneNPModelsMap.each(function(t,e){for(var n=p._zoneIdGraph.get(t),i=n.roadVector,r=0;r<e.length;r++)for(var o=e[r],s=0;s<i.length;s++){var a=i[s],u=a.roadEntry,l=a.calcMiddlePoint();if(A.default.pointInPolygon2d(o.points,l,o.pointCount-1)){if(a.length=Number.MAX_VALUE,u==C.default.NaviRoadEntry_BOTH||u==C.default.NaviRoadEntry_FORWARD){var d=p._zoneIdGraph.get(t).adjList.get(a.startId);if(d)for(var h=0;h<d.length;h++)d[h].nodeId==a.endId&&(d[h].length=a.length)}if(a.roadEntry==C.default.NaviRoadEntry_BOTH||a.roadEntry==C.default.NaviRoadEntry_BACK){var f=p._zoneIdGraph.get(t).adjList.get(a.endId);if(f)for(var c=0;c<f.length;c++)f[c].nodeId==a.startId&&(f[c].length=a.length)}}}})}},{key:"_switchVariableHinderTo",value:function(t,e,n){var i=this._modelIdRoadsMap.get(e.Id);if(i){if(C.default.NaviRoadHinderType_HINDER_HIGH==n)for(var r=0;r<i.length;r++){var o=i[r];if(o.calcLength(),o.length=i.length*this._kScaleVariable,o.roadEntry==C.default.NaviRoadEntry_BOTH||o.roadEntry==C.default.NaviRoadEntry_FORWARD){var s=this._zoneIdGraph.get(t).adjList.get(o.startId);if(s)for(var a=0;a<s.length;a++)s[a].nodeId==o.endId&&(s[a].length=o.length)}if(o.roadEntry==C.default.NaviRoadEntry_BOTH||o.roadEntry==C.default.NaviRoadEntry_BACK){var u=this._zoneIdGraph.get(t).adjList.get(o.endId);if(u)for(var l=0;l<u.length;l++)u[l].nodeId==o.startId&&(u[l].length=o.length)}}if(C.default.NaviRoadHinderType_HINDER_GENERAL==n)for(var d=0;d<i.length;d++){var h=i[d];if(h.calcLength(),h.roadEntry==C.default.NaviRoadEntry_BOTH||h.roadEntry==C.default.NaviRoadEntry_FORWARD){var f=this._zoneIdGraph.get(t).adjList.get(h.startId);if(f)for(var c=0;c<f.length;c++)f[c].nodeId==h.endId&&(f[c].length=h.length)}if(h.roadEntry==C.default.NaviRoadEntry_BOTH||h.roadEntry==C.default.NaviRoadEntry_BACK){var p=this._zoneIdGraph.get(t).adjList.get(h.endId);if(p)for(var _=0;_<p.length;_++)p[_].nodeId==h.startId&&(p[_].length=h.length)}}}}},{key:"_findNearZoneDoor",value:function(t,e,n){var i=this._naviGraph.getZone(e);if(null==i)return null;for(var r=this._zoneIdGraph.get(e).findModel(t,o),o=r.area,s=Number.MAX_VALUE,a=null,u=0;u<i._linkAccessNodes.length;u++){var l,d=i._linkAccessNodes[u],h=A.default.distanceOfTwoPoints(d.point,t);d.entranceType!=C.default.NaviEntranceType_ACCESS&&d.entranceType!=n||h<s&&(l=this._findMinAreaNearestObstructModel(e,d.point),l!=r&&l.pass==C.default.NaviModelPassType_PASS_NOT_THROUGH||(s=h,a=d))}return a}},{key:"_findMinAreaNearestObstructModel",value:function(t,e){for(var n=null,t=this._zoneIdGraph.get(t),i=Number.MAX_VALUE,r=Number.MAX_VALUE,o=null,s=t.obstructModels,a=0;a<s.length;a++){var u=s[a],l=A.default.pointToPolygon2d(u.points,e,u.points.length-1);l<r&&(r=l,o=u),this._kDoorToler>l&&(l=u.area,l<i&&(i=l,n=u))}return null==n?o:n}},{key:"_modelInZone",value:function(t,e){return!t.bb.isSeparate(e.bb)&&(t=t.center,!!A.default.pointInPolygon2d(e.points,t,e.pointCount))}},{key:"_insertTempNodeToRoad",value:function(t,e,n){var i=this._tmpAdjNodeIds.find(function(t){return t==n.startId}),r=this._tmpAdjNodeIds.find(function(t){return t==n.endId});null==i&&this._tmpAdjNodeIds.push(n.startId),null==r&&this._tmpAdjNodeIds.push(n.endId);for(var o=this._unattachedTempRoadTrees,s=null,a=0;a<o.length;a++)if(o[a]._wrappedRoad==n){s=o[a];break}if(null==s)s={},s._wrappedRoad=n,o.push(s);else for(;null!=s._fromChild;)var u=s._fromChild._wrappedRoad,s=A.default.pointIsInRect1(e,u.startPoint,u.endPoint)?s._fromChild:s._toChild;n=s._wrappedRoad;var l=new D.default;l.Id=this._newTmpId(),l.point=e;var d=new F.default;d.Id=this._newTmpId(),d.startId=n.startId,d.startPoint=n.startPoint,d.endId=l.Id,d.endPoint=l.point,d.pointVector=[n.startPoint,l.point],d.roadRank=n.roadRank;var h=new F.default;h.Id=this._newTmpId(),h.startId=l.Id,h.startPoint=l.point,h.endId=n.endId,h.endPoint=n.endPoint,h.pointVector=[l.point,n.endPoint],h.roadRank=n.roadRank,this._unattachedTempRoads.push(d),this._unattachedTempRoads.push(h),i={},i._wrappedRoad=d,r={},r._wrappedRoad=h,s._fromChild=i,s._toChild=r,l.tempType=1,d.tempType=1,h.tempType=1,d.calcLength(),h.calcLength(),d.roadEntry=n.roadEntry,h.roadEntry=n.roadEntry,r=this._zoneIdGraph.get(t),r.nodeVector.push(l),r.roadVector.push(d),r.roadVector.push(h);var f,t=this._zoneIdSimpleDijkstraMap.get(t)._naviGraph;return t._nodeMap.put(l.Id,r.nodeVector.length-1),n.roadEntry==C.default.NaviRoadEntry_BOTH&&(r=[],r.push({nodeId:n.startId,length:d.length}),r.push({nodeId:n.endId,length:h.length}),t.adjList.put(l.Id,r),r=t.adjList.get(n.startId),r||(r=[],t.adjList.put(n.startId,r)),r.push({nodeId:l.Id,length:d.length}),r=t.adjList.get(n.endId),r||(r=[],t.adjList.put(n.endId,r)),r.push({nodeId:l.Id,length:h.length})),n.roadEntry==C.default.NaviRoadEntry_FORWARD&&(f=[],f.push({nodeId:n.endId,length:h.length}),t.adjList.put(l.Id,f),f=t.adjList.get(n.startId),f||(f=[],t.adjList.put(n.startId,f)),f.push({nodeId:l.Id,length:d.length})),n.roadEntry==C.default.NaviRoadEntry_BACK&&(f=[],f.push({nodeId:n.startId,length:d.length}),t.adjList.put(l.Id,f),f=t.adjList.get(n.endId),f||(f=[],t.adjList.put(n.endId,f)),f.push({nodeId:l.Id,length:h.length})),l}},{key:"_insertItemToVector",value:function(t,e){for(var n=e.length-1;0<=n;n--)if(e[n].Id&&0<e[n].Id)return e.splice(n+1,0,t),n+1;return-1}},{key:"_insertNodeToRoad",value:function(t,e,n,i){if(i)return this._insertTempNodeToRoad(t,e,n);var r=this._zoneIdGraph.get(t),o=new D.default;o.Id=r.generateNodeId(),o.point=e;var s=new F.default;s.Id=r.generateRoadId(),s.startId=n.startId,s.startPoint=n.startPoint,s.endId=o.Id,s.endPoint=o.point,s.pointVector=[n.startPoint,o.point],i=new F.default,i.Id=r.generateRoadId(),i.startId=o.Id,i.startPoint=o.point,i.endId=n.endId,i.endPoint=n.endPoint,i.pointVector=[o.point,n.endPoint],t=[],t.push(s.Id),t.push(i.Id),o.segLinks=t,s.calcLength(),i.calcLength(),s.roadEntry=n.roadEntry,i.roadEntry=n.roadEntry;var a,e=r.nodeVector,t=r.roadVector,e=this._insertItemToVector(o,e);return this._insertItemToVector(s,t),this._insertItemToVector(i,t),r._nodeMap.put(o.Id,e),n.roadEntry==C.default.NaviRoadEntry_BOTH&&(e=[],e.push({nodeId:n.startId,length:s.length}),e.push({nodeId:n.endId,length:i.length}),r.adjList.put(o.Id,e),e=r.adjList.get(n.startId),e||(e=[],r.adjList.put(n.startId,e)),e.push({nodeId:o.Id,length:s.length}),e=r.adjList.get(n.endId),e||(e=[],r.adjList.put(n.endId,e)),e.push({nodeId:o.Id,length:i.length})),n.roadEntry==C.default.NaviRoadEntry_FORWARD&&(a=[],a.push({nodeId:n.endId,length:i.length}),r.adjList.put(o.Id,a),a=r.adjList.get(n.startId),a||(a=[],r.adjList.put(n.startId,a)),a.push({nodeId:o.Id,length:s.length})),n.roadEntry==C.default.NaviRoadEntry_BACK&&(a=[],a.push({nodeId:n.startId,length:s.length}),r.adjList.put(o.Id,a),a=r.adjList.get(n.endId),a||(a=[],r.adjList.put(n.endId,a)),a.push({nodeId:o.Id,length:i.length})),o}},{key:"_clearTmpPoint",value:function(t){if(null!=t){for(var e=this._zoneIdGraph.get(t),n=e.nodeVector.length-1;0<=n;n--){var i=e.nodeVector[n];if(null==i||0<=i.Id)break;e.nodeVector.splice(n,1)}for(var r=e.roadVector.length-1;0<=r;r--){var o=e.roadVector[r];if(null==o||0<=o.Id)break;e.roadVector.splice(r,1)}}}},{key:"_deleteTmpConnectionEntirely",value:function(t,e){var n=t.get(e);if(n)for(var i=0;i<n.length;i++)n[i].nodeId<0&&(n.splice(i,1),i--)}},{key:"_removeConnection",value:function(t,e){for(var n=t.get(e),i=0;i<n.length;i++)this._deleteTmpConnectionEntirely(t,n[i].nodeId);t.remove(e)}},{key:"_calcAdherenceAtOneAngle",value:function(t,e,n,i,r,o){r.toDistance=Number.MAX_VALUE,r.stickToRoad=!1,r.rotateAngle=0;for(var s=Number.MAX_VALUE,a={},u=this._zoneIdGraph.get(t),l=0;l<u.roadVector.length;l++){var d,h=u.roadVector[l];null!=h&&h.roadEntry!=C.default.NaviRoadEntry_FORBID&&(d=A.default.quickRayIntersect(e,n,h.startPoint,h.endPoint,a),d&&(d=A.default.distanceOfTwoPoints(e,a),(d<s||Math.abs(d-s)<.1&&h.Id<0)&&(s=d,r.cross=(0,w.default)({},a),r.distance=s,r.road=h,r.stickToRoad=!0)))}for(var u=this._zoneIdGraph.get(-1),f={},c=0;c<u.obstructModels.length;c++){var p=u.obstructModels[c];if(null!=p&&p!=o&&C.default.NaviModelPassType_DECORATE!=p.pass&&(null==o||!A.default.pointInPolygon2d(p.points,o.center,p.points.length-1)))for(var _=p.points.length,v=0;v<_-1;v++){var y=A.default.quickRayIntersect(e,n,p.points[v],p.points[v+1],f);if(y&&(y=A.default.distanceOfTwoPoints(e,f),y<s))return s=y,r.model=p,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=C.default.NaviObstructType_MODEL,!1}}for(var g={},I=u.obstructExtents,T=0;T<I.length;T++){for(var x=I[T],N=I[T].holes,m=0;m<N.length;m++)for(var R=N[m],E=0;E<R.length-1;E++){var M=A.default.quickRayIntersect(e,n,R[E],R[E+1],g);if(M&&(M=A.default.distanceOfTwoPoints(e,g),M<s))return s=M,r.model=x,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=C.default.NaviObstructType_EXTENT,!1}for(var k=I[T].points,P=0;P<k.length-1;P++){var L=A.default.quickRayIntersect(e,n,k[P],k[P+1],g);if(L&&(L=A.default.distanceOfTwoPoints(e,g),L<s))return s=L,r.model=x,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=C.default.NaviObstructType_EXTENT,!1}}return r.toDistance=A.default.distanceOfTwoPoints(r.cross,i),!0}},{key:"_adherenceCompare",value:function(t,e){return t.toDistance-e.toDistance}},{key:"_adherenceAngleCompare",value:function(t,e){return e.rotateAngle-t.rotateAngle}},{key:"_clearTempElements",value:function(t){if(t=this._zoneIdGraph.get(t),t){for(var e=t.nodeVector,n=e.length-1;0<=n;n--){var i=e[n];if(null==i||0<=i.Id)break;e.splice(n,1)}for(var r=t.roadVector,o=r.length-1;0<=o;o--){var s=r[o];if(null==s||0<=s.Id)break;r.splice(o,1)}}}},{key:"_clearTempAdjList",value:function(){var a=this;this._zoneIdSimpleDijkstraMap.each(function(t,e){for(var n=[],i=e._naviGraph.adjList,r=0;r<i.keys.length;r++)i.keys[r]<0&&n.push(i.keys[r]);for(var o=0;o<n.length;o++)a._removeConnection(e._naviGraph.adjList,n[o]);for(var s=0;s<a._tmpAdjNodeIds.length;s++)a._deleteTmpConnectionEntirely(i,a._tmpAdjNodeIds[s])})}},{key:"_exploreUprightLikelyJoints",value:function(t,e,n,i,r){for(var o=[],s=0;s<i.length;s++)if(i[s].distance<A.default.epsilon())return o.push(i[s]),o;var a={x:0,y:0},u=A.default.calcFootOfUpright(e,n.startPoint,n.endPoint,a),l={};if(u&&this._isTwoPointsConnectedDirectly(e,a,l,r))return r={},r.cross=a,r.stickToRoad=!0,r.road=n,r.rotateAngle=0,r.dist=A.default.distanceOfTwoPoints(e,a),o.push(r),o;for(var d={x:a.x-e.x,y:a.y-e.y},h=0;h<i.length;h++){var f=i[h],c={x:f.cross.x-e.x,y:f.cross.y-e.y},c=A.default.calcRotateAngle(c,d),c=270<c?c-360:c;f.rotateAngle=c}i.sort(this._adherenceAngleCompare);var p=null,_=null;if(i[i.length-1].rotateAngle<0)return p=i[i.length-1],o.push(p),o;for(var v=0;v<i.length;v++)if(0<=i[v].rotateAngle)return p=i[v],0==v?o.push(p):(_=i[v-1],A.default.distanceOfTwoPoints(p.cross,n.startPoint)>A.default.distanceOfTwoPoints(_.cross,n.startPoint)?(o.push(_),o.push(p)):(o.push(p),o.push(_))),o;return o}},{key:"_calcAllAdherance",value:function(t,e,n,i,r,o){for(var s=r||30,a=0;a<360;a+=s){var u=new l.default;this._calcAdherenceAtOneAngle(t,e,a,n,u,o),1==u.stickToRoad&&i.push(u)}i.sort(this._adherenceCompare)}},{key:"_seekNearRoads",value:function(t,e,n,i,r){var o=new d.default,s=[];for(this._calcAllAdherance(t,e,n,s,i,r);0!=s.length;){var a=s[0],u=o.get(a.road.Id);u?u.push(a):(u=[],u.push(a),o.put(a.road.Id,u)),s.splice(0,1)}return o}},{key:"_insertTmpIsolatedNode",value:function(t,e){var n=new D.default;return n.Id=this._newTmpId(),n.point=(0,w.default)({},e),e=this._zoneIdGraph.get(t),e.nodeVector.push(n),t=this._zoneIdSimpleDijkstraMap.get(t),t._naviGraph._nodeMap.put(n.Id,e.nodeVector.length-1),n}},{key:"_insertIsolatedNode",value:function(t,e,n){return n?this._insertTmpIsolatedNode(t,e):(n=new D.default,n.Id=this._naviGraph.generateNodeId(),n.point=(0,w.default)({},e),e=this.zoneIdGraph.get(t),t=e.nodeVector,t=this._insertItemToVector(n,t),e._nodeMap.put(n.Id,t),n)}},{key:"_isTwoPointsConnectedDirectly",value:function(t,e,n,i){for(var r=this._zoneIdGraph.get(-1),o=null,s=0;s<r.obstructModels.length;s++)if(o=r.obstructModels[s],null!=o&&o!=i&&C.default.NaviModelPassType_DECORATE!=o.pass)for(var a=o.points,u=0;u<a.length-1;u++)if(A.default.calcCrossPoint(t,e,a[u],a[u+1],n)){var l=A.default.distanceOfTwoPoints(t,n),d=A.default.distanceOfTwoPoints(e,n);if(!(l<=A.default.epsilon()||d<=A.default.epsilon()))return!1}for(var h=r.obstructExtents,f=0;f<h.length;f++){for(var c=h[f],p=c.holes,_=0;_<p.length;_++)for(var v=p[_],y=0;y<v.length-1;y++)if(A.default.calcCrossPoint(t,e,v[y],v[y+1],n))return!1;for(var g=c.points,I=0;I<g.length-1;I++)if(A.default.calcCrossPoint(t,e,g[I],g[I+1],n))return!1}return!0}},{key:"_joinTwoNodes",value:function(t,e,n,i,r,o){for(var s=0;s<this._attachedTempRoads.length;s++){var a=this._attachedTempRoads[s],u={};if(1==A.default.calcCrossPoint(a.startPoint,a.endPoint,e.point,n.point,u)&&A.default.distanceOfTwoPoints(e.point,u)>A.default.epsilon()&&A.default.distanceOfTwoPoints(n.point,u)>A.default.epsilon())return null}void 0===i&&(i=C.default.NaviRoadEntry_BOTH),void 0===r&&(r=!0),void 0===o&&(o=!0);var l=new F.default;l.startId=e.Id,l.startPoint=e.point,l.endId=n.Id,l.endPoint=n.point,l.pointVector=[e.point,n.point],l.roadRank=1,this._tmpAdjNodeIds.push(e.Id),this._tmpAdjNodeIds.push(n.Id),l.Id=r?this._newTmpId():this._naviGraph.generateRoadId(),l.roadEntry=i,l.calcLength(),o&&this._attachedTempRoads.push(l),o=this._zoneIdGraph.get(t),o.roadVector.push(l);var d,h,o=this._zoneIdSimpleDijkstraMap.get(t);return C.default.NaviRoadEntry_BOTH==i&&(t={nodeId:n.Id,length:l.length},d=o._naviGraph.adjList.get(e.Id),d?d.push(t):(d=[],d.push(t),o._naviGraph.adjList.put(e.Id,d)),t={nodeId:e.Id,length:l.length},d=o._naviGraph.adjList.get(n.Id),d?d.push(t):(d=[],d.push(t),o._naviGraph.adjList.put(n.Id,d))),C.default.NaviRoadEntry_FORWARD==i&&(d={nodeId:n.Id,length:l.length},h=o._naviGraph.adjList.get(e.Id),h?h.push(d):(h=[],h.push(d),o._naviGraph.adjList(e.Id,h))),C.default.NaviRoadEntry_BACK==i&&(i={nodeId:e.Id,length:l.length},h=o._naviGraph.adjList.get(n.Id),h?h.push(i):(h=[],h.push(i),o._naviGraph.adjList.put(n.Id,h))),l}},{key:"_isPointInPNTModel",value:function(t){var e=this._calcZoneIdByCoord(t),n=this._zonePNTModelsMap.get(e);if(n)for(var i=0;i<n.length;i++){var r=n[i];if(A.default.pointInPolygon2d(r.points,t,r.points.length))return r}return null}},{key:"_newTmpId",value:function(){return this._tmpId--}}]),e}(),e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(3)),n=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,null,[{key:"printRoads",value:function(t){}}]),t}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(3)),u=r(n(259)),n=function(){function t(){(0,o.default)(this,t),this._dijkCollection=[]}return(0,s.default)(t,[{key:"loadGraphs",value:function(t){var s=0,a=this;t.each(function(t,e,n){for(var i=e.obstructExtents,r=0;r<i.length;r++){var o=i[r].Id,o=e.getGraphByEid(o),o=new u.default(s++,o);o.gid=t,a._dijkCollection.push(o)}})}},{key:"each",value:function(t){for(var e=0;e<this._dijkCollection.length;e++)t(this._dijkCollection[e])}},{key:"len",value:function(){return this._dijkCollection.length}},{key:"get",value:function(t){return this._dijkCollection[t]}},{key:"getDijkByPoint",value:function(t,e){var n,i=this._dijkCollection;for(n in i){var r=i[n];if(t==r.gid&&r.containsPt(e))return r}return null}},{key:"getDijkById",value:function(t){var e,n=this._dijkCollection;for(e in n){var i=n[e];if(i.Id==t)return i}return null}}]),t}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var w=r(n(15));n(16),n(26),n(143),n(66),n(32),n(31),n(51);var v=r(n(29)),o=r(n(2)),s=r(n(3)),A=r(n(12)),C=r(n(33)),a=r(n(41)),l=r(n(144)),D=r(n(42)),F=r(n(94)),d=r(n(50)),u=r(n(96)),z=r(n(95)),f=r(n(49)),h=r(n(146)),c=r(n(261)),p=n(147),n=function(){function n(t,e){(0,o.default)(this,n),this.Id=t,this._startModel=null,this._endModel=null,this._naviGraph=e,this._zoneMap=new d.default,this._zoneIdGraph=new d.default,this._originDijkstra=null,this._zoneIdDijkstras=new d.default,this._resultVector=[],this._startZoneId=Number.INT_MIN,this._endZoneId=Number.INT_MIN,this._tmpId=-1,this._startNode=null,this._endNode=null,this._mode=a.default.MODULE_SHORTEST,this._zonePNTModelsMap=new d.default,this._zoneNPModelsMap=new d.default,this._modelIdRoadsMap=new d.default,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[],this._kScaleVariable=100,this._kRemainedZoneId=-1,this._kMinModelAngle=15,this._kDoorToler=.1,this._tmp_adj_node_ids=[],this._failedInsertPts=[],this._transitNodes=[],this._segmentByZones(),this._assemblePassNotThroughModels(),this._assembleNotPassModels(),this._fitVariableRoadsToModel(),this._adjustNPModelRoads(),this._KeyNodes=new c.default(["num","id","idx","node"]),this._NtoNRoutesGraph=new d.default,this._next=new p.SmallQueue,this._visited=!1,this._lifts=[]}return(0,s.default)(n,[{key:"gid",get:function(){return this._gid},set:function(t){this._gid=t}},{key:"setWayPoints",value:function(t){this._wayPts=null==t?[]:t,this._insertWayPoints()}},{key:"setStart",value:function(t){var e;t instanceof D.default?(this._startNode=t,this._KeyNodes.append({num:this._KeyNodes.size(),id:t.Id,idx:this._naviGraph.getIdxByNodeId(t.Id),node:t})):(e=new D.default,this._insertPoint(t,e)||this._failedInsertPts.push(t),this._startNode=e,this._KeyNodes.append({num:this._KeyNodes.size(),id:e.Id,idx:this._naviGraph.getIdxByNodeId(e.Id),node:e}))}},{key:"setEnd",value:function(t){var e;t instanceof D.default?(this._endNode=t,this._KeyNodes.append({num:this._KeyNodes.size(),id:t.Id,idx:this._naviGraph.getIdxByNodeId(t.Id),node:t})):(e=new D.default,this._insertPoint(t,e)||this._failedInsertPts.push(t),this._endNode=e,this._KeyNodes.append({num:this._KeyNodes.size(),id:e.Id,idx:this._naviGraph.getIdxByNodeId(e.Id),node:e}))}},{key:"predictLift",value:function(){function t(t,e){for(var n=0,i=0;i<e.length;i++){var r=(t.x-e[i][0])*(t.x-e[i][0])+(t.y-e[i][1])*(t.y-e[i][1]);n+=Math.sqrt(r)}return n}for(var e=this._naviGraph.getAllLifts(),n=0;n<e.length;n++)e[n].dist=t(e[n].point,this.getNext()._wayPts),e[n].dist+=t(e[n].point,this._wayPts),e[n].dist=e[n].dist/(0==this.getNext()._wayPts.length?1:this.getNext()._wayPts.length),e[n].liftType==C.default.NaviLiftType_Escalator&&(e[n].dist-=25),e[n].liftType==C.default.NaviLiftType_Lift&&(e[n].dist-=25);for(e.sort(function(t,e){return t.dist-e.dist}),n=0;n<e.length;n++){var i=e[n];if(-1!=i.liftFloors.indexOf(this.getNext().gid)&&this.getNext().getLiftByFlag(i.liftFlag))return i}return null}},{key:"hasRelationTo",value:function(t){for(var e=this._naviGraph.getAllLifts(),n=t.gid,i=this.gid,r=0;r<e.length;r++){var o=e[r];if((C.default.NaviLiftType_Stair==o.liftType||-1!=o.liftFloors.indexOf(n))&&null!=t.getLiftByFlag(o.liftFlag))if(o.liftEntry!=C.default.NaviLiftEntry_UP){if(o.liftEntry!=C.default.NaviLiftEntry_DOWN){if(o.liftEntry==C.default.NaviLiftEntry_BOTH)return{related:!0,dist:Math.abs(i-n)}}else if(n<i)return{related:!0,dist:Math.abs(i-n)}}else if(i<n)return{related:!0,dist:Math.abs(i-n)}}return{related:!1,dist:1/0}}},{key:"getLiftByFlag",value:function(t){0==this._lifts.length&&(this._lifts=this._naviGraph.getAllLifts());for(var e=0;e<this._lifts.length;e++)if(this._lifts[e].liftFlag==t)return this._lifts[e];return null}},{key:"containsPt",value:function(t){var e=this._naviGraph.obstructExtents[0].points;return!!A.default.pointInPolygon2d(e,t,e.length)}},{key:"getRouteCalculateResult",value:function(){return this._resultVector}},{key:"dispose",value:function(){this._startModel=null,this._endModel=null,this._naviGraph.dispose(),this._naviGraph=null,this._zoneMap.clear(),this._zoneMap=null,this._zoneIdGraph.each(function(t,e){e.dispose()}),this._zoneIdGraph.clear(),this._zoneIdGraph=null,null!=this._originDijkstra&&(this._originDijkstra.dispose(),this._originDijkstra=null),this._zoneIdDijkstras.each(function(t,e){e.dispose()}),this._zoneIdDijkstras.clear(),this._zoneIdDijkstras=null,this._resultVector=[],this._startNode=null,this._endNode=null,this._zonePNTModelsMap.clear(),this._zonePNTModelsMap=null,this._zoneNPModelsMap.clear(),this._zoneNPModelsMap=null,this._modelIdRoadsMap.clear(),this._zoneNPModelsMap=null,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"reset",value:function(){this._resultVector=[],this._clearTempPoint(this._startZoneId),this._startZoneId=Number.INT_MIN,this._clearTempPoint(this._endZoneId),this._endZoneId=Number.INT_MIN,this._clearTempAdjList(),this._tmp_adj_node_ids=[],this._tmpId=-1;for(var t=0;t<this._variableModelPairs.length;t++){var e=this._variableModelPairs[t];this._switchVariableHinderTo(e.zoneId,e.model,C.default.NaviRoadHinderType_HINDER_HIGH)}this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"pushNext",value:function(t){this._next.enqueue(t)}},{key:"getNext",value:function(){return this._next.peek()}},{key:"popNext",value:function(){return this._next.dequeue()}},{key:"_createGraph",value:function(){function s(t){for(var e=0,n=0;n<t.length-1;n++){var i=t[n].point.x-t[n+1].point.x,r=t[n].point.y-t[n+1].point.y;e+=Math.sqrt(i*i+r*r)}return e}this.keyGraph=[];var a=this;this._KeyNodes.foreach(function(t){var e=t.get("node"),t=a._KeyNodes.clone();t.dropLines({node:e});var n=[];t.foreach(function(t){n.push(t.get("id"))}),a._zoneIdDijkstras.get(-1).routeMultiDestinations(e.Id,n,a._mode);var i=[];a._zoneIdDijkstras.get(-1).getMultiRoute(i);for(var r=0;r<i.length;r++){var o=i[r];a.keyGraph.push([e.Id,o[o.length-1].Id,s(o),o])}})}},{key:"computeKeyRoutes",value:function(){if(this.getNext()){var t=this.predictLift();if(!t)return!1;this.setEnd(t)}var e=[];if(this._visited){var n=this._KeyNodes.query("node",this._endNode),i=this._KeyNodes.query("node",this._startNode);this._KeyNodes.clear(),this._KeyNodes.append(n),this._KeyNodes.append(i)}else for(var r=0;r<this._transitNodes.length;r++)e.push(this._transitNodes[r].Id);return this._createGraph(),i=new h.default(this.keyGraph),i.setSId(this._startNode.Id).setEId(this._endNode.Id).setWayNodes(e),i.route(),this._route=i.getResult(),this.convertRoute(),this.getNext()&&this.getNext().setStart(this.getNext()._naviGraph.getNodeByFlag(t.liftFlag)),this._KeyNodes=new c.default(["num","id","idx","node"]),this._visited=!0,!0}},{key:"convertRoute",value:function(){this._result=[];for(var t=function(t,e){for(var n=0;n<this.length;n++)if(this[n][0]==t&&this[n][1]==e)return this[n]},e=0;e<this._route.route.length-1;e++)for(var n=this._route.route[e],i=this._route.route[e+1],r=t.apply(this.keyGraph,[n,i]),o=0;o<r[3].length;o++)this._result.push(r[3][o])}},{key:"getResult",value:function(){return this._result}},{key:"route",get:function(){this._route}},{key:"_calcPointReachable",value:function(t){var e=this._naviGraph.queryContainExtentId(t);if(-1==e)return null;var n=this._calcZoneIdByCoord(t),i=-0,r=this._zoneIdGraph.get(n).findModel(t,i);if(null==r)return{extentId:e,model:null};if(r.pass==C.default.NaviModelPassType_PASS_THROUGH||r.pass==C.default.NaviModelPassType_PASS_NOT_THROUGH){if(0<r.doors.length)return{extentId:e,model:r};for(var o={},s=[],a=[],i=this._zoneIdGraph.get(n),u=i.roadVector,l=!0,d=r.points.length,h=0;h<d-1;h++)for(var f=r.points[h],c=r.points[h+1],p=0;p<u.length;p++){var _=u[p];1==A.default.calcCrossPoint(f,c,_.startPoint,_.endPoint,o)&&(l=!1,C.default.NaviRoadEntry_FORBID!=_.roadEntry&&(_=new Object,_.x=o.x,_.y=o.y,s.push(_),a.push(u[p])))}if(l)return{extentId:e,model:r};if(0==s.length)return null;r.doors=[],r.doorEntrys=[],r.doorTypes=[];for(var v=0;v<s.length;v++){var y=s[v],g=a[v],y=this._insertNodeToRoad(n,y,g);y.nodeType=C.default.NaviNodeType_COMMON,g.roadEntry==C.default.NaviRoadEntry_BOTH?y.entranceType=C.default.NaviEntranceType_ACCESS:A.default.pointInPolygon2d(r.points,g.startPoint,r.points.length-1)?(g.roadEntry==C.default.NaviRoadEntry_FORWARD&&(y.entranceType=C.default.NaviEntranceType_EXIT),g.roadEntry==C.default.NaviRoadEntry_BACK&&(y.entranceType=C.default.NaviEntranceType_ENTRANCE)):(g.roadEntry==C.default.NaviRoadEntry_FORWARD&&(y.entranceType=C.default.NaviEntranceType_ENTRANCE),g.roadEntry==C.default.NaviRoadEntry_BACK&&(y.entranceType=C.default.NaviEntranceType_EXIT)),r.doors.push(y),r.doorEntrys.push(y.entranceType),r.doorTypes.push(y.nodeType)}}return r.pass!=C.default.NaviModelPassType_NOT_PASS?{extentId:e,model:r}:null}},{key:"_processStartPoint",value:function(i,t){var r=this;this._startNode=this._insertTmpIsolatedNode(this._startZoneId,i);var e=null,o=!0,e=null!=this._startModel&&this._startModel.pass==C.default.NaviModelPassType_PASS_THROUGH&&0==this._startModel.doors.length?this._seekNearRoads(this._startZoneId,i,t,30,this._startModel):this._seekNearRoads(this._startZoneId,i,t);if(null==this._startModel&&(o=!1),0<e.size()){o=!1,e.each(function(t,e,n){for(n=0;n<e.length;n++)0!=e[n].road.roadEntry&&(o=!0)});var s=0,a=!1,u=[];if(e.each(function(t,e){var n=e[0].road,e=r._exploreUprightLikelyJoints(r._startZoneId,i,n,e,r._startModel);0==e.length?s++:Math.abs(e[0].rotateAngle)>A.default.epsilon()?u.push.apply(u,(0,v.default)(e)):(a=!0,e=r._insertTempNodeToRoad(r._startZoneId,e[0].cross,e[0].road),r._joinTwoNodes(r._startZoneId,r._startNode,e))}),a||u.forEach(function(t){t=r._insertTempNodeToRoad(r._startZoneId,t.cross,t.road),r._joinTwoNodes(r._startZoneId,r._startNode,t)}),s==e.size())return f.default.ROUTE_FAILED_NO_DATA_START}if(o){for(var n=null,l=!1,d=0;d<this._startModel.doors.length;d++){var n=this._startModel.doors[d],h=this._startModel.doorEntrys[d];h!=C.default.NaviEntranceType_EXIT&&h!=C.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._startZoneId,this._startNode,n),l=!0)}if(!l)return f.default.ROUTE_FAILED_NO_DATA_START}}},{key:"_processEndPoint",value:function(i,t){var r=this;this._endNode=this._insertTmpIsolatedNode(this._endZoneId,i);var e=null,o=!0,e=null!=this._endModel&&this._endModel.pass==C.default.NaviModelPassType_PASS_THROUGH&&0==this._endModel.doors.length?this._seekNearRoads(this._endZoneId,i,t,30,this._endModel):this._seekNearRoads(this._endZoneId,i,t);if(null==this._endModel&&(o=!1),0<e.size()){o=!1,e.each(function(t,e,n){for(n=0;n<e.length;n++)0!=e[n].road.roadEntry&&(o=!0)});var s=0,a=!1,u=[];if(e.each(function(t,e){var n=e[0].road,e=r._exploreUprightLikelyJoints(r._endZoneId,i,n,e,r._endModel);0==e.length?s++:Math.abs(e[0].rotateAngle)>A.default.epsilon()?u.push.apply(u,(0,v.default)(e)):(a=!0,e=r._insertTempNodeToRoad(r._endZoneId,e[0].cross,e[0].road),r._joinTwoNodes(r._endZoneId,r._endNode,e))}),a||u.forEach(function(t){t=r._insertTempNodeToRoad(r._endZoneId,t.cross,t.road),r._joinTwoNodes(r._endZoneId,r._endNode,t)}),s==e.size())return f.default.ROUTE_FAILED_NO_DATA_END}if(o){for(var n=null,l=!1,d=0;d<this._endModel.doors.length;d++){var n=this._endModel.doors[d],h=this._endModel.doorEntrys[d];h!=C.default.NaviEntranceType_EXIT&&h!=C.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._endZoneId,this._endNode,n),l=!0)}if(!l)return f.default.ROUTE_FAILED_NO_DATA_END}}},{key:"_insertPoint",value:function(i,r){var o=this;i instanceof Array&&2==i.length&&(i={x:i[0],y:i[1]});var t=null,s=!0,e={x:0,y:0},a=this._naviGraph.getModelByPoint(i),u=this._naviGraph.getZoneIdByPoint(i),n=this._insertTmpIsolatedNode(u,i);if((0,w.default)(r,n),t=null!=a&&a.pass==C.default.NaviModelPassType_PASS_THROUGH&&0==a.doors.length?this._seekNearRoads(u,i,e,30,a):this._seekNearRoads(u,i,e),null==a&&(s=!1),0<t.size()){s=!1,t.each(function(t,e,n){for(n=0;n<e.length;n++)0!=e[n].road.roadEntry&&(s=!0)});var l=0,d=!1,h=[];if(t.each(function(t,e){var n=e[0].road,e=o._exploreUprightLikelyJoints(u,i,n,e,a);0==e.length?l++:Math.abs(e[0].rotateAngle)>A.default.epsilon()?h.push.apply(h,(0,v.default)(e)):(d=!0,e=o._insertTempNodeToRoad(u,e[0].cross,e[0].road),o._joinTwoNodes(u,r,e))}),d||h.forEach(function(t){t=o._insertTempNodeToRoad(u,t.cross,t.road),o._joinTwoNodes(u,r,t)}),l==t.size())return!1}if(s){for(var f=null,c=!1,p=0;p<a.doors.length;p++){var f=a.doors[p],_=a.doorEntrys[p];_!=C.default.NaviEntranceType_EXIT&&_!=C.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(u,r,f),c=!0)}if(!c)return!1}return!0}},{key:"_routeCalculate",value:function(){var t=this._isPointInPNTModel(this._startNode.point);if(t&&(this._switchVariableHinderTo(this._startZoneId,t,C.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._startZoneId,model:t})),t=this._isPointInPNTModel(this._endNode.point),t&&(this._switchVariableHinderTo(this._endZoneId,t,C.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._endZoneId,model:t})),this._resultVector=[],this._startZoneId==this._endZoneId){var e=this._zoneIdDijkstras.get(this._startZoneId),n=e.routeCalculate(this._startNode,this._endNode,this._mode);if(n!=f.default.ROUTE_SUCCESS)return n;var i=e.getRouteCalculateResult();this._resultVector=[],i.reverse(),(n=this._resultVector).push.apply(n,(0,v.default)(i))}else{if(-1!=this._startZoneId&&-1==this._endZoneId){if(e=this._findNearZoneDoor(this._startNode.point,this._startZoneId,C.default.NaviEntranceType_EXIT),n=this._zoneIdDijkstras.get(this._startZoneId),i=n.routeCalculate(this._startNode,e,this._mode),i!=f.default.ROUTE_SUCCESS)return i;var r=n.getRouteCalculateResult(r),n=this._zoneIdDijkstras.get(-1),i=n.routeCalculate(e,this._endNode,this._mode);if(i!=f.default.ROUTE_SUCCESS)return i;i=n.getRouteCalculateResult(),r.reverse(),i.reverse(),(n=this._resultVector).push.apply(n,(0,v.default)(r)),(r=this._resultVector).push.apply(r,(0,v.default)(i))}if(-1==this._startZoneId&&-1!=this._endZoneId){var o=this._findNearZoneDoor(this._endNode.point,this._endZoneId,C.default.NaviEntranceType_ENTRANCE),s=this._zoneIdDijkstras.get(this._endZoneId),a=s.routeCalculate(o,this._endNode,this._mode);if(a!=f.default.ROUTE_SUCCESS)return a;var u=s.getRouteCalculateResult(),s=this._zoneIdDijkstras.get(-1),a=s.routeCalculate(this._startNode,o,this._mode);if(a!=f.default.ROUTE_SUCCESS)return a;o=s.getRouteCalculateResult(),o.reverse(),u.reverse(),(a=this._resultVector).push.apply(a,(0,v.default)(o)),(s=this._resultVector).push.apply(s,(0,v.default)(u))}if(-1!=this._startZoneId&&-1!=this._endZoneId){if(a=this._findNearZoneDoor(this._startNode.point,this._startZoneId,C.default.NaviEntranceType_EXIT),o=this._zoneIdDijkstras.get(this._startZoneId),s=o.routeCalculate(this._startNode,a,this._mode),s!=f.default.ROUTE_SUCCESS)return s;var l=o.getRouteCalculateResult(l),u=this._findNearZoneDoor(this._endNode.point,this._endZoneId,C.default.NaviEntranceType_ENTRANCE),o=this._zoneIdDijkstras.get(this._endZoneId),s=o.routeCalculate(u,this._endNode,this._mode);if(s!=f.default.ROUTE_SUCCESS)return s;var d=o.getRouteCalculateResult(d),o=this._zoneIdDijkstras.get(-1);if(s=o.routeCalculate(a,u,this._mode),s!=f.default.ROUTE_SUCCESS)return s;s=o.getRouteCalculateResult(),l.reverse(),s.reverse(),d.reverse(),(o=this._resultVector).push.apply(o,(0,v.default)(l)),(l=this._resultVector).push.apply(l,(0,v.default)(s)),(s=this._resultVector).push.apply(s,(0,v.default)(d))}}return f.default.ROUTE_SUCCESS}},{key:"_getIndexFormID",value:function(t,e,n){for(var i=0;i<e;i++)if(null!=t[i]&&t[i].Id==n)return i;return-1}},{key:"_calcZoneIdByCoord",value:function(t){for(var e=this._naviGraph.zones,n=0;n<e.length;n++){var i=e[n];if(i.contain(t))return i.Id}return-1}},{key:"_segmentByZones",value:function(){for(var n=this,t=this._naviGraph.zones,e=0;e<t.length;e++){var i=t[e],r=this._sliceGraph(this._naviGraph,i);this._zoneIdGraph.put(i.Id,r)}this._zoneIdGraph.put(-1,this._naviGraph),this._zoneIdGraph.each(function(t,e){e.simplify(),n._zoneIdDijkstras.put(t,new u.default(e))}),this._zoneIdGraph.each(function(t,e){e.consoleNodeInfos(),e.consoleRoadInfos()})}},{key:"_sliceGraph",value:function(t,e){if(t&&e){for(var n,i=0,r=0,o=t.roadVector.length,s=t.nodeVector.length,a=t.roadVector,u=t.nodeVector,l=0,d=new Int8Array(o),h=0;h<o;h++)a[h]&&a[h].roadEntry!=C.default.NaviRoadEntry_FORBID&&(n=a[h],i=e.contain(n.startPoint),r=e.contain(n.endPoint),0==i&&0==r||(l=!0),1==i&&1==r&&(d[h]=1),1==i&&0==r&&(d[h]=2),0==i&&1==r&&(d[h]=3),0==i&&0==r&&(d[h]=4),2==i&&0==r&&(d[h]=6),2==i&&1==r&&(d[h]=7),0==i&&2==r&&(d[h]=8),1==i&&2==r&&(d[h]=9));if(0==l)return null;for(var f,c,p,_,v,y,g=new Array(s),I=new Array(o),T=0,x=new Int8Array(s),N=d.length,m=0,R=N;m<R;m++)0!=d[m]&&6!=d[m]&&8!=d[m]&&1!=d[m]&&a[m]&&(f=a[m],c=f.roadEntry,v=[f.Id],2==d[m]||9==d[m]?(p=null,p=2==d[m]?e.calcCrossPoint(f.startPoint,f.endPoint):(0,w.default)({},f.endPoint),y=new D.default,y.Id=this._naviGraph.generateNodeId(),y.nodeType=C.default.NaviNodeType_COMMON,y.liftType=C.default.NaviLiftType_NULL,y.entranceType=C.default.NaviEntranceType_ACCESS,y.point=(0,w.default)({},p),_=new F.default,_.setRoad(f),_.Id=this._naviGraph.generateRoadId(),v.push(_.Id),y.segLinks=v,p=new D.default,p.setNode(y),c==C.default.NaviRoadEntry_FORWARD?p.entranceType=C.default.NaviEntranceType_EXIT:c==C.default.NaviRoadEntry_BACK&&(p.entranceType=C.default.NaviEntranceType_ENTRANCE),e._linkAccessNodes.push(p),T=this._getIndexFormID(u,s,_.endId),_.endPoint=(0,w.default)({},p.point),_.pointVector[1]=(0,w.default)({},p.point),_.endId=p.Id,_.calcLength(),I[m]=_,g[T]=p,T=this._getIndexFormID(u,s,_.startId),g[T]=u[T],g[T].segLinks.splice(g[T].segLinks.indexOf(f.Id),1,_.Id),_=new D.default,_.setNode(y),f.startId=_.Id,f.startPoint=(0,w.default)({},_.point),f.pointVector[0]=(0,w.default)({},_.point),f.calcLength(),u[T].segLinks.splice(u[T].segLinks.indexOf(f.Id),1),u.push(_),x[T]=2):3!=d[m]&&7!=d[m]||(y=null,y=3==d[m]?e.calcCrossPoint(f.startPoint,f.endPoint):(0,w.default)({},f.startPoint),_=new D.default,_.Id=this._naviGraph.generateNodeId(),_.nodeType=C.default.NaviNodeType_COMMON,_.liftType=C.default.NaviLiftType_NULL,_.entranceType=C.default.NaviEntranceType_ACCESS,_.point=(0,w.default)({},y),y=new F.default,y.setRoad(f),y.Id=this._naviGraph.generateRoadId(),v.push(y.Id),_.segLinks=v,v=new D.default,v.setNode(_),c==C.default.NaviRoadEntry_FORWARD?v.entranceType=C.default.NaviEntranceType_ENTRANCE:c==C.default.NaviRoadEntry_BACK&&(v.entranceType=C.default.NaviEntranceType_EXIT),e._linkAccessNodes.push(v),T=this._getIndexFormID(u,s,y.startId),y.startPoint=(0,w.default)({},v.point),y.pointVector[0]=(0,w.default)({},v.point),y.startId=v.Id,y.calcLength(),I[m]=y,g[T]=v,T=this._getIndexFormID(u,s,y.endId),g[T]=u[T],g[T].segLinks.splice(g[T].segLinks.indexOf(f.Id),1,y.Id),y=new D.default,y.setNode(_),f.endId=y.Id,f.endPoint=(0,w.default)({},y.point),f.pointVector[1]=(0,w.default)({},y.point),f.calcLength(),u[T].segLinks.splice(u[T].segLinks.indexOf(f.Id),1),u.push(y),x[T]=2));for(var E,M=0,k=N;M<k;M++)1==d[M]&&(E=a[M],E&&(I[M]=E,T=this._getIndexFormID(u,s,E.startId),2!=x[T]&&(g[T]=u[T],x[T]=1),T=this._getIndexFormID(u,s,E.endId),2!=x[T]&&(g[T]=u[T],x[T]=1),a[M]=null));for(var P=0;P<s;P++)1==x[P]&&(u[P]=null);for(var N=new z.default(g,I,!0,1),L=[],A=t.obstructModels,O=0;O<A.length;O++){var S,b=A[O];b&&(S=this._modelInZone(b,e),S&&L.push(b))}return(t=N.obstructModels).push.apply(t,L),N}}},{key:"_assemblePassNotThroughModels",value:function(){var s=this;this._zoneIdGraph.each(function(t,e){for(var n=e.obstructModels,i=0;i<n.length;i++){var r,o=n[i];C.default.NaviModelPassType_PASS_NOT_THROUGH==o.pass&&(r=s._zonePNTModelsMap.get(t),r||(r=[],s._zonePNTModelsMap.put(t,r)),r.push(o))}}),this._zonePNTModelsMap.each(function(t,e){for(var n=0;n<e.length;n++)e[n].fid})}},{key:"_assembleNotPassModels",value:function(){var s=this;this._zoneIdGraph.each(function(t,e){for(var n=e.obstructModels,i=0;i<n.length;i++){var r,o=n[i];C.default.NaviModelPassType_NOT_PASS==o.pass&&(r=s._zoneNPModelsMap.get(t),r||(r=[],s._zoneNPModelsMap.put(t,r)),r.push(o))}}),this._zoneNPModelsMap.each(function(t,e){for(var n=0;n<e.length;n++)e[n].fid})}},{key:"_fitVariableRoadsToModel",value:function(){var a=this;this._zonePNTModelsMap.each(function(t,e){for(var n=a._zoneIdGraph.get(t).roadVector,i=0;i<e.length;i++){for(var r=e[i],o=0;o<n.length;o++){var s=n[o].calcMiddlePoint();A.default.pointInPolygon2d(r.points,s,r.pointCount)&&(n[o].length=n[o].length*a._kScaleVariable,s=a._modelIdRoadsMap.get(r.Id),s||(s=[],a._modelIdRoadsMap.put(r.Id,s)),s.push(n[o]))}a._switchVariableHinderTo(t,r,C.default.NaviRoadHinderType_HINDER_HIGH)}})}},{key:"_insertWayPoints",value:function(){for(var t=0;t<this._wayPts.length;t++){var e=new D.default;this._insertPoint(this._wayPts[t],e)?(this._transitNodes.push(e),this._KeyNodes.append({num:this._KeyNodes.size(),id:e.Id,idx:this._naviGraph.getIdxByNodeId(e.Id),node:e})):this._failedInsertPts.push(this._wayPts[t])}}},{key:"_adjustNPModelRoads",value:function(){var p=this;this._zoneNPModelsMap.each(function(t,e){for(var n=p._zoneIdGraph.get(t),i=n.roadVector,r=0;r<e.length;r++)for(var o=e[r],s=0;s<i.length;s++){var a=i[s],u=a.roadEntry,l=a.calcMiddlePoint();if(A.default.pointInPolygon2d(o.points,l,o.pointCount-1)){if(a.length=Number.MAX_VALUE,u==C.default.NaviRoadEntry_BOTH||u==C.default.NaviRoadEntry_FORWARD){var d=p._zoneIdGraph.get(t).adjList.get(a.startId);if(d)for(var h=0;h<d.length;h++)d[h].nodeId==a.endId&&(d[h].length=a.length)}if(a.roadEntry==C.default.NaviRoadEntry_BOTH||a.roadEntry==C.default.NaviRoadEntry_BACK){var f=p._zoneIdGraph.get(t).adjList.get(a.endId);if(f)for(var c=0;c<f.length;c++)f[c].nodeId==a.startId&&(f[c].length=a.length)}}}})}},{key:"_switchVariableHinderTo",value:function(t,e,n){var i=this._modelIdRoadsMap.get(e.Id);if(i){if(C.default.NaviRoadHinderType_HINDER_HIGH==n)for(var r=0;r<i.length;r++){var o=i[r];if(o.calcLength(),o.length=i.length*this._kScaleVariable,o.roadEntry==C.default.NaviRoadEntry_BOTH||o.roadEntry==C.default.NaviRoadEntry_FORWARD){var s=this._zoneIdGraph.get(t).adjList.get(o.startId);if(s)for(var a=0;a<s.length;a++)s[a].nodeId==o.endId&&(s[a].length=o.length)}if(o.roadEntry==C.default.NaviRoadEntry_BOTH||o.roadEntry==C.default.NaviRoadEntry_BACK){var u=this._zoneIdGraph.get(t).adjList.get(o.endId);if(u)for(var l=0;l<u.length;l++)u[l].nodeId==o.startId&&(u[l].length=o.length)}}if(C.default.NaviRoadHinderType_HINDER_GENERAL==n)for(var d=0;d<i.length;d++){var h=i[d];if(h.calcLength(),h.roadEntry==C.default.NaviRoadEntry_BOTH||h.roadEntry==C.default.NaviRoadEntry_FORWARD){var f=this._zoneIdGraph.get(t).adjList.get(h.startId);if(f)for(var c=0;c<f.length;c++)f[c].nodeId==h.endId&&(f[c].length=h.length)}if(h.roadEntry==C.default.NaviRoadEntry_BOTH||h.roadEntry==C.default.NaviRoadEntry_BACK){var p=this._zoneIdGraph.get(t).adjList.get(h.endId);if(p)for(var _=0;_<p.length;_++)p[_].nodeId==h.startId&&(p[_].length=h.length)}}}}},{key:"_findNearZoneDoor",value:function(t,e,n){var i=this._naviGraph.getZone(e);if(null==i)return null;for(var r=this._zoneIdGraph.get(e).findModel(t,o),o=r.area,s=Number.MAX_VALUE,a=null,u=0;u<i._linkAccessNodes.length;u++){var l,d=i._linkAccessNodes[u],h=A.default.distanceOfTwoPoints(d.point,t);d.entranceType!=C.default.NaviEntranceType_ACCESS&&d.entranceType!=n||h<s&&(l=this._findMinAreaNearestObstructModel(e,d.point),l!=r&&l.pass==C.default.NaviModelPassType_PASS_NOT_THROUGH||(s=h,a=d))}return a}},{key:"_findMinAreaNearestObstructModel",value:function(t,e){for(var n=null,t=this._zoneIdGraph.get(t),i=Number.MAX_VALUE,r=Number.MAX_VALUE,o=null,s=t.obstructModels,a=0;a<s.length;a++){var u=s[a],l=A.default.pointToPolygon2d(u.points,e,u.points.length-1);l<r&&(r=l,o=u),this._kDoorToler>l&&(l=u.area,l<i&&(i=l,n=u))}return null==n?o:n}},{key:"_modelInZone",value:function(t,e){return!t.bb.isSeparate(e.bb)&&(t=t.center,!!A.default.pointInPolygon2d(e.points,t,e.pointCount))}},{key:"_insertTempNodeToRoad",value:function(t,e,n){var i=this._tmp_adj_node_ids.find(function(t){return t==n.startId}),r=this._tmp_adj_node_ids.find(function(t){return t==n.endId});null==i&&this._tmp_adj_node_ids.push(n.startId),null==r&&this._tmp_adj_node_ids.push(n.endId);for(var o=this._unattachedTempRoadTrees,s=null,a=0;a<o.length;a++)if(o[a]._wrappedRoad==n){s=o[a];break}if(null==s)s={},s._wrappedRoad=n,o.push(s);else for(;null!=s._fromChild;)var u=s._fromChild._wrappedRoad,s=A.default.pointIsInRect1(e,u.startPoint,u.endPoint)?s._fromChild:s._toChild;n=s._wrappedRoad;var l=new D.default;l.Id=this._newTmpId(),l.point=e;var d=new F.default;d.Id=this._newTmpId(),d.startId=n.startId,d.startPoint=n.startPoint,d.endId=l.Id,d.endPoint=l.point,d.pointVector=[n.startPoint,l.point];var h=new F.default;h.Id=this._newTmpId(),h.startId=l.Id,h.startPoint=l.point,h.endId=n.endId,h.endPoint=n.endPoint,h.pointVector=[l.point,n.endPoint],this._unattachedTempRoads.push(d),this._unattachedTempRoads.push(h),i={},i._wrappedRoad=d,r={},r._wrappedRoad=h,s._fromChild=i,s._toChild=r,l.tempType=1,d.tempType=1,h.tempType=1,d.calcLength(),h.calcLength(),d.roadEntry=n.roadEntry,h.roadEntry=n.roadEntry,r=this._zoneIdGraph.get(t),r.nodeVector.push(l),r.roadVector.push(d),r.roadVector.push(h);var f,t=this._zoneIdDijkstras.get(t)._naviGraph;return t._nodeMap.put(l.Id,r.nodeVector.length-1),n.roadEntry==C.default.NaviRoadEntry_BOTH&&(r=[],r.push({nodeId:n.startId,length:d.length}),r.push({nodeId:n.endId,length:h.length}),t.adjList.put(l.Id,r),r=t.adjList.get(n.startId),r||(r=[],t.adjList.put(n.startId,r)),r.push({nodeId:l.Id,length:d.length}),r=t.adjList.get(n.endId),r||(r=[],t.adjList.put(n.endId,r)),r.push({nodeId:l.Id,length:h.length})),n.roadEntry==C.default.NaviRoadEntry_FORWARD&&(f=[],f.push({nodeId:n.endId,length:h.length}),t.adjList.put(l.Id,f),f=t.adjList.get(n.startId),f||(f=[],t.adjList.put(n.startId,f)),f.push({nodeId:l.Id,length:d.length})),n.roadEntry==C.default.NaviRoadEntry_BACK&&(f=[],f.push({nodeId:n.startId,length:d.length}),t.adjList.put(l.Id,f),f=t.adjList.get(n.endId),f||(f=[],t.adjList.put(n.endId,f)),f.push({nodeId:l.Id,length:h.length})),l}},{key:"_insertItemToVector",value:function(t,e){for(var n=e.length-1;0<=n;n--)if(e[n].Id&&0<e[n].Id)return e.splice(n+1,0,t),n+1;return-1}},{key:"_insertNodeToRoad",value:function(t,e,n,i){if(i)return this._insertTempNodeToRoad(t,e,n);var r=this._zoneIdGraph.get(t),o=new D.default;o.Id=r.generateNodeId(),o.point=e;var s=new F.default;s.Id=r.generateRoadId(),s.startId=n.startId,s.startPoint=n.startPoint,s.endId=o.Id,s.endPoint=o.point,s.pointVector=[n.startPoint,o.point],i=new F.default,i.Id=r.generateRoadId(),i.startId=o.Id,i.startPoint=o.point,i.endId=n.endId,i.endPoint=n.endPoint,i.pointVector=[o.point,n.endPoint],t=[],t.push(s.Id),t.push(i.Id),o.segLinks=t,s.calcLength(),i.calcLength(),s.roadEntry=n.roadEntry,i.roadEntry=n.roadEntry;var a,e=r.nodeVector,t=r.roadVector,e=this._insertItemToVector(o,e);return this._insertItemToVector(s,t),this._insertItemToVector(i,t),r._nodeMap.put(o.Id,e),n.roadEntry==C.default.NaviRoadEntry_BOTH&&(e=[],e.push({nodeId:n.startId,length:s.length}),e.push({nodeId:n.endId,length:i.length}),r.adjList.put(o.Id,e),e=r.adjList.get(n.startId),e||(e=[],r.adjList.put(n.startId,e)),e.push({nodeId:o.Id,length:s.length}),e=r.adjList.get(n.endId),e||(e=[],r.adjList.put(n.endId,e)),e.push({nodeId:o.Id,length:i.length})),n.roadEntry==C.default.NaviRoadEntry_FORWARD&&(a=[],a.push({nodeId:n.endId,length:i.length}),r.adjList.put(o.Id,a),a=r.adjList.get(n.startId),a||(a=[],r.adjList.put(n.startId,a)),a.push({nodeId:o.Id,length:s.length})),n.roadEntry==C.default.NaviRoadEntry_BACK&&(a=[],a.push({nodeId:n.startId,length:s.length}),r.adjList.put(o.Id,a),a=r.adjList.get(n.endId),a||(a=[],r.adjList.put(n.endId,a)),a.push({nodeId:o.Id,length:i.length})),o}},{key:"_clearTmpPoint",value:function(t){if(null!=t){for(var e=this._zoneIdGraph.get(t),n=e.nodeVector.length-1;0<=n;n--){var i=e.nodeVector[n];if(null==i||0<=i.Id)break;e.nodeVector.splice(n,1)}for(var r=e.roadVector.length-1;0<=r;r--){var o=e.roadVector[r];if(null==o||0<=o.Id)break;e.roadVector.splice(r,1)}}}},{key:"_deleteTmpConnectionEntirely",value:function(t,e){var n=t.get(e);if(n)for(var i=0;i<n.length;i++)n[i].nodeId<0&&(n.splice(i,1),i--)}},{key:"_removeConnection",value:function(t,e){for(var n=t.get(e),i=0;i<n.length;i++)this._deleteTmpConnectionEntirely(t,n[i].nodeId);t.remove(e)}},{key:"_calcAdherenceAtAngle",value:function(t,e,n,i,r,o){r.toDistance=Number.MAX_VALUE,r.stickToRoad=!1,r.rotateAngle=0;for(var s=Number.MAX_VALUE,a={},u=this._zoneIdGraph.get(t),l=0;l<u.roadVector.length;l++){var d,h=u.roadVector[l];null!=h&&(d=A.default.rayCrossSegment(e,n,h.startPoint,h.endPoint,a),d&&(d=A.default.distanceOfTwoPoints(e,a),d<s&&(s=d,r.cross=(0,w.default)({},a),r.distance=s,r.road=h,r.stickToRoad=!0)))}for(var u=this._zoneIdGraph.get(-1),f={},c=0;c<u.obstructModels.length;c++){var p=u.obstructModels[c];if(null!=p&&p!=o&&C.default.NaviModelPassType_DECORATE!=p.pass&&(null==o||!A.default.pointInPolygon2d(p.points,o.center,p.points.length-1)))for(var _=p.points.length,v=0;v<_-1;v++){var y=A.default.rayCrossSegment(e,n,p.points[v],p.points[v+1],f);if(y&&(y=A.default.distanceOfTwoPoints(e,f),y<s))return s=y,r.model=p,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=C.default.NaviObstructType_MODEL,!1}}for(var g={},I=u.obstructExtents,T=0;T<I.length;T++){for(var x=I[T],N=I[T].holes,m=0;m<N.length;m++)for(var R=N[m],E=0;E<R.length-1;E++){var M=A.default.rayCrossSegment(e,n,R[E],R[E+1],g);if(M&&(M=A.default.distanceOfTwoPoints(e,g),M<s))return s=M,r.model=x,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=C.default.NaviObstructType_EXTENT,!1}for(var k=I[T].points,P=0;P<k.length-1;P++){var L=A.default.rayCrossSegment(e,n,k[P],k[P+1],g);if(L&&(L=A.default.distanceOfTwoPoints(e,g),L<s))return s=L,r.model=x,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=C.default.NaviObstructType_EXTENT,!1}}return r.toDistance=A.default.distanceOfTwoPoints(r.cross,i),!0}},{key:"_adherenceCompare",value:function(t,e){return t.toDistance-e.toDistance}},{key:"_adherenceAngleCompare",value:function(t,e){return e.rotateAngle-t.rotateAngle}},{key:"_clearTempPoint",value:function(t){if(t=this._zoneIdGraph.get(t),t){for(var e=t.nodeVector,n=e.length-1;0<=n;n--){var i=e[n];if(null==i||0<=i.Id)break;e.splice(n,1)}for(var r=t.roadVector,o=r.length-1;0<=o;o--){var s=r[o];if(null==s||0<=s.Id)break;r.splice(o,1)}}}},{key:"_clearTempAdjList",value:function(){var a=this;this._zoneIdDijkstras.each(function(t,e){for(var n=[],i=e._naviGraph.adjList,r=0;r<i.keys.length;r++)i.keys[r]<0&&n.push(i.keys[r]);for(var o=0;o<n.length;o++)a._removeConnection(e._naviGraph.adjList,n[o]);for(var s=0;s<a._tmp_adj_node_ids.length;s++)a._deleteTmpConnectionEntirely(i,a._tmp_adj_node_ids[s])})}},{key:"_exploreUprightLikelyJoints",value:function(t,e,n,i,r){for(var o=[],s=0;s<i.length;s++)if(i[s].distance<A.default.epsilon())return o.push(i[s]),o;var a={x:0,y:0},u=A.default.calcFootOfUpright(e,n.startPoint,n.endPoint,a),l={};if(u&&this._isTwoPointsConnectedDirectly(e,a,l,r))return r={},r.cross=a,r.stickToRoad=!0,r.road=n,r.rotateAngle=0,r.dist=A.default.distanceOfTwoPoints(e,a),o.push(r),o;for(var d={x:a.x-e.x,y:a.y-e.y},h=0;h<i.length;h++){var f=i[h],c={x:f.cross.x-e.x,y:f.cross.y-e.y},c=A.default.calcRotateAngle(c,d),c=270<c?c-360:c;f.rotateAngle=c}i.sort(this._adherenceAngleCompare);var p=null,_=null;if(i[i.length-1].rotateAngle<0)return p=i[i.length-1],o.push(p),o;for(var v=0;v<i.length;v++)if(0<=i[v].rotateAngle)return p=i[v],0==v?o.push(p):(_=i[v-1],A.default.distanceOfTwoPoints(p.cross,n.startPoint)>A.default.distanceOfTwoPoints(_.cross,n.startPoint)?(o.push(_),o.push(p)):(o.push(p),o.push(_))),o;return o}},{key:"_calcAllAdherance",value:function(t,e,n,i,r,o){for(var s=r||30,a=0;a<360;a+=s){var u=new l.default;this._calcAdherenceAtAngle(t,e,a,n,u,o),1==u.stickToRoad&&i.push(u)}i.sort(this._adherenceCompare)}},{key:"_seekNearRoads",value:function(t,e,n,i,r){var o=new d.default,s=[];for(this._calcAllAdherance(t,e,n,s,i,r);0!=s.length;){var a=s[0],u=o.get(a.road.Id);u?u.push(a):(u=[],u.push(a),o.put(a.road.Id,u)),s.splice(0,1)}return o}},{key:"_insertTmpIsolatedNode",value:function(t,e){var n=new D.default;return n.Id=this._newTmpId(),n.point=(0,w.default)({},e),e=this._zoneIdGraph.get(t),e.nodeVector.push(n),t=this._zoneIdDijkstras.get(t),t._naviGraph._nodeMap.put(n.Id,e.nodeVector.length-1),n}},{key:"_insertIsolatedNode",value:function(t,e,n){return n?this._insertTmpIsolatedNode(t,e):(n=new D.default,n.Id=this._naviGraph.generateNodeId(),n.point=(0,w.default)({},e),e=this.zoneIdGraph.get(t),t=e.nodeVector,t=this._insertItemToVector(n,t),e._nodeMap.put(n.Id,t),n)}},{key:"_isTwoPointsConnectedDirectly",value:function(t,e,n,i){for(var r=this._zoneIdGraph.get(-1),o=null,s=0;s<r.obstructModels.length;s++)if(o=r.obstructModels[s],null!=o&&o!=i&&C.default.NaviModelPassType_DECORATE!=o.pass)for(var a=o.points,u=0;u<a.length-1;u++)if(A.default.calcCrossPoint(t,e,a[u],a[u+1],n)){var l=A.default.distanceOfTwoPoints(t,n),d=A.default.distanceOfTwoPoints(e,n);if(!(l<=A.default.epsilon()||d<=A.default.epsilon()))return!1}for(var h=r.obstructExtents,f=0;f<h.length;f++){for(var c=h[f],p=c.holes,_=0;_<p.length;_++)for(var v=p[_],y=0;y<v.length-1;y++)if(A.default.calcCrossPoint(t,e,v[y],v[y+1],n))return!1;for(var g=c.points,I=0;I<g.length-1;I++)if(A.default.calcCrossPoint(t,e,g[I],g[I+1],n))return!1}return!0}},{key:"_joinTwoNodes",value:function(t,e,n,i,r,o){for(var s=0;s<this._attachedTempRoads.length;s++){var a=this._attachedTempRoads[s],u={};if(1==A.default.calcCrossPoint(a.startPoint,a.endPoint,e.point,n.point,u)&&A.default.distanceOfTwoPoints(e.point,u)>A.default.epsilon()&&A.default.distanceOfTwoPoints(n.point,u)>A.default.epsilon())return null}void 0===i&&(i=C.default.NaviRoadEntry_BOTH),void 0===r&&(r=!0),void 0===o&&(o=!0);var l=new F.default;l.startId=e.Id,l.startPoint=e.point,l.endId=n.Id,l.endPoint=n.point,l.pointVector=[e.point,n.point],this._tmp_adj_node_ids.push(e.Id),this._tmp_adj_node_ids.push(n.Id),l.Id=r?this._newTmpId():this._naviGraph.generateRoadId(),l.roadEntry=i,l.calcLength(),o&&this._attachedTempRoads.push(l),o=this._zoneIdGraph.get(t),o.roadVector.push(l);var d,h,o=this._zoneIdDijkstras.get(t);return C.default.NaviRoadEntry_BOTH==i&&(t={nodeId:n.Id,length:l.length},d=o._naviGraph.adjList.get(e.Id),d?d.push(t):(d=[],d.push(t),o._naviGraph.adjList.put(e.Id,d)),t={nodeId:e.Id,length:l.length},d=o._naviGraph.adjList.get(n.Id),d?d.push(t):(d=[],d.push(t),o._naviGraph.adjList.put(n.Id,d))),C.default.NaviRoadEntry_FORWARD==i&&(d={nodeId:n.Id,length:l.length},h=o._naviGraph.adjList.get(e.Id),h?h.push(d):(h=[],h.push(d),o._naviGraph.adjList(e.Id,h))),C.default.NaviRoadEntry_BACK==i&&(i={nodeId:e.Id,length:l.length},h=o._naviGraph.adjList.get(n.Id),h?h.push(i):(h=[],h.push(i),o._naviGraph.adjList.put(n.Id,h))),l}},{key:"_isPointInPNTModel",value:function(t){var e=this._calcZoneIdByCoord(t),n=this._zonePNTModelsMap.get(e);if(n)for(var i=0;i<n.length;i++){var r=n[i];if(A.default.pointInPolygon2d(r.points,t,r.points.length))return r}return null}},{key:"_newTmpId",value:function(){return this._tmpId--}}]),n}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(32),n(31),n(51);var s=r(n(2)),a=r(n(3)),u=r(n(50)),l=function(){function e(t){(0,s.default)(this,e),this.adj=t||[]}return(0,a.default)(e,[{key:"has",value:function(t){for(var e in this.adj)if(t==e[0])return!0;return!1}},{key:"weight",value:function(t){if(null==t)return null;for(var e in this.adj)if(t==this.adj[e][0])return this.adj[e][1];return null}},{key:"append",value:function(t){this.adj.push(t)}}]),e}(),n=function(){function o(t){for(var e in(0,s.default)(this,o),this._adjTable=new u.default,t){var n=t[e][0];t[e][1],t[e][2],this._adjTable.has(n)||this._adjTable.put(n,new l);for(var i=[],r=1;r<t[e].length;r++)i.push(t[e][r]);this._adjTable.get(n).append(i)}}return(0,a.default)(o,[{key:"get",value:function(t){return this._adjTable.has(t)?this._adjTable.get(t):null}},{key:"lookup",value:function(t,e){return this._adjTable.has(t)?(t=this._adjTable.get(t),t.weight(e)):null}},{key:"keys",value:function(){return this._adjTable.keys}},{key:"enhance",value:function(t,e,n){n=n||[];for(var i,r,o=this.keys(),s=1/0,a={dist:1/0,transit:null},u=0;u<o.length;u++)-1==n.indexOf(o[u])&&(i=this.lookup(t,o[u]),r=this.lookup(o[u],e),null!=i&&null!=r&&i+r<s&&(a={dist:i+r,transit:o[u]},s=i+r));return a}}]),o}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(16);var o=r(n(2)),s=r(n(3)),a=function(){function n(t){if((0,o.default)(this,n),t instanceof Number){this._num=t,this._array=[];for(var e=0;e<t;e++)this._array.push(null)}if(t instanceof Array)for(this._names=t,this._array=[],e=0;e<t.length;e++)this._array.push(null)}return(0,s.default)(n,[{key:"size",value:function(){return this._array.length}},{key:"set",value:function(t,e){if(t<0||t>=this.size())throw"positon is out of bounder";this._array[t]=e}},{key:"get",value:function(t){var e=t;return"string"==typeof t&&(e=this._names.indexOf(t)),this._array[e]}},{key:"toArray",value:function(){for(var t=[],e=0;e<this._array.length;e++)t.push(this._array[e]);return t}},{key:"equals",value:function(t){if(this._array.length!=t._array.length)return!1;if(this._names.length!=t._names.length)return!1;for(var e=0;e<this._names.length;e++)if(this._names[e]!=t._names[e])return!1;return!0}},{key:"clone",value:function(){for(var t=0==this._names.length?new n(this._array.length):new n(this._names),e=0;e<this._array.length;e++)t._array[e]=this._array[e];return t}}]),n}(),n=function(){function n(t){(0,o.default)(this,n),this._names=t,this._table=[]}return(0,s.default)(n,[{key:"append",value:function(t){if(t instanceof a){var e=new a(t._names);if(!e.equals(t))throw"the appended item is not compatible to the TupleTable";this._table.push(t)}else{var n,i=new a(this._names);for(n in t){var r=this._names.indexOf(n);0<=r&&i.set(r,t[n])}this._table.push(i)}}},{key:"query",value:function(t,e){for(var n=0;n<this._table.length;n++){var i=this._table[n];if(i.get(t)==e)return i}return null}},{key:"foreach",value:function(t,e){e=e||-1;for(var n=0;n<this._table.length;n++)t(e<0?this._table[n]:this._table[n].get(e))}},{key:"size",value:function(){return this._table.length}},{key:"clone",value:function(){for(var t=new n(this._names),e=0;e<this._table.length;e++)t.append(this._table[e].clone());return t}},{key:"dropLines",value:function(t){for(var e=0;e<this._table.length;e++){var n,i=!0;for(n in t){var r=this._table[e].get(n);if(r!=t[n]){i=!1;break}}i&&(this._table.splice(e,1),e--)}}},{key:"clear",value:function(){this._table=[]}}]),n}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(24),r=n(122),u=n(36),l=n(46),d=n(17),h=[].slice;i(i.P+i.F*n(7)(function(){r&&h.call(r)}),"Array",{slice:function(t,e){var n=d(this.length),i=u(this);if(e=void 0===e?n:e,"Array"==i)return h.call(this,t,e);for(var r=l(t,n),n=l(e,n),o=d(n-r),s=new Array(o),a=0;a<o;a++)s[a]="String"==i?this.charAt(r+a):this[r+a];return s}})},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var d=r(n(48)),o=r(n(2)),s=r(n(3)),h=r(n(146)),f=r(n(264)),n=n(147),a=n.SmallQueue,n=function(){function r(t,e,n,i){(0,o.default)(this,r),this._startPt=t,this._endPt=e,this._passPts=n,this._dijkCollection=i,this._failedInsertedPts={}}return(0,s.default)(r,[{key:"_refreshPts",value:function(){var t,e={};for(t in this._passPts)for(var n=this._passPts[t],i=0;i<n.length;i++){var r=n[i],o=this._dijkCollection.getDijkByPoint(t,{x:r[0],y:r[1]});o?(e[o.Id]||(e[o.Id]=[]),e[o.Id].push(r)):(o=this._failedInsertedPts[t],null==o&&(this._failedInsertedPts[t]=[]),this._failedInsertedPts[t].push(r))}this._passPts=e}},{key:"_buildGraph",value:function(){this._graph=[];for(var t=0;t<this._dijkCollection.len();t++)for(var e,n,i=this._dijkCollection.get(t),r=0;r<this._dijkCollection.len();r++)t!=r&&(e=this._dijkCollection.get(r),n=i.hasRelationTo(e),n.related&&this._graph.push([i.Id,e.Id,n.dist]))}},{key:"executeCalculation",value:function(){this.reset(),this._buildGraph(),this._refreshPts();var t,e=[];for(t in this._passPts)e.push((0,d.default)(t));var n=this._dijkCollection.getDijkByPoint(this._startPt.groupID,this._startPt).Id,i=this._dijkCollection.getDijkByPoint(this._endPt.groupID,this._endPt).Id,r=new h.default(this._graph);r.setSId(n),r.setEId(i),n=e.indexOf(n),-1!=n&&e.splice(n,1),n=e.indexOf(i),-1!=n&&e.splice(n,1),r.setWayNodes(e),r.route();var o=r.getResult();if(2==o.route.length&&o.route[0]==o.route[1]&&(o.route=[o.route[0]]),o.dist!=1/0){for(var s=[],a=0;a<o.route.length;a++){var u=this._dijkCollection.getDijkById(o.route[a]);if(u.setWayPoints(this._passPts[o.route[a]]),s.push(u),0<u._failedInsertPts.length){var l=this._failedInsertedPts[u.fid];for(null==l&&(this._failedInsertedPts[u.fid]=[]),a=0;a<u._failedInsertPts.length;a++)this._failedInsertedPts[u.fid].push(u._failedInsertPts[a])}}this._dijkList=new f.default,this._dijkList.load(s),this._dijkList.compute(this._startPt,this._endPt),this._routes=this._dijkList.routes}}},{key:"routes",get:function(){return this._routes},set:function(t){this._routes=t}},{key:"reset",value:function(){this._dijkCollection.each(function(t){t._next=new a,t._startNode=null,t._endNode=null,t._visited=!1,t._transitNodes=[],t._failedInsertPts=[]})}},{key:"failInsertedPts",get:function(){return this._failedInsertedPts}}]),r}(),n=n;e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(3)),n=function(){function t(){(0,o.default)(this,t),this._head=null,this.routes=[]}return(0,s.default)(t,[{key:"load",value:function(t){if(0!=t.length){this._head=t[0];for(var e=this._head,n=1;n<t.length;n++)e.pushNext(t[n]),e=t[n];e.pushNext(null)}}},{key:"compute",value:function(t,e){var n=this._head;for(n.setStart(t);n.getNext();){if(n.Id,!n.computeKeyRoutes())return!1;this.routes.push({groupId:n.gid,result:n.getResult()}),n=n.popNext()}n.setEnd(e),n.computeKeyRoutes(),this.routes.push({groupId:n.gid,result:n.getResult()})}}]),t}(),n=n;e.default=n},function(t,e,n){t.exports=n(266)},function(t,e,n){n(267),t.exports=Math.pow(2,-52)},function(t,e,n){n=n(6),n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){t.exports=n(269)},function(t,e,n){n(270);var i=n(4).Object;t.exports=function(t,e){return i.defineProperties(t,e)}},function(t,e,n){var i=n(6);i(i.S+i.F*!n(14),"Object",{defineProperties:n(108)})},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.Matrix4=p;var u,l,o,s,a,d,h,f,c,r=r(n(15)),n=n(148);function p(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}(0,r.default)(p.prototype,{isMatrix4:!0,set:function(t,e,n,i,r,o,s,a,u,l,d,h,f,c,p,_){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=i,v[1]=r,v[5]=o,v[9]=s,v[13]=a,v[2]=u,v[6]=l,v[10]=d,v[14]=h,v[3]=f,v[7]=c,v[11]=p,v[15]=_,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new p).fromArray(this.elements)},copy:function(t){var e=this.elements,t=t.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements,t=t.elements;return e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:(c=new n.Vector3,function(t){var e=this.elements,n=t.elements,i=1/c.setFromMatrixColumn(t,0).length(),r=1/c.setFromMatrixColumn(t,1).length(),t=1/c.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*t,e[9]=n[9]*t,e[10]=n[10]*t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e,n,i,r,o,s,a,u,l,d,h,f,c=this.elements,p=t.x,_=t.y,v=t.z,y=Math.cos(p),g=Math.sin(p),I=Math.cos(_),p=Math.sin(_),_=Math.cos(v),v=Math.sin(v);return"XYZ"===t.order?(o=y*_,s=y*v,a=g*_,u=g*v,c[0]=I*_,c[4]=-I*v,c[8]=p,c[1]=s+a*p,c[5]=o-u*p,c[9]=-g*I,c[2]=u-o*p,c[6]=a+s*p,c[10]=y*I):"YXZ"===t.order?(e=I*_,n=I*v,i=p*_,r=p*v,c[0]=e+r*g,c[4]=i*g-n,c[8]=y*p,c[1]=y*v,c[5]=y*_,c[9]=-g,c[2]=n*g-i,c[6]=r+e*g,c[10]=y*I):"ZXY"===t.order?(e=I*_,n=I*v,i=p*_,r=p*v,c[0]=e-r*g,c[4]=-y*v,c[8]=i+n*g,c[1]=n+i*g,c[5]=y*_,c[9]=r-e*g,c[2]=-y*p,c[6]=g,c[10]=y*I):"ZYX"===t.order?(o=y*_,s=y*v,a=g*_,u=g*v,c[0]=I*_,c[4]=a*p-s,c[8]=o*p+u,c[1]=I*v,c[5]=u*p+o,c[9]=s*p-a,c[2]=-p,c[6]=g*I,c[10]=y*I):"YZX"===t.order?(l=y*I,d=y*p,h=g*I,f=g*p,c[0]=I*_,c[4]=f-l*v,c[8]=h*v+d,c[1]=v,c[5]=y*_,c[9]=-g*_,c[2]=-p*_,c[6]=d*v+h,c[10]=l-f*v):"XZY"===t.order&&(l=y*I,d=y*p,h=g*I,f=g*p,c[0]=I*_,c[4]=-v,c[8]=p*_,c[1]=l*v+f,c[5]=y*_,c[9]=d*v-h,c[2]=h*v-d,c[6]=g*_,c[10]=f*v+l),c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this},makeRotationFromQuaternion:(h=new n.Vector3(0,0,0),f=new n.Vector3(1,1,1),function(t){return this.compose(h,t,f)}),lookAt:(s=new n.Vector3,a=new n.Vector3,d=new n.Vector3,function(t,e,n){var i=this.elements;return d.subVectors(t,e),0===d.lengthSq()&&(d.z=1),d.normalize(),s.crossVectors(n,d),0===s.lengthSq()&&(1===Math.abs(n.z)?d.x+=1e-4:d.z+=1e-4,d.normalize(),s.crossVectors(n,d)),s.normalize(),a.crossVectors(d,s),i[0]=s.x,i[4]=a.x,i[8]=d.x,i[1]=s.y,i[5]=a.y,i[9]=d.y,i[2]=s.z,i[6]=a.z,i[10]=d.z,this}),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,o=n[0],s=n[4],a=n[8],u=n[12],l=n[1],d=n[5],h=n[9],f=n[13],c=n[2],p=n[6],_=n[10],v=n[14],y=n[3],g=n[7],I=n[11],T=n[15],x=i[0],N=i[4],m=i[8],R=i[12],E=i[1],M=i[5],k=i[9],P=i[13],L=i[2],A=i[6],O=i[10],S=i[14],t=i[3],e=i[7],n=i[11],i=i[15];return r[0]=o*x+s*E+a*L+u*t,r[4]=o*N+s*M+a*A+u*e,r[8]=o*m+s*k+a*O+u*n,r[12]=o*R+s*P+a*S+u*i,r[1]=l*x+d*E+h*L+f*t,r[5]=l*N+d*M+h*A+f*e,r[9]=l*m+d*k+h*O+f*n,r[13]=l*R+d*P+h*S+f*i,r[2]=c*x+p*E+_*L+v*t,r[6]=c*N+p*M+_*A+v*e,r[10]=c*m+p*k+_*O+v*n,r[14]=c*R+p*P+_*S+v*i,r[3]=y*x+g*E+I*L+T*t,r[7]=y*N+g*M+I*A+T*e,r[11]=y*m+g*k+I*O+T*n,r[15]=y*R+g*P+I*S+T*i,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:(o=new n.Vector3,function(t){for(var e=0,n=t.count;e<n;e++)o.x=t.getX(e),o.y=t.getY(e),o.z=t.getZ(e),o.applyMatrix4(this),t.setXYZ(e,o.x,o.y,o.z);return t}),determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],s=t[5],a=t[9],u=t[13],l=t[2],d=t[6],h=t[10],f=t[14],c=t[3],p=t[7],_=t[11],t=t[15];return c*(+r*a*d-i*u*d-r*s*h+n*u*h+i*s*f-n*a*f)+p*(+e*a*f-e*u*h+r*o*h-i*o*f+i*u*l-r*a*l)+_*(+e*u*d-e*s*f-r*o*d+n*o*f+r*s*l-n*u*l)+t*(-i*s*l-e*a*d+e*s*h+i*o*d-n*o*h+n*a*l)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t,e,n){var i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this},getInverse:function(t,e){var n=this.elements,i=t.elements,r=i[0],o=i[1],s=i[2],a=i[3],u=i[4],l=i[5],d=i[6],h=i[7],f=i[8],c=i[9],p=i[10],_=i[11],v=i[12],y=i[13],g=i[14],I=i[15],T=c*g*h-y*p*h+y*d*_-l*g*_-c*d*I+l*p*I,x=v*p*h-f*g*h-v*d*_+u*g*_+f*d*I-u*p*I,N=f*y*h-v*c*h+v*l*_-u*y*_-f*l*I+u*c*I,m=v*c*d-f*y*d-v*l*p+u*y*p+f*l*g-u*c*g,t=r*T+o*x+s*N+a*m;if(0!==t)return t=1/t,n[0]=T*t,n[1]=(y*p*a-c*g*a-y*s*_+o*g*_+c*s*I-o*p*I)*t,n[2]=(l*g*a-y*d*a+y*s*h-o*g*h-l*s*I+o*d*I)*t,n[3]=(c*d*a-l*p*a-c*s*h+o*p*h+l*s*_-o*d*_)*t,n[4]=x*t,n[5]=(f*g*a-v*p*a+v*s*_-r*g*_-f*s*I+r*p*I)*t,n[6]=(v*d*a-u*g*a-v*s*h+r*g*h+u*s*I-r*d*I)*t,n[7]=(u*p*a-f*d*a+f*s*h-r*p*h-u*s*_+r*d*_)*t,n[8]=N*t,n[9]=(v*c*a-f*y*a-v*o*_+r*y*_+f*o*I-r*c*I)*t,n[10]=(u*y*a-v*l*a+v*o*h-r*y*h-u*o*I+r*l*I)*t,n[11]=(f*l*a-u*c*a-f*o*h+r*c*h+u*o*_-r*l*_)*t,n[12]=m*t,n[13]=(f*y*s-v*c*s+v*o*p-r*y*p-f*o*g+r*c*g)*t,n[14]=(v*l*s-u*y*s-v*o*d+r*y*d+u*o*g-r*l*g)*t,n[15]=(u*c*s-f*l*s+f*o*d-r*c*d-u*o*p+r*l*p)*t,this;if(i="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0",!0===e)throw new Error(i);return console.warn(i),this.identity()},scale:function(t){var e=this.elements,n=t.x,i=t.y,t=t.z;return e[0]*=n,e[4]*=i,e[8]*=t,e[1]*=n,e[5]*=i,e[9]*=t,e[2]*=n,e[6]*=i,e[10]*=t,e[3]*=n,e[7]*=i,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,t))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),t=Math.sin(t);return this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),t=Math.sin(t);return this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),t=Math.sin(t);return this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,s=t.y,a=t.z,e=r*o,t=r*s;return this.set(e*o+n,e*s-i*a,e*a+i*s,0,e*s+i*a,t*s+n,t*a-i*o,0,e*a-i*s,t*a+i*o,r*a*a+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var i=this.elements,r=e._x,o=e._y,s=e._z,a=e._w,u=r+r,l=o+o,d=s+s,h=r*u,f=r*l,c=r*d,e=o*l,r=o*d,o=s*d,s=a*u,u=a*l,l=a*d,a=n.x,d=n.y,n=n.z;return i[0]=(1-(e+o))*a,i[1]=(f+l)*a,i[2]=(c-u)*a,i[3]=0,i[4]=(f-l)*d,i[5]=(1-(h+o))*d,i[6]=(r+s)*d,i[7]=0,i[8]=(c+u)*n,i[9]=(r-s)*n,i[10]=(1-(h+e))*n,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this},decompose:(u=new n.Vector3,l=new p,function(t,e,n){var i=this.elements,r=u.set(i[0],i[1],i[2]).length(),o=u.set(i[4],i[5],i[6]).length(),s=u.set(i[8],i[9],i[10]).length(),a=this.determinant();return a<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],l.copy(this),a=1/r,t=1/o,i=1/s,l.elements[0]*=a,l.elements[1]*=a,l.elements[2]*=a,l.elements[4]*=t,l.elements[5]*=t,l.elements[6]*=t,l.elements[8]*=i,l.elements[9]*=i,l.elements[10]*=i,e.setFromRotationMatrix(l),n.x=r,n.y=o,n.z=s,this}),makePerspective:function(t,e,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,a=2*r/(e-t),u=2*r/(n-i),t=(e+t)/(e-t),n=(n+i)/(n-i),i=-(o+r)/(o-r),r=-2*o*r/(o-r);return s[0]=a,s[4]=0,s[8]=t,s[12]=0,s[1]=0,s[5]=u,s[9]=n,s[13]=0,s[2]=0,s[6]=0,s[10]=i,s[14]=r,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(t,e,n,i,r,o){var s=this.elements,a=1/(e-t),u=1/(n-i),l=1/(o-r),t=(e+t)*a,i=(n+i)*u,r=(o+r)*l;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-t,s[1]=0,s[5]=2*u,s[9]=0,s[13]=-i,s[2]=0,s[6]=0,s[10]=-2*l,s[14]=-r,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}})},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0,n(16);var n=r(n(273)),y=n.default;function o(t,e){e=e||1;for(var n=Number.MAX_VALUE,i=Number.MAX_VALUE,r=Number.MIN_VALUE,o=Number.MIN_VALUE,s=0;s<t[0].length;s++){var a=t[0][s];a[0]<n&&(n=a[0]),a[1]<i&&(i=a[1]),a[0]>r&&(r=a[0]),a[1]>o&&(o=a[1])}var u=r-n,l=o-i,d=Math.min(u,l),h=d/2;if(0===d)return[n,i];for(var f=new y(void 0,g),c=n;c<r;c+=d)for(var p=i;p<o;p+=d)f.push(new I(c+h,p+h,h,t));var _=T(t),l=new I(n+u/2,i+l/2,0,t);for(l.d>_.d&&(_=l),f.length;0<f.length;){var v=f.pop();v.d>_.d&&(_=v),v.max-_.d<=e||(h=v.h/2,f.push(new I(v.x-h,v.y-h,h,t)),f.push(new I(v.x+h,v.y-h,h,t)),f.push(new I(v.x-h,v.y+h,h,t)),f.push(new I(v.x+h,v.y+h,h,t)))}return[_.x,_.y]}function g(t,e){return e.max-t.max}function I(t,e,n,i){this.x=t,this.y=e,this.h=n,this.d=s(t,e,i),this.max=this.d+this.h*Math.SQRT2}function s(t,e,n){for(var i=!1,r=1/0,o=0;o<n.length;o++)for(var s=n[o],a=0,u=s.length,l=u-1;a<u;l=a++){var d=s[a],h=s[l];d[1]>e!=h[1]>e&&t<(h[0]-d[0])*(e-d[1])/(h[1]-d[1])+d[0]&&(i=!i),r=Math.min(r,f(t,e,d,h))}return(i?1:-1)*Math.sqrt(r)}function T(t){for(var e=0,n=0,i=0,r=t[0],o=0,s=r.length,a=s-1;o<s;a=o++){var u=r[o],l=r[a],d=u[0]*l[1]-l[0]*u[1];n+=(u[0]+l[0])*d,i+=(u[1]+l[1])*d,e+=3*d}return 0===e?new I(r[0][0],r[0][1],0,t):new I(n/e,i/e,0,t)}function f(t,e,n,i){var r=n[0],o=n[1],s=i[0]-r,a=i[1]-o,u=r,n=o;return 0===s&&0===a||(o=((t-r)*s+(e-o)*a)/(s*s+a*a),1<o?(u=i[0],n=i[1]):0<o&&(u+=s*o,n+=a*o)),s=t-u,a=e-n,s*s+a*a}n=o,e.default=n},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(2)),s=r(n(3)),n=function(){function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a;if((0,o.default)(this,i),this.data=t,this.length=this.data.length,this.compare=e,0<this.length)for(var n=(this.length>>1)-1;0<=n;n--)this._down(n)}return(0,s.default)(i,[{key:"push",value:function(t){this.data.push(t),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,0<this.length&&(this.data[0]=e,this._down(0)),t}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(t){for(var e=this.data,n=this.compare,i=e[t];0<t;){var r=t-1>>1,o=e[r];if(0<=n(i,o))break;e[t]=o,t=r}e[t]=i}},{key:"_down",value:function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),s=e[o],a=o+1;if(a<this.length&&n(e[a],s)<0&&(o=a,s=e[a]),0<=n(s,r))break;e[t]=s,t=o}e[t]=r}}]),i}();function a(t,e){return t<e?-1:e<t?1:0}e.default=n}],i={},r.m=n,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=150).default;function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var n,i});