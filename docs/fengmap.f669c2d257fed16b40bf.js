/*! For license information please see fengmap.f669c2d257fed16b40bf.js.LICENSE.txt */
(()=>{var e={439:function(e,n,r){var i,o,a,s;function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}e=r.nmd(e),s=function(){return n=[function(e,t,n){e.exports=n(151)},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(0);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r(e,i.key,i)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e=e.exports={version:"2.6.12"},"number"==typeof __e&&(__e=e)},function(e,t,n){var r=n(83)("wks"),i=n(47),o=n(8).Symbol,a="function"==typeof o;(e=e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t,n){var r=n(9),i=n(4),o=n(67),a=n(34),s=n(28),u="prototype",l=function e(t,n,l){var c,h,f,d=t&e.F,p=t&e.G,g=t&e.S,m=t&e.P,v=t&e.B,y=t&e.W,_=p?i:i[n]||(i[n]={}),x=_[u],A=p?r:g?r[n]:(r[n]||{})[u];for(c in p&&(l=n),l)(h=!d&&A&&void 0!==A[c])&&s(_,c)||(f=(h?A:l)[c],_[c]=p&&"function"!=typeof A[c]?l[c]:v&&h?o(f,r):y&&A[c]==f?function(e){var t=function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)}));return t[u]=e[u],t}(f):m&&"function"==typeof f?o(Function.call,f):f,m&&((_.virtual||(_.virtual={}))[c]=f,t&e.R&&x&&!x[c]&&a(x,c,f)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=e)},function(e,t){e=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=e)},function(e,t,n){e.exports=!n(7)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(73)("wks"),i=n(55),o=n(9).Symbol,a="function"==typeof o;(e=e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(16),n(26);var o=i(n(2)),a=i(n(3)),s=1e-5,u=1e-5,l=.001;n=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,null,[{key:"epsilon",value:function(){return l}},{key:"isZero",value:function(e){return e<s&&-s<e}},{key:"gtZero",value:function(e){return s<e}},{key:"ltZero",value:function(e){return e<-s}},{key:"pointDistanceToLine",value:function(t,n,r,i){var o=n.x,a=n.y,s=r.x,u=r.y,l=t.x,c=t.y,h=s-o,f=u-a,d=Math.sqrt(h*h+f*f),p=l-o,g=c-a;return t=Math.sqrt(p*p+g*g),e.isZero(d)?(i.x=n.x,i.y=n.y,e.isZero(t)?0:t):(g=(h/=d)*p+(f/=d)*g,e.gtZero(g)?e.ltZero(g-d)?(l-=h=o+g*h,c-=f=a+g*f,c=Math.sqrt(l*l+c*c),i.x=h,i.y=f,c):(s=l-s,u=c-u,u=Math.sqrt(s*s+u*u),i.x=r.x,i.y=r.y,u):(i.x=n.x,i.y=n.y,t))}},{key:"distanceOfTwoPoints",value:function(e,t){return e&&t?Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)):Number.NaN}},{key:"isSamePoint",value:function(e,t){return Math.abs(e.x-t.x)<=u&&Math.abs(e.y-t.y)<=u}},{key:"isNearlySamePoint",value:function(e,t){return Math.abs(e.x-t.x)<=.01&&Math.abs(e.y-t.y)<=.01}},{key:"getPolygonInnerPoint",value:function(t){if(t&&0==t.length)return{x:0,y:0};if(t.length<3)return t[0];var n=t[0],r=t[1],i=(n.x+r.x)/2,o=(n.y+r.y)/2,a=Math.atan2(r.y-n.y,r.x-n.x);a-=Math.PI/2;for(var s=3;.5<s;){var u={x:i+s*Math.cos(a),y:o+s*Math.sin(a)};if(e.isInPolygon(u,t))return u;s/=2}for(a+=Math.PI,s=3;.5<s;){var l={x:i+s*Math.cos(a),y:o+s*Math.sin(a)};if(e.isInPolygon(l,t))return l;s/=2}return{x:0,y:0}}},{key:"isInPolygon",value:function(e,t){for(var n=!1,r=t.length,i=0,o=r-1;i<r;o=i,++i){var a=t[i].x,s=t[i].y,u=t[o].x,l=t[o].y;if(a==e.x&&s==e.y||u==e.x&&l==e.y)return!0;if(s<e.y&&l>=e.y||s>=e.y&&l<e.y){if((s=a+(e.y-s)*(u-a)/(l-s))==e.x)return!0;s>e.x&&(n=!n)}}return n}},{key:"isInCircle",value:function(e,t,n,r){if(e.x<r[0]&&e.x>r[1])return!1;if(e.y<r[2]&&e.y>r[3])return!1;var i=n*n;return r=e.x,n=e.y,(n=(r=(e=t.x)-r)*r+(n=(t=t.y)-n)*n)<i}},{key:"isRectCross",value:function(e,t,n,r){return!(Math.max(e.x,t.x)<Math.min(n.x,r.x)||Math.max(e.y,t.y)<Math.min(n.y,r.y)||Math.max(n.x,r.x)<Math.min(e.x,t.x)||Math.max(n.y,r.y)<Math.min(e.y,t.y))}},{key:"pointIsInRect",value:function(e,t,n,r){return Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<r}},{key:"pointIsInRect1",value:function(e,t,n){var r=Math.min(t.x,n.x),i=Math.max(t.x,n.x),o=Math.min(t.y,n.y);return n=Math.max(t.y,n.y),!(e.x<r||e.x>i||e.y<o||e.y>n)}},{key:"cross",value:function(e,t,n){return(e.x-n.x)*(t.y-n.y)-(t.x-n.x)*(e.y-n.y)}},{key:"isLineSegmentCross",value:function(t,n,r,i){return!(Math.max(t.x,n.x)<Math.min(r.x,i.x)||Math.max(t.y,n.y)<Math.min(r.y,i.y)||Math.max(r.x,i.x)<Math.min(t.x,n.x)||Math.max(r.y,i.y)<Math.min(t.y,n.y)||e.cross(r,n,t)*e.cross(n,i,t)<0||e.cross(t,i,r)*e.cross(i,n,r)<0)}},{key:"rayCrossSegment",value:function(e,t,n,r,i){var o=Math.min(e.x,n.x,r.x),a=Math.max(e.x,n.x,r.x),s=Math.min(e.y,n.y,r.y),u=Math.max(e.y,n.y,r.y);return u=Math.sqrt((a-o)*(a-o)+(u-s)*(u-s)),s=t/180*Math.PI,t=u*Math.cos(s)+e.x,s=u*Math.sin(s)+e.y,1==this.calcCrossPoint(e,{x:t,y:s},n,r,i)}},{key:"calcCrossPoint",value:function(t,n,r,i,o){if(1!=e.isLineSegmentCross(t,n,r,i))return 0;var a=(i.x-r.x)*(t.y-n.y)-(n.x-t.x)*(r.y-i.y),s=(t.y-r.y)*(n.x-t.x)*(i.x-r.x)+r.x*(i.y-r.y)*(n.x-t.x)-t.x*(n.y-t.y)*(i.x-r.x);return o.x=s/a,a=(t.x-n.x)*(i.y-r.y)-(n.y-t.y)*(r.x-i.x),s=n.y*(t.x-n.x)*(i.y-r.y)+(i.x-n.x)*(i.y-r.y)*(t.y-n.y)-i.y*(r.x-i.x)*(n.y-t.y),o.y=s/a,1}},{key:"pointInPolygon2d",value:function(e,t,n){for(var r=!1,i=null,o=null,a=0;a<n;a++)i=e[a],o=e[(a+1)%n],(i.y<t.y&&o.y>=t.y||o.y<t.y&&i.y>=t.y)&&(i.x<=t.x||o.x<=t.x)&&i.x+(t.y-i.y)/(o.y-i.y)*(o.x-i.x)<t.x&&(r=!r);return r}},{key:"pointInPolygon2d1",value:function(e,t,n){for(var r=0,i=null,o=null,a=null,s=0;s<n;s++)if(i=e[s],o=e[(s+1)%n],(i.y<t.y&&o.y>=t.y||o.y<t.y&&i.y>=t.y)&&(i.x<=t.x||o.x<=t.x)){if(a=i.x+(t.y-i.y)/(o.y-i.y)*(o.x-i.x),Math.abs(a-t.x)<=l)return 2;a<t.x&&(r=!r)}return r}},{key:"pointInPolygonVector2d",value:function(e,t,n){for(var r=!1,i=null,o=null,a=0,s=n/2,u=0;u<s;u++)i={x:e[a=2*u],y:e[a+1]},o={x:e[(a+2)%n],y:e[(a+3)%n]},(i.y<t.y&&o.y>=t.y||o.y<t.y&&i.y>=t.y)&&(i.x<=t.x||o.x<=t.x)&&i.x+(t.y-i.y)/(o.y-i.y)*(o.x-i.x)<t.x&&(r=!r);return r}},{key:"pointToSegmentDistance",value:function(e,t,n){var r=e.x,i=e.y,o=t.x,a=t.y,s=n.x;return(t=(s-o)*(r-o)+((e=n.y)-a)*(i-a))<=0?Math.sqrt((r-o)*(r-o)+(i-a)*(i-a)):(n=(s-o)*(s-o)+(e-a)*(e-a))<=t?Math.sqrt((r-s)*(r-s)+(i-e)*(i-e)):(o+=(s-o)*(n=t/n),n=a+(e-a)*n,Math.sqrt((r-o)*(r-o)+(n-i)*(n-i)))}},{key:"pointToPolygon2d",value:function(t,n,r){for(var i=null,o=null,a=Number.MAX_VALUE,s=0;s<r;s++){i=t[s],o=t[(s+1)%r];var u=e.pointToSegmentDistance(n,i,o);u<a&&(a=u)}return a}},{key:"lineInCircle2d",value:function(t,n,r,i,o){if(t.x<o[0]&&n.x<o[0])return!1;if(t.x>o[1]&&n.x>o[1])return!1;if(t.y<o[2]&&n.y<o[2])return!1;if(t.y>o[3]&&n.y>o[3])return!1;var a=i*i,s=t.x,u=t.y,l=n.x,c=n.y,h=r.x,f=r.y,d=l-s;return i=d*d+(o=c-u)*o,r=(t=h-s)*t+(n=f-u)*n,e.isZero(i)?!!e.isZero(r)||r<a:(n=(d/=i=Math.sqrt(i))*t+(o/=i)*n,e.gtZero(n)?e.ltZero(n-i)?(o=(d=h-(d=s+n*d))*d+(o=f-(o=u+n*o))*o)<a:(c=(l=h-l)*l+(c=f-c)*c)<a:r<a)}},{key:"lineInPolygon2d",value:function(t,n,r,i){if(t.x<i[0]&&n.x<i[0])return!1;if(t.x>i[1]&&n.x>i[1])return!1;if(t.y<i[2]&&n.y<i[2])return!1;if(t.y>i[3]&&n.y>i[3])return!1;var o=r.length;if(e.pointInPolygon2d(r,t,o))return!0;if(e.pointInPolygon2d(r,n,o))return!0;for(var a=0;a<o;a++){var s=(a+1)%o;if(e.isLineSegmentCross(t,n,r[a],r[s]))return!0}return!1}},{key:"calcLineCircleCrossPoints2d",value:function(t,n,r,i,o){if(t.x<o[0]&&n.x<o[0])return null;if(t.x>o[1]&&n.x>o[1])return null;if(t.y<o[2]&&n.y<o[2])return null;if(t.y>o[3]&&n.y>o[3])return null;var a={isContain:!1,crossPoints:[]},u=i*i,l=t.x,c=t.y,h=n.x,f=n.y,d=r.x,p=r.y,g=h-l,m=f-c,v=g*g+m*m;return r=(o=d-l)*o+(i=p-c)*i,f=(h=d-h)*h+(f=p-f)*f,e.isZero(v)?((e.isZero(r)||r<u)&&(a.isContain=!0,a.crossPoints=[t,n]),a):r<u&&f<u?(a.isContain=!0,a.crossPoints=[t,n],a):(g=o*(n=g/(t=Math.sqrt(v)))+i*(v=m/t),u-(i=o*o+i*i)+(m=g*g)<0?null:(i=Math.sqrt(u-i+m),-s<+(m=g-i)&&m-t<s&&a.crossPoints.push({x:l+m*n,y:c+m*v}),-s<+(m=g+i)&&m-t<s&&a.crossPoints.push({x:l+m*n,y:c+m*v}),a))}},{key:"calcLinePolygonCrossPoints2d",value:function(t,n,r,i){if(t.x<i[0]&&n.x<i[0])return null;if(t.x>i[1]&&n.x>i[1])return null;if(t.y<i[2]&&n.y<i[2])return null;if(t.y>i[3]&&n.y>i[3])return null;var o={containType:0,crossPoints:[]},a=r.length;e.pointInPolygon2d(r,t,a)&&(o.containType|=1),e.pointInPolygon2d(r,n,a)&&(o.containType|=2);for(var s=[],u=0;u<a;u++){var l,c=(u+1)%a,h={};e.calcCrossPoint(t,n,r[u],r[c],h)&&(l=h.x-t.x,c=h.y-t.y,s.push({dis2:l*l+c*c,point:h}))}if(0==s.length)return null;s.sort((function(e,t){return t.dis2-e.dis2}));for(var f=0;f<s.length;f++)o.crossPoints.push(s[f].point);return o}},{key:"calcCenterOfGravityPoint",value:function(e,t){for(var n=0,r=0,i=0,o=0;o<t;o++){var a=e[o],s=e[(o+1)%t],u=(a.x*s.y-a.y*s.x)/2;n+=u,r+=u*(a.x+s.x)/3,i+=u*(a.y+s.y)/3}return{x:r/=n,y:i/=n}}},{key:"calcPolygonArea2d",value:function(e){var t=e.length;if(t<3)return 0;for(var n=0,r=0;r<t;++r){var i=e[r],o=e[(r+1)%t];n+=i.x*o.y-i.y*o.x}return Math.abs(n/2)}},{key:"quickRayIntersect",value:function(t,n,r,i,o){var a=Math.min(r.x,i.x),s=Math.max(r.x,i.x),u=Math.min(r.y,i.y),c=Math.max(r.y,i.y),h=t.x,f=t.y,d=r.x,p=r.y,g=i.x,m=i.y;if(90==n){if(t.x<a||t.x>s)return!1;var v=(v=(m-p)/(g-d))*(h-d)+p;return o.y=v,o.x=h,!(v<f||!e.pointIsInRect1(o,r,i))}if(270==n)return!(t.x<a||t.x>s||(t=(m-p)/(g-d),t=t*(h-d)+p,o.y=t,o.x=h,f<t||!e.pointIsInRect1(o,r,i)));if(270!=n&&90!=n&&s-a<l&&(s=a,a=(a=Math.tan(n/180*Math.PI))*(s-h)+f,o.y=a,o.x=s,e.pointIsInRect1(o,r,i)))return s-=h,a-=f,0<(s/=Math.sqrt(s*s+a*a))*Math.cos(n/180*Math.PI);if(c-u<=1e-6){if(c=u,u=1/(u=Math.tan(n/180*Math.PI))*(c-f)+h,o.x=u,o.y=c,e.pointIsInRect1(o,r,i)){var y=c-f;return 0<(u=(u-=h)/Math.sqrt(u*u+y*y))*Math.cos(n/180*Math.PI)}return!1}return y=f+(y=Math.tan(n/180*Math.PI))*((g=(p-f-((g=(m-p)/(g-d))*d-y*h))/(y-g))-h),o.x=g,o.y=y,!!e.pointIsInRect1(o,r,i)&&(f=y-f,0<(f=(h=g-h)/Math.sqrt(h*h+f*f))*Math.cos(n/180*Math.PI))}},{key:"calcFootOfUpright",value:function(t,n,r,i){var o=Math.min(n.x,r.x),a=Math.max(n.x,r.x),s=Math.min(n.y,r.y),l=Math.max(n.y,r.y),c=t.x,h=t.y,f=n.x,d=n.y,p=r.x;return t=r.y,Math.abs(f-p)<u?(i.x=f,i.y=h,s<=h&&h<=l):Math.abs(d-t)<u?(i.x=c,i.y=d,o<=c&&c<=a):(c=h+(a=-1/(a=(t-d)/(p-f)))*((p=(d-h-((p=(t-d)/(p-f))*f-a*c))/(a-p))-c),i.x=p,i.y=c,!!e.pointIsInRect1(i,n,r))}},{key:"vectorCross",value:function(e,t){return{x:e.y*t.z-e.z*t.y,y:e.z*t.x-e.x*t.z,z:e.x*t.y-e.y*t.x}}},{key:"vectorDot",value:function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}},{key:"vectorLength",value:function(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}},{key:"vector2DDot",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"vector2DLength",value:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)}},{key:"calcRotateAngle",value:function(t,n){if(0==t.x&&0==t.y||0==n.x&&0==n.y)return 0;var r={x:t.x,y:t.y,z:0},i={x:n.x,y:n.y,z:0};return r=e.vectorCross(r,i),i=e.vector2DDot(t,n),n=Math.acos(i/(e.vector2DLength(t)*e.vector2DLength(n))),0<r.z?n/Math.PI*180:360-n/Math.PI*180}},{key:"isPointOnSegment",value:function(e,t,n){return(e.x-t.x)*(n.y-t.y)==(n.x-t.x)*(e.y-t.y)&&Math.min(t.x,n.x)<=e.x&&e.x<=Math.max(t.x,n.x)&&Math.min(t.y,n.y)<=e.y&&e.y<=Math.max(t.y,n.y)}},{key:"segCrossPolygon",value:function(e,t,n,r){for(var i=0;i<n.length;i++){var o=n[i],a=n[(i+1)%n.length];if(1==this.calcCrossPoint(e,t,o,a,r))return!0}return!1}}]),e}(),t.default=n},function(e,t,n){var r=n(23),i=n(59);e.exports=n(10)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){e.exports=!n(20)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){e.exports=n(155)},function(e,t,n){"use strict";var r=n(8),i=n(30),o=n(36),a=n(190),s=n(61),u=n(7),l=n(81).f,c=n(80).f,h=n(23).f,f=n(193).trim,d="Number",p=x=r[d],g=x.prototype,m=o(n(85)(g))==d,v="trim"in String.prototype,y=function(e){if("string"==typeof(r=s(e,!1))&&2<r.length){var t,n,r,i=(r=v?r.trim():f(r,3)).charCodeAt(0);if(43===i||45===i){if(88===(e=r.charCodeAt(2))||120===e)return NaN}else if(48===i){switch(r.charCodeAt(1)){case 66:case 98:t=2,n=49;break;case 79:case 111:t=8,n=55;break;default:return+r}for(var o,a=r.slice(2),u=0,l=a.length;u<l;u++)if((o=a.charCodeAt(u))<48||n<o)return NaN;return parseInt(a,t)}}return+r};if(!x(" 0o1")||!x("0b1")||x("+0x1")){for(var _,x=function(e){e=arguments.length<1?0:e;var t=this;return t instanceof x&&(m?u((function(){g.valueOf.call(t)})):o(t)!=d)?a(new p(y(e)),t,x):y(e)},A=n(10)?l(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),I=0;A.length>I;I++)i(p,_=A[I])&&!i(x,_)&&h(x,_,c(p,_));x.prototype=g,g.constructor=x,n(25)(r,d,x)}},function(e,t,n){var r=n(38),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(27),i=n(98),o=n(69),a=Object.defineProperty;t.f=n(14)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){return"object"==u(e)?null!==e:"function"==typeof e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==u(e)?null!==e:"function"==typeof e}},function(e,t,n){var r=n(21);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(22),i=n(117),o=n(61),a=Object.defineProperty;t.f=n(10)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(8),i=n(62),o=n(13),a=n(25),s=n(58),u="prototype",l=function e(t,n,l){var c,h,f,d=t&e.F,p=t&e.G,g=t&e.P,m=t&e.B,v=p?r:t&e.S?r[n]||(r[n]={}):(r[n]||{})[u],y=p?i:i[n]||(i[n]={}),_=y[u]||(y[u]={});for(c in p&&(l=n),l)h=((f=!d&&v&&void 0!==v[c])?v:l)[c],f=m&&f?s(h,r):g&&"function"==typeof h?s(Function.call,h):h,v&&a(v,c,h,t&e.U),y[c]!=h&&o(y,c,f),g&&_[c]!=h&&(_[c]=h)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var r=n(8),i=n(13),o=n(30),a=n(47)("src"),s=n(194),u="toString",l=(""+s).split(u);n(62).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(u&&(o(n,a)||i(n,a,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,u,(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,n){"use strict";var r=n(24),i=n(79),o=n(39),a=n(7),s=[].sort,u=[1,2,3];r(r.P+r.F*(a((function(){u.sort(void 0)}))||!a((function(){u.sort(null)}))||!n(197)(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},function(e,t,n){var r=n(19);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(162),i=n(163),o=n(188),a=n(189);e.exports=function(e){return r(e)||i(e)||o(e)||a()},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){"use strict";var r=n(131),i=n(208),o=n(40),a=n(60);e.exports=n(209)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r=n(64),i={};i[n(5)("toStringTag")]="z",i+""!="[object z]"&&n(25)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={NaviNodeType_NULL:-1,NaviNodeType_COMMON:0,NaviNodeType_SIDE:1,NaviNodeType_FLOOR:2,NaviNodeType_EXTENT:3,NaviLiftType_NULL:0,NaviLiftType_Lift:1,NaviLiftType_Stair:2,NaviLiftType_Escalator:3,NaviLiftType_Accessible:4,NaviLiftEntry_BOTH:0,NaviLiftEntry_UP:1,NaviLiftEntry_DOWN:2,NaviLiftEntry_FORBID:3,NaviEntranceType_NULL:0,NaviEntranceType_EXIT:1,NaviEntranceType_ENTRANCE:2,NaviEntranceType_ACCESS:3,NaviRoadRank_MAIN:1,NaviRoadRank_MINOR:2,NaviRoadRank_NARROW:3,NaviRoadEntry_BOTH:0,NaviRoadEntry_FORWARD:1,NaviRoadEntry_BACK:2,NaviRoadEntry_FORBID:3,NaviRoadPass_NULL:-1,NaviRoadPass_NOT_THROUGH:0,NaviRoadPass_THROUGH:1,NaviZoneType_NULL:-1,NaviZoneType_PASS_UNRESTRAINT:0,NaviZoneType_PASS_THROUGH:1,NaviZoneType_PASS_NOT_THROUGH:2,NaviZoneType_NO_ENTRY:3,NaviZoneType_CORRIDOR:4,NaviModelPassType_PASS_THROUGH:0,NaviModelPassType_PASS_NOT_THROUGH:1,NaviModelPassType_NOT_PASS:2,NaviModelPassType_DECORATE:3,NaviRoadHinderType_HINDER_GENERAL:0,NaviRoadHinderType_HINDER_HIGH:1,NaviObstructType_MODEL:0,NaviObstructType_EXTENT:1},t.default=n},function(e,t,n){var r=n(18),i=n(43);e.exports=n(14)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(101),i=n(53);e.exports=function(e){return r(i(e))}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t,n){var r=n(37);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports={}},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={MODULE_SHORTEST:1,MODULE_BEST:2},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(15)),a=i(n(2)),s=i(n(3)),u=(i(n(135)),i(n(33)));n=function(){function e(){(0,a.default)(this,e),this.Id=0,this.point={},this._type=0,this.liftFloors=[],this.segLinks=[],this.liftFlag=0,this.relatedLiftNodes=[],this.treatHead=!1,this.treatTail=!1,this._dist=0,this._visited=!1,this._vPre=[]}return(0,s.default)(e,[{key:"nodeType",get:function(){return 3&this._type},set:function(e){-1!=e&&(this._type|=e)}},{key:"liftType",get:function(){return this._type>>2&7},set:function(e){this._type|=e<<2}},{key:"liftEntry",get:function(){return this._type>>5&3},set:function(e){this._type|=e<<5}},{key:"entranceType",get:function(){return this._type>>7&3},set:function(e){this._type|=e<<7}},{key:"tempType",get:function(){return _type>>9&3},set:function(e){this._type|=e<<9}},{key:"init",value:function(e){this.Id=e,this.point={x:0,y:0},this._type=0,this.liftFlag=0,this.treatHead=!1,this.treatTail=!1}},{key:"equals",value:function(e){return this.Id==e.Id}},{key:"setNode",value:function(e){this.Id=e.Id,this.point=(0,o.default)({},e.point),this._type=e._type,this.liftFloors=[];for(var t=0;t<e.liftFloors.length;t++)this.liftFloors[t]=e.liftFloors[t];this.segLinks=[];for(var n=0;n<e.segLinks.length;n++)this.segLinks[n]=e.segLinks[n];this.liftFlag=e.liftFlag,this.relatedLiftNodes=[];for(var r=0;r<e.relatedLiftNodes.length;r++)this.relatedLiftNodes[r]=e.relatedLiftNodes[r];this.treatHead=e.treatHead,this.treatTail=e.treatTail}},{key:"getLiftFloorsLength",value:function(){return this.liftFloors.length}},{key:"getSegLinksLength",value:function(){return this.segLinks.length}},{key:"contansFloor",value:function(e){if(this.liftType==u.default.NaviLiftType_Stair)return!0;for(var t=this.liftFloors.length-1;0<=t;t--)if(this.liftFloors[t]==e)return!0;return!1}}]),e}(),t.default=n},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(53);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports={}},function(e,t,n){var r=n(38),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){e.exports=n(218)},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={ROUTE_SUCCESS:1,ROUTE_FAILED_NO_FMDBDATA:2,ROUTE_FAILED_TOO_CLOSE:3,ROUTE_FAILED_NO_DATA_START:4,ROUTE_FAILED_NO_DATA_END:5,ROUTE_FAILED_NO_STAIR:6,ROUTE_FAILED_NOTSUPPORT:7,ROUTE_FAILED_CANNOT_CALCULATE:8,ROUTE_FAILED_CANNOT_ARRIVE:9,ROUTE_FAILED_WAYPOINT_CALCULATE_ERROR:10,ROUTE_FAILED_NO_START_ARRIVAL:11,ROUTE_FAILED_NO_END_ARRIVAL:12,ROUTE_FAILED_OUTLINE:13,ROUTE_FAILED_NO_DOOR_START:14,ROUTE_FAILED_NO_DOOR_END:15},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(32),n(31),n(51),n(26);var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e),this.keys=[],this.data={}}return(0,a.default)(e,[{key:"clear",value:function(){this.keys=[],this.data={}}},{key:"put",value:function(e,t){null==this.data[e]&&this.keys.push(e),this.data[e]=t}},{key:"get",value:function(e){return this.data[e]}},{key:"has",value:function(e){for(var t=this.keys.length,n=0;n<t;n++)if(this.keys[n]==e)return!0;return!1}},{key:"remove",value:function(e){var t=this.keys.indexOf(e);-1!=t&&(this.keys.splice(t,1),this.data[e]=null)}},{key:"each",value:function(e){if("function"==typeof e)for(var t=this.keys.length,n=0;n<t;n++){var r=this.keys[n];e(r,this.data[r],n)}}},{key:"entrys",value:function(){for(var e=this.keys.length,t=new Array(e),n=0;n<e;n++)t[n]={key:this.keys[n],value:this.data[n]};return t}},{key:"isEmpty",value:function(){return 0==this.keys.length}},{key:"size",value:function(){return this.keys.length}},{key:"toString",value:function(){for(var e="{",t=0;t<this.keys.length;t++,e+=","){var n=this.keys[t];e+=n+"="+this.data[n]}return e+"}"}},{key:"sort",value:function(){this.keys.sort((function(e,t){return e-t}))}}]),e}(),t.default=n},function(e,t,n){for(var r=n(31),i=n(121),o=n(25),a=n(8),s=n(13),u=n(40),l=(n=n(5))("iterator"),c=n("toStringTag"),h=u.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(f),p=0;p<d.length;p++){var g,m=d[p],v=f[m],y=a[m],_=y&&y.prototype;if(_&&(_[l]||s(_,l,h),_[c]||s(_,c,m),u[m]=h,v))for(g in r)_[g]||o(_,g,r[g],!0)}},function(e,t,n){var r=n(100),i=n(74);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){e.exports=!0},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(27),i=n(108),o=n(74),a=n(72)("IE_PROTO"),s=function(){},u="prototype",l=function(){var e=n(99)("iframe"),t=o.length;for(e.style.display="none",n(168).appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;t--;)delete l[u][o[t]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[u]=r(e),n=new s,s[u]=null,n[a]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(79);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(116),i=n(37);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(21);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e=e.exports={version:"2.6.12"},"number"==typeof __e&&(__e=e)},function(e,t){e.exports=!1},function(e,t,n){var r=n(36),i=n(5)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?e:o?r(t):"Object"==(e=r(t))&&"function"==typeof t.callee?"Arguments":e}},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={PRIORITY_DEFAULT:1,PRIORITY_LIFTFIRST:2,PRIORITY_ESCALATORFIRST:3,PRIORITY_STAIRFIRST:4,PRIORITY_LIFTONLY:5,PRIORITY_ESCALATORONLY:6,PRIORITY_STAIRONLY:7,PRIORITY_ACCESSIBLEONLY:8,PRIORITY_LIFTFIRST1:9,PRIORITY_ESCALATORFIRST1:10,PRIORITY_STAIRFIRST1:11},t.default=n},function(e,t,n){"use strict";var r=n(24),i=n(129)(5),o="find",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r(r.P+r.F*a,"Array",{find:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),n(131)(o)},function(e,t,n){var r=n(68);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(19);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t,n){var r=n(73)("keys"),i=n(55);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(4),i=n(9),o="__core-js_shared__",a=i[o]||(i[o]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(54)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(18).f,i=n(28),o=n(11)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){t.f=n(11)},function(e,t,n){var r=n(9),i=n(4),o=n(54),a=n(77),s=n(18).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=!o&&r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(192),i=n(59),o=n(60),a=n(61),s=n(30),u=n(117),l=Object.getOwnPropertyDescriptor;t.f=n(10)?l:function(e,t){if(e=o(e),t=a(t,!0),u)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(119),i=n(84).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(83)("keys"),i=n(47);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(62),i=n(8),o="__core-js_shared__",a=i[o]||(i[o]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(63)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(22),i=n(196),o=n(84),a=n(82)("IE_PROTO"),s=function(){},u="prototype",l=function(){var e=n(118)("iframe"),t=o.length;for(e.style.display="none",n(122).appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;t--;)delete l[u][o[t]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[u]=r(e),n=new s,s[u]=null,n[a]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){"use strict";var r,i,o,a,s,l,c,h,f,d,p,g,m,v,y,_,x,A,I,w,b,C,M,E,T,S,L,k,R,N,P,O,D,F,B,G,z,U,V,H,j,W,Y,q,X,Z,J,K,Q,$,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,he,fe,de,pe,ge,me,ve,ye,_e,xe,Ae,Ie,we,be,Ce,Me,Ee,Te,Se,Le,ke,Re,Ne,Pe,Oe,De,Fe,Be,Ge,ze,Ue,Ve;n(10)?(r=n(63),i=n(8),o=n(7),a=n(24),s=n(123),l=n(202),c=n(58),h=n(125),f=n(59),d=n(13),p=n(124),g=n(38),m=n(17),v=n(126),y=n(46),_=n(61),x=n(30),A=n(64),I=n(21),w=n(39),b=n(203),C=n(85),M=n(128),E=n(81).f,T=n(204),ze=n(47),Le=n(5),Ue=n(129),S=n(120),L=n(130),k=n(31),R=n(40),N=n(211),P=n(212),O=n(127),D=n(213),F=n(23),B=n(80),G=F.f,z=B.f,U=i.RangeError,V=i.TypeError,H=i.Uint8Array,W="Shared"+(j="ArrayBuffer"),Y="BYTES_PER_ELEMENT",q="prototype",n=Array[q],X=l.ArrayBuffer,Z=l.DataView,J=Ue(0),K=Ue(2),Q=Ue(3),$=Ue(4),ee=Ue(5),te=Ue(6),ne=S(!0),re=S(!1),ie=k.values,oe=k.keys,ae=k.entries,se=n.lastIndexOf,ue=n.reduce,le=n.reduceRight,ce=n.join,he=n.sort,fe=n.slice,de=n.toString,pe=n.toLocaleString,ge=Le("iterator"),me=Le("toStringTag"),ve=ze("typed_constructor"),ye=ze("def_constructor"),n=s.CONSTR,_e=s.TYPED,xe=s.VIEW,Ae="Wrong length!",Ie=Ue(1,(function(e,t){return Ee(L(e,e[ye]),t)})),we=o((function(){return 1===new H(new Uint16Array([1]).buffer)[0]})),be=!!H&&!!H[q].set&&o((function(){new H(1).set({})})),Ce=function(e,t){if((e=g(e))<0||e%t)throw U("Wrong offset!");return e},Me=function(e){if(I(e)&&_e in e)return e;throw V(e+" is not a typed array!")},Ee=function(e,t){if(!I(e)||!(ve in e))throw V("It is not a typed array constructor!");return new e(t)},Te=function(e,t){return Se(L(e,e[ye]),t)},Se=function(e,t){for(var n=0,r=t.length,i=Ee(e,r);n<r;)i[n]=t[n++];return i},Le=function(e,t,n){G(e,t,{get:function(){return this._d[n]}})},ke=function(e){var t,n,r,i,o,a,s=w(e),u=arguments.length,l=1<u?arguments[1]:void 0,h=void 0!==l;if(null!=(e=T(s))&&!b(e)){for(a=e.call(s),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);s=r}for(h&&2<u&&(l=c(l,arguments[2],2)),t=0,n=m(s.length),i=Ee(this,n);t<n;t++)i[t]=h?l(s[t],t):s[t];return i},Re=function(){for(var e=0,t=arguments.length,n=Ee(this,t);e<t;)n[e]=arguments[e++];return n},Ne=!!H&&o((function(){pe.call(new H(1))})),Pe=function(){return pe.apply(Ne?fe.call(Me(this)):Me(this),arguments)},Oe={copyWithin:function(e,t){return D.call(Me(this),e,t,2<arguments.length?arguments[2]:void 0)},every:function(e){return $(Me(this),e,1<arguments.length?arguments[1]:void 0)},fill:function(e){return O.apply(Me(this),arguments)},filter:function(e){return Te(this,K(Me(this),e,1<arguments.length?arguments[1]:void 0))},find:function(e){return ee(Me(this),e,1<arguments.length?arguments[1]:void 0)},findIndex:function(e){return te(Me(this),e,1<arguments.length?arguments[1]:void 0)},forEach:function(e){J(Me(this),e,1<arguments.length?arguments[1]:void 0)},indexOf:function(e){return re(Me(this),e,1<arguments.length?arguments[1]:void 0)},includes:function(e){return ne(Me(this),e,1<arguments.length?arguments[1]:void 0)},join:function(e){return ce.apply(Me(this),arguments)},lastIndexOf:function(e){return se.apply(Me(this),arguments)},map:function(e){return Ie(Me(this),e,1<arguments.length?arguments[1]:void 0)},reduce:function(e){return ue.apply(Me(this),arguments)},reduceRight:function(e){return le.apply(Me(this),arguments)},reverse:function(){for(var e,t=this,n=Me(t).length,r=Math.floor(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t},some:function(e){return Q(Me(this),e,1<arguments.length?arguments[1]:void 0)},sort:function(e){return he.call(Me(this),e)},subarray:function(e,t){var n=Me(this),r=n.length;return e=y(e,r),new(L(n,n[ye]))(n.buffer,n.byteOffset+e*n.BYTES_PER_ELEMENT,m((void 0===t?r:y(t,r))-e))}},De=function(e,t){return Te(this,fe.call(Me(this),e,t))},Fe=function(e){Me(this);var t=Ce(arguments[1],1),n=this.length,r=w(e),i=m(r.length),o=0;if(n<i+t)throw U(Ae);for(;o<i;)this[t+o]=r[o++]},Be={entries:function(){return ae.call(Me(this))},keys:function(){return oe.call(Me(this))},values:function(){return ie.call(Me(this))}},Ge=function(e,t){return I(e)&&e[_e]&&"symbol"!=u(t)&&t in e&&String(+t)==String(t)},ze=function(e,t){return Ge(e,t=_(t,!0))?f(2,e[t]):z(e,t)},Ue=function(e,t,n){return!(Ge(e,t=_(t,!0))&&I(n)&&x(n,"value"))||x(n,"get")||x(n,"set")||n.configurable||x(n,"writable")&&!n.writable||x(n,"enumerable")&&!n.enumerable?G(e,t,n):(e[t]=n.value,e)},n||(B.f=ze,F.f=Ue),a(a.S+a.F*!n,"Object",{getOwnPropertyDescriptor:ze,defineProperty:Ue}),o((function(){de.call({})}))&&(de=pe=function(){return ce.call(this)}),Ve=p({},Oe),p(Ve,Be),d(Ve,ge,Be.values),p(Ve,{slice:De,set:Fe,constructor:function(){},toString:de,toLocaleString:Pe}),Le(Ve,"buffer","b"),Le(Ve,"byteOffset","o"),Le(Ve,"byteLength","l"),Le(Ve,"length","e"),G(Ve,me,{get:function(){return this[_e]}}),e.exports=function(e,t,n,u){var l=e+((u=!!u)?"Clamped":"")+"Array",c="get"+e,f="set"+e,p=i[l],g=p||{},y=p&&M(p),_=!p||!s.ABV,x=(e={},p&&p[q]),w=function(e,n){G(e,n,{get:function(){return function(e,n){return(e=e._d).v[c](n*t+e.o,we)}(this,n)},set:function(e){return function(e,n,r){e=e._d,u&&(r=(r=Math.round(r))<0?0:255<r?255:255&r),e.v[f](n*t+e.o,r,we)}(this,n,e)},enumerable:!0})};_?(p=n((function(e,n,r,i){h(e,p,l,"_d");var o,a,s=0,u=0;if(I(n)){if(!(n instanceof X||(c=A(n))==j||c==W))return _e in n?Se(p,n):ke.call(p,n);var c=n;if(u=Ce(r,t),r=n.byteLength,void 0===i){if(r%t)throw U(Ae);if((o=r-u)<0)throw U(Ae)}else if(r<(o=m(i)*t)+u)throw U(Ae);a=o/t}else a=v(n),c=new X(o=a*t);for(d(e,"_d",{b:c,o:u,l:o,e:a,v:new Z(c)});s<a;)w(e,s++)})),x=p[q]=C(Ve),d(x,"constructor",p)):o((function(){p(1)}))&&o((function(){new p(-1)}))&&N((function(e){new p,new p(null),new p(1.5),new p(e)}),!0)||(p=n((function(e,n,r,i){var o;return h(e,p,l),I(n)?n instanceof X||(o=A(n))==j||o==W?void 0!==i?new g(n,Ce(r,t),i):void 0!==r?new g(n,Ce(r,t)):new g(n):_e in n?Se(p,n):ke.call(p,n):new g(v(n))})),J(y!==Function.prototype?E(g).concat(E(y)):E(g),(function(e){e in p||d(p,e,g[e])})),p[q]=x,r||(x.constructor=p)),n=!!(_=x[ge])&&("values"==_.name||null==_.name),y=Be.values,d(p,ve,!0),d(x,_e,l),d(x,xe,!0),d(x,ye,p),(u?new p(1)[me]==l:me in x)||G(x,me,{get:function(){return l}}),e[l]=p,a(a.G+a.W+a.F*(p!=g),e),a(a.S,l,{BYTES_PER_ELEMENT:t}),a(a.S+a.F*o((function(){g.of.call(p,1)})),l,{from:ke,of:Re}),Y in x||d(x,Y,t),a(a.P,l,Oe),P(l),a(a.P+a.F*be,l,{set:Fe}),a(a.P+a.F*!n,l,Be),r||x.toString==de||(x.toString=de),a(a.P+a.F*o((function(){new p(1).slice()})),l,{slice:De}),a(a.P+a.F*(o((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!o((function(){x.toLocaleString.call([1,2])}))),l,{toLocaleString:Pe}),R[l]=n?_:y,r||n||d(x,ge,y)}):e.exports=function(){}},function(e,t,n){var r=n(23).f,i=n(30),o=n(5)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";n(215)("sub",(function(e){return function(){return e(this,"sub","","")}}))},function(e,t,n){"use strict";var r=n(22);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(t,n,r,i){(0,o.default)(this,e),this._groupId=t,this._length=n,this._pointList=r||[],this._nodeList=i||[]}return(0,a.default)(e,[{key:"dispose",value:function(){this._pointList=[],this._nodeList=[]}},{key:"groupId",get:function(){return this._groupId}},{key:"GroupId",get:function(){return this._groupId}},{key:"length",get:function(){return this._length}},{key:"Length",get:function(){return this._length}},{key:"pointList",get:function(){return this.getPointList()}},{key:"PointList",get:function(){return this.getPointList()}},{key:"getPointList",value:function(){for(var e=[],t=0,n=this._pointList.length;t<n;t++)e.push({x:this._pointList[t].x,y:this._pointList[t].y,groupId:this._groupId});return e}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(224),i=n(22),o=n(130),a=n(225),s=n(17),u=n(227),l=n(93),c=n(7),h=Math.min,f=[].push,d="split",p="length",g="lastIndex",m=4294967295,v=!c((function(){RegExp(m,"y")}));n(228)("split",2,(function(e,t,n,c){var y="c"=="abbc"[d](/(b)*/)[1]||4!="test"[d](/(?:)/,-1)[p]||2!="ab"[d](/(?:ab)*/)[p]||4!="."[d](/(.?)(.?)/)[p]||1<"."[d](/()()/)[p]||""[d](/.?/)[p]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(i,e,t);for(var o,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,d=void 0===t?m:t>>>0,v=new RegExp(e.source,c+"g");(o=l.call(v,i))&&!(h<(a=v[g])&&(u.push(i.slice(h,o.index)),1<o[p]&&o.index<i[p]&&f.apply(u,o.slice(1)),s=o[0][p],h=a,u[p]>=d));)v[g]===o.index&&v[g]++;return h===i[p]?!s&&v.test("")||u.push(""):u.push(i.slice(h)),u[p]>d?u.slice(0,d):u}:"0"[d](void 0,0)[p]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n;return[function(n,r){var i=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):y.call(String(i),n,r)},function(e,t){if((f=c(y,e,this,t,y!==n)).done)return f.value;var r=i(e),l=String(this),f=o(r,RegExp),d=r.unicode,p=(e=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(v?"y":"g"),new f(v?r:"^(?:"+r.source+")",e)),g=void 0===t?m:t>>>0;if(0===g)return[];if(0===l.length)return null===u(p,l)?[l]:[];for(var _=0,x=0,A=[];x<l.length;){p.lastIndex=v?x:0;var I,w=u(p,v?l:l.slice(x));if(null===w||(I=h(s(p.lastIndex+(v?0:x)),l.length))===_)x=a(l,x,d);else{if(A.push(l.slice(_,x)),A.length===g)return A;for(var b=1;b<=w.length-1;b++)if(A.push(w[b]),A.length===g)return A;x=_=I}}return A.push(l.slice(_)),A}]}))},function(e,t,n){"use strict";var r,i=n(89),o=RegExp.prototype.exec,a=String.prototype.replace,s=o,u="lastIndex",l=(r=/a/,n=/b*/g,o.call(r,"a"),o.call(n,"a"),0!==r[u]||0!==n[u]),c=void 0!==/()??/.exec("")[1];(n=l||c)&&(s=function(e){var t,n,r,s,h=this;return c&&(n=new RegExp("^"+h.source+"$(?!\\s)",i.call(h))),l&&(t=h[u]),r=o.call(h,e),l&&r&&(h[u]=h.global?r.index+r[0].length:t),c&&r&&1<r.length&&a.call(r[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(r[s]=void 0)})),r}),e.exports=s},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(15)),a=i(n(2)),s=i(n(3)),u=i(n(12));i(n(135)),n=function(){function e(){(0,a.default)(this,e),this.Id=0,this.startId=-1,this.startPoint={},this.endId=-1,this.endPoint={},this.length=0,this._type=0,this.pointVector=[],this.extentId=-1,this._isInAdj=!1,this._info=0}return(0,s.default)(e,[{key:"roadRank",get:function(){return 3&this._type},set:function(e){this._type|=e}},{key:"roadEntry",get:function(){return this._type>>2&3},set:function(e){this._type|=e<<2}},{key:"tempType",get:function(){return this._type>>4&3},set:function(e){this._type|=e<<4}},{key:"through",get:function(){return 16&this._type?1:0},set:function(e){e?this._type|=16:this._type&=-17}},{key:"setRoad",value:function(e){this.Id=e.Id,this.startId=e.startId,this.startPoint=(0,o.default)({},e.startPoint),this.endId=e.endId,this.endPoint=(0,o.default)({},e.endPoint),this.length=e.length,this._type=e._type,this.pointVector=[],this.extentId=e.extentId;for(var t=0;t<e.pointVector.length;t++)this.pointVector[t]=e.pointVector[t]}},{key:"calcLength",value:function(){this.length=u.default.distanceOfTwoPoints(this.startPoint,this.endPoint)}},{key:"calcManhattanDistance",value:function(){var e=this.startPoint.x-this.endPoint.x,t=this.startPoint.y-this.endPoint.y;this.length=Math.abs(e)+Math.abs(t)}},{key:"calcMiddlePoint",value:function(){var e={};return e.x=(this.startPoint.x+this.endPoint.x)/2,e.y=(this.startPoint.y+this.endPoint.y)/2,e}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.NodeDistance=t.default=void 0;var o=i(n(134)),a=i(n(48));n(16),n(26),n(32),n(31),n(51),n(66);var s=i(n(29)),u=i(n(3)),l=i(n(2)),c=i(n(12)),h=i(n(42)),f=i(n(33)),d=i(n(50)),p=function e(){(0,l.default)(this,e),this.distance=Number.MAX_VALUE,this.node=null};t.NodeDistance=p,n=function(){function e(t,n,r,i){(0,l.default)(this,e),this.groupId=0,this._type=i,this.nodeVector=t,this.roadVector=n,this.obstructModels=[],this.obstructExtents=[],this.obstructLines=[],this.zones=[],this.zoneIDMap=new d.default,this.vertexLen=[],this.adjList=new d.default,this.nextFloorMap=new d.default,this._needVertex=r,this._roadDiffusion=[],this._nodeMap=new d.default,this._roadMap=new d.default,this._maxNodeId=0,this._maxRoadId=0,this.simplify(),this._init()}return(0,u.default)(e,[{key:"dispose",value:function(){this.nodeVector=null,this.roadVector=null,this.obstructModels=null,this.obstructExtents=null,this.obstructLines=null,this.zones=null,null!=this.zoneIDMap&&(this.zoneIDMap.clear(),this.zoneIDMap=null),null!=this.adjList&&(this.adjList.clear(),this.adjList=null),this.vertexLen=null,null!=this.nextFloorMap&&(this.nextFloorMap.clear(),this.nextFloorMap=null),this._roadDiffusion=null,null!=this._nodeMap&&(this._nodeMap.clear(),this._nodeMap=null),null!=this._roadMap&&(this._roadMap.clear(),this._roadMap=null)}},{key:"initVertexLen",value:function(e){for(var t,n,r=Number.MAX_VALUE,i=0;i<this.roadVector.length;i++)0!=this.needVertex&&(t=this.roadVector[i],1==e?r=t.length:2==e&&(r=t.length*t.roadRank),(n=t.roadEntry)!=f.default.NaviRoadEntry_BOTH&&n!=f.default.NaviRoadEntry_FORWARD||(this.vertexLen[t.startId][t.endId]=r),n!=f.default.NaviRoadEntry_BOTH&&n!=f.default.NaviRoadEntry_BACK||(this.vertexLen[t.endId][t.startId]=r))}},{key:"invalide",value:function(){return 0==this.nodeVector.length||0==this.roadVector.length}},{key:"reset",value:function(){for(var e=0;e<this.nodeVector.length;e++)this.nodeVector[e]._treatHead=!1;if(1==this._needVertex)for(var t=this.nodeVector.length+1,n=0;n<t;n++)for(var r=0;r<t;r++)void 0!==this.vertexLen[n]&&void 0!==this.vertexLen[n][r]&&(this.vertexLen[n][r]=Number.MAX_VALUE)}},{key:"obstructsToZones",value:function(){this.zones=[];for(var e=0;e<this.obstructExtents.length;e++){var t=(t=this.obstructExtents[e]).toZone();this.zones.push(t)}for(var n=0;n<this.obstructModels.length;n++){var r=(r=this.obstructExtents[n]).toZone();this.zones.push(r)}}},{key:"getZone",value:function(e){for(var t=0;t<this.zones.length;t++){var n=this.zones[t];if(n&&n.Id==e)return n}return null}},{key:"queryZoneByPoint",value:function(e){for(var t=0;t<this.zones.length;t++){var n=this.zones[t];if(n&&1==n.contain(e))return n}return null}},{key:"transpose",value:function(){}},{key:"queryEntranceCoordByPoint",value:function(e,t){var n=null;if(this.nodeVector.length<=0||this.roadVector.length<=0)return n;for(var r=[],i=0,o=this.nodeVector.length;i<o;i++){var a=this.nodeVector[i],s=a.entranceType;s!=t&&s!=f.default.NaviEntranceType_ACCESS||((s=new p).node=a,s.distance=c.default.distanceOfTwoPoints(e,a.point),r.push(s))}return 0==r.length||(n=(r=r.sort(this._nodeDistanceFunc))[0].node.point),n}},{key:"queryEntranceCoords",value:function(e){var t=[];if(this.nodeVector.length<=0||this.roadVector.length<=0)return t;for(var n=0,r=this.nodeVector.length;n<r;n++){var i=this.nodeVector[n],o=i.entranceType;o!=e&&o!=f.default.NaviEntranceType_ACCESS||t.push(i.point)}return t}},{key:"nodesAccess",value:function(e,t){if(this.nodeVector.length<=0||this.roadVector.length<=0)return!1;if(e.Id==t.Id)return!0;this._resetRoadDiffusion();var n=[];n.push(e.Id);for(var r=null,i=null,o=a=0;a!=n.length;){o=a;for(var a=n.length,s=o;s<n.length;s++)for(var u=0;u<this.roadVector.length;u++)if(1!=this._roadDiffusion[u]){if(i=(r=this.roadVector[u]).roadEntry,r.startId==n[s]&&(i==f.default.NaviRoadEntry_BOTH||i==f.default.NaviRoadEntry_FORWARD)){if(r.endId==t.Id)return!0;n.push(r.endId),this._roadDiffusion[u]=!0}if(r.endId==n[s]&&(i==f.default.NaviRoadEntry_BOTH||i==f.default.NaviRoadEntry_BACK)){if(r.startId==t.Id)return!0;n.push(r.startId),this._roadDiffusion[u]=!0}}}return!1}},{key:"querySameExtentLiftNodesByGeoPoint",value:function(e,t,n,r){if(this.nodeVector.length<=0||this.roadVector.length<=0)return[];var i=this.queryContainExtentId(e);if(0==i)return!1;for(var a=[],s=0;s<this.nodeVector.length;s++){var u=this.nodeVector[s],l=this.queryContainExtentId(u.point);!u.contansFloor(t)||l!=i&&0!=i||((l=new p).node=u,l.distance=c.default.distanceOfTwoPoints(e,u.point),l.distance=(0,o.default)(l.distance).toFixed(4),a.push(l))}if(!a||0==a.length)return[];a=a.sort(this._nodeDistanceFunc);for(var f=0;f<a.length;f++)n[f]=new h.default,n[f].setNode(a[f].node),r[f]=(0,o.default)(a[f].distance);return n}},{key:"queryLiftNodeByFLAGID",value:function(e,t){if(!this.nodeVector||this.nodeVector.length<=0||!this.roadVector||this.roadVector.length<=0)return!1;for(var n=0;n<this.nodeVector.length;n++){var r=this.nodeVector[n];if(r.nodeType==f.default.NaviNodeType_FLOOR&&r.liftFlag==e)return t.setNode(r),!0}return!1}},{key:"queryLiftNodesByType",value:function(e,t){if(!this.nodeVector||this.nodeVector.length<=0||!this.roadVector||this.roadVector.length<=0)return!1;for(var n=0;n<this.nodeVector.length;n++){var r=this.nodeVector[n];r.liftType==e&&(t[n]=r)}return 0!=t.length}},{key:"queryContainExtentId",value:function(e){if(0==this.obstructExtents.length||!e)return 0;for(var t=0,n=this.obstructExtents.length;t<n;t++){var r=this.obstructExtents[t];if(r.contain(e))return r.Id}return 0}},{key:"isLineObstruct",value:function(e,t){if(0==this.obstructLines.length||!e||!t)return!1;for(var n=0;n<this.obstructLines.length;n++)if(this.obstructLines[n].isCross(e,t))return!0;return!1}},{key:"queryNearestSameExtentElementByGeoPoint",value:function(e,t,n,r,i){var o=Number.MAX_VALUE,a={};if(new h.default,this.nodeVector.length<=0||this.roadVector.length<=0)return!1;var s=this.queryContainExtentId(e);if(0==s)return!1;for(var u=0,l=this.roadVector.length;u<l;u++){var d,p=this.roadVector[u];p&&s==this.queryContainExtentId(p.startPoint)&&(d=c.default.pointDistanceToLine(e,p.startPoint,p.endPoint,a),this.isLineObstruct(a,e)||d<o&&(o=d,t.setRoad(p),r.x=a.x,r.y=a.y))}if(!t||t.roadEntry==f.default.NaviRoadEntry_FORBID)return!1;for(var g=t.roadEntry==f.default.NaviRoadEntry_BACK||t.roadEntry!=f.default.NaviRoadEntry_FORWARD&&c.default.distanceOfTwoPoints(t.startPoint,r)<=c.default.distanceOfTwoPoints(t.endPoint,r)?t.startId:t.endId,m=0;m<this.nodeVector.length;m++){var v=this.nodeVector[m];if(v.Id==g){n.setNode(v);break}}return!0}},{key:"queryNearestSameExtentElementByGeoPointProcessForbid",value:function(e,t,n,r){var i=Number.MAX_VALUE,o={};if(new h.default,this.nodeVector.length<=0||this.roadVector.length<=0)return!1;var a=this.queryContainExtentId(e);if(0==a)return!1;for(var s=0;s<this.roadVector.length;s++){var u,l=this.roadVector[s];f.default.NaviRoadEntry_BOTH==l.roadEntry&&(a!=this.queryContainExtentId(l.startPoint)&&0!=a||(u=c.default.pointDistanceToLine(e,l.startPoint,l.endPoint,o),this.isLineObstruct(o,e)||u<i&&(i=u,t.setRoad(l),r.x=o.x,r.y=o.y)))}if(-1==t.Id)return!1;for(var d=c.default.distanceOfTwoPoints(t.startPoint,r)<=c.default.distanceOfTwoPoints(t.endPoint,r)?t.startId:t.endId,p=0;p<this.nodeVector.length;p++){var g=this.nodeVector[p];if(g.Id==d){n.setNode(g);break}}return-1!=n.Id}},{key:"simplify",value:function(){this._maxNodeId=0,this._maxRoadId=0;for(var e=0;e<this.roadVector.length;)null==this.roadVector[e]?this.roadVector.splice(e,1):(this.roadVector[e].Id>this._maxRoadId&&(this._maxRoadId=this.roadVector[e].Id),e++);for(var t=0;t<this.nodeVector.length;)null==this.nodeVector[t]?this.nodeVector.splice(t,1):(this.nodeVector[t].Id>this._maxNodeId&&(this._maxNodeId=this.nodeVector[t].Id),t++)}},{key:"consoleAdjList",value:function(e){if(e){var t,n=this.adjList,r=(this.nodeVector,this),i=(naviMap.size(),"*********  ADJLIST   ************\n");for(t in n.keys)for(var o=n.keys[t],a=o,s=n.get(o),u=0;u<s.length;u++){var l=(c=s[u]).nodeId,c=this._naviGraph.getIndexByNodeID(a);this._naviGraph.getIndexByNodeID(l),l=r.nodeVector[c],c=r.nodeVector[endidx],i=i+l.Id+","+l.point.x+","+l.point.y,i=(i+=",")+c.Id+","+c.point.x+","+c.point.y,i+="\n"}i+="*********** END **************"}}},{key:"consoleNodeInfos",value:function(e){if(e){var t=[];t.push.apply(t,(0,s.default)(this.nodeVector)),t.sort((function(e,t){return e.Id-t.Id}));for(var n=0;n<t.length;n++)for(var r=t[n],i=(r.Id,0);i<r.segLinks.length;i++)r.segLinks[i]}}},{key:"consoleNodePres",value:function(e){if(e)for(var t=0;t<this.nodeVector.length;t++)for(var n=this.nodeVector[t],r=(n.Id,0);r<n._vPre.length;r++)n._vPre[r]}},{key:"consoleRoadInfos",value:function(e){if(e){var t=[];t.push.apply(t,(0,s.default)(this.roadVector)),t.sort((function(e,t){return e.Id-t.Id}));for(var n=0;n<t.length;n++){var r=t[n];r.Id,r.startId,r.endId}}}},{key:"consoleAdjInfos",value:function(e){e&&(this.adjList.sort(),this.adjList.each((function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.nodeId,r.length.toFixed(6)}})))}},{key:"getIndexByNodeID",value:function(e){return void 0===(e=this._nodeMap.get(e))?null:e}},{key:"getIndexByRoadID",value:function(e){return void 0===(e=this._roadMap.get(e))?null:e}},{key:"findObstruct",value:function(e){for(var t=Number.MAX_VALUE,n=null,r=0;r<this.obstructExtents.length;++r){var i=this.obstructExtents[r];i.contain(e)&&i.area<t&&(t=cur_area,n=i)}for(var o=0;o<this.obstructModels.size();++o){var a=this.obstructModels[o];a.contain(e)&&a.area<t&&(t=cur_area,n=a)}return n||null}},{key:"findModel",value:function(e){for(var t=Number.MAX_VALUE,n=null,r=0;r<this.obstructModels.length;++r){var i=this.obstructModels[r];i.contain(e)&&i.area<t&&(t=i.area,n=i)}return n||null}},{key:"generateNodeId",value:function(){return++this._maxNodeId}},{key:"generateRoadId",value:function(){return++this._maxRoadId}},{key:"setBaseNodeId",value:function(e){this._maxNodeId=e}},{key:"setBaseRoadId",value:function(e){this._maxRoadId=e}},{key:"createNodeMap",value:function(){for(var e=0;e<this.nodeVector.length;e++){var t=this.nodeVector[e];t&&this._nodeMap.put(t.Id,e)}}},{key:"createRoadMap",value:function(){for(var e=0;e<this.roadVector.length;e++){var t=this.roadVector[e];t&&this._roadMap.put(t.Id,e)}}},{key:"clearNodeCache",value:function(){var e=this;this._nodeMap.each((function(t,n){(n=e.nodeVector[n])._vPre=[]}))}},{key:"makeUpAdjList",value:function(){var e=this;this.adjList.clear();for(var t,n=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(n){var r=e.roadVector[n];if(null==r)return"continue";var i,o=r.roadEntry;f.default.NaviRoadEntry_BOTH!=o&&f.default.NaviRoadEntry_FORWARD!=o||(n=r.startId,(i=e.adjList.get(n))||(i=[],e.adjList.put(n,i)),t=i.find((function(e){return e.nodeId==r.endId})),null==t&&i.push({nodeId:r.endId,length:r.length})),f.default.NaviRoadEntry_BOTH!=o&&f.default.NaviRoadEntry_BACK!=o||(i=r.endId,(o=e.adjList.get(i))||(o=[],e.adjList.put(i,o)),t=o.find((function(e){return e.nodeId==r.startId})),null==t&&o.push({nodeId:r.startId,length:r.length}))})),r=0;r<this.roadVector.length;r++)n(r)}},{key:"getIdxByNodeId",value:function(e){for(var t=9;t<this.nodeVector.length;t++)if(this.nodeVector[t].Id==e)return t;return-1}},{key:"getIdxByRoadId",value:function(e){for(var t=9;t<this.roadVector.length;t++)if(this.roadVector[t].Id==e)return t;return-1}},{key:"queryRoadsByPolygon",value:function(e){for(var t=[],n=this.roadVector,r=0;r<n.length;r++){var i=n[r].startPoint,o=n[r].endPoint,a=[];c.default.segCrossPolygon(i,o,e,a)?(a.sort((function(e,t){return(e=c.default.distanceOfTwoPoints(i,e))-c.default.distanceOfTwoPoints(i,t)})),t.push({road:n[r],crss:a})):c.default.pointInPolygon2d(e,i,e.length)&&t.push({road:n[r],crss:[]})}return t}},{key:"getModelByPoint",value:function(e){for(var t=null,n=1/0,r=0;r<this.obstructModels.length;r++){var i=this.obstructModels[r];i.Id,i.fid,c.default.pointInPolygon2d(i.points,e,i.points.length)&&n>c.default.calcPolygonArea2d(i.points)&&(t=i,n=c.default.calcPolygonArea2d(i.points))}return t}},{key:"getZoneIdByPoint",value:function(e){for(var t=-1,n=0;n<this.zones.length;n++){var r=this.zones[n];if(c.default.pointInPolygon2d(r.points,e,r.points.length)){t=r.Id;break}}return t}},{key:"getRandomModel",value:function(){var e=this.obstructModels.length;return e=(0,a.default)(Math.random()*e),this.obstructModels[e]}},{key:"_init",value:function(){if(1==this._needVertex)for(var e=null,t=0;t<this.roadVector.length;t++)e=this.roadVector[t],void 0===this.vertexLen[e.startId]&&(this.vertexLen[e.startId]=new Array),this.vertexLen[e.startId][e.endId]=Number.MAX_VALUE,void 0===this.vertexLen[e.endId]&&(this.vertexLen[e.endId]=new Array),this.vertexLen[e.endId][e.startId]=Number.MAX_VALUE;for(var n=0;n<this.roadVector.length;n++)this._roadDiffusion[n]=!1}},{key:"_resetRoadDiffusion",value:function(){for(var e=0;e<this._roadDiffusion.length;e++)this._roadDiffusion[e]=!1}},{key:"_nodeDistanceFunc",value:function(e,t){return(0,o.default)(e.distance)-(0,o.default)(t.distance)}},{key:"getLifts",value:function(){for(var e=[],t=0;t<this.nodeVector.length;t++){var n=this.nodeVector[t];n.liftType==f.default.NaviLiftType_Lift&&e.push(n)}return e}},{key:"getNodeByFlag",value:function(e){for(var t=0;t<this.nodeVector.length;t++)if(this.nodeVector[t].liftFlag==e)return this.nodeVector[t];return null}},{key:"getEscalators",value:function(){}},{key:"getStaris",value:function(){}},{key:"getAllLifts",value:function(){for(var e=[],t=0;t<this.nodeVector.length;t++){var n=this.nodeVector[t];n.liftType!=f.default.NaviLiftType_NULL&&e.push(n)}return e}},{key:"getGraphByEid",value:function(t){for(var n=null,r=0;r<this.obstructExtents.length;r++)if(t==this.obstructExtents[r].Id){n=this.obstructExtents[r];break}if(!n)return null;for(var i=[],o=0;o<this.nodeVector.length;o++){var a=this.nodeVector[o];c.default.pointInPolygon2d(n.points,a.point,n.points.length)&&i.push(a)}for(var s=[],u=0;u<this.roadVector.length;u++){var l=this.roadVector[u];c.default.pointInPolygon2d(n.points,l.startPoint,n.points.length)&&s.push(l)}var h=[];for(r=0;r<this.obstructModels.length;r++){var f=this.obstructModels[r];c.default.pointInPolygon2d(n.points,f.center,n.points.length)&&h.push(f)}var d=new e(i,s,!0,1);return d.obstructModels=h,d.obstructExtents=[n],d}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(16),n(26);var o=i(n(2)),a=i(n(3)),s=i(n(41)),u=i(n(49));n=function(){function e(t){(0,o.default)(this,e),this._naviGraph=t,this._startNode=null,this._endNode=null,this._startNodeID=-1,this._endNodeID=-1,this._mode=s.default.MODULE_SHORTEST,this._naviGraph.createNodeMap(),this._naviGraph.createRoadMap(),this._naviGraph.makeUpAdjList(),this._kEPSILON_VALUE=5e-4}return(0,a.default)(e,[{key:"routeMultiDestinations",value:function(e,t,n){if(this._switchToMode(n),this._destIds=t,-1==(e=this._naviGraph.getIndexByNodeID(e)))return u.default.ROUTE_FAILED_CANNOT_CALCULATE;this.endIdxs=[];for(var r=0;r<t.length;r++){var i=this._naviGraph.getIndexByNodeID(t[r]);this.endIdxs.push(i)}return e=this._dijkstraAssist_1vN(this._naviGraph,e,this.endIdxs),this._naviGraph.consoleNodePres(),!!e}},{key:"getMultiRoute",value:function(e){for(var t=0;t<this.endIdxs.length;t++){var n=[];this._getOneRoute(this.endIdxs[t],n),n.reverse(),e.push(n)}}},{key:"_getOneRoute",value:function(e,t){e=this._naviGraph.nodeVector[e],t.push(e),null!=(e=e._vPre[0])&&this._getOneRoute(e,t)}},{key:"routeCalculate",value:function(e,t,n){return this._switchToMode(n),this._startNode=e,this._endNode=t,this._startNodeID=e.Id,this._endNodeID=t.Id,-1==(n=this._naviGraph.getIndexByNodeID(this._startNodeID))||-1==(e=this._naviGraph.getIndexByNodeID(t.Id))?u.default.ROUTE_FAILED_CANNOT_CALCULATE:((t=[]).push(e),t=this._dijkstraAssist_1vN(this._naviGraph,n,t),this._naviGraph.consoleNodePres(),t?u.default.ROUTE_SUCCESS:u.default.ROUTE_FAILED_CANNOT_ARRIVE)}},{key:"getRouteCalculateResult",value:function(){var e=[],t=this._naviGraph.getIndexByNodeID(this._endNodeID),n=[];n.push(t);var r=[];return t=[],this._multiPathNodeVector(n,this._naviGraph.nodeVector,r,t),e.push.apply(e,r),e}},{key:"dispose",value:function(){this._naviGraph.dispose(),this._naviGraph=null,this._startNode=null,this._endNode=null}},{key:"_dijkstraAssist_1vN",value:function(e,t,n){if(null==e)return!1;var r=e.nodeVector.length;if(t<0||r<=t)return!1;this._removeArrayAll(n,t);for(var i=0;i<r;++i)e.nodeVector[i]._dist=Number.MAX_VALUE,e.nodeVector[i]._visited=!1,e.nodeVector[i]._vPre=[];e.nodeVector[t]._dist=0;var o=n.length,a=0,s=[];s.push(e.nodeVector[t]);for(var u=this._nodeDistCompareFunc.bind(this);0<s.length;){var l=s[0].Id;s.splice(0,1);var c=e.getIndexByNodeID(l);if(null!=c){var h=e.nodeVector[c];if(!h._visited){if(h._visited=!0,-1!=n.indexOf(c)&&++a==o)return!0;if(0!=e.adjList.size()){var f=e.adjList.get(l);if(f)for(var d=0;d<f.length;d++){var p=f[d],g=p.nodeId,m=e.getIndexByNodeID(g);null!=m&&(g=p.length,(p=e.nodeVector[m])._visited||(p._dist>g+h._dist?(p._dist=g+h._dist,p._vPre=[],p._vPre.push(c),s.push(e.nodeVector[m]),s.sort(u)):Math.abs(p._dist-(g+h._dist))<1e-12&&-1!=p._vPre.indexOf(c)&&p._vPre.push(c)))}}}}}return!(a<o)}},{key:"_nodeDistCompareFunc",value:function(e,t){return e._dist-(t._dist+this._kEPSILON_VALUE)}},{key:"_removeArrayAll",value:function(e,t){for(var n=e.indexOf(t);-1!=n;)e.splice(n,1),n=e.indexOf(t)}},{key:"_switchToMode",value:function(e){this._mode!=e&&(s.default.MODULE_SHORTEST==e?this._naviGraph.roadVector.forEach((function(e){e.length=e.length/e.roadRank})):s.default.MODULE_BEST==e&&this._naviGraph.roadVector.forEach((function(e){e.length=e.length*e.roadRank})),this._naviGraph.makeUpAdjList(),this._mode=e)}},{key:"_pathNodeVector",value:function(e,t,n,r){0!=t[e]._vPre.length&&(e=t[e]._vPre[0],n.push(t[e]),r.count++,this._pathNodeVector(e,t,n,r))}},{key:"_multiPathNodeVector",value:function(e,t,n,r){for(var i=0;i<e.length;i++){var o=e[i];n.push(t[o]);var a={count:1};this._pathNodeVector(o,t,n,a),r.push(a.count)}}}]),e}(),t.default=n},function(e,t,n){"use strict";n(0)(t,"__esModule",{value:!0}),t._Math=void 0,n(32),n(132);var r={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(i=e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&r|128]+e[r>>8&255]+"-"+e[r>>16&255]+e[r>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*r.DEG2RAD},radToDeg:function(e){return e*r.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};t._Math=r},function(e,t,n){e.exports=!n(14)&&!n(20)((function(){return 7!=Object.defineProperty(n(99)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(19),i=n(9).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(28),i=n(35),o=n(158)(!1),a=n(72)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=a&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var r=n(70);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(71),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},function(e,t,n){e.exports=n(160)},function(e,t,n){var r=n(70);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(164)},function(e,t,n){e.exports=n(34)},function(e,t,n){var r=n(18),i=n(27),o=n(52);e.exports=n(14)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,u=0;u<s;)r.f(e,n=a[u++],t[n]);return e}},function(e,t,n){var r=n(100),i=n(74).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(56),i=n(43),o=n(35),a=n(69),s=n(28),u=n(98),l=Object.getOwnPropertyDescriptor;t.f=n(14)?l:function(e,t){if(e=o(e),t=a(t,!0),u)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){e.exports=n(173)},function(e,t,n){"use strict";var r=n(174)(!0);n(113)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e=this._t,t=this._i;return t>=e.length?{value:void 0,done:!0}:(t=r(e,t),this._i+=t.length,{value:t,done:!1})}))},function(e,t,n){"use strict";var r=n(54),i=n(6),o=n(107),a=n(34),s=n(45),u=n(175),l=n(76),c=n(114),h=n(11)("iterator"),f=!([].keys&&"next"in[].keys()),d="keys",p="values",g=function(){return this};e.exports=function(e,t,n,m,v,y,_){u(n,t,m);var x,A,I=function(e){if(!f&&e in M)return M[e];switch(e){case d:case p:return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",b=v==p,C=!1,M=e.prototype,E=M[h]||M["@@iterator"]||v&&M[v],T=E||I(v),S=v?b?I("entries"):T:void 0;if((m="Array"==t&&M.entries||E)&&(e=c(m.call(new e)))!==Object.prototype&&e.next&&(l(e,w,!0),r||"function"==typeof e[h]||a(e,h,g)),b&&E&&E.name!==p&&(C=!0,T=function(){return E.call(this)}),r&&!_||!f&&!C&&M[h]||a(M,h,T),s[t]=T,s[w]=g,v)if(x={values:b?T:I(p),keys:y?T:I(d),entries:S},_)for(A in x)A in M||o(M,A,x[A]);else i(i.P+i.F*(f||C),t,x);return x}},function(e,t,n){var r=n(28),i=n(44),o=n(72)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){e.exports=n(180)},function(e,t,n){var r=n(36);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){e.exports=!n(10)&&!n(7)((function(){return 7!=Object.defineProperty(n(118)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(21),i=n(8).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(30),i=n(60),o=n(120)(!1),a=n(82)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=a&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var r=n(60),i=n(17),o=n(46);e.exports=function(e){return function(t,n,a){var s,u=r(t),l=i(u.length),c=o(a,l);if(e&&n!=n){for(;c<l;)if((s=u[c++])!=s)return!0}else for(;c<l;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(119),i=n(84);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){n=n(8).document,e.exports=n&&n.documentElement},function(e,t,n){for(var r,i=n(8),o=n(13),a=(n=n(47))("typed_array"),s=n("view"),u=n=!(!i.ArrayBuffer||!i.DataView),l=0,c="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(r=i[c[l++]])?(o(r.prototype,a,!0),o(r.prototype,s,!0)):u=!1;e.exports={ABV:n,CONSTR:u,TYPED:a,VIEW:s}},function(e,t,n){var r=n(25);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(38),i=n(17);e.exports=function(e){if(void 0===e)return 0;var t=r(e);if(t!==(e=i(t)))throw RangeError("Wrong length!");return e}},function(e,t,n){"use strict";var r=n(39),i=n(46),o=n(17);e.exports=function(e){for(var t,n=r(this),a=o(n.length),s=i(1<(t=arguments.length)?arguments[1]:void 0,a),u=void 0===(t=2<t?arguments[2]:void 0)?a:i(t,a);s<u;)n[s++]=e;return n}},function(e,t,n){var r=n(30),i=n(39),o=n(82)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var r=n(58),i=n(116),o=n(39),a=n(17),s=n(205);e.exports=function(e,t){var n=1==e,u=2==e,l=3==e,c=4==e,h=6==e,f=5==e||h,d=t||s;return function(t,s,p){for(var g,m,v=o(t),y=i(v),_=r(s,p,3),x=a(y.length),A=0,I=n?d(t,x):u?d(t,0):void 0;A<x;A++)if((f||A in y)&&(m=_(g=y[A],A,v),e))if(n)I[A]=m;else if(m)switch(e){case 3:return!0;case 5:return g;case 6:return A;case 2:I.push(g)}else if(c)return!1;return h?-1:l||c?c:I}}},function(e,t,n){var r=n(22),i=n(79),o=n(5)("species");e.exports=function(e,t){var n;return void 0===(e=r(e).constructor)||null==(n=r(e)[o])?t:i(n)}},function(e,t,n){var r=n(5)("unscopables"),i=Array.prototype;null==i[r]&&n(13)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){"use strict";n(217);var r=n(22),i=n(89),o=n(10),a="toString",s=/./[a],u=function(e){n(25)(RegExp.prototype,a,e,!0)};n(7)((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?u((function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)})):s.name!=a&&u((function(){return s.call(this)}))},function(e,t,n){var r=n(6),i=n(53),o=n(20),a=n(90),s=(n="["+a+"]",RegExp("^"+n+n+"*")),u=RegExp(n+n+"*$"),l=(n=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()}));t=i[e]=s?t(l):a[e],n&&(i[n]=t),r(r.P+r.F*s,"String",i)},n.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(u,"")),e});e.exports=n},function(e,t,n){e.exports=n(232)},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e),this.x=void 0,this.y=void 0,this.z=void 0,this.gid=void 0}return(0,a.default)(e,[{key:"setGeoPoint",value:function(e){this.x=e.x,this.y=e.y}}]),e}(),t.default=n},function(e,t,n){e.exports=n(237)},function(e,t,n){var r=n(241),i=n(244);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=r(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(245)},function(e,t,n){var r=n(248).default,i=n(249);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(138),i=n(250);function o(t){return e.exports=o=r?i:function(e){return e.__proto__||i(e)},e.exports.default=e.exports,e.exports.__esModule=!0,o(t)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3)),s=i(n(12)),u=i(n(142));n=function(){function e(t,n,r,i){(0,o.default)(this,e),this.Id=t,this.groupId=n,this._type=r,this.points=i,this.pointCount=i&&i.length?i.length:0,this._level=-1,this.inId=0,this._parent=null,this._child=null,this._brothers=[],this._linkAccessNodes=[],this._area=null,this.bb=new u.default,this.refreshBB()}return(0,a.default)(e,[{key:"pass",get:function(){return 3&this._type},set:function(e){this._type|=e}},{key:"level",get:function(){return 31&this._level},set:function(e){this._level=31&e}},{key:"area",get:function(){return this._area||(this._area=s.default.calcPolygonArea2d()),this._area}},{key:"contain",value:function(e){return s.default.pointInPolygon2d1(this.points,e,this.points.length-1)}},{key:"calcCrossPoint",value:function(e,t){for(var n={},r=0;r<this.pointCount;r++){var i=this.points[r],o=this.points[(r+1)%this.pointCount];if(1==s.default.calcCrossPoint(i,o,e,t,n))break}return n}},{key:"refreshBB",value:function(){this.bb.init();for(var e=0;e<this.pointCount;e++)this.bb.expandBy({x:this.points[e].x,y:this.points[e].y})}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(16);var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e),this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE}return(0,a.default)(e,[{key:"init",value:function(){this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE}},{key:"expandBy",value:function(e){e&&e.x&&e.y&&(this.minX>e.x&&(this.minX=e.x),this.maxX<e.x&&(this.maxX=e.x),this.minY>e.y&&(this.minY=e.y),this.maxY<e.y&&(this.maxY=e.y))}},{key:"isSeparate",value:function(e){return this.minX>e.maxX||this.minY>e.maxY||this.maxX<e.minX||this.maxY<e.minY}}]),e}(),t.default=n},function(e,t,n){n(86)("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(33));n=function e(){(0,o.default)(this,e),this.cross=null,this.road=null,this.model=null,this.distance=0,this.toDistance=0,this.stickToRoad=!1,this.obstructType=a.default.NaviObstructType_MODEL},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(48));n(92);var a=i(n(2)),s=i(n(3));n=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,null,[{key:"toColor",value:function(e){if("number"==typeof e)return e;var t=e.split(",");return 3<=t.length?(0,o.default)(t[0])<<16|(0,o.default)(t[1])<<8|(0,o.default)(t[2]):(console.error("color format error",e),0)}},{key:"toRgba",value:function(e){if("number"==typeof e)return"rgba("+(0,o.default)(255*new fm.Color(e).r)+","+(0,o.default)(255*new fm.Color(e).g)+","+(0,o.default)(255*new fm.Color(e).b)+",1)";var t=e.split(",");return 3<=t.length?"rgba("+(0,o.default)(t[0])+","+(0,o.default)(t[1])+","+(0,o.default)(t[2])+",1)":e}},{key:"bindEvent",value:function(e,t,n,r){e.addEventListener(n,(function(e){var n,i=e||window.event,o=i.target||i.srcElement,a=i.currentTarget;for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;0<=--n&&t.item(n)!==this;);return-1<n});o!==a;)o.matches(t)&&(n=o,r.call(n,i)),o=o.parentNode}))}},{key:"toSceneCoord",value:function(e,t){var n=0;return t.groupID&&(n=e.getFMGroup(t.groupID).height),new fm.Vector3(t.x-e.center.x,e.center.y+n,-t.y+e.center.y)}},{key:"removeFormArray",value:function(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)}},{key:"scrollTopAnFun",value:function(){var e,t=!1;return function n(r){var i=r.el,o=r.to,a=r.form,s=(r.time,o<a?"up":"bottom"),u=(a<o?o-a:o==a?0:a-o)/10,l=0,c=function(){t=!1,e=!1,0==a&&(i.scrollTop=0)};t?(e=0,window.setTimeout((function(){var e=Object(r,{to:i.scrollTop});t=!1,n(e)}),11)):(t=!0,e=u,function t(){var n;--e<=0?c():(n=function(){!1!==e&&(l=function(e){var t=e.val,n=e.nbak,r=e.n;return e=e.elTop,"up"==s?e+(n-r)*t:e-(n-r)*t}({val:10,nbak:u,n:e,elTop:o,VDIRECTIONE:s}),l&&(i.scrollTop=l),t())},window.setTimeout(n,10))}())}}},{key:"toVector",value:function(e){return e.hasOwnProperty("z")?new fm.Vector3(e.x,e.y,e.z):new fm.Vector2(e.x,e.y)}},{key:"sleep",value:function(e){for(var t=(new Date).getTime(),n=0;n<1e7&&!((new Date).getTime()-t>e);n++);}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3)),s=i(n(260)),u=function(){function e(t){(0,o.default)(this,e),this._wayPoints=t||[]}return(0,a.default)(e,[{key:"drop",value:function(e){for(var t=-1,n=0;n<this._wayPoints.length;n++)if(this[n]==e){t=n;break}t<0||this._wayPoints.splice(t,1)}},{key:"cloneDrop",value:function(e){for(var t=[],n=0;n<this._wayPoints.length;n++)t.push(this._wayPoints[n]);for(var r=-1,i=0;i<t.length;i++)if(t[i]==e){r=i;break}if(!(r<0))return t.splice(r,1),t}},{key:"toArray",value:function(){for(var e=[],t=0;t<this._wayPoints.length;t++)e.push(this._wayPoints[t]);return e}},{key:"len",value:function(){return this._wayPoints.length}}]),e}();n=function(){function e(t){(0,o.default)(this,e),0!=t.length&&(this._adjTable=new s.default(t))}return(0,a.default)(e,[{key:"setSId",value:function(e){return this._sId=e,this}},{key:"setEId",value:function(e){return this._eId=e,this}},{key:"setWayNodes",value:function(e){return this._wayPoints=e,this}},{key:"route",value:function(){this._result=this._route(this._sId,this._eId,this._wayPoints)}},{key:"getResult",value:function(){return this._result}},{key:"_route",value:function(e,t,n){if(0==n.length){if(e==t)return{route:[e],dist:0};var r=this._adjTable.lookup(e,t);if(null!=r)return{route:[e,t],dist:r};var i=this._adjTable.enhance(e,t,this._wayPoints);return{route:[e,i.transit,t],dist:i.dist}}for(var o=new u(n),a=o.toArray(),s=1/0,l=[],c=0;c<o.len();c++){var h,f=a[c],d=this._route(e,f,o.cloneDrop(f));null!=d.dist&&(null==(h=this._adjTable.lookup(f,t))?(h=(i=this._adjTable.enhance(f,t,this._wayPoints)).dist)+d.dist<s&&(s=h+d.dist,d.route.push(i.transit),d.route.push(t),l=d.route):h+d.dist<s&&(s=h+d.dist,d.route.push(t),l=d.route))}return{route:l,dist:s}}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.SmallQueue=function(){var e=[],t=0;this.getLength=function(){return e.length-t},this.isEmpty=function(){return 0==e.length},this.enqueue=function(t){e.push(t)},this.dequeue=function(){if(0!=e.length){var n=e[t];return 2*++t>=e.length&&(e=e.slice(t),t=0),n}},this.peek=function(){return 0<e.length?e[t]:void 0}},t.Queue=void 0,n(262);var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e),this.items=[]}return(0,a.default)(e,[{key:"enqueue",value:function(e){this.items.push(e)}},{key:"dequeue",value:function(){return this.isEmpty()?"Underflow":this.items.shift()}},{key:"front",value:function(){return this.isEmpty()?"No elements in Queue":this.items[0]}},{key:"isEmpty",value:function(){return 0==this.items.length}},{key:"printQueue",value:function(){for(var e="",t=0;t<this.items.length;t++)e+=this.items[t]+" ";return e}}]),e}(),t.Queue=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.Vector3=c,n(88),i=i(n(15));var o,a,s,u,l=n(97);function c(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}n=n(149),(0,i.default)(c.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(u=new n.Quaternion,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(u.setFromEuler(e))}),applyAxisAngle:(s=new n.Quaternion,function(e,t){return this.applyQuaternion(s.setFromAxisAngle(e,t))}),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z;return e=e.elements,this.x=e[0]*t+e[3]*n+e[6]*r,this.y=e[1]*t+e[4]*n+e[7]*r,this.z=e[2]*t+e[5]*n+e[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return e=1/(i[3]*t+i[7]*n+i[11]*r+i[15]),this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*e,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*e,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*e,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,u=s*t+o*r-a*n,l=s*n+a*t-i*r;return e=s*r+i*n-o*t,r=-i*t-o*n-a*r,this.x=u*s+r*-i+l*-a-e*-o,this.y=l*s+r*-o+e*-i-u*-a,this.z=e*s+r*-a+u*-o-l*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,r=this.z;return e=e.elements,this.x=e[0]*t+e[4]*n+e[8]*r,this.y=e[1]*t+e[5]*n+e[9]*r,this.z=e[2]*t+e[6]*n+e[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x;return e=t.y,t=t.z,this.x=r*t-i*e,this.y=i*o-n*t,this.z=n*e-r*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(a=new c,function(e){return a.copy(this).projectOnVector(e),this.sub(a)}),reflect:(o=new c,function(e){return this.sub(o.copy(e).multiplyScalar(2*this.dot(e)))}),angleTo:function(e){return e=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq()),Math.acos(l._Math.clamp(e,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n+(e=this.z-e.z)*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length();return e=this.setFromMatrixColumn(e,2).length(),this.x=t,this.y=n,this.z=e,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}})},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.Quaternion=s,t=i(n(15));var o=i(n(265)),a=(i=i(n(268)),n(97));function s(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}(0,t.default)(s,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,a,s){var u=n[r+0],l=n[r+1],c=n[r+2],h=n[r+3],f=i[a+0],d=i[a+1],p=i[a+2],g=i[a+3];h===g&&u===f&&l===d&&c===p||(n=1-s,i=0<=(r=u*f+l*d+c*p+h*g)?1:-1,(a=1-r*r)>o.default&&(a=Math.sqrt(a),r=Math.atan2(a,r*i),n=Math.sin(n*r)/a,s=Math.sin(s*r)/a),u=u*n+f*(i*=s),l=l*n+d*i,c=c*n+p*i,h=h*n+g*i,n===1-s&&(u*=s=1/Math.sqrt(u*u+l*l+c*c+h*h),l*=s,c*=s,h*=s)),e[t]=u,e[t+1]=l,e[t+2]=c,e[t+3]=h}}),(0,i.default)(s.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),(0,t.default)(s.prototype,{isQuaternion:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,u=a(n/2);return e=a(r/2),a=a(i/2),n=s(n/2),r=s(r/2),i=s(i/2),"XYZ"===o?(this._x=n*e*a+u*r*i,this._y=u*r*a-n*e*i,this._z=u*e*i+n*r*a,this._w=u*e*a-n*r*i):"YXZ"===o?(this._x=n*e*a+u*r*i,this._y=u*r*a-n*e*i,this._z=u*e*i-n*r*a,this._w=u*e*a+n*r*i):"ZXY"===o?(this._x=n*e*a-u*r*i,this._y=u*r*a+n*e*i,this._z=u*e*i+n*r*a,this._w=u*e*a-n*r*i):"ZYX"===o?(this._x=n*e*a-u*r*i,this._y=u*r*a+n*e*i,this._z=u*e*i-n*r*a,this._w=u*e*a+n*r*i):"YZX"===o?(this._x=n*e*a+u*r*i,this._y=u*r*a+n*e*i,this._z=u*e*i-n*r*a,this._w=u*e*a-n*r*i):"XZY"===o&&(this._x=n*e*a-u*r*i,this._y=u*r*a-n*e*i,this._z=u*e*i+n*r*a,this._w=u*e*a+n*r*i),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2;return t=Math.sin(n),this._x=e.x*t,this._y=e.y*t,this._z=e.z*t,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n,r=(n=e.elements)[0],i=n[4],o=n[8],a=n[1],s=n[5],u=n[9],l=n[2],c=n[6];return 0<(n=r+s+(e=n[10]))?(t=.5/Math.sqrt(n+1),this._w=.25/t,this._x=(c-u)*t,this._y=(o-l)*t,this._z=(a-i)*t):s<r&&e<r?(t=2*Math.sqrt(1+r-s-e),this._w=(c-u)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+l)/t):e<s?(t=2*Math.sqrt(1+s-r-e),this._w=(o-l)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(u+c)/t):(t=2*Math.sqrt(1+e-r-s),this._w=(a-i)/t,this._x=(o+l)/t,this._y=(u+c)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=n,this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(a._Math.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);return 0===n||(n=Math.min(1,t/n),this.slerp(e,n)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y;return e=t._z,t=t._w,this._x=n*t+o*a+r*e-i*s,this._y=r*t+o*s+i*a-n*e,this._z=i*t+o*e+n*s-r*a,this._w=o*t-n*a-r*s-i*e,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,s=a*e._w+n*e._x+r*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),1<=s)return this._w=a,this._x=n,this._y=r,this._z=i,this;if((e=1-s*s)<=o.default){var u=1-t;return this._w=u*a+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*i+t*this._z,this.normalize(),this._onChangeCallback(),this}return u=Math.sqrt(e),e=Math.atan2(u,s),s=Math.sin((1-t)*e)/u,u=Math.sin(t*e)/u,this._w=a*s+this._w*u,this._x=n*s+this._x*u,this._y=r*s+this._y*u,this._z=i*s+this._z*u,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}})},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o,a=i(n(153)),s=i(n(154)),u=i(n(41)),l=i(n(65)),c=n(148),h=n(97),f=n(271),d=(r=n(149),n=i(n(272)),window.fengmap||{}),p={VERSION:a.default.VERSION,BUILD:a.default.BUILD,FMNaviAnalyser:s.default,FMNaviMode:u.default,FMNaviPriority:l.default};for(o in p)p.hasOwnProperty(o)&&(d[o]=p[o]);window.fengmap=d,window.DEBUG=!1,window.Geo=window.Geo||{Vector3:c.Vector3,_Math:h._Math,Matrix4:f.Matrix4,Quaternion:r.Quaternion,Centroid:n.default},window.Calculator=window.Geo,n=d,t.default=n},function(e,t,n){n(152);var r=n(4).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(6);r(r.S+r.F*!n(14),"Object",{defineProperty:n(18).f})},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={VERSION:"2.7.3",BUILD:7},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(15)),a=i(n(103)),s=i(n(29)),u=i(n(2)),l=i(n(3)),c=i(n(12)),h=n(198),f=i(n(199)),d=i(n(41)),p=i(n(65)),g=i(n(91)),m=i(n(49)),v=i(n(221));n(145),n=function(){function e(t){(0,u.default)(this,e),this._options={},this._navi=null,this._naviResults=[],"function"==typeof h.FMMap&&t instanceof h.FMMap&&(this._map=null,this.init(t)),this._endDoor=null}return(0,l.default)(e,[{key:"navi",get:function(){this._navi}},{key:"passPts",set:function(e){this._navi.passPts=e}},{key:"routePassingPoints",value:function(e,t){(t=this._navi.routePassingPoints(e,t))==m.default.ROUTE_SUCCESS?(this._naviResults=this._navi.getRouteResult(),this.failedInsertedPts=this._navi.failedInsertedPts):this._naviResults=[]}},{key:"naviToDoor",get:function(){return this._navi.naviToDoor},set:function(e){this._navi.naviToDoor=e}},{key:"analyzeNavi",value:function(e,t,n,r,i,o){return(o=this._navi.route(e,t,n,r,i||d.default.MODULE_SHORTEST,o||p.default.PRIORITY_DEFAULT))==m.default.ROUTE_SUCCESS?(this._naviResults=this._navi.getRouteResult(),this._endDoor=this._navi._endDoor):this._naviResults=[],o}},{key:"init",value:function(e){this._map=e,this._navi=new v.default({}),this._navi.initByMap(e)}},{key:"initByOptions",value:function(e){this._navi=new v.default({}),this._navi.initByOptions(e)}},{key:"initByScene",value:function(e){this._navi=new v.default({}),this._navi.initByScene(e)}},{key:"dispose",value:function(){this._map=null;for(var e=0;e<this._naviResults.length;e++){var t=this._naviResults[e];t.dispose(),t=null}this._naviResults=[],this._navi&&(this._navi.dispose(),this._navi=null)}},{key:"getNaviResults",value:function(){return this._naviResults}},{key:"getNaviResult",value:function(e){return this.getNaviResults()}},{key:"getRouteAllPoints",value:function(e){var t=e||this._naviResults;if(!this._isNaviResultsValide(t))return[];var n,r=[];for(n in t)t[n].getPointList&&r.push.apply(r,(0,s.default)(t[n].getPointList()));return r}},{key:"getRouteLineSegments",value:function(e){var t=e||this._naviResults;if(!this._isNaviResultsValide(t))return[];for(var n=[],r=0;r<t.length;r++){var i=t[r],a=i.groupId,s=i.pointList,u=new f.default;u.groupId=a,u.points=[];for(var l=0;l<s.length;l++)u.points.push((0,o.default)({},s[l]));n.push(u)}return n}},{key:"getRouteDistance",value:function(e){if(e=e||this._naviResults,!this._isNaviResultsValide(e))return 0;var t=this.getRouteAllPoints(e);if(0==t.length)return 0;for(var n=0,r=0;r<t.length-1;r++)n+=c.default.distanceOfTwoPoints(t[r],t[r+1]);return n}},{key:"getRouteGroupIds",value:function(e){var t=e||this._naviResults;if(!this._isNaviResultsValide(t))return[];var n,r=[];for(n in t)!t[n].groupId||0!=n&&r[r.length-1]==t[n].groupId||r.push(t[n].groupId);return r}},{key:"getRouteGroupPoints",value:function(e,t){var n=t||this._naviResults;if(!this._isNaviResultsValide(n))return[];var r,i=[];for(r in n)n[r].groupId&&n[r].groupId==e&&(i=i.concat(n[r].getPointList()));return i}},{key:"pathConstraint",value:function(e,t){return this._navi?this._navi.pathConstraint(e,t):null}},{key:"losedPoints",get:function(){return this._navi.failedInsertedPts}},{key:"_getNaviResults",value:function(e){for(var t,n=[],r=0;r<e.length;r++)null!=e[r].groupId&&(t=new g.default(e[r].groupId,e[r].length,e[r].pointVector,e[r].nodeVector),n.push(t));return n}},{key:"_isNaviResultsValide",value:function(e){if(!(0,a.default)(e))return!1;if(0==e.length)return!1;for(var t=0;t<e.length;t++)if(!e[t]instanceof g.default)return!1;return!0}}]),e}(),t.default=n},function(e,t,n){n(156),e.exports=n(4).Object.assign},function(e,t,n){var r=n(6);r(r.S+r.F,"Object",{assign:n(157)})},function(e,t,n){"use strict";var r=n(14),i=n(52),o=n(75),a=n(56),s=n(44),u=n(101),l=Object.assign;e.exports=!l||n(20)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var n=s(e),l=arguments.length,c=1,h=o.f,f=a.f;c<l;)for(var d,p=u(arguments[c++]),g=h?i(p).concat(h(p)):i(p),m=g.length,v=0;v<m;)d=g[v++],r&&!f.call(p,d)||(n[d]=p[d]);return n}:l},function(e,t,n){var r=n(35),i=n(102),o=n(159);e.exports=function(e){return function(t,n,a){var s,u=r(t),l=i(u.length),c=o(a,l);if(e&&n!=n){for(;c<l;)if((s=u[c++])!=s)return!0}else for(;c<l;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(71),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){n(161),e.exports=n(4).Array.isArray},function(e,t,n){var r=n(6);r(r.S,"Array",{isArray:n(104)})},function(e,t,n){var r=n(103),i=n(105);e.exports=function(e){if(r(e))return i(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(106),i=n(111),o=n(115);e.exports=function(e){if(void 0!==r&&null!=e[i]||null!=e["@@iterator"])return o(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){n(165),n(170),n(171),n(172),e.exports=n(4).Symbol},function(e,t,n){"use strict";var r=n(9),i=n(28),o=n(14),a=n(6),s=n(107),l=n(166).KEY,c=n(20),h=n(73),f=n(76),d=n(55),p=n(11),g=n(77),m=n(78),v=n(167),y=n(104),_=n(27),x=n(19),A=n(44),I=n(35),w=n(69),b=n(43),C=n(57),M=n(169),E=n(110),T=n(75),S=n(18),L=n(52),k=E.f,R=S.f,N=M.f,P=r.Symbol,O=r.JSON,D=O&&O.stringify,F="prototype",B=p("_hidden"),G=p("toPrimitive"),z={}.propertyIsEnumerable,U=h("symbol-registry"),V=h("symbols"),H=h("op-symbols"),j=Object[F],W="function"==typeof P&&!!T.f,Y=!(ee=r.QObject)||!ee[F]||!ee[F].findChild,q=o&&c((function(){return 7!=C(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=k(j,t);r&&delete j[t],R(e,t,n),r&&e!==j&&R(j,t,r)}:R,X=function(e){var t=V[e]=C(P[F]);return t._k=e,t},Z=W&&"symbol"==u(P.iterator)?function(e){return"symbol"==u(e)}:function(e){return e instanceof P},J=function e(t,n,r){return t===j&&e(H,n,r),_(t),n=w(n,!0),_(r),i(V,n)?(r.enumerable?(i(t,B)&&t[B][n]&&(t[B][n]=!1),r=C(r,{enumerable:b(0,!1)})):(i(t,B)||R(t,B,b(1,{})),t[B][n]=!0),q(t,n,r)):R(t,n,r)},K=function(e,t){_(e);for(var n,r=v(t=I(t)),i=0,o=r.length;i<o;)J(e,n=r[i++],t[n]);return e},Q=function(e){var t=z.call(this,e=w(e,!0));return!(this===j&&i(V,e)&&!i(H,e))&&(!(t||!i(this,e)||!i(V,e)||i(this,B)&&this[B][e])||t)},$=function(e,t){if(e=I(e),t=w(t,!0),e!==j||!i(V,t)||i(H,t)){var n=k(e,t);return!n||!i(V,t)||i(e,B)&&e[B][t]||(n.enumerable=!0),n}},ee=(h=function(e){for(var t,n=N(I(e)),r=[],o=0;n.length>o;)i(V,t=n[o++])||t==B||t==l||r.push(t);return r},function(e){for(var t,n=e===j,r=N(n?H:I(e)),o=[],a=0;r.length>a;)!i(V,t=r[a++])||n&&!i(j,t)||o.push(V[t]);return o});W||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=d(0<arguments.length?arguments[0]:void 0);return o&&Y&&q(j,e,{configurable:!0,set:function t(n){this===j&&t.call(H,n),i(this,B)&&i(this[B],e)&&(this[B][e]=!1),q(this,e,b(1,n))}}),X(e)},s(P[F],"toString",(function(){return this._k})),E.f=$,S.f=J,n(109).f=M.f=h,n(56).f=Q,T.f=ee,o&&!n(54)&&s(j,"propertyIsEnumerable",Q,!0),g.f=function(e){return X(p(e))}),a(a.G+a.W+a.F*!W,{Symbol:P});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)p(te[ne++]);for(var re=L(p.store),ie=0;re.length>ie;)m(re[ie++]);a(a.S+a.F*!W,"Symbol",{for:function(e){return i(U,e+="")?U[e]:U[e]=P(e)},keyFor:function(e){if(!Z(e))throw TypeError(e+" is not a symbol!");for(var t in U)if(U[t]===e)return t},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),a(a.S+a.F*!W,"Object",{create:function(e,t){return void 0===t?C(e):K(C(e),t)},defineProperty:J,defineProperties:K,getOwnPropertyDescriptor:$,getOwnPropertyNames:h,getOwnPropertySymbols:ee}),ee=c((function(){T.f(1)})),a(a.S+a.F*ee,"Object",{getOwnPropertySymbols:function(e){return T.f(A(e))}}),O&&a(a.S+a.F*(!W||c((function(){var e=P();return"[null]"!=D([e])||"{}"!=D({a:e})||"{}"!=D(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;i<arguments.length;)r.push(arguments[i++]);if(n=t=r[1],(x(t)||void 0!==e)&&!Z(e))return y(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Z(t))return t}),r[1]=t,D.apply(O,r)}}),P[F][G]||n(34)(P[F],G,P[F].valueOf),f(P,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(e,t,n){var r=n(55)("meta"),i=n(19),o=n(28),a=n(18).f,s=0,l=Object.isExtensible||function(){return!0},c=!n(20)((function(){return l(Object.preventExtensions({}))})),h=function(e){a(e,r,{value:{i:"O"+ ++s,w:{}}})},f=(n=function(e){return c&&f.NEED&&l(e)&&!o(e,r)&&h(e),e},e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==u(e)?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!l(e))return"F";if(!t)return"E";h(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!l(e))return!0;if(!t)return!1;h(e)}return e[r].w},onFreeze:n})},function(e,t,n){var r=n(52),i=n(75),o=n(56);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,s=n(e),u=o.f,l=0;s.length>l;)u.call(e,a=s[l++])&&t.push(a);return t}},function(e,t,n){n=n(9).document,e.exports=n&&n.documentElement},function(e,t,n){var r=n(35),i=n(109).f,o={}.toString,a="object"==("undefined"==typeof window?"undefined":u(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t){},function(e,t,n){n(78)("asyncIterator")},function(e,t,n){n(78)("observable")},function(e,t,n){n(112),n(176),e.exports=n(77).f("iterator")},function(e,t,n){var r=n(71),i=n(53);e.exports=function(e){return function(t,n){var o,a=String(i(t)),s=r(n);return t=a.length,s<0||t<=s?e?"":void 0:(n=a.charCodeAt(s))<55296||56319<n||s+1===t||(o=a.charCodeAt(s+1))<56320||57343<o?e?a.charAt(s):n:e?a.slice(s,s+2):o-56320+(n-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(57),i=n(43),o=n(76),a={};n(34)(a,n(11)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){n(177);for(var r=n(9),i=n(34),o=n(45),a=n(11)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var l,c=s[u];(l=(l=r[c])&&l.prototype)&&!l[a]&&i(l,a,c),o[c]=o.Array}},function(e,t,n){"use strict";var r=n(178),i=n(179),o=n(45),a=n(35);e.exports=n(113)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){n(112),n(181),e.exports=n(4).Array.from},function(e,t,n){"use strict";var r=n(67),i=n(6),o=n(44),a=n(182),s=n(183),u=n(102),l=n(184),c=n(185);i(i.S+i.F*!n(187)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,h,f=o(e),d="function"==typeof this?this:Array,p=arguments.length,g=1<p?arguments[1]:void 0,m=void 0!==g,v=0;if(e=c(f),m&&(g=r(g,2<p?arguments[2]:void 0,2)),null==e||d==Array&&s(e))for(n=new d(t=u(f.length));v<t;v++)l(n,v,m?g(f[v],v):f[v]);else for(h=e.call(f),n=new d;!(i=h.next()).done;v++)l(n,v,m?a(h,g,[i.value,v],!0):i.value);return n.length=v,n}})},function(e,t,n){var r=n(27);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){throw void 0!==(n=e.return)&&r(n.call(e)),t}}},function(e,t,n){var r=n(45),i=n(11)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){"use strict";var r=n(18),i=n(43);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(186),i=n(11)("iterator"),o=n(45);e.exports=n(4).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){var r=n(70),i=n(11)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?e:o?r(t):"Object"==(e=r(t))&&"function"==typeof t.callee?"Arguments":e}},function(e,t,n){var r=n(11)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){var r=n(115),i=n(105);e.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(21),i=n(191).set;e.exports=function(e,t,n){var o;return(t=t.constructor)!==n&&"function"==typeof t&&(o=t.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){var r=n(21),i=n(22),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(58)(Function.call,n(80).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(24),i=n(37),o=n(7),a=n(195),s=(n="["+a+"]",RegExp("^"+n+n+"*")),u=RegExp(n+n+"*$"),l=(n=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()}));t=i[e]=s?t(l):a[e],n&&(i[n]=t),r(r.P+r.F*s,"String",i)},n.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(u,"")),e});e.exports=n},function(e,t,n){e.exports=n(83)("native-function-to-string",Function.toString)},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(23),i=n(22),o=n(121);e.exports=n(10)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,u=0;u<s;)r.f(e,n=a[u++],t[n]);return e}},function(e,t,n){"use strict";var r=n(7);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){"use strict";var r=n(0);r(t,"__esModule",{value:!0}),t.BoundingBox=t.FMMapCoord=t.NaviService=t.NaviDataType=t.FMLanguageType=t.FMLocationMarker=t.FMLineMarker=t.FMImageMarker=t.FMUtil=t.DataManager=t.EventDispatcher=t.FMRouteCalcuResult=t.FMNaviPriority=t.FMNaviMode=t.FMSegment=t.FMMap=t.Map=t.Graphics=void 0;var i={};n={},window.fengmap&&(n=window.fengmap,i=window.fengmap.inner||{}),r=i.Graphics||{},t.Graphics=r,r=n.FMMap||{},t.FMMap=r,n=n.Map||{},t.Map=n,n=i.FMSegment||{},t.FMSegment=n,n=i.FMNaviMode||{},t.FMNaviMode=n,n=i.FMNaviPriority||{},t.FMNaviPriority=n,n=i.FMRouteCalcuResult||{},t.FMRouteCalcuResult=n,n=i.EventDispatcher||{},t.EventDispatcher=n,n=i.DataManager||{},t.DataManager=n,n=i.FMUtil||{},t.FMUtil=n,n=i.FMImageMarker||{},t.FMImageMarker=n,n=i.FMLineMarker||{},t.FMLineMarker=n,n=i.FMLocationMarker||{},t.FMLocationMarker=n,n=i.FMLanguageType||{},t.FMLanguageType=n,n=i.NaviDataType||{},t.NaviDataType=n,n=i.NaviService||{},t.NaviService=n,n=i.FMMapCoord||{},t.FMMapCoord=n,i=i.BoundingBox||{},t.BoundingBox=i},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(29)),a=i(n(2)),s=i(n(3)),u=i(n(200)),l=i(n(12));n=function(){function e(t){(0,a.default)(this,e),this._points=t||null,this._groupId=0,this._lineDis=[],this._linePoints=null,this._screenPoints=[],this._screenDis=[],this._radiusPoint=[],this._radiuInit=!1,this._uvys=null,this._minRadius=1,this.needSmooth=!0}return(0,s.default)(e,[{key:"initSegement",value:function(e,t){"number"!=typeof t&&(t=this._minRadius),this._linePoints=this.pointsToLinePnts(e,t),this._uvys=this.computerUVY()}},{key:"pointsToRadius",value:function(e){for(var t,n,r=[],i=new u.default,a=0;a<this._points.length;a++)0<a&&a<this._points.length-1?(n=l.default.distanceOfTwoPoints(r[r.length-1],this._points[a]),(t=.5*((t=l.default.distanceOfTwoPoints(this._points[a],this._points[a+1]))<n?t:n))<(n=e)&&(n=t),r.push.apply(r,(0,o.default)(i.computerArcLineByPoints(r[r.length-1],this._points[a],this._points[a+1],n||1,12)))):r.push(this._points[a]);this._radiusPoint=r,this._radiuInit=!0}},{key:"pointsToLinePnts",value:function(e,t){this.needSmooth?this._radiuInit||this.pointsToRadius(t):((t=[]).push.apply(t,(0,o.default)(this._points)),this._radiusPoint=t);for(var n=[],r=0;r<this._radiusPoint.length;r++){var i=this._radiusPoint[r].x-e.x,a=this._radiusPoint[r].z,s=-this._radiusPoint[r].y+e.y;n.push(i,a,s),0!==r&&(a=new fm.Vector3(this._radiusPoint[r].x,this._radiusPoint[r].y,this._radiusPoint[r].z),s=new fm.Vector3(this._radiusPoint[r-1].x,this._radiusPoint[r-1].y,this._radiusPoint[r-1].z),this._lineDis.push(a.distanceTo(s)))}return n}},{key:"getIndexDis",value:function(e){for(var t=0,n=0;n<this._lineDis.length;n++)n<e&&(t+=this._lineDis[n]);return t}},{key:"computerUVY",value:function(){for(var e,t=[],n=this.getIndexDis(this._lineDis.length),r=0;r<this._radiusPoint.length;r++)0===r?t.push(0):r===this._radiusPoint.length-1?t.push(1):(e=this.getIndexDis(r)/n,t.push(e),t.push(e));return t}},{key:"computeScreenCoord",value:function(e,t,n,r){for(var i=[],o=0,a=[],s=e.matrixWorldInverse,u=0;u<this._linePoints.length;u+=3){var l=this._linePoints[u],c=this._linePoints[u+1],h=this._linePoints[u+2];(h=(h=new fm.Vector3(l+r.x,c+r.y,h+r.z)).applyMatrix4(s)).z,e.near,h=h.applyMatrix4(e.projectionMatrix),h=new fm.Vector2(t/2+t/2*h.x,n/2-n/2*h.y),i.push(h),2<u&&(o+=h=h.distanceTo(i[Math.round(u/3)-1]),a.push(h))}return this._screenPoints=i,this._screenDis=a,o}},{key:"_calcMinRadius",value:function(){if(this.points){this._minRadius=1;for(var e=0;e<this._points.length-1;e++){var t=this._points[e],n=this._points[e+1];n=.368*l.default.distanceOfTwoPoints(t,n),this._minRadius>n&&(this._minRadius=n)}}}},{key:"points",get:function(){return this._points},set:function(e){this._points=e}},{key:"groupId",get:function(){return this._groupId},set:function(e){this._groupId=e}},{key:"allLength",get:function(){return this.getIndexDis(this._lineDis.length)}},{key:"linePoints",get:function(){return this._linePoints}},{key:"uvys",get:function(){return this._uvys}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(201),n(214),n(88);var o=i(n(2)),a=i(n(3));i(n(216)),n=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,[{key:"createGeometry",value:function(e,t,n,r){for(var i=new Float32Array((t+1)*n*3),o=new Float32Array((t+1)*n*2),a=new Uint16Array(t*n*2*3),s=0;s<t+1;s++)for(var u=s/t*e,l=4/Math.sqrt(2*Math.PI)*Math.exp(-u*u/2/r)/Math.sqrt(r),c=0;c<n;c++){var h=c/n*Math.PI*2,f=u*Math.sin(h),d=u*Math.cos(h),p=s*n*3+3*c;i[p]=d,i[p+1]=l,i[p+2]=f;var g=s*n*2+2*c;o[g]=c/n,o[g+1]=s/t,s<t&&(h=void 0,d=void 0,p=void 0,f=void 0,p=(h=s*n+c)+n,f=(d=c+1===n?s*n:h+1)+n,a[g=s*n*6+6*c]=h,a[g+1]=d,a[g+2]=p,a[g+3]=d,a[g+4]=f,a[g+5]=p)}return{index:a,uv:o,vertice:i}}},{key:"computerArcLineByPoints",value:function(e,t,n,r,i){var o=(new fm.Vector3).copy(e).distanceTo(t),a=(new fm.Vector3).copy(n).distanceTo(t),s=(new fm.Vector3).copy(e),u=(new fm.Vector3).copy(e),l=[];r<o&&(s=(new fm.Vector3).copy(t).add((new fm.Vector3).copy(e).sub(t).normalize().multiplyScalar(r)),l.push(s)),r<a&&(u=(new fm.Vector3).copy(t).add((new fm.Vector3).copy(n).sub(t).normalize().multiplyScalar(r)));for(var c=new fm.QuadraticBezierCurve3(s,t,u),h=0;h<i-1;h++){var f=(h+1)/i;f=c.getPoint(f),l.push(f)}return r<a&&l.push(u),l}}]),e}(),t.default=n},function(e,t,n){n(86)("Float32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){"use strict";var r=n(8),i=n(10),o=n(63),a=n(123),s=n(13),u=n(124),l=n(7),c=n(125),h=n(38),f=n(17),d=n(126),p=n(81).f,g=n(23).f,m=n(127),v=n(87),y="ArrayBuffer",_="DataView",x="prototype",A="Wrong index!",I=r[y],w=r[_],b=r.Math,C=r.RangeError,M=r.Infinity,E=I,T=b.abs,S=b.pow,L=b.floor,k=b.log,R=b.LN2,N=(n="buffer",r="byteLength",b="byteOffset",i?"_b":n),P=i?"_l":r,O=i?"_o":b;function D(e,t,n){var r,i,o=new Array(n),a=8*n-t-1,s=(1<<a)-1,u=s>>1,l=23===t?S(2,-24)-S(2,-77):0,c=0,h=e<0||0===e&&1/e<0?1:0;for((e=T(e))!=e||e===M?(i=e!=e?1:0,r=s):(r=L(k(e)/R),e*(n=S(2,-r))<1&&(r--,n*=2),2<=(e+=1<=r+u?l/n:l*S(2,1-u))*n&&(r++,n/=2),s<=r+u?(i=0,r=s):1<=r+u?(i=(e*n-1)*S(2,t),r+=u):(i=e*S(2,u-1)*S(2,t),r=0));8<=t;o[c++]=255&i,i/=256,t-=8);for(r=r<<t|i,a+=t;0<a;o[c++]=255&r,r/=256,a-=8);return o[--c]|=128*h,o}function F(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,l=127&(n=e[u--]);for(n>>=7;0<s;l=256*l+e[u],u--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=t;0<s;r=256*r+e[u],u--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:n?-M:M;r+=S(2,t),l-=a}return(n?-1:1)*r*S(2,l-t)}function B(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function G(e){return[255&e]}function z(e){return[255&e,e>>8&255]}function U(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function V(e){return D(e,52,8)}function H(e){return D(e,23,4)}function j(e,t,n){g(e[x],t,{get:function(){return this[n]}})}function W(e,t,n,r){var i=+n;if((n=d(i))+t>e[P])throw C(A);return i=e[N]._b,e=n+e[O],t=i.slice(e,e+t),r?t:t.reverse()}function Y(e,t,n,r,i,o){if((n=d(n=+n))+t>e[P])throw C(A);for(var a=e[N]._b,s=n+e[O],u=r(+i),l=0;l<t;l++)a[s+l]=u[o?l:t-l-1]}if(a.ABV){if(!l((function(){I(1)}))||!l((function(){new I(-1)}))||l((function(){return new I,new I(1.5),new I(NaN),I.name!=y}))){I=function(e){return c(this,I),new E(d(e))};for(var q,X=I[x]=E[x],Z=p(E),J=0;Z.length>J;)(q=Z[J++])in I||s(I,q,E[q]);o||(X.constructor=I)}X=new w(new I(2));var K=w[x].setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||u(w[x],{setInt8:function(e,t){K.call(this,e,t<<24>>24)},setUint8:function(e,t){K.call(this,e,t<<24>>24)}},!0)}else I=function(e){c(this,I,y),e=d(e),this._b=m.call(new Array(e),0),this[P]=e},w=function(e,t,n){c(this,w,_),c(e,I,_);var r=e[P];if((t=h(t))<0||r<t)throw C("Wrong offset!");if(r<t+(n=void 0===n?r-t:f(n)))throw C("Wrong length!");this[N]=e,this[O]=t,this[P]=n},i&&(j(I,r,"_l"),j(w,n,"_b"),j(w,r,"_l"),j(w,b,"_o")),u(w[x],{getInt8:function(e){return W(this,1,e)[0]<<24>>24},getUint8:function(e){return W(this,1,e)[0]},getInt16:function(e){return((e=W(this,2,e,arguments[1]))[1]<<8|e[0])<<16>>16},getUint16:function(e){return(e=W(this,2,e,arguments[1]))[1]<<8|e[0]},getInt32:function(e){return B(W(this,4,e,arguments[1]))},getUint32:function(e){return B(W(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return F(W(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return F(W(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){Y(this,1,e,G,t)},setUint8:function(e,t){Y(this,1,e,G,t)},setInt16:function(e,t){Y(this,2,e,z,t,arguments[2])},setUint16:function(e,t){Y(this,2,e,z,t,arguments[2])},setInt32:function(e,t){Y(this,4,e,U,t,arguments[2])},setUint32:function(e,t){Y(this,4,e,U,t,arguments[2])},setFloat32:function(e,t){Y(this,4,e,H,t,arguments[2])},setFloat64:function(e,t){Y(this,8,e,V,t,arguments[2])}});v(I,y),v(w,_),s(w[x],a.VIEW,!0),t[y]=I,t[_]=w},function(e,t,n){var r=n(40),i=n(5)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){var r=n(64),i=n(5)("iterator"),o=n(40);e.exports=n(62).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){var r=n(206);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(21),i=n(207),o=n(5)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(36);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(63),i=n(24),o=n(25),a=n(13),s=n(40),u=n(210),l=n(87),c=n(128),h=n(5)("iterator"),f=!([].keys&&"next"in[].keys()),d="keys",p="values",g=function(){return this};e.exports=function(e,t,n,m,v,y,_){u(n,t,m);var x,A,I=function(e){if(!f&&e in M)return M[e];switch(e){case d:case p:return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",b=v==p,C=!1,M=e.prototype,E=M[h]||M["@@iterator"]||v&&M[v],T=E||I(v),S=v?b?I("entries"):T:void 0;if((m="Array"==t&&M.entries||E)&&(e=c(m.call(new e)))!==Object.prototype&&e.next&&(l(e,w,!0),r||"function"==typeof e[h]||a(e,h,g)),b&&E&&E.name!==p&&(C=!0,T=function(){return E.call(this)}),r&&!_||!f&&!C&&M[h]||a(M,h,T),s[t]=T,s[w]=g,v)if(x={values:b?T:I(p),keys:y?T:I(d),entries:S},_)for(A in x)A in M||o(M,A,x[A]);else i(i.P+i.F*(f||C),t,x);return x}},function(e,t,n){"use strict";var r=n(85),i=n(59),o=n(87),a={};n(13)(a,n(5)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(5)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(8),i=n(23),o=n(10),a=n(5)("species");e.exports=function(e){e=r[e],o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=n(39),i=n(46),o=n(17);e.exports=[].copyWithin||function(e,t){var n=r(this),a=o(n.length),s=i(e,a),u=i(t,a),l=(t=2<arguments.length?arguments[2]:void 0,Math.min((void 0===t?a:i(t,a))-u,a-s)),c=1;for(u<s&&s<u+l&&(c=-1,u+=l-1,s+=l-1);0<l--;)u in n?n[s]=n[u]:delete n[s],s+=c,u+=c;return n}},function(e,t,n){n(86)("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){var r=n(24),i=n(7),o=n(37),a=/"/g,s=function(e,t,n,r){var i=String(o(e));return e="<"+t,""!==n&&(e+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),e+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||3<t.split('"').length})),"String",n)}},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(32),n(132);var o,a,s,u,l,c,h,f,d,p,g,m=i(n(48));o=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],a=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],s=0,u=0,l=[2,0,0,0],c=function(e,t){var n=0,r=0,i=0;for(r=0;r<8;r++)1&t&&(n^=e),i=128&e,e<<=1,i&&(e^=27),t>>=1;return n},h=function(e,t,n){for(var r=0;r<4;r++)e[0+r]^=t[16*n+4*r],e[4+r]^=t[16*n+4*r+1],e[8+r]^=t[16*n+4*r+2],e[12+r]^=t[16*n+4*r+3]},f=function(e){for(var t,n,r,i=1;i<4;i++)for(n=0;n<i;){for(r=e[4*i+4-1],t=3;0<t;t--)e[4*i+t]=e[4*i+t-1];e[4*i+0]=r,n++}},d=function(e){for(var t,n,r,i=0;i<4;i++)for(t=0;t<4;t++)n=(240&e[4*i+t])>>4,r=15&e[4*i+t],e[4*i+t]=a[16*n+r]},p=function(e){for(var t=0;t<4;t++)e[t]=o[16*((240&e[t])>>4)+(15&e[t])]},g=function(e){return(0,m.default)(e,16)},n={decryption:function(e,t){for(var n=Array(16),r=0;r<16;r++)n[r]=16*g(t.substr(2*r,1))+g(t.substr(2*r+1,1));var i=Array(16);for(r=0;r<16;r++)i[r]=16*g(e.substr(2*r,1))+g(e.substr(2*r+1,1));var o=Array(16);switch(r=[],n.length){default:case 16:s=4,u=10;break;case 24:s=6,u=12;break;case 32:s=8,u=14}for(var a=r=Array(16*(u+1)),m=Array(4),v=4*(u+1),y=0;y<s;y++)a[4*y+0]=n[4*y+0],a[4*y+1]=n[4*y+1],a[4*y+2]=n[4*y+2],a[4*y+3]=n[4*y+3];for(y=s;y<v;y++){if(m[0]=a[4*(y-1)+0],m[1]=a[4*(y-1)+1],m[2]=a[4*(y-1)+2],m[3]=a[4*(y-1)+3],0==y%s){var _=void 0,x=void 0;for(_=(n=m)[0],x=0;x<3;x++)n[x]=n[x+1];if(n[3]=_,p(m),1==(n=y/s))l[0]=1;else if(1<n)for(l[0]=2,n--;0<n-1;)l[0]=c(l[0],2),n--;n=m,_=l,(x=m)[0]=n[0]^_[0],x[1]=n[1]^_[1],x[2]=n[2]^_[2],x[3]=n[3]^_[3]}else 6<s&&4==y%s&&p(m);a[4*y+0]=a[4*(y-s)+0]^m[0],a[4*y+1]=a[4*(y-s)+1]^m[1],a[4*y+2]=a[4*(y-s)+2]^m[2],a[4*y+3]=a[4*(y-s)+3]^m[3]}for(a=Array(16),m=0;m<4;m++)for(y=0;y<4;y++)a[4*m+y]=i[m+4*y];for(h(a,r,u),i=u-1;1<=i;i--)for(f(a),d(a),h(a,r,i),m=a,y=[14,9,13,11],v=x=void 0,n=Array(4),_=Array(4),v=0;v<4;v++){for(x=0;x<4;x++)n[x]=m[4*x+v];x=y;var A=n,I=_;for(I[0]=c(x[0],A[0])^c(x[3],A[1])^c(x[2],A[2])^c(x[1],A[3]),I[1]=c(x[1],A[0])^c(x[0],A[1])^c(x[3],A[2])^c(x[2],A[3]),I[2]=c(x[2],A[0])^c(x[1],A[1])^c(x[0],A[2])^c(x[3],A[3]),I[3]=c(x[3],A[0])^c(x[2],A[1])^c(x[1],A[2])^c(x[0],A[3]),x=0;x<4;x++)m[4*x+v]=_[x]}for(f(a),d(a),h(a,r,0),m=0;m<4;m++)for(y=0;y<4;y++)o[m+4*y]=a[4*m+y];for(i="",r=0;r<16;++r)(a=o[r].toString(16)).length<2&&(a="0"+a),i+=a;return i}},t.default=n},function(e,t,n){n(10)&&"g"!=/./g.flags&&n(23).f(RegExp.prototype,"flags",{configurable:!0,get:n(89)})},function(e,t,n){n(219),e.exports=n(4).parseInt},function(e,t,n){var r=n(6);n=n(220),r(r.G+r.F*(parseInt!=n),{parseInt:n})},function(e,t,n){var r=n(9).parseInt,i=n(133).trim,o=(n=n(90),/^[-+]?0[xX]/);e.exports=8!==r(n+"08")||22!==r(n+"0x16")?function(e,t){return e=i(String(e),3),r(e,t>>>0||(o.test(e)?16:10))}:r},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(48)),a=i(n(15));n(26),n(16),n(88),n(66);var s=i(n(29)),u=i(n(2)),l=i(n(3)),c=i(n(12)),h=i(n(41)),f=i(n(65)),d=i(n(49)),p=i(n(91)),g=i(n(222)),m=i(n(223)),v=i(n(50)),y=i(n(33)),_=i(n(42)),x=i(n(236)),A=i(n(94)),I=i(n(141)),w=i(n(254)),b=i(n(95)),C=i(n(255)),M=i(n(96)),E=i(n(256)),T=i(n(145)),S=i(n(258)),L=i(n(263));n=function(){function e(t){(0,u.default)(this,e),this._options=new g.default(t),this._naviService=new m.default(this._options),this._startPoint=null,this._startGroupId=null,this._endPoint=null,this._endGroupId=null,this._startZone=null,this._mode=h.default.MODULE_SHORTEST,this._priority=f.default.PRIORITY_DEFAULT,this._graphs=new v.default,this._outlineAnalyseDijkstra=null,this._multiFloorDijkstraMap=new v.default,this._groupLiftNodes=new v.default,this._extentNodes=[],this._extentRoads=[],this._predictExtentNodes=[],this._predictLiftNodes=[],this._result=[],this._weightBias=1,this._liftLessWeightGain=.1,this._liftWeightGain=1,this._liftGreaterWightGain=10,this._escalatorLessWightGain=.1,this._escalatorWeightGain=1,this._escalatorGreaterWightGain=10,this._stairLessWeightGain=.1,this._stairWeightGain=1,this._stairGreaterWeightGain=10,this._scene=null,this._eDijKCollection=null,this._naviToDoor=!1,this._startModel=null,this._endModel=null,this._endDoor=null,this._assignedInfos=[]}return(0,l.default)(e,[{key:"initByMap",value:function(e){e&&e._currentSceneId&&e.dataManager&&(e=e.dataManager._sceneDecodeData[e._currentSceneId])&&(this._naviService.setScene(e),this._scene=e,0!=(e=e.floors).length&&(this._initNaviGraphs(e),this._initDijkstras(),this._eDijKCollection=new S.default,this._eDijKCollection.loadGraphs(this._graphs)))}},{key:"initByOptions",value:function(e){}},{key:"initByScene",value:function(e){e&&(this._scene=e,this._naviService.setScene(e),0!=(e=e.floors).length&&(this._initNaviGraphs(e),this._initDijkstras()))}},{key:"initByNaviGraphs",value:function(e){e&&(this._initNaviGraphs(e),this._initDijkstras())}},{key:"dispose",value:function(){this._options=null,this._naviService=null,this._graphs.each((function(e,t){t.dispose()})),this._graphs.clear(),this._graphs=null,this._outlineAnalyseDijkstra.dispose(),this._outlineAnalyseDijkstra=null,this._multiFloorDijkstraMap.each((function(e,t){t.dispose()})),this._multiFloorDijkstraMap.clear(),this._multiFloorDijkstraMap=null,this._groupLiftNodes.clear(),this._groupLiftNodes=null,this._extentNodes=null,this._extentRoads=null,this._predictExtentNodes=null,this._predictLiftNodes=null,this._result=null}},{key:"assginedInfos",get:function(){return this._assignedInfos},set:function(e){this._assignedInfos=e}},{key:"passPts",set:function(e){this._passPts=e}},{key:"routePassingPoints",value:function(e,t){return this.naviAdapter=new L.default(e,t,this._passPts,this._eDijKCollection),this.naviAdapter.executeCalculation(),this._result=this.naviAdapter.routes,this._failedInsertedPts=this.naviAdapter.failInsertedPts,d.default.ROUTE_SUCCESS}},{key:"failedInsertedPts",get:function(){return this._failedInsertedPts}},{key:"calc_outlines_dist",value:function(e){for(var t=0,n=0;n<e.length-1;n++)t+=Math.abs(e[n].groupId-e[n+1].groupId);return{dist:t,seq:e}}},{key:"calc_sort_outlines_dist",value:function(e){for(var t=[],n=0;n<e.length;n++)t.push(this.calc_outlines_dist(e[n]));return t.sort((function(e,t){return e.dist-t.dist})),t}},{key:"sort_outlineinfos_length",value:function(e){e.sort((function(e,t){return e.seq.length-t.seq.length}))}},{key:"naviToDoor",get:function(){return this._naviToDoor},set:function(e){this._naviToDoor=e}},{key:"routeAssigned",value:function(){for(var e in this._assignedInfos){var t=(0,o.default)(e);(e=this._multiFloorDijkstraMap.get(t)).assignedPts=this._assignedInfos[t],e.routeAssigned(),this._result.push({groupId:t,result:e.getRouteCalculateResult()})}}},{key:"route",value:function(e,t,n,r,i,o){var a=this;this.reset();var s=this._multiFloorDijkstraMap.get(e);if(!s)return d.default.ROUTE_FAILED_NO_DATA_START;var u=s._calcPointReachable(t);if(!u)return d.default.ROUTE_FAILED_NO_DATA_START;if(this._startModel=u.model,!(s=this._multiFloorDijkstraMap.get(n)))return d.default.ROUTE_FAILED_NO_DATA_END;if(!(s=s._calcPointReachable(r)))return d.default.ROUTE_FAILED_NO_DATA_END;this._endModel=s.model,this._result=[],this._startGroupId=e,this._startPoint=t,this._endGroupId=n,this._endPoint=r;var l=u.extentId,c=s.extentId,h=u.model,f=s.model;if(0==l||0==c)return d.default.ROUTE_FAILED_CANNOT_ARRIVE;var p=null;this._mode=i,this._switchToPriority(o);var g=function(){a._result=[];for(var e=[],n=[a._startPoint],o=0;o<a._predictExtentNodes.length-1;o++){var s=[],u=[];if(!a._calcPredictLiftNodes(a._predictExtentNodes[o],a._predictExtentNodes[o+1],n[n.length-1],s,u))return d.default.ROUTE_FAILED_CANNOT_ARRIVE;for(var l=!1,c=0;c<s.length;c++){var g,m=s[c]._wrappedNode,v=u[c]._wrappedNode,y=s[c].groupId,_=u[c].groupId;if(p=0==o?((g=a._multiFloorDijkstraMap.get(y))._startModel=h,g.routeCalculate(t,m,i)):(g=a._multiFloorDijkstraMap.get(y)).routeCalculate(e[e.length-1],m,i),d.default.ROUTE_SUCCESS==p){if(m=(m=a._multiFloorDijkstraMap.get(y)).getRouteCalculateResult(),a._result.push({groupId:y,result:m}),e.push(v),n.push(v.point),l=!0,a._predictExtentNodes.length-2==o){if((m=a._multiFloorDijkstraMap.get(_))._endModel=f,p=m.routeCalculate(v,r,i),d.default.ROUTE_SUCCESS!=p){a._result.splice(a._result.length-1,1),l=!1,n.splice(n.length-1,1),e.splice(e.length-1,1);continue}m=m.getRouteCalculateResult(),a._result.push({groupId:_,result:m})}if(d.default.ROUTE_SUCCESS==p)break}}if(!l)return d.default.ROUTE_FAILED_CANNOT_ARRIVE}return d.default.ROUTE_SUCCESS};if(e==n&&l==c){var m=this._multiFloorDijkstraMap.get(e);if(m._startModel=h,m._endModel=f,(p=m.routeCalculate(t,r,i))!=d.default.ROUTE_SUCCESS){for(var v=[],y=0;y<this._extentNodes.length;y++)this._extentNodes[y].groupId==e&&this._extentNodes[y].extentId==l&&v.push(this._extentNodes[y]);var _=this._enlarge_connected_nodes_num(v,v[0],1);if(0==_.length)return d.default.ROUTE_FAILED_OUTLINE;var x=this.calc_sort_outlines_dist(_);for(y=0;y<x.length;y++){this._predictExtentNodes=x[y].seq;var A=g();if(A==d.default.ROUTE_SUCCESS)return A}return d.default.ROUTE_FAILED_CANNOT_ARRIVE}m=m.getRouteCalculateResult(),this._result.push({groupId:e,result:m})}else{if((m=this._calcPredictExtentNodes(e,l,n,c))!=d.default.ROUTE_SUCCESS)return d.default.ROUTE_FAILED_OUTLINE;if(this._predictExtentNodes.reverse(),m=g(),d.default.ROUTE_SUCCESS!=m){var I=null,w=null;for(y=0;y<this._extentNodes.length;y++)this._extentNodes[y].groupId==e&&this._extentNodes[y].extentId==l&&(I=this._extentNodes[y]),this._extentNodes[y].groupId==n&&this._extentNodes[y].extentId==c&&(w=this._extentNodes[y]);if((_=[]).push([I]),this._enlarge_connected_nodes_norepeat(I,w,_),0==_.length)return d.default.ROUTE_FAILED_OUTLINE;for(x=this.calc_sort_outlines_dist(_),this.sort_outlineinfos_length(x),y=0;y<x.length;y++)if(this._predictExtentNodes=x[y].seq,(A=g())==d.default.ROUTE_SUCCESS)return A;return d.default.ROUTE_FAILED_CANNOT_ARRIVE}}return d.default.ROUTE_SUCCESS}},{key:"getRouteResult",value:function(){if(this._naviToDoor&&(this._endDoor=null,this._endModel&&0<this._result.length)){for(var e,t=this._result[this._result.length-1],n=t.result,r={x:-1,y:-1},i=n.length-1;0<i;i--){var o=n[i],a=n[i-1];if(c.default.segCrossPolygon(o.point,a.point,this._endModel.points,r)){e=i;break}}n.splice(e),(t=new _.default).Id=-1,t.point=r,n.push(t),this._endDoor=r}for(var s=[],u=0;u<this._result.length;u++){this._simplifyRouteResult(this._result[u]);for(var l=this._result[u],h=l.groupId,f=l.result,d=[],g=0,m=0;m<f.length;m++)d.push(f[m].point),m!=f.length-1&&(g+=c.default.distanceOfTwoPoints(f[m].point,f[m+1].point));(l=new p.default)._groupId=h,l._nodeList=f,l._pointList=d,l._length=g,s.push(l),u!=this._result.length-1&&(h=this._getBeginTransitionRoute(this._result[u]),l=this._getEndTransitionRoute(this._result[u+1]),s.push(h),s.push(l))}return s}},{key:"setBannedPoltyons",value:function(e){for(var t in e){var n=(0,o.default)(t);(n=this._multiFloorDijkstraMap.get(n)).setBannedPoltyons(e[t])}}},{key:"clearBannedAreas",value:function(){this._multiFloorDijkstraMap.each((function(e,t,n){n.clearBannedArea()}))}},{key:"refreshBannedArea",value:function(){this._multiFloorDijkstraMap.each((function(e,t,n){t._zoneIdSimpleDijkstraMap.get(-1).refreshAdjList()}))}},{key:"_simplifyRouteResult",value:function(e){if(e&&e.result){var t=e.result;if((s=t.length)&&!(s<2)){var n=[];n.push(t[0]);var r=t[0],i=t[s-1];c.default.distanceOfTwoPoints(r.point,i.point),c.default.epsilon();for(var o=1;o<s-1;o++){var a=t[o];null!=r&&c.default.distanceOfTwoPoints(r.point,a.point)<c.default.epsilon()||null!=i&&c.default.distanceOfTwoPoints(i.point,a.point)<c.default.epsilon()||n.push(a)}n.push(i);for(var s=n.length,u=new Array(s),l=0;l<s;l++)u[l]=0;for(var h=1;h<s-1;h++){for(var f=n[h],d=h-1;0!=u[d];)d--;var p=n[d],g=n[h+1];c.default.isPointOnSegment(f.point,p.point,g.point)&&(u[h]=1)}for(var m=[],v=0;v<s;v++)0==u[v]&&m.push(n[v]);e.result=m}}}},{key:"resetBanned",value:function(){this._multiFloorDijkstraMap.each((function(e,t){t.resetBanned()}))}},{key:"reset",value:function(){this._predictExtentNodes=[],this._predictLiftNodes=[],this._multiFloorDijkstraMap.each((function(e,t){t.reset()}))}},{key:"pathConstraint",value:function(e,t){var n=this;if(this._multiFloorDijkstraMap.size()<=0)return null;var r=this._multiFloorDijkstraMap.get(e.groupID);if(!r)return null;if(!(h=r._naviGraph))return null;var i=[];i.push.apply(i,(0,s.default)(h.roadVector)),r._zoneIdGraph.each((function(e,t){i.push.apply(i,(0,s.default)(t.roadVector))}));var o={},u=h.queryContainExtentId(e),l={distance:Number.MAX_VALUE,road:null,coord:{groupID:e.groupID}},h=null;return i.length&&(i.forEach((function(r){var i;r.roadEntry!=y.default.NaviRoadEntry_FORBID&&(t?0<=t.indexOf(r.roadRank)&&u==r.extentId&&(i=c.default.pointDistanceToLine(e,r.startPoint,r.endPoint,o))<l.distance&&(l.distance=i,l.road=r,l.angle=n._getRouteAngle(r.startPoint,r.endPoint),(0,a.default)(l.coord,o)):u==r.extentId&&(i=c.default.pointDistanceToLine(e,r.startPoint,r.endPoint,o))<l.distance&&(l.distance=i,l.road=r,l.angle=n._getRouteAngle(r.startPoint,r.endPoint),(0,a.default)(l.coord,o)))})),h=l),h}},{key:"_getRouteAngle",value:function(e,t){var n=new Geo.Vector3(0,0,1);return e=new Geo.Vector3(e.x,0,e.y),e=(t=(t=new Geo.Vector3(t.x,0,t.y)).clone().sub(e).normalize()).angleTo(n)*Geo._Math.RAD2DEG,(n=0<t.clone().cross(n).y)?360-e:e}},{key:"_initNaviGraphs",value:function(e){for(var t in this._graphs=new v.default,e){var n=e[t].gid;if(null!=n){var r=e[t].geo[0],i=e[t].biz[0],o=e[t].navi[0],a=this._naviService.convertToGroup(n,r,i,o),s=new v.default,u=this._initNaviNodes(a,s),l=this._initNaviRoads(a);t=this._initNaviZones(a),r=this._initNaviObstructExtents(a),i=this._initNaviObstructModels(a),this._processNaviObstructModels(i,u,o,s);var c=new b.default(u,l,!0,1);c.groupId=n,0!=r.length&&(c.obstructExtents=r),0!=t.length&&(c.zones=t),0!=i.length&&(c.obstructModels=i);for(var h=0;h<l.length;h++)l[h].extentId=c.queryContainExtentId(l[h].startPoint);this._graphs.put(a.gid,c)}}}},{key:"_initNaviNodes",value:function(e,t){var n,r=[],i=function(n){var i=e.naviNodes[n];if(null==i.nodeId)return"continue";var a=new _.default;a.Id=i.nodeId,a.point=i.geoArr,a.nodeType=i.nodeType,a.liftType=i.liftType,a.liftFlag=i.liftFlag,a.liftEntry=i.liftEntry,i.linkSegArr.forEach((function(e){a.segLinks.push((0,o.default)(e))})),i.liftFloorArr.forEach((function(e){a.liftFloors.push((0,o.default)(e))})),r.push(a),t.put(i.nodeId,n)};for(n in e.naviNodes)i(n);return r}},{key:"_initNaviRoads",value:function(e){var t,n=[];for(t in e.naviSegments){var r,i=e.naviSegments[t],o=i.geoArr;o&&((r=new A.default).Id=i.segmentId,r.startId=i.snode,r.startPoint=o[0],r.endId=i.enode,r.endPoint=o[1],r.length=i.length,r.roadEntry=i.entry,r.roadRank=i.rank,n.push(r))}return n}},{key:"_initNaviObstructExtents",value:function(e){for(var t=[],n=0,r=e.extentLayer.length;n<r;n++){var i=e.extentLayer[n],o=(o=i.geoArr)||[];(o=new w.default(i.eid,e.gid,0,o,i.center,i.holes)).fid=i.fid,t.push(o)}return t}},{key:"_initNaviObstructModels",value:function(e){for(var t=[],n=0,r=e.modelLayer.length;n<r;n++){var i=e.modelLayer[n],o=(o=i.geoArr)||[];(o=new w.default(i.eid,e.gid,0,o,i.center,i.holes)).fid=i.fid,o.pass=i.pass,t.push(o)}return t}},{key:"_initNaviZones",value:function(e){for(var t=[],n=0,r=e.naviZones.length;n<r;n++){var i=e.naviZones[n];i=new I.default(i.id,e.gid,i.type,i.geoArr),t.push(i)}return t}},{key:"_processNaviObstructModels",value:function(e,t,n,r){for(var i=new v.default,o=0;o<e.length;o++){var a=e[o];i.put(a.Id,o)}for(var s=0;s<n.naviModels.length;s++)for(var u=n.naviModels[s],l=u.id,c=e[i.get(l)],h=0;h<u.doorids.length;h++){var f=u.doorids[h],d=t[r.get(f)];c.doors.push(d),f=u.nodetypes[h],d=u.entrytypes[h],c.doorTypes.push(f),c.doorEntrys.push(d)}}},{key:"_processLiftFloors",value:function(){var e;this._graphs.size()<=0||(e={},this._graphs.each((function(t,n){var r,i=[];for(r in n.queryLiftNodesByType(y.default.NaviLiftType_Escalator,i),i){var o,a=i[r];a.liftFlag&&(o=a.liftFlag,e[o]?e[o]=e[o].concat(a.liftFloors):e[o]=a.liftFloors)}})),this._graphs.each((function(t,n){var r,i=[];for(r in n.queryLiftNodesByType(y.default.NaviLiftType_Escalator,i),i){var o,a=i[r];a.liftFlag&&(o=a.liftFlag,e[o]&&(a.liftFloors=e[o]))}})))}},{key:"_initDijkstras",value:function(){var e,t=this;!this._graphs||!this._graphs instanceof v.default||(this._initExtentNodes(),this._initExtentRoads(),e=new b.default(this._extentNodes,this._extentRoads),this._outlineAnalyzeDijkstra=new M.default(e),this._graphs.each((function(e,n){t._multiFloorDijkstraMap.put(e,new E.default(n))})))}},{key:"_initExtentNodes",value:function(){var e=this;this._extentNodes=[];var t=0;this._graphs.each((function(n,r){for(var i=r.obstructExtents,o=0;o<i.length;o++){var a=i[o],s=new C.default;s.Id=t++,s.groupId=n,s.extentId=a.Id,s.extent=a;for(var u=0;u<r.nodeVector.length;u++){var l,h,f=r.nodeVector[u];f.liftType!=y.default.NaviLiftType_NULL&&c.default.pointInPolygon2d(a.points,f.point,a.pointCount)&&(l=new x.default,h=r.queryZoneByPoint(f.point),l.zone=h,l.setNode(f),l.groupId=n,l._wrappedNode=f,l._liftType=f.liftType,s.liftNodes.push(l))}e._extentNodes.push(s)}}))}},{key:"_initExtentRoads",value:function(){this._extentRoads=[];for(var e=0;e<this._extentNodes.length;e++)for(var t=this._extentNodes[e],n=0;n<this._extentNodes.length;n++){var r,i,o=this._extentNodes[n];e!=n&&null!=(r=this._checkConnection(t,o))&&(r*=0==(i=Math.abs(t.groupId-o.groupId))?1:i,(i=new A.default).startId=t.Id,i.endId=o.Id,i.entryType=y.default.NaviRoadEntry_FORWARD,i.length=r,this._extentRoads.push(i))}}},{key:"_checkConnection",value:function(e,t){for(var n=Number.MAX_VALUE,r=!1,i=e.groupId,o=t.groupId,a=i<o?y.default.NaviLiftEntry_DOWN:y.default.NaviLiftEntry_UP,s=0;s<e.liftNodes.length;s++){var u=e.liftNodes[s],l=u.liftEntry;if(l!=y.default.NaviLiftEntry_FORBID&&l!=a){var c=u.liftType;if(f.default.PRIORITY_LIFTONLY==this._priority){if(y.default.NaviLiftType_Lift!=c)continue}else if(f.default.PRIORITY_ESCALATORONLY==this._priority){if(y.default.NaviLiftType_Escalator!=c)continue}else if(f.default.PRIORITY_STAIRONLY==this._priority){if(y.default.NaviLiftType_Stair!=c)continue}else if(f.default.PRIORITY_ACCESSIBLEONLY==this._priority&&y.default.NaviLiftType_Accessible!=c)continue;if(c==y.default.NaviLiftType_Stair||-1!=u.liftFloors.indexOf(o))for(var h=0;h<t.liftNodes.length;h++){var d=t.liftNodes[h];if(null!=d&&u.liftFlag==d.liftFlag)if(e.Id,t.Id,u.liftFlag,f.default.PRIORITY_LIFTFIRST==this._priority||f.default.PRIORITY_DEFAULT==this._priority){if(y.default.NaviLiftType_Lift==c||y.default.NaviLiftType_Accessible==c)return this._liftLessWeightGain;if(y.default.NaviLiftType_Escalator==c){var p=this._escalatorWeightGain;p<n&&(n=p),r=!0;break}if(y.default.NaviLiftType_Stair==c){(p=this._stairGreaterWeightGain)<n&&(n=p),r=!0;break}}else if(f.default.PRIORITY_ESCALATORFIRST==this._priority){if(y.default.NaviLiftType_Lift==c||y.default.NaviLiftType_Accessible==c){var g=this._liftWeightGain;g<n&&(n=g),r=!0;break}if(y.default.NaviLiftType_Escalator==c)return this._escalatorLessWightGain;if(y.default.NaviLiftType_Stair==c){var m=this._stairGreaterWeightGain;m<n&&(n=m),r=!0;break}}else if(f.default.PRIORITY_STAIRFIRST==this._priority){if(y.default.NaviLiftType_Lift==c){(m=this._liftWeightGain)<n&&(n=m),r=!0;break}if(y.default.NaviLiftType_Escalator==c||y.default.NaviLiftType_Accessible==c){var v=this._escalatorGreaterWeightGain;v<n&&(n=v),r=!0;break}if(y.default.NaviLiftType_Stair==c)return this._stairLessWeightGain}else{if(f.default.PRIORITY_LIFTFIRST1==this._priority||f.default.PRIORITY_STAIRFIRST1==this._priority||f.default.PRIORITY_ESCALATORFIRST1==this._priority)return this._weightBias;if(f.default.PRIORITY_LIFTONLY==this._priority||f.default.PRIORITY_ESCALATORONLY==this._priority||f.default.PRIORITY_STAIRONLY==this._priority||f.default.PRIORITY_ACCESSIBLEONLY==this._priority)return this._weightBias}}}}return r?n:null}},{key:"_getLiftNode",value:function(e,t){for(var n=0;n<t.length;n++)if(t[n].liftFlag==e)return t[n];return null}},{key:"_switchToPriority",value:function(e){this._priority==e&&this._outlineAnalyseDijkstra||(this._priority=e,this._initExtentRoads(),e=new b.default(this._extentNodes,this._extentRoads),this._outlineAnalyseDijkstra=new M.default(e))}},{key:"_getEndTransitionRoute",value:function(e){var t=e.result,n=new p.default;return n._groupId=e.groupId,n._nodeList.push(t[0]),n._pointList.push(t[0].point),n._length=0,n}},{key:"_getBeginTransitionRoute",value:function(e){var t=e.result,n=new p.default;return n._groupId=e.groupId,n._nodeList.push(t[t.length-1]),n._pointList.push(t[t.length-1].point),n._length=0,n}},{key:"_getExtentNode",value:function(e,t){for(var n=0;n<this._extentNodes.length;n++)if(this._extentNodes[n].groupId==e&&this._extentNodes[n].extentId==t)return this._extentNodes[n];return null}},{key:"_calcPredictExtentNodes",value:function(e,t,n,r){if(t=this._getExtentNode(e,t),r=this._getExtentNode(n,r),(r=this._outlineAnalyseDijkstra.routeCalculate(t,r))!=d.default.ROUTE_SUCCESS)return r;var i=this._outlineAnalyseDijkstra.getRouteCalculateResult();this._predictExtentNodes=[];for(var o=0;o<i.length;o++)this._predictExtentNodes.push(i[o]);return r}},{key:"_compareLiftFirstFunc",value:function(e,t){return e.liftType==y.default.NaviLiftType_Lift&&t.liftType==y.default.NaviLiftType_Lift?e._dist-t._dist:e.liftType==y.default.NaviLiftType_Lift?-1:t.liftType==y.default.NaviLiftType_Lift?1:e._dist-t._dist}},{key:"_compareEscalatorFirstFunc",value:function(e,t){return e.liftType==y.default.NaviLiftType_Escalator&&t.liftType==y.default.NaviLiftType_Escalator?e._dist-t._dist:e.liftType==y.default.NaviLiftType_Escalator?-1:t.liftType==y.default.NaviLiftType_Escalator?1:e._dist-t._dist}},{key:"_compareStairFirstFunc",value:function(e,t){return e.liftType==y.default.NaviLiftType_Stair&&t.liftType==y.default.NaviLiftType_Stair?e._dist-t._dist:e.liftType==y.default.NaviLiftType_Stair?-1:t.liftType==y.default.NaviLiftType_Stair?1:e._dist-t._dist}},{key:"_has_extent_node",value:function(e,t){if(null==e)return!1;for(var n=0;n<e.length;n++)if(e[n].Id==t.Id)return!0;return!1}},{key:"_has_adj_nodeId",value:function(e,t){if(null==e)return!1;for(var n=0;n<e.length;n++)if(e[n].nodeId==t.Id)return!0;return!1}},{key:"_enlarge_connected_nodes_num",value:function(e,t,n){var r=this._outlineAnalyseDijkstra._naviGraph.adjList;if(0==r.size())return[];var i=e.length-1,o=r.get(e[i].Id);if(null==o)return[];if(0==n)return this._has_adj_nodeId(o,t)?(e.push(t),e):[];for(var a=[],s=0;s<o.length;s++){var u,l=o[s];this._has_extent_node(e,l)||l.nodeId==t.Id||(u=e.concat(),l=this._outlineAnalyseDijkstra._naviGraph.getIndexByNodeID(l.nodeId),u.push(this._outlineAnalyseDijkstra._naviGraph.nodeVector[l]),0!=(u=this._enlarge_connected_nodes_num(u,t,n-1)).length&&a.push(u))}return a}},{key:"_enlarge_connected_nodes_norepeat",value:function(e,t,n){var r=this._outlineAnalyseDijkstra._naviGraph.adjList;if(0!=r.size()){for(var i=-1,o=0;o<n.length;o++)n[o].indexOf(e)==n[o].length-1&&(i=o);if(-1!=i){var a=n[i];n.splice(i,1);var u=r.get(e.Id);if(null!=u)for(var l=0;l<u.length;l++){var c,h=this._extentNodes[u[l].nodeId];this._has_extent_node(a,h)||((c=[]).push.apply(c,(0,s.default)(a)),c.push(h),n.push(c),h.Id!=t.Id&&this._enlarge_connected_nodes_norepeat(h,t,n))}}}}},{key:"_calcPredictConnectedLift",value:function(e,t,n){for(var r=e.liftNodes,i=n.liftNodes,o=0;o<r.length;o++){var a=r[o];a._dist=c.default.distanceOfTwoPoints(a.point,t)}f.default.PRIORITY_DEFAULT==this._priority||f.default.PRIORITY_LIFTONLY==this._priority||f.default.PRIORITY_LIFTONLY==this._priority?r.sort(this._compareLiftFirstFunc):f.default.PRIORITY_ESCALATORFIRST==this._priority||f.default.PRIORITY_ESCALATORONLY==this._priority?r.sort(this._compareEscalatorFirstFunc):f.default.PRIORITY_STAIRFIRST!=this._priority&&f.default.PRIORITY_STAIRONLY!=this._priority||r.sort(this._compareLiftFirstFunc);for(var s=null,u=null,l=!1,h=0;h<r.length;h++){for(var d=r[h],p=d.liftFlag,g=(d.liftFloors,0);g<i.length;g++)if(i[g].liftFlag==p){s=d,u=i[g],l=!0;break}if(l)break}return null==s||null==u?null:{startLiftNodes:s,endLiftNodes:u}}},{key:"_calcPredictLiftNodesBak",value:function(e,t,n,r,i){this._startZone=this._multiFloorDijkstraMap.get(e.groupId)._naviGraph.queryZoneByPoint(n);for(var o=e.queryLiftNodes(this._startZone,n,this._endPoint,this._priority),a=0;a<o.length;a++){var s=o[a];if(y.default.NaviLiftType_Stair==s.liftType||-1!=s.liftFloors.indexOf(t.groupId))for(var u=0;u<t.liftNodes.length;u++){var l=t.liftNodes[u];if(s.liftFlag==l.liftFlag){r.push(s),i.push(l);break}}}return 0==r.length}},{key:"_calcPredictLiftNodes",value:function(e,t,n,r,i){this._startZone=this._multiFloorDijkstraMap.get(e.groupId)._naviGraph.queryZoneByPoint(n);var o=[];function a(t,n){t=e.queryLifts(t,n),(n=o).push.apply(n,(0,s.default)(t))}for(var u=e.liftNodes,l=0;l<u.length;l++){var c=u[l],h=T.default.toVector(c.point),d=T.default.toVector(this._endPoint),p=T.default.toVector(n);c._dist=d.sub(h).length()+h.sub(p).length()}var g=e.extent.bb,m=g.maxX-g.minX+(g.maxY-g.minY);f.default.PRIORITY_LIFTONLY!=this._priority&&f.default.PRIORITY_ESCALATORONLY!=this._priority&&f.default.PRIORITY_STAIRONLY!=this._priority&&f.default.PRIORITY_ACCESSIBLEONLY!=this._priority||(g=null,f.default.PRIORITY_LIFTONLY==this._priority&&(g=y.default.NaviLiftType_Lift),f.default.PRIORITY_ESCALATORONLY==this._priority&&(g=y.default.NaviLiftType_Escalator),f.default.PRIORITY_STAIRONLY==this._priority&&(g=y.default.NaviLiftType_Stair),f.default.PRIORITY_ACCESSIBLEONLY==this._priority&&(g=y.default.NaviLiftType_Accessible),o=e.queryLifts(g)),f.default.PRIORITY_LIFTFIRST!=this._priority&&f.default.PRIORITY_ESCALATORFIRST!=this._priority&&f.default.PRIORITY_STAIRFIRST!=this._priority&&f.default.PRIORITY_DEFAULT!=this._priority||(f.default.PRIORITY_LIFTFIRST!=this._priority&&f.default.PRIORITY_DEFAULT!=this._priority||(a(y.default.NaviLiftType_Lift,-15),a(y.default.NaviLiftType_Escalator,-8),a(y.default.NaviLiftType_Stair,0)),f.default.PRIORITY_ESCALATORFIRST==this._priority&&(a(y.default.NaviLiftType_Lift,-8),a(y.default.NaviLiftType_Escalator,-15),a(y.default.NaviLiftType_Stair,0)),f.default.PRIORITY_STAIRFIRST==this._priority&&(a(y.default.NaviLiftType_Lift,-8),a(y.default.NaviLiftType_Escalator,0),a(y.default.NaviLiftType_Stair,-15))),f.default.PRIORITY_LIFTFIRST1!=this._priority&&f.default.PRIORITY_ESCALATORFIRST1!=this._priority&&f.default.PRIORITY_STAIRFIRST1!=this._priority||(f.default.PRIORITY_LIFTFIRST1==this._priority&&(a(y.default.NaviLiftType_Lift,-m),a(y.default.NaviLiftType_Escalator,0),a(y.default.NaviLiftType_Stair,0)),f.default.PRIORITY_ESCALATORFIRST1==this._priority&&(a(y.default.NaviLiftType_Lift,0),a(y.default.NaviLiftType_Escalator,-m),a(y.default.NaviLiftType_Stair,0)),f.default.PRIORITY_STAIRFIRST1==this._priority&&(a(y.default.NaviLiftType_Lift,0),a(y.default.NaviLiftType_Escalator,0),a(y.default.NaviLiftType_Stair,-m)));var v=this;o.sort((function(e,t){if(e.zone!=t.zone){if(e.zone==v._startZone)return-1;if(t.zone==v._startZone)return 1}return e._dist-t._dist}));for(var _=0;_<o.length;_++){var x=o[_];if(y.default.NaviLiftType_Stair!=x._liftType&&x._wrappedNode.liftFloors.find((function(e){return e==t.groupId})),!(1==x.liftEntry&&t.groupId<e.groupId||2==x.liftEntry&&t.groupId>e.groupId))for(var A=0;A<t.liftNodes.length;A++){var I=t.liftNodes[A];if(x.liftFlag==I.liftFlag){r.push(x),i.push(I);break}}}return 0!=r.length}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(t){(0,o.default)(this,e),this._options=t,this._options.hasOwnProperty("naviServerURL")&&null!=this._options.naviServerURL||(this._options.naviServerURL=".http://source.fengmap.com/newmap"),void 0===this._options.useStatic&&(this._options.useStatic=!1)}return(0,a.default)(e,[{key:"naviServerURL",get:function(){return this._options.naviServerURL}},{key:"useStatic",get:function(){return this._options.useStatic}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(92);var o=i(n(2)),a=i(n(3)),s=i(n(230)),u=i(n(231)),l=i(n(235));n=function(){function e(t){(0,o.default)(this,e),this._options=t,this._staticNaviScene=null,this._wktReader=new u.default,this._scene=null}return(0,a.default)(e,[{key:"setScene",value:function(e){this._scene=e}},{key:"queryScene",value:function(e,t,n){var r,i=this;this._options.useStatic?(r=this._options.naviServerURL+"/"+e+".fmap",new s.default(r,(function(e){e=i._convertStatic1(e),t(e.scene_data)}),!0)):(r=this._options.naviServerURL+"/"+e,new s.default(r,(function(e){e=i._convertSite1(e),t(e.scene_data)}),!0))}},{key:"queryNaviData",value:function(e,t,n,r){var i,o,a,u,l=this;this._options.useStatic?(i=l._convertStatic2(t),n(i)):(o=null,a=null,u=null,l=this,new s.default(this._options.naviServerURL+"/group_v2/"+e+"/"+t+"/geo",(function(e){null!=(o=e)&&null!=a&&null!=u&&(e=l._convertSite2(t,o,a,u),n(e))}),!0),new s.default(this._options.naviServerURL+"/group_v2/"+e+"/"+t+"/biz",(function(e){a=e,null!=o&&null!=a&&null!=u&&(e=l._convertSite2(t,o,a,u),n(e))}),!0),new s.default(this._options.naviServerURL+"/group_v2/"+e+"/"+t+"/navi",(function(e){u=e,null!=o&&null!=a&&null!=u&&(e=l._convertSite2(t,o,a,u),n(e))}),!0))}},{key:"convertToGroup",value:function(e,t,n,r){return this._convertToGroup(e,t,n,r)}},{key:"convertGeo2Geometry",value:function(e,t){return this._convertGeo2Geometry(e,t)}},{key:"convertArray2Geometry",value:function(e,t){return this._convertArray2Geometry(e,t)}},{key:"_convertSite1",value:function(e){return{scene_data:fmSceneDecode(e)}}},{key:"_convertSite2",value:function(e,t,n,r){return t=fmFloorGeoDecode(t),n=fmFloorBizDecode(n),r=fmFloorNaviDecode(r),this._convertToGroup(e,t,n,r)}},{key:"_convertGeo2Geometry",value:function(e,t){return{points:(e=this._wktReader.parse(e))._points,holes:e._holes}}},{key:"_convertArray2Geometry",value:function(e,t){return{points:(t=(new l.default).parseGeometry(e,t))._points,holes:t._holes}}},{key:"_tempFlipX",value:function(e){if(e&&"string"!=typeof e)for(var t in e){var n=e[t];if("vertices"==t||"vertex"==t)for(var r in n)r%2==0&&(n[r]=-n[r]);else"scene_data"==t?(n.x=-n.x,n.defCenX=-n.defCenX):this._tempFlipX(n)}}},{key:"_convertStringToArray",value:function(e){if(""==e||!e)return[];var t=[],n=e;return e=[],0<=n.indexOf("|")||0<=n.indexOf("-")||0<=n.indexOf(",")?(e=n.split(/[|,-]/),t.push.apply(t,e)):t.push(n),t}},{key:"_convertStatic1",value:function(e){return this._staticNaviScene=fmMapDecode(e,!1),{scene_data:this._staticNaviScene.scene}}},{key:"_convertStatic2",value:function(e){for(var t=this._staticNaviScene.floors,n=0;n<t.length;n++){var r=t[n];if(r.gid==e)return this._convertToGroup(e,r.geo[0],r.biz[0],r.navi[0])}return null}},{key:"_convertToGroup",value:function(e,t,n,r){for(var i={},o=[],a=[],s=[],u=[],l=[],c=this._scene.scene.file_ver,h=0,f=t.extentLayer.length;h<f;h++){var d=t.extentLayer[h],p=1===c?this._convertGeo2Geometry(d.geo):this._convertArray2Geometry(d.idxs,d.pts);d.geoArr=p.points,d.holes=p.holes,a.push(d)}for(var g=0,m=t.labelLayer.length;g<m;g++)i[t.labelLayer[g].eid]=t.labelLayer[g];for(var v=0,y=t.modelLayer.length;v<y;v++){var _=t.modelLayer[v],x=n.modelLayer[v],A={};A.fid=x.fid,A.eid=_.eid,A.pass=x.pass,A.center=(1===c?this._convertGeo2Geometry(i[_.eid].geo):this._convertArray2Geometry(i[_.eid].idxs,i[_.eid].pts)).points[0],x=null,x=1===c?this._convertGeo2Geometry(_.geo):this._convertArray2Geometry(_.idxs,_.pts),A.geoArr=x.points,A.holes=x.holes,o.push(A)}for(var I=0,w=r.naviNodes.length;I<w;I++){var b=r.naviNodes[I];b.geoArr=(1===c?this._convertGeo2Geometry(b.geo):this._convertArray2Geometry(b.idxs,b.pts)).points[0],b.linkSegArr=this._convertStringToArray(b.linkSeg),b.liftFloorArr=this._convertStringToArray(b.liftFloor),s.push(b)}for(var C=0,M=r.naviSegments.length;C<M;C++){var E=r.naviSegments[C];E.geoArr=(1===c?this._convertGeo2Geometry(E.geo):this._convertArray2Geometry(E.idxs,E.pts)).points,E.m_Id=r.mid,u.push(E)}if(r.naviZones){var T=0;for(M=r.naviZones.length;T<M;T++){var S=r.naviZones[T],L=1===c?this._convertGeo2Geometry(S.geo):this._convertArray2Geometry(S.idxs,S.pts);S.geoArr=L.points,S.holes=L.holes,S.m_Id=r.mid,l.push(S)}}return{gid:e,extentLayer:a,modelLayer:o,naviSegments:u,naviNodes:s,naviZones:l}}}]),e}(),t.default=n},function(e,t,n){var r=n(21),i=n(36),o=n(5)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){"use strict";var r=n(226)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r=n(38),i=n(37);e.exports=function(e){return function(t,n){var o,a=String(i(t)),s=r(n);return t=a.length,s<0||t<=s?e?"":void 0:(n=a.charCodeAt(s))<55296||56319<n||s+1===t||(o=a.charCodeAt(s+1))<56320||57343<o?e?a.charAt(s):n:e?a.slice(s,s+2):o-56320+(n-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(64),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){if("object"!=u(n=n.call(e,t)))throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";n(229);var r,i=n(25),o=n(13),a=n(7),s=n(37),u=n(5),l=n(93),c=u("species"),h=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),f=(r=(n=/(?:)/).exec,n.exec=function(){return r.apply(this,arguments)},2===(n="ab".split(n)).length&&"a"===n[0]&&"b"===n[1]);e.exports=function(e,t,n){var r,d,p=u(e),g=!a((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),m=g?!a((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[c]=function(){return n}),n[p](""),!t})):void 0;g&&m&&("replace"!==e||h)&&("split"!==e||f)||(r=/./[p],m=n(s,p,""[e],(function(e,t,n,i,o){return t.exec===l?g&&!o?{done:!0,value:r.call(t,n,i)}:{done:!0,value:e.call(n,t,i)}:{done:!1}})),n=m[0],d=m[1],i(String.prototype,e,n),o(RegExp.prototype,p,2==t?function(e,t){return d.call(e,this,t)}:function(e){return d.call(e,this)}))}},function(e,t,n){"use strict";var r=n(93);n(24)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e),this.requestMethod="GET",this._requestHeader={},this.sendData=null}return(0,a.default)(e,[{key:"getFile",value:function(e,t,n,r,i){void 0!==this._path&&(e=this._path+e);var o,a=new XMLHttpRequest;for(o in a.open(this.requestMethod,e,!0),a.addEventListener("load",(function(e){var r=this.response;200===this.status||0===this.status||201===this.status?(0===this.status&&console.warn("FMMap FileLoader: HTTP Status 0 received."),t(r)):n(r)}),!1),a.addEventListener("progress",(function(e){r&&r()}),!1),a.addEventListener("error",(function(e){n()}),!1),a.addEventListener("abort",(function(e){i&&i()}),!1),void 0!==this._responseType&&(a.responseType=this._responseType),void 0!==this._withCredentials&&(a.withCredentials=this._withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this._mimeType?this._mimeType:"text/plain"),this._requestHeader)a.setRequestHeader(o,this._requestHeader[o]);a.send(this.sendData)}},{key:"setPath",value:function(e){return this._path=e,this}},{key:"setResponseType",value:function(e){return this._responseType=e,this}},{key:"setWithCredentials",value:function(e){return this._withCredentials=e,this}},{key:"setMimeType",value:function(e){return this._mimeType=e,this}},{key:"setRequestHeader",value:function(e){return e&&(this._requestHeader=e),this}}]),e}(),t.default=n},function(e,n,r){"use strict";var i=r(0),o=r(1);i(n,"__esModule",{value:!0}),n.default=void 0;var a=o(r(134));r(92);var s=o(r(2)),u=o(r(3)),l=l||{};l.GLEN1=15,l.GLEN2=6,l.GLEN3=17,r=function(){function e(){(0,s.default)(this,e),this._points,this._holes}return(0,u.default)(e,[{key:"parse",value:function(e){if(this._points=[],this._holes=[],0==e.indexOf("MULTIPOLYGON((("))for(var t=e.substring(l.GLEN1,e.length-3).split(/\),\(/),n=0;n<t.length;n++){var r=t[n].split(/,/);if(0==n)for(var i=0;i<r.length;i++){var o=r[i].split(" ");this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])})}else{var s=[];for(i=0;i<r.length;i++)o=r[i].split(" "),s.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});this._holes.push(s)}}else if(0==e.indexOf("POINT("))o=e.substring(l.GLEN2,e.length-1).split(" "),this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});else if(0==e.indexOf("MULTILINESTRING(("))for(r=e.substring(l.GLEN3,e.length-2).split(","),i=0;i<r.length;i++)o=r[i].split(" "),this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});return this}},{key:"toFixed",value:function(e){return+e.toFixed(2)}},{key:"parsePnt",value:function(e){if(this._points=[],0==e.indexOf("MULTIPOLYGON((("))for(var t=e.substring(l.GLEN1,e.length-3).split(","),n=0;n<t.length;n++){var r=t[n].split(" ");this._points.push({x:(0,a.default)(r[0]),y:(0,a.default)(r[1])})}else if(0==e.indexOf("POINT("))r=e.substring(l.GLEN2,e.length-1).split(" "),this._points.push({x:(0,a.default)(r[0]),y:(0,a.default)(r[1])});else if(0==e.indexOf("MULTILINESTRING(("))for(t=e.substring(l.GLEN3,e.length-2).split(","),n=0;n<t.length;n++)r=t[n].split(" "),this._points.push({x:(0,a.default)(r[0]),y:(0,a.default)(r[1])});return this}},{key:"toPntStrip",value:function(e){var t=[],n=this._points.length;if(!0===e){if(1<=n)for(var r=0;r<n-1;r++){var i=this._points[r];t.push(i.x,i.y)}}else for(r=0;r<n;r++)i=this._points[r],t.push(i.x,i.y);return t}},{key:"mergePnts",value:function(e){for(var t=[],n=e.length,r=0;r<n;r++){for(var i=e[r],o={x:this.toFixed(i.x),y:this.toFixed(i.y)},a=t.length,s=!1,u=0;u<a;u++){var l=t[u];if(l.x==o.x&&l.y==o.y){s=!0;break}}s||t.push(o)}return t}},{key:"toStrip",value:function(e){var n=[];if((r=this._points.length)<=0)return n;for(var r=this._points.splice(r-1,1)[0],i=this.mergePnts(this._points),o=i.length,a=0;a<o;a++){var s=i[a];n.push(s.x,s.y)}return!0===e||(t={x:this.toFixed(r.x),y:this.toFixed(r.y)},n.push(t.x,t.y),this._points.push(r)),n}},{key:"hasHoles",value:function(){return null!=this._holes&&0<this._holes.length}},{key:"toStripHoles",value:function(e){for(var n=[],r=0;r<this._holes.length;r++){for(var i=this._holes[r],o=[],a=i.length,s=(a=i.splice(a-1,1)[0],this.mergePnts(i)),u=s.length,l=0;l<u;l++){var c=s[l];o.push(c.x,c.y)}!0===e||(t={x:this.toFixed(a.x),y:this.toFixed(a.y)},o.push(t.x,t.y)),n.push(o)}return n}},{key:"holes",get:function(){return this._holes},set:function(e){this._holes=e}},{key:"points",get:function(){return this._points},set:function(e){this._points=e}}]),e}(),n.default=r},function(e,t,n){n(233),e.exports=n(4).parseFloat},function(e,t,n){var r=n(6);n=n(234),r(r.G+r.F*(parseFloat!=n),{parseFloat:n})},function(e,t,n){var r=n(9).parseFloat,i=n(133).trim;e.exports=1/r(n(90)+"-0")!=-1/0?function(e){var t=i(String(e),3);return 0===(e=r(t))&&"-"==t.charAt(0)?-0:e}:r},function(e,n,r){"use strict";var i=r(0),o=r(1);i(n,"__esModule",{value:!0}),n.default=void 0;var a=o(r(2)),s=o(r(3));r=function(){function e(){(0,a.default)(this,e),this._points,this._holes}return(0,s.default)(e,[{key:"parse",value:function(e,t){this._points=[],this._holes=[];for(var n=0,r=0;r<e.length;r++){var i;if("number"==typeof(i=(i=e[r].idxs)||e[r]))for(;n<i;)this._points.push({x:t[n],y:t[n+1]}),n+=2;else for(var o=0;o<i.length;o++)for(var a=i[o];n<a;)this._points.push({x:t[n],y:t[n+1]}),n+=2}return this}},{key:"parseGeometry",value:function(e,t){this._points=[],this._holes=[];for(var n=0,r=0;r<e.length;r++){var i;if("number"==typeof(i=(i=e[r].idxs)||e[r]))for(;n<i;)this._points.push({x:t[n],y:t[n+1]}),n+=2;else for(var o=0;o<i.length;o++)if(0===o)for(var a=i[o];n<a;)this._points.push({x:t[n],y:t[n+1]}),n+=2;else{for(var s=[],u=i[o];n<u;)s.push({x:t[n],y:t[n+1]}),n+=2;this._holes.push(s)}}return this}},{key:"mergePnts",value:function(e){for(var t=[],n=e.length,r=0;r<n;r++){for(var i=e[r],o={x:this.toFixed(i.x),y:this.toFixed(i.y)},a=t.length,s=!1,u=0;u<a;u++){var l=t[u];if(l.x==o.x&&l.y==o.y){s=!0;break}}s||t.push(o)}return t}},{key:"toStrip",value:function(e){var n=[];if((r=this._points.length)<=0)return n;for(var r=this._points.splice(r-1,1)[0],i=this._points,o=i.length,a=0;a<o;a++){var s=i[a];n.push(s.x,s.y)}return!0===e||(t={x:this.toFixed(r.x),y:this.toFixed(r.y)},n.push(t.x,t.y),this._points.push(r)),n}},{key:"toFixed",value:function(e){return+e.toFixed(2)}},{key:"hasHoles",value:function(){return null!=this._holes&&0<this._holes.length}},{key:"toStripHoles",value:function(e){for(var n=[],r=0;r<this._holes.length;r++){for(var i=this._holes[r],o=[],a=i.length,s=(a=i.splice(a-1,1)[0],this.mergePnts(i)),u=s.length,l=0;l<u;l++){var c=s[l];o.push(c.x,c.y)}!0===e||(t={x:this.toFixed(a.x),y:this.toFixed(a.y)},o.push(t.x,t.y)),n.push(o)}return n}},{key:"holes",get:function(){return this._holes},set:function(e){this._holes=e}},{key:"points",get:function(){return this._points},set:function(e){this._points=e}}]),e}(),n.default=r},function(e,t,n){"use strict";var r=n(136),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(137)),u=o(n(139)),l=o(n(140));n=function(e){(0,s.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this)).liftId=0,e.groupId=0,e.zone=null,e._dist=0,e._wrappedNode=null,e._liftType=null,e}return n}((n=o(n(42))).default),t.default=n},function(e,t,n){n(238),e.exports=n(4).Reflect.construct},function(e,t,n){var r=n(6),i=n(57),o=n(68),a=n(27),s=n(19),u=n(20),l=n(239),c=(n(9).Reflect||{}).construct,h=u((function(){function e(){}return!(c((function(){}),[],e)instanceof e)})),f=!u((function(){c((function(){}))}));r(r.S+r.F*(h||f),"Reflect",{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(f&&!h)return c(e,t,n);if(e!=n)return r=n.prototype,n=i(s(r)?r:Object.prototype),r=Function.apply.call(e,n,t),s(r)?r:n;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(l.apply(e,r))}})},function(e,t,n){"use strict";var r=n(68),i=n(19),o=n(240),a=[].slice,s={};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),u=function r(){var i=n.concat(a.call(arguments));return this instanceof r?function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)}(t,i.length,i):o(t,i,e)};return i(t.prototype)&&(u.prototype=t.prototype),u}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){e.exports=n(242)},function(e,t,n){n(243);var r=n(4).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){var r=n(6);r(r.S,"Object",{create:n(57)})},function(e,t,n){var r=n(138);function i(t,n){return e.exports=i=r||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,i(t,n)}e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){n(246),e.exports=n(4).Object.setPrototypeOf},function(e,t,n){var r=n(6);r(r.S,"Object",{setPrototypeOf:n(247).set})},function(e,t,n){var r=n(19),i=n(27),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(67)(Function.call,n(110).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){var r=n(106),i=n(111);function o(t){return e.exports=o="function"==typeof r&&"symbol"==u(i)?function(e){return u(e)}:function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":u(e)},e.exports.default=e.exports,e.exports.__esModule=!0,o(t)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(251)},function(e,t,n){n(252),e.exports=n(4).Object.getPrototypeOf},function(e,t,n){var r=n(44),i=n(114);n(253)("getPrototypeOf",(function(){return function(e){return i(r(e))}}))},function(e,t,n){var r=n(6),i=n(4),o=n(20);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3)),s=i(n(142)),u=i(n(12)),l=i(n(141));n=function(){function e(t,n,r,i,a,u){(0,o.default)(this,e),this.Id=t,this.fid="",this.points=i,this.pointCount=i&&i.length?i.length:0,this.center=a,this.holes=u,this._type=r,this.groupID=n,this.doors=[],this.doorTypes=[],this.doorEntrys=[],this.parent=null,this.child=null,this.brothers=[],this.level=0,this.inId=0,this._area=null,this.isExtent=!1,this.bb=new s.default,this.refreshBB()}return(0,a.default)(e,[{key:"pass",get:function(){return 3&this._type},set:function(e){this._type|=e}},{key:"level",get:function(){return 31&_level},set:function(e){this._level=31&e}},{key:"area",get:function(){return null==this._area&&(this._area=u.default.calcPolygonArea2d(this.points)),this._area}},{key:"contain",value:function(e){return u.default.pointInPolygon2d(this.points,e,this.points.length-1)}},{key:"refreshBB",value:function(){this.bb.init();for(var e=0;e<this.pointCount;e++)this.bb.expandBy({x:this.points[e].x,y:this.points[e].y})}},{key:"toZone",value:function(){var e=new l.default(this.isExtent?-this.Id:this.Id,this.groupID,this._type,this.points);return e.pass=this.pass,e.level=this.level,e.inId=this.inId,pZone}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(136),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(26);var a=o(n(29)),s=o(n(2)),u=o(n(3)),l=o(n(137)),c=o(n(139)),h=o(n(140)),f=(i=o(n(42)),o(n(33))),d=o(n(65)),p=o(n(12));i=function(e){(0,l.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.default)(e);return i=t?(n=(0,h.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,c.default)(this,i)}}(n);function n(){var e;return(0,s.default)(this,n),(e=t.call(this)).groupId=0,e.extentId=0,e.liftNodes=[],e._zone=null,e._firstPriorityOffset=15,e._secondPriorityOffset=8,e}return(0,u.default)(n,[{key:"queryLifts",value:function(e,t){if(!e)return[];for(var n=[],r=0;r<this.liftNodes.length;r++){var i=this.liftNodes[r];e==i._liftType&&(t&&(i._dist=i._dist+t),n.push(i))}return n}},{key:"queryLiftNodes",value:function(e,t,n,r){this._zone=e;var i=[];i.push.apply(i,(0,a.default)(this.liftNodes));for(var o=0;o<i.length;o++){var s=i[o];s._dist=p.default.distanceOfTwoPoints(n,s.point)+p.default.distanceOfTwoPoints(s.point,t)}return this._liftNodeSort(i,r)}},{key:"_liftNodeSort",value:function(e,t){if(t==d.default.PRIORITY_LIFTFIRST1){var n=this._sortLiftFirst.bind(this);e.sort(n)}else if(t==d.default.PRIORITY_ESCALATORFIRST1){var r=this._sortEscalatorFirst.bind(this);e.sort(r)}else if(t!=d.default.PRIORITY_STAIRFIRST1)r=this._sortStairFirst.bind(this),e.sort(r);else{this._modifyDistance(e,t);for(var i=[],o=0;o<e.length;o++)e[o]._dist&&i.push(e[o]);(t=e=[]).push.apply(t,i),t=this._sortDistFunc.bind(this),e.sort(t)}return e}},{key:"_sortLiftFirst",value:function(e,t){if(e.zone!=t.zone){if(this._zone==e.zone)return-1;if(this._zone==t.zone)return 1}return e.liftType!=f.default.NaviLiftType_Lift&&e.liftType!=f.default.NaviLiftType_Accessible||t.liftType!=f.default.NaviLiftType_Lift&&t.liftType!=f.default.NaviLiftType_Accessible?e.liftType==f.default.NaviLiftType_Lift||e.liftType==f.default.NaviLiftType_Accessible?-1:t.liftType==f.default.NaviLiftType_Lift||t.liftType==f.default.NaviLiftType_Accessible?1:e._dist-t._dist:e._dist<t._dist}},{key:"_sortEscalatorFirst",value:function(e,t){if(e.zone!=t.zone){if(this._zone==e.zone)return-1;if(this._zone==t.zone)return 1}return e.liftType==f.default.NaviLiftType_Escalator&&t.liftType==f.default.NaviLiftType_Escalator?e._dist<t._dist:e.liftType==f.default.NaviLiftType_Escalator?-1:t.liftType==f.default.NaviLiftType_Escalator?1:e._dist-t._dist}},{key:"_sortStairFirst",value:function(e,t){if(e.zone!=t.zone){if(this._zone==e.zone)return-1;if(this._zone==t.zone)return 1}return e.liftType==f.default.NaviLiftType_Stair&&t.liftType==f.default.NaviLiftType_Stair?e._dist<t._dist:e.liftType==f.default.NaviLiftType_Stair?-1:t.liftType==f.default.NaviLiftType_Stair?1:e._dist-t._dist}},{key:"_sortDistFunc",value:function(e,t){if(e.zone!=t.zone){if(this._zone==e.zone)return-1;if(this._zone==t.zone)return 1}return e._dist-t._dist}},{key:"_modifyDistance",value:function(e,t){if(t==d.default.PRIORITY_DEFAULT)for(var n=0;n<e.length;n++)e[n].liftType==f.default.NaviLiftType_Escalator?e[n]._dist-=this._firstPriorityOffset:e[n].liftType!=f.default.NaviLiftType_Lift&&e[n].liftType!=f.default.NaviLiftType_Accessible||(e[n]._dist-=this._secondPriorityOffset);else if(t==d.default.PRIORITY_STAIRFIRST)for(var r=0;r<e.length;r++)e[r].liftType==f.default.NaviLiftType_Stair?e[r]._dist-=this._firstPriorityOffset:e[r].liftType==f.default.NaviLiftType_Escalator&&(e[r]._dist-=this._secondPriorityOffset);else if(t==d.default.PRIORITY_ESCALATORFIRST)for(var i=0;i<e.length;i++)e[i].liftType==f.default.NaviLiftType_Escalator?e[i]._dist-=this._firstPriorityOffset:e[i].liftType!=f.default.NaviLiftType_Lift&&e[i].liftType!=f.default.NaviLiftType_Accessible||(e[i]._dist-=this._secondPriorityOffset);else if(t==d.default.PRIORITY_LIFTFIRST)for(var o=0;o<e.length;o++)e[o].liftType==f.default.NaviLiftType_Lift||e[o].liftType==f.default.NaviLiftType_Accessible?e[o]._dist-=this._firstPriorityOffset:e[o].liftType==f.default.NaviLiftType_Escalator&&(e[o]._dist-=this._secondPriorityOffset);else if(t==d.default.PRIORITY_STAIRONLY)for(var a=0;a<e.length;a++)e[a].liftType!=f.default.NaviLiftType_Stair&&(e[a]._dist=null);else if(t==d.default.PRIORITY_ESCALATORONLY)for(var s=0;s<e.length;s++)e[s].liftType!=f.default.NaviLiftType_Escalator&&(e[s]._dist=null);else if(t==d.default.PRIORITY_LIFTONLY)for(var u=0;u<e.length;u++)e[u].liftType!=f.default.NaviLiftType_Lift&&e[u].liftType!=f.default.NaviLiftType_Accessible&&(e[u]._dist=null);else if(t==d.default.PRIORITY_ACCESSIBLEONLY)for(var l=0;l<e.length;l++)e[l].liftType!=f.default.NaviLiftType_Accessible&&(e[l]._dist=null)}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(15));n(16),n(143),n(66),n(32),n(31),n(51),n(26);var a=i(n(29)),s=i(n(2)),u=i(n(3)),l=i(n(12)),c=i(n(33)),h=i(n(41)),f=i(n(144)),d=i(n(42)),p=i(n(94)),g=i(n(50)),m=i(n(96)),v=i(n(95)),y=i(n(49)),_=(i(n(91)),i(n(257)));n=function(){function e(t){(0,s.default)(this,e),this._startModel=null,this._endModel=null,this._naviGraph=t,this._zoneMap=new g.default,this._zoneIdGraph=new g.default,this._originDijkstra=null,this._zoneIdSimpleDijkstraMap=new g.default,this._resultVector=[],this._startZoneId=Number.INT_MIN,this._endZoneId=Number.INT_MIN,this._tmpId=-1,this._startNode=null,this._endNode=null,this._mode=h.default.MODULE_SHORTEST,this._zonePNTModelsMap=new g.default,this._zoneNPModelsMap=new g.default,this._modelIdRoadsMap=new g.default,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[],this._kScaleVariable=100,this._kRemainedZoneId=-1,this._kMinModelAngle=15,this._kDoorToler=.1,this._tmpAdjNodeIds=[],this._assignedPts=[],this._newTempRoads=[],this._bannedPolys=[],this._assignedNodes=[],this._segmentByZones(),this._assemblePassNotThroughModels(),this._assembleNotPassModels(),this._fitVariableRoadsToModel(),this._adjustNPModelRoads()}return(0,u.default)(e,[{key:"routeCalculate",value:function(e,t,n){if(this._startZoneId=e instanceof d.default?this._calcZoneIdByCoord(e.point):this._calcZoneIdByCoord(e),this._endZoneId=t instanceof d.default?this._calcZoneIdByCoord(t.point):this._calcZoneIdByCoord(t),n&&(this._mode=n),this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),e instanceof d.default)this._startNode=e;else if(y.default.ROUTE_FAILED_NO_DATA_START==this._processStartPoint(e,e))return y.default.ROUTE_FAILED_NO_DATA_START;if(this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),t instanceof d.default)this._endNode=t;else if(y.default.ROUTE_FAILED_NO_DATA_END==this._processEndPoint(t,e instanceof d.default?e.point:e))return y.default.ROUTE_FAILED_NO_DATA_END;return this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),null==this._startNode?y.default.ROUTE_FAILED_NO_DATA_START:null==this._endNode?y.default.ROUTE_FAILED_NO_DATA_END:(this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),this._naviGraph.consoleAdjInfos(),this._routeCalculate())}},{key:"routeAssigned",value:function(){var e;this._assignedNodes=[];for(var t=0;t<this._assignedPts.length;t++){var n={x:(n=this._assignedPts[t])[0],y:n[1]},r=this._calcZoneIdByCoord(n);n=this._insertTmpIsolatedNode(r,n),this._assignedNodes.push(n)}(e=this._resultVector).push.apply(e,(0,a.default)(this._assignedNodes))}},{key:"assignedPts",get:function(){return this._assignedPts},set:function(e){this._assignedPts=e}},{key:"getRouteCalculateResult",value:function(){return this._resultVector}},{key:"dispose",value:function(){this._startModel=null,this._endModel=null,this._naviGraph.dispose(),this._naviGraph=null,this._zoneMap.clear(),this._zoneMap=null,this._zoneIdGraph.each((function(e,t){t.dispose()})),this._zoneIdGraph.clear(),this._zoneIdGraph=null,null!=this._originDijkstra&&(this._originDijkstra.dispose(),this._originDijkstra=null),this._zoneIdSimpleDijkstraMap.each((function(e,t){t.dispose()})),this._zoneIdSimpleDijkstraMap.clear(),this._zoneIdSimpleDijkstraMap=null,this._resultVector=[],this._startNode=null,this._endNode=null,this._zonePNTModelsMap.clear(),this._zonePNTModelsMap=null,this._zoneNPModelsMap.clear(),this._zoneNPModelsMap=null,this._modelIdRoadsMap.clear(),this.__zoneNPModelsMap=null,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"reset",value:function(){this._resultVector=[],this._clearTempElements(-1),this._clearTempElements(this._startZoneId),this._startZoneId=Number.INT_MIN,this._clearTempElements(this._endZoneId),this._endZoneId=Number.INT_MIN,this._clearTempAdjList(),this._tmpAdjNodeIds=[];var e=this._naviGraph.roadVector.length;this._tmpId<-2*e&&(this._tmpId=-1);for(var t=0;t<this._variableModelPairs.length;t++){var n=this._variableModelPairs[t];this._switchVariableHinderTo(n.zoneId,n.model,c.default.NaviRoadHinderType_HINDER_HIGH)}this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"resetBanned",value:function(){this._newTempRoads=[];for(var e=0;e<this._noEntryRoads.length;e++){var t=this._noEntryRoads[e];t.road.roadEntry=t.originEntry}this._noEntryRoads=[],this._clearTempElements(-1),this._zoneIdSimpleDijkstraMap.get(-1)._naviGraph.makeUpAdjList()}},{key:"setBannedPoltyons",value:function(e){this.resetBanned(),0!=e.length&&(this._bannedPolys=e,this._dealBannedAreas())}},{key:"clearBannedArea",value:function(){}},{key:"_dealBannedAreas",value:function(){for(var e=0;e<this._bannedPolys.length;e++)this._banBySinglePolygon(this._bannedPolys[e])}},{key:"_insertNewTempRoad",value:function(e,t,n,r,i){var o,a;e instanceof d.default?o=e:((o=new d.default).Id=t,o.point=e,this._naviGraph.nodeVector.push(o)),n instanceof d.default?a=n:((a=new d.default).Id=r,a.point=n,this._naviGraph.nodeVector.push(a)),(n=new p.default).Id=this._tmpId--,n.startId=o.Id,n.startPoint=o.point,n.endId=a.Id,n.endPoint=a.point,n.roadEntry=i,this._naviGraph.roadVector.push(n)}},{key:"_banBySinglePolygon",value:function(e){for(var t=this._naviGraph.queryRoadsByPolygon(e),n=0;n<t.length;n++){var r=t[n],i=r.road,o=i.roadEntry;this._noEntryRoads.push({road:i,originEntry:o}),i.roadEntry=c.default.NaviRoadEntry_FORBID,1==r.crss.length&&(1==l.default.pointInPolygon2d(e,i.startPoint,e.length)?this._insertNewTempRoad(r.crss[0],this._tmpId--,i.endPoint,this._tmpId--,o):this._insertNewTempRoad(i.startPoint,this._tmpId--,r.crss[0],this._tmpId--,o)),2==r.crss.length&&(this._insertNewTempRoad(i.startPoint,this._newTempId(),r.crss[0],this._newTempId(),o),this._insertNewTempRoad(r.crss[1],this._newTempId(),i.endPoint,this._newTempId(),o))}var a=new NaviModel;a.Id=this._tmpId--,a.points=e,a.points.push(e[0]),a.pass=c.default.NaviModelPassType_NOT_PASS,this._naviGraph.obstructModels.push(a)}},{key:"_newTempId",value:function(){return this._tmpId--}},{key:"_calcPointReachable",value:function(e){var t=this._naviGraph.queryContainExtentId(e);if(-1==t)return null;var n=this._calcZoneIdByCoord(e),r=-0,i=this._zoneIdGraph.get(n).findModel(e,r);if(null==i)return{extentId:t,model:null};if(i.pass==c.default.NaviModelPassType_PASS_THROUGH||i.pass==c.default.NaviModelPassType_PASS_NOT_THROUGH){if(0<i.doors.length)return{extentId:t,model:i};for(var o={},a=[],s=[],u=(r=this._zoneIdGraph.get(n)).roadVector,h=!0,f=i.points.length,d=0;d<f-1;d++)for(var p=i.points[d],g=i.points[d+1],m=0;m<u.length;m++){var v=u[m];1==l.default.calcCrossPoint(p,g,v.startPoint,v.endPoint,o)&&(h=!1,c.default.NaviRoadEntry_FORBID!=v.roadEntry&&((v=new Object).x=o.x,v.y=o.y,a.push(v),s.push(u[m])))}if(h)return{extentId:t,model:i};if(0==a.length)return null;i.doors=[],i.doorEntrys=[],i.doorTypes=[];for(var y=0;y<a.length;y++){var _=a[y],x=s[y];(_=this._insertNodeToRoad(n,_,x)).nodeType=c.default.NaviNodeType_COMMON,x.roadEntry==c.default.NaviRoadEntry_BOTH?_.entranceType=c.default.NaviEntranceType_ACCESS:l.default.pointInPolygon2d(i.points,x.startPoint,i.points.length-1)?(x.roadEntry==c.default.NaviRoadEntry_FORWARD&&(_.entranceType=c.default.NaviEntranceType_EXIT),x.roadEntry==c.default.NaviRoadEntry_BACK&&(_.entranceType=c.default.NaviEntranceType_ENTRANCE)):(x.roadEntry==c.default.NaviRoadEntry_FORWARD&&(_.entranceType=c.default.NaviEntranceType_ENTRANCE),x.roadEntry==c.default.NaviRoadEntry_BACK&&(_.entranceType=c.default.NaviEntranceType_EXIT)),i.doors.push(_),i.doorEntrys.push(_.entranceType),i.doorTypes.push(_.nodeType)}}return i.pass!=c.default.NaviModelPassType_NOT_PASS?{extentId:t,model:i}:null}},{key:"_processStartPoint",value:function(e,t){var n=this;this._startNode=this._insertTmpIsolatedNode(this._startZoneId,e);var r=null,i=!0;if(r=null!=this._startModel&&this._startModel.pass==c.default.NaviModelPassType_PASS_THROUGH&&0==this._startModel.doors.length?this._seekNearRoads(this._startZoneId,e,t,30,this._startModel):this._seekNearRoads(this._startZoneId,e,t),null==this._startModel&&(i=!1),0<r.size()){i=!1,r.each((function(e,t,n){for(n=0;n<t.length;n++)0!=t[n].road.roadEntry&&(i=!0)}));var o=0,s=!1,u=[];if(r.each((function(t,r){var i=r[0].road;0==(r=n._exploreUprightLikelyJoints(n._startZoneId,e,i,r,n._startModel)).length?o++:Math.abs(r[0].rotateAngle)>l.default.epsilon()?u.push.apply(u,(0,a.default)(r)):(s=!0,r=n._insertTempNodeToRoad(n._startZoneId,r[0].cross,r[0].road),n._joinTwoNodes(n._startZoneId,n._startNode,r))})),s||u.forEach((function(e){e=n._insertTempNodeToRoad(n._startZoneId,e.cross,e.road),n._joinTwoNodes(n._startZoneId,n._startNode,e)})),o==r.size())return y.default.ROUTE_FAILED_NO_DATA_START}if(i&&null!=this._startModel&&0<this._startModel.doors.length){for(var h=null,f=!1,d=0;d<this._startModel.doors.length;d++){h=this._startModel.doors[d];var p=this._startModel.doorEntrys[d];p!=c.default.NaviEntranceType_EXIT&&p!=c.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._startZoneId,this._startNode,h),f=!0)}if(!f)return y.default.ROUTE_FAILED_NO_DATA_START}}},{key:"_processEndPoint",value:function(e,t){var n=this;this._endNode=this._insertTmpIsolatedNode(this._endZoneId,e);var r=null,i=!0;if(r=null!=this._endModel&&this._endModel.pass==c.default.NaviModelPassType_PASS_THROUGH&&0==this._endModel.doors.length?this._seekNearRoads(this._endZoneId,e,t,30,this._endModel):this._seekNearRoads(this._endZoneId,e,t),null==this._endModel&&(i=!1),0<r.size()){i=!1,r.each((function(e,t,n){for(n=0;n<t.length;n++)0!=t[n].road.roadEntry&&(i=!0)}));var o=0,s=!1,u=[];if(r.each((function(t,r){var i=r[0].road;0==(r=n._exploreUprightLikelyJoints(n._endZoneId,e,i,r,n._endModel)).length?o++:Math.abs(r[0].rotateAngle)>l.default.epsilon()?u.push.apply(u,(0,a.default)(r)):(s=!0,r=n._insertTempNodeToRoad(n._endZoneId,r[0].cross,r[0].road),n._joinTwoNodes(n._endZoneId,n._endNode,r))})),s||u.forEach((function(e){e=n._insertTempNodeToRoad(n._endZoneId,e.cross,e.road),n._joinTwoNodes(n._endZoneId,n._endNode,e)})),o==r.size())return y.default.ROUTE_FAILED_NO_DATA_END}if(i&&null!=this._endModel&&0<this._endModel.doors.length){for(var h=null,f=!1,d=0;d<this._endModel.doors.length;d++){h=this._endModel.doors[d];var p=this._endModel.doorEntrys[d];p!=c.default.NaviEntranceType_ENTRANCE&&p!=c.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._endZoneId,this._endNode,h),f=!0)}if(!f)return y.default.ROUTE_FAILED_NO_DATA_END}}},{key:"_routeCalculate",value:function(){window.DEBUG&&_.default.printRoads(this._naviGraph);var e=this._isPointInPNTModel(this._startNode.point);if(e&&(this._switchVariableHinderTo(this._startZoneId,e,c.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._startZoneId,model:e})),(e=this._isPointInPNTModel(this._endNode.point))&&(this._switchVariableHinderTo(this._endZoneId,e,c.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._endZoneId,model:e})),this._resultVector=[],this._startZoneId==this._endZoneId){var t=this._zoneIdSimpleDijkstraMap.get(this._startZoneId);if((r=t.routeCalculate(this._startNode,this._endNode,this._mode))!=y.default.ROUTE_SUCCESS)return r;var n=t.getRouteCalculateResult();this._resultVector=[],n.reverse(),(r=this._resultVector).push.apply(r,(0,a.default)(n))}else{if(-1!=this._startZoneId&&-1==this._endZoneId){if(t=this._findNearZoneDoor(this._startNode.point,this._startZoneId,c.default.NaviEntranceType_EXIT),(n=(r=this._zoneIdSimpleDijkstraMap.get(this._startZoneId)).routeCalculate(this._startNode,t,this._mode))!=y.default.ROUTE_SUCCESS)return n;var r,i=r.getRouteCalculateResult(i);if((n=(r=this._zoneIdSimpleDijkstraMap.get(-1)).routeCalculate(t,this._endNode,this._mode))!=y.default.ROUTE_SUCCESS)return n;n=r.getRouteCalculateResult(),i.reverse(),n.reverse(),(r=this._resultVector).push.apply(r,(0,a.default)(i)),(i=this._resultVector).push.apply(i,(0,a.default)(n))}if(-1==this._startZoneId&&-1!=this._endZoneId){var o=this._findNearZoneDoor(this._endNode.point,this._endZoneId,c.default.NaviEntranceType_ENTRANCE);if((s=(l=this._zoneIdSimpleDijkstraMap.get(this._endZoneId)).routeCalculate(o,this._endNode,this._mode))!=y.default.ROUTE_SUCCESS)return s;var s,u=l.getRouteCalculateResult();if((s=(l=this._zoneIdSimpleDijkstraMap.get(-1)).routeCalculate(this._startNode,o,this._mode))!=y.default.ROUTE_SUCCESS)return s;(o=l.getRouteCalculateResult()).reverse(),u.reverse(),(s=this._resultVector).push.apply(s,(0,a.default)(o)),(l=this._resultVector).push.apply(l,(0,a.default)(u))}if(-1!=this._startZoneId&&-1!=this._endZoneId){if(s=this._findNearZoneDoor(this._startNode.point,this._startZoneId,c.default.NaviEntranceType_EXIT),(l=(o=this._zoneIdSimpleDijkstraMap.get(this._startZoneId)).routeCalculate(this._startNode,s,this._mode))!=y.default.ROUTE_SUCCESS)return l;var l,h=o.getRouteCalculateResult(h);if(u=this._findNearZoneDoor(this._endNode.point,this._endZoneId,c.default.NaviEntranceType_ENTRANCE),(l=(o=this._zoneIdSimpleDijkstraMap.get(this._endZoneId)).routeCalculate(u,this._endNode,this._mode))!=y.default.ROUTE_SUCCESS)return l;var f=o.getRouteCalculateResult(f);if((l=(o=this._zoneIdSimpleDijkstraMap.get(-1)).routeCalculate(s,u,this._mode))!=y.default.ROUTE_SUCCESS)return l;l=o.getRouteCalculateResult(),h.reverse(),l.reverse(),f.reverse(),(o=this._resultVector).push.apply(o,(0,a.default)(h)),(h=this._resultVector).push.apply(h,(0,a.default)(l)),(l=this._resultVector).push.apply(l,(0,a.default)(f))}}return y.default.ROUTE_SUCCESS}},{key:"_getIndexFormID",value:function(e,t,n){for(var r=0;r<t;r++)if(null!=e[r]&&e[r].Id==n)return r;return-1}},{key:"_calcZoneIdByCoord",value:function(e){for(var t=this._naviGraph.zones,n=0;n<t.length;n++){var r=t[n];if(r.contain(e))return r.Id}return-1}},{key:"_segmentByZones",value:function(){for(var e=this,t=this._naviGraph.zones,n=0;n<t.length;n++){var r=t[n],i=this._sliceGraph(this._naviGraph,r);this._zoneIdGraph.put(r.Id,i)}this._zoneIdGraph.put(-1,this._naviGraph),this._zoneIdGraph.each((function(t,n){n.simplify(),e._zoneIdSimpleDijkstraMap.put(t,new m.default(n))})),this._zoneIdGraph.each((function(e,t){t.consoleNodeInfos(),t.consoleRoadInfos()}))}},{key:"_sliceGraph",value:function(e,t){if(e&&t){for(var n,r=0,i=0,a=e.roadVector.length,s=e.nodeVector.length,u=e.roadVector,l=e.nodeVector,h=0,f=new Int8Array(a),g=0;g<a;g++)u[g]&&u[g].roadEntry!=c.default.NaviRoadEntry_FORBID&&(n=u[g],r=t.contain(n.startPoint),i=t.contain(n.endPoint),0==r&&0==i||(h=!0),1==r&&1==i&&(f[g]=1),1==r&&0==i&&(f[g]=2),0==r&&1==i&&(f[g]=3),0==r&&0==i&&(f[g]=4),2==r&&0==i&&(f[g]=6),2==r&&1==i&&(f[g]=7),0==r&&2==i&&(f[g]=8),1==r&&2==i&&(f[g]=9));if(0==h)return null;for(var m,y,_,x,A,I,w=new Array(s),b=new Array(a),C=0,M=new Int8Array(s),E=0,T=N=f.length;E<T;E++)0!=f[E]&&6!=f[E]&&8!=f[E]&&1!=f[E]&&u[E]&&(y=(m=u[E]).roadEntry,A=[m.Id],2==f[E]||9==f[E]?(_=null,_=2==f[E]?t.calcCrossPoint(m.startPoint,m.endPoint):(0,o.default)({},m.endPoint),(I=new d.default).Id=this._naviGraph.generateNodeId(),I.nodeType=c.default.NaviNodeType_COMMON,I.liftType=c.default.NaviLiftType_NULL,I.entranceType=c.default.NaviEntranceType_ACCESS,I.point=(0,o.default)({},_),(x=new p.default).setRoad(m),x.Id=this._naviGraph.generateRoadId(),A.push(x.Id),I.segLinks=A,(_=new d.default).setNode(I),y==c.default.NaviRoadEntry_FORWARD?_.entranceType=c.default.NaviEntranceType_EXIT:y==c.default.NaviRoadEntry_BACK&&(_.entranceType=c.default.NaviEntranceType_ENTRANCE),t._linkAccessNodes.push(_),C=this._getIndexFormID(l,s,x.endId),x.endPoint=(0,o.default)({},_.point),x.pointVector[1]=(0,o.default)({},_.point),x.endId=_.Id,x.calcLength(),b[E]=x,w[C]=_,w[C=this._getIndexFormID(l,s,x.startId)]=l[C],w[C].segLinks.splice(w[C].segLinks.indexOf(m.Id),1,x.Id),(x=new d.default).setNode(I),m.startId=x.Id,m.startPoint=(0,o.default)({},x.point),m.pointVector[0]=(0,o.default)({},x.point),m.calcLength(),l[C].segLinks.splice(l[C].segLinks.indexOf(m.Id),1),l.push(x),M[C]=2):3!=f[E]&&7!=f[E]||(I=null,I=3==f[E]?t.calcCrossPoint(m.startPoint,m.endPoint):(0,o.default)({},m.startPoint),(x=new d.default).Id=this._naviGraph.generateNodeId(),x.nodeType=c.default.NaviNodeType_COMMON,x.liftType=c.default.NaviLiftType_NULL,x.entranceType=c.default.NaviEntranceType_ACCESS,x.point=(0,o.default)({},I),(I=new p.default).setRoad(m),I.Id=this._naviGraph.generateRoadId(),A.push(I.Id),x.segLinks=A,(A=new d.default).setNode(x),y==c.default.NaviRoadEntry_FORWARD?A.entranceType=c.default.NaviEntranceType_ENTRANCE:y==c.default.NaviRoadEntry_BACK&&(A.entranceType=c.default.NaviEntranceType_EXIT),t._linkAccessNodes.push(A),C=this._getIndexFormID(l,s,I.startId),I.startPoint=(0,o.default)({},A.point),I.pointVector[0]=(0,o.default)({},A.point),I.startId=A.Id,I.calcLength(),b[E]=I,w[C]=A,w[C=this._getIndexFormID(l,s,I.endId)]=l[C],w[C].segLinks.splice(w[C].segLinks.indexOf(m.Id),1,I.Id),(I=new d.default).setNode(x),m.endId=I.Id,m.endPoint=(0,o.default)({},I.point),m.pointVector[1]=(0,o.default)({},I.point),m.calcLength(),l[C].segLinks.splice(l[C].segLinks.indexOf(m.Id),1),l.push(I),M[C]=2));for(var S,L=0,k=N;L<k;L++)1==f[L]&&(S=u[L])&&(b[L]=S,2!=M[C=this._getIndexFormID(l,s,S.startId)]&&(w[C]=l[C],M[C]=1),2!=M[C=this._getIndexFormID(l,s,S.endId)]&&(w[C]=l[C],M[C]=1),u[L]=null);for(var R=0;R<s;R++)1==M[R]&&(l[R]=null);for(var N=new v.default(w,b,!0,1),P=[],O=e.obstructModels,D=0;D<O.length;D++){var F=O[D];F&&this._modelInZone(F,t)&&P.push(F)}return(e=N.obstructModels).push.apply(e,P),N}}},{key:"_assemblePassNotThroughModels",value:function(){var e=this;this._zoneIdGraph.each((function(t,n){for(var r=n.obstructModels,i=0;i<r.length;i++){var o,a=r[i];c.default.NaviModelPassType_PASS_NOT_THROUGH==a.pass&&((o=e._zonePNTModelsMap.get(t))||(o=[],e._zonePNTModelsMap.put(t,o)),o.push(a))}})),this._zonePNTModelsMap.each((function(e,t){for(var n=0;n<t.length;n++)t[n].fid}))}},{key:"_assembleNotPassModels",value:function(){var e=this;this._zoneIdGraph.each((function(t,n){for(var r=n.obstructModels,i=0;i<r.length;i++){var o,a=r[i];c.default.NaviModelPassType_NOT_PASS==a.pass&&((o=e._zoneNPModelsMap.get(t))||(o=[],e._zoneNPModelsMap.put(t,o)),o.push(a))}})),this._zoneNPModelsMap.each((function(e,t){for(var n=0;n<t.length;n++)t[n].fid}))}},{key:"_fitVariableRoadsToModel",value:function(){var e=this;this._zonePNTModelsMap.each((function(t,n){for(var r=e._zoneIdGraph.get(t).roadVector,i=0;i<n.length;i++){for(var o=n[i],a=0;a<r.length;a++){var s=r[a].calcMiddlePoint();l.default.pointInPolygon2d(o.points,s,o.pointCount)&&(r[a].length=r[a].length*e._kScaleVariable,(s=e._modelIdRoadsMap.get(o.Id))||(s=[],e._modelIdRoadsMap.put(o.Id,s)),s.push(r[a]))}e._switchVariableHinderTo(t,o,c.default.NaviRoadHinderType_HINDER_HIGH)}}))}},{key:"_adjustNPModelRoads",value:function(){var e=this;this._zoneNPModelsMap.each((function(t,n){for(var r=e._zoneIdGraph.get(t).roadVector,i=0;i<n.length;i++)for(var o=n[i],a=0;a<r.length;a++){var s=r[a],u=s.roadEntry,h=s.calcMiddlePoint();if(l.default.pointInPolygon2d(o.points,h,o.pointCount-1)){if(s.length=Number.MAX_VALUE,u==c.default.NaviRoadEntry_BOTH||u==c.default.NaviRoadEntry_FORWARD){var f=e._zoneIdGraph.get(t).adjList.get(s.startId);if(f)for(var d=0;d<f.length;d++)f[d].nodeId==s.endId&&(f[d].length=s.length)}if(s.roadEntry==c.default.NaviRoadEntry_BOTH||s.roadEntry==c.default.NaviRoadEntry_BACK){var p=e._zoneIdGraph.get(t).adjList.get(s.endId);if(p)for(var g=0;g<p.length;g++)p[g].nodeId==s.startId&&(p[g].length=s.length)}}}}))}},{key:"_switchVariableHinderTo",value:function(e,t,n){var r=this._modelIdRoadsMap.get(t.Id);if(r){if(c.default.NaviRoadHinderType_HINDER_HIGH==n)for(var i=0;i<r.length;i++){var o=r[i];if(o.calcLength(),o.length=r.length*this._kScaleVariable,o.roadEntry==c.default.NaviRoadEntry_BOTH||o.roadEntry==c.default.NaviRoadEntry_FORWARD){var a=this._zoneIdGraph.get(e).adjList.get(o.startId);if(a)for(var s=0;s<a.length;s++)a[s].nodeId==o.endId&&(a[s].length=o.length)}if(o.roadEntry==c.default.NaviRoadEntry_BOTH||o.roadEntry==c.default.NaviRoadEntry_BACK){var u=this._zoneIdGraph.get(e).adjList.get(o.endId);if(u)for(var l=0;l<u.length;l++)u[l].nodeId==o.startId&&(u[l].length=o.length)}}if(c.default.NaviRoadHinderType_HINDER_GENERAL==n)for(var h=0;h<r.length;h++){var f=r[h];if(f.calcLength(),f.roadEntry==c.default.NaviRoadEntry_BOTH||f.roadEntry==c.default.NaviRoadEntry_FORWARD){var d=this._zoneIdGraph.get(e).adjList.get(f.startId);if(d)for(var p=0;p<d.length;p++)d[p].nodeId==f.endId&&(d[p].length=f.length)}if(f.roadEntry==c.default.NaviRoadEntry_BOTH||f.roadEntry==c.default.NaviRoadEntry_BACK){var g=this._zoneIdGraph.get(e).adjList.get(f.endId);if(g)for(var m=0;m<g.length;m++)g[m].nodeId==f.startId&&(g[m].length=f.length)}}}}},{key:"_findNearZoneDoor",value:function(e,t,n){var r=this._naviGraph.getZone(t);if(null==r)return null;for(var i=this._zoneIdGraph.get(t).findModel(e,o),o=i.area,a=Number.MAX_VALUE,s=null,u=0;u<r._linkAccessNodes.length;u++){var h,f=r._linkAccessNodes[u],d=l.default.distanceOfTwoPoints(f.point,e);f.entranceType!=c.default.NaviEntranceType_ACCESS&&f.entranceType!=n||d<a&&((h=this._findMinAreaNearestObstructModel(t,f.point))!=i&&h.pass==c.default.NaviModelPassType_PASS_NOT_THROUGH||(a=d,s=f))}return s}},{key:"_findMinAreaNearestObstructModel",value:function(e,t){for(var n=null,r=(e=this._zoneIdGraph.get(e),Number.MAX_VALUE),i=Number.MAX_VALUE,o=null,a=e.obstructModels,s=0;s<a.length;s++){var u=a[s],c=l.default.pointToPolygon2d(u.points,t,u.points.length-1);c<i&&(i=c,o=u),this._kDoorToler>c&&(c=u.area)<r&&(r=c,n=u)}return null==n?o:n}},{key:"_modelInZone",value:function(e,t){return!e.bb.isSeparate(t.bb)&&(e=e.center,!!l.default.pointInPolygon2d(t.points,e,t.pointCount))}},{key:"_insertTempNodeToRoad",value:function(e,t,n){var r=this._tmpAdjNodeIds.find((function(e){return e==n.startId})),i=this._tmpAdjNodeIds.find((function(e){return e==n.endId}));null==r&&this._tmpAdjNodeIds.push(n.startId),null==i&&this._tmpAdjNodeIds.push(n.endId);for(var o=this._unattachedTempRoadTrees,a=null,s=0;s<o.length;s++)if(o[s]._wrappedRoad==n){a=o[s];break}if(null==a)(a={})._wrappedRoad=n,o.push(a);else for(;null!=a._fromChild;){var u=a._fromChild._wrappedRoad;a=l.default.pointIsInRect1(t,u.startPoint,u.endPoint)?a._fromChild:a._toChild}n=a._wrappedRoad;var h=new d.default;h.Id=this._newTmpId(),h.point=t;var f=new p.default;f.Id=this._newTmpId(),f.startId=n.startId,f.startPoint=n.startPoint,f.endId=h.Id,f.endPoint=h.point,f.pointVector=[n.startPoint,h.point],f.roadRank=n.roadRank;var g,m=new p.default;return m.Id=this._newTmpId(),m.startId=h.Id,m.startPoint=h.point,m.endId=n.endId,m.endPoint=n.endPoint,m.pointVector=[h.point,n.endPoint],m.roadRank=n.roadRank,this._unattachedTempRoads.push(f),this._unattachedTempRoads.push(m),(r={})._wrappedRoad=f,(i={})._wrappedRoad=m,a._fromChild=r,a._toChild=i,h.tempType=1,f.tempType=1,m.tempType=1,f.calcLength(),m.calcLength(),f.roadEntry=n.roadEntry,m.roadEntry=n.roadEntry,(i=this._zoneIdGraph.get(e)).nodeVector.push(h),i.roadVector.push(f),i.roadVector.push(m),(e=this._zoneIdSimpleDijkstraMap.get(e)._naviGraph)._nodeMap.put(h.Id,i.nodeVector.length-1),n.roadEntry==c.default.NaviRoadEntry_BOTH&&((i=[]).push({nodeId:n.startId,length:f.length}),i.push({nodeId:n.endId,length:m.length}),e.adjList.put(h.Id,i),(i=e.adjList.get(n.startId))||(i=[],e.adjList.put(n.startId,i)),i.push({nodeId:h.Id,length:f.length}),(i=e.adjList.get(n.endId))||(i=[],e.adjList.put(n.endId,i)),i.push({nodeId:h.Id,length:m.length})),n.roadEntry==c.default.NaviRoadEntry_FORWARD&&((g=[]).push({nodeId:n.endId,length:m.length}),e.adjList.put(h.Id,g),(g=e.adjList.get(n.startId))||(g=[],e.adjList.put(n.startId,g)),g.push({nodeId:h.Id,length:f.length})),n.roadEntry==c.default.NaviRoadEntry_BACK&&((g=[]).push({nodeId:n.startId,length:f.length}),e.adjList.put(h.Id,g),(g=e.adjList.get(n.endId))||(g=[],e.adjList.put(n.endId,g)),g.push({nodeId:h.Id,length:m.length})),h}},{key:"_insertItemToVector",value:function(e,t){for(var n=t.length-1;0<=n;n--)if(t[n].Id&&0<t[n].Id)return t.splice(n+1,0,e),n+1;return-1}},{key:"_insertNodeToRoad",value:function(e,t,n,r){if(r)return this._insertTempNodeToRoad(e,t,n);var i=this._zoneIdGraph.get(e),o=new d.default;o.Id=i.generateNodeId(),o.point=t;var a,s=new p.default;return s.Id=i.generateRoadId(),s.startId=n.startId,s.startPoint=n.startPoint,s.endId=o.Id,s.endPoint=o.point,s.pointVector=[n.startPoint,o.point],(r=new p.default).Id=i.generateRoadId(),r.startId=o.Id,r.startPoint=o.point,r.endId=n.endId,r.endPoint=n.endPoint,r.pointVector=[o.point,n.endPoint],(e=[]).push(s.Id),e.push(r.Id),o.segLinks=e,s.calcLength(),r.calcLength(),s.roadEntry=n.roadEntry,r.roadEntry=n.roadEntry,t=i.nodeVector,e=i.roadVector,t=this._insertItemToVector(o,t),this._insertItemToVector(s,e),this._insertItemToVector(r,e),i._nodeMap.put(o.Id,t),n.roadEntry==c.default.NaviRoadEntry_BOTH&&((t=[]).push({nodeId:n.startId,length:s.length}),t.push({nodeId:n.endId,length:r.length}),i.adjList.put(o.Id,t),(t=i.adjList.get(n.startId))||(t=[],i.adjList.put(n.startId,t)),t.push({nodeId:o.Id,length:s.length}),(t=i.adjList.get(n.endId))||(t=[],i.adjList.put(n.endId,t)),t.push({nodeId:o.Id,length:r.length})),n.roadEntry==c.default.NaviRoadEntry_FORWARD&&((a=[]).push({nodeId:n.endId,length:r.length}),i.adjList.put(o.Id,a),(a=i.adjList.get(n.startId))||(a=[],i.adjList.put(n.startId,a)),a.push({nodeId:o.Id,length:s.length})),n.roadEntry==c.default.NaviRoadEntry_BACK&&((a=[]).push({nodeId:n.startId,length:s.length}),i.adjList.put(o.Id,a),(a=i.adjList.get(n.endId))||(a=[],i.adjList.put(n.endId,a)),a.push({nodeId:o.Id,length:r.length})),o}},{key:"_clearTmpPoint",value:function(e){if(null!=e){for(var t=this._zoneIdGraph.get(e),n=t.nodeVector.length-1;0<=n;n--){var r=t.nodeVector[n];if(null==r||0<=r.Id)break;t.nodeVector.splice(n,1)}for(var i=t.roadVector.length-1;0<=i;i--){var o=t.roadVector[i];if(null==o||0<=o.Id)break;t.roadVector.splice(i,1)}}}},{key:"_deleteTmpConnectionEntirely",value:function(e,t){var n=e.get(t);if(n)for(var r=0;r<n.length;r++)n[r].nodeId<0&&(n.splice(r,1),r--)}},{key:"_removeConnection",value:function(e,t){for(var n=e.get(t),r=0;r<n.length;r++)this._deleteTmpConnectionEntirely(e,n[r].nodeId);e.remove(t)}},{key:"_calcAdherenceAtOneAngle",value:function(e,t,n,r,i,a){i.toDistance=Number.MAX_VALUE,i.stickToRoad=!1,i.rotateAngle=0;for(var s=Number.MAX_VALUE,u={},h=this._zoneIdGraph.get(e),f=0;f<h.roadVector.length;f++){var d,p=h.roadVector[f];null!=p&&p.roadEntry!=c.default.NaviRoadEntry_FORBID&&(d=l.default.quickRayIntersect(t,n,p.startPoint,p.endPoint,u))&&((d=l.default.distanceOfTwoPoints(t,u))<s||Math.abs(d-s)<.1&&p.Id<0)&&(s=d,i.cross=(0,o.default)({},u),i.distance=s,i.road=p,i.stickToRoad=!0)}h=this._zoneIdGraph.get(-1);for(var g={},m=0;m<h.obstructModels.length;m++){var v=h.obstructModels[m];if(null!=v&&v!=a&&c.default.NaviModelPassType_DECORATE!=v.pass&&(null==a||!l.default.pointInPolygon2d(v.points,a.center,v.points.length-1)))for(var y=v.points.length,_=0;_<y-1;_++){var x=l.default.quickRayIntersect(t,n,v.points[_],v.points[_+1],g);if(x&&(x=l.default.distanceOfTwoPoints(t,g))<s)return s=x,i.model=v,i.distance=Number.MAX_VALUE,i.stickToRoad=!1,i.obstructType=c.default.NaviObstructType_MODEL,!1}}for(var A={},I=h.obstructExtents,w=0;w<I.length;w++){for(var b=I[w],C=I[w].holes,M=0;M<C.length;M++)for(var E=C[M],T=0;T<E.length-1;T++){var S=l.default.quickRayIntersect(t,n,E[T],E[T+1],A);if(S&&(S=l.default.distanceOfTwoPoints(t,A))<s)return s=S,i.model=b,i.distance=Number.MAX_VALUE,i.stickToRoad=!1,i.obstructType=c.default.NaviObstructType_EXTENT,!1}for(var L=I[w].points,k=0;k<L.length-1;k++){var R=l.default.quickRayIntersect(t,n,L[k],L[k+1],A);if(R&&(R=l.default.distanceOfTwoPoints(t,A))<s)return s=R,i.model=b,i.distance=Number.MAX_VALUE,i.stickToRoad=!1,i.obstructType=c.default.NaviObstructType_EXTENT,!1}}return i.toDistance=l.default.distanceOfTwoPoints(i.cross,r),!0}},{key:"_adherenceCompare",value:function(e,t){return e.toDistance-t.toDistance}},{key:"_adherenceAngleCompare",value:function(e,t){return t.rotateAngle-e.rotateAngle}},{key:"_clearTempElements",value:function(e){if(e=this._zoneIdGraph.get(e)){for(var t=e.nodeVector,n=t.length-1;0<=n;n--){var r=t[n];if(null==r||0<=r.Id)break;t.splice(n,1)}for(var i=e.roadVector,o=i.length-1;0<=o;o--){var a=i[o];if(null==a||0<=a.Id)break;i.splice(o,1)}}}},{key:"_clearTempAdjList",value:function(){var e=this;this._zoneIdSimpleDijkstraMap.each((function(t,n){for(var r=[],i=n._naviGraph.adjList,o=0;o<i.keys.length;o++)i.keys[o]<0&&r.push(i.keys[o]);for(var a=0;a<r.length;a++)e._removeConnection(n._naviGraph.adjList,r[a]);for(var s=0;s<e._tmpAdjNodeIds.length;s++)e._deleteTmpConnectionEntirely(i,e._tmpAdjNodeIds[s])}))}},{key:"_exploreUprightLikelyJoints",value:function(e,t,n,r,i){for(var o=[],a=0;a<r.length;a++)if(r[a].distance<l.default.epsilon())return o.push(r[a]),o;var s={x:0,y:0};if(l.default.calcFootOfUpright(t,n.startPoint,n.endPoint,s)&&this._isTwoPointsConnectedDirectly(t,s,{},i))return(i={}).cross=s,i.stickToRoad=!0,i.road=n,i.rotateAngle=0,i.dist=l.default.distanceOfTwoPoints(t,s),o.push(i),o;for(var u={x:s.x-t.x,y:s.y-t.y},c=0;c<r.length;c++){var h=r[c],f={x:h.cross.x-t.x,y:h.cross.y-t.y};f=270<(f=l.default.calcRotateAngle(f,u))?f-360:f,h.rotateAngle=f}r.sort(this._adherenceAngleCompare);var d=null,p=null;if(r[r.length-1].rotateAngle<0)return d=r[r.length-1],o.push(d),o;for(var g=0;g<r.length;g++)if(0<=r[g].rotateAngle)return d=r[g],0==g?o.push(d):(p=r[g-1],l.default.distanceOfTwoPoints(d.cross,n.startPoint)>l.default.distanceOfTwoPoints(p.cross,n.startPoint)?(o.push(p),o.push(d)):(o.push(d),o.push(p))),o;return o}},{key:"_calcAllAdherance",value:function(e,t,n,r,i,o){for(var a=i||30,s=0;s<360;s+=a){var u=new f.default;this._calcAdherenceAtOneAngle(e,t,s,n,u,o),1==u.stickToRoad&&r.push(u)}r.sort(this._adherenceCompare)}},{key:"_seekNearRoads",value:function(e,t,n,r,i){var o=new g.default,a=[];for(this._calcAllAdherance(e,t,n,a,r,i);0!=a.length;){var s=a[0],u=o.get(s.road.Id);u?u.push(s):((u=[]).push(s),o.put(s.road.Id,u)),a.splice(0,1)}return o}},{key:"_insertTmpIsolatedNode",value:function(e,t){var n=new d.default;return n.Id=this._newTmpId(),n.point=(0,o.default)({},t),(t=this._zoneIdGraph.get(e)).nodeVector.push(n),(e=this._zoneIdSimpleDijkstraMap.get(e))._naviGraph._nodeMap.put(n.Id,t.nodeVector.length-1),n}},{key:"_insertIsolatedNode",value:function(e,t,n){return n?this._insertTmpIsolatedNode(e,t):((n=new d.default).Id=this._naviGraph.generateNodeId(),n.point=(0,o.default)({},t),e=(t=this.zoneIdGraph.get(e)).nodeVector,e=this._insertItemToVector(n,e),t._nodeMap.put(n.Id,e),n)}},{key:"_isTwoPointsConnectedDirectly",value:function(e,t,n,r){for(var i=this._zoneIdGraph.get(-1),o=null,a=0;a<i.obstructModels.length;a++)if(null!=(o=i.obstructModels[a])&&o!=r&&c.default.NaviModelPassType_DECORATE!=o.pass)for(var s=o.points,u=0;u<s.length-1;u++)if(l.default.calcCrossPoint(e,t,s[u],s[u+1],n)){var h=l.default.distanceOfTwoPoints(e,n),f=l.default.distanceOfTwoPoints(t,n);if(!(h<=l.default.epsilon()||f<=l.default.epsilon()))return!1}for(var d=i.obstructExtents,p=0;p<d.length;p++){for(var g=d[p],m=g.holes,v=0;v<m.length;v++)for(var y=m[v],_=0;_<y.length-1;_++)if(l.default.calcCrossPoint(e,t,y[_],y[_+1],n))return!1;for(var x=g.points,A=0;A<x.length-1;A++)if(l.default.calcCrossPoint(e,t,x[A],x[A+1],n))return!1}return!0}},{key:"_joinTwoNodes",value:function(e,t,n,r,i,o){for(var a=0;a<this._attachedTempRoads.length;a++){var s=this._attachedTempRoads[a],u={};if(1==l.default.calcCrossPoint(s.startPoint,s.endPoint,t.point,n.point,u)&&l.default.distanceOfTwoPoints(t.point,u)>l.default.epsilon()&&l.default.distanceOfTwoPoints(n.point,u)>l.default.epsilon())return null}void 0===r&&(r=c.default.NaviRoadEntry_BOTH),void 0===i&&(i=!0),void 0===o&&(o=!0);var h,f,d=new p.default;return d.startId=t.Id,d.startPoint=t.point,d.endId=n.Id,d.endPoint=n.point,d.pointVector=[t.point,n.point],d.roadRank=1,this._tmpAdjNodeIds.push(t.Id),this._tmpAdjNodeIds.push(n.Id),d.Id=i?this._newTmpId():this._naviGraph.generateRoadId(),d.roadEntry=r,d.calcLength(),o&&this._attachedTempRoads.push(d),(o=this._zoneIdGraph.get(e)).roadVector.push(d),o=this._zoneIdSimpleDijkstraMap.get(e),c.default.NaviRoadEntry_BOTH==r&&(e={nodeId:n.Id,length:d.length},(h=o._naviGraph.adjList.get(t.Id))?h.push(e):((h=[]).push(e),o._naviGraph.adjList.put(t.Id,h)),e={nodeId:t.Id,length:d.length},(h=o._naviGraph.adjList.get(n.Id))?h.push(e):((h=[]).push(e),o._naviGraph.adjList.put(n.Id,h))),c.default.NaviRoadEntry_FORWARD==r&&(h={nodeId:n.Id,length:d.length},(f=o._naviGraph.adjList.get(t.Id))?f.push(h):((f=[]).push(h),o._naviGraph.adjList(t.Id,f))),c.default.NaviRoadEntry_BACK==r&&(r={nodeId:t.Id,length:d.length},(f=o._naviGraph.adjList.get(n.Id))?f.push(r):((f=[]).push(r),o._naviGraph.adjList.put(n.Id,f))),d}},{key:"_isPointInPNTModel",value:function(e){var t=this._calcZoneIdByCoord(e),n=this._zonePNTModelsMap.get(t);if(n)for(var r=0;r<n.length;r++){var i=n[r];if(l.default.pointInPolygon2d(i.points,e,i.points.length))return i}return null}},{key:"_newTmpId",value:function(){return this._tmpId--}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,null,[{key:"printRoads",value:function(e){}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3)),s=i(n(259));n=function(){function e(){(0,o.default)(this,e),this._dijkCollection=[]}return(0,a.default)(e,[{key:"loadGraphs",value:function(e){var t=0,n=this;e.each((function(e,r,i){for(var o=r.obstructExtents,a=0;a<o.length;a++){var u=o[a].Id;u=r.getGraphByEid(u),(u=new s.default(t++,u)).gid=e,n._dijkCollection.push(u)}}))}},{key:"each",value:function(e){for(var t=0;t<this._dijkCollection.length;t++)e(this._dijkCollection[t])}},{key:"len",value:function(){return this._dijkCollection.length}},{key:"get",value:function(e){return this._dijkCollection[e]}},{key:"getDijkByPoint",value:function(e,t){var n,r=this._dijkCollection;for(n in r){var i=r[n];if(e==i.gid&&i.containsPt(t))return i}return null}},{key:"getDijkById",value:function(e){var t,n=this._dijkCollection;for(t in n){var r=n[t];if(r.Id==e)return r}return null}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(15));n(16),n(26),n(143),n(66),n(32),n(31),n(51);var a=i(n(29)),s=i(n(2)),u=i(n(3)),l=i(n(12)),c=i(n(33)),h=i(n(41)),f=i(n(144)),d=i(n(42)),p=i(n(94)),g=i(n(50)),m=i(n(96)),v=i(n(95)),y=i(n(49)),_=i(n(146)),x=i(n(261)),A=n(147);n=function(){function e(t,n){(0,s.default)(this,e),this.Id=t,this._startModel=null,this._endModel=null,this._naviGraph=n,this._zoneMap=new g.default,this._zoneIdGraph=new g.default,this._originDijkstra=null,this._zoneIdDijkstras=new g.default,this._resultVector=[],this._startZoneId=Number.INT_MIN,this._endZoneId=Number.INT_MIN,this._tmpId=-1,this._startNode=null,this._endNode=null,this._mode=h.default.MODULE_SHORTEST,this._zonePNTModelsMap=new g.default,this._zoneNPModelsMap=new g.default,this._modelIdRoadsMap=new g.default,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[],this._kScaleVariable=100,this._kRemainedZoneId=-1,this._kMinModelAngle=15,this._kDoorToler=.1,this._tmp_adj_node_ids=[],this._failedInsertPts=[],this._transitNodes=[],this._segmentByZones(),this._assemblePassNotThroughModels(),this._assembleNotPassModels(),this._fitVariableRoadsToModel(),this._adjustNPModelRoads(),this._KeyNodes=new x.default(["num","id","idx","node"]),this._NtoNRoutesGraph=new g.default,this._next=new A.SmallQueue,this._visited=!1,this._lifts=[]}return(0,u.default)(e,[{key:"gid",get:function(){return this._gid},set:function(e){this._gid=e}},{key:"setWayPoints",value:function(e){this._wayPts=null==e?[]:e,this._insertWayPoints()}},{key:"setStart",value:function(e){var t;e instanceof d.default?(this._startNode=e,this._KeyNodes.append({num:this._KeyNodes.size(),id:e.Id,idx:this._naviGraph.getIdxByNodeId(e.Id),node:e})):(t=new d.default,this._insertPoint(e,t)||this._failedInsertPts.push(e),this._startNode=t,this._KeyNodes.append({num:this._KeyNodes.size(),id:t.Id,idx:this._naviGraph.getIdxByNodeId(t.Id),node:t}))}},{key:"setEnd",value:function(e){var t;e instanceof d.default?(this._endNode=e,this._KeyNodes.append({num:this._KeyNodes.size(),id:e.Id,idx:this._naviGraph.getIdxByNodeId(e.Id),node:e})):(t=new d.default,this._insertPoint(e,t)||this._failedInsertPts.push(e),this._endNode=t,this._KeyNodes.append({num:this._KeyNodes.size(),id:t.Id,idx:this._naviGraph.getIdxByNodeId(t.Id),node:t}))}},{key:"predictLift",value:function(){function e(e,t){for(var n=0,r=0;r<t.length;r++){var i=(e.x-t[r][0])*(e.x-t[r][0])+(e.y-t[r][1])*(e.y-t[r][1]);n+=Math.sqrt(i)}return n}for(var t=this._naviGraph.getAllLifts(),n=0;n<t.length;n++)t[n].dist=e(t[n].point,this.getNext()._wayPts),t[n].dist+=e(t[n].point,this._wayPts),t[n].dist=t[n].dist/(0==this.getNext()._wayPts.length?1:this.getNext()._wayPts.length),t[n].liftType==c.default.NaviLiftType_Escalator&&(t[n].dist-=25),t[n].liftType==c.default.NaviLiftType_Lift&&(t[n].dist-=25);for(t.sort((function(e,t){return e.dist-t.dist})),n=0;n<t.length;n++){var r=t[n];if(-1!=r.liftFloors.indexOf(this.getNext().gid)&&this.getNext().getLiftByFlag(r.liftFlag))return r}return null}},{key:"hasRelationTo",value:function(e){for(var t=this._naviGraph.getAllLifts(),n=e.gid,r=this.gid,i=0;i<t.length;i++){var o=t[i];if((c.default.NaviLiftType_Stair==o.liftType||-1!=o.liftFloors.indexOf(n))&&null!=e.getLiftByFlag(o.liftFlag))if(o.liftEntry!=c.default.NaviLiftEntry_UP){if(o.liftEntry!=c.default.NaviLiftEntry_DOWN){if(o.liftEntry==c.default.NaviLiftEntry_BOTH)return{related:!0,dist:Math.abs(r-n)}}else if(n<r)return{related:!0,dist:Math.abs(r-n)}}else if(r<n)return{related:!0,dist:Math.abs(r-n)}}return{related:!1,dist:1/0}}},{key:"getLiftByFlag",value:function(e){0==this._lifts.length&&(this._lifts=this._naviGraph.getAllLifts());for(var t=0;t<this._lifts.length;t++)if(this._lifts[t].liftFlag==e)return this._lifts[t];return null}},{key:"containsPt",value:function(e){var t=this._naviGraph.obstructExtents[0].points;return!!l.default.pointInPolygon2d(t,e,t.length)}},{key:"getRouteCalculateResult",value:function(){return this._resultVector}},{key:"dispose",value:function(){this._startModel=null,this._endModel=null,this._naviGraph.dispose(),this._naviGraph=null,this._zoneMap.clear(),this._zoneMap=null,this._zoneIdGraph.each((function(e,t){t.dispose()})),this._zoneIdGraph.clear(),this._zoneIdGraph=null,null!=this._originDijkstra&&(this._originDijkstra.dispose(),this._originDijkstra=null),this._zoneIdDijkstras.each((function(e,t){t.dispose()})),this._zoneIdDijkstras.clear(),this._zoneIdDijkstras=null,this._resultVector=[],this._startNode=null,this._endNode=null,this._zonePNTModelsMap.clear(),this._zonePNTModelsMap=null,this._zoneNPModelsMap.clear(),this._zoneNPModelsMap=null,this._modelIdRoadsMap.clear(),this._zoneNPModelsMap=null,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"reset",value:function(){this._resultVector=[],this._clearTempPoint(this._startZoneId),this._startZoneId=Number.INT_MIN,this._clearTempPoint(this._endZoneId),this._endZoneId=Number.INT_MIN,this._clearTempAdjList(),this._tmp_adj_node_ids=[],this._tmpId=-1;for(var e=0;e<this._variableModelPairs.length;e++){var t=this._variableModelPairs[e];this._switchVariableHinderTo(t.zoneId,t.model,c.default.NaviRoadHinderType_HINDER_HIGH)}this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"pushNext",value:function(e){this._next.enqueue(e)}},{key:"getNext",value:function(){return this._next.peek()}},{key:"popNext",value:function(){return this._next.dequeue()}},{key:"_createGraph",value:function(){function e(e){for(var t=0,n=0;n<e.length-1;n++){var r=e[n].point.x-e[n+1].point.x,i=e[n].point.y-e[n+1].point.y;t+=Math.sqrt(r*r+i*i)}return t}this.keyGraph=[];var t=this;this._KeyNodes.foreach((function(n){var r=n.get("node");(n=t._KeyNodes.clone()).dropLines({node:r});var i=[];n.foreach((function(e){i.push(e.get("id"))})),t._zoneIdDijkstras.get(-1).routeMultiDestinations(r.Id,i,t._mode);var o=[];t._zoneIdDijkstras.get(-1).getMultiRoute(o);for(var a=0;a<o.length;a++){var s=o[a];t.keyGraph.push([r.Id,s[s.length-1].Id,e(s),s])}}))}},{key:"computeKeyRoutes",value:function(){if(this.getNext()){var e=this.predictLift();if(!e)return!1;this.setEnd(e)}var t=[];if(this._visited){var n=this._KeyNodes.query("node",this._endNode),r=this._KeyNodes.query("node",this._startNode);this._KeyNodes.clear(),this._KeyNodes.append(n),this._KeyNodes.append(r)}else for(var i=0;i<this._transitNodes.length;i++)t.push(this._transitNodes[i].Id);return this._createGraph(),(r=new _.default(this.keyGraph)).setSId(this._startNode.Id).setEId(this._endNode.Id).setWayNodes(t),r.route(),this._route=r.getResult(),this.convertRoute(),this.getNext()&&this.getNext().setStart(this.getNext()._naviGraph.getNodeByFlag(e.liftFlag)),this._KeyNodes=new x.default(["num","id","idx","node"]),this._visited=!0,!0}},{key:"convertRoute",value:function(){this._result=[];for(var e=function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){for(var n=0;n<this.length;n++)if(this[n][0]==e&&this[n][1]==t)return this[n]})),t=0;t<this._route.route.length-1;t++)for(var n=this._route.route[t],r=this._route.route[t+1],i=e.apply(this.keyGraph,[n,r]),o=0;o<i[3].length;o++)this._result.push(i[3][o])}},{key:"getResult",value:function(){return this._result}},{key:"route",get:function(){this._route}},{key:"_calcPointReachable",value:function(e){var t=this._naviGraph.queryContainExtentId(e);if(-1==t)return null;var n=this._calcZoneIdByCoord(e),r=-0,i=this._zoneIdGraph.get(n).findModel(e,r);if(null==i)return{extentId:t,model:null};if(i.pass==c.default.NaviModelPassType_PASS_THROUGH||i.pass==c.default.NaviModelPassType_PASS_NOT_THROUGH){if(0<i.doors.length)return{extentId:t,model:i};for(var o={},a=[],s=[],u=(r=this._zoneIdGraph.get(n)).roadVector,h=!0,f=i.points.length,d=0;d<f-1;d++)for(var p=i.points[d],g=i.points[d+1],m=0;m<u.length;m++){var v=u[m];1==l.default.calcCrossPoint(p,g,v.startPoint,v.endPoint,o)&&(h=!1,c.default.NaviRoadEntry_FORBID!=v.roadEntry&&((v=new Object).x=o.x,v.y=o.y,a.push(v),s.push(u[m])))}if(h)return{extentId:t,model:i};if(0==a.length)return null;i.doors=[],i.doorEntrys=[],i.doorTypes=[];for(var y=0;y<a.length;y++){var _=a[y],x=s[y];(_=this._insertNodeToRoad(n,_,x)).nodeType=c.default.NaviNodeType_COMMON,x.roadEntry==c.default.NaviRoadEntry_BOTH?_.entranceType=c.default.NaviEntranceType_ACCESS:l.default.pointInPolygon2d(i.points,x.startPoint,i.points.length-1)?(x.roadEntry==c.default.NaviRoadEntry_FORWARD&&(_.entranceType=c.default.NaviEntranceType_EXIT),x.roadEntry==c.default.NaviRoadEntry_BACK&&(_.entranceType=c.default.NaviEntranceType_ENTRANCE)):(x.roadEntry==c.default.NaviRoadEntry_FORWARD&&(_.entranceType=c.default.NaviEntranceType_ENTRANCE),x.roadEntry==c.default.NaviRoadEntry_BACK&&(_.entranceType=c.default.NaviEntranceType_EXIT)),i.doors.push(_),i.doorEntrys.push(_.entranceType),i.doorTypes.push(_.nodeType)}}return i.pass!=c.default.NaviModelPassType_NOT_PASS?{extentId:t,model:i}:null}},{key:"_processStartPoint",value:function(e,t){var n=this;this._startNode=this._insertTmpIsolatedNode(this._startZoneId,e);var r=null,i=!0;if(r=null!=this._startModel&&this._startModel.pass==c.default.NaviModelPassType_PASS_THROUGH&&0==this._startModel.doors.length?this._seekNearRoads(this._startZoneId,e,t,30,this._startModel):this._seekNearRoads(this._startZoneId,e,t),null==this._startModel&&(i=!1),0<r.size()){i=!1,r.each((function(e,t,n){for(n=0;n<t.length;n++)0!=t[n].road.roadEntry&&(i=!0)}));var o=0,s=!1,u=[];if(r.each((function(t,r){var i=r[0].road;0==(r=n._exploreUprightLikelyJoints(n._startZoneId,e,i,r,n._startModel)).length?o++:Math.abs(r[0].rotateAngle)>l.default.epsilon()?u.push.apply(u,(0,a.default)(r)):(s=!0,r=n._insertTempNodeToRoad(n._startZoneId,r[0].cross,r[0].road),n._joinTwoNodes(n._startZoneId,n._startNode,r))})),s||u.forEach((function(e){e=n._insertTempNodeToRoad(n._startZoneId,e.cross,e.road),n._joinTwoNodes(n._startZoneId,n._startNode,e)})),o==r.size())return y.default.ROUTE_FAILED_NO_DATA_START}if(i){for(var h=null,f=!1,d=0;d<this._startModel.doors.length;d++){h=this._startModel.doors[d];var p=this._startModel.doorEntrys[d];p!=c.default.NaviEntranceType_EXIT&&p!=c.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._startZoneId,this._startNode,h),f=!0)}if(!f)return y.default.ROUTE_FAILED_NO_DATA_START}}},{key:"_processEndPoint",value:function(e,t){var n=this;this._endNode=this._insertTmpIsolatedNode(this._endZoneId,e);var r=null,i=!0;if(r=null!=this._endModel&&this._endModel.pass==c.default.NaviModelPassType_PASS_THROUGH&&0==this._endModel.doors.length?this._seekNearRoads(this._endZoneId,e,t,30,this._endModel):this._seekNearRoads(this._endZoneId,e,t),null==this._endModel&&(i=!1),0<r.size()){i=!1,r.each((function(e,t,n){for(n=0;n<t.length;n++)0!=t[n].road.roadEntry&&(i=!0)}));var o=0,s=!1,u=[];if(r.each((function(t,r){var i=r[0].road;0==(r=n._exploreUprightLikelyJoints(n._endZoneId,e,i,r,n._endModel)).length?o++:Math.abs(r[0].rotateAngle)>l.default.epsilon()?u.push.apply(u,(0,a.default)(r)):(s=!0,r=n._insertTempNodeToRoad(n._endZoneId,r[0].cross,r[0].road),n._joinTwoNodes(n._endZoneId,n._endNode,r))})),s||u.forEach((function(e){e=n._insertTempNodeToRoad(n._endZoneId,e.cross,e.road),n._joinTwoNodes(n._endZoneId,n._endNode,e)})),o==r.size())return y.default.ROUTE_FAILED_NO_DATA_END}if(i){for(var h=null,f=!1,d=0;d<this._endModel.doors.length;d++){h=this._endModel.doors[d];var p=this._endModel.doorEntrys[d];p!=c.default.NaviEntranceType_EXIT&&p!=c.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._endZoneId,this._endNode,h),f=!0)}if(!f)return y.default.ROUTE_FAILED_NO_DATA_END}}},{key:"_insertPoint",value:function(e,t){var n=this;e instanceof Array&&2==e.length&&(e={x:e[0],y:e[1]});var r=null,i=!0,s={x:0,y:0},u=this._naviGraph.getModelByPoint(e),h=this._naviGraph.getZoneIdByPoint(e),f=this._insertTmpIsolatedNode(h,e);if((0,o.default)(t,f),r=null!=u&&u.pass==c.default.NaviModelPassType_PASS_THROUGH&&0==u.doors.length?this._seekNearRoads(h,e,s,30,u):this._seekNearRoads(h,e,s),null==u&&(i=!1),0<r.size()){i=!1,r.each((function(e,t,n){for(n=0;n<t.length;n++)0!=t[n].road.roadEntry&&(i=!0)}));var d=0,p=!1,g=[];if(r.each((function(r,i){var o=i[0].road;0==(i=n._exploreUprightLikelyJoints(h,e,o,i,u)).length?d++:Math.abs(i[0].rotateAngle)>l.default.epsilon()?g.push.apply(g,(0,a.default)(i)):(p=!0,i=n._insertTempNodeToRoad(h,i[0].cross,i[0].road),n._joinTwoNodes(h,t,i))})),p||g.forEach((function(e){e=n._insertTempNodeToRoad(h,e.cross,e.road),n._joinTwoNodes(h,t,e)})),d==r.size())return!1}if(i){for(var m=null,v=!1,y=0;y<u.doors.length;y++){m=u.doors[y];var _=u.doorEntrys[y];_!=c.default.NaviEntranceType_EXIT&&_!=c.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(h,t,m),v=!0)}if(!v)return!1}return!0}},{key:"_routeCalculate",value:function(){var e=this._isPointInPNTModel(this._startNode.point);if(e&&(this._switchVariableHinderTo(this._startZoneId,e,c.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._startZoneId,model:e})),(e=this._isPointInPNTModel(this._endNode.point))&&(this._switchVariableHinderTo(this._endZoneId,e,c.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._endZoneId,model:e})),this._resultVector=[],this._startZoneId==this._endZoneId){var t=this._zoneIdDijkstras.get(this._startZoneId);if((r=t.routeCalculate(this._startNode,this._endNode,this._mode))!=y.default.ROUTE_SUCCESS)return r;var n=t.getRouteCalculateResult();this._resultVector=[],n.reverse(),(r=this._resultVector).push.apply(r,(0,a.default)(n))}else{if(-1!=this._startZoneId&&-1==this._endZoneId){if(t=this._findNearZoneDoor(this._startNode.point,this._startZoneId,c.default.NaviEntranceType_EXIT),(n=(r=this._zoneIdDijkstras.get(this._startZoneId)).routeCalculate(this._startNode,t,this._mode))!=y.default.ROUTE_SUCCESS)return n;var r,i=r.getRouteCalculateResult(i);if((n=(r=this._zoneIdDijkstras.get(-1)).routeCalculate(t,this._endNode,this._mode))!=y.default.ROUTE_SUCCESS)return n;n=r.getRouteCalculateResult(),i.reverse(),n.reverse(),(r=this._resultVector).push.apply(r,(0,a.default)(i)),(i=this._resultVector).push.apply(i,(0,a.default)(n))}if(-1==this._startZoneId&&-1!=this._endZoneId){var o=this._findNearZoneDoor(this._endNode.point,this._endZoneId,c.default.NaviEntranceType_ENTRANCE);if((s=(l=this._zoneIdDijkstras.get(this._endZoneId)).routeCalculate(o,this._endNode,this._mode))!=y.default.ROUTE_SUCCESS)return s;var s,u=l.getRouteCalculateResult();if((s=(l=this._zoneIdDijkstras.get(-1)).routeCalculate(this._startNode,o,this._mode))!=y.default.ROUTE_SUCCESS)return s;(o=l.getRouteCalculateResult()).reverse(),u.reverse(),(s=this._resultVector).push.apply(s,(0,a.default)(o)),(l=this._resultVector).push.apply(l,(0,a.default)(u))}if(-1!=this._startZoneId&&-1!=this._endZoneId){if(s=this._findNearZoneDoor(this._startNode.point,this._startZoneId,c.default.NaviEntranceType_EXIT),(l=(o=this._zoneIdDijkstras.get(this._startZoneId)).routeCalculate(this._startNode,s,this._mode))!=y.default.ROUTE_SUCCESS)return l;var l,h=o.getRouteCalculateResult(h);if(u=this._findNearZoneDoor(this._endNode.point,this._endZoneId,c.default.NaviEntranceType_ENTRANCE),(l=(o=this._zoneIdDijkstras.get(this._endZoneId)).routeCalculate(u,this._endNode,this._mode))!=y.default.ROUTE_SUCCESS)return l;var f=o.getRouteCalculateResult(f);if((l=(o=this._zoneIdDijkstras.get(-1)).routeCalculate(s,u,this._mode))!=y.default.ROUTE_SUCCESS)return l;l=o.getRouteCalculateResult(),h.reverse(),l.reverse(),f.reverse(),(o=this._resultVector).push.apply(o,(0,a.default)(h)),(h=this._resultVector).push.apply(h,(0,a.default)(l)),(l=this._resultVector).push.apply(l,(0,a.default)(f))}}return y.default.ROUTE_SUCCESS}},{key:"_getIndexFormID",value:function(e,t,n){for(var r=0;r<t;r++)if(null!=e[r]&&e[r].Id==n)return r;return-1}},{key:"_calcZoneIdByCoord",value:function(e){for(var t=this._naviGraph.zones,n=0;n<t.length;n++){var r=t[n];if(r.contain(e))return r.Id}return-1}},{key:"_segmentByZones",value:function(){for(var e=this,t=this._naviGraph.zones,n=0;n<t.length;n++){var r=t[n],i=this._sliceGraph(this._naviGraph,r);this._zoneIdGraph.put(r.Id,i)}this._zoneIdGraph.put(-1,this._naviGraph),this._zoneIdGraph.each((function(t,n){n.simplify(),e._zoneIdDijkstras.put(t,new m.default(n))})),this._zoneIdGraph.each((function(e,t){t.consoleNodeInfos(),t.consoleRoadInfos()}))}},{key:"_sliceGraph",value:function(e,t){if(e&&t){for(var n,r=0,i=0,a=e.roadVector.length,s=e.nodeVector.length,u=e.roadVector,l=e.nodeVector,h=0,f=new Int8Array(a),g=0;g<a;g++)u[g]&&u[g].roadEntry!=c.default.NaviRoadEntry_FORBID&&(n=u[g],r=t.contain(n.startPoint),i=t.contain(n.endPoint),0==r&&0==i||(h=!0),1==r&&1==i&&(f[g]=1),1==r&&0==i&&(f[g]=2),0==r&&1==i&&(f[g]=3),0==r&&0==i&&(f[g]=4),2==r&&0==i&&(f[g]=6),2==r&&1==i&&(f[g]=7),0==r&&2==i&&(f[g]=8),1==r&&2==i&&(f[g]=9));if(0==h)return null;for(var m,y,_,x,A,I,w=new Array(s),b=new Array(a),C=0,M=new Int8Array(s),E=0,T=N=f.length;E<T;E++)0!=f[E]&&6!=f[E]&&8!=f[E]&&1!=f[E]&&u[E]&&(y=(m=u[E]).roadEntry,A=[m.Id],2==f[E]||9==f[E]?(_=null,_=2==f[E]?t.calcCrossPoint(m.startPoint,m.endPoint):(0,o.default)({},m.endPoint),(I=new d.default).Id=this._naviGraph.generateNodeId(),I.nodeType=c.default.NaviNodeType_COMMON,I.liftType=c.default.NaviLiftType_NULL,I.entranceType=c.default.NaviEntranceType_ACCESS,I.point=(0,o.default)({},_),(x=new p.default).setRoad(m),x.Id=this._naviGraph.generateRoadId(),A.push(x.Id),I.segLinks=A,(_=new d.default).setNode(I),y==c.default.NaviRoadEntry_FORWARD?_.entranceType=c.default.NaviEntranceType_EXIT:y==c.default.NaviRoadEntry_BACK&&(_.entranceType=c.default.NaviEntranceType_ENTRANCE),t._linkAccessNodes.push(_),C=this._getIndexFormID(l,s,x.endId),x.endPoint=(0,o.default)({},_.point),x.pointVector[1]=(0,o.default)({},_.point),x.endId=_.Id,x.calcLength(),b[E]=x,w[C]=_,w[C=this._getIndexFormID(l,s,x.startId)]=l[C],w[C].segLinks.splice(w[C].segLinks.indexOf(m.Id),1,x.Id),(x=new d.default).setNode(I),m.startId=x.Id,m.startPoint=(0,o.default)({},x.point),m.pointVector[0]=(0,o.default)({},x.point),m.calcLength(),l[C].segLinks.splice(l[C].segLinks.indexOf(m.Id),1),l.push(x),M[C]=2):3!=f[E]&&7!=f[E]||(I=null,I=3==f[E]?t.calcCrossPoint(m.startPoint,m.endPoint):(0,o.default)({},m.startPoint),(x=new d.default).Id=this._naviGraph.generateNodeId(),x.nodeType=c.default.NaviNodeType_COMMON,x.liftType=c.default.NaviLiftType_NULL,x.entranceType=c.default.NaviEntranceType_ACCESS,x.point=(0,o.default)({},I),(I=new p.default).setRoad(m),I.Id=this._naviGraph.generateRoadId(),A.push(I.Id),x.segLinks=A,(A=new d.default).setNode(x),y==c.default.NaviRoadEntry_FORWARD?A.entranceType=c.default.NaviEntranceType_ENTRANCE:y==c.default.NaviRoadEntry_BACK&&(A.entranceType=c.default.NaviEntranceType_EXIT),t._linkAccessNodes.push(A),C=this._getIndexFormID(l,s,I.startId),I.startPoint=(0,o.default)({},A.point),I.pointVector[0]=(0,o.default)({},A.point),I.startId=A.Id,I.calcLength(),b[E]=I,w[C]=A,w[C=this._getIndexFormID(l,s,I.endId)]=l[C],w[C].segLinks.splice(w[C].segLinks.indexOf(m.Id),1,I.Id),(I=new d.default).setNode(x),m.endId=I.Id,m.endPoint=(0,o.default)({},I.point),m.pointVector[1]=(0,o.default)({},I.point),m.calcLength(),l[C].segLinks.splice(l[C].segLinks.indexOf(m.Id),1),l.push(I),M[C]=2));for(var S,L=0,k=N;L<k;L++)1==f[L]&&(S=u[L])&&(b[L]=S,2!=M[C=this._getIndexFormID(l,s,S.startId)]&&(w[C]=l[C],M[C]=1),2!=M[C=this._getIndexFormID(l,s,S.endId)]&&(w[C]=l[C],M[C]=1),u[L]=null);for(var R=0;R<s;R++)1==M[R]&&(l[R]=null);for(var N=new v.default(w,b,!0,1),P=[],O=e.obstructModels,D=0;D<O.length;D++){var F=O[D];F&&this._modelInZone(F,t)&&P.push(F)}return(e=N.obstructModels).push.apply(e,P),N}}},{key:"_assemblePassNotThroughModels",value:function(){var e=this;this._zoneIdGraph.each((function(t,n){for(var r=n.obstructModels,i=0;i<r.length;i++){var o,a=r[i];c.default.NaviModelPassType_PASS_NOT_THROUGH==a.pass&&((o=e._zonePNTModelsMap.get(t))||(o=[],e._zonePNTModelsMap.put(t,o)),o.push(a))}})),this._zonePNTModelsMap.each((function(e,t){for(var n=0;n<t.length;n++)t[n].fid}))}},{key:"_assembleNotPassModels",value:function(){var e=this;this._zoneIdGraph.each((function(t,n){for(var r=n.obstructModels,i=0;i<r.length;i++){var o,a=r[i];c.default.NaviModelPassType_NOT_PASS==a.pass&&((o=e._zoneNPModelsMap.get(t))||(o=[],e._zoneNPModelsMap.put(t,o)),o.push(a))}})),this._zoneNPModelsMap.each((function(e,t){for(var n=0;n<t.length;n++)t[n].fid}))}},{key:"_fitVariableRoadsToModel",value:function(){var e=this;this._zonePNTModelsMap.each((function(t,n){for(var r=e._zoneIdGraph.get(t).roadVector,i=0;i<n.length;i++){for(var o=n[i],a=0;a<r.length;a++){var s=r[a].calcMiddlePoint();l.default.pointInPolygon2d(o.points,s,o.pointCount)&&(r[a].length=r[a].length*e._kScaleVariable,(s=e._modelIdRoadsMap.get(o.Id))||(s=[],e._modelIdRoadsMap.put(o.Id,s)),s.push(r[a]))}e._switchVariableHinderTo(t,o,c.default.NaviRoadHinderType_HINDER_HIGH)}}))}},{key:"_insertWayPoints",value:function(){for(var e=0;e<this._wayPts.length;e++){var t=new d.default;this._insertPoint(this._wayPts[e],t)?(this._transitNodes.push(t),this._KeyNodes.append({num:this._KeyNodes.size(),id:t.Id,idx:this._naviGraph.getIdxByNodeId(t.Id),node:t})):this._failedInsertPts.push(this._wayPts[e])}}},{key:"_adjustNPModelRoads",value:function(){var e=this;this._zoneNPModelsMap.each((function(t,n){for(var r=e._zoneIdGraph.get(t).roadVector,i=0;i<n.length;i++)for(var o=n[i],a=0;a<r.length;a++){var s=r[a],u=s.roadEntry,h=s.calcMiddlePoint();if(l.default.pointInPolygon2d(o.points,h,o.pointCount-1)){if(s.length=Number.MAX_VALUE,u==c.default.NaviRoadEntry_BOTH||u==c.default.NaviRoadEntry_FORWARD){var f=e._zoneIdGraph.get(t).adjList.get(s.startId);if(f)for(var d=0;d<f.length;d++)f[d].nodeId==s.endId&&(f[d].length=s.length)}if(s.roadEntry==c.default.NaviRoadEntry_BOTH||s.roadEntry==c.default.NaviRoadEntry_BACK){var p=e._zoneIdGraph.get(t).adjList.get(s.endId);if(p)for(var g=0;g<p.length;g++)p[g].nodeId==s.startId&&(p[g].length=s.length)}}}}))}},{key:"_switchVariableHinderTo",value:function(e,t,n){var r=this._modelIdRoadsMap.get(t.Id);if(r){if(c.default.NaviRoadHinderType_HINDER_HIGH==n)for(var i=0;i<r.length;i++){var o=r[i];if(o.calcLength(),o.length=r.length*this._kScaleVariable,o.roadEntry==c.default.NaviRoadEntry_BOTH||o.roadEntry==c.default.NaviRoadEntry_FORWARD){var a=this._zoneIdGraph.get(e).adjList.get(o.startId);if(a)for(var s=0;s<a.length;s++)a[s].nodeId==o.endId&&(a[s].length=o.length)}if(o.roadEntry==c.default.NaviRoadEntry_BOTH||o.roadEntry==c.default.NaviRoadEntry_BACK){var u=this._zoneIdGraph.get(e).adjList.get(o.endId);if(u)for(var l=0;l<u.length;l++)u[l].nodeId==o.startId&&(u[l].length=o.length)}}if(c.default.NaviRoadHinderType_HINDER_GENERAL==n)for(var h=0;h<r.length;h++){var f=r[h];if(f.calcLength(),f.roadEntry==c.default.NaviRoadEntry_BOTH||f.roadEntry==c.default.NaviRoadEntry_FORWARD){var d=this._zoneIdGraph.get(e).adjList.get(f.startId);if(d)for(var p=0;p<d.length;p++)d[p].nodeId==f.endId&&(d[p].length=f.length)}if(f.roadEntry==c.default.NaviRoadEntry_BOTH||f.roadEntry==c.default.NaviRoadEntry_BACK){var g=this._zoneIdGraph.get(e).adjList.get(f.endId);if(g)for(var m=0;m<g.length;m++)g[m].nodeId==f.startId&&(g[m].length=f.length)}}}}},{key:"_findNearZoneDoor",value:function(e,t,n){var r=this._naviGraph.getZone(t);if(null==r)return null;for(var i=this._zoneIdGraph.get(t).findModel(e,o),o=i.area,a=Number.MAX_VALUE,s=null,u=0;u<r._linkAccessNodes.length;u++){var h,f=r._linkAccessNodes[u],d=l.default.distanceOfTwoPoints(f.point,e);f.entranceType!=c.default.NaviEntranceType_ACCESS&&f.entranceType!=n||d<a&&((h=this._findMinAreaNearestObstructModel(t,f.point))!=i&&h.pass==c.default.NaviModelPassType_PASS_NOT_THROUGH||(a=d,s=f))}return s}},{key:"_findMinAreaNearestObstructModel",value:function(e,t){for(var n=null,r=(e=this._zoneIdGraph.get(e),Number.MAX_VALUE),i=Number.MAX_VALUE,o=null,a=e.obstructModels,s=0;s<a.length;s++){var u=a[s],c=l.default.pointToPolygon2d(u.points,t,u.points.length-1);c<i&&(i=c,o=u),this._kDoorToler>c&&(c=u.area)<r&&(r=c,n=u)}return null==n?o:n}},{key:"_modelInZone",value:function(e,t){return!e.bb.isSeparate(t.bb)&&(e=e.center,!!l.default.pointInPolygon2d(t.points,e,t.pointCount))}},{key:"_insertTempNodeToRoad",value:function(e,t,n){var r=this._tmp_adj_node_ids.find((function(e){return e==n.startId})),i=this._tmp_adj_node_ids.find((function(e){return e==n.endId}));null==r&&this._tmp_adj_node_ids.push(n.startId),null==i&&this._tmp_adj_node_ids.push(n.endId);for(var o=this._unattachedTempRoadTrees,a=null,s=0;s<o.length;s++)if(o[s]._wrappedRoad==n){a=o[s];break}if(null==a)(a={})._wrappedRoad=n,o.push(a);else for(;null!=a._fromChild;){var u=a._fromChild._wrappedRoad;a=l.default.pointIsInRect1(t,u.startPoint,u.endPoint)?a._fromChild:a._toChild}n=a._wrappedRoad;var h=new d.default;h.Id=this._newTmpId(),h.point=t;var f=new p.default;f.Id=this._newTmpId(),f.startId=n.startId,f.startPoint=n.startPoint,f.endId=h.Id,f.endPoint=h.point,f.pointVector=[n.startPoint,h.point];var g,m=new p.default;return m.Id=this._newTmpId(),m.startId=h.Id,m.startPoint=h.point,m.endId=n.endId,m.endPoint=n.endPoint,m.pointVector=[h.point,n.endPoint],this._unattachedTempRoads.push(f),this._unattachedTempRoads.push(m),(r={})._wrappedRoad=f,(i={})._wrappedRoad=m,a._fromChild=r,a._toChild=i,h.tempType=1,f.tempType=1,m.tempType=1,f.calcLength(),m.calcLength(),f.roadEntry=n.roadEntry,m.roadEntry=n.roadEntry,(i=this._zoneIdGraph.get(e)).nodeVector.push(h),i.roadVector.push(f),i.roadVector.push(m),(e=this._zoneIdDijkstras.get(e)._naviGraph)._nodeMap.put(h.Id,i.nodeVector.length-1),n.roadEntry==c.default.NaviRoadEntry_BOTH&&((i=[]).push({nodeId:n.startId,length:f.length}),i.push({nodeId:n.endId,length:m.length}),e.adjList.put(h.Id,i),(i=e.adjList.get(n.startId))||(i=[],e.adjList.put(n.startId,i)),i.push({nodeId:h.Id,length:f.length}),(i=e.adjList.get(n.endId))||(i=[],e.adjList.put(n.endId,i)),i.push({nodeId:h.Id,length:m.length})),n.roadEntry==c.default.NaviRoadEntry_FORWARD&&((g=[]).push({nodeId:n.endId,length:m.length}),e.adjList.put(h.Id,g),(g=e.adjList.get(n.startId))||(g=[],e.adjList.put(n.startId,g)),g.push({nodeId:h.Id,length:f.length})),n.roadEntry==c.default.NaviRoadEntry_BACK&&((g=[]).push({nodeId:n.startId,length:f.length}),e.adjList.put(h.Id,g),(g=e.adjList.get(n.endId))||(g=[],e.adjList.put(n.endId,g)),g.push({nodeId:h.Id,length:m.length})),h}},{key:"_insertItemToVector",value:function(e,t){for(var n=t.length-1;0<=n;n--)if(t[n].Id&&0<t[n].Id)return t.splice(n+1,0,e),n+1;return-1}},{key:"_insertNodeToRoad",value:function(e,t,n,r){if(r)return this._insertTempNodeToRoad(e,t,n);var i=this._zoneIdGraph.get(e),o=new d.default;o.Id=i.generateNodeId(),o.point=t;var a,s=new p.default;return s.Id=i.generateRoadId(),s.startId=n.startId,s.startPoint=n.startPoint,s.endId=o.Id,s.endPoint=o.point,s.pointVector=[n.startPoint,o.point],(r=new p.default).Id=i.generateRoadId(),r.startId=o.Id,r.startPoint=o.point,r.endId=n.endId,r.endPoint=n.endPoint,r.pointVector=[o.point,n.endPoint],(e=[]).push(s.Id),e.push(r.Id),o.segLinks=e,s.calcLength(),r.calcLength(),s.roadEntry=n.roadEntry,r.roadEntry=n.roadEntry,t=i.nodeVector,e=i.roadVector,t=this._insertItemToVector(o,t),this._insertItemToVector(s,e),this._insertItemToVector(r,e),i._nodeMap.put(o.Id,t),n.roadEntry==c.default.NaviRoadEntry_BOTH&&((t=[]).push({nodeId:n.startId,length:s.length}),t.push({nodeId:n.endId,length:r.length}),i.adjList.put(o.Id,t),(t=i.adjList.get(n.startId))||(t=[],i.adjList.put(n.startId,t)),t.push({nodeId:o.Id,length:s.length}),(t=i.adjList.get(n.endId))||(t=[],i.adjList.put(n.endId,t)),t.push({nodeId:o.Id,length:r.length})),n.roadEntry==c.default.NaviRoadEntry_FORWARD&&((a=[]).push({nodeId:n.endId,length:r.length}),i.adjList.put(o.Id,a),(a=i.adjList.get(n.startId))||(a=[],i.adjList.put(n.startId,a)),a.push({nodeId:o.Id,length:s.length})),n.roadEntry==c.default.NaviRoadEntry_BACK&&((a=[]).push({nodeId:n.startId,length:s.length}),i.adjList.put(o.Id,a),(a=i.adjList.get(n.endId))||(a=[],i.adjList.put(n.endId,a)),a.push({nodeId:o.Id,length:r.length})),o}},{key:"_clearTmpPoint",value:function(e){if(null!=e){for(var t=this._zoneIdGraph.get(e),n=t.nodeVector.length-1;0<=n;n--){var r=t.nodeVector[n];if(null==r||0<=r.Id)break;t.nodeVector.splice(n,1)}for(var i=t.roadVector.length-1;0<=i;i--){var o=t.roadVector[i];if(null==o||0<=o.Id)break;t.roadVector.splice(i,1)}}}},{key:"_deleteTmpConnectionEntirely",value:function(e,t){var n=e.get(t);if(n)for(var r=0;r<n.length;r++)n[r].nodeId<0&&(n.splice(r,1),r--)}},{key:"_removeConnection",value:function(e,t){for(var n=e.get(t),r=0;r<n.length;r++)this._deleteTmpConnectionEntirely(e,n[r].nodeId);e.remove(t)}},{key:"_calcAdherenceAtAngle",value:function(e,t,n,r,i,a){i.toDistance=Number.MAX_VALUE,i.stickToRoad=!1,i.rotateAngle=0;for(var s=Number.MAX_VALUE,u={},h=this._zoneIdGraph.get(e),f=0;f<h.roadVector.length;f++){var d,p=h.roadVector[f];null!=p&&(d=l.default.rayCrossSegment(t,n,p.startPoint,p.endPoint,u))&&(d=l.default.distanceOfTwoPoints(t,u))<s&&(s=d,i.cross=(0,o.default)({},u),i.distance=s,i.road=p,i.stickToRoad=!0)}h=this._zoneIdGraph.get(-1);for(var g={},m=0;m<h.obstructModels.length;m++){var v=h.obstructModels[m];if(null!=v&&v!=a&&c.default.NaviModelPassType_DECORATE!=v.pass&&(null==a||!l.default.pointInPolygon2d(v.points,a.center,v.points.length-1)))for(var y=v.points.length,_=0;_<y-1;_++){var x=l.default.rayCrossSegment(t,n,v.points[_],v.points[_+1],g);if(x&&(x=l.default.distanceOfTwoPoints(t,g))<s)return s=x,i.model=v,i.distance=Number.MAX_VALUE,i.stickToRoad=!1,i.obstructType=c.default.NaviObstructType_MODEL,!1}}for(var A={},I=h.obstructExtents,w=0;w<I.length;w++){for(var b=I[w],C=I[w].holes,M=0;M<C.length;M++)for(var E=C[M],T=0;T<E.length-1;T++){var S=l.default.rayCrossSegment(t,n,E[T],E[T+1],A);if(S&&(S=l.default.distanceOfTwoPoints(t,A))<s)return s=S,i.model=b,i.distance=Number.MAX_VALUE,i.stickToRoad=!1,i.obstructType=c.default.NaviObstructType_EXTENT,!1}for(var L=I[w].points,k=0;k<L.length-1;k++){var R=l.default.rayCrossSegment(t,n,L[k],L[k+1],A);if(R&&(R=l.default.distanceOfTwoPoints(t,A))<s)return s=R,i.model=b,i.distance=Number.MAX_VALUE,i.stickToRoad=!1,i.obstructType=c.default.NaviObstructType_EXTENT,!1}}return i.toDistance=l.default.distanceOfTwoPoints(i.cross,r),!0}},{key:"_adherenceCompare",value:function(e,t){return e.toDistance-t.toDistance}},{key:"_adherenceAngleCompare",value:function(e,t){return t.rotateAngle-e.rotateAngle}},{key:"_clearTempPoint",value:function(e){if(e=this._zoneIdGraph.get(e)){for(var t=e.nodeVector,n=t.length-1;0<=n;n--){var r=t[n];if(null==r||0<=r.Id)break;t.splice(n,1)}for(var i=e.roadVector,o=i.length-1;0<=o;o--){var a=i[o];if(null==a||0<=a.Id)break;i.splice(o,1)}}}},{key:"_clearTempAdjList",value:function(){var e=this;this._zoneIdDijkstras.each((function(t,n){for(var r=[],i=n._naviGraph.adjList,o=0;o<i.keys.length;o++)i.keys[o]<0&&r.push(i.keys[o]);for(var a=0;a<r.length;a++)e._removeConnection(n._naviGraph.adjList,r[a]);for(var s=0;s<e._tmp_adj_node_ids.length;s++)e._deleteTmpConnectionEntirely(i,e._tmp_adj_node_ids[s])}))}},{key:"_exploreUprightLikelyJoints",value:function(e,t,n,r,i){for(var o=[],a=0;a<r.length;a++)if(r[a].distance<l.default.epsilon())return o.push(r[a]),o;var s={x:0,y:0};if(l.default.calcFootOfUpright(t,n.startPoint,n.endPoint,s)&&this._isTwoPointsConnectedDirectly(t,s,{},i))return(i={}).cross=s,i.stickToRoad=!0,i.road=n,i.rotateAngle=0,i.dist=l.default.distanceOfTwoPoints(t,s),o.push(i),o;for(var u={x:s.x-t.x,y:s.y-t.y},c=0;c<r.length;c++){var h=r[c],f={x:h.cross.x-t.x,y:h.cross.y-t.y};f=270<(f=l.default.calcRotateAngle(f,u))?f-360:f,h.rotateAngle=f}r.sort(this._adherenceAngleCompare);var d=null,p=null;if(r[r.length-1].rotateAngle<0)return d=r[r.length-1],o.push(d),o;for(var g=0;g<r.length;g++)if(0<=r[g].rotateAngle)return d=r[g],0==g?o.push(d):(p=r[g-1],l.default.distanceOfTwoPoints(d.cross,n.startPoint)>l.default.distanceOfTwoPoints(p.cross,n.startPoint)?(o.push(p),o.push(d)):(o.push(d),o.push(p))),o;return o}},{key:"_calcAllAdherance",value:function(e,t,n,r,i,o){for(var a=i||30,s=0;s<360;s+=a){var u=new f.default;this._calcAdherenceAtAngle(e,t,s,n,u,o),1==u.stickToRoad&&r.push(u)}r.sort(this._adherenceCompare)}},{key:"_seekNearRoads",value:function(e,t,n,r,i){var o=new g.default,a=[];for(this._calcAllAdherance(e,t,n,a,r,i);0!=a.length;){var s=a[0],u=o.get(s.road.Id);u?u.push(s):((u=[]).push(s),o.put(s.road.Id,u)),a.splice(0,1)}return o}},{key:"_insertTmpIsolatedNode",value:function(e,t){var n=new d.default;return n.Id=this._newTmpId(),n.point=(0,o.default)({},t),(t=this._zoneIdGraph.get(e)).nodeVector.push(n),(e=this._zoneIdDijkstras.get(e))._naviGraph._nodeMap.put(n.Id,t.nodeVector.length-1),n}},{key:"_insertIsolatedNode",value:function(e,t,n){return n?this._insertTmpIsolatedNode(e,t):((n=new d.default).Id=this._naviGraph.generateNodeId(),n.point=(0,o.default)({},t),e=(t=this.zoneIdGraph.get(e)).nodeVector,e=this._insertItemToVector(n,e),t._nodeMap.put(n.Id,e),n)}},{key:"_isTwoPointsConnectedDirectly",value:function(e,t,n,r){for(var i=this._zoneIdGraph.get(-1),o=null,a=0;a<i.obstructModels.length;a++)if(null!=(o=i.obstructModels[a])&&o!=r&&c.default.NaviModelPassType_DECORATE!=o.pass)for(var s=o.points,u=0;u<s.length-1;u++)if(l.default.calcCrossPoint(e,t,s[u],s[u+1],n)){var h=l.default.distanceOfTwoPoints(e,n),f=l.default.distanceOfTwoPoints(t,n);if(!(h<=l.default.epsilon()||f<=l.default.epsilon()))return!1}for(var d=i.obstructExtents,p=0;p<d.length;p++){for(var g=d[p],m=g.holes,v=0;v<m.length;v++)for(var y=m[v],_=0;_<y.length-1;_++)if(l.default.calcCrossPoint(e,t,y[_],y[_+1],n))return!1;for(var x=g.points,A=0;A<x.length-1;A++)if(l.default.calcCrossPoint(e,t,x[A],x[A+1],n))return!1}return!0}},{key:"_joinTwoNodes",value:function(e,t,n,r,i,o){for(var a=0;a<this._attachedTempRoads.length;a++){var s=this._attachedTempRoads[a],u={};if(1==l.default.calcCrossPoint(s.startPoint,s.endPoint,t.point,n.point,u)&&l.default.distanceOfTwoPoints(t.point,u)>l.default.epsilon()&&l.default.distanceOfTwoPoints(n.point,u)>l.default.epsilon())return null}void 0===r&&(r=c.default.NaviRoadEntry_BOTH),void 0===i&&(i=!0),void 0===o&&(o=!0);var h,f,d=new p.default;return d.startId=t.Id,d.startPoint=t.point,d.endId=n.Id,d.endPoint=n.point,d.pointVector=[t.point,n.point],this._tmp_adj_node_ids.push(t.Id),this._tmp_adj_node_ids.push(n.Id),d.Id=i?this._newTmpId():this._naviGraph.generateRoadId(),d.roadEntry=r,d.calcLength(),o&&this._attachedTempRoads.push(d),(o=this._zoneIdGraph.get(e)).roadVector.push(d),o=this._zoneIdDijkstras.get(e),c.default.NaviRoadEntry_BOTH==r&&(e={nodeId:n.Id,length:d.length},(h=o._naviGraph.adjList.get(t.Id))?h.push(e):((h=[]).push(e),o._naviGraph.adjList.put(t.Id,h)),e={nodeId:t.Id,length:d.length},(h=o._naviGraph.adjList.get(n.Id))?h.push(e):((h=[]).push(e),o._naviGraph.adjList.put(n.Id,h))),c.default.NaviRoadEntry_FORWARD==r&&(h={nodeId:n.Id,length:d.length},(f=o._naviGraph.adjList.get(t.Id))?f.push(h):((f=[]).push(h),o._naviGraph.adjList(t.Id,f))),c.default.NaviRoadEntry_BACK==r&&(r={nodeId:t.Id,length:d.length},(f=o._naviGraph.adjList.get(n.Id))?f.push(r):((f=[]).push(r),o._naviGraph.adjList.put(n.Id,f))),d}},{key:"_isPointInPNTModel",value:function(e){var t=this._calcZoneIdByCoord(e),n=this._zonePNTModelsMap.get(t);if(n)for(var r=0;r<n.length;r++){var i=n[r];if(l.default.pointInPolygon2d(i.points,e,i.points.length))return i}return null}},{key:"_newTmpId",value:function(){return this._tmpId--}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(32),n(31),n(51);var o=i(n(2)),a=i(n(3)),s=i(n(50)),u=function(){function e(t){(0,o.default)(this,e),this.adj=t||[]}return(0,a.default)(e,[{key:"has",value:function(e){for(var t in this.adj)if(e==t[0])return!0;return!1}},{key:"weight",value:function(e){if(null==e)return null;for(var t in this.adj)if(e==this.adj[t][0])return this.adj[t][1];return null}},{key:"append",value:function(e){this.adj.push(e)}}]),e}();n=function(){function e(t){for(var n in(0,o.default)(this,e),this._adjTable=new s.default,t){var r=t[n][0];t[n][1],t[n][2],this._adjTable.has(r)||this._adjTable.put(r,new u);for(var i=[],a=1;a<t[n].length;a++)i.push(t[n][a]);this._adjTable.get(r).append(i)}}return(0,a.default)(e,[{key:"get",value:function(e){return this._adjTable.has(e)?this._adjTable.get(e):null}},{key:"lookup",value:function(e,t){return this._adjTable.has(e)?(e=this._adjTable.get(e)).weight(t):null}},{key:"keys",value:function(){return this._adjTable.keys}},{key:"enhance",value:function(e,t,n){n=n||[];for(var r,i,o=this.keys(),a=1/0,s={dist:1/0,transit:null},u=0;u<o.length;u++)-1==n.indexOf(o[u])&&(r=this.lookup(e,o[u]),i=this.lookup(o[u],t),null!=r&&null!=i&&r+i<a&&(s={dist:r+i,transit:o[u]},a=r+i));return s}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(16);var o=i(n(2)),a=i(n(3)),s=function(){function e(t){if((0,o.default)(this,e),t instanceof Number){this._num=t,this._array=[];for(var n=0;n<t;n++)this._array.push(null)}if(t instanceof Array)for(this._names=t,this._array=[],n=0;n<t.length;n++)this._array.push(null)}return(0,a.default)(e,[{key:"size",value:function(){return this._array.length}},{key:"set",value:function(e,t){if(e<0||e>=this.size())throw"positon is out of bounder";this._array[e]=t}},{key:"get",value:function(e){var t=e;return"string"==typeof e&&(t=this._names.indexOf(e)),this._array[t]}},{key:"toArray",value:function(){for(var e=[],t=0;t<this._array.length;t++)e.push(this._array[t]);return e}},{key:"equals",value:function(e){if(this._array.length!=e._array.length)return!1;if(this._names.length!=e._names.length)return!1;for(var t=0;t<this._names.length;t++)if(this._names[t]!=e._names[t])return!1;return!0}},{key:"clone",value:function(){for(var t=0==this._names.length?new e(this._array.length):new e(this._names),n=0;n<this._array.length;n++)t._array[n]=this._array[n];return t}}]),e}();n=function(){function e(t){(0,o.default)(this,e),this._names=t,this._table=[]}return(0,a.default)(e,[{key:"append",value:function(e){if(e instanceof s){if(!new s(e._names).equals(e))throw"the appended item is not compatible to the TupleTable";this._table.push(e)}else{var t,n=new s(this._names);for(t in e){var r=this._names.indexOf(t);0<=r&&n.set(r,e[t])}this._table.push(n)}}},{key:"query",value:function(e,t){for(var n=0;n<this._table.length;n++){var r=this._table[n];if(r.get(e)==t)return r}return null}},{key:"foreach",value:function(e,t){t=t||-1;for(var n=0;n<this._table.length;n++)e(t<0?this._table[n]:this._table[n].get(t))}},{key:"size",value:function(){return this._table.length}},{key:"clone",value:function(){for(var t=new e(this._names),n=0;n<this._table.length;n++)t.append(this._table[n].clone());return t}},{key:"dropLines",value:function(e){for(var t=0;t<this._table.length;t++){var n,r=!0;for(n in e)if(this._table[t].get(n)!=e[n]){r=!1;break}r&&(this._table.splice(t,1),t--)}}},{key:"clear",value:function(){this._table=[]}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(24),i=n(122),o=n(36),a=n(46),s=n(17),u=[].slice;r(r.P+r.F*n(7)((function(){i&&u.call(i)})),"Array",{slice:function(e,t){var n=s(this.length),r=o(this);if(t=void 0===t?n:t,"Array"==r)return u.call(this,e,t);for(var i=a(e,n),l=(n=a(t,n),s(n-i)),c=new Array(l),h=0;h<l;h++)c[h]="String"==r?this.charAt(i+h):this[i+h];return c}})},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(48)),a=i(n(2)),s=i(n(3)),u=i(n(146)),l=i(n(264)),c=(n=n(147)).SmallQueue;n=function(){function e(t,n,r,i){(0,a.default)(this,e),this._startPt=t,this._endPt=n,this._passPts=r,this._dijkCollection=i,this._failedInsertedPts={}}return(0,s.default)(e,[{key:"_refreshPts",value:function(){var e,t={};for(e in this._passPts)for(var n=this._passPts[e],r=0;r<n.length;r++){var i=n[r],o=this._dijkCollection.getDijkByPoint(e,{x:i[0],y:i[1]});o?(t[o.Id]||(t[o.Id]=[]),t[o.Id].push(i)):(null==(o=this._failedInsertedPts[e])&&(this._failedInsertedPts[e]=[]),this._failedInsertedPts[e].push(i))}this._passPts=t}},{key:"_buildGraph",value:function(){this._graph=[];for(var e=0;e<this._dijkCollection.len();e++)for(var t,n,r=this._dijkCollection.get(e),i=0;i<this._dijkCollection.len();i++)e!=i&&(t=this._dijkCollection.get(i),(n=r.hasRelationTo(t)).related&&this._graph.push([r.Id,t.Id,n.dist]))}},{key:"executeCalculation",value:function(){this.reset(),this._buildGraph(),this._refreshPts();var e,t=[];for(e in this._passPts)t.push((0,o.default)(e));var n=this._dijkCollection.getDijkByPoint(this._startPt.groupID,this._startPt).Id,r=this._dijkCollection.getDijkByPoint(this._endPt.groupID,this._endPt).Id,i=new u.default(this._graph);i.setSId(n),i.setEId(r),-1!=(n=t.indexOf(n))&&t.splice(n,1),-1!=(n=t.indexOf(r))&&t.splice(n,1),i.setWayNodes(t),i.route();var a=i.getResult();if(2==a.route.length&&a.route[0]==a.route[1]&&(a.route=[a.route[0]]),a.dist!=1/0){for(var s=[],c=0;c<a.route.length;c++){var h=this._dijkCollection.getDijkById(a.route[c]);if(h.setWayPoints(this._passPts[a.route[c]]),s.push(h),0<h._failedInsertPts.length)for(null==this._failedInsertedPts[h.fid]&&(this._failedInsertedPts[h.fid]=[]),c=0;c<h._failedInsertPts.length;c++)this._failedInsertedPts[h.fid].push(h._failedInsertPts[c])}this._dijkList=new l.default,this._dijkList.load(s),this._dijkList.compute(this._startPt,this._endPt),this._routes=this._dijkList.routes}}},{key:"routes",get:function(){return this._routes},set:function(e){this._routes=e}},{key:"reset",value:function(){this._dijkCollection.each((function(e){e._next=new c,e._startNode=null,e._endNode=null,e._visited=!1,e._transitNodes=[],e._failedInsertPts=[]}))}},{key:"failInsertedPts",get:function(){return this._failedInsertedPts}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e),this._head=null,this.routes=[]}return(0,a.default)(e,[{key:"load",value:function(e){if(0!=e.length){this._head=e[0];for(var t=this._head,n=1;n<e.length;n++)t.pushNext(e[n]),t=e[n];t.pushNext(null)}}},{key:"compute",value:function(e,t){var n=this._head;for(n.setStart(e);n.getNext();){if(n.Id,!n.computeKeyRoutes())return!1;this.routes.push({groupId:n.gid,result:n.getResult()}),n=n.popNext()}n.setEnd(t),n.computeKeyRoutes(),this.routes.push({groupId:n.gid,result:n.getResult()})}}]),e}(),t.default=n},function(e,t,n){e.exports=n(266)},function(e,t,n){n(267),e.exports=Math.pow(2,-52)},function(e,t,n){(n=n(6))(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){e.exports=n(269)},function(e,t,n){n(270);var r=n(4).Object;e.exports=function(e,t){return r.defineProperties(e,t)}},function(e,t,n){var r=n(6);r(r.S+r.F*!n(14),"Object",{defineProperties:n(108)})},function(e,t,n){"use strict";var r,i,o,a,s,u,l,c,h,f=n(0),d=n(1);function p(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}f(t,"__esModule",{value:!0}),t.Matrix4=p,d=d(n(15)),n=n(148),(0,d.default)(p.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,o,a,s,u,l,c,h,f,d,p,g){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=o,m[9]=a,m[13]=s,m[2]=u,m[6]=l,m[10]=c,m[14]=h,m[3]=f,m[7]=d,m[11]=p,m[15]=g,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new p).fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this},copyPosition:function(e){var t=this.elements;return e=e.elements,t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:(h=new n.Vector3,function(e){var t=this.elements,n=e.elements,r=1/h.setFromMatrixColumn(e,0).length(),i=1/h.setFromMatrixColumn(e,1).length();return e=1/h.setFromMatrixColumn(e,2).length(),t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t,n,r,i,o,a,s,u,l,c,h,f,d=this.elements,p=e.x,g=e.y,m=e.z,v=Math.cos(p),y=Math.sin(p),_=Math.cos(g);return p=Math.sin(g),g=Math.cos(m),m=Math.sin(m),"XYZ"===e.order?(o=v*g,a=v*m,s=y*g,u=y*m,d[0]=_*g,d[4]=-_*m,d[8]=p,d[1]=a+s*p,d[5]=o-u*p,d[9]=-y*_,d[2]=u-o*p,d[6]=s+a*p,d[10]=v*_):"YXZ"===e.order?(t=_*g,n=_*m,r=p*g,i=p*m,d[0]=t+i*y,d[4]=r*y-n,d[8]=v*p,d[1]=v*m,d[5]=v*g,d[9]=-y,d[2]=n*y-r,d[6]=i+t*y,d[10]=v*_):"ZXY"===e.order?(t=_*g,n=_*m,r=p*g,i=p*m,d[0]=t-i*y,d[4]=-v*m,d[8]=r+n*y,d[1]=n+r*y,d[5]=v*g,d[9]=i-t*y,d[2]=-v*p,d[6]=y,d[10]=v*_):"ZYX"===e.order?(o=v*g,a=v*m,s=y*g,u=y*m,d[0]=_*g,d[4]=s*p-a,d[8]=o*p+u,d[1]=_*m,d[5]=u*p+o,d[9]=a*p-s,d[2]=-p,d[6]=y*_,d[10]=v*_):"YZX"===e.order?(l=v*_,c=v*p,h=y*_,f=y*p,d[0]=_*g,d[4]=f-l*m,d[8]=h*m+c,d[1]=m,d[5]=v*g,d[9]=-y*g,d[2]=-p*g,d[6]=c*m+h,d[10]=l-f*m):"XZY"===e.order&&(l=v*_,c=v*p,h=y*_,f=y*p,d[0]=_*g,d[4]=-m,d[8]=p*g,d[1]=l*m+f,d[5]=v*g,d[9]=c*m-h,d[2]=h*m-c,d[6]=y*g,d[10]=f*m+l),d[3]=0,d[7]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,this},makeRotationFromQuaternion:(l=new n.Vector3(0,0,0),c=new n.Vector3(1,1,1),function(e){return this.compose(l,e,c)}),lookAt:(a=new n.Vector3,s=new n.Vector3,u=new n.Vector3,function(e,t,n){var r=this.elements;return u.subVectors(e,t),0===u.lengthSq()&&(u.z=1),u.normalize(),a.crossVectors(n,u),0===a.lengthSq()&&(1===Math.abs(n.z)?u.x+=1e-4:u.z+=1e-4,u.normalize(),a.crossVectors(n,u)),a.normalize(),s.crossVectors(u,a),r[0]=a.x,r[4]=s.x,r[8]=u.x,r[1]=a.y,r[5]=s.y,r[9]=u.y,r[2]=a.z,r[6]=s.z,r[10]=u.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],l=n[1],c=n[5],h=n[9],f=n[13],d=n[2],p=n[6],g=n[10],m=n[14],v=n[3],y=n[7],_=n[11],x=n[15],A=r[0],I=r[4],w=r[8],b=r[12],C=r[1],M=r[5],E=r[9],T=r[13],S=r[2],L=r[6],k=r[10],R=r[14];return e=r[3],t=r[7],n=r[11],r=r[15],i[0]=o*A+a*C+s*S+u*e,i[4]=o*I+a*M+s*L+u*t,i[8]=o*w+a*E+s*k+u*n,i[12]=o*b+a*T+s*R+u*r,i[1]=l*A+c*C+h*S+f*e,i[5]=l*I+c*M+h*L+f*t,i[9]=l*w+c*E+h*k+f*n,i[13]=l*b+c*T+h*R+f*r,i[2]=d*A+p*C+g*S+m*e,i[6]=d*I+p*M+g*L+m*t,i[10]=d*w+p*E+g*k+m*n,i[14]=d*b+p*T+g*R+m*r,i[3]=v*A+y*C+_*S+x*e,i[7]=v*I+y*M+_*L+x*t,i[11]=v*w+y*E+_*k+x*n,i[15]=v*b+y*T+_*R+x*r,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:(o=new n.Vector3,function(e){for(var t=0,n=e.count;t<n;t++)o.x=e.getX(t),o.y=e.getY(t),o.z=e.getZ(t),o.applyMatrix4(this),e.setXYZ(t,o.x,o.y,o.z);return e}),determinant:function(){var e,t=(e=this.elements)[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],u=e[13],l=e[2],c=e[6],h=e[10],f=e[14];return e[3]*(+i*s*c-r*u*c-i*a*h+n*u*h+r*a*f-n*s*f)+e[7]*(+t*s*f-t*u*h+i*o*h-r*o*f+r*u*l-i*s*l)+e[11]*(+t*u*c-t*a*f-i*o*c+n*o*f+i*a*l-n*u*l)+(e=e[15])*(-r*a*l-t*s*c+t*a*h+r*o*c-n*o*h+n*s*l)},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],l=r[5],c=r[6],h=r[7],f=r[8],d=r[9],p=r[10],g=r[11],m=r[12],v=r[13],y=r[14],_=r[15],x=d*y*h-v*p*h+v*c*g-l*y*g-d*c*_+l*p*_,A=m*p*h-f*y*h-m*c*g+u*y*g+f*c*_-u*p*_,I=f*v*h-m*d*h+m*l*g-u*v*g-f*l*_+u*d*_,w=m*d*c-f*v*c-m*l*p+u*v*p+f*l*y-u*d*y;if(0!=(e=i*x+o*A+a*I+s*w))return e=1/e,n[0]=x*e,n[1]=(v*p*s-d*y*s-v*a*g+o*y*g+d*a*_-o*p*_)*e,n[2]=(l*y*s-v*c*s+v*a*h-o*y*h-l*a*_+o*c*_)*e,n[3]=(d*c*s-l*p*s-d*a*h+o*p*h+l*a*g-o*c*g)*e,n[4]=A*e,n[5]=(f*y*s-m*p*s+m*a*g-i*y*g-f*a*_+i*p*_)*e,n[6]=(m*c*s-u*y*s-m*a*h+i*y*h+u*a*_-i*c*_)*e,n[7]=(u*p*s-f*c*s+f*a*h-i*p*h-u*a*g+i*c*g)*e,n[8]=I*e,n[9]=(m*d*s-f*v*s-m*o*g+i*v*g+f*o*_-i*d*_)*e,n[10]=(u*v*s-m*l*s+m*o*h-i*v*h-u*o*_+i*l*_)*e,n[11]=(f*l*s-u*d*s-f*o*h+i*d*h+u*o*g-i*l*g)*e,n[12]=w*e,n[13]=(f*v*a-m*d*a+m*o*p-i*v*p-f*o*y+i*d*y)*e,n[14]=(m*l*a-u*v*a-m*o*c+i*v*c+u*o*y-i*l*y)*e,n[15]=(u*d*a-f*l*a+f*o*c-i*d*c-u*o*p+i*l*p)*e,this;if(r="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0",!0===t)throw new Error(r);return console.warn(r),this.identity()},scale:function(e){var t=this.elements,n=e.x,r=e.y;return e=e.z,t[0]*=n,t[4]*=r,t[8]*=e,t[1]*=n,t[5]*=r,t[9]*=e,t[2]*=n,t[6]*=r,t[10]*=e,t[3]*=n,t[7]*=r,t[11]*=e,this},getMaxScaleOnAxis:function(){var e=(n=this.elements)[0]*n[0]+n[1]*n[1]+n[2]*n[2],t=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],n=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(e,t,n))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z;return t=i*o,e=i*a,this.set(t*o+n,t*a-r*s,t*s+r*a,0,t*a+r*s,e*a+n,e*s-r*o,0,t*s-r*a,e*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,u=i*(h=i+i),l=i*(f=o+o),c=i*(d=a+a),h=(t=o*f,i=o*d,o=a*d,a=s*h,s*f),f=s*d,d=(s=n.x,n.y);return n=n.z,r[0]=(1-(t+o))*s,r[1]=(l+f)*s,r[2]=(c-h)*s,r[3]=0,r[4]=(l-f)*d,r[5]=(1-(u+o))*d,r[6]=(i+a)*d,r[7]=0,r[8]=(c+h)*n,r[9]=(i-a)*n,r[10]=(1-(u+t))*n,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:(r=new n.Vector3,i=new p,function(e,t,n){var o=this.elements,a=r.set(o[0],o[1],o[2]).length(),s=r.set(o[4],o[5],o[6]).length(),u=r.set(o[8],o[9],o[10]).length(),l=this.determinant();return l<0&&(a=-a),e.x=o[12],e.y=o[13],e.z=o[14],i.copy(this),l=1/a,e=1/s,o=1/u,i.elements[0]*=l,i.elements[1]*=l,i.elements[2]*=l,i.elements[4]*=e,i.elements[5]*=e,i.elements[6]*=e,i.elements[8]*=o,i.elements[9]*=o,i.elements[10]*=o,t.setFromRotationMatrix(i),n.x=a,n.y=s,n.z=u,this}),makePerspective:function(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),u=2*i/(n-r);return e=(t+e)/(t-e),n=(n+r)/(n-r),r=-(o+i)/(o-i),i=-2*o*i/(o-i),a[0]=s,a[4]=0,a[8]=e,a[12]=0,a[1]=0,a[5]=u,a[9]=n,a[13]=0,a[2]=0,a[6]=0,a[10]=r,a[14]=i,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),u=1/(n-r),l=1/(o-i);return e=(t+e)*s,r=(n+r)*u,i=(o+i)*l,a[0]=2*s,a[4]=0,a[8]=0,a[12]=-e,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-r,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-i,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}})},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(16);var o=(n=i(n(273))).default;function a(e,t){return t.max-e.max}function s(e,t,n,r){this.x=e,this.y=t,this.h=n,this.d=function(e,t,n){for(var r=!1,i=1/0,o=0;o<n.length;o++)for(var a=n[o],s=0,l=a.length,c=l-1;s<l;c=s++){var h=a[s],f=a[c];h[1]>t!=f[1]>t&&e<(f[0]-h[0])*(t-h[1])/(f[1]-h[1])+h[0]&&(r=!r),i=Math.min(i,u(e,t,h,f))}return(r?1:-1)*Math.sqrt(i)}(e,t,r),this.max=this.d+this.h*Math.SQRT2}function u(e,t,n,r){var i=n[0],o=n[1],a=r[0]-i,s=r[1]-o,u=i;return n=o,0===a&&0===s||(1<(o=((e-i)*a+(t-o)*s)/(a*a+s*s))?(u=r[0],n=r[1]):0<o&&(u+=a*o,n+=s*o)),(a=e-u)*a+(s=t-n)*s}n=function(e,t){t=t||1;for(var n=Number.MAX_VALUE,r=Number.MAX_VALUE,i=Number.MIN_VALUE,u=Number.MIN_VALUE,l=0;l<e[0].length;l++){var c=e[0][l];c[0]<n&&(n=c[0]),c[1]<r&&(r=c[1]),c[0]>i&&(i=c[0]),c[1]>u&&(u=c[1])}var h=i-n,f=u-r,d=Math.min(h,f),p=d/2;if(0===d)return[n,r];for(var g=new o(void 0,a),m=n;m<i;m+=d)for(var v=r;v<u;v+=d)g.push(new s(m+p,v+p,p,e));var y=function(e){for(var t=0,n=0,r=0,i=e[0],o=0,a=i.length,u=a-1;o<a;u=o++){var l=i[o],c=i[u],h=l[0]*c[1]-c[0]*l[1];n+=(l[0]+c[0])*h,r+=(l[1]+c[1])*h,t+=3*h}return 0===t?new s(i[0][0],i[0][1],0,e):new s(n/t,r/t,0,e)}(e);for((f=new s(n+h/2,r+f/2,0,e)).d>y.d&&(y=f),g.length;0<g.length;){var _=g.pop();_.d>y.d&&(y=_),_.max-y.d<=t||(p=_.h/2,g.push(new s(_.x-p,_.y-p,p,e)),g.push(new s(_.x+p,_.y-p,p,e)),g.push(new s(_.x-p,_.y+p,p,e)),g.push(new s(_.x+p,_.y+p,p,e)))}return[y.x,y.y]},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));function s(e,t){return e<t?-1:t<e?1:0}n=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:s;if((0,o.default)(this,e),this.data=t,this.length=this.data.length,this.compare=n,0<this.length)for(var r=(this.length>>1)-1;0<=r;r--)this._down(r)}return(0,a.default)(e,[{key:"push",value:function(e){this.data.push(e),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,0<this.length&&(this.data[0]=t,this._down(0)),e}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(e){for(var t=this.data,n=this.compare,r=t[e];0<e;){var i=e-1>>1,o=t[i];if(0<=n(r,o))break;t[e]=o,e=i}t[e]=r}},{key:"_down",value:function(e){for(var t=this.data,n=this.compare,r=this.length>>1,i=t[e];e<r;){var o=1+(e<<1),a=t[o],s=o+1;if(s<this.length&&n(t[s],a)<0&&(o=s,a=t[s]),0<=n(a,i))break;t[e]=a,e=o}t[e]=i}}]),e}(),t.default=n}],r={},e.m=n,e.c=r,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==u(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(e){return t[e]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=150).default;function e(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return n[t].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n,r},"object"==u(n)&&"object"==u(e)?e.exports=s():(o=[],void 0===(a="function"==typeof(i=s)?i.apply(n,o):i)||(e.exports=a))},642:function(e,t,n){var r,i,o,a;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}e=n.nmd(e),a=function(){return t=[function(e,t,n){e.exports=n(79)},function(e,t){e=e.exports={version:"2.6.12"},"number"==typeof __e&&(__e=e)},function(e,t,n){var r=n(37)("wks"),i=n(28),o=n(3).Symbol,a="function"==typeof o;(e=e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t){e=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=e)},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(3),i=n(1),o=n(51),a=n(11),s=n(9),u="prototype",l=function e(t,n,l){var c,h,f,d=t&e.F,p=t&e.G,g=t&e.S,m=t&e.P,v=t&e.B,y=t&e.W,_=p?i:i[n]||(i[n]={}),x=_[u],A=p?r:g?r[n]:(r[n]||{})[u];for(c in p&&(l=n),l)(h=!d&&A&&void 0!==A[c])&&s(_,c)||(f=(h?A:l)[c],_[c]=p&&"function"!=typeof A[c]?l[c]:v&&h?o(f,r):y&&A[c]==f?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t[u]=e[u],t}(f):m&&"function"==typeof f?o(Function.call,f):f,m&&((_.virtual||(_.virtual={}))[c]=f,t&e.R&&x&&!x[c]&&a(x,c,f)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var r=n(14),i=n(52),o=n(33),a=Object.defineProperty;t.f=n(7)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports=!n(12)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(0);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r(e,i.key,i)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(6),i=n(16);e.exports=n(7)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(55),i=n(26);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(15);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==s(e)?null!==e:"function"==typeof e}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){"use strict";var r=n(0),i=n(4);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(82)),a=i(n(8)),s=i(n(88));n=function e(t){(0,a.default)(this,e),this.size=s.default.FMMap_CONTROL_NORMAL,this.position=null,this.offset=new fm.Vector2(0,0),this.imgURL="resource/style/wedgets/img/",(0,o.default)(this,t)},t.default=n},function(e,t){e.exports=function(e){return"object"==s(e)?null!==e:"function"==typeof e}},function(e,t,n){var r=n(58)("wks"),i=n(59),o=n(20).Symbol,a="function"==typeof o;(e=e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t){e=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=e)},function(e,t,n){var r=n(18);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={LEFT_TOP:1,LEFT_BOTTOM:2,RIGHT_TOP:3,RIGHT_BOTTOM:4},t.default=n},function(e,t){e.exports={}},function(e,t,n){var r=n(54),i=n(38);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){e.exports=!0},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(26);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r=n(0),i=n(4);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(40));n(94);var a=i(n(8)),s=i(n(10));n=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,null,[{key:"toColor",value:function(e){if("number"==typeof e)return e;var t=e.split(",");return 3<=t.length?(0,o.default)(t[0])<<16|(0,o.default)(t[1])<<8|(0,o.default)(t[2]):(console.error("color format error",e),0)}},{key:"toRgba",value:function(e){if("number"==typeof e)return"rgba("+(0,o.default)(255*new fm.Color(e).r)+","+(0,o.default)(255*new fm.Color(e).g)+","+(0,o.default)(255*new fm.Color(e).b)+",1)";var t=e.split(",");return 3<=t.length?"rgba("+(0,o.default)(t[0])+","+(0,o.default)(t[1])+","+(0,o.default)(t[2])+",1)":e}},{key:"bindEvent",value:function(e,t,n,r){e.addEventListener(n,(function(e){var n,i=e||window.event,o=i.target||i.srcElement,a=i.currentTarget;for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;0<=--n&&t.item(n)!==this;);return-1<n});o!==a;)o.matches(t)&&(n=o,r.call(n,i)),o=o.parentNode}))}},{key:"toSceneCoord",value:function(e,t){var n=0;return t.groupID&&(n=e.getFMGroup(t.groupID).height),new fm.Vector3(t.x-e.center.x,e.center.y+n,-t.y+e.center.y)}},{key:"removeFormArray",value:function(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)}},{key:"scrollTopAnFun",value:function(){var e,t=!1;return function n(r){var i=r.el,o=r.to,a=r.form,s=(r.time,o<a?"up":"bottom"),u=(a<o?o-a:o==a?0:a-o)/10,l=0,c=function(){t=!1,e=!1,0==a&&(i.scrollTop=0)};t?(e=0,window.setTimeout((function(){var e=Object(r,{to:i.scrollTop});t=!1,n(e)}),11)):(t=!0,e=u,function t(){var n;--e<=0?c():(n=function(){!1!==e&&(l=function(e){var t=e.val,n=e.nbak,r=e.n;return e=e.elTop,"up"==s?e+(n-r)*t:e-(n-r)*t}({val:10,nbak:u,n:e,elTop:o,VDIRECTIONE:s}),l&&(i.scrollTop=l),t())},window.setTimeout(n,10))}())}}},{key:"toVector",value:function(e){return e.hasOwnProperty("z")?new fm.Vector3(e.x,e.y,e.z):new fm.Vector2(e.x,e.y)}},{key:"sleep",value:function(e){for(var t=(new Date).getTime(),n=0;n<1e7&&!((new Date).getTime()-t>e);n++);}}]),e}(),t.default=n},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(15);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t,n){var r=n(37)("keys"),i=n(28);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(1),i=n(3),o="__core-js_shared__",a=i[o]||(i[o]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(27)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){e.exports=n(90)},function(e,t){e=e.exports={version:"2.6.12"},"number"==typeof __e&&(__e=e)},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(42),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},function(e,t,n){"use strict";var r,i=n(100),o=RegExp.prototype.exec,a=String.prototype.replace,s=o,u="lastIndex",l=(r=/a/,n=/b*/g,o.call(r,"a"),o.call(n,"a"),0!==r[u]||0!==n[u]),c=void 0!==/()??/.exec("")[1];(n=l||c)&&(s=function(e){var t,n,r,s,h=this;return c&&(n=new RegExp("^"+h.source+"$(?!\\s)",i.call(h))),l&&(t=h[u]),r=o.call(h,e),l&&r&&(h[u]=h.global?r.index+r[0].length:t),c&&r&&1<r.length&&a.call(r[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(r[s]=void 0)})),r}),e.exports=s},function(e,t,n){var r=n(102),i=n(106);e.exports=n(47)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){e.exports=!n(22)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(6).f,i=n(9),o=n(2)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){t.f=n(2)},function(e,t,n){var r=n(3),i=n(1),o=n(27),a=n(49),s=n(6).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=!o&&r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){var r=n(81);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){e.exports=!n(7)&&!n(12)((function(){return 7!=Object.defineProperty(n(53)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(15),i=n(3).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(9),i=n(13),o=n(86)(!1),a=n(36)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=a&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var r=n(34);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(35),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(41),i=n(20),o="__core-js_shared__",a=i[o]||(i[o]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(96)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){"use strict";var r=n(98)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){"use strict";var r=n(99),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){if("object"!=s(n=n.call(e,t)))throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";n(101);var r,i=n(65),o=n(46),a=n(22),s=n(43),u=n(19),l=n(45),c=u("species"),h=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),f=(r=(n=/(?:)/).exec,n.exec=function(){return r.apply(this,arguments)},2===(n="ab".split(n)).length&&"a"===n[0]&&"b"===n[1]);e.exports=function(e,t,n){var r,d,p=u(e),g=!a((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),m=g?!a((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[c]=function(){return n}),n[p](""),!t})):void 0;g&&m&&("replace"!==e||h)&&("split"!==e||f)||(r=/./[p],m=n(s,p,""[e],(function(e,t,n,i,o){return t.exec===l?g&&!o?{done:!0,value:r.call(t,n,i)}:{done:!0,value:e.call(n,t,i)}:{done:!1}})),n=m[0],d=m[1],i(String.prototype,e,n),o(RegExp.prototype,p,2==t?function(e,t){return d.call(e,this,t)}:function(e){return d.call(e,this)}))}},function(e,t,n){var r=n(20),i=n(41),o=n(46),a=n(65),s=n(66),u="prototype",l=function e(t,n,l){var c,h,f,d=t&e.F,p=t&e.G,g=t&e.P,m=t&e.B,v=p?r:t&e.S?r[n]||(r[n]={}):(r[n]||{})[u],y=p?i:i[n]||(i[n]={}),_=y[u]||(y[u]={});for(c in p&&(l=n),l)h=((f=!d&&v&&void 0!==v[c])?v:l)[c],f=m&&f?s(h,r):g&&"function"==typeof h?s(Function.call,h):h,v&&a(v,c,h,t&e.U),y[c]!=h&&o(y,c,f),g&&_[c]!=h&&(_[c]=h)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var r=n(20),i=n(46),o=n(107),a=n(59)("src"),s=n(108),u="toString",l=(""+s).split(u);n(41).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(u&&(o(n,a)||i(n,a,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,u,(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,n){var r=n(60);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(43);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r=n(64),i=n(111)(1);r(r.P+r.F*!n(116)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){var r=n(117),i=n(121),o=n(151),a=n(152);e.exports=function(e){return r(e)||i(e)||o(e)||a()},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(34);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(11)},function(e,t,n){var r=n(14),i=n(127),o=n(38),a=n(36)("IE_PROTO"),s=function(){},u="prototype",l=function(){var e=n(53)("iframe"),t=o.length;for(e.style.display="none",n(128).appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;t--;)delete l[u][o[t]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[u]=r(e),n=new s,s[u]=null,n[a]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(54),i=n(38).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){"use strict";var r=n(136)(!0);n(76)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e=this._t,t=this._i;return t>=e.length?{value:void 0,done:!0}:(t=r(e,t),this._i+=t.length,{value:t,done:!1})}))},function(e,t,n){"use strict";var r=n(27),i=n(5),o=n(72),a=n(11),s=n(24),u=n(137),l=n(48),c=n(138),h=n(2)("iterator"),f=!([].keys&&"next"in[].keys()),d="keys",p="values",g=function(){return this};e.exports=function(e,t,n,m,v,y,_){u(n,t,m);var x,A,I=function(e){if(!f&&e in M)return M[e];switch(e){case d:case p:return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",b=v==p,C=!1,M=e.prototype,E=M[h]||M["@@iterator"]||v&&M[v],T=E||I(v),S=v?b?I("entries"):T:void 0;if((m="Array"==t&&M.entries||E)&&(e=c(m.call(new e)))!==Object.prototype&&e.next&&(l(e,w,!0),r||"function"==typeof e[h]||a(e,h,g)),b&&E&&E.name!==p&&(C=!0,T=function(){return E.call(this)}),r&&!_||!f&&!C&&M[h]||a(M,h,T),s[t]=T,s[w]=g,v)if(x={values:b?T:I(p),keys:y?T:I(d),entries:S},_)for(A in x)A in M||o(M,A,x[A]);else i(i.P+i.F*(f||C),t,x);return x}},function(e,t,n){e.exports=n(143)},function(e,t,n){"use strict";var r=n(0),i=n(4);r(t,"__esModule",{value:!0}),t.default=void 0;var o,a=i(n(17)),s=i(n(89)),u=i(n(109)),l=i(n(153)),c=i(n(154)),h=(r=i(n(156)),n=i(n(157)),{controlOptions:a.default,FMControlOptions:a.default,zoomControl:s.default,FMZoomControl:s.default,scrollGroupsControl:u.default,FMScrollGroupsControl:u.default,buttonGroupsControl:l.default,FMButtonGroupsControl:l.default,toolControl:c.default,FMToolControl:c.default,FMPopInfoWindow:r.default,FMCompassControl:n.default});for(o in h)h.hasOwnProperty(o)&&(fengmap[o]=h[o]);n=fengmap,t.default=n},function(e,t,n){n(80);var r=n(1).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(5);r(r.S+r.F*!n(7),"Object",{defineProperty:n(6).f})},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){e.exports=n(83)},function(e,t,n){n(84),e.exports=n(1).Object.assign},function(e,t,n){var r=n(5);r(r.S+r.F,"Object",{assign:n(85)})},function(e,t,n){"use strict";var r=n(7),i=n(25),o=n(39),a=n(29),s=n(30),u=n(55),l=Object.assign;e.exports=!l||n(12)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var n=s(e),l=arguments.length,c=1,h=o.f,f=a.f;c<l;)for(var d,p=u(arguments[c++]),g=h?i(p).concat(h(p)):i(p),m=g.length,v=0;v<m;)d=g[v++],r&&!f.call(p,d)||(n[d]=p[d]);return n}:l},function(e,t,n){var r=n(13),i=n(56),o=n(87);e.exports=function(e){return function(t,n,a){var s,u=r(t),l=i(u.length),c=o(a,l);if(e&&n!=n){for(;c<l;)if((s=u[c++])!=s)return!0}else for(;c<l;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(35),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={FMMap_CONTROL_SMALL:"small",FMMap_CONTROL_NORMAL:"normal"},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(4);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(8)),a=i(n(10)),s=i(n(31)),u=i(n(23)),l=i(n(17));n=function(){function e(t,n){(0,o.default)(this,e),this._map=t,this._ctrlOpts=new l.default(n),this._ctrlOpts.offset||(this._ctrlOpts.offset={x:0,y:0}),this._dom=null,this._imgUrl=n.imgURL||"resource/style/wedgets/img/",this.init()}return(0,a.default)(e,[{key:"init",value:function(){var e=this,t=this.createPanel();this._dom=t;var n=this;this.checkPosition(this._ctrlOpts.position,this._ctrlOpts.offset,t),s.default.bindEvent(t,"img","mouseover",(function(e){this.src=this.dataset.on})),s.default.bindEvent(t,"img","mouseout",(function(e){this.src=this.dataset.leave})),s.default.bindEvent(t,"div","click",(function(e){"in"===this.dataset.type?n._map.dollyIn():n._map.dollyOut()})),this._map.on("dispose",(function(n){e._map.getContainer().removeChild(t)}))}},{key:"showZoom",value:function(e){this._dom.style.display=e?"block":"none"}},{key:"createPanel",value:function(){var e=document.createElement("div");return e.setAttribute("class","fm-control-zoom"),e.style.zIndex=20,e.style.position="absolute",e.style.backgroundColor="white",e.style.boxShadow="2px 2px 3px rgba(0,0,0, 0.3)",e.style.borderRadius="2px",e.style.left=0,e.style.top=0,this._map.getContainer().appendChild(e),e.innerHTML=this.createInnerHtml(this._imgUrl+"zoomout.png",this._imgUrl+"zoomout_on.png",this._imgUrl+"zoomin.png",this._imgUrl+"zoomin_on.png"),e}},{key:"createInnerHtml",value:function(e,t,n,r){return'\n       \n            <div data-type="in" style="padding: 14px; cursor: pointer;">\n            <img src='.concat(n," data-leave=").concat(n," data-on=").concat(r,' style="width: 14px; height: 14px;"/>\n             </div>\n            <hr style="height: 1px; border-top: 1px solid rgba(153, 153, 153, 0.45); border-right: none; border-bottom: none; border-left: none; border-image: initial; width: 60%; margin: 0px 20%;">\n            <div data-type="out" style="padding: 14px; cursor: pointer;">\n            <img src=').concat(e," data-leave=").concat(e," data-on=").concat(t,' style="width: 14px; height: 14px;"/>\n            </div>\n        ')}},{key:"checkPosition",value:function(e,t,n){switch(n.style.left="",n.style.right="",n.style.top="",n.style.bottom="",e){case u.default.LEFT_TOP:n.style.left=t.x+"px",n.style.top=t.y+"px";break;case u.default.RIGHT_TOP:n.style.right=-t.x+"px",n.style.top=t.y+"px";break;case u.default.LEFT_BOTTOM:n.style.left=t.x+"px",n.style.bottom=-t.y+"px";break;case u.default.RIGHT_BOTTOM:n.style.right=-t.x+"px",n.style.bottom=-t.y+"px"}}}]),e}(),t.default=n},function(e,t,n){n(91),e.exports=n(1).parseInt},function(e,t,n){var r=n(5);n=n(92),r(r.G+r.F*(parseInt!=n),{parseInt:n})},function(e,t,n){var r=n(3).parseInt,i=n(93).trim,o=(n=n(57),/^[-+]?0[xX]/);e.exports=8!==r(n+"08")||22!==r(n+"0x16")?function(e,t){return e=i(String(e),3),r(e,t>>>0||(o.test(e)?16:10))}:r},function(e,t,n){var r=n(5),i=n(26),o=n(12),a=n(57),s=(n="["+a+"]",RegExp("^"+n+n+"*")),u=RegExp(n+n+"*$"),l=(n=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()}));t=i[e]=s?t(l):a[e],n&&(i[n]=t),r(r.P+r.F*s,"String",i)},n.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(u,"")),e});e.exports=n},function(e,t,n){"use strict";var r=n(95),i=n(21),o=n(97),a=n(61),s=n(44),u=n(62),l=n(45),c=n(22),h=Math.min,f=[].push,d="split",p="length",g="lastIndex",m=4294967295,v=!c((function(){RegExp(m,"y")}));n(63)("split",2,(function(e,t,n,c){var y="c"=="abbc"[d](/(b)*/)[1]||4!="test"[d](/(?:)/,-1)[p]||2!="ab"[d](/(?:ab)*/)[p]||4!="."[d](/(.?)(.?)/)[p]||1<"."[d](/()()/)[p]||""[d](/.?/)[p]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(i,e,t);for(var o,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,d=void 0===t?m:t>>>0,v=new RegExp(e.source,c+"g");(o=l.call(v,i))&&!(h<(a=v[g])&&(u.push(i.slice(h,o.index)),1<o[p]&&o.index<i[p]&&f.apply(u,o.slice(1)),s=o[0][p],h=a,u[p]>=d));)v[g]===o.index&&v[g]++;return h===i[p]?!s&&v.test("")||u.push(""):u.push(i.slice(h)),u[p]>d?u.slice(0,d):u}:"0"[d](void 0,0)[p]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n;return[function(n,r){var i=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):y.call(String(i),n,r)},function(e,t){if((f=c(y,e,this,t,y!==n)).done)return f.value;var r=i(e),l=String(this),f=o(r,RegExp),d=r.unicode,p=(e=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(v?"y":"g"),new f(v?r:"^(?:"+r.source+")",e)),g=void 0===t?m:t>>>0;if(0===g)return[];if(0===l.length)return null===u(p,l)?[l]:[];for(var _=0,x=0,A=[];x<l.length;){p.lastIndex=v?x:0;var I,w=u(p,v?l:l.slice(x));if(null===w||(I=h(s(p.lastIndex+(v?0:x)),l.length))===_)x=a(l,x,d);else{if(A.push(l.slice(_,x)),A.length===g)return A;for(var b=1;b<=w.length-1;b++)if(A.push(w[b]),A.length===g)return A;x=_=I}}return A.push(l.slice(_)),A}]}))},function(e,t,n){var r=n(18),i=n(32),o=n(19)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t){e.exports=!1},function(e,t,n){var r=n(21),i=n(60),o=n(19)("species");e.exports=function(e,t){var n;return void 0===(e=r(e).constructor)||null==(n=r(e)[o])?t:i(n)}},function(e,t,n){var r=n(42),i=n(43);e.exports=function(e){return function(t,n){var o,a=String(i(t)),s=r(n);return t=a.length,s<0||t<=s?e?"":void 0:(n=a.charCodeAt(s))<55296||56319<n||s+1===t||(o=a.charCodeAt(s+1))<56320||57343<o?e?a.charAt(s):n:e?a.slice(s,s+2):o-56320+(n-55296<<10)+65536}}},function(e,t,n){var r=n(32),i=n(19)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?e:o?r(t):"Object"==(e=r(t))&&"function"==typeof t.callee?"Arguments":e}},function(e,t,n){"use strict";var r=n(21);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(45);n(64)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){var r=n(21),i=n(103),o=n(105),a=Object.defineProperty;t.f=n(47)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports=!n(47)&&!n(22)((function(){return 7!=Object.defineProperty(n(104)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(18),i=n(20).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(18);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){e.exports=n(58)("native-function-to-string",Function.toString)},function(e,t,n){"use strict";var r=n(0),i=n(4);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(40));n(110),n(68);var a,s=i(n(69)),u=i(n(8)),l=i(n(10)),c=i(n(31)),h=i(n(23)),f=i(n(17));n=function(){function e(t,n){(0,u.default)(this,e),this._map=t,this._ctlOpt=new f.default(n),this._btnWidth=42,this._showBtnCount=this._ctlOpt.showBtnCount||5,this._foucusId=this._map.currentFocusGroup,this._scrollSpeed=10,this._btnPanel=null,this._mainPanel=null,this._ctlOpt.offset||(this._ctlOpt.offset={x:0,y:0}),this._ctlOpt.needAllLayerBtn=null==this._ctlOpt.needAllLayerBtn||this._ctlOpt.needAllLayerBtn,this._allLayer=this._ctlOpt.allLayer||!1,this._allLayer&&this._map.showSingerOrMultiGroup(this._allLayer),this.uuid=null,this.init(),this.scrollTopAn_=new c.default.scrollTopAnFun}return(0,l.default)(e,[{key:"init",value:function(){var e,t=this,n=(e=new Date).getFullYear(),r=e.getMonth(),i=e.getDate(),o=e.getHours(),a=e.getMinutes();o<10&&(o="0"+o),a<10&&(a="0"+a),(e=e.getSeconds())<10&&(e="0"+e),i=n+"/"+r+"/"+i+"/"+o+":"+a+":"+e,this.uuid=String(5*Math.random()).replace(/^(.*\..{4}).*$/,"$1")+i;var s=this.createPanel(this._btnWidth);this._mainPanel=s,this.checkPosition(this._ctlOpt.position,this._ctlOpt.offset,s),this._map.getContainer().appendChild(s),o=this._map.listGroups.map((function(e){return e.gid})),a=o.length,e=this._showBtnCount,i=!0,a<=this._showBtnCount&&(e=a,i=!1),a=this.createMultiSwitchButton(this._ctlOpt.imgURL+(this._ctlOpt.allLayer?"layers.png":"layer.png")),this._ctlOpt.needAllLayerBtn&&s.appendChild(a),this._switchBtn=a,i&&s.appendChild(this.createScrollButton(this._ctlOpt.imgURL+"arrow1.png","top"));var u=this.createGroupBtnPanel(e*this._btnWidth+2*(e-1));s.appendChild(u),this._btnPanel=u;for(var l=this._map.listGroups,c=l.length-1;-1<c;c--)u.appendChild(this.createGroupButton(l[c],this._btnWidth)),0<c&&u.appendChild(this.createHr());i&&s.appendChild(this.createScrollButton(this._ctlOpt.imgURL+"arrow2.png","buttom")),u.scrollTop=this.getCenterScrolltopById(this._foucusId,o.length),document.getElementById("gid_"+this._foucusId+this.uuid).style.color="rgb(30, 130, 250)",this.eventBtnPanelInit(u),this.eventPanelInit(s,u,o),this.eventSwitchBtn(a);var h=function(e){var n=t._map.listGroups.map((function(e){return e.gid}));e.gid<n[0]||e.gid>n[n.length-1]||(u.scrollTop=t.getCenterScrolltopById(e.gid,n.length),t.setFocusStaus(e.gid))},f=function(e){1<e.gids.length?t.setLayerStatus(!0):t.setLayerStatus(!1)};this._map.on("focusGroupIDChanged",h),this._map.on("visibleGroupIDsChanged",f),this._map.on("dispose",(function(e){t._map.off("focusGroupIDChanged",h),t._map.off("visibleGroupIDsChanged",f),t._map.getContainer().removeChild(s)})),this._$=function(e){return(t.map?t.map.mapView.container_:document).querySelector(e)}}},{key:"eventSwitchBtn",value:function(e){var t=this;e.addEventListener("click",(function(n){t._allLayer=!t._allLayer,t._allLayer?e.firstElementChild.src=t._ctlOpt.imgURL+"layers.png":e.firstElementChild.src=t._ctlOpt.imgURL+"layer.png",t._map.showSingerOrMultiGroup(t._allLayer)}))}},{key:"eventBtnPanelInit",value:function(e){var t=this,n=this;n.changeScrollBtnPic(),c.default.bindEvent(e,"label","click",(function(){n.foucusId=(0,o.default)(this.dataset.gid),n.setFocusStaus(this.dataset.gid)}));var r=function(r){n.changeScrollBtnPic();var i=0;r.wheelDelta?i+=-r.wheelDelta:r.detail&&(i+=r.detail),t.scrollTopAn_({el:e,to:e.scrollTop,form:e.scrollTop+i})};e.addEventListener("mousewheel",r,{passive:!0}),e.addEventListener("MozMousePixelScroll",r,!1),e.addEventListener("touchstart",this.touchstart.bind(this),!1),e.addEventListener("touchmove",this.touchmove.bind(this),!1),e.addEventListener("touchend",this.touchend.bind(this),!0)}},{key:"touchstart",value:function(e){e.preventDefault(),this.touchStartPointY=e.touches[0].pageY,this.touchPointX=e.touches[0].pageX,this.touchPointY=e.touches[0].pageY}},{key:"touchmove",value:function(e){e.preventDefault(),this.touchEndPointX=e.touches[0].pageX,this.touchEndPointY=e.touches[0].pageY,this.handleTouchEnd(e)}},{key:"handleTouchEnd",value:function(e){var t,n=this,r=null;0<(e=e||window.event).changedTouches.length&&(n.touchEndPointX=e.changedTouches[0].pageX,n.touchEndPointY=e.changedTouches[0].pageY),(r=e.target)instanceof HTMLSpanElement==1&&(r=r.parentElement),0!=(t=-(r=n.touchEndPointY-n.touchPointY))&&(n.touchPointX=n.touchEndPointX,n.touchPointY=n.touchEndPointY,n=n._$(".fm-layer-list"),this.scrollTopAn_({el:n,to:n.scrollTop,form:n.scrollTop+t}))}},{key:"touchend",value:function(e){var t=this,n=null;0<(e=e||window.event).changedTouches.length&&(t.touchEndPointX=e.changedTouches[0].pageX,t.touchEndPointY=e.changedTouches[0].pageY),(n=e.target)instanceof HTMLSpanElement==1&&(n=n.parentElement),(e=Math.abs(t.touchEndPointY-t.touchStartPointY))<5&&0<=e&&n&&(n=(0,o.default)(n.dataset.gid),isNaN(n)||(t.foucusId=n,t.setFocusStaus(n)))}},{key:"eventPanelInit",value:function(e,t,n){var r=this;e.onselectstart=function(){return!1},e.style.MozUserSelect="none",c.default.bindEvent(e,".scroll","click",(function(e){var i=n.length-Math.floor(t.scrollTop/44)-(r._showBtnCount-1),o=t.scrollTop%44,a=i+r._showBtnCount-1+(0<o?1:0),s=0;if(this.id==="scroll_top"+r.uuid){var u=r._foucusId+1;if(u=Math.min(n[n.length-1],u),r.foucusId==u)return;r.foucusId=u,u<i?s-=0<o?44-o:0:u<=a+1&&u===a+1&&(s-=44+(0<o?44-o:0))}else{if(u=r._foucusId-1,u=Math.max(n[0],u),r.foucusId==u)return;r.foucusId=u,a<u?s+=0<o?o:0:i-1<=u&&u===i-1&&(s+=44+(0<o?o:0))}0!=s&&r.scrollTopAn_({el:t,to:t.scrollTop,form:t.scrollTop+s})}))}},{key:"getCenterScrolltopById",value:function(e,t){return(e=t-e-Math.floor(this._showBtnCount/2))*(this._btnWidth+2)}},{key:"createPanel",value:function(e){var t=document.createElement("div");return t.innerHTML='\n            <div class="fm-control-groups" style ="z-index: 20;width: 42px; position: absolute; background-color: white; box-shadow: rgba(0, 0, 0, 0.3) 2px 2px 3px; border-radius: 2px; top: 30px; right: 30px;"></div>\n        '.trim(),t.firstChild}},{key:"createGroupBtnPanel",value:function(e){var t=document.createElement("div");return e='\n            <div style = "overflow: hidden; height: '.concat(e,'px;" class="fm-layer-list"> </div\n        '),t.innerHTML=e.trim(),t.firstChild}},{key:"createMultiSwitchButton",value:function(e){var t=document.createElement("div");return e='\n            <div class="fm-control-groups-layer fm-btn-layer" style="padding: 10px; cursor: pointer;">\n                <img src="'.concat(e,'" style="width: 22px; height: 22px;">\n            </div>\n            '),t.innerHTML=e.trim(),t.firstChild}},{key:"createHr",value:function(){var e=document.createElement("div");return e.innerHTML='\n            <hr style="height: 1px; border-top: 1px solid rgba(153, 153, 153, 0.45); border-right: none; border-bottom: none; border-left: none; border-image: initial; width: 60%; margin: 0px 20%;">\n        '.trim(),e.firstChild}},{key:"createScrollButton",value:function(e,t){var n=document.createElement("div");return e='\n            <div class="scroll" id="scroll_'.concat(t+this.uuid,'" style="height: 18px; background: url(&quot;').concat(e,'&quot;) 50% 50% no-repeat; cursor: pointer;"></div>\n        '),n.innerHTML=e.trim(),n.firstChild}},{key:"createGroupButton",value:function(e,t){var n=document.createElement("div");return e="<label  data-gid=".concat(e.gid,' id="gid_').concat(e.gid+this.uuid,'" style="display: inline-block; text-align: center; width: ').concat(t,"px; height: ").concat(t,"px; line-height: ").concat(t,'px; margin: 0px; cursor: pointer; font-size: 0.8em; font-weight: bold; color: rgb(102, 102, 102);">\n                        <span>').concat(e.alias&&e.alias.toUpperCase()||e.gname.toUpperCase(),"</span>\n                    </label>"),n.innerHTML=e.trim(),n.firstChild}},{key:"changeScrollBtnPic",value:function(){var e=this._foucusId,t=this._map.listGroups.map((function(e){return e.gid})),n=document.getElementById("scroll_buttom"+this.uuid),r=document.getElementById("scroll_top"+this.uuid);e==t[0]?n&&(n.style.backgroundImage="url("+this._ctlOpt.imgURL+"arrow4.png)"):n&&(n.style.backgroundImage="url("+this._ctlOpt.imgURL+"arrow2.png)"),e==t[t.length-1]?r&&(r.style.backgroundImage="url("+this._ctlOpt.imgURL+"arrow3.png)"):r&&(r.style.backgroundImage="url("+this._ctlOpt.imgURL+"arrow1.png)")}},{key:"changeFocusGroup",value:function(e){this.foucusId=e}},{key:"changeGroupsSelect",value:function(e){this.setLayerStatus(e),this._map.showSingerOrMultiGroup(e)}},{key:"setLayerStatus",value:function(e){this._allLayer=e,this._allLayer?this._switchBtn.firstElementChild.src=this._ctlOpt.imgURL+"layers.png":this._switchBtn.firstElementChild.src=this._ctlOpt.imgURL+"layer.png"}},{key:"checkPosition",value:function(e,t,n){switch(n.style.left="",n.style.right="",n.style.top="",n.style.bottom="",e){case h.default.LEFT_TOP:n.style.left=t.x+"px",n.style.top=t.y+"px";break;case h.default.RIGHT_TOP:n.style.right=-t.x+"px",n.style.top=t.y+"px";break;case h.default.LEFT_BOTTOM:n.style.left=t.x+"px",n.style.bottom=-t.y+"px";break;case h.default.RIGHT_BOTTOM:n.style.right=-t.x+"px",n.style.bottom=-t.y+"px";break;default:n.style.left=t.x+"px",n.style.top=t.y+"px"}}},{key:"onChange",value:function(e){a=e}},{key:"foucusId",get:function(){return this._map.currentFocusGroup},set:function(e){var t=[];t.push.apply(t,(0,s.default)(this._map.visibleGroupIDs)),1==t.length?this._map.visibleGroupIDs=[e]:-1<this._map.visibleGroupIDs.indexOf(e)||(t.push(e),this._map.visibleGroupIDs=t),this._map.changeFocusToGroup({gid:e}),a&&a([e],1<this._map.visibleGroupIDs.length)}},{key:"setFocusStaus",value:function(e){document.getElementById("gid_"+this._foucusId+this.uuid).style.color="rgb(102, 102, 102)",this._foucusId=(0,o.default)(e),document.getElementById("gid_"+this._foucusId+this.uuid).style.color="rgb(30, 130, 250)",this.changeScrollBtnPic()}},{key:"allLayer",get:function(){return this._map.showAllGroup}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(21),i=n(67),o=n(44),a=n(42),s=n(61),u=n(62),l=Math.max,c=Math.min,h=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g,p=function(e){return void 0===e?e:String(e)};n(63)("replace",2,(function(e,t,n,g){return[function(r,i){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(e,t){var i=g(n,e,this,t);if(i.done)return i.value;var h=r(e),f=String(this),d="function"==typeof t;d||(t=String(t));var v,y=h.global;y&&(v=h.unicode,h.lastIndex=0);for(var _=[];null!==(w=u(h,f))&&(_.push(w),y);)""===String(w[0])&&(h.lastIndex=s(f,o(h.lastIndex),v));for(var x="",A=0,I=0;I<_.length;I++){for(var w=_[I],b=String(w[0]),C=l(c(a(w.index),f.length),0),M=[],E=1;E<w.length;E++)M.push(p(w[E]));var T,S=w.groups;S=d?(T=[b].concat(M,C,f),void 0!==S&&T.push(S),String(t.apply(void 0,T))):m(b,f,C,M,S,t),A<=C&&(x+=f.slice(A,C)+S,A=C+b.length)}return x+f.slice(A)}];function m(e,t,r,o,a,s){var u=r+e.length,l=o.length,c=d;return void 0!==a&&(a=i(a),c=f),n.call(s,c,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(u);case"<":s=a[i.slice(1,-1)];break;default:var c=+i;if(0===c)return n;if(l<c){var f=h(c/10);return 0!==f&&f<=l?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):n}s=o[c-1]}return void 0===s?"":s}))}}))},function(e,t,n){var r=n(66),i=n(112),o=n(67),a=n(44),s=n(113);e.exports=function(e,t){var n=1==e,u=2==e,l=3==e,c=4==e,h=6==e,f=5==e||h,d=t||s;return function(t,s,p){for(var g,m,v=o(t),y=i(v),_=r(s,p,3),x=a(y.length),A=0,I=n?d(t,x):u?d(t,0):void 0;A<x;A++)if((f||A in y)&&(m=_(g=y[A],A,v),e))if(n)I[A]=m;else if(m)switch(e){case 3:return!0;case 5:return g;case 6:return A;case 2:I.push(g)}else if(c)return!1;return h?-1:l||c?c:I}}},function(e,t,n){var r=n(32);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(114);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(18),i=n(115),o=n(19)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(32);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r=n(22);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){var r=n(118),i=n(71);e.exports=function(e){if(r(e))return i(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(119)},function(e,t,n){n(120),e.exports=n(1).Array.isArray},function(e,t,n){var r=n(5);r(r.S,"Array",{isArray:n(70)})},function(e,t,n){var r=n(122),i=n(134),o=n(77);e.exports=function(e){if(void 0!==r&&null!=e[i]||null!=e["@@iterator"])return o(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(123)},function(e,t,n){n(124),n(131),n(132),n(133),e.exports=n(1).Symbol},function(e,t,n){"use strict";var r=n(3),i=n(9),o=n(7),a=n(5),u=n(72),l=n(125).KEY,c=n(12),h=n(37),f=n(48),d=n(28),p=n(2),g=n(49),m=n(50),v=n(126),y=n(70),_=n(14),x=n(15),A=n(30),I=n(13),w=n(33),b=n(16),C=n(73),M=n(129),E=n(130),T=n(39),S=n(6),L=n(25),k=E.f,R=S.f,N=M.f,P=r.Symbol,O=r.JSON,D=O&&O.stringify,F="prototype",B=p("_hidden"),G=p("toPrimitive"),z={}.propertyIsEnumerable,U=h("symbol-registry"),V=h("symbols"),H=h("op-symbols"),j=Object[F],W="function"==typeof P&&!!T.f,Y=!(ee=r.QObject)||!ee[F]||!ee[F].findChild,q=o&&c((function(){return 7!=C(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=k(j,t);r&&delete j[t],R(e,t,n),r&&e!==j&&R(j,t,r)}:R,X=function(e){var t=V[e]=C(P[F]);return t._k=e,t},Z=W&&"symbol"==s(P.iterator)?function(e){return"symbol"==s(e)}:function(e){return e instanceof P},J=function e(t,n,r){return t===j&&e(H,n,r),_(t),n=w(n,!0),_(r),i(V,n)?(r.enumerable?(i(t,B)&&t[B][n]&&(t[B][n]=!1),r=C(r,{enumerable:b(0,!1)})):(i(t,B)||R(t,B,b(1,{})),t[B][n]=!0),q(t,n,r)):R(t,n,r)},K=function(e,t){_(e);for(var n,r=v(t=I(t)),i=0,o=r.length;i<o;)J(e,n=r[i++],t[n]);return e},Q=function(e){var t=z.call(this,e=w(e,!0));return!(this===j&&i(V,e)&&!i(H,e))&&(!(t||!i(this,e)||!i(V,e)||i(this,B)&&this[B][e])||t)},$=function(e,t){if(e=I(e),t=w(t,!0),e!==j||!i(V,t)||i(H,t)){var n=k(e,t);return!n||!i(V,t)||i(e,B)&&e[B][t]||(n.enumerable=!0),n}},ee=(h=function(e){for(var t,n=N(I(e)),r=[],o=0;n.length>o;)i(V,t=n[o++])||t==B||t==l||r.push(t);return r},function(e){for(var t,n=e===j,r=N(n?H:I(e)),o=[],a=0;r.length>a;)!i(V,t=r[a++])||n&&!i(j,t)||o.push(V[t]);return o});W||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=d(0<arguments.length?arguments[0]:void 0);return o&&Y&&q(j,e,{configurable:!0,set:function t(n){this===j&&t.call(H,n),i(this,B)&&i(this[B],e)&&(this[B][e]=!1),q(this,e,b(1,n))}}),X(e)},u(P[F],"toString",(function(){return this._k})),E.f=$,S.f=J,n(74).f=M.f=h,n(29).f=Q,T.f=ee,o&&!n(27)&&u(j,"propertyIsEnumerable",Q,!0),g.f=function(e){return X(p(e))}),a(a.G+a.W+a.F*!W,{Symbol:P});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)p(te[ne++]);for(var re=L(p.store),ie=0;re.length>ie;)m(re[ie++]);a(a.S+a.F*!W,"Symbol",{for:function(e){return i(U,e+="")?U[e]:U[e]=P(e)},keyFor:function(e){if(!Z(e))throw TypeError(e+" is not a symbol!");for(var t in U)if(U[t]===e)return t},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),a(a.S+a.F*!W,"Object",{create:function(e,t){return void 0===t?C(e):K(C(e),t)},defineProperty:J,defineProperties:K,getOwnPropertyDescriptor:$,getOwnPropertyNames:h,getOwnPropertySymbols:ee}),ee=c((function(){T.f(1)})),a(a.S+a.F*ee,"Object",{getOwnPropertySymbols:function(e){return T.f(A(e))}}),O&&a(a.S+a.F*(!W||c((function(){var e=P();return"[null]"!=D([e])||"{}"!=D({a:e})||"{}"!=D(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;i<arguments.length;)r.push(arguments[i++]);if(n=t=r[1],(x(t)||void 0!==e)&&!Z(e))return y(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Z(t))return t}),r[1]=t,D.apply(O,r)}}),P[F][G]||n(11)(P[F],G,P[F].valueOf),f(P,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(e,t,n){var r=n(28)("meta"),i=n(15),o=n(9),a=n(6).f,u=0,l=Object.isExtensible||function(){return!0},c=!n(12)((function(){return l(Object.preventExtensions({}))})),h=function(e){a(e,r,{value:{i:"O"+ ++u,w:{}}})},f=(n=function(e){return c&&f.NEED&&l(e)&&!o(e,r)&&h(e),e},e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==s(e)?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!l(e))return"F";if(!t)return"E";h(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!l(e))return!0;if(!t)return!1;h(e)}return e[r].w},onFreeze:n})},function(e,t,n){var r=n(25),i=n(39),o=n(29);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,s=n(e),u=o.f,l=0;s.length>l;)u.call(e,a=s[l++])&&t.push(a);return t}},function(e,t,n){var r=n(6),i=n(14),o=n(25);e.exports=n(7)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,u=0;u<s;)r.f(e,n=a[u++],t[n]);return e}},function(e,t,n){n=n(3).document,e.exports=n&&n.documentElement},function(e,t,n){var r=n(13),i=n(74).f,o={}.toString,a="object"==("undefined"==typeof window?"undefined":s(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t,n){var r=n(29),i=n(16),o=n(13),a=n(33),s=n(9),u=n(52),l=Object.getOwnPropertyDescriptor;t.f=n(7)?l:function(e,t){if(e=o(e),t=a(t,!0),u)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t){},function(e,t,n){n(50)("asyncIterator")},function(e,t,n){n(50)("observable")},function(e,t,n){e.exports=n(135)},function(e,t,n){n(75),n(139),e.exports=n(49).f("iterator")},function(e,t,n){var r=n(35),i=n(26);e.exports=function(e){return function(t,n){var o,a=String(i(t)),s=r(n);return t=a.length,s<0||t<=s?e?"":void 0:(n=a.charCodeAt(s))<55296||56319<n||s+1===t||(o=a.charCodeAt(s+1))<56320||57343<o?e?a.charAt(s):n:e?a.slice(s,s+2):o-56320+(n-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(73),i=n(16),o=n(48),a={};n(11)(a,n(2)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(9),i=n(30),o=n(36)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){n(140);for(var r=n(3),i=n(11),o=n(24),a=n(2)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var l,c=s[u];(l=(l=r[c])&&l.prototype)&&!l[a]&&i(l,a,c),o[c]=o.Array}},function(e,t,n){"use strict";var r=n(141),i=n(142),o=n(24),a=n(13);e.exports=n(76)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){n(75),n(144),e.exports=n(1).Array.from},function(e,t,n){"use strict";var r=n(51),i=n(5),o=n(30),a=n(145),s=n(146),u=n(56),l=n(147),c=n(148);i(i.S+i.F*!n(150)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,h,f=o(e),d="function"==typeof this?this:Array,p=arguments.length,g=1<p?arguments[1]:void 0,m=void 0!==g,v=0;if(e=c(f),m&&(g=r(g,2<p?arguments[2]:void 0,2)),null==e||d==Array&&s(e))for(n=new d(t=u(f.length));v<t;v++)l(n,v,m?g(f[v],v):f[v]);else for(h=e.call(f),n=new d;!(i=h.next()).done;v++)l(n,v,m?a(h,g,[i.value,v],!0):i.value);return n.length=v,n}})},function(e,t,n){var r=n(14);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){throw void 0!==(n=e.return)&&r(n.call(e)),t}}},function(e,t,n){var r=n(24),i=n(2)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){"use strict";var r=n(6),i=n(16);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(149),i=n(2)("iterator"),o=n(24);e.exports=n(1).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){var r=n(34),i=n(2)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?e:o?r(t):"Object"==(e=r(t))&&"function"==typeof t.callee?"Arguments":e}},function(e,t,n){var r=n(2)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){var r=n(77),i=n(71);e.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(0),i=n(4);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(40));n(68);var a,s=i(n(69)),u=i(n(8)),l=i(n(10)),c=i(n(31)),h=i(n(23)),f=i(n(17));n=function(){function e(t,n){(0,u.default)(this,e),this._map=t,this._ctlOpt=new f.default(n),this._ctlOpt.offset||(this._ctlOpt.offset={x:0,y:0}),this._btnWidth=42,this._showBtnCount=this._ctlOpt.showBtnCount||5,this._foucusId=this._map.currentFocusGroup||1,this._scrollSpeed=10,this._btnPanel=null,this._mainPanel=null,this._enableExpand=!0,this._disMainPanel=30+this._btnWidth,this._btnPanelVsible=!1,this._allLayer=n.allLayer||!1,this._allLayer&&this._map.showSingerOrMultiGroup(this._allLayer),this.scrollTopAn_=new c.default.scrollTopAnFun,this.init()}return(0,l.default)(e,[{key:"init",value:function(){var e=this,t=this._map.getFMGroup(this._foucusId),n=this.createPanel(this._btnWidth,t.groupName);this._mainPanel=n,this._map.getContainer().appendChild(n);var r=this._map.listGroups.map((function(e){return e.gid})),i=r.length;t=this._showBtnCount,i<=this._showBtnCount&&(t=i);var o=this.createGroupBtnPanel(t*this._btnWidth+2*(t-1));this._map.getContainer().appendChild(o),this._btnPanel=o;for(var a=this._map.listGroups,s=a.length-1;-1<s;s--)o.appendChild(this.createGroupButton(a[s],this._btnWidth)),0<s&&o.appendChild(this.createHr());this.checkPosition(this._ctlOpt.position,this._ctlOpt.offset,n,o),document.getElementById("gid_"+this._foucusId).style.color="rgb(30, 130, 250)",this.eventBtnPanelInit(o),this.eventPanelInit(n,r);var u=function(t){var n=e._map.listGroups.map((function(e){return e.gid}));t.gid<n[0]||t.gid>n[n.length-1]||(o.scrollTop=e.getCenterScrolltopById(t.gid,n.length),e.setFocusStaus(t.gid))};this._map.on("focusGroupIDChanged",u),this._map.on("dispose",(function(t){e._map.off("focusGroupIDChanged",u),e._map.getContainer().removeChild(o),e._map.getContainer().removeChild(n)})),this._$=function(t){return(e.map?e.map.mapView.container_:document).querySelector(t)}}},{key:"eventBtnPanelInit",value:function(e){var t=this,n=this;e.onselectstart=function(){return!1},e.style.MozUserSelect="none",c.default.bindEvent(e,"label","click",(function(){n.foucusId=(0,o.default)(this.dataset.gid)}));var r=function(n){var r=0;n.wheelDelta?r+=-n.wheelDelta:n.detail&&(r+=n.detail),t.scrollTopAn_({el:e,to:e.scrollTop,form:e.scrollTop+r})};e.addEventListener("mousewheel",r),e.addEventListener("MozMousePixelScroll",r,!1),e.addEventListener("touchstart",this.touchstart.bind(this),!1),e.addEventListener("touchmove",this.touchmove.bind(this),!1),e.addEventListener("touchend",this.touchend.bind(this),!0)}},{key:"touchstart",value:function(e){e.preventDefault(),this.touchPointX=e.touches[0].pageX,this.touchPointY=e.touches[0].pageY,this.touchStartPointY=e.touches[0].pageY}},{key:"touchmove",value:function(e){e.preventDefault(),this.touchEndPointX=e.touches[0].pageX,this.touchEndPointY=e.touches[0].pageY,this.handleTouchEnd(e)}},{key:"handleTouchEnd",value:function(e){var t,n=this,r=null;0<(e=e||window.event).changedTouches.length&&(n.touchEndPointX=e.changedTouches[0].pageX,n.touchEndPointY=e.changedTouches[0].pageY),(r=e.target)instanceof HTMLSpanElement==1&&(r=r.parentElement),0!=(t=-(r=n.touchEndPointY-n.touchPointY))&&(n.touchPointX=n.touchEndPointX,n.touchPointY=n.touchEndPointY,n=n._$(".fm-layer-list"),this.scrollTopAn_({el:n,to:n.scrollTop,form:n.scrollTop+t}))}},{key:"touchend",value:function(e){var t=this,n=null;0<(e=e||window.event).changedTouches.length&&(t.touchEndPointX=e.changedTouches[0].pageX,t.touchEndPointY=e.changedTouches[0].pageY),(n=e.target)instanceof HTMLSpanElement==1&&(n=n.parentElement),(e=Math.abs(t.touchEndPointY-t.touchStartPointY))<5&&0<=e&&n&&(n=(0,o.default)(n.dataset.gid),isNaN(n)||(t.foucusId=n,t.setFocusStaus(n)))}},{key:"eventPanelInit",value:function(e,t){var n=this;e.onselectstart=function(){return!1},e.style.MozUserSelect="none",e.addEventListener("click",(function(){n._enableExpand&&(n._btnPanelVsible?n._btnPanel.style.display="none":n._btnPanel.style.display="block",n._btnPanel.scrollTop=n.getCenterScrolltopById(n._foucusId,t.length),n._btnPanelVsible=!n._btnPanelVsible)}))}},{key:"getCenterScrolltopById",value:function(e,t){return(e=t-e-Math.floor(this._showBtnCount/2))*(this._btnWidth+2)}},{key:"createGroupBtnPanel",value:function(e){var t=document.createElement("div");return e='\n            <div style = "position: absolute; background-color: white; box-shadow: rgba(0, 0, 0, 0.3) 2px 2px 3px; border-radius: 2px; display: none; overflow: hidden;height: '.concat(e,'px;" class="fm-layer-list"> </div\n        '),t.innerHTML=e.trim(),t.firstChild}},{key:"createPanel",value:function(e,t){return e='<div class="fm-control-groups-btn" style="z-index: 20;width: '.concat(e,'px; height: 42px; position: absolute; background-color: white; box-shadow: rgba(0, 0, 0, 0.3) 2px 2px 3px; border-radius: 2px; text-align: center; cursor: pointer; font-size: 0.8em; font-weight: bold; text-transform: uppercase; line-height: 42px; color: rgb(30, 130, 250);">').concat(t.toUpperCase(),"</div>"),(t=document.createElement("div")).innerHTML=e.trim(),t.firstChild}},{key:"createHr",value:function(){var e=document.createElement("div");return e.innerHTML='\n            <hr style="height: 1px; border-top: 1px solid rgba(153, 153, 153, 0.45); border-right: none; border-bottom: none; border-left: none; border-image: initial; width: 60%; margin: 0px 20%;">\n        '.trim(),e.firstChild}},{key:"createGroupButton",value:function(e,t){var n=document.createElement("div");return e="<label  data-gid=".concat(e.gid,' id="gid_').concat(e.gid,'" style="display: inline-block; text-align: center; width: ').concat(t,"px; height: ").concat(t,"px; line-height: ").concat(t,'px; margin: 0px; cursor: pointer; font-size: 0.8em; font-weight: bold; color: rgb(102, 102, 102);">\n                        <span>').concat(e.alias&&e.alias.toUpperCase()||e.gname.toUpperCase(),"</span>\n                    </label>"),n.innerHTML=e.trim(),n.firstChild}},{key:"checkPosition",value:function(e,t,n,r){switch(n.style.left="",n.style.right="",n.style.top="",n.style.bottom="",r.style.left="",r.style.right="",r.style.top="",r.style.bottom="",e){case h.default.LEFT_TOP:n.style.left=t.x+"px",n.style.top=t.y+"px",r.style.left=t.x+"px",r.style.top=t.y+this._disMainPanel+"px";break;case h.default.RIGHT_TOP:n.style.right=-t.x+"px",n.style.top=t.y+"px",r.style.right=-t.x+"px",r.style.top=t.y+this._disMainPanel+"px";break;case h.default.LEFT_BOTTOM:n.style.left=t.x+"px",n.style.bottom=-t.y+"px",r.style.left=t.x+"px",r.style.bottom=-t.y+this._disMainPanel+"px";break;case h.default.RIGHT_BOTTOM:n.style.right=-t.x+"px",n.style.bottom=-t.y+"px",r.style.right=-t.x+"px",r.style.bottom=-t.y+this._disMainPanel+"px";break;default:n.style.left=t.x+"px",n.style.top=t.y+"px",r.style.left=t.x+"px",r.style.top=t.y+this._disMainPanel+"px"}}},{key:"onChange",value:function(e){a=e}},{key:"changeFocusGroup",value:function(e,t){this._map.showSingerOrMultiGroup(t),this.foucusId=e}},{key:"foucusId",set:function(e){var t=[];t.push.apply(t,(0,s.default)(this._map.visibleGroupIDs)),1==t.length?this._map.visibleGroupIDs=[e]:-1<this._map.visibleGroupIDs.indexOf(e)||(t.push(e),this._map.visibleGroupIDs=t),this._map.changeFocusToGroup({gid:e}),a&&a([e],this._map.showAllGroup)}},{key:"getGroupNameByGid",value:function(e){for(var t=this._map.listGroups,n=0,r=t.length;n<r;n++){var i=t[n];if(i.gid==e)return i.gname.toUpperCase()}return""}},{key:"setFocusStaus",value:function(e){this._mainPanel.innerHTML="".concat(this.getGroupNameByGid(e)),document.getElementById("gid_"+this._foucusId).style.color="rgb(102, 102, 102)",this._foucusId=e,document.getElementById("gid_"+this._foucusId).style.color="rgb(30, 130, 250)"}},{key:"allLayer",get:function(){return this._map.showAllGroup}},{key:"enableExpand",get:function(){return this._enableExpand},set:function(e){this._enableExpand=e}},{key:"expand",get:function(){return this._btnPanelVsible},set:function(e){var t;this._enableExpand&&(this._btnPanel.style.display=e?"block":"none",t=this._map.listGroups.map((function(e){return e.gid})),this._btnPanel.scrollTop=this.getCenterScrolltopById(this._foucusId,t.length),this._btnPanelVsible=e)}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(4);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(8)),a=i(n(10)),s=i(n(155)),u=i(n(17)),l=i(n(23));n=function(){function e(t,n){(0,o.default)(this,e),this._map=t,this._ctlOpt=new u.default(n),this._mainPanel=null,this._viewModeButton=null,this._groupChange=null,this._viewModeButtonNeeded=void 0===n.viewModeButtonNeeded||n.viewModeButtonNeeded,this._groupsButtonNeeded=void 0===n.groupsButtonNeeded||n.groupsButtonNeeded,this._init2D=void 0!==n.init2D&&n.init2D,this._initGroups=void 0!==n.initGroups&&n.initGroups,this._init2D&&(this._map.viewMode="top"),this._initGroups&&this._map.showSingerOrMultiGroup(!0),this._isOpenedControl=!1,this._showAllGroup=this._initGroups,this._direct=n.position||l.default.RIGHT_TOP,this._offset={x:0,y:0},n.offset&&(this._offset=n.offset),this.init()}return(0,a.default)(e,[{key:"init",value:function(){var e=this;this._mainPanel=this.createPanel(this._ctlOpt.imgURL+"more.png"),this._viewModeButton=this.createTopAnd3DButton(this._ctlOpt.imgURL+(this._init2D?"2D.png":"3D.png")),this._groupChange=this.createMultiAndSingerButton(this._ctlOpt.imgURL+(this._showAllGroup?"groups.png":"group.png")),(this._viewModeButtonNeeded||this._groupsButtonNeeded)&&this._map.getContainer().appendChild(this._mainPanel),this._viewModeButtonNeeded&&this._map.getContainer().appendChild(this._viewModeButton),this._groupsButtonNeeded&&this._map.getContainer().appendChild(this._groupChange);var t=this._offset;this._viewModeButtonNeeded&&this._groupsButtonNeeded?(this._mainPanel.style.display="block",this.checkPosition(this._direct,t,this._mainPanel),this.checkPosition(this._direct,t,this._viewModeButton,!0,1),this.checkPosition(this._direct,t,this._groupChange,!0,2)):this._viewModeButtonNeeded?(this._viewModeButton.style.display="block",this.checkPosition(this._direct,t,this._viewModeButton,!0,1)):this._groupsButtonNeeded&&(this._groupChange.style.display="block",this.checkPosition(this._direct,t,this._groupChange,!0,1)),this.initMainPanelEvent(this._mainPanel),this.initMultiGroupPanelEvent(this._groupChange),this.initViewModePanelEvent(this._viewModeButton);var n=function(t){e.setViewModeButtonPic()};this._map.on("viewModeChange",n);var r=function(t){e.setSingleMultiStatus(1<t.gids.length)};this._map.on("visibleGroupIDsChanged",r),this._map.on("dispose",(function(t){e._map.off("visibleGroupIDsChanged",r),e._map.off("viewModeChange",n),e._map.getContainer().contains(e._mainPanel)&&e._map.getContainer().removeChild(e._mainPanel),e._map.getContainer().contains(e._viewModeButton)&&e._map.getContainer().removeChild(e._viewModeButton),e._map.getContainer().contains(e._groupChange)&&e._map.getContainer().removeChild(e._groupChange)}))}},{key:"isAllGroups",value:function(){return this._map.showAllGroup}},{key:"initMainPanelEvent",value:function(e){var t=this;e.addEventListener("click",(function(){t._isOpenedControl?(t._groupChange.style.display="none",t._viewModeButton.style.display="none",this.style.backgroundImage="url("+t._ctlOpt.imgURL+"more.png)"):(t._groupChange.style.display="block",t._viewModeButton.style.display="block",this.style.backgroundImage="url("+t._ctlOpt.imgURL+"less.png)"),t._isOpenedControl=!t._isOpenedControl}))}},{key:"initViewModePanelEvent",value:function(e){var t=this;e.addEventListener("click",(function(){t._map.viewMode===s.default.MODE_3D?(t._map.viewMode=s.default.MODE_2D,this.style.backgroundImage="url("+t._ctlOpt.imgURL+"2D.png)"):(t._map.viewMode=s.default.MODE_3D,this.style.backgroundImage="url("+t._ctlOpt.imgURL+"3D.png)")}))}},{key:"setViewModeButtonPic",value:function(){this._map.viewMode===s.default.MODE_3D?this._viewModeButton.style.backgroundImage="url("+this._ctlOpt.imgURL+"3D.png)":this._viewModeButton.style.backgroundImage="url("+this._ctlOpt.imgURL+"2D.png)"}},{key:"initMultiGroupPanelEvent",value:function(e){var t=this;e.addEventListener("click",(function(){t._showAllGroup?(t._map.showSingerOrMultiGroup(!1),this.style.backgroundImage="url("+t._ctlOpt.imgURL+"group.png)"):(t._map.showSingerOrMultiGroup(!0),this.style.backgroundImage="url("+t._ctlOpt.imgURL+"groups.png)"),t._showAllGroup=!t._showAllGroup}))}},{key:"setSingleMultiStatus",value:function(e){this._groupChange.style.backgroundImage=e?"url("+this._ctlOpt.imgURL+"group.png)":"url("+this._ctlOpt.imgURL+"groups.png)"}},{key:"createPanel",value:function(e){var t=document.createElement("div");return e='<div class="fm-control-tool" style="z-index: 20; display: none;position: absolute; height: 42px; width: 42px; cursor: pointer; background: url(&quot;'.concat(e,'&quot;) 50% 50% no-repeat white; box-shadow: rgba(0, 0, 0, 0.3) 2px 2px 3px; border-radius: 2px; "></div>'),t.innerHTML=e.trim(),t.firstChild}},{key:"createTopAnd3DButton",value:function(e){var t=document.createElement("div");return e='<div class="fm-control-tool-3d" style="position: absolute; z-index:20; display: none;height: 42px; width: 42px; padding: 0px; cursor: pointer; box-shadow: rgba(0, 0, 0, 0.3) 2px 2px 3px; border-radius: 2px; background: url(&quot;'.concat(e,'&quot;) 50% 50% no-repeat white;"></div>'),t.innerHTML=e.trim(),t.firstChild}},{key:"createMultiAndSingerButton",value:function(e){var t=document.createElement("div");return e='<div class="fm-control-tool-group" style="position: absolute; z-index:20; display: none;height: 42px; width: 42px; padding: 0px; margin-top: 10px; cursor: pointer; box-shadow: rgba(0, 0, 0, 0.3) 2px 2px 3px; border-radius: 2px; background: url(&quot;'.concat(e,'&quot;) 50% 50% no-repeat white;"></div>'),t.innerHTML=e.trim(),t.firstChild}},{key:"checkPosition",value:function(e,t,n,r,i){n.style.left="",n.style.right="",n.style.top="",n.style.bottom="";var o=0;switch(e){case l.default.LEFT_TOP:1==r?(o=1==i?62:124,n.style.left=t.x+"px",n.style.top=t.y+o+"px"):(n.style.left=t.x+"px",n.style.top=t.y+"px");break;case l.default.RIGHT_TOP:1==r?(o=1==i?62:124,n.style.right=-t.x+"px",n.style.top=t.y+o+"px"):(n.style.right=-t.x+"px",n.style.top=t.y+"px");break;case l.default.LEFT_BOTTOM:1==r?(o=1==i?-62:-124,n.style.left=t.x+"px",n.style.bottom=-t.y-o+"px"):(n.style.left=t.x+"px",n.style.bottom=-t.y+"px");break;case l.default.RIGHT_BOTTOM:1==r?(o=1==i?-62:-124,n.style.right=-t.x+"px",n.style.bottom=-t.y-o+"px"):(n.style.right=-t.x+"px",n.style.bottom=-t.y+"px");break;default:n.style.left=t.x+"px",n.style.top=t.y+"px"}}}]),e}(),t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={MODE_2D:"top",MODE_3D:"3d"},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(4);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(8)),a=i(n(10)),s=i(n(31));n=function(){function e(t,n,r){(0,o.default)(this,e),this._map=t,this._opt=n,this._coord=n.mapCoord,this._threeCoord=n.threeCoord,this._window=null,this.marker=r,this._content=n.content||"<span>我是气泡</span>",this._width=n.width||200,this._height=n.height||100,this._padding=n._padding||10,this.init(),this.dispose}return(0,a.default)(e,[{key:"bindMarker",value:function(e){e&&e instanceof fengmap.FMImageMarker&&(this.marker=e)}},{key:"init",value:function(){var e=this;this._window=this.createWindow(this._content,this._width,this._height,this._padding,this._opt.margintop),this._window.style.left="0px",this._window.style.top="0px",this._map.getContainer().appendChild(this._window),this._map.registeredPop(this),s.default.bindEvent(this._window,".fm-control-popmarker-closebtn","click",(function(){e.close()})),this._map.updatePopPosition(this),this.dispose=function(t){e._map.logoutPop(e),e._map.getContainer().removeChild(e._window)},this._map.on("dispose",this.dispose)}},{key:"close",value:function(){this._map.off("dispose",this.dispose),this._map.getContainer().removeChild(this._window),this._map.logoutPop(this),this._opt.closeCallBack&&this._opt.closeCallBack(this)}},{key:"updateCoord",value:function(e,t){var n=0;this._coord&&this._coord.height&&(n=this._coord.height),-1<navigator.userAgent.indexOf("Edge")||-1<navigator.userAgent.indexOf(".NET4.0C")?this._window.style.transform="translate(".concat(e-this._width/2,"px, ").concat(t-this._height-20-n,"px)"):this._window.style.webkitTransform="translate(".concat(e-this._width/2,"px, ").concat(t-this._height-20-n,"px)")}},{key:"createWindow",value:function(e,t,n,r,i){var o=document.createElement("div");return e='<div class="z-index: 20;fm-control-popmarker" style="box-sizing: border-box;width: '.concat(t,"px; height: ").concat(n,"px; padding: ").concat(r,'px; background-color: rgb(255, 255, 255); border: 1px solid rgba(0, 0, 0, 0.2); border-radius: 6px; position: absolute;">\n            <input type="button" class="fm-control-popmarker-closebtn" value="✖" style="border-radius: 50%; position: absolute; right: 10px; top: 8px; background: 0px 0px rgb(238, 238, 238); width: 24px; height: 24px; border: 0px; -webkit-appearance: none;">\n            <span class="fm-control-popmarker-bot" style="width: 0px; height: 0px; font-size: 0px; overflow: hidden; position: absolute; border-width: 20px; border-style: solid dashed dashed; border-color: rgba(0, 0, 0, 0.2) transparent transparent; left: ').concat(t/2-20,'px; bottom: -40px;"></span>\n            <span class="fm-control-popmarker-top" style="width: 0px; height: 0px; font-size: 0px; overflow: auto; position: absolute; border-style: solid dashed dashed; border-width: 20px; border-color: rgb(255, 255, 255) transparent transparent; left: ').concat(t/2-20,'px; bottom: -39px;"></span>\n            <div style="overflow:auto;height:').concat(n-2*r,"px;margin-top:").concat(i||0,'px">\n                ').concat(e,"\n            </div></div>"),o.innerHTML=e.trim(),o.firstChild}},{key:"coord",get:function(){return this._coord}},{key:"threeCoord",get:function(){return this._threeCoord}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(4);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(8)),a=i(n(10)),s=i(n(23));n=function(){function e(t,n){(0,o.default)(this,e),this._map=t,this._option=n,this._compass=null,this._compassDiv=null,this._init()}return(0,a.default)(e,[{key:"_init",value:function(){var e=document.createElement("div");e.style.cssText="position:absolute;left:10px;top:10px;",e.style.width="50px",e.style.height="50px",e.style.backgroundColor="#FFFFFF",e.style.backgroundSize="100% 100%",e.style.zIndex=20,this._option.bgimage&&(e.style.backgroundImage="url('"+this._option.bgimage+"')"),e.style.borderRadius="80px",this._option.position&&this._option.offset&&this.checkPosition(this._option.position,this._option.offset,e),this._option.width&&(e.style.width=this._option.width+"px"),this._option.height&&(e.style.height=this._option.height+"px"),this._option.contain.appendChild(e);var t=180*this._map.controls.getAzimuthalAngle()/Math.PI;this._compass=document.createElement("div"),this._compass.style.cssText="position:absolute;left:0px;top:0px;",this._compass.style.transform="rotate("+t+"deg)",this._compass.style.msTransform="rotate("+t+"deg)",this._compass.style.mozTransform="rotate("+t+"deg)",this._compass.style.webkitTransform="rotate("+t+"deg)",this._compass.style.oTransform="rotate("+t+"deg)",this._compass.style.width="100%",this._compass.style.height="100%",this._compass.style.backgroundSize="100% 100%",this._compass.style.backgroundImage="url('"+this._option.compassimage+"')",e.appendChild(this._compass),this._compassDiv=e,this._start()}},{key:"_start",value:function(){var e=this;setInterval((function(){var t=180*e._map.controls.getAzimuthalAngle()/Math.PI;e._compass.style.transform="rotate("+t+"deg)",e._compass.style.msTransform="rotate("+t+"deg)",e._compass.style.mozTransform="rotate("+t+"deg)",e._compass.style.webkitTransform="rotate("+t+"deg)",e._compass.style.oTransform="rotate("+t+"deg)",e._compass.style.top="0px",e._compass.style.left="0px"}),50)}},{key:"addClickCompass",value:function(e){this._compassDiv.onclick=function(t){e()}}},{key:"checkPosition",value:function(e,t,n){switch(n.style.left="",n.style.right="",n.style.top="",n.style.bottom="",e){case s.default.LEFT_TOP:n.style.left=t.x+"px",n.style.top=t.y+"px";break;case s.default.RIGHT_TOP:n.style.right=-t.x+"px",n.style.top=t.y+"px";break;case s.default.LEFT_BOTTOM:n.style.left=t.x+"px",n.style.bottom=-t.y+"px";break;case s.default.RIGHT_BOTTOM:n.style.right=-t.x+"px",n.style.bottom=-t.y+"px";break;default:n.style.left=t.x+"px",n.style.top=t.y+"px"}}}]),e}(),t.default=n}],n={},e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==s(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(e){return t[e]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=78).default;function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var t,n},"object"==s(t)&&"object"==s(e)?e.exports=a():(i=[],void 0===(o="function"==typeof(r=a)?r.apply(t,i):r)||(e.exports=o))},531:function(e,n,r){var i,o,a;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}e=r.nmd(e);var u=function(){return n=[function(e,t,n){e.exports=n(267)},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(0);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r(e,i.key,i)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(270)},function(e,t,n){var r=n(34),i=n(288);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=r(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(53).default,i=n(96);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(175),i=n(292);function o(t){return e.exports=o=r?i:function(e){return e.__proto__||i(e)},e.exports.default=e.exports,e.exports.__esModule=!0,o(t)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(41).f,i=Function.prototype,o=/^\s*function ([^ (]*)/,a="name";a in i||n(30)&&r(i,a,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(23),i=n(146)(1);r(r.P+r.F*!n(147)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(9);var o=i(n(2)),a=i(n(3));n=function(){function e(t,n){(0,o.default)(this,e),this._eid=t,this._groupId=t,this.parent=null,this._nodeType=n,this._x=0,this._y=0,this._z=0,this._height=0,this._alwaysShow=!1,this._show=!0,this.needAvoid=!0,this.renderNodeInited=!1,this.tryInit=!1,this._visible=!0}return(0,a.default)(e,[{key:"findParent",value:function(e){for(var t=this.parent;t;){if(t instanceof e)return t;t=t.parent}return!1}},{key:"avoid",value:function(e){this.needAvoid=e,e||(this.show=!0)}},{key:"alwaysShow",value:function(){var e;this._alwaysShow=!0;for(var t=this.parent;t;){if(t.isGroup){e=t;break}t=t.parent}e&&this.renderNode&&e.alwaysShowMarkers.push(this.renderNode)}},{key:"isAlwaysShow",get:function(){return this._alwaysShow}},{key:"groupID",get:function(){if(this.isGroup)return this._eid;for(var e,t=this.parent;t;){if(t.isGroup){e=t;break}t=t.parent}return e?e.eid:0}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"mapCoord",get:function(){return{x:this._x,y:this._y,z:this._height}},set:function(e){this._mapCoord=e}},{key:"nodeType",get:function(){return this._nodeType},set:function(e){this._nodeType=e}},{key:"show",get:function(){return this._show},set:function(e){this._show=e,this._renderNode&&(this._renderNode.visible=e)}},{key:"x",get:function(){return this._x},set:function(e){this._x=e}},{key:"y",get:function(){return this._y},set:function(e){this._y=e}},{key:"z",get:function(){return this._z},set:function(e){this._z=e}},{key:"eid",get:function(){return this._eid}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.parent&&this.parent.parent&&this.parent.parent.parent&&this.parent.parent.parent.map.setRenderList()}}]),e}(),t.default=n},function(e,t,n){e.exports=n(340)},function(e,t){e=e.exports={version:"2.6.12"},"number"==typeof __e&&(__e=e)},function(e,t,n){"use strict";var r=n(23),i=n(182),o=n(69),a=n(84),s=n(39),u=[].slice;r(r.P+r.F*n(26)((function(){i&&u.call(i)})),"Array",{slice:function(e,t){var n=s(this.length),r=o(this);if(t=void 0===t?n:t,"Array"==r)return u.call(this,e,t);for(var i=a(e,n),l=(n=a(t,n),s(n-i)),c=new Array(l),h=0;h<l;h++)c[h]="String"==r?this.charAt(i+h):this[i+h];return c}})},function(e,t,n){"use strict";var r=n(105),i={};i[n(24)("toStringTag")]="z",i+""!="[object z]"&&n(45)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){var r=n(20),i=n(12),o=n(42),a=n(51),s=n(52),u="prototype",l=function e(t,n,l){var c,h,f,d=t&e.F,p=t&e.G,g=t&e.S,m=t&e.P,v=t&e.B,y=t&e.W,_=p?i:i[n]||(i[n]={}),x=_[u],A=p?r:g?r[n]:(r[n]||{})[u];for(c in p&&(l=n),l)(h=!d&&A&&void 0!==A[c])&&s(_,c)||(f=(h?A:l)[c],_[c]=p&&"function"!=typeof A[c]?l[c]:v&&h?o(f,r):y&&A[c]==f?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t[u]=e[u],t}(f):m&&"function"==typeof f?o(Function.call,f):f,m&&((_.virtual||(_.virtual={}))[c]=f,t&e.R&&x&&!x[c]&&a(x,c,f)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){e.exports=n(369)},function(e,t,n){e.exports=n(275)},function(e,t,n){e.exports=n(281)},function(e,t,n){e.exports=n(336)},function(e,t){e=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=e)},function(e,t,n){"use strict";var r=n(196),i=n(38),o=n(190),a=n(143),s=n(39),u=n(104),l=n(144),c=n(26),h=Math.min,f=[].push,d="split",p="length",g="lastIndex",m=4294967295,v=!c((function(){RegExp(m,"y")}));n(106)("split",2,(function(e,t,n,c){var y="c"=="abbc"[d](/(b)*/)[1]||4!="test"[d](/(?:)/,-1)[p]||2!="ab"[d](/(?:ab)*/)[p]||4!="."[d](/(.?)(.?)/)[p]||1<"."[d](/()()/)[p]||""[d](/.?/)[p]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(i,e,t);for(var o,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,d=void 0===t?m:t>>>0,v=new RegExp(e.source,c+"g");(o=l.call(v,i))&&!(h<(a=v[g])&&(u.push(i.slice(h,o.index)),1<o[p]&&o.index<i[p]&&f.apply(u,o.slice(1)),s=o[0][p],h=a,u[p]>=d));)v[g]===o.index&&v[g]++;return h===i[p]?!s&&v.test("")||u.push(""):u.push(i.slice(h)),u[p]>d?u.slice(0,d):u}:"0"[d](void 0,0)[p]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n;return[function(n,r){var i=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):y.call(String(i),n,r)},function(e,t){if((f=c(y,e,this,t,y!==n)).done)return f.value;var r=i(e),l=String(this),f=o(r,RegExp),d=r.unicode,p=(e=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(v?"y":"g"),new f(v?r:"^(?:"+r.source+")",e)),g=void 0===t?m:t>>>0;if(0===g)return[];if(0===l.length)return null===u(p,l)?[l]:[];for(var _=0,x=0,A=[];x<l.length;){p.lastIndex=v?x:0;var I,w=u(p,v?l:l.slice(x));if(null===w||(I=h(s(p.lastIndex+(v?0:x)),l.length))===_)x=a(l,x,d);else{if(A.push(l.slice(_,x)),A.length===g)return A;for(var b=1;b<=w.length-1;b++)if(A.push(w[b]),A.length===g)return A;x=_=I}}return A.push(l.slice(_)),A}]}))},function(e,t){e.exports=function(e){return"object"==s(e)?null!==e:"function"==typeof e}},function(e,t,n){var r=n(31),i=n(97),o=n(40),a=n(45),s=n(100),u="prototype",l=function e(t,n,l){var c,h,f,d=t&e.F,p=t&e.G,g=t&e.P,m=t&e.B,v=p?r:t&e.S?r[n]||(r[n]={}):(r[n]||{})[u],y=p?i:i[n]||(i[n]={}),_=y[u]||(y[u]={});for(c in p&&(l=n),l)h=((f=!d&&v&&void 0!==v[c])?v:l)[c],f=m&&f?s(h,r):g&&"function"==typeof h?s(Function.call,h):h,v&&a(v,c,h,t&e.U),y[c]!=h&&o(y,c,f),g&&_[c]!=h&&(_[c]=h)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var r=n(135)("wks"),i=n(83),o=n(31).Symbol,a="function"==typeof o;(e=e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t,n){e.exports=n(343)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";var r=n(16),i=n(17),o=n(18),a=n(11),s=n(0);n(13),n(14);var u=n(1);s(t,"__esModule",{value:!0}),t.default=void 0,n(21),n(8),n(64),n(9);var l=u(n(155)),c=u(n(11)),h=u(n(63)),f=u(n(19)),d=u(n(25)),p=u(n(2)),g=u(n(3)),m=u(n(158)),v=u(n(49)),y=u(n(399)),_=u(n(238)),x=u(n(403)),A=u(n(405)),I=u(n(415)),w=u(n(65)),b=u(n(87)),C=u(n(86)),M=n(416),E=n(417);function T(e,t){var n=void 0!==i&&e[o]||e["@@iterator"];if(!n){if(a(e)||(n=S(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw s}}}}function S(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(){function e(t,n){var r=this;(0,p.default)(this,e),this._scenes={},this._materialManager=new y.default(t.font),this._raycaster=new fm.Raycaster,this._focusAlphaMode=t._focusAlphaMode,this._focusAlpha=t._focusAlpha,this._map=n,this._externalModelUrl=t.mapServerURL+"/models/",this._externalLoader=new A.default(this._externalModelUrl,"fengmap"==t.mapServerURL,t.key),this._dynamicLoader=new I.default,this._externalLoader.setLoadedBack((function(){n.dispatchEvent({type:"externalLoaded"}),n.dispatchEvent({type:"gltfLoaded"}),n.checkNode(),n.setRenderList()})),this.isNeedSweep=n.MapOptions.isNeedSweep,this.sweepMax=n.MapOptions.sweepMax,this.sweepMin=n.MapOptions.sweepMin,this._waitingRenders=new l.default,n.on("frameLoop",(function(){r._updateWaitingRender()}))}return(0,g.default)(e,[{key:"createCompassNode",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=3<arguments.length?arguments[3]:void 0,n=4<arguments.length?arguments[4]:void 0,r=(r=1<arguments.length?arguments[1]:void 0)||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAGhUlEQVR4nOWbzW/cRBjGn7HHY7u7m8RLojIF8SFUUQECFQqnimsF/wAgEIiWKEqgH+LjAJxRDwjU0kIEpZWASvQvAM6IEy1IILUqogiEaKZVluxu1tv1ztgeDvHSELLJfno3yU/KIfaM93kfjz2ej5fMzc2hEzjnLZUTQowCeBzAgwDuBbALAAfgAcgkxaoASgDmAFwG8AuAnwF8yzkvdySwRUg/DBBC3APgOQBPEEIeZYzVKKV1SqmklErTNEPDMGJCSAwAWmsjjmMjiiIahiFL/mwppau1Pg/gawBnOee/dSR2DXpmgBDCBPA0gGnTNB9zHGfRcZwqYyzoRqCU0gmCIBMEwUgURd8DmAVwjnMedXPdBl0bkAR+GMB7juNUtm3bVrJtu9YLcSup1+vujRs3xoIgyAF4DcDxbo3oygAhxEsATrmuW85mswuUUtWNmFYJw9DyfT9fq9VGAUxyzj/t9FqdGnAfgBnLsg6MjIxcZ4zVOxXQDVJKe3FxcbtS6jSAjzjnl9q9RicGzBBCTmaz2flsNltqt3I/8H1/zPf9Ca31K5zzj9qp264BR03TfNXzPGFZ1kDuejOUUnaxWORRFL3HOX+r1XpGG79xjDF2aHx8/M9hCx4ALMuqj4+P/8kYOyyEONZqvVYNOGHb9v58Pn/VMIy4Q419xzCMOJ/PX7Vte78Q4kRLdVooc8y27Rfy+bwghOguNfYdQojO5/PCtu0XWmkJ6xlwlDE26XnetR7pSw3P864xxiaFEEfXKreWATPJC29uI9z5lRBCtOd5c6ZpviqEmGlWrpkBDxBCTnqeJ4b5mV8PwzBiz/MEIeSkEOL+Vcs0qTudy+Xmh/Ft3y6WZdVzudw8gOnVzq9mwIxlWS9mMpmh+MjpBZlMpmRZ1gEhxOTKcys/hCgAOax9fTcopexCoXAnALp8ALWyBRx2XXdxswUPLD0KruuWsTRy/ZflLYACkBMTE3+kNapLmzAMrfn5+bsAMM55CPy3BTzrOE5lswYPAJRS5TiOD+DZxrHlBkxvphdfMzKZTBHLeoSGAfdRSnd3O321EWCMBZTS3Y3vgoYBTzuOUxmgrlRJYn0KuGnAPtu2q4OTlC5JrPuAJQPGCCF7tkLzb8AYCwghe4QQYwaAvYyxvsziDjNJzHsNAA9RSjfdh896JDE/ZADYRSmVgxaUNknMuwwAO7ewATsNALebphkOWlDaJDHfbgAY2ciTHp2SxDxqAMg1Vmm3EknM2XbWBTYVWmsCQBoAKlrrLWdEEnPFALAYx/GWMyCJuWIA+CuKIjpoQWkTx7EJ4LoB4NcwDNmgBaVNEvOvBoDLW9iAywaAn8IwtActKG2SmH8yAHwnpXQHLShtkpi/MwCUtNYXpJTOoEWlhZTS0Vpf4JyXGt3f1/V6PbNmrU1EEus3wM0psbO1Wm1kcJLSJYn1C+CmAVeiKDq/Fd4FUko3iqLznPMrwH/XBWar1erogHSlRhLjbOP/5QacC4IgF4ahlb6sdAjD0Ep2mZ5rHFtuQAjgDd/386krS4kkttcb64LA/1eHj9VqtVGl1Kb7MFJK2cnW2uPLj680IAIwVS6Xt6emLCWSmKZWbq5ebRj8iVLqdLVaHUtHWv/xfX9MKXWac/7JynPN5gFmK5XKhFJqww+SlFK27/sTAFbdQ9zMgIta60PFYnHHRp4siePYKBaLO7TWU812kq8V3Mkoit5PLkD6pLFvaK1JsVjckWyePtWs3Hp3900p5alSqXRrj/X1nVKpdKuU8hTn/M21yrXSvI8EQfBZsVjkG6ElJHeeB0HwGef8yHrlW32+DwZBcGZhYeG2YX4nxHFsLCws3BYEwRnO+cFW6rQTzBEp5QeFQuGOYewdlFKsUCjcIaX8oJU736CTlJmXCSEncrnc/LBsqqpWq2OVSmVCa32Qc/5hO3U7TZq6H8C0ZVkHRkdHrw9qY6VSyi6Xy42kqVnO+cV2r9Ft2twkgI9d113M5XJ/p7XKHEURrVQqtyQTG1NrdXPr0YvESQrgDQDvOI5TyWQypX7tN5JSOtVqtZE4+TaAd5eP7Dqhl6mzDMAzAKZM09zjuu6ibds9SZ2t1+uZWq02EkXRBQAfA/iSc96TTR39TJ5+HsCThJCHGWM3LMuqJ4nTaq3k6SiKrDAMmVLKllJu01r/COArAJ8PdfJ0M4QQY1hKn38ESxmndwPYjtXT568B+B3AJQA/YCl9vq89zT/uIvNLxH1bgwAAAABJRU5ErkJggg==",i=(i=2<arguments.length?arguments[2]:void 0)||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAA5nmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMwNjcgNzkuMTU3NzQ3LCAyMDE1LzAzLzMwLTIzOjQwOjQyICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgICAgICAgICB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgICAgICAgICB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDIwLTExLTEzVDE0OjI4OjI5KzA4OjAwPC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMjAtMTEtMTNUMTQ6Mjk6MjUrMDg6MDA8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDIwLTExLTEzVDE0OjI5OjI1KzA4OjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjE4MjQ1YjY4LThkNDAtNzY0Ni04OTI0LTdkZDA2ZDYzZTM4MDwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDo4Nzc2QTE5MUEzRDAxMUU2QjhGOTlFMTYyOEIzMUI4MDwveG1wTU06RG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkRlcml2ZWRGcm9tIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgPHN0UmVmOmluc3RhbmNlSUQ+eG1wLmlpZDozRkM2NUZGNUEzQ0MxMUU2QjhGOTlFMTYyOEIzMUI4MDwvc3RSZWY6aW5zdGFuY2VJRD4KICAgICAgICAgICAgPHN0UmVmOmRvY3VtZW50SUQ+eG1wLmRpZDozRkM2NUZGNkEzQ0MxMUU2QjhGOTlFMTYyOEIzMUI4MDwvc3RSZWY6ZG9jdW1lbnRJRD4KICAgICAgICAgPC94bXBNTTpEZXJpdmVkRnJvbT4KICAgICAgICAgPHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD54bXAuZGlkOjg3NzZBMTkxQTNEMDExRTZCOEY5OUUxNjI4QjMxQjgwPC94bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpIaXN0b3J5PgogICAgICAgICAgICA8cmRmOlNlcT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+c2F2ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDoxODI0NWI2OC04ZDQwLTc2NDYtODkyNC03ZGQwNmQ2M2UzODA8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMjAtMTEtMTNUMTQ6Mjk6MjUrMDg6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChXaW5kb3dzKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNoYW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpIaXN0b3J5PgogICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3BuZzwvZGM6Zm9ybWF0PgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+NjQ8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+NjQ8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PtblBDkAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAnJJREFUeNrsmz9r20AYxh8lzpGhkE6d3DRzB7fQrZ/A5A8Opl/DQ/MBWmi8t07ivZ0SJylkMPQbSM5Qg09OWpeQaCoYMpVCh8ZSB9kg26os2dYpd3oPDPLdey/H73neu5PBmuM4SHNbQMobASAABIAAEAACQAAIAAFIa8vElfhnqTQp5IVWr+uPAPzZ3HwJ4GtQ8IP9fbkA4O4ueJzzM1gWWwTAms2zv7nc4zSVwCsYRnbwhbnPxfQAaLXew/sa7jhYarUqaQFQxPl5drSTuX1F9QFwXoFtj/fbNpY4r6gOoIhGI/u/QeaObasBQNPGP5x/8FV/2AV7vnMVcEABjcbEo465MQX1SoDzvUD1R12gGIAtGMZq2GDmxm6pA8A0D0Kp73WBaR6oAmADur4adRJz52zIfwpEVX/YBVXZT4F16PratJOZrj8BsC6lAzR3569Opf7wiVCVdQ/Iz6K+xwVrAPLyAbCsNzOp73HB4s3NW/kAXF09m1eqzPV1Lq5lxveL0O3t8ljfysq4wGFyOQ6TD0C7/UsDHk68IXe7YbL9fi7hJmjd01zCAHy5p7mEAfgIoDeHPD0An2QE8APA4RzyHAHoyHoVLs/ogh6AXZnfBjsAajPMr8WpvqjX4Xdhj3ufK8Ju3IsTAaDTr+Npav+7CgAGe4EdUf2yiIWJAvAt4l5Q689RBkAUFwip/SQAXAI4DhF3LEp90QDCuEBY7ScF4ALAScD4ST9GWQBBLhBa+0kCaAM49ek/Fa1+UgD8XCC89pMGYAL4PKK+mcRCMkiuvQbwtP+8k9QiNPrPUMobASAABIAAEAACQAAIAAFIa/s3AKynv4ToD/dyAAAAAElFTkSuQmCC",o=new x.default;return o.uniforms.scale={value:e},o.uniforms.offset={value:new fm.Vector2(t,n)},o.uniforms.mapfront={value:this._materialManager.loadTexture(i,(function(e){o.needsUpdate=!0}))},o.uniforms.mapBack={value:this._materialManager.loadTexture(r,(function(e){o.needsUpdate=!0}))},o.transparent=!0,r=new _.default,(r=new fm.Mesh(r,o)).userData.coord={x:t,y:n},r.userData.width=.5*e,r.frustumCulled=!1,r}},{key:"getModel",value:function(e,t,n,r){return(e=this._scenes[e])?(t=e.getGroupsModels(t),this._raycaster.setFromCamera(n,r),t=this._raycaster.intersectObjects(t)):[]}},{key:"getExternalModels",value:function(e,t,n,r){return(e=this._scenes[e])?(t=e.getGroupsExternalModels(t),this._raycaster.setFromCamera(n,r),t=this._raycaster.intersectObjects(t)):[]}},{key:"getModelExternal",value:function(e,t,n,r){var i=this._scenes[e];return i?(e=i.getGroupsModels(t),t=i.getGroupsExternalModels(t),t=e.concat(t),this._raycaster.setFromCamera(n,r),t=this._raycaster.intersectObjects(t)):[]}},{key:"getMarkers",value:function(e,t,n,r){var i=this._scenes[e];if(!i)return[];for(var o=[],a=0;a<t.length;a++)for(var s=i.getAllImageMarker(t[a]),u=0;u<s.length;u++)o.push(s[u]);return this._raycaster.setFromCamera(n,r),this._raycaster.perspective="PerspectiveCamera"===r.type,this._raycaster.intersectObjects(o)}},{key:"getNode",value:function(e,t,n,r,i){if(!(e=this._scenes[e]))return[];for(var o=e.getNodesExceptFacility(t,i),a=[],s=0;s<o.length;s++){var u=o[s].mapNode;(!u||u.visible&&u.show)&&a.push(o[s])}t=e.getDynnodes(i,t),this._raycaster.setFromCamera(n,r),this._raycaster.perspective="PerspectiveCamera"===r.type,r=this._raycaster.intersectObjects(a);var l=this._raycaster.intersectObjects(t,!0);if(l[0])for(var c=l[0].object;c.parent;){if(c.parent.mapNode){l[0].object=c.parent;break}c=c.parent}return l[0]&&r[0]?l[0].distance>r.distance?r:l:l[0]?l:r[0]?r:[]}},{key:"getFacility",value:function(e,t,n,r,i){if(!(e=this._scenes[e]))return[];i=e.getFacilityByFilter(t,i),this._raycaster.setFromCamera(n,r),this._raycaster.perspective="PerspectiveCamera"===r.type;for(var o=this._raycaster.intersectObjects(i),a=0;a<o.length;a++)if(a){if(!(o[a].distance-o[a-1].distance<1e-6))break;if("number"==typeof o[a].object.material.priority&&"number"!=typeof o[a-1].object.material.priority){var s=o[a],u=o[a-1];o[a-1]=s,o[a]=u}else if("number"==typeof o[a].object.material.priority&&"number"==typeof o[a-1].object.material.priority)for(var l=0,c=1;c<=a&&o[a-l].object.material.priority>o[a-c].object.material.priority;c++){var h=o[a-l],f=o[a-c];o[a-c]=h,o[a]=f,l++}}for(var d=[],p=0;p<o.length;p++){var g=o[p].object.mapNode;g.nodeType!==fengmap.FMNodeType.IMAGE_MARKER&&g.nodeType!==fengmap.FMNodeType.TEXT_MARKER||d.push(o[p])}for(var m=0;m<o.length;m++)o[m].object.mapNode.nodeType===fengmap.FMNodeType.FACILITY&&d.push(o[m]);return d}},{key:"getGroupLength",value:function(e){return this._scenes[""+e].groupLength}},{key:"getGroupIds",value:function(e){return this._scenes[""+e].groupIds}},{key:"getGroup",value:function(e,t){return this._scenes[""+e].groups[t+""]}},{key:"getRenderList",value:function(){if(this._scenes){var e,t=[];for(e in this._scenes){var n=this._scenes[e].getRenderGroup();t.push(n)}return t}}},{key:"conformatScene",value:function(e,t,n){(e=new m.default(t,e,this)).parent=this,this._scenes[t+""]=e,this._scenes[t+""].theme=n}},{key:"checkMaterialAlpha",value:function(e,t){if(e)if(this._focusAlphaMode&&t!==this._map.currentFocusGroup&&this._map.otherFocus.indexOf(t)<0){if((0,c.default)(e.material)){var n,r=T(e.material);try{for(r.s();!(n=r.n()).done;)n.value.opacity=this._focusAlpha}catch(e){r.e(e)}finally{r.f()}}else if(e.material)if(void 0===e.material.length)e.material.opacity!==this._focusAlpha&&(e.material.opacity=this._focusAlpha);else for(var i=0;i<e.material.length;i++)e.material[i].opacity!==this._focusAlpha&&(e.material[i].opacity=this._focusAlpha)}else if((0,c.default)(e.material)){var o,a=T(e.material);try{for(a.s();!(o=a.n()).done;){var s=o.value;"number"==typeof s.userData.opacity&&(s.opacity=s.userData.opacity)}}catch(e){a.e(e)}finally{a.f()}}else void 0!==e.material&&"number"==typeof e.material.userData.opacity&&(e.material.opacity=e.material.userData.opacity)}},{key:"checkNodeByFrustum",value:function(e,t,n,r,i){var o=this;if(o._scenes[i+""]){var a=o._scenes[i+""].theme,s=this._scenes[""+i].center.x,u=this._scenes[""+i].center.y,l=this._scenes[""+i].mapcenter.x,c=this._scenes[""+i].mapcenter.y,f=this._map.labelLanguage;b.default[this._map.uuid].bbox=this._scenes[""+i].bboxTh,b.default[this._map.uuid].bbox.uuid=this._map.uuid;var d=this._scenes[""+i].groups,p=(0,h.default)(d);try{var g,m=T(p);try{var v=function(){var e=g.value,h=d[e];if(n.indexOf(h.eid)<=-1)return h.visible=!1,"continue";h.visible=!0,h.traverseByAlias(["extent","model","facility","label","externalModel"],(function(e,n){var d=-1===(d=e.bdata).minlevel||-1===d.maxlevel||0!==d.minlevel&&!d.minlevel||!d.maxlevel||d.minlevel<=r&&d.maxlevel>r;if(!o._map.isRangeHidden||d)switch(void 0===e.uuid&&(e.uuid=fm.MathUtils.generateUUID()),n){case"extent":case"facility":e.renderNodeInited&&!o._waitingRenders.has(e.uuid)?(e.checkByFrustum(t),o.checkMaterialAlpha(e._renderNode,h.eid)):o._waitingRenders.has(e.uuid)||o._waitingRenders.set(e.uuid,{alias:n,node:e,sceneId:i,eid:h.eid});break;case"model":e.renderNodeInited&&!o._waitingRenders.has(e.uuid)?(e.checkByFrustum(t),o.checkMaterialAlpha(e.renderNode,h.eid),o.checkMaterialAlpha(e.line,h.eid)):o._waitingRenders.has(e.uuid)||o._waitingRenders.set(e.uuid,{alias:n,node:e,sceneId:i,eid:h.eid});break;case"label":e.renderNodeInited&&!o._waitingRenders.has(e.uuid)?(e.checkByFrustum(t),o.checkMaterialAlpha(e._renderNode,h.eid)):e.tryInit||o._waitingRenders.has(e.uuid)||o._waitingRenders.set(e.uuid,{alias:n,node:e,sceneId:i,eid:h.eid,frustum:t,labelLuage:f});break;case"externalModel":if(e.renderNodeInited)e.checkByFrustum(t),o.checkMaterialAlpha(e._renderNode,h.eid);else{var p=e.bdata,g=e.gdata,m=a.getExteralModelTheme(p.fid);if(!m)return;o._externalLoader.preLoadModels[m.normalid]||(o._externalLoader.preLoadModels[m.normalid]={loaded:!1,isLoading:!1,modelUrl:m.model,model:null,geometry:null,material:null});var v=o._externalLoader.preLoadModels[m.normalid];v.loaded?o._waitingRenders.has(e.uuid)||o._waitingRenders.set(e.uuid,{alias:n,node:e,exterdata:v,externalTheme:m,centx:s,centy:u,height:h.height,mapcentx:l,mapcenty:c}):(o._externalLoader.waitingBacks[m.normalid],o._externalLoader.addWaitingBacks(m.normalid,(function(t,n,r){o.createExterModel(t,n,g,p,m,e,s,u,h.height,l,c,"js"!==r)}),p.fid),v.isLoading||o._externalLoader.load(m.normalid))}}else null!==e.renderNode&&(e.visible=!1)}))};for(m.s();!(g=m.n()).done;)v()}catch(e){m.e(e)}finally{m.f()}}catch(e){}}}},{key:"_updateWaitingRender",value:function(){var e,t,n,r=this;0<this._waitingRenders.size&&(e="top"===this._map._viewMode?this._map.getScaleByCameraScale():this._map.getScaleByCameraDistance(),t=this._map.scaleTolevel(e),n=0,this._waitingRenders.forEach((function(e,i){if(n<r._map._renderNodeNumber){var o=-1===(o=e.node.bdata).minlevel||-1===o.maxlevel||0!==o.minlevel&&!o.minlevel||!o.maxlevel||o.minlevel<=t&&o.maxlevel>t;if(!r._map.isRangeHidden||o){switch(e.alias){case"extent":r.createExtent(e.node,e.sceneId,e.eid);break;case"model":r.createModel(e.node,e.sceneId,e.eid);break;case"label":r.createLabel(e.node,e.sceneId,e.labelLuage,e.eid);break;case"facility":r.createFacility(e.node,e.sceneId,e.eid);break;case"externalModel":r.createExterModel(e.exterdata.geometry,e.exterdata.material,e.node.gdata,e.node.bdata,e.externalTheme,e.node,e.centx,e.centy,e.height,e.mapcentx,e.mapcenty,e.exterdata.isGltf)}o=r._map.renderer.getFrustumByViewMode(r._map._viewMode),e.node.checkByFrustum(o),r._waitingRenders.delete(i),n++,0===r._waitingRenders.size&&r._map.avoidMarkers(),n===r._map._renderNodeNumber&&r._map.avoidMarkers()}else null!==e.node.renderNode&&(e.node.visible=!1)}})))}},{key:"createModel",value:function(e,t,n){var r=this._scenes[""+t].center.x,i=this._scenes[""+t].center.y,o=this._scenes[""+t].mapcenter.x,a=this._scenes[""+t].mapcenter.y,s=this._scenes[""+t].theme,u=e.gdata,l=e.bdata;this._map.MapOptions.useStoreApply&&(c=s.getStoreApplyTheme(l.fid));var c=c||s.getModelTheme(l);s=null,s=1===this._map.dataManager.file_ver?v.default.convertGeo2Geometry(u.geo):v.default.convertArray2Geometry(u.idxs,u.pts),e._data=s,l=u.height&&-1!==u.height?u.height:2,s=this.createGeometry(s,l,t),t=this._materialManager.createNormalMaterial(c),e._geometry=s,s=this.isNeedSweep,this.isNeedSweep&&(fm.ShaderLib.physical.vertexShader=M.vertexShader,fm.ShaderLib.physical.fragmentShader=E.fragmentShader,(0,f.default)(fm.ShaderLib.physical.uniforms,{maxPos:{value:this.sweepMax},minPos:{value:this.sweepMin},relativeModelMatrix:{value:void 0}})),e.initMesh(t,new fm.Vector3(r,i+l,0),s),e.x=o,e.y=a,e.height=l,e.currHeight=l,this.checkMaterialAlpha(e.renderNode,n),e.initLine(this._materialManager.createLineMaterial(c),u.height),this.checkMaterialAlpha(e.line,n),c.image&&c.sizes&&(u=c.sizes.split(","),n=[],c.coords&&(n=c.coords.split(",")),e.addStoreImage({image:c.image?this._map.MapOptions.mapThemeURL+"/"+this._map.MapOptions.defaultThemeName+"/"+c.image:"",angle:c.angle||0,size:[(0,d.default)(u[0]),(0,d.default)(u[1])],mapCoord:c.coords?new fm.Vector2((0,d.default)(n[0]),(0,d.default)(n[1])):void 0}))}},{key:"createExtent",value:function(e,t,n){var r=e.gdata,i=this._scenes[t+""].theme,o=this._scenes[""+t].center.x,a=this._scenes[""+t].center.y,s=this._scenes[""+t].mapcenter.x,u=this._scenes[""+t].mapcenter.y,l=1===this._map.dataManager.file_ver?v.default.convertGeo2Geometry(r.geo):v.default.convertArray2Geometry(r.idxs,r.pts);t=this.createGeometry(l,r.height||1,t),e._geometry=t,e.x=s,e.y=u,u=this._materialManager.createNormalMaterial(),e.initMesh(u,new fm.Vector3(o,a,0),i.floorColor,i.floorOpacity),this.checkMaterialAlpha(e.renderNode,n)}},{key:"createLabel",value:function(e,t,n,r){var i=e.gdata,o=e.bdata,a=this._scenes[""+t].mapcenter.x,s=this._scenes[""+t].mapcenter.y,u=this._scenes[""+t].center.x,l=this._scenes[""+t].center.y,c=this._scenes[t+""].theme;t=null,t=1===this._map.dataManager.file_ver?v.default.convertGeo2Points(i.geo):v.default.convertArrayPoints(i.idxs,i.pts),i=-1===i.height?2.2:i.height,s=new fm.Vector3(t.vertices[0].x-a,-t.vertices[0].y+s,0).applyEuler(new fm.Euler(Math.PI/2,0,0,"XYZ")).add(new fm.Vector3(u,l+i,0)),u=o.ename,l=o.name,u=n===C.default.ZH?l:u,e.x=t.vertices[0].x,e.y=t.vertices[0].y,e.height=i,e.pos=s,e.tryInit=!0,(o=c.getLabelTheme(o))&&(e.theme=o,e.size=1.4*o.fontsize,u&&(o=this._materialManager.createLabelMaterial(u,o),e.initSprite(o,(new fm.Vector3).copy(s)),this.checkMaterialAlpha(e._renderNode,r),e.setSize()))}},{key:"createFacility",value:function(e,t,n){var r=e.gdata,i=e.bdata,o=this._scenes[""+t].center.x,a=this._scenes[""+t].center.y,s=this._scenes[""+t].mapcenter.x,u=this._scenes[""+t].mapcenter.y,l=this._scenes[t+""].theme;t=null,t=1===this._map.dataManager.file_ver?v.default.convertGeo2Points(r.geo):v.default.convertArrayPoints(r.idxs,r.pts),r=-1===r.height?2.2:r.height,a=new fm.Vector3(t.vertices[0].x-s,-t.vertices[0].y+u,0).applyEuler(new fm.Euler(Math.PI/2,0,0,"XYZ")).add(new fm.Vector3(o,a+r,0)),l=l.getPoiTheme(i),i=this._materialManager.createPoiMaterial(l),e.x=t.vertices[0].x,e.y=t.vertices[0].y,e.height=r,e.pos=a,l.height&&(e.size=l.height),e.initSprite(i,(new fm.Vector3).copy(a)),this.checkMaterialAlpha(e._renderNode,n),e.setSize()}},{key:"everGroup",value:function(e,t){for(var n=0;n<e.biz.length;n++){for(var r=0;r<e.biz[n].extentLayer.length;r++)t(e.geo[n].extentLayer[r],"extentLayer",e.biz[n].extentLayer[r]);for(var i=0;i<e.biz[n].labelLayer.length;i++)t(e.geo[n].labelLayer[i],"labelLayer",e.biz[n].labelLayer[i]);for(var o=0;o<e.biz[n].modelLayer.length;o++)t(e.geo[n].modelLayer[o],"modelLayer",e.biz[n].modelLayer[o]);for(var a=0;a<e.biz[n].poiLayer.length;a++)t(e.geo[n].poiLayer[a],"poiLayer",e.biz[n].poiLayer[a]);for(var s=0;s<e.biz[n].stairLayer.length;s++)t(e.geo[n].stairLayer[s],"stairLayer",e.biz[n].stairLayer[s]);for(var u=0;u<e.biz[n].externalModelLayer.length;u++)t(e.geo[n].externalModelLayer[u],"externalModelLayer",e.biz[n].externalModelLayer[u])}}},{key:"createGeometry",value:function(e,t,n){var r=e.vertices;function i(e){for(var t=[],n=0;n<e.length;n+=2){var r=(e.length-n)/2;t[2*(r-1)]=e[n],t[2*(r-1)+1]=e[n+1]}return t}if(v.default.checkClockwise(r)||(r=i(r),e.vertices=r),6<=r.length){var o=new fm.Shape,a=this._scenes[""+n].mapcenter.x,s=this._scenes[""+n].mapcenter.y;if(e.holes&&0<e.holes.length){var u={};for(f in e.holes){var l=e.holes[f];v.default.checkClockwise(l)||(l=i(l),e.holes[f]=l);for(var c=0;c<l.length;c+=2){var h=l[c]+"-"+l[c+1];u[h]=!0}}this.forEachVertForShape(r,(function(e,t,n){e?o.moveTo(t-a,n-s):u[t+"-"+n]||o.lineTo(t-a,n-s)}));for(var f=0;f<e.holes.length;f++){l=e.holes[f];var d=new fm.Path;this.forEachVertForShape(l,(function(e,t,n){e?d.moveTo(t-a,n-s):d.lineTo(t-a,n-s)})),o.holes.push(d)}}else this.forEachVertForShape(r,(function(e,t,n){e?o.moveTo(t-a,n-s):o.lineTo(t-a,n-s)}));var p=0==t?new fm.ShapeGeometry(o):new fm.ExtrudeGeometry(o,{depth:t,bevelEnabled:!1}),g=b.default[this._map.uuid].bbox.min.x,m=b.default[this._map.uuid].bbox.min.y,y=b.default[this._map.uuid].bbox.max.x-b.default[this._map.uuid].bbox.min.x,_=b.default[this._map.uuid].bbox.max.y-b.default[this._map.uuid].bbox.min.y,x=p.faces,A=x.length;for(f=0;f<A;f++){var I=p.vertices[x[f].a],w=p.vertices[x[f].b],C=p.vertices[x[f].c];p.faceVertexUvs[0][f][0].x=(I.x-g)/y,p.faceVertexUvs[0][f][0].y=(I.y-m)/_,p.faceVertexUvs[0][f][1].x=(w.x-g)/y,p.faceVertexUvs[0][f][1].y=(w.y-m)/_,p.faceVertexUvs[0][f][2].x=(C.x-g)/y,p.faceVertexUvs[0][f][2].y=(C.y-m)/_}return p.computeBoundingSphere(),{geometry:p,shape:o}}return null}},{key:"createExterModel",value:function(e,t,n,r,i,o,a,s,u,l,h,p){var g=this,m=1===this._map.dataManager.file_ver?v.default.convertGeo2Points(n.geo):v.default.convertArrayPoints(n.idxs,n.pts);if(a=new fm.Vector3(m.vertices[0].x-l,-m.vertices[0].y+h,0).applyEuler(new fm.Euler(Math.PI/2,0,0,"XYZ")).add(new fm.Vector3(a,s+(-1===n.height?2.2:n.height),0)),p){s=e.scene;var y=null;0<e.animations.length?(y=s,this._map.animaModels.push({model:s,animations:e.animations})):y=s.clone(),y.traverse((function(e){if(e instanceof fm.Mesh){if(e.isGltf=!0,void 0!==e.material.length)for(var t=0;t<e.material.length;t++)e.material[t]=e.material[t].clone(),e.material[t].color=new fm.Color(w.default.toColor(i.color)),e.material[t].needsUpdate=!0,e.material[t].userData.opacity=e.material[t].opacity;else e.material=e.material.clone(),g.isNeedSweep&&(fm.ShaderLib.physical.vertexShader=M.vertexShader,fm.ShaderLib.physical.fragmentShader=E.fragmentShader,(0,f.default)(fm.ShaderLib.physical.uniforms,{sweepW:{value:0},sweepH:{value:0},se2N:{value:new fm.Vector2(0,0)},se2RN:{value:new fm.Vector2(0,0)},moveP:{value:new fm.Vector2(0,0)},relativeModelMatrix:{value:void 0},isNeedSweep:{value:!0},isRect:{value:!1},isAnnulus:{value:!1},circleC:{value:new fm.Vector2(0,0)},maxR:{value:0},minR:{value:0}}),e.name="isNeedSweep",e.material.uniforms={sweepW:{value:0},sweepH:{value:0},se2N:{value:new fm.Vector2(0,0)},se2RN:{value:new fm.Vector2(0,0)},moveP:{value:new fm.Vector2(0,0)},relativeModelMatrix:{value:e.matrixWorld},isNeedSweep:{value:!1},isRect:{value:!1},isAnnulus:{value:!1},circleC:{value:new fm.Vector2(0,0)},maxR:{value:0},minR:{value:0}}),e.material.transparent=!0,e.material.color=new fm.Color(w.default.toColor(i.color)),e.material.needsUpdate=!0,e.material.userData.opacity=e.material.opacity;e.renderOrder=r.eid}}));var _=i.scale.split(","),x=(p=i.rotate.split(","),i.translate.split(","));(s=new fm.Vector3).set((0,d.default)(p[0])*fm.Math.DEG2RAD,(0,d.default)(p[2])*fm.Math.DEG2RAD,(0,d.default)(p[1])*fm.Math.DEG2RAD),y.rotation.setFromVector3(s,"YXZ"),y.scale.set((0,d.default)(_[0]),(0,d.default)(_[2]),(0,d.default)(_[1])),a.add(new fm.Vector3((0,d.default)(x[0]),(0,d.default)(x[2]),(0,d.default)(x[1]))),y.position.set(a.x,a.y,a.z),o.renderNode=y,o.x=m.vertices[0].x+(0,d.default)(x[0]),o.y=m.vertices[0].y+(0,d.default)(x[1]),o.height=-1===n.height?2.2:n.height,o._renderNode&&(o._renderNode.frustumCulled=!1,o.renderNodeInited=!0)}else{if((0,c.default)(t)){var A,I=T(t);try{for(I.s();!(A=I.n()).done;){var b=A.value;b.color=new fm.Color(w.default.toColor(i.color)),b.transparent=!0,b.map&&(b.map.wrapS=fm.RepeatWrapping,b.map.wrapT=fm.RepeatWrapping,b.color.setScalar(1)),b.userData.opacity=b.opacity}}catch(e){I.e(e)}finally{I.f()}}else t.color=new fm.Color(w.default.toColor(i.color)),t.transparent=!0,t.map&&(t.map.wrapS=fm.RepeatWrapping,t.map.wrapT=fm.RepeatWrapping,t.color.setScalar(1)),t.userData.opacity=t.opacity;var C=[];if(void 0!==t.length)for(var S=0;S<t.length;S++)C.push(t[S].clone());else C.push(t.clone());_=new fm.Mesh(e,C),y=i.scale.split(","),x=i.rotate.split(","),e=i.translate.split(","),_.scale.set((0,d.default)(y[0]),(0,d.default)(y[2]),(0,d.default)(y[1])),(y=new fm.Vector3).set((0,d.default)(x[0])*fm.Math.DEG2RAD,(0,d.default)(x[2])*fm.Math.DEG2RAD,(0,d.default)(x[1])*fm.Math.DEG2RAD),_.rotation.setFromVector3(y,"YXZ"),a.add(new fm.Vector3((0,d.default)(e[0]),(0,d.default)(e[2]),(0,d.default)(e[1]))),_.position.set(a.x,a.y,a.z),_.renderOrder=r.eid,o.renderNode=_,o.x=m.vertices[0].x+(0,d.default)(e[0]),o.y=m.vertices[0].y+(0,d.default)(e[1]),o.height=-1===n.height?2.2:n.height,o._renderNode&&(o._renderNode.frustumCulled=!1,o.renderNodeInited=!0)}}},{key:"findGltfMesh",value:function(e,t){if(e instanceof fm.Mesh)t(e);else{var n,r=T(e.children);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.findGltfMesh(i,t)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"getDynLoader",value:function(){return this._dynamicLoader}},{key:"getSceneCenter",value:function(e){return(new fm.Vector3).copy(this._scenes[e+""].center)}},{key:"forEachVertForShape",value:function(e,t){var n=0;for(t(!0,e[n],e[n+1]),n=2;n<e.length;n+=2)t(!1,e[n],e[n+1]);t(!1,e[n=0],e[n+1])}},{key:"getCurrentNodeCenter",value:function(e,t){for(var n=this._scenes[t],r=(t=n.center,0),i=0;i<e.length;i++)r+=e[i]*n.space;return new fm.Vector3(t.x,t.y+r/e.length,0)}},{key:"getHeight",value:function(e,t){return this._scenes[""+e].getHeight(t)}},{key:"getSceneById",value:function(e){return this._scenes[""+e]}},{key:"dispose",value:function(){for(var e in this._materialManager.dispose(),this._scenes)this._scenes[e].dispose(),this._scenes[e].parent=void 0;this._map=void 0,this._scenes=void 0,this._materialManager=void 0}},{key:"disposeById",value:function(e){this._scenes[e].dispose(),this._scenes[e].parent=void 0,this._scenes[e]=void 0}},{key:"map",get:function(){return this._map}},{key:"materialManager",get:function(){return this._materialManager}}]),e}(),t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={NONE:0,EXTENT:4,FLOOR:4,MODEL:5,DYNMODEL:6,FACILITY:11,LABEL:12,LINE:21,IMAGE_MARKER:31,TEXT_MARKER:32,LOCATION_MARKER:33,SURFACEIMAGE_MARKER:34,EXTERANL_MODEL:35,EXTERNAL_MODEL:35,POLYGON_MARKER:36,WATER_MARKER:37,EXTRUDE_MARKER:38,GRADIENT_POLYGON_MARKER:39,EDGES_LINES_TYPE:40,ALL:65535,ELEMENT:100},t.default=n},function(e,t,n){var r=n(126)("wks"),i=n(91),o=n(20).Symbol,a="function"==typeof o;(e=e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t,n){e.exports=!n(26)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){e=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=e)},function(e,t,n){n(47)("Float32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){e.exports=!n(43)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){e.exports=n(286)},function(e,t,n){e.exports=n(346)},function(e,t,n){var r=n(37),i=n(164),o=n(122),a=Object.defineProperty;t.f=n(33)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(22);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(44);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(54),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(41),i=n(98);e.exports=n(30)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(38),i=n(176),o=n(82),a=Object.defineProperty;t.f=n(30)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(56);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==s(e)?null!==e:"function"==typeof e}},function(e,t,n){var r=n(31),i=n(40),o=n(58),a=n(83)("src"),s=n(296),u="toString",l=(""+s).split(u);n(97).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(u&&(o(n,a)||i(n,a,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,u,(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,n){var r=n(60);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r,i,o,a,u,l,c,h,f,d,p,g,m,v,y,_,x,A,I,w,b,C,M,E,T,S,L,k,R,N,P,O,D,F,B,G,z,U,V,H,j,W,Y,q,X,Z,J,K,Q,$,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,he,fe,de,pe,ge,me,ve,ye,_e,xe,Ae,Ie,we,be,Ce,Me,Ee,Te,Se,Le,ke,Re,Ne,Pe,Oe,De,Fe,Be,Ge,ze,Ue,Ve;n(30)?(r=n(99),i=n(31),o=n(26),a=n(23),u=n(185),l=n(315),c=n(100),h=n(187),f=n(98),d=n(40),p=n(186),g=n(54),m=n(39),v=n(188),y=n(84),_=n(82),x=n(58),A=n(105),I=n(44),w=n(46),b=n(316),C=n(141),M=n(189),E=n(102).f,T=n(317),ze=n(83),Le=n(24),Ue=n(146),S=n(181),L=n(190),k=n(71),R=n(70),N=n(320),P=n(193),O=n(148),D=n(321),F=n(41),B=n(137),G=F.f,z=B.f,U=i.RangeError,V=i.TypeError,H=i.Uint8Array,W="Shared"+(j="ArrayBuffer"),Y="BYTES_PER_ELEMENT",q="prototype",n=Array[q],X=l.ArrayBuffer,Z=l.DataView,J=Ue(0),K=Ue(2),Q=Ue(3),$=Ue(4),ee=Ue(5),te=Ue(6),ne=S(!0),re=S(!1),ie=k.values,oe=k.keys,ae=k.entries,se=n.lastIndexOf,ue=n.reduce,le=n.reduceRight,ce=n.join,he=n.sort,fe=n.slice,de=n.toString,pe=n.toLocaleString,ge=Le("iterator"),me=Le("toStringTag"),ve=ze("typed_constructor"),ye=ze("def_constructor"),n=u.CONSTR,_e=u.TYPED,xe=u.VIEW,Ae="Wrong length!",Ie=Ue(1,(function(e,t){return Ee(L(e,e[ye]),t)})),we=o((function(){return 1===new H(new Uint16Array([1]).buffer)[0]})),be=!!H&&!!H[q].set&&o((function(){new H(1).set({})})),Ce=function(e,t){if((e=g(e))<0||e%t)throw U("Wrong offset!");return e},Me=function(e){if(I(e)&&_e in e)return e;throw V(e+" is not a typed array!")},Ee=function(e,t){if(!I(e)||!(ve in e))throw V("It is not a typed array constructor!");return new e(t)},Te=function(e,t){return Se(L(e,e[ye]),t)},Se=function(e,t){for(var n=0,r=t.length,i=Ee(e,r);n<r;)i[n]=t[n++];return i},Le=function(e,t,n){G(e,t,{get:function(){return this._d[n]}})},ke=function(e){var t,n,r,i,o,a,s=w(e),u=arguments.length,l=1<u?arguments[1]:void 0,h=void 0!==l;if(null!=(e=T(s))&&!b(e)){for(a=e.call(s),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);s=r}for(h&&2<u&&(l=c(l,arguments[2],2)),t=0,n=m(s.length),i=Ee(this,n);t<n;t++)i[t]=h?l(s[t],t):s[t];return i},Re=function(){for(var e=0,t=arguments.length,n=Ee(this,t);e<t;)n[e]=arguments[e++];return n},Ne=!!H&&o((function(){pe.call(new H(1))})),Pe=function(){return pe.apply(Ne?fe.call(Me(this)):Me(this),arguments)},Oe={copyWithin:function(e,t){return D.call(Me(this),e,t,2<arguments.length?arguments[2]:void 0)},every:function(e){return $(Me(this),e,1<arguments.length?arguments[1]:void 0)},fill:function(e){return O.apply(Me(this),arguments)},filter:function(e){return Te(this,K(Me(this),e,1<arguments.length?arguments[1]:void 0))},find:function(e){return ee(Me(this),e,1<arguments.length?arguments[1]:void 0)},findIndex:function(e){return te(Me(this),e,1<arguments.length?arguments[1]:void 0)},forEach:function(e){J(Me(this),e,1<arguments.length?arguments[1]:void 0)},indexOf:function(e){return re(Me(this),e,1<arguments.length?arguments[1]:void 0)},includes:function(e){return ne(Me(this),e,1<arguments.length?arguments[1]:void 0)},join:function(e){return ce.apply(Me(this),arguments)},lastIndexOf:function(e){return se.apply(Me(this),arguments)},map:function(e){return Ie(Me(this),e,1<arguments.length?arguments[1]:void 0)},reduce:function(e){return ue.apply(Me(this),arguments)},reduceRight:function(e){return le.apply(Me(this),arguments)},reverse:function(){for(var e,t=this,n=Me(t).length,r=Math.floor(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t},some:function(e){return Q(Me(this),e,1<arguments.length?arguments[1]:void 0)},sort:function(e){return he.call(Me(this),e)},subarray:function(e,t){var n=Me(this),r=n.length;return e=y(e,r),new(L(n,n[ye]))(n.buffer,n.byteOffset+e*n.BYTES_PER_ELEMENT,m((void 0===t?r:y(t,r))-e))}},De=function(e,t){return Te(this,fe.call(Me(this),e,t))},Fe=function(e){Me(this);var t=Ce(arguments[1],1),n=this.length,r=w(e),i=m(r.length),o=0;if(n<i+t)throw U(Ae);for(;o<i;)this[t+o]=r[o++]},Be={entries:function(){return ae.call(Me(this))},keys:function(){return oe.call(Me(this))},values:function(){return ie.call(Me(this))}},Ge=function(e,t){return I(e)&&e[_e]&&"symbol"!=s(t)&&t in e&&String(+t)==String(t)},ze=function(e,t){return Ge(e,t=_(t,!0))?f(2,e[t]):z(e,t)},Ue=function(e,t,n){return!(Ge(e,t=_(t,!0))&&I(n)&&x(n,"value"))||x(n,"get")||x(n,"set")||n.configurable||x(n,"writable")&&!n.writable||x(n,"enumerable")&&!n.enumerable?G(e,t,n):(e[t]=n.value,e)},n||(B.f=ze,F.f=Ue),a(a.S+a.F*!n,"Object",{getOwnPropertyDescriptor:ze,defineProperty:Ue}),o((function(){de.call({})}))&&(de=pe=function(){return ce.call(this)}),Ve=p({},Oe),p(Ve,Be),d(Ve,ge,Be.values),p(Ve,{slice:De,set:Fe,constructor:function(){},toString:de,toLocaleString:Pe}),Le(Ve,"buffer","b"),Le(Ve,"byteOffset","o"),Le(Ve,"byteLength","l"),Le(Ve,"length","e"),G(Ve,me,{get:function(){return this[_e]}}),e.exports=function(e,t,n,s){var l=e+((s=!!s)?"Clamped":"")+"Array",c="get"+e,f="set"+e,p=i[l],g=p||{},y=p&&M(p),_=!p||!u.ABV,x=(e={},p&&p[q]),w=function(e,n){G(e,n,{get:function(){return function(e,n){return(e=e._d).v[c](n*t+e.o,we)}(this,n)},set:function(e){return function(e,n,r){e=e._d,s&&(r=(r=Math.round(r))<0?0:255<r?255:255&r),e.v[f](n*t+e.o,r,we)}(this,n,e)},enumerable:!0})};_?(p=n((function(e,n,r,i){h(e,p,l,"_d");var o,a,s=0,u=0;if(I(n)){if(!(n instanceof X||(c=A(n))==j||c==W))return _e in n?Se(p,n):ke.call(p,n);var c=n;if(u=Ce(r,t),r=n.byteLength,void 0===i){if(r%t)throw U(Ae);if((o=r-u)<0)throw U(Ae)}else if(r<(o=m(i)*t)+u)throw U(Ae);a=o/t}else a=v(n),c=new X(o=a*t);for(d(e,"_d",{b:c,o:u,l:o,e:a,v:new Z(c)});s<a;)w(e,s++)})),x=p[q]=C(Ve),d(x,"constructor",p)):o((function(){p(1)}))&&o((function(){new p(-1)}))&&N((function(e){new p,new p(null),new p(1.5),new p(e)}),!0)||(p=n((function(e,n,r,i){var o;return h(e,p,l),I(n)?n instanceof X||(o=A(n))==j||o==W?void 0!==i?new g(n,Ce(r,t),i):void 0!==r?new g(n,Ce(r,t)):new g(n):_e in n?Se(p,n):ke.call(p,n):new g(v(n))})),J(y!==Function.prototype?E(g).concat(E(y)):E(g),(function(e){e in p||d(p,e,g[e])})),p[q]=x,r||(x.constructor=p)),n=!!(_=x[ge])&&("values"==_.name||null==_.name),y=Be.values,d(p,ve,!0),d(x,_e,l),d(x,xe,!0),d(x,ye,p),(s?new p(1)[me]==l:me in x)||G(x,me,{get:function(){return l}}),e[l]=p,a(a.G+a.W+a.F*(p!=g),e),a(a.S,l,{BYTES_PER_ELEMENT:t}),a(a.S+a.F*o((function(){g.of.call(p,1)})),l,{from:ke,of:Re}),Y in x||d(x,Y,t),a(a.P,l,Oe),P(l),a(a.P+a.F*be,l,{set:Fe}),a(a.P+a.F*!n,l,Be),r||x.toString==de||(x.toString=de),a(a.P+a.F*o((function(){new p(1).slice()})),l,{slice:De}),a(a.P+a.F*(o((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!o((function(){x.toLocaleString.call([1,2])}))),l,{toLocaleString:Pe}),R[l]=n?_:y,r||n||d(x,ge,y)}):e.exports=function(){}},function(e,t,n){var r=n(376),i=n(377),o=n(378),a=n(379);e.exports=function(e){return r(e)||i(e)||o(e)||a()},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(59),n(61);var o=i(n(2)),a=i(n(3)),s=i(n(381)),u=i(n(217)),l=i(n(218));n=function(){function e(){(0,o.default)(this,e),this._sceneRawData={},this._sceneDecodeData={},this._reader=new s.default,this.file_ver=1}return(0,a.default)(e,[{key:"putRawScene",value:function(e,t){this.sceneRawData[t+""]=e}},{key:"removeRawScene",value:function(e){this.sceneRawData[e+""]=void 0}},{key:"parseScene",value:function(e,t,n,r){if(e=t?this._reader.sceneDecode(this.sceneRawData[e+""],n,e):this._reader.mapDecode(this.sceneRawData[e+""],n,e)){t&&(e={scene:e,floors:[]});for(var i=e.scene.layerGroups,o=0;o<i.length;o++){var a=i[o];a.elevation=a.height}return e}}},{key:"parseFloor",value:function(e,t,n){return[e=this._reader.floorGeoDecode(e),t=this._reader.floorBizDecode(t),n=this._reader.floorNaviDecode(n)]}},{key:"isSceneHasZone",value:function(e){if(!e)return!1;if(!(e=this._sceneDecodeData[e+""]))return!1;var t=!1;return e.floors.forEach((function(e){0<e.navi[0].naviZones.length&&(t=!0)})),t}},{key:"putDecodeScene",value:function(e,t){this.file_ver=e.scene.file_ver,this.sceneDecodeData[t+""]=e}},{key:"removeDecodeScene",value:function(e){this.sceneDecodeData[e+""]=void 0}},{key:"getRawScene",value:function(e){return this.sceneRawData[e+""]}},{key:"getDecodeScene",value:function(e){return this.sceneDecodeData[e+""]}},{key:"dispose",value:function(){for(var e in this._reader.dispose(),this.sceneRawData)this.sceneRawData[e]=void 0;for(var t in this.sceneDecodeData)this.sceneDecodeData[t]=void 0;this.sceneRawData=void 0,this.sceneDecodeData=void 0}},{key:"disposeById",value:function(e){this.sceneRawData[e]=void 0,this.sceneDecodeData[e]=void 0}},{key:"sceneRawData",get:function(){return this._sceneRawData},set:function(e){this._sceneRawData=e}},{key:"sceneDecodeData",get:function(){return this._sceneDecodeData},set:function(e){this._sceneDecodeData=e}}],[{key:"convertGeo2Geometry",value:function(e){var t=(new u.default).parse(e);return e={vertices:t.toStrip(!0)},t.hasHoles()&&(e.holes=t.toStripHoles(!0)),e}},{key:"convertArr2Geometry",value:function(e,t){for(var n=e[0].idxs[0],r=[],i=0;i<n-2;i+=2)r.push(t[i]),r.push(t[i+1]);var o={vertices:r};if(1<e.length){for(var a=[],s=1;s<e.length;s++){for(var u=e[s-1],l=e[s],c=[],h=u;h<l-2;h+=2)c.push(t[h]),c.push(t[h+1]);a.push(c)}o.holes=a}return o}},{key:"convertArray2Geometry",value:function(e,t){return t={vertices:(e=(new l.default).parseGeometry(e,t)).toStrip(!0)},e.hasHoles()&&(t.holes=e.toStripHoles(!0)),t}},{key:"convertGeo2Points",value:function(e){return{vertices:(e=(new u.default).parse(e)).points}}},{key:"convertArrayPoints",value:function(e,t){return{vertices:(t=(new l.default).parse(e,t)).points}}},{key:"checkClockwise",value:function(e){for(var t=Number.NEGATIVE_INFINITY,n=0,r=0,i=0,o=0;o<e.length;o+=2)e[o]>t&&(t=e[o],n=o);var a=new fm.Vector3(e[n],e[n+1],0);return r=0===n?e.length-2:n-2,i=n===e.length-2?0:n+2,r=new fm.Vector3(e[r],e[r+1],0),i=new fm.Vector3(e[i],e[i+1],0),r=(new fm.Vector3).copy(a).sub(r),a=(new fm.Vector3).copy(i).sub(a),0<(a=r.cross(a)).z}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(59),n(62);var o=i(n(2)),a=i(n(3)),s=1e-5,u=1e-5,l=.001;n=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,null,[{key:"epsilon",value:function(){return l}},{key:"isZero",value:function(e){return e<s&&-s<e}},{key:"gtZero",value:function(e){return s<e}},{key:"ltZero",value:function(e){return e<-s}},{key:"pointDistanceToLine",value:function(t,n,r,i){var o=n.x,a=n.y,s=r.x,u=r.y,l=t.x,c=t.y,h=s-o,f=u-a,d=Math.sqrt(h*h+f*f),p=l-o,g=c-a;return t=Math.sqrt(p*p+g*g),e.isZero(d)?(i.x=n.x,i.y=n.y,e.isZero(t)?0:t):(g=(h/=d)*p+(f/=d)*g,e.gtZero(g)?e.ltZero(g-d)?(l-=h=o+g*h,c-=f=a+g*f,c=Math.sqrt(l*l+c*c),i.x=h,i.y=f,c):(s=l-s,u=c-u,u=Math.sqrt(s*s+u*u),i.x=r.x,i.y=r.y,u):(i.x=n.x,i.y=n.y,t))}},{key:"distanceOfTwoPoints",value:function(e,t){return e&&t?Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)):Number.NaN}},{key:"isSamePoint",value:function(e,t){return Math.abs(e.x-t.x)<=u&&Math.abs(e.y-t.y)<=u}},{key:"isNearlySamePoint",value:function(e,t){return Math.abs(e.x-t.x)<=.01&&Math.abs(e.y-t.y)<=.01}},{key:"getPolygonInnerPoint",value:function(t){if(t&&0==t.length)return{x:0,y:0};if(t.length<3)return t[0];var n=t[0],r=t[1],i=(n.x+r.x)/2,o=(n.y+r.y)/2,a=Math.atan2(r.y-n.y,r.x-n.x);a-=Math.PI/2;for(var s=3;.5<s;){var u={x:i+s*Math.cos(a),y:o+s*Math.sin(a)};if(e.isInPolygon(u,t))return u;s/=2}for(a+=Math.PI,s=3;.5<s;){var l={x:i+s*Math.cos(a),y:o+s*Math.sin(a)};if(e.isInPolygon(l,t))return l;s/=2}return{x:0,y:0}}},{key:"isInPolygon",value:function(e,t){for(var n=!1,r=t.length,i=0,o=r-1;i<r;o=i,++i){var a=t[i].x,s=t[i].y,u=t[o].x,l=t[o].y;if(a==e.x&&s==e.y||u==e.x&&l==e.y)return!0;if(s<e.y&&l>=e.y||s>=e.y&&l<e.y){if((s=a+(e.y-s)*(u-a)/(l-s))==e.x)return!0;s>e.x&&(n=!n)}}return n}},{key:"isInCircle",value:function(e,t,n,r){if(e.x<r[0]&&e.x>r[1])return!1;if(e.y<r[2]&&e.y>r[3])return!1;var i=n*n;return r=e.x,n=e.y,(n=(r=(e=t.x)-r)*r+(n=(t=t.y)-n)*n)<i}},{key:"isRectCross",value:function(e,t,n,r){return!(Math.max(e.x,t.x)<Math.min(n.x,r.x)||Math.max(e.y,t.y)<Math.min(n.y,r.y)||Math.max(n.x,r.x)<Math.min(e.x,t.x)||Math.max(n.y,r.y)<Math.min(e.y,t.y))}},{key:"pointIsInRect",value:function(e,t,n,r){return Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<r}},{key:"pointIsInRect1",value:function(e,t,n){var r=Math.min(t.x,n.x),i=Math.max(t.x,n.x),o=Math.min(t.y,n.y);return n=Math.max(t.y,n.y),!(e.x<r||e.x>i||e.y<o||e.y>n)}},{key:"cross",value:function(e,t,n){return(e.x-n.x)*(t.y-n.y)-(t.x-n.x)*(e.y-n.y)}},{key:"isLineSegmentCross",value:function(t,n,r,i){return!(Math.max(t.x,n.x)<Math.min(r.x,i.x)||Math.max(t.y,n.y)<Math.min(r.y,i.y)||Math.max(r.x,i.x)<Math.min(t.x,n.x)||Math.max(r.y,i.y)<Math.min(t.y,n.y)||e.cross(r,n,t)*e.cross(n,i,t)<0||e.cross(t,i,r)*e.cross(i,n,r)<0)}},{key:"rayCrossSegment",value:function(e,t,n,r,i){var o=Math.min(e.x,n.x,r.x),a=Math.max(e.x,n.x,r.x),s=Math.min(e.y,n.y,r.y),u=Math.max(e.y,n.y,r.y);return u=Math.sqrt((a-o)*(a-o)+(u-s)*(u-s)),s=t/180*Math.PI,t=u*Math.cos(s)+e.x,s=u*Math.sin(s)+e.y,1==this.calcCrossPoint(e,{x:t,y:s},n,r,i)}},{key:"calcCrossPoint",value:function(t,n,r,i,o){if(1!=e.isLineSegmentCross(t,n,r,i))return 0;var a=(i.x-r.x)*(t.y-n.y)-(n.x-t.x)*(r.y-i.y),s=(t.y-r.y)*(n.x-t.x)*(i.x-r.x)+r.x*(i.y-r.y)*(n.x-t.x)-t.x*(n.y-t.y)*(i.x-r.x);return o.x=s/a,a=(t.x-n.x)*(i.y-r.y)-(n.y-t.y)*(r.x-i.x),s=n.y*(t.x-n.x)*(i.y-r.y)+(i.x-n.x)*(i.y-r.y)*(t.y-n.y)-i.y*(r.x-i.x)*(n.y-t.y),o.y=s/a,1}},{key:"pointInPolygon2d",value:function(e,t,n){for(var r=!1,i=null,o=null,a=0;a<n;a++)i=e[a],o=e[(a+1)%n],(i.y<t.y&&o.y>=t.y||o.y<t.y&&i.y>=t.y)&&(i.x<=t.x||o.x<=t.x)&&i.x+(t.y-i.y)/(o.y-i.y)*(o.x-i.x)<t.x&&(r=!r);return r}},{key:"pointInPolygon2d1",value:function(e,t,n){for(var r=0,i=null,o=null,a=null,s=0;s<n;s++)if(i=e[s],o=e[(s+1)%n],(i.y<t.y&&o.y>=t.y||o.y<t.y&&i.y>=t.y)&&(i.x<=t.x||o.x<=t.x)){if(a=i.x+(t.y-i.y)/(o.y-i.y)*(o.x-i.x),Math.abs(a-t.x)<=l)return 2;a<t.x&&(r=!r)}return r}},{key:"pointInPolygonVector2d",value:function(e,t,n){for(var r=!1,i=null,o=null,a=0,s=n/2,u=0;u<s;u++)i={x:e[a=2*u],y:e[a+1]},o={x:e[(a+2)%n],y:e[(a+3)%n]},(i.y<t.y&&o.y>=t.y||o.y<t.y&&i.y>=t.y)&&(i.x<=t.x||o.x<=t.x)&&i.x+(t.y-i.y)/(o.y-i.y)*(o.x-i.x)<t.x&&(r=!r);return r}},{key:"pointToSegmentDistance",value:function(e,t,n){var r=e.x,i=e.y,o=t.x,a=t.y,s=n.x;return(t=(s-o)*(r-o)+((e=n.y)-a)*(i-a))<=0?Math.sqrt((r-o)*(r-o)+(i-a)*(i-a)):(n=(s-o)*(s-o)+(e-a)*(e-a))<=t?Math.sqrt((r-s)*(r-s)+(i-e)*(i-e)):(o+=(s-o)*(n=t/n),n=a+(e-a)*n,Math.sqrt((r-o)*(r-o)+(n-i)*(n-i)))}},{key:"pointToPolygon2d",value:function(t,n,r){for(var i=null,o=null,a=Number.MAX_VALUE,s=0;s<r;s++){i=t[s],o=t[(s+1)%r];var u=e.pointToSegmentDistance(n,i,o);u<a&&(a=u)}return a}},{key:"lineInCircle2d",value:function(t,n,r,i,o){if(t.x<o[0]&&n.x<o[0])return!1;if(t.x>o[1]&&n.x>o[1])return!1;if(t.y<o[2]&&n.y<o[2])return!1;if(t.y>o[3]&&n.y>o[3])return!1;var a=i*i,s=t.x,u=t.y,l=n.x,c=n.y,h=r.x,f=r.y,d=l-s;return i=d*d+(o=c-u)*o,r=(t=h-s)*t+(n=f-u)*n,e.isZero(i)?!!e.isZero(r)||r<a:(n=(d/=i=Math.sqrt(i))*t+(o/=i)*n,e.gtZero(n)?e.ltZero(n-i)?(o=(d=h-(d=s+n*d))*d+(o=f-(o=u+n*o))*o)<a:(c=(l=h-l)*l+(c=f-c)*c)<a:r<a)}},{key:"lineInPolygon2d",value:function(t,n,r,i){if(t.x<i[0]&&n.x<i[0])return!1;if(t.x>i[1]&&n.x>i[1])return!1;if(t.y<i[2]&&n.y<i[2])return!1;if(t.y>i[3]&&n.y>i[3])return!1;var o=r.length;if(e.pointInPolygon2d(r,t,o))return!0;if(e.pointInPolygon2d(r,n,o))return!0;for(var a=0;a<o;a++){var s=(a+1)%o;if(e.isLineSegmentCross(t,n,r[a],r[s]))return!0}return!1}},{key:"calcLineCircleCrossPoints2d",value:function(t,n,r,i,o){if(t.x<o[0]&&n.x<o[0])return null;if(t.x>o[1]&&n.x>o[1])return null;if(t.y<o[2]&&n.y<o[2])return null;if(t.y>o[3]&&n.y>o[3])return null;var a={isContain:!1,crossPoints:[]},u=i*i,l=t.x,c=t.y,h=n.x,f=n.y,d=r.x,p=r.y,g=h-l,m=f-c,v=g*g+m*m;return r=(o=d-l)*o+(i=p-c)*i,f=(h=d-h)*h+(f=p-f)*f,e.isZero(v)?((e.isZero(r)||r<u)&&(a.isContain=!0,a.crossPoints=[t,n]),a):r<u&&f<u?(a.isContain=!0,a.crossPoints=[t,n],a):(g=o*(n=g/(t=Math.sqrt(v)))+i*(v=m/t),u-(i=o*o+i*i)+(m=g*g)<0?null:(i=Math.sqrt(u-i+m),-s<+(m=g-i)&&m-t<s&&a.crossPoints.push({x:l+m*n,y:c+m*v}),-s<+(m=g+i)&&m-t<s&&a.crossPoints.push({x:l+m*n,y:c+m*v}),a))}},{key:"calcLinePolygonCrossPoints2d",value:function(t,n,r,i){if(t.x<i[0]&&n.x<i[0])return null;if(t.x>i[1]&&n.x>i[1])return null;if(t.y<i[2]&&n.y<i[2])return null;if(t.y>i[3]&&n.y>i[3])return null;var o={containType:0,crossPoints:[]},a=r.length;e.pointInPolygon2d(r,t,a)&&(o.containType|=1),e.pointInPolygon2d(r,n,a)&&(o.containType|=2);for(var s=[],u=0;u<a;u++){var l,c=(u+1)%a,h={};e.calcCrossPoint(t,n,r[u],r[c],h)&&(l=h.x-t.x,c=h.y-t.y,s.push({dis2:l*l+c*c,point:h}))}if(0==s.length)return null;s.sort((function(e,t){return t.dis2-e.dis2}));for(var f=0;f<s.length;f++)o.crossPoints.push(s[f].point);return o}},{key:"calcCenterOfGravityPoint",value:function(e,t){for(var n=0,r=0,i=0,o=0;o<t;o++){var a=e[o],s=e[(o+1)%t],u=(a.x*s.y-a.y*s.x)/2;n+=u,r+=u*(a.x+s.x)/3,i+=u*(a.y+s.y)/3}return{x:r/=n,y:i/=n}}},{key:"calcPolygonArea2d",value:function(e){var t=e.length;if(t<3)return 0;for(var n=0,r=0;r<t;++r){var i=e[r],o=e[(r+1)%t];n+=i.x*o.y-i.y*o.x}return Math.abs(n/2)}},{key:"quickRayIntersect",value:function(t,n,r,i,o){var a=Math.min(r.x,i.x),s=Math.max(r.x,i.x),u=Math.min(r.y,i.y),c=Math.max(r.y,i.y),h=t.x,f=t.y,d=r.x,p=r.y,g=i.x,m=i.y;if(90==n){if(t.x<a||t.x>s)return!1;var v=(v=(m-p)/(g-d))*(h-d)+p;return o.y=v,o.x=h,!(v<f||!e.pointIsInRect1(o,r,i))}if(270==n)return!(t.x<a||t.x>s||(t=(m-p)/(g-d),t=t*(h-d)+p,o.y=t,o.x=h,f<t||!e.pointIsInRect1(o,r,i)));if(270!=n&&90!=n&&s-a<l&&(s=a,a=(a=Math.tan(n/180*Math.PI))*(s-h)+f,o.y=a,o.x=s,e.pointIsInRect1(o,r,i)))return s-=h,a-=f,0<(s/=Math.sqrt(s*s+a*a))*Math.cos(n/180*Math.PI);if(c-u<=1e-6){if(c=u,u=1/(u=Math.tan(n/180*Math.PI))*(c-f)+h,o.x=u,o.y=c,e.pointIsInRect1(o,r,i)){var y=c-f;return 0<(u=(u-=h)/Math.sqrt(u*u+y*y))*Math.cos(n/180*Math.PI)}return!1}return y=f+(y=Math.tan(n/180*Math.PI))*((g=(p-f-((g=(m-p)/(g-d))*d-y*h))/(y-g))-h),o.x=g,o.y=y,!!e.pointIsInRect1(o,r,i)&&(f=y-f,0<(f=(h=g-h)/Math.sqrt(h*h+f*f))*Math.cos(n/180*Math.PI))}},{key:"calcFootOfUpright",value:function(t,n,r,i){var o=Math.min(n.x,r.x),a=Math.max(n.x,r.x),s=Math.min(n.y,r.y),l=Math.max(n.y,r.y),c=t.x,h=t.y,f=n.x,d=n.y,p=r.x;return t=r.y,Math.abs(f-p)<u?(i.x=f,i.y=h,s<=h&&h<=l):Math.abs(d-t)<u?(i.x=c,i.y=d,o<=c&&c<=a):(c=h+(a=-1/(a=(t-d)/(p-f)))*((p=(d-h-((p=(t-d)/(p-f))*f-a*c))/(a-p))-c),i.x=p,i.y=c,!!e.pointIsInRect1(i,n,r))}},{key:"vectorCross",value:function(e,t){return{x:e.y*t.z-e.z*t.y,y:e.z*t.x-e.x*t.z,z:e.x*t.y-e.y*t.x}}},{key:"vectorDot",value:function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}},{key:"vectorLength",value:function(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}},{key:"vector2DDot",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"vector2DLength",value:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)}},{key:"calcRotateAngle",value:function(t,n){if(0==t.x&&0==t.y||0==n.x&&0==n.y)return 0;var r={x:t.x,y:t.y,z:0},i={x:n.x,y:n.y,z:0};return r=e.vectorCross(r,i),i=e.vector2DDot(t,n),n=Math.acos(i/(e.vector2DLength(t)*e.vector2DLength(n))),0<r.z?n/Math.PI*180:360-n/Math.PI*180}},{key:"isPointOnSegment",value:function(e,t,n){return(e.x-t.x)*(n.y-t.y)==(n.x-t.x)*(e.y-t.y)&&Math.min(t.x,n.x)<=e.x&&e.x<=Math.max(t.x,n.x)&&Math.min(t.y,n.y)<=e.y&&e.y<=Math.max(t.y,n.y)}},{key:"segCrossPolygon",value:function(e,t,n,r){for(var i=0;i<n.length;i++){var o=n[i],a=n[(i+1)%n.length];if(1==this.calcCrossPoint(e,t,o,a,r))return!0}return!1}}]),e}(),t.default=n},function(e,t,n){var r=n(36),i=n(74);e.exports=n(33)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(17),i=n(18);function o(t){return e.exports=o="function"==typeof r&&"symbol"==s(i)?function(e){return s(e)}:function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":s(e)},e.exports.default=e.exports,e.exports.__esModule=!0,o(t)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t,n){"use strict";var r=n(38),i=n(46),o=n(39),a=n(54),s=n(143),u=n(104),l=Math.max,c=Math.min,h=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g,p=function(e){return void 0===e?e:String(e)};n(106)("replace",2,(function(e,t,n,g){return[function(r,i){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(e,t){var i=g(n,e,this,t);if(i.done)return i.value;var h=r(e),f=String(this),d="function"==typeof t;d||(t=String(t));var v,y=h.global;y&&(v=h.unicode,h.lastIndex=0);for(var _=[];null!==(w=u(h,f))&&(_.push(w),y);)""===String(w[0])&&(h.lastIndex=s(f,o(h.lastIndex),v));for(var x="",A=0,I=0;I<_.length;I++){for(var w=_[I],b=String(w[0]),C=l(c(a(w.index),f.length),0),M=[],E=1;E<w.length;E++)M.push(p(w[E]));var T,S=w.groups;S=d?(T=[b].concat(M,C,f),void 0!==S&&T.push(S),String(t.apply(void 0,T))):m(b,f,C,M,S,t),A<=C&&(x+=f.slice(A,C)+S,A=C+b.length)}return x+f.slice(A)}];function m(e,t,r,o,a,s){var u=r+e.length,l=o.length,c=d;return void 0!==a&&(a=i(a),c=f),n.call(s,c,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(u);case"<":s=a[i.slice(1,-1)];break;default:var c=+i;if(0===c)return n;if(l<c){var f=h(c/10);return 0!==f&&f<=l?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):n}s=o[c-1]}return void 0===s?"":s}))}}))},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(89);e.exports=function(e){return Object(r(e))}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){"use strict";var r=n(31),i=n(58),o=n(69),a=n(178),s=n(82),u=n(26),l=n(102).f,c=n(137).f,h=n(41).f,f=n(298).trim,d="Number",p=x=r[d],g=x.prototype,m=o(n(141)(g))==d,v="trim"in String.prototype,y=function(e){if("string"==typeof(r=s(e,!1))&&2<r.length){var t,n,r,i=(r=v?r.trim():f(r,3)).charCodeAt(0);if(43===i||45===i){if(88===(e=r.charCodeAt(2))||120===e)return NaN}else if(48===i){switch(r.charCodeAt(1)){case 66:case 98:t=2,n=49;break;case 79:case 111:t=8,n=55;break;default:return+r}for(var o,a=r.slice(2),u=0,l=a.length;u<l;u++)if((o=a.charCodeAt(u))<48||n<o)return NaN;return parseInt(a,t)}}return+r};if(!x(" 0o1")||!x("0b1")||x("+0x1")){for(var _,x=function(e){e=arguments.length<1?0:e;var t=this;return t instanceof x&&(m?u((function(){g.valueOf.call(t)})):o(t)!=d)?a(new p(y(e)),t,x):y(e)},A=n(30)?l(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),I=0;A.length>I;I++)i(p,_=A[I])&&!i(x,_)&&h(x,_,c(p,_));x.prototype=g,g.constructor=x,n(45)(r,d,x)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";n(109)("sub",(function(e){return function(){return e(this,"sub","","")}}))},function(e,t,n){"use strict";var r=n(23),i=n(136),o=n(46),a=n(26),s=[].sort,u=[1,2,3];r(r.P+r.F*(a((function(){u.sort(void 0)}))||!a((function(){u.sort(null)}))||!n(147)(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},function(e,t,n){e.exports=n(349)},function(e,t,n){"use strict";n(109)("fontsize",(function(e){return function(t){return e(this,"font","size",t)}}))},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(35));n(21);var a=i(n(2)),s=i(n(3));n=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,null,[{key:"toColor",value:function(e){if("number"==typeof e)return e;var t=e.split(",");return 3<=t.length?(0,o.default)(t[0])<<16|(0,o.default)(t[1])<<8|(0,o.default)(t[2]):(console.error("color format error",e),0)}},{key:"toRgba",value:function(e){if("number"==typeof e)return"rgba("+(0,o.default)(255*new fm.Color(e).r)+","+(0,o.default)(255*new fm.Color(e).g)+","+(0,o.default)(255*new fm.Color(e).b)+",1)";var t=e.split(",");return 3<=t.length?"rgba("+(0,o.default)(t[0])+","+(0,o.default)(t[1])+","+(0,o.default)(t[2])+",1)":e}},{key:"bindEvent",value:function(e,t,n,r){e.addEventListener(n,(function(e){var n,i=e||window.event,o=i.target||i.srcElement,a=i.currentTarget;for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;0<=--n&&t.item(n)!==this;);return-1<n});o!==a;)o.matches(t)&&(n=o,r.call(n,i)),o=o.parentNode}))}},{key:"toSceneCoord",value:function(e,t){var n=0;return t.groupID&&(n=e.getFMGroup(t.groupID).height),new fm.Vector3(t.x-e.center.x,e.center.y+n,-t.y+e.center.y)}},{key:"removeFormArray",value:function(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)}},{key:"scrollTopAnFun",value:function(){var e,t=!1;return function n(r){var i=r.el,o=r.to,a=r.form,s=(r.time,o<a?"up":"bottom"),u=(a<o?o-a:o==a?0:a-o)/10,l=0,c=function(){t=!1,e=!1,0==a&&(i.scrollTop=0)};t?(e=0,window.setTimeout((function(){var e=Object(r,{to:i.scrollTop});t=!1,n(e)}),11)):(t=!0,e=u,function t(){var n;--e<=0?c():(n=function(){!1!==e&&(l=function(e){var t=e.val,n=e.nbak,r=e.n;return e=e.elTop,"up"==s?e+(n-r)*t:e-(n-r)*t}({val:10,nbak:u,n:e,elTop:o,VDIRECTIONE:s}),l&&(i.scrollTop=l),t())},window.setTimeout(n,10))}())}}},{key:"toVector",value:function(e){return e.hasOwnProperty("z")?new fm.Vector3(e.x,e.y,e.z):new fm.Vector2(e.x,e.y)}},{key:"sleep",value:function(e){for(var t=(new Date).getTime(),n=0;n<1e7&&!((new Date).getTime()-t>e);n++);}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(19)),a=i(n(2)),s=i(n(3));n=function(){function e(t,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1e3,i=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0;(0,a.default)(this,e),this._left=(0,o.default)({},t),this._right=(0,o.default)({},n),this._time=r,this._enable=!1,this._countTime=0,this._endBack=i,this._runBack=s,this.speed=1,this._result=(0,o.default)({},t)}return(0,s.default)(e,[{key:"run",value:function(e){var t,n=e*this.speed,r={};if(this._countTime+n>this._time){for(var i in this._left){var o=(this._right[i]-this._left[i])*(this._time-this._countTime)/this._time;this._result[i]+=o,r[i]=o}return this._enable=!1,this._runBack(this._result,r),this._endBack(this._result,r),this._result={},void(this._countTime=0)}for(t in this._left){var a=(this._right[t]-this._left[t])*n/this._time;this._result[t]+=a,r[t]=a}this._countTime+=n,this._runBack(this._result,r)}},{key:"pause",value:function(){return this._enable=!1,this}},{key:"resume",value:function(){return this._enable=!0,this}},{key:"stop",value:function(){return this._enable=!1,this._countTime=0,this._result=(0,o.default)({},this._left),this}},{key:"start",value:function(){return this._enable=!0,this}},{key:"enable",get:function(){return this._enable},set:function(e){this._enable=e}}]),e}(),t.default=n},function(e,t,n){var r=n(123),i=n(89);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(91)("meta"),i=n(22),o=n(52),a=n(36).f,u=0,l=Object.isExtensible||function(){return!0},c=!n(43)((function(){return l(Object.preventExtensions({}))})),h=function(e){a(e,r,{value:{i:"O"+ ++u,w:{}}})},f=(n=function(e){return c&&f.NEED&&l(e)&&!o(e,r)&&h(e),e},e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==s(e)?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!l(e))return"F";if(!t)return"E";h(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!l(e))return!0;if(!t)return!1;h(e)}return e[r].w},onFreeze:n})},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports={}},function(e,t,n){"use strict";var r=n(191),i=n(318),o=n(70),a=n(101);e.exports=n(192)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){var r=n(42),i=n(201),o=n(202),a=n(37),s=n(90),u=n(203),l={},c={};t=e.exports=function(e,t,n,h,f){f=f?function(){return e}:u(e);var d,p,g,m,v=r(n,h,t?2:1),y=0;if("function"!=typeof f)throw TypeError(e+" is not iterable!");if(o(f)){for(d=s(e.length);y<d;y++)if((m=t?v(a(p=e[y])[0],p[1]):v(e[y]))===l||m===c)return m}else for(g=f.call(e);!(p=g.next()).done;)if((m=i(g,v,p.value,t))===l||m===c)return m},t.BREAK=l,t.RETURN=c},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.mapOptionMessage=t.tileMessage=t.cerityMessage=void 0,n={warn_nokey:"key%E5%80%BC%E6%9C%AA%E9%85%8D%E7%BD%AE%EF%BC%8C%E8%AF%B7%E8%AE%BF%E9%97%AE%E8%9C%82%E9%B8%9F%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%9F%A5%E7%9C%8B%E5%BA%94%E7%94%A8%E5%90%8D%E7%A7%B0%E3%80%82",warn_noappname:"%E5%BA%94%E7%94%A8%E5%90%8D%E7%A7%B0%EF%BC%88appname%EF%BC%89%E6%9C%AA%E9%85%8D%E7%BD%AE%EF%BC%8C%E8%AF%B7%E8%AE%BF%E9%97%AE%E8%9C%82%E9%B8%9F%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%9F%A5%E7%9C%8B%E5%BA%94%E7%94%A8%E5%90%8D%E7%A7%B0%E3%80%82",warn_nomapid:"%E5%9C%B0%E5%9B%BEID%E6%9C%AA%E9%85%8D%E7%BD%AE%EF%BC%8C%E8%AF%B7%E8%AE%BF%E9%97%AE%E8%9C%82%E9%B8%9F%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%9F%A5%E7%9C%8B%E5%9C%B0%E5%9B%BEID%E3%80%82",warn_keynotright:"%E6%82%A8%E9%85%8D%E7%BD%AE%E7%9A%84key%E5%80%BC%E4%B8%8D%E6%AD%A3%E7%A1%AE%EF%BC%8C%E8%AF%B7%E8%AE%BF%E9%97%AE%E8%9C%82%E9%B8%9F%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%A3%80%E6%9F%A5%E6%AD%A4%E5%BA%94%E7%94%A8%E4%B8%8B%E7%9A%84key%E5%80%BC%E3%80%82",warn_offline:"%E6%82%A8%E9%85%8D%E7%BD%AE%E7%9A%84%E5%BA%94%E7%94%A8%E5%90%8D%E7%A7%B0%EF%BC%88appname%EF%BC%89%E6%88%96key%E5%80%BC%E4%B8%8D%E6%AD%A3%E7%A1%AE%EF%BC%8C%E8%AF%B7%E8%AE%BF%E9%97%AE%E8%9C%82%E9%B8%9F%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%A3%80%E6%9F%A5%E6%82%A8%E7%9A%84%E5%BA%94%E7%94%A8%E3%80%82",warn_openerror:"%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E5%A4%B1%E8%B4%A5",warn_connecterror:"%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E5%88%B0%E8%9C%82%E9%B8%9F%E4%BA%91",warn_downloaderror:"%E4%BB%8E%E8%9C%82%E9%B8%9F%E4%BA%91%E4%B8%8A%E8%8E%B7%E5%BE%97%E5%9C%B0%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%A4%B1%E8%B4%A5",warn_local:"%E6%9C%AC%E5%9C%B0%E9%AA%8C%E8%AF%81%E5%A4%B1%E8%B4%A5"},t.cerityMessage=n,n={noGroup:"目标楼层未初始化，请检查楼层id是否越界，或者等待楼层加载！",noFocus:"焦点层不在可视楼层中，请检查焦点层和可视楼层的参数设置！"},t.tileMessage=n,n={defaultViewCenterError:"地图初始化中心位置错误，请检查fengmap.FMMap初始化参数defaultViewCenter的正确性"},t.mapOptionMessage=n},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.AmbientLight=Dh,t.AmbientLightProbe=af,t.AnimationClip=Hc,t.AnimationLoader=Kc,t.AnimationMixer=Of,t.AnimationObjectGroup=Nf,t.ArcCurve=oh,t.ArrayCamera=tu,t.ArrowHelper=bd,t.Audio=mf,t.AudioAnalyser=If,t.AudioListener=gf,t.AudioLoader=tf,t.AxesHelper=Cd,t.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Cd(e)},t.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new $c(e)},t.Bone=Nu,t.BooleanKeyframeTrack=Dc,t.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new yd(e,t)},t.Box2=jf,t.Box3=ii,t.Box3Helper=_d,t.BoxHelper=yd,t.BufferAttribute=Hi,t.BufferGeometry=uo,t.BufferGeometryLoader=Vh,t.Camera=Ho,t.CameraHelper=gd,t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},t.CanvasTexture=ol,t.CatmullRomCurve3=hh,t.CircleBufferGeometry=vc,t.CircleGeometry=mc,t.Clock=cf,t.ClosedSplineCurve3=rp,t.Color=Pi,t.ColorKeyframeTrack=Fc,t.CompressedTexture=il,t.CompressedTextureLoader=Qc,t.ConeBufferGeometry=gc,t.ConeGeometry=pc,t.CubeCamera=qo,t.CubeTexture=va,t.CubeTextureLoader=th,t.CubicBezierCurve=gh,t.CubicBezierCurve3=mh,t.CubicInterpolant=Rc,t.Curve=rh,t.CurvePath=wh,t.CylinderBufferGeometry=dc,t.CylinderGeometry=fc,t.Cylindrical=Vf,t.DataTexture=Zo,t.DataTexture2DArray=ya,t.DataTexture3D=_a,t.DataTextureLoader=$c,t.DepthTexture=al,t.DirectionalLight=Oh,t.DirectionalLightHelper=fd,t.DirectionalLightShadow=Ph,t.DiscreteInterpolant=Pc,t.DodecahedronBufferGeometry=_l,t.DodecahedronGeometry=yl,t.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Hi(e,t).setUsage(qn)},t.EdgesGeometry=hc,t.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Xu(new hc(e.geometry),new Gu({color:void 0!==t?t:16777215}))},t.EllipseCurve=ih,t.Euler=Tr,t.EventDispatcher=tr,t.ExtrudeBufferGeometry=Kl,t.ExtrudeGeometry=Jl,t.Face3=Bi,t.Face4=function(e,t,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Bi(e,t,n,i,o,a)},t.FileLoader=Jc,t.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Ki(e,t)},t.Float32BufferAttribute=Ki,t.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Qi(e,t)},t.Float64BufferAttribute=Qi,t.Fog=au,t.FogExp2=ou,t.Font=Kh,t.FontLoader=$h,t.Frustum=Qo,t.Geometry=Po,t.GridHelper=sd,t.Group=nu,t.HemisphereLight=Eh,t.HemisphereLightHelper=ad,t.HemisphereLightProbe=of,t.IcosahedronBufferGeometry=vl,t.IcosahedronGeometry=ml,t.ImageBitmapLoader=Zh,t.ImageLoader=eh,t.ImmediateRenderObject=Xf,t.InstancedBufferAttribute=Uh,t.InstancedBufferGeometry=zh,t.InstancedInterleavedBuffer=Ff,t.InstancedMesh=Bu,t.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new qi(e,t)},t.Int16BufferAttribute=qi,t.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Zi(e,t)},t.Int32BufferAttribute=Zi,t.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new ji(e,t)},t.Int8BufferAttribute=ji,t.InterleavedBuffer=su,t.InterleavedBufferAttribute=cu,t.Interpolant=kc,t.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},t.KeyframeTrack=Oc,t.LOD=Tu,t.LatheBufferGeometry=sc,t.LatheGeometry=ac,t.Layers=Sr,t.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},t.Light=Mh,t.LightProbe=rf,t.LightShadow=Th,t.Line=Wu,t.Line3=qf,t.LineBasicMaterial=Gu,t.LineCurve=vh,t.LineCurve3=yh,t.LineDashedMaterial=Tc,t.LineLoop=Zu,t.LineSegments=Xu,t.LinearInterpolant=Nc,t.Loader=Xc,t.LoadingManager=Yc,t.Material=zi,t.MaterialLoader=Bh,t.Matrix3=sr,t.Matrix4=Cr,t.Mesh=Eo,t.MeshBasicMaterial=Ui,t.MeshDepthMaterial=qs,t.MeshDistanceMaterial=Xs,t.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},t.MeshLambertMaterial=Mc,t.MeshMatcapMaterial=Ec,t.MeshNormalMaterial=Cc,t.MeshPhongMaterial=wc,t.MeshPhysicalMaterial=Ic,t.MeshStandardMaterial=Ac,t.MeshToonMaterial=bc,t.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},t.NumberKeyframeTrack=Bc,t.Object3D=Hr,t.ObjectLoader=jh,t.OctahedronBufferGeometry=gl,t.OctahedronGeometry=pl,t.OrthographicCamera=Nh,t.PMREMGenerator=jd,t.ParametricBufferGeometry=ll,t.ParametricGeometry=ul,t.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new bu(e)},t.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ju(e)},t.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new tl(e,t)},t.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ju(e)},t.Path=bh,t.PerspectiveCamera=jo,t.Plane=_i,t.PlaneBufferGeometry=ra,t.PlaneGeometry=na,t.PlaneHelper=xd,t.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new tl(e,t)},t.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ju(e)},t.PointLight=Rh,t.PointLightHelper=nd,t.Points=tl,t.PointsMaterial=Ju,t.PolarGridHelper=ud,t.PolyhedronBufferGeometry=hl,t.PolyhedronGeometry=cl,t.PositionalAudio=Af,t.PropertyBinding=Rf,t.PropertyMixer=wf,t.QuadraticBezierCurve=_h,t.QuadraticBezierCurve3=xh,t.Quaternion=pr,t.QuaternionKeyframeTrack=zc,t.QuaternionLinearInterpolant=Gc,t.RawShaderMaterial=xc,t.Ray=gi,t.Raycaster=Bf,t.RectAreaLight=Fh,t.RingBufferGeometry=oc,t.RingGeometry=ic,t.Scene=jr,t.ShaderMaterial=Vo,t.ShadowMaterial=_c,t.Shape=Ch,t.ShapeBufferGeometry=lc,t.ShapeGeometry=uc,t.ShapePath=Jh,t.Skeleton=Ru,t.SkeletonHelper=td,t.SkinnedMesh=Su,t.Sphere=si,t.SphereBufferGeometry=rc,t.SphereGeometry=nc,t.Spherical=Uf,t.SphericalHarmonics3=nf,t.Spline=op,t.SplineCurve=Ah,t.SplineCurve3=ip,t.SpotLight=Lh,t.SpotLightHelper=Jf,t.SpotLightShadow=Sh,t.Sprite=bu,t.SpriteMaterial=hu,t.StereoCamera=lf,t.StringKeyframeTrack=Uc,t.TetrahedronBufferGeometry=dl,t.TetrahedronGeometry=fl,t.TextBufferGeometry=tc,t.TextGeometry=ec,t.Texture=cr,t.TextureLoader=nh,t.TorusBufferGeometry=Cl,t.TorusGeometry=bl,t.TorusKnotBufferGeometry=wl,t.TorusKnotGeometry=Il,t.Triangle=Li,t.TubeBufferGeometry=Al,t.TubeGeometry=xl,t.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Xi(e,t)},t.Uint16BufferAttribute=Xi,t.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Ji(e,t)},t.Uint32BufferAttribute=Ji,t.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Wi(e,t)},t.Uint8BufferAttribute=Wi,t.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Yi(e,t)},t.Uint8ClampedBufferAttribute=Yi,t.Uniform=Df,t.Vector2=ar,t.Vector3=vr,t.Vector4=hr,t.VectorKeyframeTrack=Vc,t.Vertex=function(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new vr(e,t,n)},t.VideoTexture=rl,t.WebGLCubeRenderTarget=Xo,t.WebGLMultisampleRenderTarget=dr,t.WebGLRenderTarget=fr,t.WebGLRenderTargetCube=function(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Xo(e,n)},t.WebGLRenderer=iu,t.WebGLUtils=eu,t.WireframeGeometry=sl,t.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Xu(new sl(e.geometry),new Gu({color:void 0!==t?t:16777215}))},t.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Jc(e)},t.NeverDepth=t.NearestMipmapNearestFilter=t.NearestMipmapLinearFilter=t.NearestMipMapNearestFilter=t.NearestMipMapLinearFilter=t.NearestFilter=t.MultiplyOperation=t.MultiplyBlending=t.MixOperation=t.MirroredRepeatWrapping=t.MinEquation=t.MaxEquation=t.MathUtils=t.Math=t.MOUSE=t.LuminanceFormat=t.LuminanceAlphaFormat=t.LoopRepeat=t.LoopPingPong=t.LoopOnce=t.LogLuvEncoding=t.LoaderUtils=t.LinearToneMapping=t.LinearMipmapNearestFilter=t.LinearMipmapLinearFilter=t.LinearMipMapNearestFilter=t.LinearMipMapLinearFilter=t.LinearFilter=t.LinearEncoding=t.LineStrip=t.LinePieces=t.LessStencilFunc=t.LessEqualStencilFunc=t.LessEqualDepth=t.LessDepth=t.KeepStencilOp=t.InvertStencilOp=t.InterpolateSmooth=t.InterpolateLinear=t.InterpolateDiscrete=t.IntType=t.IncrementWrapStencilOp=t.IncrementStencilOp=t.ImageUtils=t.HalfFloatType=t.GreaterStencilFunc=t.GreaterEqualStencilFunc=t.GreaterEqualDepth=t.GreaterDepth=t.GeometryUtils=t.GammaEncoding=t.FrontSide=t.FrontFaceDirectionCW=t.FrontFaceDirectionCCW=t.FloatType=t.FlatShading=t.FaceColors=t.EquirectangularRefractionMapping=t.EquirectangularReflectionMapping=t.EqualStencilFunc=t.EqualDepth=t.DynamicReadUsage=t.DynamicDrawUsage=t.DynamicCopyUsage=t.DstColorFactor=t.DstAlphaFactor=t.DoubleSide=t.DepthStencilFormat=t.DepthFormat=t.DefaultLoadingManager=t.DecrementWrapStencilOp=t.DecrementStencilOp=t.CustomBlending=t.CullFaceNone=t.CullFaceFrontBack=t.CullFaceFront=t.CullFaceBack=t.CubeUVRefractionMapping=t.CubeUVReflectionMapping=t.CubeRefractionMapping=t.CubeReflectionMapping=t.ClampToEdgeWrapping=t.CineonToneMapping=t.Cache=t.ByteType=t.CubeGeometry=t.BoxGeometry=t.BoxBufferGeometry=t.BasicShadowMap=t.BasicDepthPacking=t.BackSide=t.AudioContext=t.AnimationUtils=t.AlwaysStencilFunc=t.AlwaysDepth=t.AlphaFormat=t.AdditiveBlending=t.AddOperation=t.AddEquation=t.ACESFilmicToneMapping=void 0,t.UniformsLib=t.Uncharted2ToneMapping=t.UVMapping=t.TrianglesDrawMode=t.TriangleStripDrawMode=t.TriangleFanDrawMode=t.TangentSpaceNormalMap=t.TOUCH=t.SubtractiveBlending=t.SubtractEquation=t.StreamReadUsage=t.StreamDrawUsage=t.StreamCopyUsage=t.StaticReadUsage=t.StaticDrawUsage=t.StaticCopyUsage=t.SrcColorFactor=t.SrcAlphaSaturateFactor=t.SrcAlphaFactor=t.SphericalReflectionMapping=t.SmoothShading=t.ShortType=t.ShapeUtils=t.ShaderLib=t.ShaderChunk=t.SceneUtils=t.SRGB8_ALPHA8_ASTC_8x8_Format=t.SRGB8_ALPHA8_ASTC_8x6_Format=t.SRGB8_ALPHA8_ASTC_8x5_Format=t.SRGB8_ALPHA8_ASTC_6x6_Format=t.SRGB8_ALPHA8_ASTC_6x5_Format=t.SRGB8_ALPHA8_ASTC_5x5_Format=t.SRGB8_ALPHA8_ASTC_5x4_Format=t.SRGB8_ALPHA8_ASTC_4x4_Format=t.SRGB8_ALPHA8_ASTC_12x12_Format=t.SRGB8_ALPHA8_ASTC_12x10_Format=t.SRGB8_ALPHA8_ASTC_10x8_Format=t.SRGB8_ALPHA8_ASTC_10x6_Format=t.SRGB8_ALPHA8_ASTC_10x5_Format=t.SRGB8_ALPHA8_ASTC_10x10_Format=t.ReverseSubtractEquation=t.ReplaceStencilOp=t.RepeatWrapping=t.ReinhardToneMapping=t.RedIntegerFormat=t.RedFormat=t.RGIntegerFormat=t.RGFormat=t.RGB_S3TC_DXT1_Format=t.RGB_PVRTC_4BPPV1_Format=t.RGB_PVRTC_2BPPV1_Format=t.RGB_ETC2_Format=t.RGB_ETC1_Format=t.RGBM7Encoding=t.RGBM16Encoding=t.RGBIntegerFormat=t.RGBFormat=t.RGBEFormat=t.RGBEEncoding=t.RGBDEncoding=t.RGBA_S3TC_DXT5_Format=t.RGBA_S3TC_DXT3_Format=t.RGBA_S3TC_DXT1_Format=t.RGBA_PVRTC_4BPPV1_Format=t.RGBA_PVRTC_2BPPV1_Format=t.RGBA_ETC2_EAC_Format=t.RGBA_BPTC_Format=t.RGBA_ASTC_8x8_Format=t.RGBA_ASTC_8x6_Format=t.RGBA_ASTC_8x5_Format=t.RGBA_ASTC_6x6_Format=t.RGBA_ASTC_6x5_Format=t.RGBA_ASTC_5x5_Format=t.RGBA_ASTC_5x4_Format=t.RGBA_ASTC_4x4_Format=t.RGBA_ASTC_12x12_Format=t.RGBA_ASTC_12x10_Format=t.RGBA_ASTC_10x8_Format=t.RGBA_ASTC_10x6_Format=t.RGBA_ASTC_10x5_Format=t.RGBA_ASTC_10x10_Format=t.RGBAIntegerFormat=t.RGBAFormat=t.RGBADepthPacking=t.REVISION=t.PCFSoftShadowMap=t.PCFShadowMap=t.OneMinusSrcColorFactor=t.OneMinusSrcAlphaFactor=t.OneMinusDstColorFactor=t.OneMinusDstAlphaFactor=t.OneFactor=t.ObjectSpaceNormalMap=t.NotEqualStencilFunc=t.NotEqualDepth=t.NormalBlending=t.NoToneMapping=t.NoColors=t.NoBlending=t.NeverStencilFunc=void 0,t.sRGBEncoding=t.ZeroStencilOp=t.ZeroSlopeEnding=t.ZeroFactor=t.ZeroCurvatureEnding=t.WrapAroundEnding=t.VertexColors=t.VSMShadowMap=t.UnsignedShortType=t.UnsignedShort565Type=t.UnsignedShort5551Type=t.UnsignedShort4444Type=t.UnsignedIntType=t.UnsignedInt248Type=t.UnsignedByteType=t.UniformsUtils=void 0;var a=o(n(53)),s=o(n(174)),u=o(n(96)),l=o(n(2)),c=o(n(5)),h=o(n(6)),f=o(n(7));n(295),n(59),n(301),n(303),n(8),n(103),n(14),n(108),n(307),n(13),n(145),n(61),n(311),n(9),n(184),n(150),n(322),n(194),n(151),n(323),n(195),n(32),n(324),n(62),n(21),n(325),n(55),n(71),n(110),n(197),n(327),n(328);var d=o(n(329)),p=o(n(332)),g=o(n(0)),m=o(n(19)),v=o(n(111)),y=o(n(34)),_=o(n(11)),x=o(n(112)),A=o(n(25)),I=o(n(35)),w=o(n(63)),b=o(n(200)),C=o(n(155)),M=o(n(366)),E=o(n(16));function T(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,f.default)(e);return i=t?(n=(0,f.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,h.default)(this,i)}}void 0===d.default&&(Number.EPSILON=Math.pow(2,-52)),void 0===p.default&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:0<e?1:+e}),"name"in Function.prototype==0&&(0,g.default)(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===m.default&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}),t.REVISION="115";var S={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2};t.MOUSE=S;var L={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3};t.TOUCH=L;var k=0;t.CullFaceNone=k;var R=1;t.CullFaceBack=R;var N=2;t.CullFaceFront=N;var P=3;t.CullFaceFrontBack=P;var O=0;t.FrontFaceDirectionCW=O;var D=1;t.FrontFaceDirectionCCW=D;var F=0;t.BasicShadowMap=F;var B=1;t.PCFShadowMap=B;var G=2;t.PCFSoftShadowMap=G;var z=3;t.VSMShadowMap=z;var U=0;t.FrontSide=U;var V=1;t.BackSide=V;var H=2;t.DoubleSide=H,t.FlatShading=1;var j=2;t.SmoothShading=j;var W=0;t.NoBlending=W;var Y=1;t.NormalBlending=Y;var q=2;t.AdditiveBlending=q;var X=3;t.SubtractiveBlending=X;var Z=4;t.MultiplyBlending=Z;var J=5;t.CustomBlending=J;var K=100;t.AddEquation=K;var Q=101;t.SubtractEquation=Q;var $=102;t.ReverseSubtractEquation=$;var ee=103;t.MinEquation=ee;var te=104;t.MaxEquation=te;var ne=200;t.ZeroFactor=ne;var re=201;t.OneFactor=re;var ie=202;t.SrcColorFactor=ie;var oe=203;t.OneMinusSrcColorFactor=oe;var ae=204;t.SrcAlphaFactor=ae;var se=205;t.OneMinusSrcAlphaFactor=se;var ue=206;t.DstAlphaFactor=ue;var le=207;t.OneMinusDstAlphaFactor=le;var ce=208;t.DstColorFactor=ce;var he=209;t.OneMinusDstColorFactor=he;var fe=210;t.SrcAlphaSaturateFactor=fe;var de=0;t.NeverDepth=de;var pe=1;t.AlwaysDepth=pe;var ge=2;t.LessDepth=ge;var me=3;t.LessEqualDepth=me;var ve=4;t.EqualDepth=ve;var ye=5;t.GreaterEqualDepth=ye;var _e=6;t.GreaterDepth=_e;var xe=7;t.NotEqualDepth=xe;var Ae=0;t.MultiplyOperation=Ae;var Ie=1;t.MixOperation=Ie;var we=2;t.AddOperation=we;var be=0;t.NoToneMapping=be;var Ce=1;t.LinearToneMapping=Ce;var Me=2;t.ReinhardToneMapping=Me;var Ee=3;t.Uncharted2ToneMapping=Ee;var Te=4;t.CineonToneMapping=Te;var Se=5;t.ACESFilmicToneMapping=Se;var Le=300;t.UVMapping=Le;var ke=301;t.CubeReflectionMapping=ke;var Re=302;t.CubeRefractionMapping=Re;var Ne=303;t.EquirectangularReflectionMapping=Ne;var Pe=304;t.EquirectangularRefractionMapping=Pe;var Oe=305;t.SphericalReflectionMapping=Oe;var De=306;t.CubeUVReflectionMapping=De;var Fe=307;t.CubeUVRefractionMapping=Fe;var Be=1e3;t.RepeatWrapping=Be;var Ge=1001;t.ClampToEdgeWrapping=Ge;var ze=1002;t.MirroredRepeatWrapping=ze;var Ue=1003;t.NearestFilter=Ue;var Ve=1004;t.NearestMipmapNearestFilter=Ve;var He=1004;t.NearestMipMapNearestFilter=He;var je=1005;t.NearestMipmapLinearFilter=je;var We=1005;t.NearestMipMapLinearFilter=We;var Ye=1006;t.LinearFilter=Ye;var qe=1007;t.LinearMipmapNearestFilter=qe;var Xe=1007;t.LinearMipMapNearestFilter=Xe;var Ze=1008;t.LinearMipmapLinearFilter=Ze;var Je=1008;t.LinearMipMapLinearFilter=Je;var Ke=1009;t.UnsignedByteType=Ke;var Qe=1010;t.ByteType=Qe;var $e=1011;t.ShortType=$e;var et=1012;t.UnsignedShortType=et;var tt=1013;t.IntType=tt;var nt=1014;t.UnsignedIntType=nt;var rt=1015;t.FloatType=rt;var it=1016;t.HalfFloatType=it;var ot=1017;t.UnsignedShort4444Type=ot;var at=1018;t.UnsignedShort5551Type=at;var st=1019;t.UnsignedShort565Type=st;var ut=1020;t.UnsignedInt248Type=ut;var lt=1021;t.AlphaFormat=lt;var ct=1022;t.RGBFormat=ct;var ht=1023;t.RGBAFormat=ht;var ft=1024;t.LuminanceFormat=ft;var dt=1025;t.LuminanceAlphaFormat=dt;var pt=ht;t.RGBEFormat=pt;var gt=1026;t.DepthFormat=gt;var mt=1027;t.DepthStencilFormat=mt;var vt=1028;t.RedFormat=vt;var yt=1029;t.RedIntegerFormat=yt;var _t=1030;t.RGFormat=_t;var xt=1031;t.RGIntegerFormat=xt;var At=1032;t.RGBIntegerFormat=At;var It=1033;t.RGBAIntegerFormat=It;var wt=33776;t.RGB_S3TC_DXT1_Format=wt;var bt=33777;t.RGBA_S3TC_DXT1_Format=bt;var Ct=33778;t.RGBA_S3TC_DXT3_Format=Ct;var Mt=33779;t.RGBA_S3TC_DXT5_Format=Mt;var Et=35840;t.RGB_PVRTC_4BPPV1_Format=Et;var Tt=35841;t.RGB_PVRTC_2BPPV1_Format=Tt;var St=35842;t.RGBA_PVRTC_4BPPV1_Format=St;var Lt=35843;t.RGBA_PVRTC_2BPPV1_Format=Lt;var kt=36196;t.RGB_ETC1_Format=kt;var Rt=37492;t.RGB_ETC2_Format=Rt;var Nt=37496;t.RGBA_ETC2_EAC_Format=Nt;var Pt=37808;t.RGBA_ASTC_4x4_Format=Pt;var Ot=37809;t.RGBA_ASTC_5x4_Format=Ot;var Dt=37810;t.RGBA_ASTC_5x5_Format=Dt;var Ft=37811;t.RGBA_ASTC_6x5_Format=Ft;var Bt=37812;t.RGBA_ASTC_6x6_Format=Bt;var Gt=37813;t.RGBA_ASTC_8x5_Format=Gt;var zt=37814;t.RGBA_ASTC_8x6_Format=zt;var Ut=37815;t.RGBA_ASTC_8x8_Format=Ut;var Vt=37816;t.RGBA_ASTC_10x5_Format=Vt;var Ht=37817;t.RGBA_ASTC_10x6_Format=Ht;var jt=37818;t.RGBA_ASTC_10x8_Format=jt;var Wt=37819;t.RGBA_ASTC_10x10_Format=Wt;var Yt=37820;t.RGBA_ASTC_12x10_Format=Yt;var qt=37821;t.RGBA_ASTC_12x12_Format=qt;var Xt=36492;t.RGBA_BPTC_Format=Xt;var Zt=37840;t.SRGB8_ALPHA8_ASTC_4x4_Format=Zt;var Jt=37841;t.SRGB8_ALPHA8_ASTC_5x4_Format=Jt;var Kt=37842;t.SRGB8_ALPHA8_ASTC_5x5_Format=Kt;var Qt=37843;t.SRGB8_ALPHA8_ASTC_6x5_Format=Qt;var $t=37844;t.SRGB8_ALPHA8_ASTC_6x6_Format=$t;var en=37845;t.SRGB8_ALPHA8_ASTC_8x5_Format=en;var tn=37846;t.SRGB8_ALPHA8_ASTC_8x6_Format=tn;var nn=37847;t.SRGB8_ALPHA8_ASTC_8x8_Format=nn;var rn=37848;t.SRGB8_ALPHA8_ASTC_10x5_Format=rn;var on=37849;t.SRGB8_ALPHA8_ASTC_10x6_Format=on;var an=37850;t.SRGB8_ALPHA8_ASTC_10x8_Format=an;var sn=37851;t.SRGB8_ALPHA8_ASTC_10x10_Format=sn;var un=37852;t.SRGB8_ALPHA8_ASTC_12x10_Format=un;var ln=37853;t.SRGB8_ALPHA8_ASTC_12x12_Format=ln,t.LoopOnce=2200,t.LoopRepeat=2201,t.LoopPingPong=2202;var cn=2300;t.InterpolateDiscrete=cn;var hn=2301;t.InterpolateLinear=hn;var fn=2302;t.InterpolateSmooth=fn;var dn=2400;t.ZeroCurvatureEnding=dn;var pn=2401;t.ZeroSlopeEnding=pn;var gn=2402;t.WrapAroundEnding=gn,t.TrianglesDrawMode=0;var mn=1;t.TriangleStripDrawMode=mn;var vn=2;t.TriangleFanDrawMode=vn;var yn=3e3;t.LinearEncoding=yn;var _n=3001;t.sRGBEncoding=_n;var xn=3007;t.GammaEncoding=xn;var An=3002;t.RGBEEncoding=An;var In=3003;t.LogLuvEncoding=In;var wn=3004;t.RGBM7Encoding=wn;var bn=3005;t.RGBM16Encoding=bn;var Cn=3006;t.RGBDEncoding=Cn;var Mn=3200;t.BasicDepthPacking=Mn;var En=3201;t.RGBADepthPacking=En;var Tn=0;t.TangentSpaceNormalMap=Tn;var Sn=1;t.ObjectSpaceNormalMap=Sn;var Ln=0;t.ZeroStencilOp=Ln;var kn=7680;t.KeepStencilOp=kn;var Rn=7681;t.ReplaceStencilOp=Rn;var Nn=7682;t.IncrementStencilOp=Nn;var Pn=7683;t.DecrementStencilOp=Pn;var On=34055;t.IncrementWrapStencilOp=On;var Dn=34056;t.DecrementWrapStencilOp=Dn;var Fn=5386;t.InvertStencilOp=Fn;var Bn=512;t.NeverStencilFunc=Bn;var Gn=513;t.LessStencilFunc=Gn;var zn=514;t.EqualStencilFunc=zn;var Un=515;t.LessEqualStencilFunc=Un;var Vn=516;t.GreaterStencilFunc=Vn;var Hn=517;t.NotEqualStencilFunc=Hn;var jn=518;t.GreaterEqualStencilFunc=jn;var Wn=519;t.AlwaysStencilFunc=Wn;var Yn=35044;t.StaticDrawUsage=Yn;var qn=35048;t.DynamicDrawUsage=qn;var Xn=35040;t.StreamDrawUsage=Xn;var Zn=35045;t.StaticReadUsage=Zn;var Jn=35049;t.DynamicReadUsage=Jn;var Kn=35041;t.StreamReadUsage=Kn;var Qn=35046;t.StaticCopyUsage=Qn;var $n=35050;t.DynamicCopyUsage=$n;var er=35042;function tr(){}t.StreamCopyUsage=er,(0,m.default)(tr.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){void 0!==this._listeners&&void 0!==(e=this._listeners[e])&&-1!==(t=e.indexOf(t))&&e.splice(t,1)},dispatchEvent:function(e){var t;if(void 0!==this._listeners&&void 0!==(t=(t=this._listeners)[e.type])){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}});for(var nr=[],rr=0;rr<256;rr++)nr[rr]=(rr<16?"0":"")+rr.toString(16);var ir,or={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(r=nr[255&e]+nr[e>>8&255]+nr[e>>16&255]+nr[e>>24&255]+"-"+nr[255&t]+nr[t>>8&255]+"-"+nr[t>>16&15|64]+nr[t>>24&255]+"-"+nr[63&n|128]+nr[n>>8&255]+"-"+nr[n>>16&255]+nr[n>>24&255]+nr[255&r]+nr[r>>8&255]+nr[r>>16&255]+nr[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*or.DEG2RAD},radToDeg:function(e){return e*or.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){var o=Math.cos,a=Math.sin,s=o(n/2),u=a(n/2),l=o((t+r)/2),c=a((t+r)/2),h=o((t-r)/2);n=a((t-r)/2),o=o((r-t)/2),t=a((r-t)/2),"XYX"===i?e.set(s*c,u*h,u*n,s*l):"YZY"===i?e.set(u*n,s*c,u*h,s*l):"ZXZ"===i?e.set(u*h,u*n,s*c,s*l):"XZX"===i?e.set(s*c,u*t,u*o,s*l):"YXY"===i?e.set(u*o,s*c,u*t,s*l):"ZYZ"===i?e.set(u*t,u*o,s*c,s*l):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function ar(e,t){this.x=e||0,this.y=t||0}function sr(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}t.MathUtils=t.Math=or,(0,v.default)(ar.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),(0,m.default)(ar.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y;return e=e.elements,this.x=e[0]*t+e[3]*n+e[6],this.y=e[1]*t+e[4]*n+e[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x;return t*t+(e=this.y-e.y)*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x;return t=this.y-e.y,this.x=i*n-t*r+e.x,this.y=i*r+t*n+e.y,this}}),(0,m.default)(sr.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,o,a,s,u){var l=this.elements;return l[0]=e,l[1]=r,l[2]=a,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=o,l[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this},extractBasis:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],l=n[4],c=n[7],h=n[2],f=n[5],d=n[8],p=r[0],g=r[3],m=r[6],v=r[1],y=r[4];return e=r[7],t=r[2],n=r[5],r=r[8],i[0]=o*p+a*v+s*t,i[3]=o*g+a*y+s*n,i[6]=o*m+a*e+s*r,i[1]=u*p+l*v+c*t,i[4]=u*g+l*y+c*n,i[7]=u*m+l*e+c*r,i[2]=h*p+f*v+d*t,i[5]=h*g+f*y+d*n,i[8]=h*m+f*e+d*r,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e,t=(e=this.elements)[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7];return t*o*(e=e[8])-t*a*u-n*i*e+n*a*s+r*i*u-r*o*s},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=e.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],l=n[5],c=n[6],h=n[7],f=n[8],d=f*u-l*h;return 0==(n=i*d+o*(t=l*c-f*s)+a*(e=h*s-u*c))?this.set(0,0,0,0,0,0,0,0,0):(n=1/n,r[0]=d*n,r[1]=(a*h-f*o)*n,r[2]=(l*o-a*u)*n,r[3]=t*n,r[4]=(f*i-a*c)*n,r[5]=(a*s-l*i)*n,r[6]=e*n,r[7]=(o*c-h*i)*n,r[8]=(u*i-o*s)*n,this)},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,o,a){var s=Math.cos(i);i=Math.sin(i),this.set(n*s,n*i,-n*(s*o+i*a)+o+e,-r*i,r*s,-r*(-i*o+s*a)+a+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],u=r[4];return e=r[7],r[0]=t*i+n*s,r[3]=t*o+n*u,r[6]=t*a+n*e,r[1]=-n*i+t*s,r[4]=-n*o+t*u,r[7]=-n*a+t*e,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var ur={getDataURL:function(e){return"undefined"==typeof HTMLCanvasElement?e.src:2048<(e=e instanceof HTMLCanvasElement?e:(void 0===ir&&(ir=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),ir.width=e.width,ir.height=e.height,t=ir.getContext("2d"),e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),ir)).width||2048<e.height?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png");var t}};t.ImageUtils=ur;var lr=0;function cr(e,t,n,r,i,o,a,s,u,l){(0,g.default)(this,"id",{value:lr++}),this.uuid=or.generateUUID(),this.name="",this.image=void 0!==e?e:cr.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:cr.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:Ge,this.wrapT=void 0!==r?r:Ge,this.magFilter=void 0!==i?i:Ye,this.minFilter=void 0!==o?o:Ze,this.anisotropy=void 0!==u?u:1,this.format=void 0!==a?a:ht,this.internalFormat=null,this.type=void 0!==s?s:Ke,this.offset=new ar(0,0),this.repeat=new ar(1,1),this.center=new ar(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new sr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:yn,this.version=0,this.onUpdate=null}function hr(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1}function fr(e,t,n){this.width=e,this.height=t,this.scissor=new hr(0,0,e,t),this.scissorTest=!1,this.viewport=new hr(0,0,e,t),n=n||{},this.texture=new cr(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Ye,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function dr(e,t,n){fr.call(this,e,t,n),this.samples=4}function pr(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}cr.DEFAULT_IMAGE=void 0,cr.DEFAULT_MAPPING=Le,cr.prototype=(0,m.default)((0,y.default)(tr.prototype),{constructor:cr,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=or.generateUUID()),!t&&void 0===e.images[r.uuid]){if((0,_.default)(r))for(var i=[],o=0,a=r.length;o<a;o++)i.push(ur.getDataURL(r[o]));else i=ur.getDataURL(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==Le)return e;if(e.applyMatrix3(this.matrix),e.x<0||1<e.x)switch(this.wrapS){case Be:e.x=e.x-Math.floor(e.x);break;case Ge:e.x=e.x<0?0:1;break;case ze:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||1<e.y)switch(this.wrapT){case Be:e.y=e.y-Math.floor(e.y);break;case Ge:e.y=e.y<0?0:1;break;case ze:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),(0,g.default)(cr.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),(0,v.default)(hr.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),(0,m.default)(hr.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w;return e=e.elements,this.x=e[0]*t+e[4]*n+e[8]*r+e[12]*i,this.y=e[1]*t+e[5]*n+e[9]*r+e[13]*i,this.z=e[2]*t+e[6]*n+e[10]*r+e[14]*i,this.w=e[3]*t+e[7]*n+e[11]*r+e[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,i=.01,o=.1,a=(_=e.elements)[0],s=_[4],u=_[8],l=_[1],c=_[5],h=_[9],f=_[2],d=_[6],p=_[10];if(Math.abs(s-l)<i&&Math.abs(u-f)<i&&Math.abs(h-d)<i){if(Math.abs(s+l)<o&&Math.abs(u+f)<o&&Math.abs(h+d)<o&&Math.abs(a+c+p-3)<o)return this.set(1,0,0,0),this;var g=Math.PI,m=(a+1)/2,v=(c+1)/2,y=(p+1)/2,_=(e=(s+l)/4,(u+f)/4);return o=(h+d)/4,v<m&&y<m?r=m<i?(t=0,n=.707106781,.707106781):(n=e/(t=Math.sqrt(m)),_/t):y<v?r=v<i?(t=.707106781,n=0,.707106781):(t=e/(n=Math.sqrt(v)),o/n):y<i?(t=.707106781,n=.707106781,r=0):(t=_/(r=Math.sqrt(y)),n=o/r),this.set(t,n,r,g),this}return g=Math.sqrt((d-h)*(d-h)+(u-f)*(u-f)+(l-s)*(l-s)),Math.abs(g)<.001&&(g=1),this.x=(d-h)/g,this.y=(u-f)/g,this.z=(l-s)/g,this.w=Math.acos((a+c+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),fr.prototype=(0,m.default)((0,y.default)(tr.prototype),{constructor:fr,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),dr.prototype=(0,m.default)((0,y.default)(fr.prototype),{constructor:dr,isWebGLMultisampleRenderTarget:!0,copy:function(e){return fr.prototype.copy.call(this,e),this.samples=e.samples,this}}),(0,m.default)(pr,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,o,a){var s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3],h=i[o+0],f=i[o+1],p=i[o+2],g=i[o+3];c===g&&s===h&&u===f&&l===p||(n=1-a,i=0<=(r=s*h+u*f+l*p+c*g)?1:-1,(o=1-r*r)>d.default&&(o=Math.sqrt(o),r=Math.atan2(o,r*i),n=Math.sin(n*r)/o,a=Math.sin(a*r)/o),s=s*n+h*(i*=a),u=u*n+f*i,l=l*n+p*i,c=c*n+g*i,n===1-a&&(s*=a=1/Math.sqrt(s*s+u*u+l*l+c*c),u*=a,l*=a,c*=a)),e[t]=s,e[t+1]=u,e[t+2]=l,e[t+3]=c}}),(0,v.default)(pr.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),(0,m.default)(pr.prototype,{isQuaternion:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,u=a(n/2);return e=a(r/2),a=a(i/2),n=s(n/2),r=s(r/2),i=s(i/2),"XYZ"===o?(this._x=n*e*a+u*r*i,this._y=u*r*a-n*e*i,this._z=u*e*i+n*r*a,this._w=u*e*a-n*r*i):"YXZ"===o?(this._x=n*e*a+u*r*i,this._y=u*r*a-n*e*i,this._z=u*e*i-n*r*a,this._w=u*e*a+n*r*i):"ZXY"===o?(this._x=n*e*a-u*r*i,this._y=u*r*a+n*e*i,this._z=u*e*i+n*r*a,this._w=u*e*a-n*r*i):"ZYX"===o?(this._x=n*e*a-u*r*i,this._y=u*r*a+n*e*i,this._z=u*e*i-n*r*a,this._w=u*e*a+n*r*i):"YZX"===o?(this._x=n*e*a+u*r*i,this._y=u*r*a+n*e*i,this._z=u*e*i-n*r*a,this._w=u*e*a-n*r*i):"XZY"===o&&(this._x=n*e*a-u*r*i,this._y=u*r*a-n*e*i,this._z=u*e*i+n*r*a,this._w=u*e*a+n*r*i),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2;return t=Math.sin(n),this._x=e.x*t,this._y=e.y*t,this._z=e.z*t,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n,r=(n=e.elements)[0],i=n[4],o=n[8],a=n[1],s=n[5],u=n[9],l=n[2],c=n[6];return 0<(n=r+s+(e=n[10]))?(t=.5/Math.sqrt(n+1),this._w=.25/t,this._x=(c-u)*t,this._y=(o-l)*t,this._z=(a-i)*t):s<r&&e<r?(t=2*Math.sqrt(1+r-s-e),this._w=(c-u)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+l)/t):e<s?(t=2*Math.sqrt(1+s-r-e),this._w=(o-l)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(u+c)/t):(t=2*Math.sqrt(1+e-r-s),this._w=(a-i)/t,this._x=(o+l)/t,this._y=(u+c)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=n,this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(or.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);return 0===n||(n=Math.min(1,t/n),this.slerp(e,n)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y;return e=t._z,t=t._w,this._x=n*t+o*a+r*e-i*s,this._y=r*t+o*s+i*a-n*e,this._z=i*t+o*e+n*s-r*a,this._w=o*t-n*a-r*s-i*e,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),1<=a)return this._w=o,this._x=n,this._y=r,this._z=i,this;if((e=1-a*a)<=d.default){var s=1-t;return this._w=s*o+t*this._w,this._x=s*n+t*this._x,this._y=s*r+t*this._y,this._z=s*i+t*this._z,this.normalize(),this._onChangeCallback(),this}return s=Math.sqrt(e),e=Math.atan2(s,a),a=Math.sin((1-t)*e)/s,s=Math.sin(t*e)/s,this._w=o*a+this._w*s,this._x=n*a+this._x*s,this._y=r*a+this._y*s,this._z=i*a+this._z*s,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},fromBufferAttribute:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var gr=new vr,mr=new pr;function vr(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}(0,m.default)(vr.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(mr.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(mr.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z;return e=e.elements,this.x=e[0]*t+e[3]*n+e[6]*r,this.y=e[1]*t+e[4]*n+e[7]*r,this.z=e[2]*t+e[5]*n+e[8]*r,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return e=1/(i[3]*t+i[7]*n+i[11]*r+i[15]),this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*e,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*e,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*e,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,u=s*t+o*r-a*n,l=s*n+a*t-i*r;return e=s*r+i*n-o*t,r=-i*t-o*n-a*r,this.x=u*s+r*-i+l*-a-e*-o,this.y=l*s+r*-o+e*-i-u*-a,this.z=e*s+r*-a+u*-o-l*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,r=this.z;return e=e.elements,this.x=e[0]*t+e[4]*n+e[8]*r,this.y=e[1]*t+e[5]*n+e[9]*r,this.z=e[2]*t+e[6]*n+e[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x;return e=t.y,t=t.z,this.x=r*t-i*e,this.y=i*o-n*t,this.z=n*e-r*o,this},projectOnVector:function(e){var t=e.lengthSq();return 0===t?this.set(0,0,0):(t=e.dot(this)/t,this.copy(e).multiplyScalar(t))},projectOnPlane:function(e){return gr.copy(this).projectOnVector(e),this.sub(gr)},reflect:function(e){return this.sub(gr.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===t?Math.PI/2:(t=this.dot(e)/t,Math.acos(or.clamp(t,-1,1)))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n+(e=this.z-e.z)*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length();return e=this.setFromMatrixColumn(e,2).length(),this.x=t,this.y=n,this.z=e,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});var yr=new vr,_r=new Cr,xr=new vr(0,0,0),Ar=new vr(1,1,1),Ir=new vr,wr=new vr,br=new vr;function Cr(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}(0,m.default)(Cr.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,o,a,s,u,l,c,h,f,d,p,g){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=o,m[9]=a,m[13]=s,m[2]=u,m[6]=l,m[10]=c,m[14]=h,m[3]=f,m[7]=d,m[11]=p,m[15]=g,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Cr).fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this},copyPosition:function(e){var t=this.elements;return e=e.elements,t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,n=e.elements,r=1/yr.setFromMatrixColumn(e,0).length(),i=1/yr.setFromMatrixColumn(e,1).length();return e=1/yr.setFromMatrixColumn(e,2).length(),t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t,n,r,i,o,a,s,u,l,c,h,f,d=this.elements,p=e.x,g=e.y,m=e.z,v=Math.cos(p),y=Math.sin(p),_=Math.cos(g);return p=Math.sin(g),g=Math.cos(m),m=Math.sin(m),"XYZ"===e.order?(o=v*g,a=v*m,s=y*g,u=y*m,d[0]=_*g,d[4]=-_*m,d[8]=p,d[1]=a+s*p,d[5]=o-u*p,d[9]=-y*_,d[2]=u-o*p,d[6]=s+a*p,d[10]=v*_):"YXZ"===e.order?(t=_*g,n=_*m,r=p*g,i=p*m,d[0]=t+i*y,d[4]=r*y-n,d[8]=v*p,d[1]=v*m,d[5]=v*g,d[9]=-y,d[2]=n*y-r,d[6]=i+t*y,d[10]=v*_):"ZXY"===e.order?(t=_*g,n=_*m,r=p*g,i=p*m,d[0]=t-i*y,d[4]=-v*m,d[8]=r+n*y,d[1]=n+r*y,d[5]=v*g,d[9]=i-t*y,d[2]=-v*p,d[6]=y,d[10]=v*_):"ZYX"===e.order?(o=v*g,a=v*m,s=y*g,u=y*m,d[0]=_*g,d[4]=s*p-a,d[8]=o*p+u,d[1]=_*m,d[5]=u*p+o,d[9]=a*p-s,d[2]=-p,d[6]=y*_,d[10]=v*_):"YZX"===e.order?(l=v*_,c=v*p,h=y*_,f=y*p,d[0]=_*g,d[4]=f-l*m,d[8]=h*m+c,d[1]=m,d[5]=v*g,d[9]=-y*g,d[2]=-p*g,d[6]=c*m+h,d[10]=l-f*m):"XZY"===e.order&&(l=v*_,c=v*p,h=y*_,f=y*p,d[0]=_*g,d[4]=-m,d[8]=p*g,d[1]=l*m+f,d[5]=v*g,d[9]=c*m-h,d[2]=h*m-c,d[6]=y*g,d[10]=f*m+l),d[3]=0,d[7]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(xr,e,Ar)},lookAt:function(e,t,n){var r=this.elements;return br.subVectors(e,t),0===br.lengthSq()&&(br.z=1),br.normalize(),Ir.crossVectors(n,br),0===Ir.lengthSq()&&(1===Math.abs(n.z)?br.x+=1e-4:br.z+=1e-4,br.normalize(),Ir.crossVectors(n,br)),Ir.normalize(),wr.crossVectors(br,Ir),r[0]=Ir.x,r[4]=wr.x,r[8]=br.x,r[1]=Ir.y,r[5]=wr.y,r[9]=br.y,r[2]=Ir.z,r[6]=wr.z,r[10]=br.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],l=n[1],c=n[5],h=n[9],f=n[13],d=n[2],p=n[6],g=n[10],m=n[14],v=n[3],y=n[7],_=n[11],x=n[15],A=r[0],I=r[4],w=r[8],b=r[12],C=r[1],M=r[5],E=r[9],T=r[13],S=r[2],L=r[6],k=r[10],R=r[14];return e=r[3],t=r[7],n=r[11],r=r[15],i[0]=o*A+a*C+s*S+u*e,i[4]=o*I+a*M+s*L+u*t,i[8]=o*w+a*E+s*k+u*n,i[12]=o*b+a*T+s*R+u*r,i[1]=l*A+c*C+h*S+f*e,i[5]=l*I+c*M+h*L+f*t,i[9]=l*w+c*E+h*k+f*n,i[13]=l*b+c*T+h*R+f*r,i[2]=d*A+p*C+g*S+m*e,i[6]=d*I+p*M+g*L+m*t,i[10]=d*w+p*E+g*k+m*n,i[14]=d*b+p*T+g*R+m*r,i[3]=v*A+y*C+_*S+x*e,i[7]=v*I+y*M+_*L+x*t,i[11]=v*w+y*E+_*k+x*n,i[15]=v*b+y*T+_*R+x*r,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e,t=(e=this.elements)[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],u=e[13],l=e[2],c=e[6],h=e[10],f=e[14];return e[3]*(+i*s*c-r*u*c-i*a*h+n*u*h+r*a*f-n*s*f)+e[7]*(+t*s*f-t*u*h+i*o*h-r*o*f+r*u*l-i*s*l)+e[11]*(+t*u*c-t*a*f-i*o*c+n*o*f+i*a*l-n*u*l)+(e=e[15])*(-r*a*l-t*s*c+t*a*h+r*o*c-n*o*h+n*s*l)},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n,r=this.elements,i=(n=e.elements)[0],o=n[1],a=n[2],s=n[3],u=n[4],l=n[5],c=n[6],h=n[7],f=n[8],d=n[9],p=n[10],g=n[11],m=n[12],v=n[13],y=n[14],_=n[15],x=d*y*h-v*p*h+v*c*g-l*y*g-d*c*_+l*p*_,A=m*p*h-f*y*h-m*c*g+u*y*g+f*c*_-u*p*_;return 0==(n=i*x+o*A+a*(t=f*v*h-m*d*h+m*l*g-u*v*g-f*l*_+u*d*_)+s*(e=m*d*c-f*v*c-m*l*p+u*v*p+f*l*y-u*d*y))?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(n=1/n,r[0]=x*n,r[1]=(v*p*s-d*y*s-v*a*g+o*y*g+d*a*_-o*p*_)*n,r[2]=(l*y*s-v*c*s+v*a*h-o*y*h-l*a*_+o*c*_)*n,r[3]=(d*c*s-l*p*s-d*a*h+o*p*h+l*a*g-o*c*g)*n,r[4]=A*n,r[5]=(f*y*s-m*p*s+m*a*g-i*y*g-f*a*_+i*p*_)*n,r[6]=(m*c*s-u*y*s-m*a*h+i*y*h+u*a*_-i*c*_)*n,r[7]=(u*p*s-f*c*s+f*a*h-i*p*h-u*a*g+i*c*g)*n,r[8]=t*n,r[9]=(m*d*s-f*v*s-m*o*g+i*v*g+f*o*_-i*d*_)*n,r[10]=(u*v*s-m*l*s+m*o*h-i*v*h-u*o*_+i*l*_)*n,r[11]=(f*l*s-u*d*s-f*o*h+i*d*h+u*o*g-i*l*g)*n,r[12]=e*n,r[13]=(f*v*a-m*d*a+m*o*p-i*v*p-f*o*y+i*d*y)*n,r[14]=(m*l*a-u*v*a-m*o*c+i*v*c+u*o*y-i*l*y)*n,r[15]=(u*d*a-f*l*a+f*o*c-i*d*c-u*o*p+i*l*p)*n,this)},scale:function(e){var t=this.elements,n=e.x,r=e.y;return e=e.z,t[0]*=n,t[4]*=r,t[8]*=e,t[1]*=n,t[5]*=r,t[9]*=e,t[2]*=n,t[6]*=r,t[10]*=e,t[3]*=n,t[7]*=r,t[11]*=e,this},getMaxScaleOnAxis:function(){var e=(n=this.elements)[0]*n[0]+n[1]*n[1]+n[2]*n[2],t=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],n=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(e,t,n))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z;return t=i*o,e=i*a,this.set(t*o+n,t*a-r*s,t*s+r*a,0,t*a+r*s,e*a+n,e*s-r*o,0,t*s-r*a,e*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,u=i*(h=i+i),l=i*(f=o+o),c=i*(d=a+a),h=(t=o*f,i=o*d,o=a*d,a=s*h,s*f),f=s*d,d=(s=n.x,n.y);return n=n.z,r[0]=(1-(t+o))*s,r[1]=(l+f)*s,r[2]=(c-h)*s,r[3]=0,r[4]=(l-f)*d,r[5]=(1-(u+o))*d,r[6]=(i+a)*d,r[7]=0,r[8]=(c+h)*n,r[9]=(i-a)*n,r[10]=(1-(u+t))*n,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:function(e,t,n){var r=this.elements,i=yr.set(r[0],r[1],r[2]).length(),o=yr.set(r[4],r[5],r[6]).length(),a=yr.set(r[8],r[9],r[10]).length(),s=this.determinant();return s<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],_r.copy(this),s=1/i,e=1/o,r=1/a,_r.elements[0]*=s,_r.elements[1]*=s,_r.elements[2]*=s,_r.elements[4]*=e,_r.elements[5]*=e,_r.elements[6]*=e,_r.elements[8]*=r,_r.elements[9]*=r,_r.elements[10]*=r,t.setFromRotationMatrix(_r),n.x=i,n.y=o,n.z=a,this},makePerspective:function(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),u=2*i/(n-r);return e=(t+e)/(t-e),n=(n+r)/(n-r),r=-(o+i)/(o-i),i=-2*o*i/(o-i),a[0]=s,a[4]=0,a[8]=e,a[12]=0,a[1]=0,a[5]=u,a[9]=n,a[13]=0,a[2]=0,a[6]=0,a[10]=r,a[14]=i,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),u=1/(n-r),l=1/(o-i);return e=(t+e)*s,r=(n+r)*u,i=(o+i)*l,a[0]=2*s,a[4]=0,a[8]=0,a[12]=-e,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-r,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-i,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});var Mr=new Cr,Er=new pr;function Tr(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||Tr.DefaultOrder}function Sr(){this.mask=1}Tr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Tr.DefaultOrder="XYZ",(0,v.default)(Tr.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),(0,m.default)(Tr.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=or.clamp,i=(h=e.elements)[0],o=h[4],a=h[8],s=h[1],u=h[5],l=h[9],c=h[2],h=(e=h[6],h[10]);return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,h),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(e,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(a,h),this._z=Math.atan2(s,u)):(this._y=Math.atan2(-c,i),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(e,-1,1)),Math.abs(e)<.9999999?(this._y=Math.atan2(-c,h),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(s,i))):"ZYX"===t?(this._y=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(e,h),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-o,u))):"YZX"===t?(this._z=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(a,h))):"XZY"===t?(this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(e,u),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-l,h),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,n){return Mr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Mr,t,n)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return Er.setFromEuler(this),this.setFromQuaternion(Er,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new vr(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),(0,m.default)(Sr.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}});var Lr=0,kr=new vr,Rr=new pr,Nr=new Cr,Pr=new vr,Or=new vr,Dr=new vr,Fr=new pr,Br=new vr(1,0,0),Gr=new vr(0,1,0),zr=new vr(0,0,1),Ur={type:"added"},Vr={type:"removed"};function Hr(){(0,g.default)(this,"id",{value:Lr++}),this.uuid=or.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Hr.DefaultUp.clone();var e=new vr,t=new Tr,n=new pr,r=new vr(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),(0,v.default)(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Cr},normalMatrix:{value:new sr}}),this.matrix=new Cr,this.matrixWorld=new Cr,this.matrixAutoUpdate=Hr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Sr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function jr(){Hr.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Hr.DefaultUp=new vr(0,1,0),Hr.DefaultMatrixAutoUpdate=!0,Hr.prototype=(0,m.default)((0,y.default)(tr.prototype),{constructor:Hr,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return Rr.setFromAxisAngle(e,t),this.quaternion.multiply(Rr),this},rotateOnWorldAxis:function(e,t){return Rr.setFromAxisAngle(e,t),this.quaternion.premultiply(Rr),this},rotateX:function(e){return this.rotateOnAxis(Br,e)},rotateY:function(e){return this.rotateOnAxis(Gr,e)},rotateZ:function(e){return this.rotateOnAxis(zr,e)},translateOnAxis:function(e,t){return kr.copy(e).applyQuaternion(this.quaternion),this.position.add(kr.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(Br,e)},translateY:function(e){return this.translateOnAxis(Gr,e)},translateZ:function(e){return this.translateOnAxis(zr,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(Nr.getInverse(this.matrixWorld))},lookAt:function(e,t,n){e.isVector3?Pr.copy(e):Pr.set(e,t,n),n=this.parent,this.updateWorldMatrix(!0,!1),Or.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Nr.lookAt(Or,Pr,this.up):Nr.lookAt(Pr,Or,this.up),this.quaternion.setFromRotationMatrix(Nr),n&&(Nr.extractRotation(n.matrixWorld),Rr.setFromRotationMatrix(Nr),this.quaternion.premultiply(Rr.inverse()))},add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Ur)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Vr)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),Nr.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Nr.multiply(e.parent.matrixWorld)),e.applyMatrix4(Nr),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i;if(void 0!==(i=(i=this.children[n]).getObjectByProperty(e,t)))return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new vr),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new pr),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Or,e,Dr),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new vr),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Or,Fr,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new vr),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r,i,o={};function a(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),"{}"!==(0,x.default)(this.userData)&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){o.geometry=a(e.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes){var u=s.shapes;if((0,_.default)(u))for(var l=0,c=u.length;l<c;l++){var h=u[l];a(e.shapes,h)}else a(e.shapes,u)}}if(void 0!==this.material)if((0,_.default)(this.material)){var f=[];for(l=0,c=this.material.length;l<c;l++)f.push(a(e.materials,this.material[l]));o.material=f}else o.material=a(e.materials,this.material);if(0<this.children.length)for(o.children=[],l=0;l<this.children.length;l++)o.children.push(this.children[l].toJSON(e).object);return t&&(r=d(e.geometries),i=d(e.materials),s=d(e.textures),t=d(e.images),u=d(e.shapes),0<r.length&&(n.geometries=r),0<i.length&&(n.materials=i),0<s.length&&(n.textures=s),0<t.length&&(n.images=t),0<u.length&&(n.shapes=u)),n.object=o,n;function d(e){var t,n=[];for(t in e){var r=e[t];delete r.metadata,n.push(r)}return n}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse((0,x.default)(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}),jr.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:jr,isScene:!0,copy:function(e,t){return Hr.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Hr.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Wr=[new vr,new vr,new vr,new vr,new vr,new vr,new vr,new vr],Yr=new vr,qr=new ii,Xr=new vr,Zr=new vr,Jr=new vr,Kr=new vr,Qr=new vr,$r=new vr,ei=new vr,ti=new vr,ni=new vr,ri=new vr;function ii(e,t){this.min=void 0!==e?e:new vr(1/0,1/0,1/0),this.max=void 0!==t?t:new vr(-1/0,-1/0,-1/0)}function oi(e,t,n,r,i){for(var o=0,a=e.length-3;o<=a;o+=3){ri.fromArray(e,o);var s=i.x*Math.abs(ri.x)+i.y*Math.abs(ri.y)+i.z*Math.abs(ri.z),u=t.dot(ri),l=n.dot(ri),c=r.dot(ri);if(Math.max(-Math.max(u,l,c),Math.min(u,l,c))>s)return!1}return!0}(0,m.default)(ii.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=e.length;s<u;s+=3){var l=e[s],c=e[s+1],h=e[s+2];l<t&&(t=l),c<n&&(n=c),h<r&&(r=h),i<l&&(i=l),o<c&&(o=c),a<h&&(a=h)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=e.count;s<u;s++){var l=e.getX(s),c=e.getY(s),h=e.getZ(s);l<t&&(t=l),c<n&&(n=c),h<r&&(r=h),i<l&&(i=l),o<c&&(o=c),a<h&&(a=h)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){return t=Yr.copy(t).multiplyScalar(.5),this.min.copy(e).sub(t),this.max.copy(e).add(t),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new vr),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new vr),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),qr.copy(t.boundingBox),qr.applyMatrix4(e.matrixWorld),this.union(qr));for(var n=e.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new vr),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,Yr),Yr.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,n=0<e.normal.x?(t=e.normal.x*this.min.x,e.normal.x*this.max.x):(t=e.normal.x*this.max.x,e.normal.x*this.min.x);return 0<e.normal.y?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(e){return!this.isEmpty()&&(this.getCenter(ei),ti.subVectors(this.max,ei),Xr.subVectors(e.a,ei),Zr.subVectors(e.b,ei),Jr.subVectors(e.c,ei),Kr.subVectors(Zr,Xr),Qr.subVectors(Jr,Zr),$r.subVectors(Xr,Jr),!!oi(e=[0,-Kr.z,Kr.y,0,-Qr.z,Qr.y,0,-$r.z,$r.y,Kr.z,0,-Kr.x,Qr.z,0,-Qr.x,$r.z,0,-$r.x,-Kr.y,Kr.x,0,-Qr.y,Qr.x,0,-$r.y,$r.x,0],Xr,Zr,Jr,ti)&&!!oi(e=[1,0,0,0,1,0,0,0,1],Xr,Zr,Jr,ti)&&(ni.crossVectors(Kr,Qr),oi(e=[ni.x,ni.y,ni.z],Xr,Zr,Jr,ti)))},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new vr),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return Yr.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Yr).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()||(Wr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Wr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Wr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Wr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Wr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Wr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Wr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Wr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Wr)),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var ai=new ii;function si(e,t){this.center=void 0!==e?e:new vr,this.radius=void 0!==t?t:0}(0,m.default)(si.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){var n=this.center;void 0!==t?n.copy(t):ai.setFromPoints(e).getCenter(n);for(var r=0,i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new vr),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new ii),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var ui=new vr,li=new vr,ci=new vr,hi=new vr,fi=new vr,di=new vr,pi=new vr;function gi(e,t){this.origin=void 0!==e?e:new vr,this.direction=void 0!==t?t:new vr(0,0,-1)}(0,m.default)(gi.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new vr),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,ui)),this},closestPointToPoint:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new vr),t.subVectors(e,this.origin),(e=t.dot(this.direction))<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=ui.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ui.copy(this.direction).multiplyScalar(t).add(this.origin),ui.distanceToSquared(e))},distanceSqToSegment:function(e,t,n,r){li.copy(e).add(t).multiplyScalar(.5),ci.copy(t).sub(e).normalize(),hi.copy(this.origin).sub(li);var i,o,a=.5*e.distanceTo(t),s=-this.direction.dot(ci),u=hi.dot(this.direction),l=-hi.dot(ci),c=hi.lengthSq();return c=0<(e=Math.abs(1-s*s))?(o=s*u-l,t=a*e,0<=(i=s*l-u)?-t<=o?o<=t?(i*=e=1/e)*(i+s*(o*=e)+2*u)+o*(s*i+o+2*l)+c:(o=a,-(i=Math.max(0,-(s*o+u)))*i+o*(o+2*l)+c):(o=-a,-(i=Math.max(0,-(s*o+u)))*i+o*(o+2*l)+c):o<=-t?-(i=Math.max(0,-(-s*a+u)))*i+(o=0<i?-a:Math.min(Math.max(-a,-l),a))*(o+2*l)+c:o<=t?(i=0,(o=Math.min(Math.max(-a,-l),a))*(o+2*l)+c):-(i=Math.max(0,-(s*a+u)))*i+(o=0<i?a:Math.min(Math.max(-a,-l),a))*(o+2*l)+c):(o=0<s?-a:a,-(i=Math.max(0,-(s*o+u)))*i+o*(o+2*l)+c),n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(ci).multiplyScalar(o).add(li),c},intersectSphere:function(e,t){ui.subVectors(e.center,this.origin);var n=ui.dot(this.direction),r=ui.dot(ui)-n*n;return(e=e.radius*e.radius)<r?null:(r=n-(e=Math.sqrt(e-r)),e=n+e,r<0&&e<0?null:r<0?this.at(e,t):this.at(r,t))},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);return 0===t?0===e.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(e.normal)+e.constant)/t)?t:null},intersectPlane:function(e,t){return null===(e=this.distanceToPlane(e))?null:this.at(e,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||(e=e.normal.dot(this.direction))*t<0},intersectBox:function(e,t){var n,r,i,o=1/this.direction.x,a=1/this.direction.y,s=1/this.direction.z,u=this.origin;return o=0<=o?(n=(e.min.x-u.x)*o,(e.max.x-u.x)*o):(n=(e.max.x-u.x)*o,(e.min.x-u.x)*o),(a=0<=a?(r=(e.min.y-u.y)*a,(e.max.y-u.y)*a):(r=(e.max.y-u.y)*a,(e.min.y-u.y)*a))<n||o<r?null:((n<r||n!=n)&&(n=r),(a<o||o!=o)&&(o=a),(s=0<=s?(i=(e.min.z-u.z)*s,(e.max.z-u.z)*s):(i=(e.max.z-u.z)*s,(e.min.z-u.z)*s))<n||o<i?null:((n<i||n!=n)&&(n=i),(s<o||o!=o)&&(o=s),o<0?null:this.at(0<=n?n:o,t)))},intersectsBox:function(e){return null!==this.intersectBox(e,ui)},intersectTriangle:function(e,t,n,r,i){if(fi.subVectors(t,e),di.subVectors(n,e),pi.crossVectors(fi,di),0<(n=this.direction.dot(pi))){if(r)return null;o=1}else{if(!(n<0))return null;o=-1,n=-n}if(hi.subVectors(this.origin,e),(r=o*this.direction.dot(di.crossVectors(hi,di)))<0)return null;if((e=o*this.direction.dot(fi.cross(hi)))<0)return null;if(n<r+e)return null;var o=-o*hi.dot(pi);return o<0?null:this.at(o/n,i)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var mi=new vr,vi=new vr,yi=new sr;function _i(e,t){this.normal=void 0!==e?e:new vr(1,0,0),this.constant=void 0!==t?t:0}(0,m.default)(_i.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,n){return t=mi.subVectors(n,t).cross(vi.subVectors(e,t)).normalize(),this.setFromNormalAndCoplanarPoint(t,e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new vr),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new vr);var n=e.delta(mi),r=this.normal.dot(n);return 0===r?0===this.distanceToPoint(e.start)?t.copy(e.start):void 0:(r=-(e.start.dot(this.normal)+this.constant)/r)<0||1<r?void 0:t.copy(n).multiplyScalar(r).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start);return e=this.distanceToPoint(e.end),t<0&&0<e||e<0&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new vr),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){return t=t||yi.getNormalMatrix(e),e=this.coplanarPoint(mi).applyMatrix4(e),t=this.normal.applyMatrix3(t).normalize(),this.constant=-e.dot(t),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var xi=new vr,Ai=new vr,Ii=new vr,wi=new vr,bi=new vr,Ci=new vr,Mi=new vr,Ei=new vr,Ti=new vr,Si=new vr;function Li(e,t,n){this.a=void 0!==e?e:new vr,this.b=void 0!==t?t:new vr,this.c=void 0!==n?n:new vr}(0,m.default)(Li,{getNormal:function(e,t,n,r){return void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new vr),r.subVectors(n,t),xi.subVectors(e,t),r.cross(xi),0<(t=r.lengthSq())?r.multiplyScalar(1/Math.sqrt(t)):r.set(0,0,0)},getBarycoord:function(e,t,n,r,i){xi.subVectors(r,t),Ai.subVectors(n,t),Ii.subVectors(e,t);var o=xi.dot(xi),a=xi.dot(Ai);return r=xi.dot(Ii),n=Ai.dot(Ai),e=Ai.dot(Ii),t=o*n-a*a,void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new vr),0===t?i.set(-2,-1,-1):(n=(n*r-a*e)*(t=1/t),t*=o*e-a*r,i.set(1-n-t,t,n))},containsPoint:function(e,t,n,r){return Li.getBarycoord(e,t,n,r,wi),0<=wi.x&&0<=wi.y&&wi.x+wi.y<=1},getUV:function(e,t,n,r,i,o,a,s){return this.getBarycoord(e,t,n,r,wi),s.set(0,0),s.addScaledVector(i,wi.x),s.addScaledVector(o,wi.y),s.addScaledVector(a,wi.z),s},isFrontFacing:function(e,t,n,r){return xi.subVectors(n,t),Ai.subVectors(e,t),xi.cross(Ai).dot(r)<0}}),(0,m.default)(Li.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return xi.subVectors(this.c,this.b),Ai.subVectors(this.a,this.b),.5*xi.cross(Ai).length()},getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new vr),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Li.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new _i),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Li.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,r,i){return Li.getUV(e,this.a,this.b,this.c,t,n,r,i)},containsPoint:function(e){return Li.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return Li.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new vr);var n=this.a,r=this.b,i=this.c;bi.subVectors(r,n),Ci.subVectors(i,n),Ei.subVectors(e,n);var o=bi.dot(Ei),a=Ci.dot(Ei);if(o<=0&&a<=0)return t.copy(n);Ti.subVectors(e,r);var s=bi.dot(Ti),u=Ci.dot(Ti);if(0<=s&&u<=s)return t.copy(r);var l=o*u-s*a;if(l<=0&&0<=o&&s<=0)return h=o/(o-s),t.copy(n).addScaledVector(bi,h);Si.subVectors(e,i);var c=bi.dot(Si);if(0<=(e=Ci.dot(Si))&&c<=e)return t.copy(i);if((o=c*a-o*e)<=0&&0<=a&&e<=0)return f=a/(a-e),t.copy(n).addScaledVector(Ci,f);if((a=s*e-c*u)<=0&&0<=u-s&&0<=c-e)return Mi.subVectors(i,r),f=(u-s)/(u-s+(c-e)),t.copy(r).addScaledVector(Mi,f);var h=o*(a=1/(a+o+l)),f=l*a;return t.copy(n).addScaledVector(bi,h).addScaledVector(Ci,f)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var ki={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ri={h:0,s:0,l:0},Ni={h:0,s:0,l:0};function Pi(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}function Oi(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Di(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Fi(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function Bi(e,t,n,r,i,o){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new vr,this.vertexNormals=(0,_.default)(r)?r:[],this.color=i&&i.isColor?i:new Pi,this.vertexColors=(0,_.default)(i)?i:[],this.materialIndex=void 0!==o?o:0}(0,m.default)(Pi.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){return e=or.euclideanModulo(e,1),t=or.clamp(t,0,1),n=or.clamp(n,0,1),0===t?this.r=this.g=this.b=n:(n=2*n-(t=n<=.5?n*(1+t):n+t-n*t),this.r=Oi(n,t,e+1/3),this.g=Oi(n,t,e),this.b=Oi(n,t,e-1/3)),this},setStyle:function(e){function t(t){void 0!==t&&(0,A.default)(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(u=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,r=u[1],i=u[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(255,(0,I.default)(n[1],10))/255,this.g=Math.min(255,(0,I.default)(n[2],10))/255,this.b=Math.min(255,(0,I.default)(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(100,(0,I.default)(n[1],10))/100,this.g=Math.min(100,(0,I.default)(n[2],10))/100,this.b=Math.min(100,(0,I.default)(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i)){var o=(0,A.default)(n[1])/360,a=(0,I.default)(n[2],10)/100,s=(0,I.default)(n[3],10)/100;return t(n[5]),this.setHSL(o,a,s)}}}else if(u=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u=(r=u[1]).length;if(3===u)return this.r=(0,I.default)(r.charAt(0)+r.charAt(0),16)/255,this.g=(0,I.default)(r.charAt(1)+r.charAt(1),16)/255,this.b=(0,I.default)(r.charAt(2)+r.charAt(2),16)/255,this;if(6===u)return this.r=(0,I.default)(r.charAt(0)+r.charAt(1),16)/255,this.g=(0,I.default)(r.charAt(2)+r.charAt(3),16)/255,this.b=(0,I.default)(r.charAt(4)+r.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this},setColorName:function(e){var t=ki[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){return void 0===t&&(t=2),t=0<t?1/t:1,this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=Di(e.r),this.g=Di(e.g),this.b=Di(e.b),this},copyLinearToSRGB:function(e){return this.r=Fi(e.r),this.g=Fi(e.g),this.b=Fi(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n=this.r,r=this.g,i=this.b,o=Math.max(n,r,i),a=Math.min(n,r,i),s=(a+o)/2;if(a===o)t=0,l=0;else{var u=o-a,l=s<=.5?u/(o+a):u/(2-o-a);switch(o){case n:t=(r-i)/u+(r<i?6:0);break;case r:t=(i-n)/u+2;break;case i:t=(n-r)/u+4}t/=6}return e.h=t,e.s=l,e.l=s,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){return this.getHSL(Ri),Ri.h+=e,Ri.s+=t,Ri.l+=n,this.setHSL(Ri.h,Ri.s,Ri.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(Ri),e.getHSL(Ni);var n=or.lerp(Ri.h,Ni.h,t);return e=or.lerp(Ri.s,Ni.s,t),t=or.lerp(Ri.l,Ni.l,t),this.setHSL(n,e,t),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),Pi.NAMES=ki,(0,m.default)(Bi.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var Gi=0;function zi(){(0,g.default)(this,"id",{value:Gi++}),this.uuid=or.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=Y,this.side=U,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=ae,this.blendDst=se,this.blendEquation=K,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=me,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Wn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=kn,this.stencilZFail=kn,this.stencilZPass=kn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Ui(e){zi.call(this),this.type="MeshBasicMaterial",this.color=new Pi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ae,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}zi.prototype=(0,m.default)((0,y.default)(tr.prototype),{constructor:zi,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n,r=e[t];void 0!==r&&("shading"!==t?void 0!==(n=this[t])?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material."):(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r))}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t,n=[];for(t in e){var r=e[t];delete r.metadata,n.push(r)}return n}return n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Y&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==U&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==(0,x.default)(this.userData)&&(n.userData=this.userData),t&&(t=r(e.textures),e=r(e.images),0<t.length&&(n.textures=t),0<e.length&&(n.images=e)),n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t)for(var r=t.length,i=(n=new Array(r),0);i!==r;++i)n[i]=t[i].clone();return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse((0,x.default)(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(0,g.default)(zi.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Ui.prototype=(0,y.default)(zi.prototype),Ui.prototype.constructor=Ui,Ui.prototype.isMeshBasicMaterial=!0,Ui.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var Vi=new vr;function Hi(e,t,n){if((0,_.default)(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=Yn,this.updateRange={offset:0,count:-1},this.version=0}function ji(e,t,n){Hi.call(this,new Int8Array(e),t,n)}function Wi(e,t,n){Hi.call(this,new Uint8Array(e),t,n)}function Yi(e,t,n){Hi.call(this,new Uint8ClampedArray(e),t,n)}function qi(e,t,n){Hi.call(this,new Int16Array(e),t,n)}function Xi(e,t,n){Hi.call(this,new Uint16Array(e),t,n)}function Zi(e,t,n){Hi.call(this,new Int32Array(e),t,n)}function Ji(e,t,n){Hi.call(this,new Uint32Array(e),t,n)}function Ki(e,t,n){Hi.call(this,new Float32Array(e),t,n)}function Qi(e,t,n){Hi.call(this,new Float64Array(e),t,n)}function $i(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function eo(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}(0,g.default)(Hi.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),(0,m.default)(Hi.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Pi),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new ar),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new vr),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new hr),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},applyMatrix3:function(e){for(var t=0,n=this.count;t<n;t++)Vi.x=this.getX(t),Vi.y=this.getY(t),Vi.z=this.getZ(t),Vi.applyMatrix3(e),this.setXYZ(t,Vi.x,Vi.y,Vi.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)Vi.x=this.getX(t),Vi.y=this.getY(t),Vi.z=this.getZ(t),Vi.applyMatrix4(e),this.setXYZ(t,Vi.x,Vi.y,Vi.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)Vi.x=this.getX(t),Vi.y=this.getY(t),Vi.z=this.getZ(t),Vi.applyNormalMatrix(e),this.setXYZ(t,Vi.x,Vi.y,Vi.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)Vi.x=this.getX(t),Vi.y=this.getY(t),Vi.z=this.getZ(t),Vi.transformDirection(e),this.setXYZ(t,Vi.x,Vi.y,Vi.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),ji.prototype=(0,y.default)(Hi.prototype),ji.prototype.constructor=ji,Wi.prototype=(0,y.default)(Hi.prototype),Wi.prototype.constructor=Wi,Yi.prototype=(0,y.default)(Hi.prototype),Yi.prototype.constructor=Yi,qi.prototype=(0,y.default)(Hi.prototype),qi.prototype.constructor=qi,Xi.prototype=(0,y.default)(Hi.prototype),Xi.prototype.constructor=Xi,Zi.prototype=(0,y.default)(Hi.prototype),Zi.prototype.constructor=Zi,Ji.prototype=(0,y.default)(Hi.prototype),Ji.prototype.constructor=Ji,Ki.prototype=(0,y.default)(Hi.prototype),Ki.prototype.constructor=Ki,Qi.prototype=(0,y.default)(Hi.prototype),Qi.prototype.constructor=Qi,(0,m.default)($i.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,i=e.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:r})}void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t=e.faces,n=e.vertices,r=e.faceVertexUvs,i=r[0]&&0<r[0].length,o=r[1]&&0<r[1].length,a=e.morphTargets,s=a.length;if(0<s){for(var u=[],l=0;l<s;l++)u[l]={name:a[l].name,data:[]};this.morphTargets.position=u}var c=e.morphNormals,h=c.length;if(0<h){var f=[];for(l=0;l<h;l++)f[l]={name:c[l].name,data:[]};this.morphTargets.normal=f}var d=e.skinIndices,p=e.skinWeights,g=d.length===n.length,m=p.length===n.length;for(0<n.length&&0===t.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),l=0;l<t.length;l++){var v=t[l];this.vertices.push(n[v.a],n[v.b],n[v.c]);var y=v.vertexNormals;3===y.length?this.normals.push(y[0],y[1],y[2]):(x=v.normal,this.normals.push(x,x,x));var _,x=v.vertexColors;3===x.length?this.colors.push(x[0],x[1],x[2]):(x=v.color,this.colors.push(x,x,x)),!0===i&&(void 0!==(_=r[0][l])?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new ar,new ar,new ar))),!0===o&&(void 0!==(_=r[1][l])?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new ar,new ar,new ar)));for(var A=0;A<s;A++){var I=a[A].vertices;u[A].data.push(I[v.a],I[v.b],I[v.c])}for(A=0;A<h;A++){var w=c[A].vertexNormals[l];f[A].data.push(w.a,w.b,w.c)}g&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),m&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});var to=1,no=new Cr,ro=new Hr,io=new vr,oo=new ii,ao=new ii,so=new vr;function uo(){(0,g.default)(this,"id",{value:to+=2}),this.uuid=or.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}uo.prototype=(0,m.default)((0,y.default)(tr.prototype),{constructor:uo,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){(0,_.default)(e)?this.index=new(65535<eo(e)?Ji:Xi)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;return void 0!==n&&(t=(new sr).getNormalMatrix(e),n.applyNormalMatrix(t),n.needsUpdate=!0),void 0!==(n=this.attributes.tangent)&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return no.makeRotationX(e),this.applyMatrix4(no),this},rotateY:function(e){return no.makeRotationY(e),this.applyMatrix4(no),this},rotateZ:function(e){return no.makeRotationZ(e),this.applyMatrix4(no),this},translate:function(e,t,n){return no.makeTranslation(e,t,n),this.applyMatrix4(no),this},scale:function(e,t,n){return no.makeScale(e,t,n),this.applyMatrix4(no),this},lookAt:function(e){return ro.lookAt(e),ro.updateMatrix(),this.applyMatrix4(ro.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(io).negate(),this.translate(io.x,io.y,io.z),this},setFromObject:function(e){var t,n,r=e.geometry;return e.isPoints||e.isLine?(t=new Ki(3*r.vertices.length,3),n=new Ki(3*r.colors.length,3),this.setAttribute("position",t.copyVector3sArray(r.vertices)),this.setAttribute("color",n.copyColorsArray(r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length&&(n=new Ki(r.lineDistances.length,1),this.setAttribute("lineDistance",n.copyArray(r.lineDistances))),null!==r.boundingSphere&&(this.boundingSphere=r.boundingSphere.clone()),null!==r.boundingBox&&(this.boundingBox=r.boundingBox.clone())):e.isMesh&&r&&r.isGeometry&&this.fromGeometry(r),this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Ki(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new $i).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t,n,r,i,o=new Float32Array(3*e.vertices.length);for(r in this.setAttribute("position",new Hi(o,3).copyVector3sArray(e.vertices)),0<e.normals.length&&(t=new Float32Array(3*e.normals.length),this.setAttribute("normal",new Hi(t,3).copyVector3sArray(e.normals))),0<e.colors.length&&(t=new Float32Array(3*e.colors.length),this.setAttribute("color",new Hi(t,3).copyColorsArray(e.colors))),0<e.uvs.length&&(n=new Float32Array(2*e.uvs.length),this.setAttribute("uv",new Hi(n,2).copyVector2sArray(e.uvs))),0<e.uvs2.length&&(n=new Float32Array(2*e.uvs2.length),this.setAttribute("uv2",new Hi(n,2).copyVector2sArray(e.uvs2))),this.groups=e.groups,e.morphTargets){for(var a=[],s=e.morphTargets[r],u=0,l=s.length;u<l;u++){var c=s[u],h=new Ki(3*c.data.length,3);h.name=c.name,a.push(h.copyVector3sArray(c.data))}this.morphAttributes[r]=a}return 0<e.skinIndices.length&&(i=new Ki(4*e.skinIndices.length,4),this.setAttribute("skinIndex",i.copyVector4sArray(e.skinIndices))),0<e.skinWeights.length&&(i=new Ki(4*e.skinWeights.length,4),this.setAttribute("skinWeight",i.copyVector4sArray(e.skinWeights))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new ii);var e=this.attributes.position,t=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];oo.setFromBufferAttribute(i),this.morphTargetsRelative?(so.addVectors(this.boundingBox.min,oo.min),this.boundingBox.expandByPoint(so),so.addVectors(this.boundingBox.max,oo.max),this.boundingBox.expandByPoint(so)):(this.boundingBox.expandByPoint(oo.min),this.boundingBox.expandByPoint(oo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new si);var e=this.attributes.position,t=this.morphAttributes.position;if(e){var n=this.boundingSphere.center;if(oo.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var o=t[r];ao.setFromBufferAttribute(o),this.morphTargetsRelative?(so.addVectors(oo.min,ao.min),oo.expandByPoint(so),so.addVectors(oo.max,ao.max),oo.expandByPoint(so)):(oo.expandByPoint(ao.min),oo.expandByPoint(ao.max))}oo.getCenter(n);var a=0;for(r=0,i=e.count;r<i;r++)so.fromBufferAttribute(e,r),a=Math.max(a,n.distanceToSquared(so));if(t)for(r=0,i=t.length;r<i;r++){o=t[r];for(var s=this.morphTargetsRelative,u=0,l=o.count;u<l;u++)so.fromBufferAttribute(o,u),s&&(io.fromBufferAttribute(e,u),so.add(io)),a=Math.max(a,n.distanceToSquared(so))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(void 0===t.normal)this.setAttribute("normal",new Hi(new Float32Array(n.length),3));else for(var r=t.normal.array,i=0,o=r.length;i<o;i++)r[i]=0;var a,s,u,l=t.normal.array,c=new vr,h=new vr,f=new vr,d=new vr,p=new vr;if(e){var g=e.array;for(i=0,o=e.count;i<o;i+=3)a=3*g[i+0],s=3*g[i+1],u=3*g[i+2],c.fromArray(n,a),h.fromArray(n,s),f.fromArray(n,u),d.subVectors(f,h),p.subVectors(c,h),d.cross(p),l[a]+=d.x,l[a+1]+=d.y,l[a+2]+=d.z,l[s]+=d.x,l[s+1]+=d.y,l[s+2]+=d.z,l[u]+=d.x,l[u+1]+=d.y,l[u+2]+=d.z}else for(i=0,o=n.length;i<o;i+=9)c.fromArray(n,i),h.fromArray(n,i+3),f.fromArray(n,i+6),d.subVectors(f,h),p.subVectors(c,h),d.cross(p),l[i]=d.x,l[i+1]=d.y,l[i+2]=d.z,l[i+3]=d.x,l[i+4]=d.y,l[i+5]=d.z,l[i+6]=d.x,l[i+7]=d.y,l[i+8]=d.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n,r=this.attributes;for(n in r)if(void 0!==e.attributes[n])for(var i=(a=r[n]).array,o=(a=e.attributes[n]).array,a=a.itemSize*t,s=Math.min(o.length,i.length-a),u=0,l=a;u<s;u++,l++)i[l]=o[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)so.x=e.getX(t),so.y=e.getY(t),so.z=e.getZ(t),so.normalize(),e.setXYZ(t,so.x,so.y,so.z)},toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=new n.constructor(t.length*r),o=0,a=0,s=0,u=t.length;s<u;s++){o=t[s]*r;for(var l=0;l<r;l++)i[a++]=n[o++]}return new Hi(i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t,n=new uo,r=this.index.array,i=this.attributes;for(t in i){var o=i[t],a=e(o,r);n.setAttribute(t,a)}var s=this.morphAttributes;for(t in s){for(var u=[],l=s[t],c=0,h=l.length;c<h;c++)a=e(o=l[c],r),u.push(a);n.morphAttributes[t]=u}n.morphTargetsRelative=this.morphTargetsRelative;for(var f=this.groups,d=(c=0,f.length);c<d;c++){var p=f[c];n.addGroup(p.start,p.count,p.materialIndex)}return n},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),0<(0,w.default)(this.userData).length&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(a in t)void 0!==t[a]&&(e[a]=t[a]);return e}e.data={attributes:{}};var n=this.index;null!==n&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var r=this.attributes;for(a in r){var i=r[a],o=i.toJSON();""!==i.name&&(o.name=i.name),e.data.attributes[a]=o}var a,s={},u=!1;for(a in this.morphAttributes){for(var l=this.morphAttributes[a],c=[],h=0,f=l.length;h<f;h++)o=(i=l[h]).toJSON(),""!==i.name&&(o.name=i.name),c.push(o);0<c.length&&(s[a]=c,u=!0)}return u&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative),0<(n=this.groups).length&&(e.data.groups=JSON.parse((0,x.default)(n))),null!==(n=this.boundingSphere)&&(e.data.boundingSphere={center:n.center.toArray(),radius:n.radius}),e},clone:function(){return(new uo).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var t=e.index;null!==t&&this.setIndex(t.clone());var n,r=e.attributes;for(n in r){var i=r[n];this.setAttribute(n,i.clone())}var o=e.morphAttributes;for(n in o){for(var a=[],s=o[n],u=0,l=s.length;u<l;u++)a.push(s[u].clone());this.morphAttributes[n]=a}this.morphTargetsRelative=e.morphTargetsRelative;var c=e.groups;for(u=0,l=c.length;u<l;u++){var h=c[u];this.addGroup(h.start,h.count,h.materialIndex)}return null!==(t=e.boundingBox)&&(this.boundingBox=t.clone()),null!==(t=e.boundingSphere)&&(this.boundingSphere=t.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var lo=new Cr,co=new gi,ho=new si,fo=new vr,po=new vr,go=new vr,mo=new vr,vo=new vr,yo=new vr,_o=new vr,xo=new vr,Ao=new vr,Io=new ar,wo=new ar,bo=new ar,Co=new vr,Mo=new vr;function Eo(e,t){Hr.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new uo,this.material=void 0!==t?t:new Ui,this.updateMorphTargets()}function To(e,t,n,r,i,o,a,s){return null===(t=t.side===V?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,t.side!==H,s))?null:(Mo.copy(s),Mo.applyMatrix4(e.matrixWorld),(s=n.ray.origin.distanceTo(Mo))<n.near||s>n.far?null:{distance:s,point:Mo.clone(),object:e})}function So(e,t,n,r,i,o,a,s,u,l,c,h){fo.fromBufferAttribute(i,l),po.fromBufferAttribute(i,c),go.fromBufferAttribute(i,h);var f=e.morphTargetInfluences;if(t.morphTargets&&o&&f){_o.set(0,0,0),xo.set(0,0,0),Ao.set(0,0,0);for(var d=0,p=o.length;d<p;d++){var g=f[d],m=o[d];0!==g&&(mo.fromBufferAttribute(m,l),vo.fromBufferAttribute(m,c),yo.fromBufferAttribute(m,h),a?(_o.addScaledVector(mo,g),xo.addScaledVector(vo,g),Ao.addScaledVector(yo,g)):(_o.addScaledVector(mo.sub(fo),g),xo.addScaledVector(vo.sub(po),g),Ao.addScaledVector(yo.sub(go),g)))}fo.add(_o),po.add(xo),go.add(Ao)}return(r=To(e,t,n,r,fo,po,go,Co))&&(s&&(Io.fromBufferAttribute(s,l),wo.fromBufferAttribute(s,c),bo.fromBufferAttribute(s,h),r.uv=Li.getUV(Co,fo,po,go,Io,wo,bo,new ar)),u&&(Io.fromBufferAttribute(u,l),wo.fromBufferAttribute(u,c),bo.fromBufferAttribute(u,h),r.uv2=Li.getUV(Co,fo,po,go,Io,wo,bo,new ar)),u=new Bi(l,c,h),Li.getNormal(fo,po,go,u.normal),r.face=u),r}Eo.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:Eo,isMesh:!0,copy:function(e){return Hr.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=(0,m.default)({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=(0,w.default)(i);if(0<o.length){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)n=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else void 0!==(r=r.morphTargets)&&0<r.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(e,t){var n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r&&(null===n.boundingSphere&&n.computeBoundingSphere(),ho.copy(n.boundingSphere),ho.applyMatrix4(i),!1!==e.ray.intersectsSphere(ho)&&(lo.getInverse(i),co.copy(e.ray).applyMatrix4(lo),null===n.boundingBox||!1!==co.intersectsBox(n.boundingBox))))if(n.isBufferGeometry){var o,a,s,u,l,c,h,f,d,p=n.index,g=n.attributes.position,m=n.morphAttributes.position,v=n.morphTargetsRelative,y=n.attributes.uv,x=n.attributes.uv2,A=n.groups,I=n.drawRange;if(null!==p)if((0,_.default)(r))for(u=0,c=A.length;u<c;u++)for(d=r[(f=A[u]).materialIndex],l=Math.max(f.start,I.start),h=Math.min(f.start+f.count,I.start+I.count);l<h;l+=3)o=p.getX(l),a=p.getX(l+1),s=p.getX(l+2),(R=So(this,d,e,co,g,m,v,y,x,o,a,s))&&(R.faceIndex=Math.floor(l/3),R.face.materialIndex=f.materialIndex,t.push(R));else for(u=Math.max(0,I.start),c=Math.min(p.count,I.start+I.count);u<c;u+=3)o=p.getX(u),a=p.getX(u+1),s=p.getX(u+2),(R=So(this,r,e,co,g,m,v,y,x,o,a,s))&&(R.faceIndex=Math.floor(u/3),t.push(R));else if(void 0!==g)if((0,_.default)(r))for(u=0,c=A.length;u<c;u++)for(d=r[(f=A[u]).materialIndex],l=Math.max(f.start,I.start),h=Math.min(f.start+f.count,I.start+I.count);l<h;l+=3)(R=So(this,d,e,co,g,m,v,y,x,o=l,a=l+1,s=l+2))&&(R.faceIndex=Math.floor(l/3),R.face.materialIndex=f.materialIndex,t.push(R));else for(u=Math.max(0,I.start),c=Math.min(g.count,I.start+I.count);u<c;u+=3)(R=So(this,r,e,co,g,m,v,y,x,o=u,a=u+1,s=u+2))&&(R.faceIndex=Math.floor(u/3),t.push(R))}else if(n.isGeometry){var w,b=(0,_.default)(r),C=n.vertices,M=n.faces;0<(n=n.faceVertexUvs[0]).length&&(w=n);for(var E=0,T=M.length;E<T;E++){var S,L,k,R,N=M[E],P=b?r[N.materialIndex]:r;void 0!==P&&(S=C[N.a],L=C[N.b],k=C[N.c],(R=To(this,P,e,co,S,L,k,Co))&&(w&&w[E]&&(P=w[E],Io.copy(P[0]),wo.copy(P[1]),bo.copy(P[2]),R.uv=Li.getUV(Co,S,L,k,Io,wo,bo,new ar)),R.face=N,R.faceIndex=E,t.push(R)))}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Lo=0,ko=new Cr,Ro=new Hr,No=new vr;function Po(){(0,g.default)(this,"id",{value:Lo+=2}),this.uuid=or.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Po.prototype=(0,m.default)((0,y.default)(tr.prototype),{constructor:Po,isGeometry:!0,applyMatrix4:function(e){for(var t=(new sr).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(e);for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return ko.makeRotationX(e),this.applyMatrix4(ko),this},rotateY:function(e){return ko.makeRotationY(e),this.applyMatrix4(ko),this},rotateZ:function(e){return ko.makeRotationZ(e),this.applyMatrix4(ko),this},translate:function(e,t,n){return ko.makeTranslation(e,t,n),this.applyMatrix4(ko),this},scale:function(e,t,n){return ko.makeScale(e,t,n),this.applyMatrix4(ko),this},lookAt:function(e){return Ro.lookAt(e),Ro.updateMatrix(),this.applyMatrix4(Ro.matrix),this},fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index.array:void 0,r=e.attributes;if(void 0===r.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,u=void 0!==r.uv2?r.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var l=0;l<i.length;l+=3)t.vertices.push((new vr).fromArray(i,l)),void 0!==a&&t.colors.push((new Pi).fromArray(a,l));function c(e,n,r,i){var l=void 0===a?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[r].clone()];i=new Bi(e,n,r,void 0===o?[]:[(new vr).fromArray(o,3*e),(new vr).fromArray(o,3*n),(new vr).fromArray(o,3*r)],l,i),t.faces.push(i),void 0!==s&&t.faceVertexUvs[0].push([(new ar).fromArray(s,2*e),(new ar).fromArray(s,2*n),(new ar).fromArray(s,2*r)]),void 0!==u&&t.faceVertexUvs[1].push([(new ar).fromArray(u,2*e),(new ar).fromArray(u,2*n),(new ar).fromArray(u,2*r)])}var h=e.groups;if(0<h.length)for(l=0;l<h.length;l++)for(var f=h[l],d=f.start,p=d,g=d+f.count;p<g;p+=3)void 0!==n?c(n[p],n[p+1],n[p+2],f.materialIndex):c(p,p+1,p+2,f.materialIndex);else if(void 0!==n)for(l=0;l<n.length;l+=3)c(n[l],n[l+1],n[l+2]);else for(l=0;l<i.length/3;l+=3)c(l,l+1,l+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(No).negate(),this.translate(No.x,No.y,No.z),this},normalize:function(){this.computeBoundingSphere();var e,t=this.boundingSphere.center,n=0===(e=this.boundingSphere.radius)?1:1/e;return(e=new Cr).set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(e),this},computeFaceNormals:function(){for(var e=new vr,t=new vr,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r;for(void 0===e&&(e=!0),r=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)r[t]=new vr;if(e)for(var i,o,a,s=new vr,u=new vr,l=0,c=this.faces.length;l<c;l++)h=this.faces[l],i=this.vertices[h.a],o=this.vertices[h.b],a=this.vertices[h.c],s.subVectors(a,o),u.subVectors(i,o),s.cross(u),r[h.a].add(s),r[h.b].add(s),r[h.c].add(s);else for(this.computeFaceNormals(),l=0,c=this.faces.length;l<c;l++)r[(h=this.faces[l]).a].add(h.normal),r[h.b].add(h.normal),r[h.c].add(h.normal);for(t=0,n=this.vertices.length;t<n;t++)r[t].normalize();for(l=0,c=this.faces.length;l<c;l++){var h=this.faces[l],f=h.vertexNormals;3===f.length?(f[0].copy(r[h.a]),f[1].copy(r[h.b]),f[2].copy(r[h.c])):(f[0]=r[h.a].clone(),f[1]=r[h.b].clone(),f[2]=r[h.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n=this.faces[e],r=n.vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(var e,t,n,r=0,i=this.faces.length;r<i;r++)for((n=this.faces[r]).__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]),e=0,t=n.vertexNormals.length;e<t;e++)n.__originalVertexNormals[e]?n.__originalVertexNormals[e].copy(n.vertexNormals[e]):n.__originalVertexNormals[e]=n.vertexNormals[e].clone();var o=new Po;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(r=0,i=this.faces.length;r<i;r++)u=new vr,l={a:new vr,b:new vr,c:new vr},a.push(u),s.push(l)}var u,l,c=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),r=0,i=this.faces.length;r<i;r++)n=this.faces[r],u=c.faceNormals[r],l=c.vertexNormals[r],u.copy(n.normal),l.a.copy(n.vertexNormals[0]),l.b.copy(n.vertexNormals[1]),l.c.copy(n.vertexNormals[2])}for(r=0,i=this.faces.length;r<i;r++)(n=this.faces[r]).normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new ii),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new si),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,u=e.faces,l=this.colors,c=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new sr).getNormalMatrix(t));for(var h=0,f=a.length;h<f;h++){var d=(d=a[h]).clone();void 0!==t&&d.applyMatrix4(t),o.push(d)}for(h=0,f=c.length;h<f;h++)l.push(c[h].clone());for(h=0,f=u.length;h<f;h++){var p,g,m=u[h],v=m.vertexNormals,y=m.vertexColors,_=new Bi(m.a+i,m.b+i,m.c+i);_.normal.copy(m.normal),void 0!==r&&_.normal.applyMatrix3(r).normalize();for(var x=0,A=v.length;x<A;x++)p=v[x].clone(),void 0!==r&&p.applyMatrix3(r).normalize(),_.vertexNormals.push(p);for(_.color.copy(m.color),x=0,A=y.length;x<A;x++)g=y[x],_.vertexColors.push(g.clone());_.materialIndex=m.materialIndex+n,s.push(_)}for(h=0,f=e.faceVertexUvs.length;h<f;h++){var I=e.faceVertexUvs[h];for(void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]),x=0,A=I.length;x<A;x++){for(var w=I[x],b=[],C=0,M=w.length;C<M;C++)b.push(w[C].clone());this.faceVertexUvs[h].push(b)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){for(var e,t,n,r,i={},o=[],a=[],s=4,u=Math.pow(10,s),l=0,c=this.vertices.length;l<c;l++)e=this.vertices[l],void 0===i[e=Math.round(e.x*u)+"_"+Math.round(e.y*u)+"_"+Math.round(e.z*u)]?(i[e]=l,o.push(this.vertices[l]),a[l]=o.length-1):a[l]=a[i[e]];var h=[];for(l=0,c=this.faces.length;l<c;l++){(t=this.faces[l]).a=a[t.a],t.b=a[t.b],t.c=a[t.c];for(var f=[t.a,t.b,t.c],d=0;d<3;d++)if(f[d]===f[(d+1)%3]){h.push(l);break}}for(l=h.length-1;0<=l;l--){var p=h[l];for(this.faces.splice(p,1),n=0,r=this.faceVertexUvs.length;n<r;n++)this.faceVertexUvs[n].splice(p,1)}return s=this.vertices.length-o.length,this.vertices=o,s},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new vr(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(o&&o.length===t&&(r=[]),a&&a.length===t&&(i=[]),n=0;n<t;n++){var s=e[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t,n=this.parameters;for(t in n)void 0!==n[t]&&(e[t]=n[t]);return e}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],u={},l=[],c={},h=[],f={};for(i=0;i<this.faces.length;i++){var d=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],g=0<d.normal.length(),m=0<d.vertexNormals.length,v=1!==d.color.r||1!==d.color.g||1!==d.color.b,y=0<d.vertexColors.length,_=x(_=0,0,0);_=x(_,1,!0),_=x(_,2,!1),_=x(_,3,p),_=x(_,4,g),_=x(_,5,m),_=x(_,6,v),_=x(_,7,y),a.push(_),a.push(d.a,d.b,d.c),a.push(d.materialIndex),p&&(p=this.faceVertexUvs[0][i],a.push(w(p[0]),w(p[1]),w(p[2]))),g&&a.push(A(d.normal)),m&&(m=d.vertexNormals,a.push(A(m[0]),A(m[1]),A(m[2]))),v&&a.push(I(d.color)),y&&(d=d.vertexColors,a.push(I(d[0]),I(d[1]),I(d[2])))}function x(e,t,n){return n?e|1<<t:e&~(1<<t)}function A(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==u[t]||(u[t]=s.length/3,s.push(e.x,e.y,e.z)),u[t]}function I(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]||(c[t]=l.length,l.push(e.getHex())),c[t]}function w(e){var t=e.x.toString()+e.y.toString();return void 0!==f[t]||(f[t]=h.length/2,h.push(e.x,e.y)),f[t]}return e.data={},e.data.vertices=r,e.data.normals=s,0<l.length&&(e.data.colors=l),0<h.length&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){return(new Po).copy(this)},copy:function(e){var t,n;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;for(var r=e.vertices,i=0,o=r.length;i<o;i++)this.vertices.push(r[i].clone());var a=e.colors;for(i=0,o=a.length;i<o;i++)this.colors.push(a[i].clone());var s=e.faces;for(i=0,o=s.length;i<o;i++)this.faces.push(s[i].clone());for(i=0,o=e.faceVertexUvs.length;i<o;i++){var u=e.faceVertexUvs[i];for(void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]),t=0,n=u.length;t<n;t++){for(var l=u[t],c=[],h=0,f=l.length;h<f;h++){var d=l[h];c.push(d.clone())}this.faceVertexUvs[i].push(c)}}var p=e.morphTargets;for(i=0,o=p.length;i<o;i++){var g={};if(g.name=p[i].name,void 0!==p[i].vertices)for(g.vertices=[],t=0,n=p[i].vertices.length;t<n;t++)g.vertices.push(p[i].vertices[t].clone());if(void 0!==p[i].normals)for(g.normals=[],t=0,n=p[i].normals.length;t<n;t++)g.normals.push(p[i].normals[t].clone());this.morphTargets.push(g)}var m=e.morphNormals;for(i=0,o=m.length;i<o;i++){var v={};if(void 0!==m[i].vertexNormals)for(v.vertexNormals=[],t=0,n=m[i].vertexNormals.length;t<n;t++){var y=m[i].vertexNormals[t],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),v.vertexNormals.push(_)}if(void 0!==m[i].faceNormals)for(v.faceNormals=[],t=0,n=m[i].faceNormals.length;t<n;t++)v.faceNormals.push(m[i].faceNormals[t].clone());this.morphNormals.push(v)}var x=e.skinWeights;for(i=0,o=x.length;i<o;i++)this.skinWeights.push(x[i].clone());var A=e.skinIndices;for(i=0,o=A.length;i<o;i++)this.skinIndices.push(A[i].clone());var I=e.lineDistances;for(i=0,o=I.length;i<o;i++)this.lineDistances.push(I[i]);var w=e.boundingBox;return null!==w&&(this.boundingBox=w.clone()),null!==(w=e.boundingSphere)&&(this.boundingSphere=w.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Oo=function(e){(0,c.default)(n,e);var t=T(n);function n(e,r,i,o,a,s){var u;return(0,l.default)(this,n),(u=t.call(this)).type="BoxGeometry",u.parameters={width:e,height:r,depth:i,widthSegments:o,heightSegments:a,depthSegments:s},u.fromBufferGeometry(new Do(e,r,i,o,a,s)),u.mergeVertices(),u}return n}(Po);t.CubeGeometry=t.BoxGeometry=Oo;var Do=function(e){(0,c.default)(n,e);var t=T(n);function n(e,r,i,o,a,s){var c;(0,l.default)(this,n),(c=t.call(this)).type="BoxBufferGeometry",c.parameters={width:e,height:r,depth:i,widthSegments:o,heightSegments:a,depthSegments:s};var h=(0,u.default)(c);e=e||1,r=r||1,i=i||1,o=Math.floor(o)||1,a=Math.floor(a)||1,s=Math.floor(s)||1;var f=[],d=[],p=[],g=[],m=0,v=0;function y(e,t,n,r,i,o,a,s,u,l,c){for(var y=o/u,_=a/l,x=o/2,A=a/2,I=s/2,w=u+1,b=l+1,C=0,M=0,E=new vr,T=0;T<b;T++)for(var S=T*_-A,L=0;L<w;L++){var k=L*y-x;E[e]=k*r,E[t]=S*i,E[n]=I,d.push(E.x,E.y,E.z),E[e]=0,E[t]=0,E[n]=0<s?1:-1,p.push(E.x,E.y,E.z),g.push(L/u),g.push(1-T/l),C+=1}for(T=0;T<l;T++)for(L=0;L<u;L++){var R=m+L+w*T,N=m+L+w*(T+1),P=m+(L+1)+w*(T+1),O=m+(L+1)+w*T;f.push(R,N,O),f.push(N,P,O),M+=6}h.addGroup(v,M,c),v+=M,m+=C}return y("z","y","x",-1,-1,i,r,e,s,a,0),y("z","y","x",1,-1,i,r,-e,s,a,1),y("x","z","y",1,1,e,i,r,o,s,2),y("x","z","y",1,-1,e,i,-r,o,s,3),y("x","y","z",1,-1,e,r,i,o,a,4),y("x","y","z",-1,-1,e,r,-i,o,a,5),c.setIndex(f),c.setAttribute("position",new Ki(d,3)),c.setAttribute("normal",new Ki(p,3)),c.setAttribute("uv",new Ki(g,2)),c}return n}(uo);function Fo(e){var t,n={};for(t in e)for(var r in n[t]={},e[t]){var i=e[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?n[t][r]=i.clone():(0,_.default)(i)?n[t][r]=i.slice():n[t][r]=i}return n}function Bo(e){for(var t={},n=0;n<e.length;n++){var r,i=Fo(e[n]);for(r in i)t[r]=i[r]}return t}t.BoxBufferGeometry=Do;var Go={clone:Fo,merge:Bo};t.UniformsUtils=Go;var zo="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",Uo="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function Vo(e){zi.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=zo,this.fragmentShader=Uo,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Ho(){Hr.call(this),this.type="Camera",this.matrixWorldInverse=new Cr,this.projectionMatrix=new Cr,this.projectionMatrixInverse=new Cr}function jo(e,t,n,r){Ho.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Vo.prototype=(0,y.default)(zi.prototype),Vo.prototype.constructor=Vo,Vo.prototype.isShaderMaterial=!0,Vo.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Fo(e.uniforms),this.defines=(0,m.default)({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Vo.prototype.toJSON=function(e){var t,n=zi.prototype.toJSON.call(this,e);for(t in n.uniforms={},this.uniforms){var r;(r=(r=this.uniforms[t]).value)&&r.isTexture?n.uniforms[t]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?n.uniforms[t]={type:"c",value:r.getHex()}:r&&r.isVector2?n.uniforms[t]={type:"v2",value:r.toArray()}:r&&r.isVector3?n.uniforms[t]={type:"v3",value:r.toArray()}:r&&r.isVector4?n.uniforms[t]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?n.uniforms[t]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?n.uniforms[t]={type:"m4",value:r.toArray()}:n.uniforms[t]={value:r}}0<(0,w.default)(this.defines).length&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader;var i,o={};for(i in this.extensions)!0===this.extensions[i]&&(o[i]=!0);return 0<(0,w.default)(o).length&&(n.extensions=o),n},Ho.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:Ho,isCamera:!0,copy:function(e,t){return Hr.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new vr),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Hr.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){Hr.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),jo.prototype=(0,m.default)((0,y.default)(Ho.prototype),{constructor:jo,isPerspectiveCamera:!0,copy:function(e,t){return Ho.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:(0,m.default)({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*or.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*or.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*or.RAD2DEG*Math.atan(Math.tan(.5*or.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e,t=this.near,n=t*Math.tan(.5*or.DEG2RAD*this.fov)/this.zoom,r=2*n,i=this.aspect*r,o=-.5*i,a=this.view;null!==this.view&&this.view.enabled&&(e=a.fullWidth,s=a.fullHeight,o+=a.offsetX*i/e,n-=a.offsetY*r/s,i*=a.width/e,r*=a.height/s);var s=this.filmOffset;0!==s&&(o+=t*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+i,n,n-r,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return(e=Hr.prototype.toJSON.call(this,e)).object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=(0,m.default)({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});var Wo=90,Yo=1;function qo(e,t,n,r){Hr.call(this),this.type="CubeCamera";var i=new jo(Wo,Yo,e,t);i.up.set(0,-1,0),i.lookAt(new vr(1,0,0)),this.add(i);var o=new jo(Wo,Yo,e,t);o.up.set(0,-1,0),o.lookAt(new vr(-1,0,0)),this.add(o);var a=new jo(Wo,Yo,e,t);a.up.set(0,0,1),a.lookAt(new vr(0,1,0)),this.add(a);var s=new jo(Wo,Yo,e,t);s.up.set(0,0,-1),s.lookAt(new vr(0,-1,0)),this.add(s);var u=new jo(Wo,Yo,e,t);u.up.set(0,-1,0),u.lookAt(new vr(0,0,1)),this.add(u);var l=new jo(Wo,Yo,e,t);l.up.set(0,-1,0),l.lookAt(new vr(0,0,-1)),this.add(l),r=r||{format:ct,magFilter:Ye,minFilter:Ye},this.renderTarget=new Xo(n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=e.getRenderTarget(),r=this.renderTarget,c=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,o),e.setRenderTarget(r,2),e.render(t,a),e.setRenderTarget(r,3),e.render(t,s),e.setRenderTarget(r,4),e.render(t,u),r.texture.generateMipmaps=c,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(n)},this.clear=function(e,t,n,r){for(var i=e.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)e.setRenderTarget(o,a),e.clear(t,n,r);e.setRenderTarget(i)}}function Xo(e,t,n){(0,p.default)(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),fr.call(this,e,e,t)}function Zo(e,t,n,r,i,o,a,s,u,l,c,h){cr.call(this,null,o,a,s,u,l,r,i,c,h),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=void 0!==u?u:Ue,this.minFilter=void 0!==l?l:Ue,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}qo.prototype=(0,y.default)(Hr.prototype),qo.prototype.constructor=qo,Xo.prototype=(0,y.default)(fr.prototype),Xo.prototype.constructor=Xo,Xo.prototype.isWebGLCubeRenderTarget=!0,Xo.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var n,r=new jr;return(n=new Vo({type:"CubemapFromEquirect",uniforms:Fo((n={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")}).uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:V,blending:W})).uniforms.tEquirect.value=t,t=new Eo(new Do(5,5,5),n),r.add(t),(n=new qo(1,10,1)).renderTarget=this,n.renderTarget.texture.name="CubeCameraTexture",n.update(e,r),t.geometry.dispose(),t.material.dispose(),this},Zo.prototype=(0,y.default)(cr.prototype),Zo.prototype.constructor=Zo,Zo.prototype.isDataTexture=!0;var Jo=new si,Ko=new vr;function Qo(e,t,n,r,i,o){this.planes=[void 0!==e?e:new _i,void 0!==t?t:new _i,void 0!==n?n:new _i,void 0!==r?r:new _i,void 0!==i?i:new _i,void 0!==o?o:new _i]}(0,m.default)(Qo.prototype,{set:function(e,t,n,r,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromProjectionMatrix:function(e){var t=this.planes,n=(m=e.elements)[0],r=m[1],i=m[2],o=m[3],a=m[4],s=m[5],u=m[6],l=m[7],c=m[8],h=m[9],f=m[10],d=m[11],p=m[12],g=m[13],m=(e=m[14],m[15]);return t[0].setComponents(o-n,l-a,d-c,m-p).normalize(),t[1].setComponents(o+n,l+a,d+c,m+p).normalize(),t[2].setComponents(o+r,l+s,d+h,m+g).normalize(),t[3].setComponents(o-r,l-s,d-h,m-g).normalize(),t[4].setComponents(o-i,l-u,d-f,m-e).normalize(),t[5].setComponents(o+i,l+u,d+f,m+e).normalize(),this},intersectsObject:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Jo.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Jo)},intersectsSprite:function(e){return Jo.center.set(0,0,0),Jo.radius=.7071067811865476,Jo.applyMatrix4(e.matrixWorld),this.intersectsSphere(Jo)},intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0},intersectsBox:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Ko.x=(0<r.normal.x?e.max:e.min).x,Ko.y=(0<r.normal.y?e.max:e.min).y,Ko.z=(0<r.normal.z?e.max:e.min).z,r.distanceToPoint(Ko)<0)return!1}return!0},containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var $o={common:{diffuse:{value:new Pi(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new sr},uv2Transform:{value:new sr},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ar(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Pi(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new sr}},sprite:{diffuse:{value:new Pi(15658734)},opacity:{value:1},center:{value:new ar(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new sr}}};function ea(){var e=null,t=!1,n=null;function r(i,o){!1!==t&&(n(i,o),e.requestAnimationFrame(r))}return{start:function(){!0!==t&&null!==n&&(e.requestAnimationFrame(r),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function ta(e,t){var n=t.isWebGL2,r=new b.default;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,n){var r=t.array,i=t.usage,o=e.createBuffer();return e.bindBuffer(n,o),e.bufferData(n,r,i),t.onUploadCallback(),i=5126,r instanceof Float32Array?i=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?i=5123:r instanceof Int16Array?i=5122:r instanceof Uint32Array?i=5125:r instanceof Int32Array?i=5124:r instanceof Int8Array?i=5120:r instanceof Uint8Array&&(i=5121),{buffer:o,type:i,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(t,i)):o.version<t.version&&(function(t,r,i){var o=r.array;r=r.updateRange,e.bindBuffer(i,t),-1===r.count?e.bufferSubData(i,0,o):(n?e.bufferSubData(i,r.offset*o.BYTES_PER_ELEMENT,o,r.offset,r.count):e.bufferSubData(i,r.offset*o.BYTES_PER_ELEMENT,o.subarray(r.offset,r.offset+r.count)),r.count=-1)}(o.buffer,t,i),o.version=t.version)}}}function na(e,t,n,r){Po.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new ra(e,t,n,r)),this.mergeVertices()}function ra(e,t,n,r){uo.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};for(var i=(e=e||1)/2,o=(t=t||1)/2,a=Math.floor(n)||1,s=Math.floor(r)||1,u=a+1,l=s+1,c=e/a,h=t/s,f=[],d=[],p=[],g=[],m=0;m<l;m++)for(var v=m*h-o,y=0;y<u;y++){var _=y*c-i;d.push(_,-v,0),p.push(0,0,1),g.push(y/a),g.push(1-m/s)}for(m=0;m<s;m++)for(y=0;y<a;y++){var x=y+u*m,A=y+u*(m+1),I=y+1+u*(m+1),w=y+1+u*m;f.push(x,A,w),f.push(A,I,w)}this.setIndex(f),this.setAttribute("position",new Ki(d,3)),this.setAttribute("normal",new Ki(p,3)),this.setAttribute("uv",new Ki(g,2))}t.UniformsLib=$o,na.prototype=(0,y.default)(Po.prototype),na.prototype.constructor=na,ra.prototype=(0,y.default)(uo.prototype),ra.prototype.constructor=ra;var ia={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\t#ifdef USE_MAP_MIXCOLOR\n diffuseColor = texelColor*texelColor.a + diffuseColor*(1.0-texelColor.a);\n #else\n diffuseColor *= texelColor;\n #endif\n #endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:i="#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:o="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:n="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:S="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:L="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:P="uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:O="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:D="#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:F="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:j="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:He="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:We="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:Xe="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:Je="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:mn="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:vn="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:Ln="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:Rn="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:Nn="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:Pn="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:On="#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:Dn="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshmatcap_vert:Fn="#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:Bn="#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:Gn="#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:zn="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\tgl_FragColor =vec4(1.0,0.2,0.3,1.0);\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:Un="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:Vn="#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform float test;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\tif(test == 1.0){\n\tgl_FragColor = vec4( 1.0,1.0,0.2,1.0 );\n\t}\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:Hn="#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:jn="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:Xn="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:Zn="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:Jn="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:Kn="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:Qn="#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:$n="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:er="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"};t.ShaderChunk=ia;var oa={basic:{uniforms:Bo([$o.common,$o.specularmap,$o.envmap,$o.aomap,$o.lightmap,$o.fog]),vertexShader:ia.meshbasic_vert,fragmentShader:ia.meshbasic_frag},lambert:{uniforms:Bo([$o.common,$o.specularmap,$o.envmap,$o.aomap,$o.lightmap,$o.emissivemap,$o.fog,$o.lights,{emissive:{value:new Pi(0)}}]),vertexShader:ia.meshlambert_vert,fragmentShader:ia.meshlambert_frag},phong:{uniforms:Bo([$o.common,$o.specularmap,$o.envmap,$o.aomap,$o.lightmap,$o.emissivemap,$o.bumpmap,$o.normalmap,$o.displacementmap,$o.fog,$o.lights,{emissive:{value:new Pi(0)},specular:{value:new Pi(1118481)},shininess:{value:30}}]),vertexShader:ia.meshphong_vert,fragmentShader:ia.meshphong_frag},standard:{uniforms:Bo([$o.common,$o.envmap,$o.aomap,$o.lightmap,$o.emissivemap,$o.bumpmap,$o.normalmap,$o.displacementmap,$o.roughnessmap,$o.metalnessmap,$o.fog,$o.lights,{emissive:{value:new Pi(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:ia.meshphysical_vert,fragmentShader:ia.meshphysical_frag},toon:{uniforms:Bo([$o.common,$o.specularmap,$o.aomap,$o.lightmap,$o.emissivemap,$o.bumpmap,$o.normalmap,$o.displacementmap,$o.gradientmap,$o.fog,$o.lights,{emissive:{value:new Pi(0)},specular:{value:new Pi(1118481)},shininess:{value:30}}]),vertexShader:ia.meshtoon_vert,fragmentShader:ia.meshtoon_frag},matcap:{uniforms:Bo([$o.common,$o.bumpmap,$o.normalmap,$o.displacementmap,$o.fog,{matcap:{value:null}}]),vertexShader:ia.meshmatcap_vert,fragmentShader:ia.meshmatcap_frag},points:{uniforms:Bo([$o.points,$o.fog]),vertexShader:ia.points_vert,fragmentShader:ia.points_frag},dashed:{uniforms:Bo([$o.common,$o.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ia.linedashed_vert,fragmentShader:ia.linedashed_frag},depth:{uniforms:Bo([$o.common,$o.displacementmap]),vertexShader:ia.depth_vert,fragmentShader:ia.depth_frag},normal:{uniforms:Bo([$o.common,$o.bumpmap,$o.normalmap,$o.displacementmap,{opacity:{value:1}}]),vertexShader:ia.normal_vert,fragmentShader:ia.normal_frag},sprite:{uniforms:Bo([$o.sprite,$o.fog]),vertexShader:ia.sprite_vert,fragmentShader:ia.sprite_frag},background:{uniforms:{uvTransform:{value:new sr},t2D:{value:null}},vertexShader:ia.background_vert,fragmentShader:ia.background_frag},cube:{uniforms:Bo([$o.envmap,{opacity:{value:1}}]),vertexShader:ia.cube_vert,fragmentShader:ia.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ia.equirect_vert,fragmentShader:ia.equirect_frag},distanceRGBA:{uniforms:Bo([$o.common,$o.displacementmap,{referencePosition:{value:new vr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ia.distanceRGBA_vert,fragmentShader:ia.distanceRGBA_frag},shadow:{uniforms:Bo([$o.lights,$o.fog,{color:{value:new Pi(0)},opacity:{value:1}}]),vertexShader:ia.shadow_vert,fragmentShader:ia.shadow_frag}};function aa(e,t,n,r){var i,o,a=new Pi(0),s=0,u=null,l=0,c=null;function h(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,r)}return{getClearColor:function(){return a},setClearColor:function(e,t){a.set(e),h(a,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){h(a,s=e)},render:function(t,r,f,d){var p=r.background;(r=(r=e.xr).getSession&&r.getSession())&&"additive"===r.environmentBlendMode&&(p=null),null===p?h(a,s):p&&p.isColor&&(h(p,1),d=!0),(e.autoClear||d)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLCubeRenderTarget||p.mapping===De)?(void 0===o&&((o=new Eo(new Do(1,1,1),new Vo({type:"BackgroundCubeMaterial",uniforms:Fo(oa.cube.uniforms),vertexShader:oa.cube.vertexShader,fragmentShader:oa.cube.fragmentShader,side:V,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},(0,g.default)(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(o)),d=p.isWebGLCubeRenderTarget?p.texture:p,o.material.uniforms.envMap.value=d,o.material.uniforms.flipEnvMap.value=d.isCubeTexture?-1:1,u===p&&l===d.version&&c===e.toneMapping||(o.material.needsUpdate=!0,u=p,l=d.version,c=e.toneMapping),t.unshift(o,o.geometry,o.material,0,0,null)):p&&p.isTexture&&(void 0===i&&((i=new Eo(new ra(2,2),new Vo({type:"BackgroundMaterial",uniforms:Fo(oa.background.uniforms),vertexShader:oa.background.vertexShader,fragmentShader:oa.background.fragmentShader,side:U,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),(0,g.default)(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),i.material.uniforms.uvTransform.value.copy(p.matrix),u===p&&l===p.version&&c===e.toneMapping||(i.material.needsUpdate=!0,u=p,l=p.version,c=e.toneMapping),t.unshift(i,i.geometry,i.material,0,0,null))}}}function sa(e,t,n,r){var i,o=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i)},this.renderInstances=function(r,a,s,u){if(0!==u){var l,c;if(o)l=e,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](i,a,s,u),n.update(s,i,u)}}}function ua(e,t,n){var r;function i(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,a=void 0!==n.precision?n.precision:"highp";(s=i(a))!==a&&(a=s);var s,u=!0===n.logarithmicDepthBuffer,l=e.getParameter(34930),c=e.getParameter(35660),h=e.getParameter(3379),f=e.getParameter(34076),d=e.getParameter(34921),p=e.getParameter(36347),g=e.getParameter(36348),m=e.getParameter(36349),v=0<c,y=o||!!t.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:u,maxTextures:l,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:f,maxAttributes:d,maxVertexUniforms:p,maxVaryings:g,maxFragmentUniforms:m,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:s=v&&y,maxSamples:n=o?e.getParameter(36183):0}}function la(){var e=this,t=null,n=0,r=!1,i=!1,o=new _i,a=new sr,s={value:null,needsUpdate:!1};function u(){s.value!==t&&(s.value=t,s.needsUpdate=0<n),e.numPlanes=n,e.numIntersection=0}function l(t,n,r,i){var u=null!==t?t.length:0,l=null;if(0!==u){if(l=s.value,!0!==i||null===l){i=r+4*u;var c=n.matrixWorldInverse;a.getNormalMatrix(c),(null===l||l.length<i)&&(l=new Float32Array(i));for(var h=0,f=r;h!==u;++h,f+=4)o.copy(t[h]).applyMatrix4(c,a),o.normal.toArray(l,f),l[f+3]=o.constant}s.value=l,s.needsUpdate=!0}return e.numPlanes=u,e.numIntersection=0,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,o){var a=0!==e.length||i||0!==n||r;return r=i,t=l(e,o,0),n=e.length,a},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,u()},this.setState=function(e,o,a,c,h,f){if(!r||null===e||0===e.length||i&&!a)i?l(null):u();else{var d=4*(a=i?0:n),p=h.clippingState||null;s.value=p,p=l(e,c,d,f);for(var g=0;g!==d;++g)p[g]=t[g];h.clippingState=p,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=a}}}function ca(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}}}function ha(e,t,n){var r=new b.default,i=new b.default;function o(e){e=e.target;var a,s=r.get(e);for(a in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[a]);e.removeEventListener("dispose",o),r.delete(e),(e=i.get(s))&&(t.remove(e),i.delete(s)),n.memory.geometries--}function a(e){var n=[],r=e.index,o=e.attributes.position,a=0;if(null!==r)for(var s=r.array,u=(a=r.version,0),l=s.length;u<l;u+=3){var c=s[u+0],h=s[u+1],f=s[u+2];n.push(c,h,h,f,f,c)}else for(s=o.array,a=o.version,u=0,l=s.length/3-1;u<l;u+=3)c=u+0,h=u+1,f=u+2,n.push(c,h,h,f,f,c);(o=new(65535<eo(n)?Ji:Xi)(n,1)).version=a,t.update(o,34963),(a=i.get(e))&&t.remove(a),i.set(e,o)}return{get:function(e,t){var i=r.get(t);return i||(t.addEventListener("dispose",o),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new uo).setFromObject(e)),i=t._bufferGeometry),r.set(t,i),n.memory.geometries++,i)},update:function(e){var n=e.index,r=e.attributes;for(i in null!==n&&t.update(n,34963),r)t.update(r[i],34962);var i,o=e.morphAttributes;for(i in o)for(var a=o[i],s=0,u=a.length;s<u;s++)t.update(a[s],34962)},getWireframeAttribute:function(e){var t,n=i.get(e);return n?null!==(t=e.index)&&n.version<t.version&&a(e):a(e),i.get(e)}}}function fa(e,t,n,r){var i,o,a,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,o,t*a),n.update(r,i)},this.renderInstances=function(r,u,l,c){if(0!==c){var h,f;if(s)h=e,f="drawElementsInstanced";else if(f="drawElementsInstancedANGLE",null===(h=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](i,l,o,u*a,c),n.update(l,i,c)}}}function da(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(r=r||1,t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function pa(e,t){return Math.abs(t[1])-Math.abs(e[1])}function ga(e){var t={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,u=void 0===s?0:s.length;if(void 0===(l=t[i.id])){for(var l=[],c=0;c<u;c++)l[c]=[c,0];t[i.id]=l}var h=o.morphTargets&&i.morphAttributes.position,f=o.morphNormals&&i.morphAttributes.normal;for(c=0;c<u;c++){var d=l[c];0!==d[1]&&(h&&i.deleteAttribute("morphTarget"+c),f&&i.deleteAttribute("morphNormal"+c))}for(c=0;c<u;c++)(d=l[c])[0]=c,d[1]=s[c];l.sort(pa);var p=0;for(c=0;c<8;c++){if(d=l[c]){var g=d[0],m=d[1];if(m){h&&i.setAttribute("morphTarget"+c,h[g]),f&&i.setAttribute("morphNormal"+c,f[g]),n[c]=m,p+=m;continue}}n[c]=0}o=i.morphTargetsRelative?1:1-p,a.getUniforms().setValue(e,"morphTargetBaseInfluence",o),a.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function ma(e,t,n,r){var i=new b.default;return{update:function(e){var o=r.render.frame,a=e.geometry,s=t.get(e,a);return i.get(s)!==o&&(a.isGeometry&&s.updateFromObject(e),t.update(s),i.set(s,o)),e.isInstancedMesh&&n.update(e.instanceMatrix,34962),s},dispose:function(){i=new b.default}}}function va(e,t,n,r,i,o,a,s,u,l){e=void 0!==e?e:[],t=void 0!==t?t:ke,a=void 0!==a?a:ct,cr.call(this,e,t,n,r,i,o,a,s,u,l),this.flipY=!1}function ya(e,t,n,r){cr.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:r||1},this.magFilter=Ue,this.minFilter=Ue,this.wrapR=Ge,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function _a(e,t,n,r){cr.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:r||1},this.magFilter=Ue,this.minFilter=Ue,this.wrapR=Ge,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}t.ShaderLib=oa,oa.physical={uniforms:Bo([oa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ar(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Pi(0)},transparency:{value:0}}]),vertexShader:ia.meshphysical_vert,fragmentShader:ia.meshphysical_frag},va.prototype=(0,y.default)(cr.prototype),va.prototype.constructor=va,va.prototype.isCubeTexture=!0,(0,g.default)(va.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),ya.prototype=(0,y.default)(cr.prototype),ya.prototype.constructor=ya,ya.prototype.isDataTexture2DArray=!0,_a.prototype=(0,y.default)(cr.prototype),_a.prototype.constructor=_a,_a.prototype.isDataTexture3D=!0;var xa=new cr,Aa=new ya,Ia=new _a,wa=new va,ba=[],Ca=[],Ma=new Float32Array(16),Ea=new Float32Array(9),Ta=new Float32Array(4);function Sa(e,t,n){var r=e[0];if(r<=0||0<r)return e;var i=t*n,o=ba[i];if(void 0===o&&(o=new Float32Array(i),ba[i]=o),0!==t){r.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=n,e[a].toArray(o,s)}return o}function La(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function ka(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Ra(e,t){var n=Ca[t];void 0===n&&(n=new Int32Array(t),Ca[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Na(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Pa(e,t){var n=this.cache;void 0!==t.x?n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y):La(n,t)||(e.uniform2fv(this.addr,t),ka(n,t))}function Oa(e,t){var n=this.cache;void 0!==t.x?n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z):void 0!==t.r?n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b):La(n,t)||(e.uniform3fv(this.addr,t),ka(n,t))}function Da(e,t){var n=this.cache;void 0!==t.x?n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w):La(n,t)||(e.uniform4fv(this.addr,t),ka(n,t))}function Fa(e,t){var n=this.cache,r=t.elements;void 0===r?La(n,t)||(e.uniformMatrix2fv(this.addr,!1,t),ka(n,t)):La(n,r)||(Ta.set(r),e.uniformMatrix2fv(this.addr,!1,Ta),ka(n,r))}function Ba(e,t){var n=this.cache,r=t.elements;void 0===r?La(n,t)||(e.uniformMatrix3fv(this.addr,!1,t),ka(n,t)):La(n,r)||(Ea.set(r),e.uniformMatrix3fv(this.addr,!1,Ea),ka(n,r))}function Ga(e,t){var n=this.cache,r=t.elements;void 0===r?La(n,t)||(e.uniformMatrix4fv(this.addr,!1,t),ka(n,t)):La(n,r)||(Ma.set(r),e.uniformMatrix4fv(this.addr,!1,Ma),ka(n,r))}function za(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||xa,i)}function Ua(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Aa,i)}function Va(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Ia,i)}function Ha(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||wa,i)}function ja(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Wa(e,t){var n=this.cache;La(n,t)||(e.uniform2iv(this.addr,t),ka(n,t))}function Ya(e,t){var n=this.cache;La(n,t)||(e.uniform3iv(this.addr,t),ka(n,t))}function qa(e,t){var n=this.cache;La(n,t)||(e.uniform4iv(this.addr,t),ka(n,t))}function Xa(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Za(e,t){e.uniform1fv(this.addr,t)}function Ja(e,t){e.uniform1iv(this.addr,t)}function Ka(e,t){e.uniform2iv(this.addr,t)}function Qa(e,t){e.uniform3iv(this.addr,t)}function $a(e,t){e.uniform4iv(this.addr,t)}function es(e,t){t=Sa(t,this.size,2),e.uniform2fv(this.addr,t)}function ts(e,t){t=Sa(t,this.size,3),e.uniform3fv(this.addr,t)}function ns(e,t){t=Sa(t,this.size,4),e.uniform4fv(this.addr,t)}function rs(e,t){t=Sa(t,this.size,4),e.uniformMatrix2fv(this.addr,!1,t)}function is(e,t){t=Sa(t,this.size,9),e.uniformMatrix3fv(this.addr,!1,t)}function os(e,t){t=Sa(t,this.size,16),e.uniformMatrix4fv(this.addr,!1,t)}function as(e,t,n){var r=t.length,i=Ra(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(t[o]||xa,i[o])}function ss(e,t,n){var r=t.length,i=Ra(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(t[o]||wa,i[o])}function us(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Na;case 35664:return Pa;case 35665:return Oa;case 35666:return Da;case 35674:return Fa;case 35675:return Ba;case 35676:return Ga;case 5124:case 35670:return ja;case 35667:case 35671:return Wa;case 35668:case 35672:return Ya;case 35669:case 35673:return qa;case 5125:return Xa;case 35678:case 36198:case 36298:case 36306:case 35682:return za;case 35679:case 36299:case 36307:return Va;case 35680:case 36300:case 36308:case 36293:return Ha;case 36289:case 36303:case 36311:case 36292:return Ua}}(t.type)}function ls(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Za;case 35664:return es;case 35665:return ts;case 35666:return ns;case 35674:return rs;case 35675:return is;case 35676:return os;case 5124:case 35670:return Ja;case 35667:case 35671:return Ka;case 35668:case 35672:return Qa;case 35669:case 35673:return $a;case 35678:case 36198:case 36298:case 36306:case 35682:return as;case 35680:case 36300:case 36308:case 36293:return ss}}(t.type)}function cs(e){this.id=e,this.seq=[],this.map={}}ls.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),ka(t,e)},cs.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(e,t[a.id],n)}};var hs=/([\w\d_]+)(\])?(\[|\.)?/g;function fs(e,t){e.seq.push(t),e.map[t.id]=t}function ds(e,t,n){var r=e.name,i=r.length;for(hs.lastIndex=0;;){var o=hs.exec(r),a=hs.lastIndex,s=o[1];if("]"===o[2]&&(s|=0),void 0===(o=o[3])||"["===o&&a+2===i){fs(n,new(void 0===o?us:ls)(s,e,t));break}void 0===(o=(o=n.map)[s])&&fs(n,o=new cs(s)),n=o}}function ps(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);ds(i,e.getUniformLocation(t,i.name),this)}}function gs(e,t,n){return t=e.createShader(t),e.shaderSource(t,n),e.compileShader(t),t}ps.prototype.setValue=function(e,t,n,r){void 0!==(t=this.map[t])&&t.setValue(e,n,r)},ps.prototype.setOptional=function(e,t,n){void 0!==(t=t[n])&&this.setValue(e,n,t)},ps.upload=function(e,t,n,r){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}},ps.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var o=e[r];o.id in t&&n.push(o)}return n};var ms=0;function vs(e){switch(e){case yn:return["Linear","( value )"];case _n:return["sRGB","( value )"];case An:return["RGBE","( value )"];case wn:return["RGBM","( value, 7.0 )"];case bn:return["RGBM","( value, 16.0 )"];case Cn:return["RGBD","( value, 256.0 )"];case xn:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case In:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+e)}}function ys(e,t,n){var r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(t=e.getShaderSource(t))}function _s(e,t){return"vec4 "+e+"( vec4 value ) { return "+(t=vs(t))[0]+"ToLinear"+t[1]+"; }"}function xs(e,t){return"vec4 "+e+"( vec4 value ) { return LinearTo"+(t=vs(t))[0]+t[1]+"; }"}function As(e,t){var n;switch(t){case Ce:n="Linear";break;case Me:n="Reinhard";break;case Ee:n="Uncharted2";break;case Te:n="OptimizedCineon";break;case Se:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Is(e){return""!==e}function ws(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function bs(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Cs=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ms(e){return e.replace(Cs,Es)}function Es(e,t){var n=ia[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Ms(n)}var Ts=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ss=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function Ls(e){return e.replace(Ss,Rs).replace(Ts,ks)}function ks(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Rs(0,t,n,r)}function Rs(e,t,n,r){for(var i="",o=(0,I.default)(t);o<(0,I.default)(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function Ns(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ps(e,t,n){var r,i,o,a,s,u,l=e.getContext(),c=n.defines,h=n.vertexShader,f=n.fragmentShader,d=function(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===B?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===G?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===z&&(t="SHADOWMAP_TYPE_VSM"),t}(n),p=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case ke:case Re:t="ENVMAP_TYPE_CUBE";break;case De:case Fe:t="ENVMAP_TYPE_CUBE_UV";break;case Ne:case Pe:t="ENVMAP_TYPE_EQUIREC";break;case Oe:t="ENVMAP_TYPE_SPHERE"}return t}(n),g=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Re:case Pe:t="ENVMAP_MODE_REFRACTION"}return t}(n),m=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Ae:t="ENVMAP_BLENDING_MULTIPLY";break;case Ie:t="ENVMAP_BLENDING_MIX";break;case we:t="ENVMAP_BLENDING_ADD"}return t}(n),v=0<e.gammaFactor?e.gammaFactor:1,y=n.isWebGL2?"":function(e){return(e=[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""]).filter(Is).join("\n")}(n),_=(c=function(e){var t,n=[];for(t in e){var r=e[t];!1!==r&&n.push("#define "+t+" "+r)}return n.join("\n")}(c),l.createProgram());return n.isRawShaderMaterial?(0<(r=[c].filter(Is).join("\n")).length&&(r+="\n"),0<(i=[y,c].filter(Is).join("\n")).length&&(i+="\n")):(r=[Ns(n),"#define SHADER_NAME "+n.shaderName,c,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+v,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.mapMixColor?"#define USE_MAP_MIXCOLOR":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Is).join("\n"),i=[y,Ns(n),"#define SHADER_NAME "+n.shaderName,c,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.mapMixColor?"#define USE_MAP_MIXCOLOR":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.envMap?"#define "+g:"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==be?"#define TONE_MAPPING":"",n.toneMapping!==be?ia.tonemapping_pars_fragment:"",n.toneMapping!==be?As("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?ia.encodings_pars_fragment:"",n.mapEncoding?_s("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?_s("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?_s("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?_s("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?_s("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?xs("linearToOutputTexel",n.outputEncoding):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Is).join("\n")),h=bs(h=ws(h=Ms(h),n),n),f=bs(f=ws(f=Ms(f),n),n),h=Ls(h),f=Ls(f),n.isWebGL2&&!n.isRawShaderMaterial&&(a=!1,o=/^\s*#version\s+300\s+es\s*\n/,n.isShaderMaterial&&null!==h.match(o)&&null!==f.match(o)&&(a=!0,h=h.replace(o,""),f=f.replace(o,"")),r=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,i=["#version 300 es\n","#define varying in",a?"":"out highp vec4 pc_fragColor;",a?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i),g=i+f,m=gs(l,35633,p=r+h),d=gs(l,35632,g),l.attachShader(_,m),l.attachShader(_,d),void 0!==n.index0AttributeName?l.bindAttribLocation(_,0,n.index0AttributeName):!0===n.morphTargets&&l.bindAttribLocation(_,0,"position"),l.linkProgram(_),e.debug.checkShaderErrors&&(o=l.getProgramInfoLog(_).trim(),a=l.getShaderInfoLog(m).trim(),h=l.getShaderInfoLog(d).trim(),f=!0,p=!0,!1===l.getProgramParameter(_,35714)?(f=!1,g=ys(l,m,"vertex"),e=ys(l,d,"fragment"),console.error("THREE.WebGLProgram: shader error: ",l.getError(),"35715",l.getProgramParameter(_,35715),"gl.getProgramInfoLog",o,g,e)):""!==o?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",o):""!==a&&""!==h||(p=!1),p&&(this.diagnostics={runnable:f,programLog:o,vertexShader:{log:a,prefix:r},fragmentShader:{log:h,prefix:i}})),l.detachShader(_,m),l.detachShader(_,d),l.deleteShader(m),l.deleteShader(d),this.getUniforms=function(){return void 0===s&&(s=new ps(l,_)),s},this.getAttributes=function(){return void 0===u&&(u=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var o;n[o=(o=e.getActiveAttrib(t,i)).name]=e.getAttribLocation(t,o)}return n}(l,_)),u},this.destroy=function(){l.deleteProgram(_),this.program=void 0},this.name=n.shaderName,this.id=ms++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=m,this.fragmentShader=d,this}function Os(e,t,n){var r=[],i=n.isWebGL2,o=n.logarithmicDepthBuffer,a=n.floatVertexTextures,s=n.precision,u=n.maxVertexUniforms,l=n.vertexTextures,c={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},h=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapMixColor","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function f(e){var t=e.skeleton;return e=t.bones,a?1024:(t=u,t=Math.floor((t-20)/4),(t=Math.min(t,e.length))<e.length?0:t)}function d(e){var t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=yn,t}this.getParameters=function(r,u,h,p,g,m,v){var y=p.fog,_=r.isMeshStandardMaterial?p.environment:null,x=r.envMap||_,A=c[r.type],I=v.isSkinnedMesh?f(v):0;return null!==r.precision&&(s=n.getMaxPrecision(r.precision))!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",s,"instead."),p=function(e,t){return t?(t=oa[t],{name:e.type,uniforms:Go.clone(t.uniforms),vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}):{name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}}(r,A),r.onBeforeCompile(p,e),_=e.getRenderTarget(),{isWebGL2:i,shaderID:A,shaderName:p.name,uniforms:p.uniforms,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,defines:r.defines,isRawShaderMaterial:r.isRawShaderMaterial,isShaderMaterial:r.isShaderMaterial,precision:s,instancing:!0===v.isInstancedMesh,supportsVertexTextures:l,outputEncoding:null!==_?d(_.texture):e.outputEncoding,map:!!r.map,mapMixColor:!!r.mapMixColor,mapEncoding:d(r.map),matcap:!!r.matcap,matcapEncoding:d(r.matcap),envMap:!!x,envMapMode:x&&x.mapping,envMapEncoding:d(x),envMapCubeUV:!!x&&(x.mapping===De||x.mapping===Fe),lightMap:!!r.lightMap,lightMapEncoding:d(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:d(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:r.normalMapType===Sn,tangentSpaceNormalMap:r.normalMapType===Tn,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||!r.displacementMap),fog:!!y,useFog:r.fog,fogExp2:y&&y.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:o,skinning:r.skinning&&0<I,maxBones:I,useVertexTexture:a,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:u.directional.length,numPointLights:u.point.length,numSpotLights:u.spot.length,numRectAreaLights:u.rectArea.length,numHemiLights:u.hemi.length,numDirLightShadows:u.directionalShadowMap.length,numPointLightShadows:u.pointShadowMap.length,numSpotLightShadows:u.spotShadowMap.length,numClippingPlanes:g,numClipIntersection:m,dithering:r.dithering,shadowMapEnabled:e.shadowMap.enabled&&0<h.length,shadowMapType:e.shadowMap.type,toneMapping:r.toneMapped?e.toneMapping:be,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===H,flipSided:r.side===V,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:i||null!==t.get("EXT_frag_depth"),rendererExtensionDrawBuffers:i||null!==t.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:i||null!==t.get("EXT_shader_texture_lod"),onBeforeCompile:r.onBeforeCompile}},this.getProgramCacheKey=function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(void 0===t.isRawShaderMaterial){for(var i=0;i<h.length;i++)n.push(t[h[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(t,n){for(var i,o=0,a=r.length;o<a;o++){var s=r[o];if(s.cacheKey===n){++(i=s).usedTimes;break}}return void 0===i&&(i=new Ps(e,n,t),r.push(i)),i},this.releaseProgram=function(e){var t;0==--e.usedTimes&&(t=r.indexOf(e),r[t]=r[r.length-1],r.pop(),e.destroy())},this.programs=r}function Ds(){var e=new b.default;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new b.default}}}function Fs(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Bs(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Gs(){var e=[],t=0,n=[],r=[],i={id:-1};function o(n,r,o,a,s,u){var l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:o,program:o.program||i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:u},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=o,l.program=o.program||i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=s,l.group=u),t++,l}return{opaque:n,transparent:r,init:function(){t=0,n.length=0,r.length=0},push:function(e,t,i,a,s,u){u=o(e,t,i,a,s,u),(!0===i.transparent?r:n).push(u)},unshift:function(e,t,i,a,s,u){u=o(e,t,i,a,s,u),(!0===i.transparent?r:n).unshift(u)},finish:function(){for(var n=t,r=e.length;n<r;n++){var i=e[n];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(e,t){1<n.length&&n.sort(e||Fs),1<r.length&&r.sort(t||Bs)}}}function zs(){var e=new b.default;function t(n){(n=n.target).removeEventListener("dispose",t),e.delete(n)}return{get:function(n,r){var i,o=e.get(n);return void 0===o?(i=new Gs,e.set(n,new b.default),e.get(n).set(r,i),n.addEventListener("dispose",t)):void 0===(i=o.get(r))&&(i=new Gs,o.set(r,i)),i},dispose:function(){e=new b.default}}}function Us(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new vr,color:new Pi};break;case"SpotLight":n={position:new vr,direction:new vr,color:new Pi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new vr,color:new Pi,distance:0,decay:0};break;case"HemisphereLight":n={direction:new vr,skyColor:new Pi,groundColor:new Pi};break;case"RectAreaLight":n={color:new Pi,position:new vr,halfWidth:new vr,halfHeight:new vr}}return e[t.id]=n,n}}}var Vs=0;function Hs(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function js(){for(var e=new Us,t=function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new ar};break;case"PointLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new ar,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=0;r<9;r++)n.probe.push(new vr);var i=new vr,o=new Cr,a=new Cr;return{setup:function(r,s,u){for(var l=0,c=0,h=0,f=0;f<9;f++)n.probe[f].set(0,0,0);var d=0,p=0,g=0,m=0,v=0,y=0,_=0,x=0,A=u.matrixWorldInverse;r.sort(Hs),f=0;for(var I=r.length;f<I;f++){var w,b,C,M=r[f],E=M.color,T=M.intensity,S=M.distance,L=M.shadow&&M.shadow.map?M.shadow.map.texture:null;if(M.isAmbientLight)l+=E.r*T,c+=E.g*T,h+=E.b*T;else if(M.isLightProbe)for(var k=0;k<9;k++)n.probe[k].addScaledVector(M.sh.coefficients[k],T);else M.isDirectionalLight?((C=e.get(M)).color.copy(M.color).multiplyScalar(M.intensity),C.direction.setFromMatrixPosition(M.matrixWorld),i.setFromMatrixPosition(M.target.matrixWorld),C.direction.sub(i),C.direction.transformDirection(A),M.castShadow&&(w=M.shadow,(b=t.get(M)).shadowBias=w.bias,b.shadowRadius=w.radius,b.shadowMapSize=w.mapSize,n.directionalShadow[d]=b,n.directionalShadowMap[d]=L,n.directionalShadowMatrix[d]=M.shadow.matrix,y++),n.directional[d]=C,d++):M.isSpotLight?((C=e.get(M)).position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(A),C.color.copy(E).multiplyScalar(T),C.distance=S,C.direction.setFromMatrixPosition(M.matrixWorld),i.setFromMatrixPosition(M.target.matrixWorld),C.direction.sub(i),C.direction.transformDirection(A),C.coneCos=Math.cos(M.angle),C.penumbraCos=Math.cos(M.angle*(1-M.penumbra)),C.decay=M.decay,M.castShadow&&(w=M.shadow,(b=t.get(M)).shadowBias=w.bias,b.shadowRadius=w.radius,b.shadowMapSize=w.mapSize,n.spotShadow[g]=b,n.spotShadowMap[g]=L,n.spotShadowMatrix[g]=M.shadow.matrix,x++),n.spot[g]=C,g++):M.isRectAreaLight?((C=e.get(M)).color.copy(E).multiplyScalar(T),C.position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(A),a.identity(),o.copy(M.matrixWorld),o.premultiply(A),a.extractRotation(o),C.halfWidth.set(.5*M.width,0,0),C.halfHeight.set(0,.5*M.height,0),C.halfWidth.applyMatrix4(a),C.halfHeight.applyMatrix4(a),n.rectArea[m]=C,m++):M.isPointLight?((C=e.get(M)).position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(A),C.color.copy(M.color).multiplyScalar(M.intensity),C.distance=M.distance,C.decay=M.decay,M.castShadow&&(w=M.shadow,(b=t.get(M)).shadowBias=w.bias,b.shadowRadius=w.radius,b.shadowMapSize=w.mapSize,b.shadowCameraNear=w.camera.near,b.shadowCameraFar=w.camera.far,n.pointShadow[p]=b,n.pointShadowMap[p]=L,n.pointShadowMatrix[p]=M.shadow.matrix,_++),n.point[p]=C,p++):M.isHemisphereLight&&((C=e.get(M)).direction.setFromMatrixPosition(M.matrixWorld),C.direction.transformDirection(A),C.direction.normalize(),C.skyColor.copy(M.color).multiplyScalar(T),C.groundColor.copy(M.groundColor).multiplyScalar(T),n.hemi[v]=C,v++)}n.ambient[0]=l,n.ambient[1]=c,n.ambient[2]=h,(u=n.hash).directionalLength===d&&u.pointLength===p&&u.spotLength===g&&u.rectAreaLength===m&&u.hemiLength===v&&u.numDirectionalShadows===y&&u.numPointShadows===_&&u.numSpotShadows===x||(n.directional.length=d,n.spot.length=g,n.rectArea.length=m,n.point.length=p,n.hemi.length=v,n.directionalShadow.length=y,n.directionalShadowMap.length=y,n.pointShadow.length=_,n.pointShadowMap.length=_,n.spotShadow.length=x,n.spotShadowMap.length=x,n.directionalShadowMatrix.length=y,n.pointShadowMatrix.length=_,n.spotShadowMatrix.length=x,u.directionalLength=d,u.pointLength=p,u.spotLength=g,u.rectAreaLength=m,u.hemiLength=v,u.numDirectionalShadows=y,u.numPointShadows=_,u.numSpotShadows=x,n.version=Vs++)},state:n}}function Ws(){var e=new js,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(r){e.setup(t,n,r)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function Ys(){var e=new b.default;function t(n){(n=n.target).removeEventListener("dispose",t),e.delete(n)}return{get:function(n,r){var i;return!1===e.has(n)?(i=new Ws,e.set(n,new b.default),e.get(n).set(r,i),n.addEventListener("dispose",t)):!1===e.get(n).has(r)?(i=new Ws,e.get(n).set(r,i)):i=e.get(n).get(r),i},dispose:function(){e=new b.default}}}function qs(e){zi.call(this),this.type="MeshDepthMaterial",this.depthPacking=Mn,this.skinning=!1,this.morphTargets=!1,this.map=null,this.mapMixColor=!1,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function Xs(e){zi.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new vr,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}qs.prototype=(0,y.default)(zi.prototype),qs.prototype.constructor=qs,qs.prototype.isMeshDepthMaterial=!0,qs.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Xs.prototype=(0,y.default)(zi.prototype),Xs.prototype.constructor=Xs,Xs.prototype.isMeshDistanceMaterial=!0,Xs.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};var Zs="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",Js="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function Ks(e,t,n){var r=new Qo,i=new ar,o=new ar,a=new hr,s=[],u=[],l={},c={0:V,1:U,2:H},h=new Vo({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new ar},radius:{value:4}},vertexShader:Js,fragmentShader:Zs}),f=h.clone();f.defines.HORIZONAL_PASS=1;var d=new uo;d.setAttribute("position",new Hi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var p=new Eo(d,h),g=this;function m(n,r){var i=t.update(p);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,h,p,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,f,p,null)}function v(e,t,n){var r=e<<0|t<<1|n<<2;return void 0===(n=s[r])&&(n=new qs({depthPacking:En,morphTargets:e,skinning:t}),s[r]=n),n}function y(e,t,n){var r=e<<0|t<<1|n<<2;return void 0===(n=u[r])&&(n=new Xs({morphTargets:e,skinning:t}),u[r]=n),n}function x(t,n,r,i,o,a){var s,u,h,f=t.geometry,d=null,p=v,g=t.customDepthMaterial;return!0===r.isPointLight&&(p=y,g=t.customDistanceMaterial),d=void 0===g?(s=!1,!0===n.morphTargets&&(!0===f.isBufferGeometry?s=f.morphAttributes&&f.morphAttributes.position&&0<f.morphAttributes.position.length:!0===f.isGeometry&&(s=f.morphTargets&&0<f.morphTargets.length)),h=!1,!0===t.isSkinnedMesh&&(!0===n.skinning?h=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),p(s,h,u=!0===t.isInstancedMesh)):g,e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length&&(h=d.uuid,u=n.uuid,void 0===(g=l[h])&&(g={},l[h]=g),void 0===(h=g[u])&&(h=d.clone(),g[u]=h),d=h),d.visible=n.visible,d.wireframe=n.wireframe,d.side=a===z?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:c[n.side],d.clipShadows=n.clipShadows,d.clippingPlanes=n.clippingPlanes,d.clipIntersection=n.clipIntersection,d.wireframeLinewidth=n.wireframeLinewidth,d.linewidth=n.linewidth,!0===r.isPointLight&&!0===d.isMeshDistanceMaterial&&(d.referencePosition.setFromMatrixPosition(r.matrixWorld),d.nearDistance=i,d.farDistance=o),d}function A(n,i,o,a,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===z)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var u=t.update(n),l=n.material;if((0,_.default)(l))for(var c=u.groups,h=0,f=c.length;h<f;h++){var d,p=c[h],g=l[p.materialIndex];g&&g.visible&&(d=x(n,g,a,o.near,o.far,s),e.renderBufferDirect(o,null,u,d,n,p))}else l.visible&&(d=x(n,l,a,o.near,o.far,s),e.renderBufferDirect(o,null,u,d,n,null))}for(var m=n.children,v=0,y=m.length;v<y;v++)A(m[v],i,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=B,this.render=function(t,s,u){if(!1!==g.enabled&&(!1!==g.autoUpdate||!1!==g.needsUpdate)&&0!==t.length){var l=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),f=e.state;f.setBlending(W),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var d=0,p=t.length;d<p;d++){var v=t[d],y=v.shadow;if(void 0!==y){i.copy(y.mapSize);var _,x=y.getFrameExtents();i.multiply(x),o.copy(y.mapSize),(i.x>n||i.y>n)&&(console.warn("THREE.WebGLShadowMap:",v,"has shadow exceeding max texture size, reducing"),i.x>n&&(o.x=Math.floor(n/x.x),i.x=o.x*x.x,y.mapSize.x=o.x),i.y>n&&(o.y=Math.floor(n/x.y),i.y=o.y*x.y,y.mapSize.y=o.y)),null!==y.map||y.isPointLightShadow||this.type!==z||(_={minFilter:Ye,magFilter:Ye,format:ht},y.map=new fr(i.x,i.y,_),y.map.texture.name=v.name+".shadowMap",y.mapPass=new fr(i.x,i.y,_),y.camera.updateProjectionMatrix()),null===y.map&&(_={minFilter:Ue,magFilter:Ue,format:ht},y.map=new fr(i.x,i.y,_),y.map.texture.name=v.name+".shadowMap",y.camera.updateProjectionMatrix()),e.setRenderTarget(y.map),e.clear();for(var I=y.getViewportCount(),w=0;w<I;w++){var b=y.getViewport(w);a.set(o.x*b.x,o.y*b.y,o.x*b.z,o.y*b.w),f.viewport(a),y.updateMatrices(v,w),r=y.getFrustum(),A(s,u,y.camera,v,this.type)}y.isPointLightShadow||this.type!==z||m(y,u)}else console.warn("THREE.WebGLShadowMap:",v,"has no shadow.")}g.needsUpdate=!1,e.setRenderTarget(l,c,h)}}}function Qs(e,t,n){var r=n.isWebGL2,i=new function(){var t=!1,n=new hr,r=null,i=new hr(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,a,s){!0===s&&(t*=a,r*=a,o*=a),n.set(t,r,o,a),!1===i.equals(n)&&(e.clearColor(t,r,o,a),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){(e?U:j)(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case de:e.depthFunc(512);break;case pe:e.depthFunc(519);break;case ge:e.depthFunc(513);break;case me:e.depthFunc(515);break;case ve:e.depthFunc(514);break;case ye:e.depthFunc(518);break;case _e:e.depthFunc(516);break;case xe:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},a=new function(){var t=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,l=null;return{setTest:function(e){t||(e?U:j)(2960)},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,a){r===t&&i===n&&o===a||(e.stencilFunc(t,n,a),r=t,i=n,o=a)},setOp:function(t,n,r){a===t&&s===n&&u===r||(e.stencilOp(t,n,r),a=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,l=null}}},u=e.getParameter(34921),l=new Uint8Array(u),c=new Uint8Array(u),h=new Uint8Array(u),f={},d=null,p=null,g=null,m=null,v=null,y=null,_=null,x=null,I=null,w=!1,b=null,C=null,M=null,E=null,T=null,S=e.getParameter(35661),L=!1;n=0,-1!==(u=e.getParameter(7938)).indexOf("WebGL")?(n=(0,A.default)(/^WebGL\ ([0-9])/.exec(u)[1]),L=1<=n):-1!==u.indexOf("OpenGL ES")&&(n=(0,A.default)(/^OpenGL\ ES\ ([0-9])/.exec(u)[1]),L=2<=n);var P=null,O={},D=new hr,F=new hr;function B(t,n,r){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var a=0;a<r;a++)e.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var G={};function z(n,i){l[n]=1,0===c[n]&&(e.enableVertexAttribArray(n),c[n]=1),h[n]!==i&&((r?e:t.get("ANGLE_instanced_arrays"))[r?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),h[n]=i)}function U(t){!0!==f[t]&&(e.enable(t),f[t]=!0)}function j(t){!1!==f[t]&&(e.disable(t),f[t]=!1)}G[3553]=B(3553,3553,1),G[34067]=B(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),U(2929),o.setFunc(me),Ce(!1),Me(R),U(2884),be(W);var Ae,Ie=(n={},(0,s.default)(n,K,32774),(0,s.default)(n,Q,32778),(0,s.default)(n,$,32779),n);r?(Ie[ee]=32775,Ie[te]=32776):null!==(Ae=t.get("EXT_blend_minmax"))&&(Ie[ee]=Ae.MIN_EXT,Ie[te]=Ae.MAX_EXT);var we=(Ae={},(0,s.default)(Ae,ne,0),(0,s.default)(Ae,re,1),(0,s.default)(Ae,ie,768),(0,s.default)(Ae,ae,770),(0,s.default)(Ae,fe,776),(0,s.default)(Ae,ce,774),(0,s.default)(Ae,ue,772),(0,s.default)(Ae,oe,769),(0,s.default)(Ae,se,771),(0,s.default)(Ae,he,775),(0,s.default)(Ae,le,773),Ae);function be(t,n,r,i,o,a,s,u){if(t!==W){if(p||(U(3042),p=!0),t===J)o=o||n,a=a||r,s=s||i,n===m&&o===_||(e.blendEquationSeparate(Ie[n],Ie[o]),m=n,_=o),r===v&&i===y&&a===x&&s===I||(e.blendFuncSeparate(we[r],we[i],we[a],we[s]),v=r,y=i,x=a,I=s),g=t,w=null;else if(t!==g||u!==w){if(m===K&&_===K||(e.blendEquation(32774),m=K,_=K),u)switch(t){case Y:e.blendFuncSeparate(1,771,1,771);break;case q:e.blendFunc(1,1);break;case X:e.blendFuncSeparate(0,0,769,771);break;case Z:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case Y:e.blendFuncSeparate(770,771,1,771);break;case q:e.blendFunc(770,1);break;case X:e.blendFunc(0,769);break;case Z:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,y=null,x=null,I=null,g=t,w=u}}else p&&(j(3042),p=!1)}function Ce(t){b!==t&&(t?e.frontFace(2304):e.frontFace(2305),b=t)}function Me(t){t!==k?(U(2884),t!==C&&(t===R?e.cullFace(1029):t===N?e.cullFace(1028):e.cullFace(1032))):j(2884),C=t}function Ee(t,n,r){t?(U(32823),E===n&&T===r||(e.polygonOffset(n,r),E=n,T=r)):j(32823)}function Te(t){void 0===t&&(t=33984+S-1),P!==t&&(e.activeTexture(t),P=t)}return{buffers:{color:i,depth:o,stencil:a},initAttributes:function(){for(var e=0,t=l.length;e<t;e++)l[e]=0},enableAttribute:function(e){z(e,0)},enableAttributeAndDivisor:z,disableUnusedAttributes:function(){for(var t=0,n=c.length;t!==n;++t)c[t]!==l[t]&&(e.disableVertexAttribArray(t),c[t]=0)},enable:U,disable:j,useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:be,setMaterial:function(e,t){(e.side===H?j:U)(2884);var n=e.side===V;t&&(n=!n),Ce(n),e.blending===Y&&!1===e.transparent?be(W):be(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),o.setFunc(e.depthFunc),o.setTest(e.depthTest),o.setMask(e.depthWrite),i.setMask(e.colorWrite),n=e.stencilWrite,a.setTest(n),n&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Ee(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:Ce,setCullFace:Me,setLineWidth:function(t){t!==M&&(L&&e.lineWidth(t),M=t)},setPolygonOffset:Ee,setScissorTest:function(e){(e?U:j)(3089)},activeTexture:Te,bindTexture:function(t,n){null===P&&Te();var r=O[P];void 0===r&&(r={type:void 0,texture:void 0},O[P]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||G[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=O[P];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===D.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),D.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){for(var t=0;t<c.length;t++)1===c[t]&&(e.disableVertexAttribArray(t),c[t]=0);f={},P=null,O={},d=null,g=null,b=null,C=null,i.reset(),o.reset(),a.reset()}}}function $s(e,t,n,r,i,o,a){var u,l,c=i.isWebGL2,h=i.maxTextures,f=i.maxCubemapSize,d=i.maxTextureSize,p=i.maxSamples,g=new b.default,m=!1;try{m="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(u){}function v(e,t){return m?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function y(e,t,n,r){var i=1;return(e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),(i<1||!0===t)&&("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap)?(t=(r=t?or.floorPowerOfTwo:Math.floor)(i*e.width),r=r(i*e.height),void 0===l&&(l=v(t,r)),(i=n?v(t,r):l).width=t,i.height=r,(n=i.getContext("2d")).drawImage(e,0,0,t,r),i):e}function x(e){return or.isPowerOfTwo(e.width)&&or.isPowerOfTwo(e.height)}function A(e,t){return e.generateMipmaps&&t&&e.minFilter!==Ue&&e.minFilter!==Ye}function I(t,n,i,o){e.generateMipmap(t),(n=r.get(n)).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function w(n,r,i){return!1===c?r:null!==n&&void 0!==e[n]?e[n]:(n=r,6403===r&&(5126===i&&(n=33326),5131===i&&(n=33325),5121===i&&(n=33321)),6407===r&&(5126===i&&(n=34837),5131===i&&(n=34843),5121===i&&(n=32849)),6408===r&&(5126===i&&(n=34836),5131===i&&(n=34842),5121===i&&(n=32856)),33325!==n&&33326!==n&&34842!==n&&34836!==n||t.get("EXT_color_buffer_float"),n)}function C(e){return e===Ue||e===Ve||e===je?9728:9729}function M(t){(t=t.target).removeEventListener("dispose",M),function(t){var n=r.get(t);void 0!==n.__webglInit&&(e.deleteTexture(n.__webglTexture),r.remove(t))}(t),t.isVideoTexture&&g.delete(t),a.memory.textures--}function E(t){(t=t.target).removeEventListener("dispose",E),function(t){var n=r.get(t),i=r.get(t.texture);if(t){if(void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(var o=0;o<6;o++)e.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[o]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&e.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer);r.remove(t.texture),r.remove(t)}}(t),a.memory.textures--}var T=0;function S(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=a.render.frame;g.get(e)!==t&&(g.set(e,t),e.update())}(e),0<e.version&&i.__version!==e.version){var o=e.image;if(void 0!==o&&!1!==o.complete)return void D(i,e,t)}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function L(t,i){if(6===t.image.length){var a=r.get(t);if(0<t.version&&a.__version!==t.version){O(a,t),n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture),e.pixelStorei(37440,t.flipY);for(var s=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture),u=t.image[0]&&t.image[0].isDataTexture,l=[],h=0;h<6;h++)l[h]=s||u?u?t.image[h].image:t.image[h]:y(t.image[h],!1,!0,f);var d=l[0],p=x(d)||c,g=o.convert(t.format),m=o.convert(t.type),v=w(t.internalFormat,g,m);if(P(34067,t,p),s){for(h=0;h<6;h++)for(var _=l[h].mipmaps,b=0;b<_.length;b++){var C=_[b];t.format!==ht&&t.format!==ct?null!==g&&n.compressedTexImage2D(34069+h,b,v,C.width,C.height,0,C.data):n.texImage2D(34069+h,b,v,C.width,C.height,0,g,m,C.data)}a.__maxMipLevel=_.length-1}else{for(_=t.mipmaps,h=0;h<6;h++)if(u)for(n.texImage2D(34069+h,0,v,l[h].width,l[h].height,0,g,m,l[h].data),b=0;b<_.length;b++){var M=(C=_[b]).image[h].image;n.texImage2D(34069+h,b+1,v,M.width,M.height,0,g,m,M.data)}else for(n.texImage2D(34069+h,0,v,g,m,l[h]),b=0;b<_.length;b++)C=_[b],n.texImage2D(34069+h,b+1,v,g,m,C.image[h]);a.__maxMipLevel=_.length}A(t,p)&&I(34067,t,d.width,d.height),a.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture)}}function k(e,t){n.activeTexture(33984+t),n.bindTexture(34067,r.get(e).__webglTexture)}var R=(u={},(0,s.default)(u,Be,10497),(0,s.default)(u,Ge,33071),(0,s.default)(u,ze,33648),u),N=(u={},(0,s.default)(u,Ue,9728),(0,s.default)(u,Ve,9984),(0,s.default)(u,je,9986),(0,s.default)(u,Ye,9729),(0,s.default)(u,qe,9985),(0,s.default)(u,Ze,9987),u);function P(n,o,a){a?(e.texParameteri(n,10242,R[o.wrapS]),e.texParameteri(n,10243,R[o.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,R[o.wrapR]),e.texParameteri(n,10240,N[o.magFilter]),e.texParameteri(n,10241,N[o.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),o.wrapS!==Ge||o.wrapT,e.texParameteri(n,10240,C(o.magFilter)),e.texParameteri(n,10241,C(o.minFilter)),o.minFilter!==Ue&&o.minFilter),(a=t.get("EXT_texture_filter_anisotropic"))&&(o.type===rt&&null===t.get("OES_texture_float_linear")||o.type===it&&null===(c||t.get("OES_texture_half_float_linear"))||(1<o.anisotropy||r.get(o).__currentAnisotropy)&&(e.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy))}function O(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",M),t.__webglTexture=e.createTexture(),a.memory.textures++)}function D(t,r,i){var a=3553;r.isDataTexture2DArray&&(a=35866),r.isDataTexture3D&&(a=32879),O(t,r),n.activeTexture(33984+i),n.bindTexture(a,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment);var s=function(e){return!c&&(e.wrapS!==Ge||e.wrapT!==Ge||e.minFilter!==Ue&&e.minFilter!==Ye)}(r)&&!1===x(r.image),u=(s=x(i=y(r.image,s,!1,d))||c,o.convert(r.format)),l=o.convert(r.type),h=w(r.internalFormat,u,l);P(a,r,s);var f,p=r.mipmaps;if(r.isDepthTexture)h=6402,c?h=r.type===rt?36012:r.type===nt?33190:r.type===ut?35056:33189:r.type===rt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===gt&&6402===h&&r.type!==et&&r.type!==nt&&(r.type=et,l=o.convert(r.type)),r.format===mt&&6402===h&&(h=34041,r.type!==ut&&(r.type=ut,l=o.convert(r.type))),n.texImage2D(3553,0,h,i.width,i.height,0,u,l,null);else if(r.isDataTexture)if(0<p.length&&s){for(var g=0,m=p.length;g<m;g++)f=p[g],n.texImage2D(3553,g,h,f.width,f.height,0,u,l,f.data);r.generateMipmaps=!1,t.__maxMipLevel=p.length-1}else n.texImage2D(3553,0,h,i.width,i.height,0,u,l,i.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(g=0,m=p.length;g<m;g++)f=p[g],r.format!==ht&&r.format!==ct?null!==u&&n.compressedTexImage2D(3553,g,h,f.width,f.height,0,f.data):n.texImage2D(3553,g,h,f.width,f.height,0,u,l,f.data);t.__maxMipLevel=p.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,h,i.width,i.height,i.depth,0,u,l,i.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,h,i.width,i.height,i.depth,0,u,l,i.data),t.__maxMipLevel=0;else if(0<p.length&&s){for(g=0,m=p.length;g<m;g++)f=p[g],n.texImage2D(3553,g,h,u,l,f);r.generateMipmaps=!1,t.__maxMipLevel=p.length-1}else n.texImage2D(3553,0,h,u,l,i),t.__maxMipLevel=0;A(r,s)&&I(a,r,i.width,i.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function F(t,i,a,s){var u=o.convert(i.texture.format),l=o.convert(i.texture.type),c=w(i.texture.internalFormat,u,l);n.texImage2D(s,0,c,i.width,i.height,0,u,l,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,a,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function B(t,n,r){var i,a,s;e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer?(a=33189,r?((i=n.depthTexture)&&i.isDepthTexture&&(i.type===rt?a=36012:i.type===nt&&(a=33190)),s=G(n),e.renderbufferStorageMultisample(36161,s,a,n.width,n.height)):e.renderbufferStorage(36161,a,n.width,n.height),e.framebufferRenderbuffer(36160,36096,36161,t)):n.depthBuffer&&n.stencilBuffer?(r?(s=G(n),e.renderbufferStorageMultisample(36161,s,35056,n.width,n.height)):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)):(i=o.convert(n.texture.format),t=o.convert(n.texture.type),a=w(n.texture.internalFormat,i,t),r?(s=G(n),e.renderbufferStorageMultisample(36161,s,a,n.width,n.height)):e.renderbufferStorage(36161,a,n.width,n.height)),e.bindRenderbuffer(36161,null)}function G(e){return c&&e.isWebGLMultisampleRenderTarget?Math.min(p,e.samples):0}var z=!1,U=!1;this.allocateTextureUnit=function(){var e=T;return h<=e&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+h),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=S,this.setTexture2DArray=function(e,t){var i=r.get(e);0<e.version&&i.__version!==e.version?D(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);0<e.version&&i.__version!==e.version?D(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=L,this.setTextureCubeDynamic=k,this.setupRenderTarget=function(t){var i=r.get(t),s=r.get(t.texture);t.addEventListener("dispose",E),s.__webglTexture=e.createTexture(),a.memory.textures++;var u,l=!0===t.isWebGLCubeRenderTarget,h=!0===t.isWebGLMultisampleRenderTarget,f=x(t)||c;if(!c||t.texture.format!==ct||t.texture.type!==rt&&t.texture.type!==it||(t.texture.format=ht),l){i.__webglFramebuffer=[];for(var d=0;d<6;d++)i.__webglFramebuffer[d]=e.createFramebuffer()}else i.__webglFramebuffer=e.createFramebuffer(),h&&c&&(i.__webglMultisampledFramebuffer=e.createFramebuffer(),i.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,i.__webglColorRenderbuffer),u=o.convert(t.texture.format),h=o.convert(t.texture.type),u=w(t.texture.internalFormat,u,h),h=G(t),e.renderbufferStorageMultisample(36161,h,u,t.width,t.height),e.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(i.__webglDepthRenderbuffer=e.createRenderbuffer(),B(i.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null));if(l){for(n.bindTexture(34067,s.__webglTexture),P(34067,t.texture,f),d=0;d<6;d++)F(i.__webglFramebuffer[d],t,36064,34069+d);A(t.texture,f)&&I(34067,t.texture,t.width,t.height),n.bindTexture(34067,null)}else n.bindTexture(3553,s.__webglTexture),P(3553,t.texture,f),F(i.__webglFramebuffer,t,36064,3553),A(t.texture,f)&&I(3553,t.texture,t.width,t.height),n.bindTexture(3553,null);t.depthBuffer&&function(t){var n=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),S(n.depthTexture,0),t=r.get(n.depthTexture).__webglTexture,n.depthTexture.format===gt)e.framebufferTexture2D(36160,36096,3553,t,0);else{if(n.depthTexture.format!==mt)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,t,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(36160,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=e.createRenderbuffer(),B(n.__webglDepthbuffer[o],t,!1)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),B(n.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}(t)},this.updateRenderTargetMipmap=function(e){var t,i=e.texture,o=x(e)||c;A(i,o)&&(t=e.isWebGLCubeRenderTarget?34067:3553,o=r.get(i).__webglTexture,n.bindTexture(t,o),I(t,i,e.width,e.height),n.bindTexture(t,null))},this.updateMultisampleRenderTarget=function(t){var n,i,o,a;t.isWebGLMultisampleRenderTarget&&c&&(n=r.get(t),e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer),i=t.width,o=t.height,a=16384,t.depthBuffer&&(a|=256),t.stencilBuffer&&(a|=1024),e.blitFramebuffer(0,0,i,o,0,0,i,o,a,9728),e.bindFramebuffer(36160,n.__webglMultisampledFramebuffer))},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),z=!0),e=e.texture),S(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===U&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),U=!0),e=e.texture),(e&&e.isCubeTexture||(0,_.default)(e.image)&&6===e.image.length?L:k)(e,t)}}function eu(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===Ke)return 5121;if(e===ot)return 32819;if(e===at)return 32820;if(e===st)return 33635;if(e===Qe)return 5120;if(e===$e)return 5122;if(e===et)return 5123;if(e===tt)return 5124;if(e===nt)return 5125;if(e===rt)return 5126;if(e===it)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(e===lt)return 6406;if(e===ct)return 6407;if(e===ht)return 6408;if(e===ft)return 6409;if(e===dt)return 6410;if(e===gt)return 6402;if(e===mt)return 34041;if(e===vt)return 6403;if(e===yt)return 36244;if(e===_t)return 33319;if(e===xt)return 33320;if(e===At)return 36248;if(e===It)return 36249;if(e===wt||e===bt||e===Ct||e===Mt){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===wt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===bt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Ct)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Mt)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===Et||e===Tt||e===St||e===Lt){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===Et)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Tt)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===St)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Lt)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===kt)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===Rt||e===Nt)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(e===Rt)return n.COMPRESSED_RGB8_ETC2;if(e===Nt)return n.COMPRESSED_RGBA8_ETC2_EAC}return e===Pt||e===Ot||e===Dt||e===Ft||e===Bt||e===Gt||e===zt||e===Ut||e===Vt||e===Ht||e===jt||e===Wt||e===Yt||e===qt||e===Zt||e===Jt||e===Kt||e===Qt||e===$t||e===en||e===tn||e===nn||e===rn||e===on||e===an||e===sn||e===un||e===ln?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:e===Xt?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===ut?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function tu(e){jo.call(this),this.cameras=e||[]}function nu(){Hr.call(this),this.type="Group"}function ru(e,t){var n=this,r=null,i=1,o=null,a="local-floor",s=null,u=[],l=new C.default,c=new jo;c.layers.enable(1),c.viewport=new hr;var h=new jo;h.layers.enable(2),h.viewport=new hr;var f=new tu([c,h]);f.layers.enable(1),f.layers.enable(2);var d=null,p=null;function g(e){var t=l.get(e.inputSource);t&&(t.targetRay&&t.targetRay.dispatchEvent({type:e.type}),t.grip&&t.grip.dispatchEvent({type:e.type}))}function m(){l.forEach((function(e,t){e.targetRay&&(e.targetRay.dispatchEvent({type:"disconnected",data:t}),e.targetRay.visible=!1),e.grip&&(e.grip.dispatchEvent({type:"disconnected",data:t}),e.grip.visible=!1)})),l.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),w.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function v(e){o=e,w.setContext(r),w.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function y(e){for(var t=r.inputSources,n=0;n<u.length;n++)l.set(t[n],u[n]);for(n=0;n<e.removed.length;n++){var i=e.removed[n],o=l.get(i);o&&(o.targetRay&&o.targetRay.dispatchEvent({type:"disconnected",data:i}),o.grip&&o.grip.dispatchEvent({type:"disconnected",data:i}),l.delete(i))}for(n=0;n<e.added.length;n++)i=e.added[n],(o=l.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"connected",data:i}),o.grip&&o.grip.dispatchEvent({type:"connected",data:i}))}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=u[e];return void 0===t&&(t={},u[e]=t),void 0===t.targetRay&&(t.targetRay=new nu,t.targetRay.matrixAutoUpdate=!1,t.targetRay.visible=!1),t.targetRay},this.getControllerGrip=function(e){var t=u[e];return void 0===t&&(t={},u[e]=t),void 0===t.grip&&(t.grip=new nu,t.grip.matrixAutoUpdate=!1,t.grip.visible=!1),t.grip},this.setFramebufferScaleFactor=function(e){i=e,1==n.isPresenting&&console.warn("WebXRManager: Cannot change framebuffer scale while presenting VR content")},this.setReferenceSpaceType=function(e){a=e},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=function(e){null!==(r=e)&&(r.addEventListener("select",g),r.addEventListener("selectstart",g),r.addEventListener("selectend",g),r.addEventListener("squeeze",g),r.addEventListener("squeezestart",g),r.addEventListener("squeezeend",g),r.addEventListener("end",m),e={antialias:(e=t.getContextAttributes()).antialias,alpha:e.alpha,depth:e.depth,stencil:e.stencil,framebufferScaleFactor:i},e=new XRWebGLLayer(r,t,e),r.updateRenderState({baseLayer:e}),r.requestReferenceSpace(a).then(v),r.addEventListener("inputsourceschange",y))};var _=new vr,x=new vr;function A(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){f.near=h.near=c.near=e.near,f.far=h.far=c.far=e.far,d===f.near&&p===f.far||(r.updateRenderState({depthNear:f.near,depthFar:f.far}),d=f.near,p=f.far);var t=e.parent,n=f.cameras;A(f,t);for(var i=0;i<n.length;i++)A(n[i],t);e.matrixWorld.copy(f.matrixWorld);for(var o=e.children,a=(i=0,o.length);i<a;i++)o[i].updateMatrixWorld(!0);return function(e,t,n){_.setFromMatrixPosition(t.matrixWorld),x.setFromMatrixPosition(n.matrixWorld);var r=_.distanceTo(x),i=t.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],c=(i=a*(c=(i[8]-1)/i[0]),o=a*(n=(o[8]+1)/o[0]),(n=r/(-c+n))*-c);t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(c),e.translateZ(n),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld),a+=n,i-=c,c=o+(r-c),u=u*s/(n=s+n)*a,s=l*s/n*a,e.projectionMatrix.makePerspective(i,c,u,s,a,n)}(f,c,h),f};var I=null,w=new ea;w.setAnimationLoop((function(t,n){if(null!==(s=n.getViewerPose(o))){var i=s.views,a=r.renderState.baseLayer;e.setFramebuffer(a.framebuffer);for(var l=0;l<i.length;l++){var c=i[l],h=a.getViewport(c),d=f.cameras[l];d.matrix.fromArray(c.transform.matrix),d.projectionMatrix.fromArray(c.projectionMatrix),d.viewport.set(h.x,h.y,h.width,h.height),0===l&&f.matrix.copy(d.matrix)}}var p=r.inputSources;for(l=0;l<u.length;l++){var g=u[l],m=p[l],v=null,y=null;m&&(g.targetRay&&null!==(v=n.getPose(m.targetRaySpace,o))&&(g.targetRay.matrix.fromArray(v.transform.matrix),g.targetRay.matrix.decompose(g.targetRay.position,g.targetRay.rotation,g.targetRay.scale)),g.grip&&m.gripSpace&&null!==(y=n.getPose(m.gripSpace,o))&&(g.grip.matrix.fromArray(y.transform.matrix),g.grip.matrix.decompose(g.grip.position,g.grip.rotation,g.grip.scale))),g.targetRay&&(g.targetRay.visible=null!==v),g.grip&&(g.grip.visible=null!==y)}I&&I(t,n)})),this.setAnimationLoop=function(e){I=e},this.dispose=function(){}}function iu(e){var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,h=null,f=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=yn,this.physicallyCorrectLights=!1,this.toneMapping=Ce,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var d,p,g,v,y,x,A,I,w,b,C,M,E,T,S,L,k,R,N=this,P=!1,O=null,D=0,F=0,B=null,G=null,z=-1,U={geometry:null,program:null,wireframe:!1},H=null,j=null,W=new hr,Y=new hr,q=null,X=t.width,Z=t.height,J=1,K=null,Q=null,$=new hr(0,0,X,Z),ee=new hr(0,0,X,Z),te=!1,ne=new Qo,re=new la,ie=!1,oe=!1,ae=new Cr,se=new vr;function ue(){return null===B?J:1}try{var le={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:c,xrCompatible:!0};if(t.addEventListener("webglcontextlost",de,!1),t.addEventListener("webglcontextrestored",pe,!1),null===(d=n||t.getContext("webgl",le)||t.getContext("experimental-webgl",le)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===d.getShaderPrecisionFormat&&(d.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function ce(){p=new ca(d),!1===(g=new ua(d,p,e)).isWebGL2&&(p.get("WEBGL_depth_texture"),p.get("OES_texture_float"),p.get("OES_texture_half_float"),p.get("OES_texture_half_float_linear"),p.get("OES_standard_derivatives"),p.get("OES_element_index_uint"),p.get("ANGLE_instanced_arrays")),p.get("OES_texture_float_linear"),R=new eu(d,p,g),(v=new Qs(d,p,g)).scissor(Y.copy(ee).multiplyScalar(J).floor()),v.viewport(W.copy($).multiplyScalar(J).floor()),y=new da(d),x=new Ds,A=new $s(d,p,v,x,g,R,y),I=new ta(d,g),w=new ha(d,I,y),b=new ma(d,w,I,y),S=new ga(d),C=new Os(N,p,g),M=new zs,E=new Ys,T=new aa(N,v,b,s),L=new sa(d,p,y,g),k=new fa(d,p,y,g),y.programs=C.programs,N.capabilities=g,N.extensions=p,N.properties=x,N.renderLists=M,N.state=v,N.info=y}ce();var he=new ru(N,d);this.xr=he;var fe=new Ks(N,b,g.maxTextureSize);function de(e){e.preventDefault(),P=!0}function pe(){P=!1,ce()}function ge(e){(e=e.target).removeEventListener("dispose",ge),function(e){me(e),x.remove(e)}(e)}function me(e){var t=x.get(e).program;e.program=void 0,void 0!==t&&C.releaseProgram(t)}this.shadowMap=fe,this.getContext=function(){return d},this.getContextAttributes=function(){return d.getContextAttributes()},this.forceContextLoss=function(){var e=p.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=p.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return J},this.setPixelRatio=function(e){void 0!==e&&(J=e,this.setSize(X,Z,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new ar),e.set(X,Z)},this.setSize=function(e,n,r){he.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(X=e,Z=n,t.width=Math.floor(e*J),t.height=Math.floor(n*J),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new ar),e.set(X*J,Z*J).floor()},this.setDrawingBufferSize=function(e,n,r){X=e,Z=n,J=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new hr),e.copy(W)},this.getViewport=function(e){return e.copy($)},this.setViewport=function(e,t,n,r){e.isVector4?$.set(e.x,e.y,e.z,e.w):$.set(e,t,n,r),v.viewport(W.copy($).multiplyScalar(J).floor())},this.getScissor=function(e){return e.copy(ee)},this.setScissor=function(e,t,n,r){e.isVector4?ee.set(e.x,e.y,e.z,e.w):ee.set(e,t,n,r),v.scissor(Y.copy(ee).multiplyScalar(J).floor())},this.getScissorTest=function(){return te},this.setScissorTest=function(e){v.setScissorTest(te=e)},this.setOpaqueSort=function(e){K=e},this.setTransparentSort=function(e){Q=e},this.getClearColor=function(){return T.getClearColor()},this.setClearColor=function(){T.setClearColor.apply(T,arguments)},this.getClearAlpha=function(){return T.getClearAlpha()},this.setClearAlpha=function(){T.setClearAlpha.apply(T,arguments)},this.clear=function(e,t,n){var r=0;void 0!==e&&!e||(r|=16384),void 0!==t&&!t||(r|=256),void 0!==n&&!n||(r|=1024),d.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",de,!1),t.removeEventListener("webglcontextrestored",pe,!1),M.dispose(),E.dispose(),x.dispose(),b.dispose(),he.dispose(),_e.stop(),this.forceContextLoss()},this.renderBufferImmediate=function(e,t){v.initAttributes();var n=x.get(e);e.hasPositions&&!n.position&&(n.position=d.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=d.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=d.createBuffer()),e.hasColors&&!n.color&&(n.color=d.createBuffer()),t=t.getAttributes(),e.hasPositions&&(d.bindBuffer(34962,n.position),d.bufferData(34962,e.positionArray,35048),v.enableAttribute(t.position),d.vertexAttribPointer(t.position,3,5126,!1,0,0)),e.hasNormals&&(d.bindBuffer(34962,n.normal),d.bufferData(34962,e.normalArray,35048),v.enableAttribute(t.normal),d.vertexAttribPointer(t.normal,3,5126,!1,0,0)),e.hasUvs&&(d.bindBuffer(34962,n.uv),d.bufferData(34962,e.uvArray,35048),v.enableAttribute(t.uv),d.vertexAttribPointer(t.uv,2,5126,!1,0,0)),e.hasColors&&(d.bindBuffer(34962,n.color),d.bufferData(34962,e.colorArray,35048),v.enableAttribute(t.color),d.vertexAttribPointer(t.color,3,5126,!1,0,0)),v.disableUnusedAttributes(),d.drawArrays(4,0,e.count),e.count=0};var ve=new jr;this.renderBufferDirect=function(e,t,n,r,i,o){null===t&&(t=ve);var a=i.isMesh&&i.matrixWorld.determinant()<0,s=be(e,t,r,i);v.setMaterial(r,a);var u=!1;U.geometry===n.id&&U.program===s.id&&U.wireframe===(!0===r.wireframe)||(U.geometry=n.id,U.program=s.id,U.wireframe=!0===r.wireframe,u=!0),(r.morphTargets||r.morphNormals)&&(S.update(i,n,r,s),u=!0);var l=n.index;if(e=n.attributes.position,null===l){if(void 0===e||0===e.count)return}else if(0===l.count)return;t=1,!0===r.wireframe&&(l=w.getWireframeAttribute(n),t=2),a=L,null!==l&&(c=I.get(l),(a=k).setIndex(c)),u&&(function(e,t,n,r){if(!1!==g.isWebGL2||!e.isInstancedMesh&&!t.isInstancedBufferGeometry||null!==p.get("ANGLE_instanced_arrays")){v.initAttributes();var i,o=t.attributes,a=r.getAttributes(),s=n.defaultAttributeValues;for(i in a){var u=a[i];if(0<=u){var l=o[i];if(void 0!==l){var c,h,f,m,y=l.normalized,_=l.itemSize;void 0!==(w=I.get(l))&&(x=w.buffer,A=w.type,c=w.bytesPerElement,l.isInterleavedBufferAttribute?(f=(h=l.data).stride,m=l.offset,h&&h.isInstancedInterleavedBuffer?(v.enableAttributeAndDivisor(u,h.meshPerAttribute),void 0===t.maxInstancedCount&&(t.maxInstancedCount=h.meshPerAttribute*h.count)):v.enableAttribute(u),d.bindBuffer(34962,x),d.vertexAttribPointer(u,_,A,y,f*c,m*c)):(l.isInstancedBufferAttribute?(v.enableAttributeAndDivisor(u,l.meshPerAttribute),void 0===t.maxInstancedCount&&(t.maxInstancedCount=l.meshPerAttribute*l.count)):v.enableAttribute(u),d.bindBuffer(34962,x),d.vertexAttribPointer(u,_,A,y,0,0)))}else if("instanceMatrix"===i){var x,A,w;void 0!==(w=I.get(e.instanceMatrix))&&(x=w.buffer,A=w.type,v.enableAttributeAndDivisor(u+0,1),v.enableAttributeAndDivisor(u+1,1),v.enableAttributeAndDivisor(u+2,1),v.enableAttributeAndDivisor(u+3,1),d.bindBuffer(34962,x),d.vertexAttribPointer(u+0,4,A,!1,64,0),d.vertexAttribPointer(u+1,4,A,!1,64,16),d.vertexAttribPointer(u+2,4,A,!1,64,32),d.vertexAttribPointer(u+3,4,A,!1,64,48))}else if(void 0!==s){var b=s[i];if(void 0!==b)switch(b.length){case 2:d.vertexAttrib2fv(u,b);break;case 3:d.vertexAttrib3fv(u,b);break;case 4:d.vertexAttrib4fv(u,b);break;default:d.vertexAttrib1fv(u,b)}}}}v.disableUnusedAttributes()}}(i,n,r,s),null!==l&&d.bindBuffer(34963,c.buffer)),s=(null!==l?l:e).count;var c=n.drawRange.start*t;l=n.drawRange.count*t,e=null!==o?o.start*t:0,o=null!==o?o.count*t:1/0,t=Math.max(c,e),o=Math.min(s,c+l,e+o)-1,0!==(o=Math.max(0,o-t+1))&&(i.isMesh?!0===r.wireframe?(v.setLineWidth(r.wireframeLinewidth*ue()),a.setMode(1)):a.setMode(4):i.isLine?(void 0===(r=r.linewidth)&&(r=1),v.setLineWidth(r*ue()),i.isLineSegments?a.setMode(1):i.isLineLoop?a.setMode(2):a.setMode(3)):i.isPoints?a.setMode(0):i.isSprite&&a.setMode(4),i.isInstancedMesh?a.renderInstances(n,t,o,i.count):n.isInstancedBufferGeometry?a.renderInstances(n,t,o,n.maxInstancedCount):a.render(t,o))},this.compile=function(e,t){(f=E.get(e,t)).init(),e.traverse((function(e){e.isLight&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),f.setupLights(t);var n={};e.traverse((function(t){if(t.material)if((0,_.default)(t.material))for(var r=0;r<t.material.length;r++)t.material[r].uuid in n==0&&(we(t.material[r],e,t),n[t.material[r].uuid]=!0);else t.material.uuid in n==0&&(we(t.material,e,t),n[t.material.uuid]=!0)}))};var ye=null,_e=new ea;function xe(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite)e.frustumCulled&&!ne.intersectsSprite(e)||(r&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ae),i=b.update(e),(o=e.material).visible&&h.push(e,i,o,n,se.z,null));else if(e.isImmediateRenderObject)r&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ae),h.push(e,null,e.material,n,se.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==y.render.frame&&(e.skeleton.update(),e.skeleton.frame=y.render.frame),!e.frustumCulled||ne.intersectsObject(e))){r&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ae);var i=b.update(e),o=e.material;if((0,_.default)(o))for(var a=i.groups,s=0,u=a.length;s<u;s++){var l=a[s],c=o[l.materialIndex];c&&c.visible&&h.push(e,i,c,n,se.z,l)}else o.visible&&h.push(e,i,o,n,se.z,null)}var d=e.children;for(s=0,u=d.length;s<u;s++)xe(d[s],t,n,r)}}function Ae(e,t,n,r){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,u=a.geometry,l=void 0===r?a.material:r,c=a.group;if(n.isArrayCamera){j=n;for(var h=n.cameras,d=0,p=h.length;d<p;d++){var g=h[d];s.layers.test(g.layers)&&(v.viewport(W.copy(g.viewport)),f.setupLights(g),Ie(s,t,g,u,l,c))}}else j=null,Ie(s,t,n,u,l,c)}}function Ie(e,t,n,r,i,o){var a;e.onBeforeRender(N,t,n,r,i,o),f=E.get(t,j||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject?(a=be(n,t,i,e),v.setMaterial(i),U.geometry=null,U.program=null,U.wireframe=!1,function(e,t){e.render((function(e){N.renderBufferImmediate(e,t)}))}(e,a)):N.renderBufferDirect(n,t,r,i,e,o),e.onAfterRender(N,t,n,r,i,o),f=E.get(t,j||n)}function we(e,t,n){var r=x.get(e),i=f.state.lights,o=f.state.shadowsArray,a=i.state.version,s=C.getParameters(e,i.state,o,t,re.numPlanes,re.numIntersection,n),u=C.getProgramCacheKey(s);if(n=!0,void 0===(o=r.program))e.addEventListener("dispose",ge);else if(o.cacheKey!==u)me(e);else if(r.lightsStateVersion!==a)r.lightsStateVersion=a,n=!1;else{if(void 0!==s.shaderID)return;n=!1}n&&(o=C.acquireProgram(s,u),r.program=o,r.uniforms=s.uniforms,r.environment=e.isMeshStandardMaterial?t.environment:null,r.outputEncoding=N.outputEncoding,e.program=o);var l=o.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var c=0;c<N.maxMorphTargets;c++)0<=l["morphTarget"+c]&&e.numSupportedMorphTargets++}if(e.morphNormals)for(e.numSupportedMorphNormals=0,c=0;c<N.maxMorphNormals;c++)0<=l["morphNormal"+c]&&e.numSupportedMorphNormals++;o=r.uniforms,(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=re.numPlanes,r.numIntersection=re.numIntersection,o.clippingPlanes=re.uniform),r.fog=t.fog,r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=a,r.needsLights&&(o.ambientLightColor.value=i.state.ambient,o.lightProbe.value=i.state.probe,o.directionalLights.value=i.state.directional,o.directionalLightShadows.value=i.state.directionalShadow,o.spotLights.value=i.state.spot,o.spotLightShadows.value=i.state.spotShadow,o.rectAreaLights.value=i.state.rectArea,o.pointLights.value=i.state.point,o.pointLightShadows.value=i.state.pointShadow,o.hemisphereLights.value=i.state.hemi,o.directionalShadowMap.value=i.state.directionalShadowMap,o.directionalShadowMatrix.value=i.state.directionalShadowMatrix,o.spotShadowMap.value=i.state.spotShadowMap,o.spotShadowMatrix.value=i.state.spotShadowMatrix,o.pointShadowMap.value=i.state.pointShadowMap,o.pointShadowMatrix.value=i.state.pointShadowMatrix),i=r.program.getUniforms(),o=ps.seqWithValue(i.seq,o),r.uniformsList=o}function be(e,t,n,r){A.resetTextureUnits();var i=t.fog,o=n.isMeshStandardMaterial?t.environment:null,a=x.get(n),s=f.state.lights;ie&&(!oe&&e===H||(m=e===H&&n.id===z,re.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,a,m))),n.version===a.__version?(void 0===a.program||n.fog&&a.fog!==i||a.environment!==o||a.needsLights&&a.lightsStateVersion!==s.state.version||void 0!==a.numClippingPlanes&&(a.numClippingPlanes!==re.numPlanes||a.numIntersection!==re.numIntersection)||a.outputEncoding!==N.outputEncoding)&&we(n,t,r):(we(n,t,r),a.__version=n.version);var u,l=!1,c=!1,h=!1,p=a.program,m=p.getUniforms();return s=a.uniforms,v.useProgram(p.program)&&(l=!0,c=!0,h=!0),n.id!==z&&(z=n.id,c=!0),!l&&H===e||(m.setValue(d,"projectionMatrix",e.projectionMatrix),g.logarithmicDepthBuffer&&m.setValue(d,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),H!==e&&(H=e,c=!0,h=!0),(n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap)&&void 0!==(u=m.map.cameraPosition)&&u.setValue(d,se.setFromMatrixPosition(e.matrixWorld)),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&m.setValue(d,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&m.setValue(d,"viewMatrix",e.matrixWorldInverse)),n.skinning&&(m.setOptional(d,r,"bindMatrix"),m.setOptional(d,r,"bindMatrixInverse"),(t=r.skeleton)&&(l=t.bones,g.floatVertexTextures?(void 0===t.boneTexture&&(u=Math.sqrt(4*l.length),u=or.ceilPowerOfTwo(u),u=Math.max(u,4),(e=new Float32Array(u*u*4)).set(t.boneMatrices),l=new Zo(e,u,u,ht,rt),t.boneMatrices=e,t.boneTexture=l,t.boneTextureSize=u),m.setValue(d,"boneTexture",t.boneTexture,A),m.setValue(d,"boneTextureSize",t.boneTextureSize)):m.setOptional(d,t,"boneMatrices"))),!c&&a.receiveShadow===r.receiveShadow||(a.receiveShadow=r.receiveShadow,m.setValue(d,"receiveShadow",r.receiveShadow)),c&&(m.setValue(d,"toneMappingExposure",N.toneMappingExposure),m.setValue(d,"toneMappingWhitePoint",N.toneMappingWhitePoint),a.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(s,h),i&&n.fog&&function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(s,i),n.isMeshBasicMaterial?Me(s,n):n.isMeshLambertMaterial?(Me(s,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(s,n)):n.isMeshToonMaterial?(Me(s,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.gradientMap&&(e.gradientMap.value=t.gradientMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===V&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===V&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(s,n)):n.isMeshPhongMaterial?(Me(s,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===V&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===V&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(s,n)):n.isMeshStandardMaterial?(Me(s,n,o),(n.isMeshPhysicalMaterial?Te:Ee)(s,n,o)):n.isMeshMatcapMaterial?(Me(s,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===V&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===V&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(s,n)):n.isMeshDepthMaterial?(Me(s,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(s,n)):n.isMeshDistanceMaterial?(Me(s,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(s,n)):n.isMeshNormalMaterial?(Me(s,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===V&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===V&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(s,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(s,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(s,n)):n.isPointsMaterial?function(e,t){var n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*J,e.scale.value=.5*Z,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(s,n):n.isSpriteMaterial?function(e,t){var n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(s,n):n.isShadowMaterial&&(s.color.value.copy(n.color),s.opacity.value=n.opacity),void 0!==s.ltc_1&&(s.ltc_1.value=$o.LTC_1),void 0!==s.ltc_2&&(s.ltc_2.value=$o.LTC_2),ps.upload(d,a.uniformsList,s,A),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(ps.upload(d,a.uniformsList,s,A),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&m.setValue(d,"center",r.center),m.setValue(d,"modelViewMatrix",r.modelViewMatrix),m.setValue(d,"normalMatrix",r.normalMatrix),m.setValue(d,"modelMatrix",r.matrixWorld),p}function Me(e,t,n){var r,i;e.opacity.value=t.opacity,(0,m.default)(e,t.uniforms),t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),(n=t.envMap||n)&&(e.envMap.value=n,e.flipEnvMap.value=n.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=x.get(n).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap&&(r=t.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),t.aoMap?i=t.aoMap:t.lightMap&&(i=t.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uv2Transform.value.copy(i.matrix))}function Ee(e,t,n){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===V&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===V&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),(t.envMap||n)&&(e.envMapIntensity.value=t.envMapIntensity)}function Te(e,t,n){Ee(e,t,n),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen),t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===V&&e.clearcoatNormalScale.value.negate()),e.transparency.value=t.transparency}_e.setAnimationLoop((function(e){he.isPresenting||ye&&ye(e)})),"undefined"!=typeof window&&_e.setContext(window),this.setAnimationLoop=function(e){ye=e,he.setAnimationLoop(e),_e.start()},this.render=function(e,t){var n,r,i;void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),r=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),i=arguments[3]),t&&t.isCamera?P||(U.geometry=null,U.program=null,U.wireframe=!1,z=-1,H=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),he.enabled&&he.isPresenting&&(t=he.getCamera(t)),(f=E.get(e,t)).init(),e.onBeforeRender(N,e,t,r||B),ae.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ne.setFromProjectionMatrix(ae),oe=this.localClippingEnabled,ie=re.init(this.clippingPlanes,oe,t),(h=M.get(e,t)).init(),xe(e,t,0,N.sortObjects),h.finish(),!0===N.sortObjects&&h.sort(K,Q),ie&&re.beginShadows(),n=f.state.shadowsArray,fe.render(n,e,t),f.setupLights(t),ie&&re.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==r&&this.setRenderTarget(r),T.render(h,e,t,i),n=h.opaque,r=h.transparent,e.overrideMaterial?(i=e.overrideMaterial,n.length&&Ae(n,e,t,i),r.length&&Ae(r,e,t,i)):(n.length&&Ae(n,e,t),r.length&&Ae(r,e,t)),e.onAfterRender(N,e,t),null!==B&&(A.updateRenderTargetMipmap(B),A.updateMultisampleRenderTarget(B)),v.buffers.depth.setTest(!0),v.buffers.depth.setMask(!0),v.buffers.color.setMask(!0),v.setPolygonOffset(!1),h=null,f=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){O!==e&&null===B&&d.bindFramebuffer(36160,e),O=e},this.getActiveCubeFace=function(){return D},this.getActiveMipmapLevel=function(){return F},this.getRenderTarget=function(){return B},this.setRenderTarget=function(e,t,n){B=e,D=t,F=n,e&&void 0===x.get(e).__webglFramebuffer&&A.setupRenderTarget(e);var r,i=O,o=!1;q=e?(r=x.get(e).__webglFramebuffer,e.isWebGLCubeRenderTarget?(i=r[t||0],o=!0):i=e.isWebGLMultisampleRenderTarget?x.get(e).__webglMultisampledFramebuffer:r,W.copy(e.viewport),Y.copy(e.scissor),e.scissorTest):(W.copy($).multiplyScalar(J).floor(),Y.copy(ee).multiplyScalar(J).floor(),te),G!==i&&(d.bindFramebuffer(36160,i),G=i),v.viewport(W),v.scissor(Y),v.setScissorTest(q),o&&(e=x.get(e.texture),d.framebufferTexture2D(36160,36064,34069+(t||0),e.__webglTexture,n||0))},this.readRenderTargetPixels=function(e,t,n,r,i,o,a){if(e&&e.isWebGLRenderTarget){var s=x.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){a=!1,s!==G&&(d.bindFramebuffer(36160,s),a=!0);try{var u=e.texture,l=u.format,c=u.type;if(l!==ht&&R.convert(l)!==d.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(c===Ke||R.convert(c)===d.getParameter(35738)||c===rt&&(g.isWebGL2||p.get("OES_texture_float")||p.get("WEBGL_color_buffer_float"))||c===it&&(g.isWebGL2?p.get("EXT_color_buffer_float"):p.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===d.checkFramebufferStatus(36160)?0<=t&&t<=e.width-r&&0<=n&&n<=e.height-i&&d.readPixels(t,n,r,i,R.convert(l),R.convert(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{a&&d.bindFramebuffer(36160,G)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(t.image.width*r),o=Math.floor(t.image.height*r);r=R.convert(t.format),A.setTexture2D(t,0),d.copyTexImage2D(3553,n,r,e.x,e.y,i,o,0),v.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r){var i=t.image.width,o=t.image.height,a=R.convert(n.format),s=R.convert(n.type);A.setTexture2D(n,0),t.isDataTexture?d.texSubImage2D(3553,r||0,e.x,e.y,i,o,a,s,t.image.data):d.texSubImage2D(3553,r||0,e.x,e.y,a,s,t.image),v.unbindTexture()},this.initTexture=function(e){A.setTexture2D(e,0),v.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function ou(e,t){this.name="",this.color=new Pi(e),this.density=void 0!==t?t:25e-5}function au(e,t,n){this.name="",this.color=new Pi(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function su(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Yn,this.updateRange={offset:0,count:-1},this.version=0}tu.prototype=(0,m.default)((0,y.default)(jo.prototype),{constructor:tu,isArrayCamera:!0}),nu.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:nu,isGroup:!0}),(0,m.default)(ru.prototype,tr.prototype),(0,m.default)(ou.prototype,{isFogExp2:!0,clone:function(){return new ou(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),(0,m.default)(au.prototype,{isFog:!0,clone:function(){return new au(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),(0,g.default)(su.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),(0,m.default)(su.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});var uu,lu=new vr;function cu(e,t,n,r){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function hu(e){zi.call(this),this.type="SpriteMaterial",this.color=new Pi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}(0,v.default)(cu.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),(0,m.default)(cu.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)lu.x=this.getX(t),lu.y=this.getY(t),lu.z=this.getZ(t),lu.applyMatrix4(e),this.setXYZ(t,lu.x,lu.y,lu.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}}),hu.prototype=(0,y.default)(zi.prototype),hu.prototype.constructor=hu,hu.prototype.isSpriteMaterial=!0,hu.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var fu=new vr,du=new vr,pu=new vr,gu=new ar,mu=new ar,vu=new Cr,yu=new vr,_u=new vr,xu=new vr,Au=new ar,Iu=new ar,wu=new ar;function bu(e){var t;Hr.call(this),this.type="Sprite",void 0===uu&&(uu=new uo,t=new su(t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5),uu.setIndex([0,1,2,0,2,3]),uu.setAttribute("position",new cu(t,3,0,!1)),uu.setAttribute("uv",new cu(t,2,3,!1))),this.geometry=uu,this.material=void 0!==e?e:new hu,this.center=new ar(.5,.5)}function Cu(e,t,n,r,i,o){gu.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(mu.x=o*gu.x-i*gu.y,mu.y=i*gu.x+o*gu.y):mu.copy(gu),e.copy(t),e.x+=mu.x,e.y+=mu.y,e.applyMatrix4(vu)}bu.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:bu,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),du.setFromMatrixScale(this.matrixWorld),vu.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),pu.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&du.multiplyScalar(-pu.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var o=this.center;Cu(yu.set(-.5,-.5,0),pu,o,du,n,r),Cu(_u.set(.5,-.5,0),pu,o,du,n,r),Cu(xu.set(.5,.5,0),pu,o,du,n,r),Au.set(0,0),Iu.set(1,0),wu.set(1,1),null===(i=e.ray.intersectTriangle(yu,_u,xu,!1,fu))&&(Cu(_u.set(-.5,.5,0),pu,o,du,n,r),Iu.set(0,1),null===(i=e.ray.intersectTriangle(yu,xu,_u,!1,fu)))||(i=e.ray.origin.distanceTo(fu))<e.near||i>e.far||t.push({distance:i,point:fu.clone(),uv:Li.getUV(fu,yu,_u,xu,Au,Iu,wu,new ar),face:null,object:this})},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Hr.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}});var Mu=new vr,Eu=new vr;function Tu(){Hr.call(this),this._currentLevel=0,this.type="LOD",(0,v.default)(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Su(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Eo.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Cr,this.bindMatrixInverse=new Cr}Tu.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:Tu,isLOD:!0,copy:function(e){Hr.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var t=this.levels;if(0<t.length){for(var n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null},raycast:function(e,t){var n=this.levels;0<n.length&&(Mu.setFromMatrixPosition(this.matrixWorld),n=e.ray.origin.distanceTo(Mu),this.getObjectForDistance(n).raycast(e,t))},update:function(e){var t=this.levels;if(1<t.length){Mu.setFromMatrixPosition(e.matrixWorld),Eu.setFromMatrixPosition(this.matrixWorld);var n=Mu.distanceTo(Eu)/e.zoom;t[0].object.visible=!0;for(var r=1,i=t.length;r<i&&n>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}},toJSON:function(e){var t=Hr.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Su.prototype=(0,m.default)((0,y.default)(Eo.prototype),{constructor:Su,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new hr,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();1/0!==i?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Eo.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Lu=new Cr,ku=new Cr;function Ru(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Cr)}}function Nu(){Hr.call(this),this.type="Bone"}(0,m.default)(Ru.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Cr;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(var e,t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=e.length;i<o;i++){var a=e[i]?e[i].matrixWorld:ku;Lu.multiplyMatrices(a,t[i]),Lu.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new Ru(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Nu.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:Nu,isBone:!0});var Pu=new Cr,Ou=new Cr,Du=[],Fu=new Eo;function Bu(e,t,n){Eo.call(this,e,t),this.instanceMatrix=new Hi(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function Gu(e){zi.call(this),this.type="LineBasicMaterial",this.color=new Pi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}Bu.prototype=(0,m.default)((0,y.default)(Eo.prototype),{constructor:Bu,isInstancedMesh:!0,getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,r=this.count;if(Fu.geometry=this.geometry,Fu.material=this.material,void 0!==Fu.material)for(var i=0;i<r;i++)this.getMatrixAt(i,Pu),Ou.multiplyMatrices(n,Pu),Fu.matrixWorld=Ou,Fu.raycast(e,Du),0<Du.length&&(Du[0].instanceId=i,Du[0].object=this,t.push(Du[0]),Du.length=0)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),Gu.prototype=(0,y.default)(zi.prototype),Gu.prototype.constructor=Gu,Gu.prototype.isLineBasicMaterial=!0,Gu.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this};var zu=new vr,Uu=new vr,Vu=new Cr,Hu=new gi,ju=new si;function Wu(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Hr.call(this),this.type="Line",this.geometry=void 0!==e?e:new uo,this.material=void 0!==t?t:new Gu}Wu.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:Wu,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)zu.fromBufferAttribute(t,r-1),Uu.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=zu.distanceTo(Uu);e.setAttribute("lineDistance",new Ki(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var o=e.vertices;for((n=e.lineDistances)[0]=0,r=1,i=o.length;r<i;r++)n[r]=n[r-1],n[r]+=o[r-1].distanceTo(o[r])}return this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),ju.copy(n.boundingSphere),ju.applyMatrix4(r),ju.radius+=i,!1!==e.ray.intersectsSphere(ju)){Vu.getInverse(r),Hu.copy(e.ray).applyMatrix4(Vu);var o=(r=i/((this.scale.x+this.scale.y+this.scale.z)/3))*r,a=new vr,s=new vr,u=new vr,l=new vr,c=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){i=n.index;var h=(r=n.attributes).position.array;if(null!==i)for(var f=i.array,d=0,p=f.length-1;d<p;d+=c){var g=f[d],m=f[d+1];a.fromArray(h,3*g),s.fromArray(h,3*m),o<Hu.distanceSqToSegment(a,s,l,u)||(l.applyMatrix4(this.matrixWorld),(_=e.ray.origin.distanceTo(l))<e.near||_>e.far||t.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}else for(d=0,p=h.length/3-1;d<p;d+=c)a.fromArray(h,3*d),s.fromArray(h,3*d+3),o<Hu.distanceSqToSegment(a,s,l,u)||(l.applyMatrix4(this.matrixWorld),(_=e.ray.origin.distanceTo(l))<e.near||_>e.far||t.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}else if(n.isGeometry){var v=n.vertices,y=v.length;for(d=0;d<y-1;d+=c){var _;o<Hu.distanceSqToSegment(v[d],v[d+1],l,u)||(l.applyMatrix4(this.matrixWorld),(_=e.ray.origin.distanceTo(l))<e.near||_>e.far||t.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Yu=new vr,qu=new vr;function Xu(e,t){Wu.call(this,e,t),this.type="LineSegments"}function Zu(e,t){Wu.call(this,e,t),this.type="LineLoop"}function Ju(e){zi.call(this),this.type="PointsMaterial",this.color=new Pi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}Xu.prototype=(0,m.default)((0,y.default)(Wu.prototype),{constructor:Xu,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)Yu.fromBufferAttribute(t,r),qu.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Yu.distanceTo(qu);e.setAttribute("lineDistance",new Ki(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var o=e.vertices;for(n=e.lineDistances,r=0,i=o.length;r<i;r+=2)Yu.copy(o[r]),qu.copy(o[r+1]),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Yu.distanceTo(qu)}return this}}),Zu.prototype=(0,m.default)((0,y.default)(Wu.prototype),{constructor:Zu,isLineLoop:!0}),Ju.prototype=(0,y.default)(zi.prototype),Ju.prototype.constructor=Ju,Ju.prototype.isPointsMaterial=!0,Ju.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var Ku=new Cr,Qu=new gi,$u=new si,el=new vr;function tl(e,t){Hr.call(this),this.type="Points",this.geometry=void 0!==e?e:new uo,this.material=void 0!==t?t:new Ju,this.updateMorphTargets()}function nl(e,t,n,r,i,o,a){var s=Qu.distanceSqToPoint(e);s<n&&(n=new vr,Qu.closestPointToPoint(e,n),n.applyMatrix4(r),(r=i.ray.origin.distanceTo(n))<i.near||r>i.far||o.push({distance:r,distanceToRay:Math.sqrt(s),point:n,index:t,face:null,object:a}))}function rl(e,t,n,r,i,o,a,s,u){cr.call(this,e,t,n,r,i,o,a,s,u),this.format=void 0!==a?a:ct,this.minFilter=void 0!==o?o:Ye,this.magFilter=void 0!==i?i:Ye,this.generateMipmaps=!1}function il(e,t,n,r,i,o,a,s,u,l,c,h){cr.call(this,null,o,a,s,u,l,r,i,c,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function ol(e,t,n,r,i,o,a,s,u){cr.call(this,e,t,n,r,i,o,a,s,u),this.needsUpdate=!0}function al(e,t,n,r,i,o,a,s,u,l){if((l=void 0!==l?l:gt)!==gt&&l!==mt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===gt&&(n=et),void 0===n&&l===mt&&(n=ut),cr.call(this,null,r,i,o,a,s,l,n,u),this.image={width:e,height:t},this.magFilter=void 0!==a?a:Ue,this.minFilter=void 0!==s?s:Ue,this.flipY=!1,this.generateMipmaps=!1}function sl(e){uo.call(this),this.type="WireframeGeometry";var t,n,r,i,o,a,s=[],u=[0,0],l={},c=["a","b","c"];if(e&&e.isGeometry){for(var h=e.faces,f=0,d=h.length;f<d;f++)for(var p=h[f],g=0;g<3;g++)i=p[c[g]],o=p[c[(g+1)%3]],u[0]=Math.min(i,o),u[1]=Math.max(i,o),void 0===l[a=u[0]+","+u[1]]&&(l[a]={index1:u[0],index2:u[1]});for(a in l)r=l[a],I=e.vertices[r.index1],s.push(I.x,I.y,I.z),I=e.vertices[r.index2],s.push(I.x,I.y,I.z)}else if(e&&e.isBufferGeometry){var m,v,y,_,x,A,I=new vr;if(null!==e.index){for(m=e.attributes.position,v=e.index,0===(y=e.groups).length&&(y=[{start:0,count:v.count,materialIndex:0}]),t=0,n=y.length;t<n;++t)for(f=_=(x=y[t]).start,d=_+(x=x.count);f<d;f+=3)for(g=0;g<3;g++)i=v.getX(f+g),o=v.getX(f+(g+1)%3),u[0]=Math.min(i,o),u[1]=Math.max(i,o),void 0===l[a=u[0]+","+u[1]]&&(l[a]={index1:u[0],index2:u[1]});for(a in l)r=l[a],I.fromBufferAttribute(m,r.index1),s.push(I.x,I.y,I.z),I.fromBufferAttribute(m,r.index2),s.push(I.x,I.y,I.z)}else for(f=0,d=(m=e.attributes.position).count/3;f<d;f++)for(g=0;g<3;g++)A=3*f+g,I.fromBufferAttribute(m,A),s.push(I.x,I.y,I.z),A=3*f+(g+1)%3,I.fromBufferAttribute(m,A),s.push(I.x,I.y,I.z)}this.setAttribute("position",new Ki(s,3))}function ul(e,t,n){Po.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new ll(e,t,n)),this.mergeVertices()}function ll(e,t,n){uo.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var r=[],i=[],o=[],a=[],s=1e-5,u=new vr,l=new vr,c=new vr,h=new vr,f=new vr;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var d=t+1,p=0;p<=n;p++)for(var g=p/n,m=0;m<=t;m++){var v=m/t;e(v,g,l),i.push(l.x,l.y,l.z),0<=v-s?(e(v-s,g,c),h.subVectors(l,c)):(e(v+s,g,c),h.subVectors(c,l)),0<=g-s?(e(v,g-s,c),f.subVectors(l,c)):(e(v,g+s,c),f.subVectors(c,l)),u.crossVectors(h,f).normalize(),o.push(u.x,u.y,u.z),a.push(v,g)}for(p=0;p<n;p++)for(m=0;m<t;m++){var y=p*d+m,_=p*d+m+1,x=(p+1)*d+m+1,A=(p+1)*d+m;r.push(y,_,A),r.push(_,x,A)}this.setIndex(r),this.setAttribute("position",new Ki(i,3)),this.setAttribute("normal",new Ki(o,3)),this.setAttribute("uv",new Ki(a,2))}function cl(e,t,n,r){Po.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new hl(e,t,n,r)),this.mergeVertices()}function hl(e,t,n,r){uo.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},n=n||1;var i=[],o=[];function a(e,t,n,r){for(var i=Math.pow(2,r),o=[],a=0;a<=i;a++){o[a]=[];for(var u=e.clone().lerp(n,a/i),l=t.clone().lerp(n,a/i),c=i-a,h=0;h<=c;h++)o[a][h]=0===h&&a===i?u:u.clone().lerp(l,h/c)}for(a=0;a<i;a++)for(h=0;h<2*(i-a)-1;h++){var f=Math.floor(h/2);h%2==0?(s(o[a][f+1]),s(o[a+1][f]),s(o[a][f])):(s(o[a][f+1]),s(o[a+1][f+1]),s(o[a+1][f]))}}function s(e){i.push(e.x,e.y,e.z)}function u(t,n){t*=3,n.x=e[t+0],n.y=e[t+1],n.z=e[t+2]}function l(e,t,n,r){r<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=r/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(function(e){for(var n=new vr,r=new vr,i=new vr,o=0;o<t.length;o+=3)u(t[o+0],n),u(t[o+1],r),u(t[o+2],i),a(n,r,i,e)})(r=r||0),function(e){for(var t=new vr,n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){for(var e=new vr,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var n=c(e)/2/Math.PI+.5,r=h(e)/Math.PI+.5;o.push(n,1-r)}(function(){for(var e=new vr,t=new vr,n=new vr,r=new vr,a=new ar,s=new ar,u=new ar,h=0,f=0;h<i.length;h+=9,f+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),a.set(o[f+0],o[f+1]),s.set(o[f+2],o[f+3]),u.set(o[f+4],o[f+5]),r.copy(e).add(t).add(n).divideScalar(3);var d=c(r);l(a,f+0,e,d),l(s,f+2,t,d),l(u,f+4,n,d)}})(),function(){for(var e=0;e<o.length;e+=6){var t=o[e+0],n=o[e+2],r=o[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);.9<i&&a<.1&&(t<.2&&(o[e+0]+=1),n<.2&&(o[e+2]+=1),r<.2&&(o[e+4]+=1))}}()}(),this.setAttribute("position",new Ki(i,3)),this.setAttribute("normal",new Ki(i.slice(),3)),this.setAttribute("uv",new Ki(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function fl(e,t){Po.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new dl(e,t)),this.mergeVertices()}function dl(e,t){hl.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function pl(e,t){Po.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new gl(e,t)),this.mergeVertices()}function gl(e,t){hl.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function ml(e,t){Po.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new vl(e,t)),this.mergeVertices()}function vl(e,t){var n=[-1,r=(1+Math.sqrt(5))/2,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];hl.call(this,n,r,e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function yl(e,t){Po.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new _l(e,t)),this.mergeVertices()}function _l(e,t){var n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-(r=1/(n=(1+Math.sqrt(5))/2)),-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],r=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];hl.call(this,n,r,e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function xl(e,t,n,r,i,o){Po.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed."),i=new Al(e,t,n,r,i),this.tangents=i.tangents,this.normals=i.normals,this.binormals=i.binormals,this.fromBufferGeometry(i),this.mergeVertices()}function Al(e,t,n,r,i){uo.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},t=t||64,n=n||1,r=r||8,i=i||!1;var o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,u=new vr,l=new vr,c=new ar,h=new vr,f=[],d=[],p=[],g=[];function m(i){h=e.getPointAt(i/t,h);var a=o.normals[i],c=o.binormals[i];for(s=0;s<=r;s++){var p=s/r*Math.PI*2,g=Math.sin(p);p=-Math.cos(p),l.x=p*a.x+g*c.x,l.y=p*a.y+g*c.y,l.z=p*a.z+g*c.z,l.normalize(),d.push(l.x,l.y,l.z),u.x=h.x+n*l.x,u.y=h.y+n*l.y,u.z=h.z+n*l.z,f.push(u.x,u.y,u.z)}}(function(){for(a=0;a<t;a++)m(a);m(!1===i?t:0),function(){for(a=0;a<=t;a++)for(s=0;s<=r;s++)c.x=a/t,c.y=s/r,p.push(c.x,c.y)}(),function(){for(s=1;s<=t;s++)for(a=1;a<=r;a++){var e=(r+1)*(s-1)+(a-1),n=(r+1)*s+(a-1),i=(r+1)*s+a,o=(r+1)*(s-1)+a;g.push(e,n,o),g.push(n,i,o)}}()})(),this.setIndex(g),this.setAttribute("position",new Ki(f,3)),this.setAttribute("normal",new Ki(d,3)),this.setAttribute("uv",new Ki(p,2))}function Il(e,t,n,r,i,o,a){Po.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new wl(e,t,n,r,i,o)),this.mergeVertices()}function wl(e,t,n,r,i,o){uo.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;for(var a,s=[],u=[],l=[],c=[],h=new vr,f=new vr,d=new vr,p=new vr,g=new vr,m=new vr,v=new vr,y=0;y<=n;++y){var _=y/n*i*Math.PI*2;for(M(_,i,o,e,d),M(_+.01,i,o,e,p),m.subVectors(p,d),v.addVectors(p,d),g.crossVectors(m,v),v.crossVectors(g,m),g.normalize(),v.normalize(),a=0;a<=r;++a){var x=a/r*Math.PI*2,A=-t*Math.cos(x);x=t*Math.sin(x),h.x=d.x+(A*v.x+x*g.x),h.y=d.y+(A*v.y+x*g.y),h.z=d.z+(A*v.z+x*g.z),u.push(h.x,h.y,h.z),f.subVectors(h,d).normalize(),l.push(f.x,f.y,f.z),c.push(y/n),c.push(a/r)}}for(a=1;a<=n;a++)for(y=1;y<=r;y++){var I=(r+1)*(a-1)+(y-1),w=(r+1)*a+(y-1),b=(r+1)*a+y,C=(r+1)*(a-1)+y;s.push(I,w,C),s.push(w,b,C)}function M(e,t,n,r,i){var o=Math.cos(e),a=Math.sin(e);t=n/t*e,e=Math.cos(t),i.x=r*(2+e)*.5*o,i.y=r*(2+e)*a*.5,i.z=r*Math.sin(t)*.5}this.setIndex(s),this.setAttribute("position",new Ki(u,3)),this.setAttribute("normal",new Ki(l,3)),this.setAttribute("uv",new Ki(c,2))}function bl(e,t,n,r,i){Po.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new Cl(e,t,n,r,i)),this.mergeVertices()}function Cl(e,t,n,r,i){uo.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;for(var o,a=[],s=[],u=[],l=[],c=new vr,h=new vr,f=new vr,d=0;d<=n;d++)for(o=0;o<=r;o++){var p=o/r*i,g=d/n*Math.PI*2;h.x=(e+t*Math.cos(g))*Math.cos(p),h.y=(e+t*Math.cos(g))*Math.sin(p),h.z=t*Math.sin(g),s.push(h.x,h.y,h.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),f.subVectors(h,c).normalize(),u.push(f.x,f.y,f.z),l.push(o/r),l.push(d/n)}for(d=1;d<=n;d++)for(o=1;o<=r;o++){var m=(r+1)*d+o-1,v=(r+1)*(d-1)+o-1,y=(r+1)*(d-1)+o,_=(r+1)*d+o;a.push(m,v,_),a.push(v,y,_)}this.setIndex(a),this.setAttribute("position",new Ki(s,3)),this.setAttribute("normal",new Ki(u,3)),this.setAttribute("uv",new Ki(l,2))}tl.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:tl,isPoints:!0,raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),$u.copy(n.boundingSphere),$u.applyMatrix4(r),$u.radius+=i,!1!==e.ray.intersectsSphere($u)){Ku.getInverse(r),Qu.copy(e.ray).applyMatrix4(Ku);var o=(a=i/((this.scale.x+this.scale.y+this.scale.z)/3))*a;if(n.isBufferGeometry){i=n.index;var a,s=(a=n.attributes).position.array;if(null!==i)for(var u=i.array,l=0,c=u.length;l<c;l++){var h=u[l];el.fromArray(s,3*h),nl(el,h,o,r,e,t,this)}else{l=0;for(var f=s.length/3;l<f;l++)el.fromArray(s,3*l),nl(el,l,o,r,e,t,this)}}else{var d=n.vertices;for(l=0,f=d.length;l<f;l++)nl(d[l],l,o,r,e,t,this)}}},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=(0,w.default)(i);if(0<o.length){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)n=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else void 0!==(r=r.morphTargets)&&0<r.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),rl.prototype=(0,m.default)((0,y.default)(cr.prototype),{constructor:rl,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),il.prototype=(0,y.default)(cr.prototype),il.prototype.constructor=il,il.prototype.isCompressedTexture=!0,ol.prototype=(0,y.default)(cr.prototype),ol.prototype.constructor=ol,ol.prototype.isCanvasTexture=!0,al.prototype=(0,y.default)(cr.prototype),al.prototype.constructor=al,al.prototype.isDepthTexture=!0,sl.prototype=(0,y.default)(uo.prototype),sl.prototype.constructor=sl,ul.prototype=(0,y.default)(Po.prototype),ul.prototype.constructor=ul,ll.prototype=(0,y.default)(uo.prototype),ll.prototype.constructor=ll,cl.prototype=(0,y.default)(Po.prototype),cl.prototype.constructor=cl,hl.prototype=(0,y.default)(uo.prototype),hl.prototype.constructor=hl,fl.prototype=(0,y.default)(Po.prototype),fl.prototype.constructor=fl,dl.prototype=(0,y.default)(hl.prototype),dl.prototype.constructor=dl,pl.prototype=(0,y.default)(Po.prototype),pl.prototype.constructor=pl,gl.prototype=(0,y.default)(hl.prototype),gl.prototype.constructor=gl,ml.prototype=(0,y.default)(Po.prototype),ml.prototype.constructor=ml,vl.prototype=(0,y.default)(hl.prototype),vl.prototype.constructor=vl,yl.prototype=(0,y.default)(Po.prototype),yl.prototype.constructor=yl,_l.prototype=(0,y.default)(hl.prototype),_l.prototype.constructor=_l,xl.prototype=(0,y.default)(Po.prototype),xl.prototype.constructor=xl,Al.prototype=(0,y.default)(uo.prototype),Al.prototype.constructor=Al,Al.prototype.toJSON=function(){var e=uo.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},Il.prototype=(0,y.default)(Po.prototype),Il.prototype.constructor=Il,wl.prototype=(0,y.default)(uo.prototype),wl.prototype.constructor=wl,bl.prototype=(0,y.default)(Po.prototype),bl.prototype.constructor=bl,Cl.prototype=(0,y.default)(uo.prototype),Cl.prototype.constructor=Cl;function Ml(e,t,n,r,i){var o,a;if(i===0<function(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,n,r))for(o=t;o<n;o+=r)a=jl(o,e[o],e[o+1],a);else for(o=n-r;t<=o;o-=r)a=jl(o,e[o],e[o+1],a);return a&&zl(a,a.next)&&(Wl(a),a=a.next),a}function El(e,t){if(!e)return e;t=t||e;var n,r=e;do{if(n=!1,r.steiner||!zl(r,r.next)&&0!==Gl(r.prev,r,r.next))r=r.next;else{if(Wl(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Tl(e,t,n,r,i,o,a){if(e){!a&&o&&function(e,t,n,r){for(var i=e;null===i.z&&(i.z=Ol(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,(i=i.next)!==e;);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,u,l=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ);t++);for(u=l;0<s||0<u&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}}while(o.nextZ=null,l*=2,1<a)}(i)}(e,r,i,o);for(var s,u,l=e;e.prev!==e.next;)if(s=e.prev,u=e.next,o?Ll(e,r,i,o):Sl(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),Wl(e),e=u.next,l=u.next;else if((e=u)===l){a?1===a?Tl(e=kl(e,t,n),t,n,r,i,o,2):2===a&&Rl(e,t,n,r,i,o):Tl(El(e),t,n,r,i,o,1);break}}}function Sl(e){var t=e.prev,n=e,r=e.next;if(0<=Gl(t,n,r))return!1;for(var i=e.next.next;i!==e.prev;){if(Fl(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&0<=Gl(i.prev,i,i.next))return!1;i=i.next}return!0}function Ll(e,t,n,r){var i=e.prev,o=e,a=e.next;if(0<=Gl(i,o,a))return!1;for(var s=(i.x<o.x?i.x<a.x?i:a:o.x<a.x?o:a).x,u=(i.y<o.y?i.y<a.y?i:a:o.y<a.y?o:a).y,l=(i.x>o.x?i.x>a.x?i:a:o.x>a.x?o:a).x,c=(i.y>o.y?i.y>a.y?i:a:o.y>a.y?o:a).y,h=Ol(s,u,t,n,r),f=Ol(l,c,t,n,r),d=e.prevZ,p=e.nextZ;d&&d.z>=h&&p&&p.z<=f;){if(d!==e.prev&&d!==e.next&&Fl(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&0<=Gl(d.prev,d,d.next))return!1;if(d=d.prevZ,p!==e.prev&&p!==e.next&&Fl(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=Gl(p.prev,p,p.next))return!1;p=p.nextZ}for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&Fl(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&0<=Gl(d.prev,d,d.next))return!1;d=d.prevZ}for(;p&&p.z<=f;){if(p!==e.prev&&p!==e.next&&Fl(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=Gl(p.prev,p,p.next))return!1;p=p.nextZ}return!0}function kl(e,t,n){var r=e;do{var i=r.prev,o=r.next.next}while(!zl(i,o)&&Ul(i,r,r.next,o)&&Vl(i,o)&&Vl(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),Wl(r),Wl(r.next),r=e=o),(r=r.next)!==e);return r}function Rl(e,t,n,r,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Bl(a,s)){var u=Hl(a,s);return a=El(a,a.next),u=El(u,u.next),Tl(a,t,n,r,i,o),void Tl(u,t,n,r,i,o)}s=s.next}}while((a=a.next)!==e)}function Nl(e,t){return e.x-t.x}function Pl(e,t){t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&a<s){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}}while((r=r.next)!==t);if(!n)return null;if(i===a)return n.prev;var u,l=n,c=n.x,h=n.y,f=1/0;for(r=n.next;r!==l;)i>=r.x&&r.x>=c&&i!==r.x&&Fl(o<h?i:a,o,c,h,o<h?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<f||u===f&&r.x>n.x)&&Vl(r,e)&&(n=r,f=u),r=r.next;return n}(e,t),t&&El(e=Hl(t,e),e.next)}function Ol(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Dl(e){for(var t=e,n=e;(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),(t=t.next)!==e;);return n}function Fl(e,t,n,r,i,o,a,s){return 0<=(i-a)*(t-s)-(e-a)*(o-s)&&0<=(e-a)*(r-s)-(n-a)*(t-s)&&0<=(n-a)*(o-s)-(i-a)*(r-s)}function Bl(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Ul(n,n.next,e,t))return!0}while((n=n.next)!==e);return!1}(e,t)&&Vl(e,t)&&Vl(t,e)&&function(e,t){for(var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),(n=n.next)!==e;);return r}(e,t)}function Gl(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function zl(e,t){return e.x===t.x&&e.y===t.y}function Ul(e,t,n,r){return!!(zl(e,n)&&zl(t,r)||zl(e,r)&&zl(n,t))||0<Gl(e,t,n)!=0<Gl(e,t,r)&&0<Gl(n,r,e)!=0<Gl(n,r,t)}function Vl(e,t){return Gl(e.prev,e,e.next)<0?0<=Gl(e,t,e.next)&&0<=Gl(e,e.prev,t):Gl(e,t,e.prev)<0||Gl(e,e.next,t)<0}function Hl(e,t){var n=new Yl(e.i,e.x,e.y),r=new Yl(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function jl(e,t,n,r){return n=new Yl(e,t,n),r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Wl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Yl(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var ql={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return ql.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];Xl(e),Zl(n,e);var o=e.length;t.forEach(Xl);for(var a=0;a<t.length;a++)r.push(o),o+=t[a].length,Zl(n,t[a]);var s=function(e,t,n){n=n||2;var r,i,o,a,s,u=t&&t.length,l=u?t[0]*n:e.length,c=Ml(e,0,l,n,!0),h=[];if(!c||c.next===c.prev)return h;if(u&&(c=function(e,t,n,r){for(var i,o=[],a=0,s=t.length;a<s;a++)(i=Ml(e,t[a]*r,i=a<s-1?t[a+1]*r:e.length,r,!1))===i.next&&(i.steiner=!0),o.push(Dl(i));for(o.sort(Nl),a=0;a<o.length;a++)Pl(o[a],n),n=El(n,n.next);return n}(e,t,c,n)),e.length>80*n){for(var f=r=e[0],d=i=e[1],p=n;p<l;p+=n)(o=e[p])<f&&(f=o),(a=e[p+1])<d&&(d=a),r<o&&(r=o),i<a&&(i=a);s=0!==(s=Math.max(r-f,i-d))?1/s:0}return Tl(c,h,n,f,d,s),h}(n,r);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function Xl(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function Zl(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function Jl(e,t){Po.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Kl(e,t)),this.mergeVertices()}function Kl(e,t){uo.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=(0,_.default)(e)?e:[e];for(var n=this,r=[],i=[],o=0,a=e.length;o<a;o++)s(e[o]);function s(e){var o=[],a=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,u=void 0!==t.depth?t.depth:100,l=void 0===t.bevelEnabled||t.bevelEnabled,c=void 0!==t.bevelThickness?t.bevelThickness:6,h=void 0!==t.bevelSize?t.bevelSize:c-2,f=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3,g=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:Ql;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=t.amount);var v,y,_,x,A,I,w=!1;g&&(v=g.getSpacedPoints(s),w=!0,l=!1,y=g.computeFrenetFrames(s,!1),_=new vr,x=new vr,A=new vr),l||(p=0,c=0,h=0,f=0);var b=(a=e.extractPoints(a)).shape,C=a.holes;if(a=!ql.isClockWise(b))for(b=b.reverse(),T=0,S=C.length;T<S;T++)I=C[T],ql.isClockWise(I)&&(C[T]=I.reverse());for(var M=ql.triangulateShape(b,C),E=b,T=0,S=C.length;T<S;T++)I=C[T],b=b.concat(I);function L(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var k,R,N,P,O,D,F=b.length,B=M.length;function G(e,t,n){var r=e.x-t.x,i=e.y-t.y,o=n.x-e.x,a=n.y-e.y,s=r*r+i*i,u=r*a-i*o;if(Math.abs(u)>d.default){var l=Math.sqrt(s),c=Math.sqrt(o*o+a*a),h=t.x-i/l,f=t.y+r/l;if((f=(c=h+r*(l=(((l=n.x-a/c)-h)*a-((c=n.y+o/c)-f)*o)/(r*a-i*o))-e.x)*c+(h=f+i*l-e.y)*h)<=2)return new ar(c,h);l=Math.sqrt(f/2)}else f=!1,r>d.default?o>d.default&&(f=!0):r<-d.default?o<-d.default&&(f=!0):Math.sign(i)===Math.sign(a)&&(f=!0),l=f?(c=-i,h=r,Math.sqrt(s)):(c=r,h=i,Math.sqrt(s/2));return new ar(c/l,h/l)}for(var z=[],U=0,V=E.length,H=V-1,j=U+1;U<V;U++,H++,j++)H===V&&(H=0),j===V&&(j=0),z[U]=G(E[U],E[H],E[j]);var W,Y,q=[],X=z.concat();for(T=0,S=C.length;T<S;T++){for(I=C[T],W=[],U=0,H=(V=I.length)-1,j=U+1;U<V;U++,H++,j++)H===V&&(H=0),j===V&&(j=0),W[U]=G(I[U],I[H],I[j]);q.push(W),X=X.concat(W)}for(k=0;k<p;k++){for(N=k/p,P=c*Math.cos(N*Math.PI/2),R=h*Math.sin(N*Math.PI/2)+f,U=0,V=E.length;U<V;U++)J((O=L(E[U],z[U],R)).x,O.y,-P);for(T=0,S=C.length;T<S;T++)for(I=C[T],W=q[T],U=0,V=I.length;U<V;U++)J((O=L(I[U],W[U],R)).x,O.y,-P)}for(R=h+f,U=0;U<F;U++)O=l?L(b[U],X[U],R):b[U],w?(x.copy(y.normals[0]).multiplyScalar(O.x),_.copy(y.binormals[0]).multiplyScalar(O.y),A.copy(v[0]).add(x).add(_),J(A.x,A.y,A.z)):J(O.x,O.y,0);for(Y=1;Y<=s;Y++)for(U=0;U<F;U++)O=l?L(b[U],X[U],R):b[U],w?(x.copy(y.normals[Y]).multiplyScalar(O.x),_.copy(y.binormals[Y]).multiplyScalar(O.y),A.copy(v[Y]).add(x).add(_),J(A.x,A.y,A.z)):J(O.x,O.y,u/s*Y);for(k=p-1;0<=k;k--){for(N=k/p,P=c*Math.cos(N*Math.PI/2),R=h*Math.sin(N*Math.PI/2)+f,U=0,V=E.length;U<V;U++)J((O=L(E[U],z[U],R)).x,O.y,u+P);for(T=0,S=C.length;T<S;T++)for(I=C[T],W=q[T],U=0,V=I.length;U<V;U++)O=L(I[U],W[U],R),w?J(O.x,O.y+v[s-1].y,v[s-1].x+P):J(O.x,O.y,u+P)}function Z(e,t){var n,r;for(U=e.length;0<=--U;){n=U,(r=U-1)<0&&(r=e.length-1);var i=0,o=s+2*p;for(i=0;i<o;i++){var a,u;Q(t+n+(a=F*i),t+r+a,a=t+r+(u=F*(i+1)),u=t+n+u)}}}function J(e,t,n){o.push(e),o.push(t),o.push(n)}function K(e,t,i){$(e),$(t),$(i),i=r.length/3,ee((i=m.generateTopUV(n,r,i-3,i-2,i-1))[0]),ee(i[1]),ee(i[2])}function Q(e,t,i,o){$(e),$(t),$(o),$(t),$(i),$(o),o=r.length/3,ee((o=m.generateSideWallUV(n,r,o-6,o-3,o-2,o-1))[0]),ee(o[1]),ee(o[3]),ee(o[1]),ee(o[2]),ee(o[3])}function $(e){r.push(o[3*e+0]),r.push(o[3*e+1]),r.push(o[3*e+2])}function ee(e){i.push(e.x),i.push(e.y)}(function(){var e=r.length/3;if(l){var t=0,i=F*t;for(U=0;U<B;U++)K((D=M[U])[2]+i,D[1]+i,D[0]+i);for(i=F*(t=s+2*p),U=0;U<B;U++)K((D=M[U])[0]+i,D[1]+i,D[2]+i)}else{for(U=0;U<B;U++)K((D=M[U])[2],D[1],D[0]);for(U=0;U<B;U++)K((D=M[U])[0]+F*s,D[1]+F*s,D[2]+F*s)}n.addGroup(e,r.length/3-e,0)})(),function(){var e=r.length/3,t=0;for(Z(E,t),t+=E.length,T=0,S=C.length;T<S;T++)Z(I=C[T],t),t+=I.length;n.addGroup(e,r.length/3-e,1)}()}this.setAttribute("position",new Ki(r,3)),this.setAttribute("uv",new Ki(i,2)),this.computeVertexNormals()}t.ShapeUtils=ql,Jl.prototype=(0,y.default)(Po.prototype),Jl.prototype.constructor=Jl,Jl.prototype.toJSON=function(){var e=Po.prototype.toJSON.call(this);return $l(this.parameters.shapes,this.parameters.options,e)},Kl.prototype=(0,y.default)(uo.prototype),Kl.prototype.constructor=Kl,Kl.prototype.toJSON=function(){var e=uo.prototype.toJSON.call(this);return $l(this.parameters.shapes,this.parameters.options,e)};var Ql={generateTopUV:function(e,t,n,r,i){var o=t[3*n],a=t[3*n+1],s=t[3*r];return n=t[3*r+1],r=t[3*i],i=t[3*i+1],[new ar(o,a),new ar(s,n),new ar(r,i)]},generateSideWallUV:function(e,t,n,r,i,o){var a=t[3*n],s=t[3*n+1],u=t[3*n+2],l=t[3*r],c=t[3*r+1],h=t[3*r+2],f=t[3*i],d=t[3*i+1];return n=t[3*i+2],r=t[3*o],i=t[3*o+1],o=t[3*o+2],Math.abs(s-c)<.01?[new ar(a,1-u),new ar(l,1-h),new ar(f,1-n),new ar(r,1-o)]:[new ar(s,1-u),new ar(c,1-h),new ar(d,1-n),new ar(i,1-o)]}};function $l(e,t,n){if(n.shapes=[],(0,_.default)(e))for(var r=0,i=e.length;r<i;r++){var o=e[r];n.shapes.push(o.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function ec(e,t){Po.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new tc(e,t)),this.mergeVertices()}function tc(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Po;e=n.generateShapes(e,t.size),t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Kl.call(this,e,t),this.type="TextBufferGeometry"}function nc(e,t,n,r,i,o,a){Po.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new rc(e,t,n,r,i,o,a)),this.mergeVertices()}function rc(e,t,n,r,i,o,a){uo.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;for(var s,u=Math.min(o+a,Math.PI),l=0,c=[],h=new vr,f=new vr,d=[],p=[],g=[],m=[],v=0;v<=n;v++){var y=[],_=v/n,x=0;for(0==v&&0==o?x=.5/t:v==n&&u==Math.PI&&(x=-.5/t),s=0;s<=t;s++){var A=s/t;h.x=-e*Math.cos(r+A*i)*Math.sin(o+_*a),h.y=e*Math.cos(o+_*a),h.z=e*Math.sin(r+A*i)*Math.sin(o+_*a),p.push(h.x,h.y,h.z),f.copy(h).normalize(),g.push(f.x,f.y,f.z),m.push(A+x,1-_),y.push(l++)}c.push(y)}for(v=0;v<n;v++)for(s=0;s<t;s++){var I=c[v][s+1],w=c[v][s],b=c[v+1][s],C=c[v+1][s+1];(0!==v||0<o)&&d.push(I,w,C),(v!==n-1||u<Math.PI)&&d.push(w,b,C)}this.setIndex(d),this.setAttribute("position",new Ki(p,3)),this.setAttribute("normal",new Ki(g,3)),this.setAttribute("uv",new Ki(m,2))}function ic(e,t,n,r,i,o){Po.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new oc(e,t,n,r,i,o)),this.mergeVertices()}function oc(e,t,n,r,i,o){uo.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},e=e||.5,t=t||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;for(var a=[],s=[],u=[],l=[],c=e,h=(t-e)/(r=void 0!==r?Math.max(1,r):1),f=new vr,d=new ar,p=0;p<=r;p++){for(m=0;m<=n;m++)v=i+m/n*o,f.x=c*Math.cos(v),f.y=c*Math.sin(v),s.push(f.x,f.y,f.z),u.push(0,0,1),d.x=(f.x/t+1)/2,d.y=(f.y/t+1)/2,l.push(d.x,d.y);c+=h}for(p=0;p<r;p++)for(var g=p*(n+1),m=0;m<n;m++){var v=m+g,y=v,_=v+n+1,x=v+n+2,A=v+1;a.push(y,_,A),a.push(_,x,A)}this.setIndex(a),this.setAttribute("position",new Ki(s,3)),this.setAttribute("normal",new Ki(u,3)),this.setAttribute("uv",new Ki(l,2))}function ac(e,t,n,r){Po.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new sc(e,t,n,r)),this.mergeVertices()}function sc(e,t,n,r){uo.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||2*Math.PI,r=or.clamp(r,0,2*Math.PI);for(var i=[],o=[],a=[],s=1/t,u=new vr,l=new ar,c=0;c<=t;c++)for(var h=n+c*s*r,f=Math.sin(h),d=Math.cos(h),p=0;p<=e.length-1;p++)u.x=e[p].x*f,u.y=e[p].y,u.z=e[p].x*d,o.push(u.x,u.y,u.z),l.x=c/t,l.y=p/(e.length-1),a.push(l.x,l.y);for(c=0;c<t;c++)for(p=0;p<e.length-1;p++){var g=w=p+c*e.length,m=w+e.length,v=w+e.length+1,y=w+1;i.push(g,m,y),i.push(m,v,y)}if(this.setIndex(i),this.setAttribute("position",new Ki(o,3)),this.setAttribute("uv",new Ki(a,2)),this.computeVertexNormals(),r===2*Math.PI){var _=this.attributes.normal.array,x=new vr,A=new vr,I=new vr,w=t*e.length*3;for(c=0,p=0;c<e.length;c++,p+=3)x.x=_[p+0],x.y=_[p+1],x.z=_[p+2],A.x=_[w+p+0],A.y=_[w+p+1],A.z=_[w+p+2],I.addVectors(x,A).normalize(),_[p+0]=_[w+p+0]=I.x,_[p+1]=_[w+p+1]=I.y,_[p+2]=_[w+p+2]=I.z}}function uc(e,t){Po.call(this),this.type="ShapeGeometry","object"===(0,a.default)(t)&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new lc(e,t)),this.mergeVertices()}function lc(e,t){uo.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],r=[],i=[],o=[],a=0,s=0;if(!1===(0,_.default)(e))l(e);else for(var u=0;u<e.length;u++)l(e[u]),this.addGroup(a,s,u),a+=s,s=0;function l(e){var a,u=r.length/3,l=(e=e.extractPoints(t)).shape,c=e.holes;for(!1===ql.isClockWise(l)&&(l=l.reverse()),f=0,d=c.length;f<d;f++)a=c[f],!0===ql.isClockWise(a)&&(c[f]=a.reverse());for(var h=ql.triangulateShape(l,c),f=0,d=c.length;f<d;f++)a=c[f],l=l.concat(a);for(f=0,d=l.length;f<d;f++){var p=l[f];r.push(p.x,p.y,0),i.push(0,0,1),o.push(p.x,p.y)}for(f=0,d=h.length;f<d;f++){var g=(v=h[f])[0]+u,m=v[1]+u,v=v[2]+u;n.push(g,m,v),s+=3}}this.setIndex(n),this.setAttribute("position",new Ki(r,3)),this.setAttribute("normal",new Ki(i,3)),this.setAttribute("uv",new Ki(o,2))}function cc(e,t){if(t.shapes=[],(0,_.default)(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function hc(e,t){uo.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,r,i,o,a=[],s=Math.cos(or.DEG2RAD*t),u=[0,0],l={},c=["a","b","c"];e.isBufferGeometry?(o=new Po).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,f=o.faces,d=0,p=f.length;d<p;d++)for(var g=f[d],m=0;m<3;m++)n=g[c[m]],r=g[c[(m+1)%3]],u[0]=Math.min(n,r),u[1]=Math.max(n,r),void 0===l[i=u[0]+","+u[1]]?l[i]={index1:u[0],index2:u[1],face1:d,face2:void 0}:l[i].face2=d;for(i in l){var v,y=l[i];(void 0===y.face2||f[y.face1].normal.dot(f[y.face2].normal)<=s)&&(v=h[y.index1],a.push(v.x,v.y,v.z),v=h[y.index2],a.push(v.x,v.y,v.z))}this.setAttribute("position",new Ki(a,3))}function fc(e,t,n,r,i,o,a,s){Po.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new dc(e,t,n,r,i,o,a,s)),this.mergeVertices()}function dc(e,t,n,r,i,o,a,s){uo.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var u=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l=[],c=[],h=[],f=[],d=0,p=[],g=n/2,m=0;function v(n){for(var i,o=new ar,p=new vr,v=0,y=!0===n?e:t,_=!0===n?1:-1,x=d,A=1;A<=r;A++)c.push(0,g*_,0),h.push(0,_,0),f.push(.5,.5),d++;for(i=d,A=0;A<=r;A++){var I=A/r*s+a,w=Math.cos(I);I=Math.sin(I),p.x=y*I,p.y=g*_,p.z=y*w,c.push(p.x,p.y,p.z),h.push(0,_,0),o.x=.5*w+.5,o.y=.5*I*_+.5,f.push(o.x,o.y),d++}for(A=0;A<r;A++){var b=x+A,C=i+A;!0===n?l.push(C,C+1,b):l.push(C+1,C,b),v+=3}u.addGroup(m,v,!0===n?1:2),m+=v}(function(){for(var o=new vr,v=new vr,y=0,_=(t-e)/n,x=0;x<=i;x++){for(var A=[],I=x/i,w=I*(t-e)+e,b=0;b<=r;b++){var C=b/r,M=C*s+a,E=Math.sin(M);M=Math.cos(M),v.x=w*E,v.y=-I*n+g,v.z=w*M,c.push(v.x,v.y,v.z),o.set(E,_,M).normalize(),h.push(o.x,o.y,o.z),f.push(C,1-I),A.push(d++)}p.push(A)}for(b=0;b<r;b++)for(x=0;x<i;x++){var T=p[x][b],S=p[x+1][b],L=p[x+1][b+1],k=p[x][b+1];l.push(T,S,k),l.push(S,L,k),y+=6}u.addGroup(m,y,0),m+=y})(),!1===o&&(0<e&&v(!0),0<t&&v(!1)),this.setIndex(l),this.setAttribute("position",new Ki(c,3)),this.setAttribute("normal",new Ki(h,3)),this.setAttribute("uv",new Ki(f,2))}function pc(e,t,n,r,i,o,a){fc.call(this,0,e,t,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function gc(e,t,n,r,i,o,a){dc.call(this,0,e,t,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function mc(e,t,n,r){Po.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new vc(e,t,n,r)),this.mergeVertices()}function vc(e,t,n,r){uo.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],u=[],l=[],c=new vr,h=new ar;for(s.push(0,0,0),u.push(0,0,1),l.push(.5,.5),o=0,i=3;o<=t;o++,i+=3){var f=n+o/t*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),s.push(c.x,c.y,c.z),u.push(0,0,1),h.x=(s[i]/e+1)/2,h.y=(s[i+1]/e+1)/2,l.push(h.x,h.y)}for(i=1;i<=t;i++)a.push(i,i+1,0);this.setIndex(a),this.setAttribute("position",new Ki(s,3)),this.setAttribute("normal",new Ki(u,3)),this.setAttribute("uv",new Ki(l,2))}ec.prototype=(0,y.default)(Po.prototype),ec.prototype.constructor=ec,tc.prototype=(0,y.default)(Kl.prototype),tc.prototype.constructor=tc,nc.prototype=(0,y.default)(Po.prototype),nc.prototype.constructor=nc,rc.prototype=(0,y.default)(uo.prototype),rc.prototype.constructor=rc,ic.prototype=(0,y.default)(Po.prototype),ic.prototype.constructor=ic,oc.prototype=(0,y.default)(uo.prototype),oc.prototype.constructor=oc,ac.prototype=(0,y.default)(Po.prototype),ac.prototype.constructor=ac,sc.prototype=(0,y.default)(uo.prototype),sc.prototype.constructor=sc,uc.prototype=(0,y.default)(Po.prototype),uc.prototype.constructor=uc,uc.prototype.toJSON=function(){var e=Po.prototype.toJSON.call(this);return cc(this.parameters.shapes,e)},lc.prototype=(0,y.default)(uo.prototype),lc.prototype.constructor=lc,lc.prototype.toJSON=function(){var e=uo.prototype.toJSON.call(this);return cc(this.parameters.shapes,e)},hc.prototype=(0,y.default)(uo.prototype),hc.prototype.constructor=hc,fc.prototype=(0,y.default)(Po.prototype),fc.prototype.constructor=fc,dc.prototype=(0,y.default)(uo.prototype),dc.prototype.constructor=dc,pc.prototype=(0,y.default)(fc.prototype),pc.prototype.constructor=pc,gc.prototype=(0,y.default)(dc.prototype),gc.prototype.constructor=gc,mc.prototype=(0,y.default)(Po.prototype),mc.prototype.constructor=mc,vc.prototype=(0,y.default)(uo.prototype),vc.prototype.constructor=vc;var yc=(0,M.default)({__proto__:null,WireframeGeometry:sl,ParametricGeometry:ul,ParametricBufferGeometry:ll,TetrahedronGeometry:fl,TetrahedronBufferGeometry:dl,OctahedronGeometry:pl,OctahedronBufferGeometry:gl,IcosahedronGeometry:ml,IcosahedronBufferGeometry:vl,DodecahedronGeometry:yl,DodecahedronBufferGeometry:_l,PolyhedronGeometry:cl,PolyhedronBufferGeometry:hl,TubeGeometry:xl,TubeBufferGeometry:Al,TorusKnotGeometry:Il,TorusKnotBufferGeometry:wl,TorusGeometry:bl,TorusBufferGeometry:Cl,TextGeometry:ec,TextBufferGeometry:tc,SphereGeometry:nc,SphereBufferGeometry:rc,RingGeometry:ic,RingBufferGeometry:oc,PlaneGeometry:na,PlaneBufferGeometry:ra,LatheGeometry:ac,LatheBufferGeometry:sc,ShapeGeometry:uc,ShapeBufferGeometry:lc,ExtrudeGeometry:Jl,ExtrudeBufferGeometry:Kl,EdgesGeometry:hc,ConeGeometry:pc,ConeBufferGeometry:gc,CylinderGeometry:fc,CylinderBufferGeometry:dc,CircleGeometry:mc,CircleBufferGeometry:vc,BoxGeometry:Oo,BoxBufferGeometry:Do});function _c(e){zi.call(this),this.type="ShadowMaterial",this.color=new Pi(0),this.transparent=!0,this.setValues(e)}function xc(e){Vo.call(this,e),this.type="RawShaderMaterial"}function Ac(e){zi.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Pi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Tn,this.normalScale=new ar(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}function Ic(e){Ac.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ar(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(e)}function wc(e){zi.call(this),this.type="MeshPhongMaterial",this.color=new Pi(16777215),this.specular=new Pi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Tn,this.normalScale=new ar(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ae,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function bc(e){zi.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Pi(16777215),this.specular=new Pi(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Tn,this.normalScale=new ar(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Cc(e){zi.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Tn,this.normalScale=new ar(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Mc(e){zi.call(this),this.type="MeshLambertMaterial",this.color=new Pi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ae,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ec(e){zi.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Pi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Tn,this.normalScale=new ar(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Tc(e){Gu.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}_c.prototype=(0,y.default)(zi.prototype),_c.prototype.constructor=_c,_c.prototype.isShadowMaterial=!0,_c.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this},xc.prototype=(0,y.default)(Vo.prototype),xc.prototype.constructor=xc,xc.prototype.isRawShaderMaterial=!0,Ac.prototype=(0,y.default)(zi.prototype),Ac.prototype.constructor=Ac,Ac.prototype.isMeshStandardMaterial=!0,Ac.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},Ic.prototype=(0,y.default)(Ac.prototype),Ic.prototype.constructor=Ic,Ic.prototype.isMeshPhysicalMaterial=!0,Ic.prototype.copy=function(e){return Ac.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new Pi).copy(e.sheen):this.sheen=null,this.transparency=e.transparency,this},wc.prototype=(0,y.default)(zi.prototype),wc.prototype.constructor=wc,wc.prototype.isMeshPhongMaterial=!0,wc.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},bc.prototype=(0,y.default)(zi.prototype),bc.prototype.constructor=bc,bc.prototype.isMeshToonMaterial=!0,bc.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Cc.prototype=(0,y.default)(zi.prototype),Cc.prototype.constructor=Cc,Cc.prototype.isMeshNormalMaterial=!0,Cc.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Mc.prototype=(0,y.default)(zi.prototype),Mc.prototype.constructor=Mc,Mc.prototype.isMeshLambertMaterial=!0,Mc.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ec.prototype=(0,y.default)(zi.prototype),Ec.prototype.constructor=Ec,Ec.prototype.isMeshMatcapMaterial=!0,Ec.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Tc.prototype=(0,y.default)(Gu.prototype),Tc.prototype.constructor=Tc,Tc.prototype.isLineDashedMaterial=!0,Tc.prototype.copy=function(e){return Gu.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Sc=(0,M.default)({__proto__:null,ShadowMaterial:_c,SpriteMaterial:hu,RawShaderMaterial:xc,ShaderMaterial:Vo,PointsMaterial:Ju,MeshPhysicalMaterial:Ic,MeshStandardMaterial:Ac,MeshPhongMaterial:wc,MeshToonMaterial:bc,MeshNormalMaterial:Cc,MeshLambertMaterial:Mc,MeshDepthMaterial:qs,MeshDistanceMaterial:Xs,MeshBasicMaterial:Ui,MeshMatcapMaterial:Ec,LineDashedMaterial:Tc,LineBasicMaterial:Gu,Material:zi}),Lc={arraySlice:function(e,t,n){return Lc.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*t,u=0;u!==t;++u)i[a++]=e[s+u];return i},flattenJSON:function(e,t,n,r){for(var i=1,o=e[0];void 0!==o&&void 0===o[r];)o=e[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if((0,_.default)(a))for(;void 0!==(a=o[r])&&(t.push(o.time),n.push.apply(n,a)),void 0!==(o=e[i++]););else if(void 0!==a.toArray)for(;void 0!==(a=o[r])&&(t.push(o.time),a.toArray(n,n.length)),void 0!==(o=e[i++]););else for(;void 0!==(a=o[r])&&(t.push(o.time),n.push(a)),void 0!==(o=e[i++]););}},subclip:function(e,t,n,r,i){i=i||30;var o=e.clone();o.name=t;for(var a=[],s=0;s<o.tracks.length;++s){for(var u=o.tracks[s],l=u.getValueSize(),c=[],h=[],f=0;f<u.times.length;++f){var d=u.times[f]*i;if(!(d<n||r<=d)){c.push(u.times[f]);for(var p=0;p<l;++p)h.push(u.values[f*l+p])}}0!==c.length&&(u.times=Lc.convertArray(c,u.times.constructor),u.values=Lc.convertArray(h,u.values.constructor),a.push(u))}o.tracks=a;var g=1/0;for(s=0;s<o.tracks.length;++s)g>o.tracks[s].times[0]&&(g=o.tracks[s].times[0]);for(s=0;s<o.tracks.length;++s)o.tracks[s].shift(-1*g);return o.resetDuration(),o}};function kc(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Rc(e,t,n,r){kc.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Nc(e,t,n,r){kc.call(this,e,t,n,r)}function Pc(e,t,n,r){kc.call(this,e,t,n,r)}function Oc(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Lc.convertArray(t,this.TimeBufferType),this.values=Lc.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function Dc(e,t,n){Oc.call(this,e,t,n)}function Fc(e,t,n,r){Oc.call(this,e,t,n,r)}function Bc(e,t,n,r){Oc.call(this,e,t,n,r)}function Gc(e,t,n,r){kc.call(this,e,t,n,r)}function zc(e,t,n,r){Oc.call(this,e,t,n,r)}function Uc(e,t,n,r){Oc.call(this,e,t,n,r)}function Vc(e,t,n,r){Oc.call(this,e,t,n,r)}function Hc(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=or.generateUUID(),this.duration<0&&this.resetDuration()}function jc(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t,n,r=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Bc;case"vector":case"vector2":case"vector3":case"vector4":return Vc;case"color":return Fc;case"quaternion":return zc;case"bool":case"boolean":return Dc;case"string":return Uc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);return void 0===e.times&&(t=[],n=[],Lc.flattenJSON(e.keys,t,n,"value"),e.times=t,e.values=n),void 0!==r.parse?r.parse(e):new r(e.name,e.times,e.values,e.interpolation)}t.AnimationUtils=Lc,(0,m.default)(kc.prototype,{evaluate:function(e){var t,n=this.parameterPositions,r=this._cachedIndex,i=n[r],o=n[r-1];e:{t:{n:{r:if(!(e<i)){for(var a=r+2;;){if(void 0===i){if(e<o)break r;return r=n.length,this._cachedIndex=r,this.afterEnd_(r-1,e,o)}if(r===a)break;if(o=i,e<(i=n[++r]))break t}t=n.length;break n}if(o<=e)break e;var s=n[1];for(e<s&&(r=2,o=s),a=r-2;;){if(void 0===o)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(r===a)break;if(i=o,(o=n[--r-1])<=e)break t}t=r,r=0}for(;r<t;){var u=r+t>>>1;e<n[u]?t=u:r=u+1}if(i=n[r],void 0===(o=n[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return r=n.length,this._cachedIndex=r,this.afterEnd_(r-1,o,e)}this._cachedIndex=r,this.intervalChanged_(r,o,i)}return this.interpolate_(r,o,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,o=0;o!==r;++o)t[o]=n[i+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),(0,m.default)(kc.prototype,{beforeStart_:kc.prototype.copySampleValue_,afterEnd_:kc.prototype.copySampleValue_}),Rc.prototype=(0,m.default)((0,y.default)(kc.prototype),{constructor:Rc,DefaultSettings_:{endingStart:dn,endingEnd:dn},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,o=e+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case pn:i=e,a=2*t-n;break;case gn:a=t+r[i=r.length-2]-r[i+1];break;default:i=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case pn:o=e,s=2*n-t;break;case gn:o=1,s=n+r[1]-r[0];break;default:o=e-1,s=t}var u=.5*(n-t),l=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=o*l},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=s-a,l=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,f=-h*(t=(r=(n=(n-t)/(r-t))*n)*n)+2*h*r-h*n,d=(1+h)*t+(-1.5-2*h)*r+(-.5+h)*n+1,p=(-1-(e=this._weightNext))*t+(1.5+e)*r+.5*n,g=e*t-e*r,m=0;m!==a;++m)i[m]=f*o[l+m]+d*o[u+m]+p*o[s+m]+g*o[c+m];return i}}),Nc.prototype=(0,m.default)((0,y.default)(kc.prototype),{constructor:Nc,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=s-a,l=(n-t)/(r-t),c=1-l,h=0;h!==a;++h)i[h]=o[u+h]*c+o[s+h]*l;return i}}),Pc.prototype=(0,m.default)((0,y.default)(kc.prototype),{constructor:Pc,interpolate_:function(e){return this.copySampleValue_(e-1)}}),(0,m.default)(Oc,{toJSON:function(e){var t,n=e.constructor;return void 0!==n.toJSON?t=n.toJSON(e):(t={name:e.name,times:Lc.convertArray(e.times,Array),values:Lc.convertArray(e.values,Array)},(n=e.getInterpolation())!==e.DefaultInterpolation&&(t.interpolation=n)),t.type=e.ValueTypeName,t}}),(0,m.default)(Oc.prototype,{constructor:Oc,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:hn,InterpolantFactoryMethodDiscrete:function(e){return new Pc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Nc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Rc(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case cn:t=this.InterpolantFactoryMethodDiscrete;break;case hn:t=this.InterpolantFactoryMethodLinear;break;case fn:t=this.InterpolantFactoryMethodSmooth}if(void 0!==t)return this.createInterpolant=t,this;var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return cn;case this.InterpolantFactoryMethodLinear:return hn;case this.InterpolantFactoryMethodSmooth:return fn}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n,r=this.times,i=r.length,o=0,a=i-1;o!==i&&r[o]<e;)++o;for(;-1!==a&&r[a]>t;)--a;return++a,0===o&&a===i||(a<=o&&(o=(a=Math.max(a,1))-1),n=this.getValueSize(),this.times=Lc.arraySlice(r,o,a),this.values=Lc.arraySlice(this.values,o*n,a*n)),this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&s<o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==r&&Lc.isTypedArray(r)){a=0;for(var u=r.length;a!==u;++a){var l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}}return e},optimize:function(){for(var e=Lc.arraySlice(this.times),t=Lc.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===fn,i=1,o=e.length-1,a=1;a<o;++a){var s=!1,u=e[a];if(u!==e[a+1]&&(1!==a||u!==u[0]))if(r)s=!0;else for(var l=a*n,c=l-n,h=l+n,f=0;f!==n;++f){var d=t[l+f];if(d!==t[c+f]||d!==t[h+f]){s=!0;break}}if(s){if(a!==i){e[i]=e[a];var p=a*n,g=i*n;for(f=0;f!==n;++f)t[g+f]=t[p+f]}++i}}if(0<o){for(e[i]=e[o],p=o*n,g=i*n,f=0;f!==n;++f)t[g+f]=t[p+f];++i}return i!==e.length?(this.times=Lc.arraySlice(e,0,i),this.values=Lc.arraySlice(t,0,i*n)):(this.times=e,this.values=t),this},clone:function(){var e=Lc.arraySlice(this.times,0),t=Lc.arraySlice(this.values,0);return(t=new(0,this.constructor)(this.name,e,t)).createInterpolant=this.createInterpolant,t}}),Dc.prototype=(0,m.default)((0,y.default)(Oc.prototype),{constructor:Dc,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:cn,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Fc.prototype=(0,m.default)((0,y.default)(Oc.prototype),{constructor:Fc,ValueTypeName:"color"}),Bc.prototype=(0,m.default)((0,y.default)(Oc.prototype),{constructor:Bc,ValueTypeName:"number"}),Gc.prototype=(0,m.default)((0,y.default)(kc.prototype),{constructor:Gc,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=(n-t)/(r-t),l=s+a;s!==l;s+=4)pr.slerpFlat(i,0,o,s-a,o,s,u);return i}}),zc.prototype=(0,m.default)((0,y.default)(Oc.prototype),{constructor:zc,ValueTypeName:"quaternion",DefaultInterpolation:hn,InterpolantFactoryMethodLinear:function(e){return new Gc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Uc.prototype=(0,m.default)((0,y.default)(Oc.prototype),{constructor:Uc,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:cn,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Vc.prototype=(0,m.default)((0,y.default)(Oc.prototype),{constructor:Vc,ValueTypeName:"vector"}),(0,m.default)(Hc,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,o=n.length;i!==o;++i)t.push(jc(n[i]).scale(r));return new Hc(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,r=(e={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},0),i=n.length;r!==i;++r)t.push(Oc.toJSON(n[r]));return e},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,o=[],a=0;a<i;a++){var s=[];(l=[]).push((a+i-1)%i,a,(a+1)%i),s.push(0,1,0);var u=Lc.getKeyframeOrder(l),l=Lc.sortedArray(l,1,u);s=Lc.sortedArray(s,1,u),r||0!==l[0]||(l.push(i),s.push(s[0])),o.push(new Bc(".morphTargetInfluences["+t[a].name+"]",l,s).scale(1/n))}return new Hc(e,-1,o)},findByName:function(e,t){var n=e;(0,_.default)(e)||(n=e.geometry&&e.geometry.animations||e.animations);for(var r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],u=s.name.match(i);u&&1<u.length&&((u=r[l=u[1]])||(r[l]=u=[]),u.push(s))}var l,c=[];for(l in r)c.push(Hc.CreateFromMorphTargetSequence(l,r[l],t,n));return c},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){var o,a;0!==n.length&&(o=[],a=[],Lc.flattenJSON(n,o,a,r),0!==o.length&&i.push(new e(t,o,a)))},r=[],i=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],u=0;u<s.length;u++){var l=s[u].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var c,h={},f=0;f<l.length;f++)if(l[f].morphTargets)for(var d=0;d<l[f].morphTargets.length;d++)h[l[f].morphTargets[d]]=-1;for(c in h){var p=[],g=[];for(d=0;d!==l[f].morphTargets.length;++d){var m=l[f];p.push(m.time),g.push(m.morphTarget===c?1:0)}r.push(new Bc(".morphTargetInfluence["+c+"]",p,g))}o=h.length*(a||1)}else{var v=".bones["+t[u].name+"]";n(Vc,v+".position",l,"pos",r),n(zc,v+".quaternion",l,"rot",r),n(Vc,v+".scale",l,"scl",r)}}return 0===r.length?null:i=new Hc(i,o,r)}}),(0,m.default)(Hc.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Hc(this.name,this.duration,e)}});var Wc={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Yc(e,t,n){var r=this,i=!1,o=0,a=0,s=void 0,u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===i&&void 0!==r.onStart&&r.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==r.onProgress&&r.onProgress(e,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return u.push(e,t),this},this.removeHandler=function(e){return-1!==(e=u.indexOf(e))&&u.splice(e,2),this},this.getHandler=function(e){for(var t=0,n=u.length;t<n;t+=2){var r=u[t],i=u[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}}t.Cache=Wc;var qc=new Yc;function Xc(e){this.manager=void 0!==e?e:qc,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}t.DefaultLoadingManager=qc,(0,m.default)(Xc.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this}});var Zc={};function Jc(e){Xc.call(this,e)}function Kc(e){Xc.call(this,e)}function Qc(e){Xc.call(this,e)}function $c(e){Xc.call(this,e)}function eh(e){Xc.call(this,e)}function th(e){Xc.call(this,e)}function nh(e){Xc.call(this,e)}function rh(){this.type="Curve",this.arcLengthDivisions=200}function ih(e,t,n,r,i,o,a,s){rh.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function oh(e,t,n,r,i,o){ih.call(this,e,t,n,n,r,i,o),this.type="ArcCurve"}function ah(){var e=0,t=0,n=0,r=0;function i(i,o,a,s){e=i,t=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(e,t,n,r,o){i(t,n,o*(n-e),o*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,o,a,s){o=(t-e)/o-(n-e)/(o+a)+(n-t)/a,s=(n-t)/a-(r-t)/(a+s)+(r-n)/s,i(t,n,o*=a,s*=a)},calc:function(i){var o=i*i;return e+t*i+n*o+r*(o*i)}}}Jc.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:Jc,load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Wc.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;if(void 0===Zc[e]){var a=/^data:(.*?)(;base64)?,(.*)$/,s=e.match(a);if(s){var u=s[1],l=(a=!!s[2],s[3]);l=decodeURIComponent(l),a&&(l=atob(l));try{var c=(this.responseType||"").toLowerCase();switch(c){case"arraybuffer":case"blob":for(var h=new Uint8Array(l.length),f=0;f<l.length;f++)h[f]=l.charCodeAt(f);d="blob"===c?new Blob([h.buffer],{type:u}):h.buffer;break;case"document":var d=(new DOMParser).parseFromString(l,u);break;case"json":d=JSON.parse(l);break;default:d=l}setTimeout((function(){t&&t(d),i.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{Zc[e]=[],Zc[e].push({onLoad:t,onProgress:n,onError:r});var p,g=new XMLHttpRequest;for(p in g.open("GET",e,!0),g.addEventListener("load",(function(t){var n=this.response,r=Zc[e];if(delete Zc[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Wc.add(e,n);for(var o=0,a=r.length;o<a;o++){var s=r[o];s.onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(o=0,a=r.length;o<a;o++)(s=r[o]).onError&&s.onError(t);i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),g.addEventListener("progress",(function(t){for(var n=Zc[e],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(t)}}),!1),g.addEventListener("error",(function(t){var n=Zc[e];delete Zc[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),g.addEventListener("abort",(function(t){var n=Zc[e];delete Zc[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(g.responseType=this.responseType),void 0!==this.withCredentials&&(g.withCredentials=this.withCredentials),g.overrideMimeType&&g.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)g.setRequestHeader(p,this.requestHeader[p]);g.send(null)}return i.manager.itemStart(e),g}Zc[e].push({onLoad:t,onProgress:n,onError:r})},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Kc.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:Kc,load:function(e,t,n,r){var i=this,o=new Jc(i.manager);o.setPath(i.path),o.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var r=Hc.parse(e[n]);t.push(r)}return t}}),Qc.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:Qc,load:function(e,t,n,r){var i=this,o=[],a=new il;a.image=o;var s=new Jc(this.manager);function u(u){s.load(e[u],(function(e){e=i.parse(e,!0),o[u]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},6===(l+=1)&&(1===e.mipmapCount&&(a.minFilter=Ye),a.format=e.format,a.needsUpdate=!0,t&&t(a))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),(0,_.default)(e))for(var l=0,c=0,h=e.length;c<h;++c)u(c);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=Ye),a.format=n.format,a.needsUpdate=!0,t&&t(a)}),n,r);return a}}),$c.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:$c,load:function(e,t,n,r){var i=this,o=new Zo,a=new Jc(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(e,(function(e){(e=i.parse(e))&&(void 0!==e.image?o.image=e.image:void 0!==e.data&&(o.image.width=e.width,o.image.height=e.height,o.image.data=e.data),o.wrapS=void 0!==e.wrapS?e.wrapS:Ge,o.wrapT=void 0!==e.wrapT?e.wrapT:Ge,o.magFilter=void 0!==e.magFilter?e.magFilter:Ye,o.minFilter=void 0!==e.minFilter?e.minFilter:Ye,o.anisotropy=void 0!==e.anisotropy?e.anisotropy:1,void 0!==e.format&&(o.format=e.format),void 0!==e.type&&(o.type=e.type),void 0!==e.mipmaps&&(o.mipmaps=e.mipmaps,o.minFilter=Ze),1===e.mipmapCount&&(o.minFilter=Ye),o.needsUpdate=!0,t&&t(o,e))}),n,r),o}}),eh.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:eh,load:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Wc.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),Wc.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",u,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a}}),th.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:th,load:function(e,t,n,r){var i=new va,o=new eh(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(e[n],(function(e){i.images[n]=e,6==++a&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var u=0;u<e.length;++u)s(u);return i}}),nh.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:nh,load:function(e,t,n,r){var i=new cr,o=new eh(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(n){i.image=n,n=0<e.search(/\.jpe?g($|\?)/i)||0===e.search(/^data\:image\/jpeg/),i.format=n?ct:ht,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}),(0,m.default)(rh.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){return e=this.getUtoTmapping(e),this.getPoint(e,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=e;n++)o+=(t=this.getPoint(n/e)).distanceTo(i),r.push(o),i=t;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){for(var n,r=this.getLengths(),i=0,o=r.length,a=t||e*r[o-1],s=0,u=o-1;s<=u;)if((n=r[i=Math.floor(s+(u-s)/2)]-a)<0)s=i+1;else{if(!(0<n)){u=i;break}u=i-1}return r[i=u]===a?i/(o-1):(t=r[i],e=r[i+1],o=(i+(e=(a-t)/(e-=t)))/(o-1))},getTangent:function(e){var t,n=e-(t=1e-4);return n<0&&(n=0),1<(t=e+t)&&(t=1),n=this.getPoint(n),(n=(t=this.getPoint(t)).clone().sub(n)).normalize()},getTangentAt:function(e){return e=this.getUtoTmapping(e),this.getTangent(e)},computeFrenetFrames:function(e,t){for(var n,r,i=new vr,o=[],a=[],s=[],u=new vr,l=new Cr,c=0;c<=e;c++)n=c/e,o[c]=this.getTangentAt(n),o[c].normalize();a[0]=new vr,s[0]=new vr;var h=Number.MAX_VALUE,f=Math.abs(o[0].x),p=Math.abs(o[0].y),g=Math.abs(o[0].z);for(f<=h&&(h=f,i.set(1,0,0)),p<=h&&(h=p,i.set(0,1,0)),g<=h&&i.set(0,0,1),u.crossVectors(o[0],i).normalize(),a[0].crossVectors(o[0],u),s[0].crossVectors(o[0],a[0]),c=1;c<=e;c++)a[c]=a[c-1].clone(),s[c]=s[c-1].clone(),u.crossVectors(o[c-1],o[c]),u.length()>d.default&&(u.normalize(),r=Math.acos(or.clamp(o[c-1].dot(o[c]),-1,1)),a[c].applyMatrix4(l.makeRotationAxis(u,r))),s[c].crossVectors(o[c],a[c]);if(!0===t)for(r=Math.acos(or.clamp(a[0].dot(a[e]),-1,1)),r/=e,0<o[0].dot(u.crossVectors(a[0],a[e]))&&(r=-r),c=1;c<=e;c++)a[c].applyMatrix4(l.makeRotationAxis(o[c],r*c)),s[c].crossVectors(o[c],a[c]);return{tangents:o,normals:a,binormals:s}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),ih.prototype=(0,y.default)(rh.prototype),ih.prototype.constructor=ih,ih.prototype.isEllipseCurve=!0,ih.prototype.getPoint=function(e,t){for(var n=t||new ar,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<d.default;i<0;)i+=r;for(;r<i;)i-=r;i<d.default&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);return 0!==this.aRotation&&(t=Math.cos(this.aRotation),o=Math.sin(this.aRotation),s=(e=s-this.aX)*t-(a=u-this.aY)*o+this.aX,u=e*o+a*t+this.aY),n.set(s,u)},ih.prototype.copy=function(e){return rh.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ih.prototype.toJSON=function(){var e=rh.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},ih.prototype.fromJSON=function(e){return rh.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},oh.prototype=(0,y.default)(ih.prototype),oh.prototype.constructor=oh,oh.prototype.isArcCurve=!0;var sh=new vr,uh=new ah,lh=new ah,ch=new ah;function hh(e,t,n,r){rh.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=r||.5}function fh(e,t,n,r,i){var o=.5*(r-t),a=.5*(i-n);return(2*n-2*r+o+a)*(i=e*(t=e*e))+(-3*n+3*r-2*o-a)*t+o*e+n}function dh(e,t,n,r){return function(e,t){return(e=1-e)*e*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function ph(e,t,n,r,i){return function(e,t){return(e=1-e)*e*e*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function gh(e,t,n,r){rh.call(this),this.type="CubicBezierCurve",this.v0=e||new ar,this.v1=t||new ar,this.v2=n||new ar,this.v3=r||new ar}function mh(e,t,n,r){rh.call(this),this.type="CubicBezierCurve3",this.v0=e||new vr,this.v1=t||new vr,this.v2=n||new vr,this.v3=r||new vr}function vh(e,t){rh.call(this),this.type="LineCurve",this.v1=e||new ar,this.v2=t||new ar}function yh(e,t){rh.call(this),this.type="LineCurve3",this.v1=e||new vr,this.v2=t||new vr}function _h(e,t,n){rh.call(this),this.type="QuadraticBezierCurve",this.v0=e||new ar,this.v1=t||new ar,this.v2=n||new ar}function xh(e,t,n){rh.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new vr,this.v1=t||new vr,this.v2=n||new vr}function Ah(e){rh.call(this),this.type="SplineCurve",this.points=e||[]}hh.prototype=(0,y.default)(rh.prototype),hh.prototype.constructor=hh,hh.prototype.isCatmullRomCurve3=!0,hh.prototype.getPoint=function(e,t){var n,r=t||new vr,i=this.points,o=i.length,a=(o-(this.closed?0:1))*e,s=Math.floor(a),u=a-s;return this.closed?s+=0<s?0:(Math.floor(Math.abs(s)/o)+1)*o:0===u&&s===o-1&&(s=o-2,u=1),n=this.closed||0<s?i[(s-1)%o]:(sh.subVectors(i[0],i[1]).add(i[0]),sh),t=i[s%o],e=i[(s+1)%o],a=this.closed||s+2<o?i[(s+2)%o]:(sh.subVectors(i[o-1],i[o-2]).add(i[o-1]),sh),"centripetal"===this.curveType||"chordal"===this.curveType?(s="chordal"===this.curveType?.5:.25,i=Math.pow(n.distanceToSquared(t),s),(o=Math.pow(t.distanceToSquared(e),s))<1e-4&&(o=1),i<1e-4&&(i=o),(s=Math.pow(e.distanceToSquared(a),s))<1e-4&&(s=o),uh.initNonuniformCatmullRom(n.x,t.x,e.x,a.x,i,o,s),lh.initNonuniformCatmullRom(n.y,t.y,e.y,a.y,i,o,s),ch.initNonuniformCatmullRom(n.z,t.z,e.z,a.z,i,o,s)):"catmullrom"===this.curveType&&(uh.initCatmullRom(n.x,t.x,e.x,a.x,this.tension),lh.initCatmullRom(n.y,t.y,e.y,a.y,this.tension),ch.initCatmullRom(n.z,t.z,e.z,a.z,this.tension)),r.set(uh.calc(u),lh.calc(u),ch.calc(u)),r},hh.prototype.copy=function(e){rh.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},hh.prototype.toJSON=function(){var e=rh.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},hh.prototype.fromJSON=function(e){rh.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new vr).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},gh.prototype=(0,y.default)(rh.prototype),gh.prototype.constructor=gh,gh.prototype.isCubicBezierCurve=!0,gh.prototype.getPoint=function(e,t){var n=t||new ar,r=this.v0,i=this.v1,o=this.v2;return t=this.v3,n.set(ph(e,r.x,i.x,o.x,t.x),ph(e,r.y,i.y,o.y,t.y)),n},gh.prototype.copy=function(e){return rh.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},gh.prototype.toJSON=function(){var e=rh.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},gh.prototype.fromJSON=function(e){return rh.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},mh.prototype=(0,y.default)(rh.prototype),mh.prototype.constructor=mh,mh.prototype.isCubicBezierCurve3=!0,mh.prototype.getPoint=function(e,t){var n=t||new vr,r=this.v0,i=this.v1,o=this.v2;return t=this.v3,n.set(ph(e,r.x,i.x,o.x,t.x),ph(e,r.y,i.y,o.y,t.y),ph(e,r.z,i.z,o.z,t.z)),n},mh.prototype.copy=function(e){return rh.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},mh.prototype.toJSON=function(){var e=rh.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},mh.prototype.fromJSON=function(e){return rh.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},vh.prototype=(0,y.default)(rh.prototype),vh.prototype.constructor=vh,vh.prototype.isLineCurve=!0,vh.prototype.getPoint=function(e,t){return t=t||new ar,1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},vh.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},vh.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},vh.prototype.copy=function(e){return rh.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},vh.prototype.toJSON=function(){var e=rh.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},vh.prototype.fromJSON=function(e){return rh.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},yh.prototype=(0,y.default)(rh.prototype),yh.prototype.constructor=yh,yh.prototype.isLineCurve3=!0,yh.prototype.getPoint=function(e,t){return t=t||new vr,1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},yh.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},yh.prototype.copy=function(e){return rh.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},yh.prototype.toJSON=function(){var e=rh.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},yh.prototype.fromJSON=function(e){return rh.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},_h.prototype=(0,y.default)(rh.prototype),_h.prototype.constructor=_h,_h.prototype.isQuadraticBezierCurve=!0,_h.prototype.getPoint=function(e,t){var n=t||new ar,r=this.v0,i=this.v1;return t=this.v2,n.set(dh(e,r.x,i.x,t.x),dh(e,r.y,i.y,t.y)),n},_h.prototype.copy=function(e){return rh.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},_h.prototype.toJSON=function(){var e=rh.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},_h.prototype.fromJSON=function(e){return rh.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},xh.prototype=(0,y.default)(rh.prototype),xh.prototype.constructor=xh,xh.prototype.isQuadraticBezierCurve3=!0,xh.prototype.getPoint=function(e,t){var n=t||new vr,r=this.v0,i=this.v1;return t=this.v2,n.set(dh(e,r.x,i.x,t.x),dh(e,r.y,i.y,t.y),dh(e,r.z,i.z,t.z)),n},xh.prototype.copy=function(e){return rh.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},xh.prototype.toJSON=function(){var e=rh.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},xh.prototype.fromJSON=function(e){return rh.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ah.prototype=(0,y.default)(rh.prototype),Ah.prototype.constructor=Ah,Ah.prototype.isSplineCurve=!0,Ah.prototype.getPoint=function(e,t){var n=t||new ar,r=this.points,i=(o=(r.length-1)*e)-(a=Math.floor(o)),o=(t=r[0===a?a:a-1],e=r[a],r[a>r.length-2?r.length-1:a+1]),a=r[a>r.length-3?r.length-1:a+2];return n.set(fh(i,t.x,e.x,o.x,a.x),fh(i,t.y,e.y,o.y,a.y)),n},Ah.prototype.copy=function(e){rh.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},Ah.prototype.toJSON=function(){var e=rh.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e},Ah.prototype.fromJSON=function(e){rh.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new ar).fromArray(r))}return this};var Ih=(0,M.default)({__proto__:null,ArcCurve:oh,CatmullRomCurve3:hh,CubicBezierCurve:gh,CubicBezierCurve3:mh,EllipseCurve:ih,LineCurve:vh,LineCurve3:yh,QuadraticBezierCurve:_h,QuadraticBezierCurve3:xh,SplineCurve:Ah});function wh(){rh.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function bh(e){wh.call(this),this.type="Path",this.currentPoint=new ar,e&&this.setFromPoints(e)}function Ch(e){bh.call(this,e),this.uuid=or.generateUUID(),this.type="Shape",this.holes=[]}function Mh(e,t){Hr.call(this),this.type="Light",this.color=new Pi(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Eh(e,t,n){Mh.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Hr.DefaultUp),this.updateMatrix(),this.groundColor=new Pi(t)}function Th(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new ar(512,512),this.map=null,this.mapPass=null,this.matrix=new Cr,this._frustum=new Qo,this._frameExtents=new ar(1,1),this._viewportCount=1,this._viewports=[new hr(0,0,1,1)]}function Sh(){Th.call(this,new jo(50,1,.5,500))}function Lh(e,t,n,r,i,o){Mh.call(this,e,t),this.type="SpotLight",this.position.copy(Hr.DefaultUp),this.updateMatrix(),this.target=new Hr,(0,g.default)(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Sh}function kh(){Th.call(this,new jo(90,1,.5,500)),this._frameExtents=new ar(4,2),this._viewportCount=6,this._viewports=[new hr(2,1,1,1),new hr(0,1,1,1),new hr(3,1,1,1),new hr(1,1,1,1),new hr(3,0,1,1),new hr(1,0,1,1)],this._cubeDirections=[new vr(1,0,0),new vr(-1,0,0),new vr(0,0,1),new vr(0,0,-1),new vr(0,1,0),new vr(0,-1,0)],this._cubeUps=[new vr(0,1,0),new vr(0,1,0),new vr(0,1,0),new vr(0,1,0),new vr(0,0,1),new vr(0,0,-1)]}function Rh(e,t,n,r){Mh.call(this,e,t),this.type="PointLight",(0,g.default)(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new kh}function Nh(e,t,n,r,i,o){Ho.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Ph(){Th.call(this,new Nh(-5,5,5,-5,.5,500))}function Oh(e,t){Mh.call(this,e,t),this.type="DirectionalLight",this.position.copy(Hr.DefaultUp),this.updateMatrix(),this.target=new Hr,this.shadow=new Ph}function Dh(e,t){Mh.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Fh(e,t,n,r){Mh.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function Bh(e){Xc.call(this,e),this.textures={}}wh.prototype=(0,m.default)((0,y.default)(rh.prototype),{constructor:wh,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new vh(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,o=this.curves[r],a=0===(a=o.getLength())?0:1-i/a;return o.getPointAt(a)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),u=0;u<s.length;u++){var l=s[u];t&&t.equals(l)||(n.push(l),t=l)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){rh.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=rh.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){rh.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push((new Ih[r.type]).fromJSON(r))}return this}}),bh.prototype=(0,m.default)((0,y.default)(wh.prototype),{constructor:bh,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){var n=new vh(this.currentPoint.clone(),new ar(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,n,r){return t=new _h(this.currentPoint.clone(),new ar(e,t),new ar(n,r)),this.curves.push(t),this.currentPoint.set(n,r),this},bezierCurveTo:function(e,t,n,r,i,o){return r=new gh(this.currentPoint.clone(),new ar(e,t),new ar(n,r),new ar(i,o)),this.curves.push(r),this.currentPoint.set(i,o),this},splineThru:function(e){var t=new Ah(t=[this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+a,t+s,n,r,i,o),this},absarc:function(e,t,n,r,i,o){return this.absellipse(e,t,n,n,r,i,o),this},ellipse:function(e,t,n,r,i,o,a,s){var u=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(e+u,t+l,n,r,i,o,a,s),this},absellipse:function(e,t,n,r,i,o,a,s){return a=new ih(e,t,n,r,i,o,a,s),0<this.curves.length&&((s=a.getPoint(0)).equals(this.currentPoint)||this.lineTo(s.x,s.y)),this.curves.push(a),a=a.getPoint(1),this.currentPoint.copy(a),this},copy:function(e){return wh.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=wh.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return wh.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Ch.prototype=(0,m.default)((0,y.default)(bh.prototype),{constructor:Ch,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){bh.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){var e=bh.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){bh.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push((new bh).fromJSON(r))}return this}}),Mh.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:Mh,isLight:!0,copy:function(e){return Hr.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){return(e=Hr.prototype.toJSON.call(this,e)).object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Eh.prototype=(0,m.default)((0,y.default)(Mh.prototype),{constructor:Eh,isHemisphereLight:!0,copy:function(e){return Mh.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),(0,m.default)(Th.prototype,{_projScreenMatrix:new Cr,_lightPositionWorld:new vr,_lookTarget:new vr,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(e.matrixWorld),t.position.copy(o),i.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(i),t.updateMatrixWorld(),r.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Sh.prototype=(0,m.default)((0,y.default)(Th.prototype),{constructor:Sh,isSpotLightShadow:!0,updateMatrices:function(e){var t=this.camera,n=2*or.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),Th.prototype.updateMatrices.call(this,e)}}),Lh.prototype=(0,m.default)((0,y.default)(Mh.prototype),{constructor:Lh,isSpotLight:!0,copy:function(e){return Mh.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),kh.prototype=(0,m.default)((0,y.default)(Th.prototype),{constructor:kh,isPointLightShadow:!0,updateMatrices:function(e,t){void 0===t&&(t=0);var n=this.camera,r=this.matrix,i=this._lightPositionWorld,o=this._lookTarget,a=this._projScreenMatrix;i.setFromMatrixPosition(e.matrixWorld),n.position.copy(i),o.copy(n.position),o.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(o),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),a.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a)}}),Rh.prototype=(0,m.default)((0,y.default)(Mh.prototype),{constructor:Rh,isPointLight:!0,copy:function(e){return Mh.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Nh.prototype=(0,m.default)((0,y.default)(Ho.prototype),{constructor:Nh,isOrthographicCamera:!0,copy:function(e,t){return Ho.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:(0,m.default)({},e.view),this},setViewOffset:function(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,o=n+e;n=r+t,e=r-t,null!==this.view&&this.view.enabled&&(r=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom,o=(i+=r*this.view.offsetX)+r*this.view.width,e=(n-=t*this.view.offsetY)-t*this.view.height),this.projectionMatrix.makeOrthographic(i,o,n,e,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return(e=Hr.prototype.toJSON.call(this,e)).object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=(0,m.default)({},this.view)),e}}),Ph.prototype=(0,m.default)((0,y.default)(Th.prototype),{constructor:Ph,isDirectionalLightShadow:!0,updateMatrices:function(e){Th.prototype.updateMatrices.call(this,e)}}),Oh.prototype=(0,m.default)((0,y.default)(Mh.prototype),{constructor:Oh,isDirectionalLight:!0,copy:function(e){return Mh.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Dh.prototype=(0,m.default)((0,y.default)(Mh.prototype),{constructor:Dh,isAmbientLight:!0}),Fh.prototype=(0,m.default)((0,y.default)(Mh.prototype),{constructor:Fh,isRectAreaLight:!0,copy:function(e){return Mh.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){return(e=Mh.prototype.toJSON.call(this,e)).object.width=this.width,e.object.height=this.height,e}}),Bh.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:Bh,load:function(e,t,n,r){var i=this,o=new Jc(i.manager);o.setPath(i.path),o.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r,i=new Sc[e.type];if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=(new Pi).setHex(e.sheen)),void 0!==e.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(i.skinning=e.skinning),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(i.morphNormals=e.morphNormals),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.vertexTangents&&(i.vertexTangents=e.vertexTangents),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?i.vertexColors=0<e.vertexColors:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var o in e.uniforms){var a=e.uniforms[o];switch(i.uniforms[o]={},a.type){case"t":i.uniforms[o].value=n(a.value);break;case"c":i.uniforms[o].value=(new Pi).setHex(a.value);break;case"v2":i.uniforms[o].value=(new ar).fromArray(a.value);break;case"v3":i.uniforms[o].value=(new vr).fromArray(a.value);break;case"v4":i.uniforms[o].value=(new hr).fromArray(a.value);break;case"m3":i.uniforms[o].value=(new sr).fromArray(a.value);case"m4":i.uniforms[o].value=(new Cr).fromArray(a.value);break;default:i.uniforms[o].value=a.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var s in e.extensions)i.extensions[s]=e.extensions[s];return void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale&&(r=e.normalScale,!1===(0,_.default)(r)&&(r=[r,r]),i.normalScale=(new ar).fromArray(r)),void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new ar).fromArray(e.clearcoatNormalScale)),i},setTextures:function(e){return this.textures=e,this}});var Gh={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function zh(){uo.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Uh(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Hi.call(this,e,t,n),this.meshPerAttribute=r||1}function Vh(e){Xc.call(this,e)}t.LoaderUtils=Gh,zh.prototype=(0,m.default)((0,y.default)(uo.prototype),{constructor:zh,isInstancedBufferGeometry:!0,copy:function(e){return uo.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=uo.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),Uh.prototype=(0,m.default)((0,y.default)(Hi.prototype),{constructor:Uh,isInstancedBufferAttribute:!0,copy:function(e){return Hi.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=Hi.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Vh.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:Vh,load:function(e,t,n,r){var i=this,o=new Jc(i.manager);o.setPath(i.path),o.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){var t=new(e.isInstancedBufferGeometry?zh:uo),n=e.data.index;void 0!==n&&(o=new Hh[n.type](n.array),t.setIndex(new Hi(o,1)));var r=e.data.attributes;for(u in r){var i=r[u],o=new Hh[i.type](i.array),a=new(i.isInstancedBufferAttribute?Uh:Hi)(o,i.itemSize,i.normalized);void 0!==i.name&&(a.name=i.name),t.setAttribute(u,a)}var s=e.data.morphAttributes;if(s)for(var u in s){for(var l=s[u],c=[],h=0,f=l.length;h<f;h++)i=l[h],a=new Hi(o=new Hh[i.type](i.array),i.itemSize,i.normalized),void 0!==i.name&&(a.name=i.name),c.push(a);t.morphAttributes[u]=c}var d=e.data.morphTargetsRelative;d&&(t.morphTargetsRelative=!0);var p=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==p){h=0;for(var g=p.length;h!==g;++h){var m=p[h];t.addGroup(m.start,m.count,m.materialIndex)}}return void 0!==(n=e.data.boundingSphere)&&(d=new vr,void 0!==n.center&&d.fromArray(n.center),t.boundingSphere=new si(d,n.radius)),e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t}});var Hh={Int8Array,Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function jh(e){Xc.call(this,e)}jh.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:jh,load:function(e,t,n,r){var i=this,o=""===this.path?Gh.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o,(o=new Jc(i.manager)).setPath(this.path),o.load(e,(function(n){var o=null;try{o=JSON.parse(n)}catch(n){return void 0!==r&&r(n),void console.error("THREE:ObjectLoader: Can't parse "+e+".",n.message)}void 0!==(n=o.metadata)&&void 0!==n.type&&"geometry"!==n.type.toLowerCase()?i.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)},parse:function(e,t){var n=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,n),i=(n=this.parseImages(e.images,(function(){void 0!==t&&t(i)})),n=this.parseTextures(e.textures,n),n=this.parseMaterials(e.materials,n),this.parseObject(e.object,r,n));return e.animations&&(i.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(i),i},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Ch).fromJSON(e[n]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var r=new Vh,i=0,o=e.length;i<o;i++){var a,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new yc[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new yc[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new yc[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new yc[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new yc[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new yc[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new yc[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new yc[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new yc[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new yc[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new yc[s.type]((new Ih[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new yc[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new yc[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],l=0,c=s.shapes.length;l<c;l++){var h=t[s.shapes[l]];u.push(h)}a=new yc[s.type](u,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(u=[],l=0,c=s.shapes.length;l<c;l++)h=t[s.shapes[l]],u.push(h);var f=s.options.extrudePath;void 0!==f&&(s.options.extrudePath=(new Ih[f.type]).fromJSON(f)),a=new yc[s.type](u,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}return n},parseMaterials:function(e,t){var n={},r={};if(void 0!==e){var i=new Bh;i.setTextures(t);for(var o=0,a=e.length;o<a;o++){var s=e[o];if("MultiMaterial"===s.type){for(var u=[],l=0;l<s.materials.length;l++){var c=s.materials[l];void 0===n[c.uuid]&&(n[c.uuid]=i.parse(c)),u.push(n[c.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=Hc.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),t.push(i)}return t},parseImages:function(e,t){var n=this,r={};function i(e){return n.manager.itemStart(e),o.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}if(void 0!==e&&0<e.length){var o=new eh(t=new Yc(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var u=e[a],l=u.url;if((0,_.default)(l)){r[u.uuid]=[];for(var c=0,h=l.length;c<h;c++){var f=l[c],d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:n.resourcePath+f;r[u.uuid].push(i(d))}}else d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.resourcePath+u.url,r[u.uuid]=i(d)}}return r},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a,s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(a=new((0,_.default)(t[s.image])?va:cr)(t[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,Yh)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],qh),a.wrapT=n(s.wrap[1],qh)),void 0!==s.format&&(a.format=s.format),void 0!==s.type&&(a.type=s.type),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,Xh)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,Xh)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),r[s.uuid]=a}return r},parseObject:function(e,t,n){function r(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function i(e){if(void 0!==e){if((0,_.default)(e)){for(var t=[],r=0,i=e.length;r<i;r++){var o=e[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(n[o])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":o=new jr,void 0!==e.background&&(0,p.default)(e.background)&&(o.background=new Pi(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new au(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new ou(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new jo(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=(0,m.default)({},e.view));break;case"OrthographicCamera":o=new Nh(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=(0,m.default)({},e.view));break;case"AmbientLight":o=new Dh(e.color,e.intensity);break;case"DirectionalLight":o=new Oh(e.color,e.intensity);break;case"PointLight":o=new Rh(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Fh(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Lh(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new Eh(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=new Eo(a=r(e.geometry),s=i(e.material));break;case"InstancedMesh":var a=r(e.geometry),s=i(e.material),u=e.count,l=e.instanceMatrix;(o=new Bu(a,s,u)).instanceMatrix=new Hi(new Float32Array(l.array),16);break;case"LOD":o=new Tu;break;case"Line":o=new Wu(r(e.geometry),i(e.material),e.mode);break;case"LineLoop":o=new Zu(r(e.geometry),i(e.material));break;case"LineSegments":o=new Xu(r(e.geometry),i(e.material));break;case"PointCloud":case"Points":o=new tl(r(e.geometry),i(e.material));break;case"Sprite":o=new bu(i(e.material));break;case"Group":o=new nu;break;default:o=new Hr}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,h=0;h<c.length;h++)o.add(this.parseObject(c[h],t,n));if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);for(var f=e.levels,d=0;d<f.length;d++){var g=f[d],v=o.getObjectByProperty("uuid",g.object);void 0!==v&&o.addLevel(v,g.distance)}}return o}});var Wh,Yh={UVMapping:Le,CubeReflectionMapping:ke,CubeRefractionMapping:Re,EquirectangularReflectionMapping:Ne,EquirectangularRefractionMapping:Pe,SphericalReflectionMapping:Oe,CubeUVReflectionMapping:De,CubeUVRefractionMapping:Fe},qh={RepeatWrapping:Be,ClampToEdgeWrapping:Ge,MirroredRepeatWrapping:ze},Xh={NearestFilter:Ue,NearestMipmapNearestFilter:Ve,NearestMipmapLinearFilter:je,LinearFilter:Ye,LinearMipmapNearestFilter:qe,LinearMipmapLinearFilter:Ze};function Zh(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Xc.call(this,e),this.options=void 0}function Jh(){this.type="ShapePath",this.color=new Pi,this.subPaths=[],this.currentPath=null}function Kh(e){this.type="Font",this.data=e}function Qh(e,t,n,r,i){var o=i.glyphs[e]||i.glyphs["?"];if(o){var a,s,u,l,c,h,f,d,p=new Jh;if(o.o)for(var g=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),m=0,v=g.length;m<v;)switch(g[m++]){case"m":a=g[m++]*t+n,s=g[m++]*t+r,p.moveTo(a,s);break;case"l":a=g[m++]*t+n,s=g[m++]*t+r,p.lineTo(a,s);break;case"q":u=g[m++]*t+n,l=g[m++]*t+r,c=g[m++]*t+n,h=g[m++]*t+r,p.quadraticCurveTo(c,h,u,l);break;case"b":u=g[m++]*t+n,l=g[m++]*t+r,c=g[m++]*t+n,h=g[m++]*t+r,f=g[m++]*t+n,d=g[m++]*t+r,p.bezierCurveTo(c,h,f,d,u,l)}return{offsetX:o.ha*t,path:p}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}function $h(e){Xc.call(this,e)}Zh.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:Zh,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Wc.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;fetch(e).then((function(e){return e.blob()})).then((function(e){return void 0===i.options?createImageBitmap(e):createImageBitmap(e,i.options)})).then((function(n){Wc.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}),(0,m.default)(Jh.prototype,{moveTo:function(e,t){return this.currentPath=new bh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this},bezierCurveTo:function(e,t,n,r,i,o){return this.currentPath.bezierCurveTo(e,t,n,r,i,o),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],o=new Ch;o.curves=i.curves,t.push(o)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=t[i],s=t[o],u=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>d.default){if(l<0&&(a=t[o],u=-u,s=t[i],l=-l),!(e.y<a.y||e.y>s.y))if(e.y===a.y){if(e.x===a.x)return!0}else{if(0==(u=l*(e.x-a.x)-u*(e.y-a.y)))return!0;u<0||(r=!r)}}else if(e.y===a.y&&(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x))return!0}return r}var i=ql.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);var a,s,u,l=[];if(1===o.length)return s=o[0],(u=new Ch).curves=s.curves,l.push(u),l;var c,h=!i(o[0].getPoints()),f=(h=e?!h:h,[]),p=[],g=[],m=0;p[m]=void 0,g[m]=[];for(var v=0,y=o.length;v<y;v++)a=i(c=(s=o[v]).getPoints()),(a=e?!a:a)?(!h&&p[m]&&m++,p[m]={s:new Ch,p:c},p[m].s.curves=s.curves,h&&m++,g[m]=[]):g[m].push({h:s,p:c[0]});if(!p[0])return n(o);if(1<p.length){for(var _=!1,x=[],A=0,I=p.length;A<I;A++)f[A]=[];for(A=0,I=p.length;A<I;A++)for(var w=g[A],b=0;b<w.length;b++){for(var C=w[b],M=!0,E=0;E<p.length;E++)r(C.p,p[E].p)&&(A!==E&&x.push({froms:A,tos:E,hole:b}),M?(M=!1,f[E].push(C)):_=!0);M&&f[A].push(C)}0<x.length&&(_||(g=f))}v=0;for(var T=p.length;v<T;v++){u=p[v].s,l.push(u);for(var S=g[v],L=0,k=S.length;L<k;L++)u.holes.push(S[L].h)}return l}}),(0,m.default)(Kh.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var n=[],r=function(e,t,n){for(var r=E.default?(0,E.default)(e):String(e).split(""),i=t/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,u=0,l=0;l<r.length;l++){var c=r[l];"\n"===c?(s=0,u-=o):(s+=(c=Qh(c,i,s,u,n)).offsetX,a.push(c.path))}return a}(e,t,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),$h.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:$h,load:function(e,t,n,r){var i=this,o=new Jc(this.manager);o.setPath(this.path),o.load(e,(function(e){try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var n=i.parse(n);t&&t(n)}),n,r)},parse:function(e){return new Kh(e)}});var ef={getContext:function(){return void 0===Wh&&(Wh=new(window.AudioContext||window.webkitAudioContext)),Wh},setContext:function(e){Wh=e}};function tf(e){Xc.call(this,e)}function nf(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new vr)}function rf(e,t){Mh.call(this,void 0,t),this.sh=void 0!==e?e:new nf}function of(e,t,n){rf.call(this,void 0,n);var r=(new Pi).set(e);n=(new Pi).set(t),e=new vr(r.r,r.g,r.b),t=new vr(n.r,n.g,n.b),n=(r=Math.sqrt(Math.PI))*Math.sqrt(.75),this.sh.coefficients[0].copy(e).add(t).multiplyScalar(r),this.sh.coefficients[1].copy(e).sub(t).multiplyScalar(n)}function af(e,t){rf.call(this,void 0,t),e=(new Pi).set(e),this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI))}t.AudioContext=ef,tf.prototype=(0,m.default)((0,y.default)(Xc.prototype),{constructor:tf,load:function(e,t,n,r){var i=new Jc(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(e,(function(e){var n=e.slice(0);(e=ef.getContext()).decodeAudioData(n,(function(e){t(e)}))}),n,r)}}),(0,m.default)(nf.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var n=e.x,r=e.y,i=e.z;return e=this.coefficients,t.copy(e[0]).multiplyScalar(.282095),t.addScaledVector(e[1],.488603*r),t.addScaledVector(e[2],.488603*i),t.addScaledVector(e[3],.488603*n),t.addScaledVector(e[4],n*r*1.092548),t.addScaledVector(e[5],r*i*1.092548),t.addScaledVector(e[6],.315392*(3*i*i-1)),t.addScaledVector(e[7],n*i*1.092548),t.addScaledVector(e[8],.546274*(n*n-r*r)),t},getIrradianceAt:function(e,t){var n=e.x,r=e.y,i=e.z;return e=this.coefficients,t.copy(e[0]).multiplyScalar(.886227),t.addScaledVector(e[1],1.023328*r),t.addScaledVector(e[2],1.023328*i),t.addScaledVector(e[3],1.023328*n),t.addScaledVector(e[4],.858086*n*r),t.addScaledVector(e[5],.858086*r*i),t.addScaledVector(e[6],.743125*i*i-.247708),t.addScaledVector(e[7],.858086*n*i),t.addScaledVector(e[8],.429043*(n*n-r*r)),t},add:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},addScaledSH:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this},scale:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},equals:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e,t){void 0===t&&(t=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}),(0,m.default)(nf,{getBasisAt:function(e,t){var n=e.x,r=e.y;e=e.z,t[0]=.282095,t[1]=.488603*r,t[2]=.488603*e,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*e,t[6]=.315392*(3*e*e-1),t[7]=1.092548*n*e,t[8]=.546274*(n*n-r*r)}}),rf.prototype=(0,m.default)((0,y.default)(Mh.prototype),{constructor:rf,isLightProbe:!0,copy:function(e){return Mh.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return Mh.prototype.toJSON.call(this,e)}}),of.prototype=(0,m.default)((0,y.default)(rf.prototype),{constructor:of,isHemisphereLightProbe:!0,copy:function(e){return rf.prototype.copy.call(this,e),this},toJSON:function(e){return rf.prototype.toJSON.call(this,e)}}),af.prototype=(0,m.default)((0,y.default)(rf.prototype),{constructor:af,isAmbientLightProbe:!0,copy:function(e){return rf.prototype.copy.call(this,e),this},toJSON:function(e){return rf.prototype.toJSON.call(this,e)}});var sf=new Cr,uf=new Cr;function lf(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new jo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new jo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function cf(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}(0,m.default)(lf.prototype,{update:function(e){var t,n,r,i,o=this._cache,a=o.focus!==e.focus||o.fov!==e.fov||o.aspect!==e.aspect*this.aspect||o.near!==e.near||o.far!==e.far||o.zoom!==e.zoom||o.eyeSep!==this.eyeSep;a&&(o.focus=e.focus,o.fov=e.fov,o.aspect=e.aspect*this.aspect,o.near=e.near,o.far=e.far,o.zoom=e.zoom,o.eyeSep=this.eyeSep,t=e.projectionMatrix.clone(),n=(i=o.eyeSep/2)*o.near/o.focus,r=o.near*Math.tan(or.DEG2RAD*o.fov*.5)/o.zoom,uf.elements[12]=-i,sf.elements[12]=i,a=-r*o.aspect+n,i=r*o.aspect+n,t.elements[0]=2*o.near/(i-a),t.elements[8]=(i+a)/(i-a),this.cameraL.projectionMatrix.copy(t),a=-r*o.aspect-n,i=r*o.aspect-n,t.elements[0]=2*o.near/(i-a),t.elements[8]=(i+a)/(i-a),this.cameraR.projectionMatrix.copy(t)),this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(uf),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(sf)}}),(0,m.default)(cf.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e,t=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(t=((e=("undefined"==typeof performance?Date:performance).now())-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t),t)}});var hf=new vr,ff=new pr,df=new vr,pf=new vr;function gf(){Hr.call(this),this.type="AudioListener",this.context=ef.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new cf}function mf(e){Hr.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}gf.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:gf,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){Hr.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,n=this.up;this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(hf,ff,df),pf.set(0,0,-1).applyQuaternion(ff),t.positionX?(e=this.context.currentTime+this.timeDelta,t.positionX.linearRampToValueAtTime(hf.x,e),t.positionY.linearRampToValueAtTime(hf.y,e),t.positionZ.linearRampToValueAtTime(hf.z,e),t.forwardX.linearRampToValueAtTime(pf.x,e),t.forwardY.linearRampToValueAtTime(pf.y,e),t.forwardZ.linearRampToValueAtTime(pf.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)):(t.setPosition(hf.x,hf.y,hf.z),t.setOrientation(pf.x,pf.y,pf.z,n.x,n.y,n.z))}}),mf.prototype=(0,m.default)((0,y.default)(Hr.prototype),{constructor:mf,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(void 0===e&&(e=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl)return this._startedAt=this.context.currentTime+e,(e=this.context.createBufferSource()).buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect();console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e=e||[],!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var vf=new vr,yf=new pr,_f=new vr,xf=new vr;function Af(e){mf.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function If(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function wf(e,t,n){this.binding=e,this.valueSize=n;var r,i=Float64Array;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Af.prototype=(0,m.default)((0,y.default)(mf.prototype),{constructor:Af,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(e){var t;Hr.prototype.updateMatrixWorld.call(this,e),!0===this.hasPlaybackControl&&!1===this.isPlaying||(this.matrixWorld.decompose(vf,yf,_f),xf.set(0,0,1).applyQuaternion(yf),(t=this.panner).positionX?(e=this.context.currentTime+this.listener.timeDelta,t.positionX.linearRampToValueAtTime(vf.x,e),t.positionY.linearRampToValueAtTime(vf.y,e),t.positionZ.linearRampToValueAtTime(vf.z,e),t.orientationX.linearRampToValueAtTime(xf.x,e),t.orientationY.linearRampToValueAtTime(xf.y,e),t.orientationZ.linearRampToValueAtTime(xf.z,e)):(t.setPosition(vf.x,vf.y,vf.z),t.setOrientation(xf.x,xf.y,xf.z)))}}),(0,m.default)(If.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),(0,m.default)(wf.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r;if(0===(e=this.cumulativeWeight)){for(var o=0;o!==r;++o)n[i+o]=n[o];e=t}else t/=e+=t,this._mixBufferRegion(n,i,0,t,r);this.cumulativeWeight=e},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,o=this.binding;this.cumulativeWeight=0,i<1&&(e=3*t,this._mixBufferRegion(n,r,e,1-i,t));for(var a=t,s=t+t;a!==s;++a)if(n[a]!==n[a+t]){o.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=3*n;e.getValue(t,r);for(var i=n,o=r;i!==o;++i)t[i]=t[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,r,i){if(.5<=r)for(var o=0;o!==i;++o)e[t+o]=e[n+o]},_slerp:function(e,t,n,r){pr.slerpFlat(e,t,e,t,e,n,r)},_lerp:function(e,t,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[n+a]*r}}}),$n="\\[\\]\\.:\\/";var bf,Cf,Mf,Ef,Tf=new RegExp("["+$n+"]","g"),Sf=(er="[^"+$n+"]",Oo="[^"+$n.replace("\\.","")+"]",M=/((?:WC+[\/:])*)/.source.replace("WC",er),$n=/(WCOD+)?/.source.replace("WCOD",Oo),Oo=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",er),er=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",er),new RegExp("^"+M+$n+Oo+er+"$")),Lf=["material","materials","bones"];function kf(e,t,n){n=n||Rf.parseTrackName(t),this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function Rf(e,t,n){this.path=t,this.parsedPath=n||Rf.parseTrackName(t),this.node=Rf.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Nf(){this.uuid=or.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Pf(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var r=t.tracks,i=r.length,o=new Array(i),a={endingStart:dn,endingEnd:dn},s=0;s!==i;++s){var u=r[s].createInterpolant(null);o[s]=u,u.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Of(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Df(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Ff(e,t,n){su.call(this,e,t),this.meshPerAttribute=n||1}function Bf(e,t,n,r){this.ray=new gi(e,t),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new Sr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},(0,v.default)(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Gf(e,t){return e.distance-t.distance}function zf(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,o=0,a=i.length;o<a;o++)zf(i[o],t,n,!0)}function Uf(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function Vf(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}(0,m.default)(kf.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_;void 0!==(n=this._bindings[n])&&n.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),(0,m.default)(Rf,{Composite:kf,create:function(e,t,n){return new(e&&e.isAnimationObjectGroup?Rf.Composite:Rf)(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Tf,"")},parseTrackName:function(e){var t=Sf.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r&&(t=n.nodeName.substring(r+1),-1!==Lf.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t)),null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}return e.children&&(n=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;if(i=e(i.children))return i}return null},e=n(e.children))?e:null}}),(0,m.default)(Rf.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=Rf.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var o=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[r];if(void 0!==s){var u=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===i){i=a;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):(0,_.default)(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][u]}else t=t.nodeName,console.error("THREE.PropertyBinding: Trying to update property for track: "+t+"."+r+" but it wasn't found.",e)}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),(0,m.default)(Rf.prototype,{_getValue_unbound:Rf.prototype.getValue,_setValue_unbound:Rf.prototype.setValue}),(0,m.default)(Xc.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,n){for(var r=[],i=0;i<e.length;++i)r[i]=this.createMaterial(e[i],t,n);return r},createMaterial:(bf={NoBlending:W,NormalBlending:Y,AdditiveBlending:q,SubtractiveBlending:X,MultiplyBlending:Z,CustomBlending:J},Cf=new Pi,Mf=new nh,Ef=new Bh,function(e,t,n){var r={};function i(e,i,o,a,s){var u=t+e;return u=null!==(e=(e=new Yc).getHandler(u))?e.load(u):(Mf.setCrossOrigin(n),Mf.load(u)),void 0!==i&&(u.repeat.fromArray(i),1!==i[0]&&(u.wrapS=Be),1!==i[1]&&(u.wrapT=Be)),void 0!==o&&u.offset.fromArray(o),void 0!==a&&("repeat"===a[0]&&(u.wrapS=Be),"mirror"===a[0]&&(u.wrapS=ze),"repeat"===a[1]&&(u.wrapT=Be),"mirror"===a[1]&&(u.wrapT=ze)),void 0!==s&&(u.anisotropy=s),s=or.generateUUID(),r[s]=u,s}var o,a={uuid:or.generateUUID(),type:"MeshLambertMaterial"};for(o in e){var s=e[o];switch(o){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":case"colorAmbient":case"mapAmbient":case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"DbgName":a.name=s;break;case"blending":a.blending=bf[s];break;case"colorDiffuse":a.color=Cf.fromArray(s).getHex();break;case"colorSpecular":a.specular=Cf.fromArray(s).getHex();break;case"colorEmissive":a.emissive=Cf.fromArray(s).getHex();break;case"specularCoef":a.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(a.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(a.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(a.type="MeshStandardMaterial");break;case"mapDiffuse":a.map=i(s,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapEmissive":a.emissiveMap=i(s,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapLight":a.lightMap=i(s,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapAO":a.aoMap=i(s,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapBump":a.bumpMap=i(s,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":a.bumpScale=s;break;case"mapNormal":a.normalMap=i(s,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":a.normalScale=s;break;case"mapSpecular":a.specularMap=i(s,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapMetalness":a.metalnessMap=i(s,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapRoughness":a.roughnessMap=i(s,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapAlpha":a.alphaMap=i(s,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"flipSided":a.side=V;break;case"doubleSided":a.side=H;break;case"transparency":a.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":a[o]=s;break;case"vertexColors":!0===s&&(a.vertexColors=np),"face"===s&&(a.vertexColors=tp)}}return"MeshBasicMaterial"===a.type&&delete a.emissive,"MeshPhongMaterial"!==a.type&&delete a.specular,a.opacity<1&&(a.transparent=!0),Ef.setTextures(r),Ef.parse(a)})}),(0,m.default)(Nf.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,u=void 0,l=0,c=arguments.length;l!==c;++l){var h=arguments[l],f=h.uuid,d=r[f];if(void 0===d){d=t++,r[f]=d,e.push(h);for(var p=0,g=s;p!==g;++p)a[p].push(new Rf(h,i[p],o[p]))}else if(d<n){u=e[d];var m=--n,v=e[m];for(r[v.uuid]=d,e[d]=v,r[f]=m,e[m]=h,p=0,g=s;p!==g;++p){var y=a[p],_=y[m],x=y[d];y[d]=_,void 0===x&&(x=new Rf(h,i[p],o[p])),y[m]=x}}else e[d]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],u=s.uuid,l=n[u];if(void 0!==l&&t<=l){var c=t++,h=e[c];n[h.uuid]=l,e[l]=h,n[u]=c,e[c]=s;for(var f=0,d=i;f!==d;++f){var p=r[f],g=p[c],m=p[l];p[l]=g,p[c]=m}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var u=r[c=(c=arguments[a]).uuid];if(void 0!==u)if(delete r[c],u<n){var l=--n,c=e[l],h=--t,f=e[h];r[c.uuid]=u,e[u]=c,r[f.uuid]=l,e[l]=f,e.pop();for(var d=0,p=o;d!==p;++d){var g=i[d],m=g[l],v=g[h];g[u]=m,g[l]=v,g.pop()}}else for(r[(f=e[h=--t]).uuid]=u,e[u]=f,e.pop(),d=0,p=o;d!==p;++d)(g=i[d])[u]=g[h],g.pop()}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,l=this.nCachedObjects_,c=new Array(u);r=i.length,n[e]=r,o.push(e),a.push(t),i.push(c);for(var h=l,f=s.length;h!==f;++h){var d=s[h];c[h]=new Rf(d,e,t)}return c},unsubscribe_:function(e){var t,n,r,i,o,a=this._bindingsIndicesByPath,s=a[e];void 0!==s&&(t=this._paths,n=this._parsedPaths,o=(r=this._bindings)[i=r.length-1],a[e=e[i]]=s,r[s]=o,r.pop(),n[s]=n[i],n.pop(),t[s]=t[i],t.pop())}}),(0,m.default)(Pf.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){var r,i;return e.fadeOut(t),this.fadeIn(t),n&&(r=this._clip.duration,n=(i=e._clip.duration)/r,i=r/i,e.warp(1,n,t),this.warp(i,1,t)),this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;return null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o),r=o.parameterPositions,o=o.sampleValues,r[0]=i,r[1]=i+n,o[0]=e/a,o[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){if((i=(e-i)*n)<0||0===n)return;this._startTime=null,t=n*i}t*=this._updateTimeScale(e);var o=this._updateTime(t),a=this._updateWeight(e);if(0<a)for(var s=this._interpolants,u=this._propertyBindings,l=0,c=s.length;l!==c;++l)s[l].evaluate(o),u[l].accumulate(r,a)}else this._updateWeight(e)},_updateWeight:function(e){var t,n,r=0;return this.enabled&&(r=this.weight,null!==(t=this._weightInterpolant)&&(r*=n=t.evaluate(e)[0],e>t.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1)))),this._effectiveWeight=r,r},_updateTimeScale:function(e){var t,n=0;return this.paused||(n=this.timeScale,null!==(t=this._timeScaleInterpolant)&&(n*=t.evaluate(e)[0],e>t.parameterPositions[1]&&(this.stopWarping(),0===n?this.paused=!0:this.timeScale=n))),this._effectiveTimeScale=n,n},_updateTime:function(e){var t,n=this.time+e,r=this._clip.duration,i=this.loop,o=this._loopCount,a=2202===i;if(0===e)return-1!==o&&a&&1==(1&o)?r-n:n;if(2200===i){-1===o&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r<=n)n=r;else{if(!(n<0)){this.time=n;break e}n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else if(-1===o&&(0<=e?(o=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r<=n||n<0?(n-=r*(t=Math.floor(n/r)),o+=Math.abs(t),(i=this.repetitions-o)<=0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=0<e?r:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1})):(1===i?(i=e<0,this._setEndings(i,!i,a)):this._setEndings(!1,!1,a),this._loopCount=o,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:t}))):this.time=n,a&&1==(1&o))return r-n;return n},_setEndings:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=pn,r.endingEnd=pn):(r.endingStart=e?this.zeroSlopeAtStart?pn:dn:gn,r.endingEnd=t?this.zeroSlopeAtEnd?pn:dn:gn)},_scheduleFading:function(e,t,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;return null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o),r=o.parameterPositions,o=o.sampleValues,r[0]=i,o[0]=t,r[1]=i+e,o[1]=n,this}}),Of.prototype=(0,m.default)((0,y.default)(tr.prototype),{constructor:Of,_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,u=(e=this._bindingsByRootAndName)[s];void 0===u&&(u={},e[s]=u);for(var l=0;l!==i;++l){var c=r[l],h=c.name;if(void 0!==(f=u[h]))o[l]=f;else{if(void 0!==(f=o[l])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,h));continue}var f,d=t&&t._propertyBindings[l].binding.parsedPath;++(f=new wf(Rf.create(n,h,d),c.ValueTypeName,c.getValueSize())).referenceCount,this._addInactiveBinding(f,s,h),o[l]=f}a[l].resultBuffer=f.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){var t,n,r;null===e._cacheIndex&&(t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n],this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t));for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){return null!==(e=e._cacheIndex)&&e<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,o=i[t];void 0===o?(o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o):(t=o.knownActions,e._byClipCacheIndex=t.length,t.push(e)),e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=(a=this._actions)[a.length-1],n=e._cacheIndex;t._cacheIndex=n,a[n]=t,a.pop(),e._cacheIndex=null;var r=e._clip.uuid,i=this._actionsByClip,o=i[r],a=(t=(n=o.knownActions)[n.length-1],e._byClipCacheIndex);t._byClipCacheIndex=a,n[a]=t,n.pop(),e._byClipCacheIndex=null,delete(t=o.actionByRoot)[o=(e._localRoot||this._root).uuid],0===n.length&&delete i[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=r[t],o=this._bindings;void 0===i&&(i={},r[t]=i),i[n]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=(a=e.binding).rootNode.uuid,r=a.path,i=this._bindingsByRootAndName,o=i[n],a=t[t.length-1];e=e._cacheIndex,a._cacheIndex=e,t[e]=a,t.pop(),delete o[r],0===(0,w.default)(o).length&&delete i[n]},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Nc(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=(a=t||this._root).uuid,r="string"==typeof e?Hc.findByName(a,e):e,i=null!==r?r.uuid:e,o=this._actionsByClip[i],a=null;if(void 0!==o){if(void 0!==(e=o.actionByRoot[n]))return e;a=o.knownActions[0],null===r&&(r=a._clip)}return null===r?null:(t=new Pf(this,r,t),this._bindAction(t,a),this._addInactiveAction(t,i,n),t)},existingAction:function(e,t){var n;return t=(n=t||this._root).uuid,e=(n="string"==typeof e?Hc.findByName(n,e):e)?n.uuid:e,void 0!==(e=this._actionsByClip[e])&&e.actionByRoot[t]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==n;++a)t[a]._update(r,e,i,o);var s=this._bindings,u=this._nActiveBindings;for(a=0;a!==u;++a)s[a].apply(o);return this},setTime:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip;if(void 0!==(e=r[n])){for(var i=e.knownActions,o=0,a=i.length;o!==a;++o){var s=i[o];this._deactivateAction(s);var u=s._cacheIndex,l=t[t.length-1];s._cacheIndex=null,s._byClipCacheIndex=null,l._cacheIndex=u,t[u]=l,t.pop(),this._removeInactiveBindingsForAction(s)}delete r[n]}},uncacheRoot:function(e){var t,n=e.uuid,r=this._actionsByClip;for(t in r){var i;void 0!==(i=(i=r[t].actionByRoot)[n])&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=(e=this._bindingsByRootAndName)[n];if(void 0!==o)for(var a in o)(a=o[a]).restoreOriginalState(),this._removeInactiveBinding(a)},uncacheAction:function(e,t){null!==(t=this.existingAction(e,t))&&(this._deactivateAction(t),this._removeInactiveAction(t))}}),Df.prototype.clone=function(){return new Df(void 0===this.value.clone?this.value:this.value.clone())},Ff.prototype=(0,m.default)((0,y.default)(su.prototype),{constructor:Ff,isInstancedInterleavedBuffer:!0,copy:function(e){return su.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),(0,m.default)(Bf.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){return zf(e,this,n=n||[],t),n.sort(Gf),n},intersectObjects:function(e,t,n){var r=n||[];if(!1===(0,_.default)(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=e.length;i<o;i++)zf(e[i],this,r,t);return r.sort(Gf),r}}),(0,m.default)(Uf.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(or.clamp(t/this.radius,-1,1))),this}}),(0,m.default)(Vf.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}});var Hf=new ar;function jf(e,t){this.min=void 0!==e?e:new ar(1/0,1/0),this.max=void 0!==t?t:new ar(-1/0,-1/0)}(0,m.default)(jf.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){return t=Hf.copy(t).multiplyScalar(.5),this.min.copy(e).sub(t),this.max.copy(e).add(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new ar),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new ar),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new ar),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new ar),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return Hf.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Wf=new vr,Yf=new vr;function qf(e,t){this.start=void 0!==e?e:new vr,this.end=void 0!==t?t:new vr}function Xf(e){Hr.call(this),this.material=e,this.render=function(){}}(0,m.default)(qf.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new vr),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new vr),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new vr),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){Wf.subVectors(e,this.start),Yf.subVectors(this.end,this.start);var n=Yf.dot(Yf);return n=(e=Yf.dot(Wf))/n,t&&(n=or.clamp(n,0,1)),n},closestPointToPoint:function(e,t,n){return t=this.closestPointToPointParameter(e,t),void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new vr),this.delta(n).multiplyScalar(t).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Xf.prototype=(0,y.default)(Hr.prototype),Xf.prototype.constructor=Xf,Xf.prototype.isImmediateRenderObject=!0;var Zf=new vr;function Jf(e,t){Hr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,e=new uo;for(var n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,i=1;r<32;r++,i++){var o=r/32*Math.PI*2,a=i/32*Math.PI*2;n.push(Math.cos(o),Math.sin(o),1,Math.cos(a),Math.sin(a),1)}e.setAttribute("position",new Ki(n,3)),t=new Gu({fog:!1,toneMapped:!1}),this.cone=new Xu(e,t),this.add(this.cone),this.update()}Jf.prototype=(0,y.default)(Hr.prototype),Jf.prototype.constructor=Jf,Jf.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Jf.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance||1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Zf.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Zf),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Kf=new vr,Qf=new Cr,$f=new Cr;function ed(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,ed(e.children[n]));return t}function td(e){for(var t=ed(e),n=new uo,r=[],i=[],o=new Pi(0,0,1),a=new Pi(0,1,0),s=0;s<t.length;s++){var u=t[s];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.setAttribute("position",new Ki(r,3)),n.setAttribute("color",new Ki(i,3));var l=new Gu({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Xu.call(this,n,l),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function nd(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n,n=new rc(t,4,2),t=new Ui({wireframe:!0,fog:!1,toneMapped:!1}),Eo.call(this,n,t),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}td.prototype=(0,y.default)(Xu.prototype),td.prototype.constructor=td,td.prototype.isSkeletonHelper=!0,td.prototype.updateMatrixWorld=function(e){var t=this.bones,n=this.geometry,r=n.getAttribute("position");$f.getInverse(this.root.matrixWorld);for(var i=0,o=0;i<t.length;i++){var a=t[i];a.parent&&a.parent.isBone&&(Qf.multiplyMatrices($f,a.matrixWorld),Kf.setFromMatrixPosition(Qf),r.setXYZ(o,Kf.x,Kf.y,Kf.z),Qf.multiplyMatrices($f,a.parent.matrixWorld),Kf.setFromMatrixPosition(Qf),r.setXYZ(o+1,Kf.x,Kf.y,Kf.z),o+=2)}n.getAttribute("position").needsUpdate=!0,Hr.prototype.updateMatrixWorld.call(this,e)},nd.prototype=(0,y.default)(Eo.prototype),nd.prototype.constructor=nd,nd.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},nd.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var rd=new vr,id=new Pi,od=new Pi;function ad(e,t,n){Hr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,(n=new gl(t)).rotateY(.5*Math.PI),this.material=new Ui({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0),t=n.getAttribute("position"),t=new Float32Array(3*t.count),n.setAttribute("color",new Hi(t,3)),this.add(new Eo(n,this.material)),this.update()}function sd(e,t,n,r){e=e||10,t=t||10,n=new Pi(void 0!==n?n:4473924),r=new Pi(void 0!==r?r:8947848);for(var i=t/2,o=e/t,a=e/2,s=[],u=[],l=0,c=0,h=-a;l<=t;l++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var f=l===i?n:r;f.toArray(u,c),c+=3,f.toArray(u,c),c+=3,f.toArray(u,c),c+=3,f.toArray(u,c),c+=3}var d=new uo;d.setAttribute("position",new Ki(s,3)),d.setAttribute("color",new Ki(u,3)),e=new Gu({vertexColors:!0,toneMapped:!1}),Xu.call(this,d,e)}function ud(e,t,n,r,i,o){e=e||10,t=t||16,n=n||8,r=r||64,i=new Pi(void 0!==i?i:4473924),o=new Pi(void 0!==o?o:8947848);for(var a,s,u,l,c,h,f=[],d=[],p=0;p<=t;p++)u=p/t*(2*Math.PI),a=Math.sin(u)*e,s=Math.cos(u)*e,f.push(0,0,0),f.push(a,0,s),h=1&p?i:o,d.push(h.r,h.g,h.b),d.push(h.r,h.g,h.b);for(p=0;p<=n;p++)for(h=1&p?i:o,c=e-e/n*p,l=0;l<r;l++)u=l/r*(2*Math.PI),a=Math.sin(u)*c,s=Math.cos(u)*c,f.push(a,0,s),d.push(h.r,h.g,h.b),u=(l+1)/r*(2*Math.PI),a=Math.sin(u)*c,s=Math.cos(u)*c,f.push(a,0,s),d.push(h.r,h.g,h.b);var g=new uo;g.setAttribute("position",new Ki(f,3)),g.setAttribute("color",new Ki(d,3));var m=new Gu({vertexColors:!0,toneMapped:!1});Xu.call(this,g,m)}ad.prototype=(0,y.default)(Hr.prototype),ad.prototype.constructor=ad,ad.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ad.prototype.update=function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");id.copy(this.light.color),od.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?id:od;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(rd.setFromMatrixPosition(this.light.matrixWorld).negate())},sd.prototype=(0,m.default)((0,y.default)(Xu.prototype),{constructor:sd,copy:function(e){return Xu.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),ud.prototype=(0,y.default)(Xu.prototype),ud.prototype.constructor=ud;var ld=new vr,cd=new vr,hd=new vr;function fd(e,t,n){Hr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1),(n=new uo).setAttribute("position",new Ki([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3)),t=new Gu({fog:!1,toneMapped:!1}),this.lightPlane=new Wu(n,t),this.add(this.lightPlane),(n=new uo).setAttribute("position",new Ki([0,0,0,0,0,1],3)),this.targetLine=new Wu(n,t),this.add(this.targetLine),this.update()}fd.prototype=(0,y.default)(Hr.prototype),fd.prototype.constructor=fd,fd.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},fd.prototype.update=function(){ld.setFromMatrixPosition(this.light.matrixWorld),cd.setFromMatrixPosition(this.light.target.matrixWorld),hd.subVectors(cd,ld),this.lightPlane.lookAt(cd),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(cd),this.targetLine.scale.z=hd.length()};var dd=new vr,pd=new Ho;function gd(e){var t=new uo,n=new Gu({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={},a=new Pi(16755200),s=new Pi(16711680),u=new Pi(43775),l=new Pi(16777215),c=new Pi(3355443);function h(e,t,n){f(e,n),f(t,n)}function f(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(r.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",u),h("u2","u3",u),h("u3","u1",u),h("c","t",l),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),t.setAttribute("position",new Ki(r,3)),t.setAttribute("color",new Ki(i,3)),Xu.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function md(e,t,n,r,i,o,a){dd.set(i,o,a).unproject(r);var s=t[e];if(void 0!==s)for(var u=n.getAttribute("position"),l=0,c=s.length;l<c;l++)u.setXYZ(s[l],dd.x,dd.y,dd.z)}gd.prototype=(0,y.default)(Xu.prototype),gd.prototype.constructor=gd,gd.prototype.update=function(){var e=this.geometry,t=this.pointMap;pd.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),md("c",t,e,pd,0,0,-1),md("t",t,e,pd,0,0,1),md("n1",t,e,pd,-1,-1,-1),md("n2",t,e,pd,1,-1,-1),md("n3",t,e,pd,-1,1,-1),md("n4",t,e,pd,1,1,-1),md("f1",t,e,pd,-1,-1,1),md("f2",t,e,pd,1,-1,1),md("f3",t,e,pd,-1,1,1),md("f4",t,e,pd,1,1,1),md("u1",t,e,pd,.7,1.1,-1),md("u2",t,e,pd,-.7,1.1,-1),md("u3",t,e,pd,0,2,-1),md("cf1",t,e,pd,-1,0,1),md("cf2",t,e,pd,1,0,1),md("cf3",t,e,pd,0,-1,1),md("cf4",t,e,pd,0,1,1),md("cn1",t,e,pd,-1,0,-1),md("cn2",t,e,pd,1,0,-1),md("cn3",t,e,pd,0,-1,-1),md("cn4",t,e,pd,0,1,-1),e.getAttribute("position").needsUpdate=!0};var vd=new ii;function yd(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24);(e=new uo).setIndex(new Hi(n,1)),e.setAttribute("position",new Hi(r,3)),Xu.call(this,e,new Gu({color:t,toneMapped:!1})),this.matrixAutoUpdate=!1,this.update()}function _d(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);(e=new uo).setIndex(new Hi(n,1)),e.setAttribute("position",new Ki([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Xu.call(this,e,new Gu({color:t,toneMapped:!1})),this.geometry.computeBoundingSphere()}function xd(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t,e=void 0!==n?n:16776960,t=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],(n=new uo).setAttribute("position",new Ki(t,3)),n.computeBoundingSphere(),Wu.call(this,n,new Gu({color:e,toneMapped:!1})),t=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],(n=new uo).setAttribute("position",new Ki(t,3)),n.computeBoundingSphere(),this.add(new Eo(n,new Ui({color:e,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}yd.prototype=(0,y.default)(Xu.prototype),yd.prototype.constructor=yd,yd.prototype.update=function(e){var t,n,r;void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&vd.setFromObject(this.object),vd.isEmpty()||(t=vd.min,n=vd.max,(e=(r=this.geometry.attributes.position).array)[0]=n.x,e[1]=n.y,e[2]=n.z,e[3]=t.x,e[4]=n.y,e[5]=n.z,e[6]=t.x,e[7]=t.y,e[8]=n.z,e[9]=n.x,e[10]=t.y,e[11]=n.z,e[12]=n.x,e[13]=n.y,e[14]=t.z,e[15]=t.x,e[16]=n.y,e[17]=t.z,e[18]=t.x,e[19]=t.y,e[20]=t.z,e[21]=n.x,e[22]=t.y,e[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere())},yd.prototype.setFromObject=function(e){return this.object=e,this.update(),this},yd.prototype.copy=function(e){return Xu.prototype.copy.call(this,e),this.object=e.object,this},yd.prototype.clone=function(){return(new this.constructor).copy(this)},_d.prototype=(0,y.default)(Xu.prototype),_d.prototype.constructor=_d,_d.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Hr.prototype.updateMatrixWorld.call(this,e))},xd.prototype=(0,y.default)(Wu.prototype),xd.prototype.constructor=xd,xd.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?V:U,this.lookAt(this.plane.normal),Hr.prototype.updateMatrixWorld.call(this,e)};var Ad,Id,wd=new vr;function bd(e,t,n,r,i,o){Hr.call(this),void 0===e&&(e=new vr(0,0,1)),void 0===t&&(t=new vr(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===Ad&&((Ad=new uo).setAttribute("position",new Ki([0,0,0,0,1,0],3)),(Id=new dc(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Wu(Ad,new Gu({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Eo(Id,new Ui({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,o)}function Cd(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1];(e=new uo).setAttribute("position",new Ki(t,3)),e.setAttribute("color",new Ki(n,3)),n=new Gu({vertexColors:!0,toneMapped:!1}),Xu.call(this,e,n)}bd.prototype=(0,y.default)(Hr.prototype),bd.prototype.constructor=bd,bd.prototype.setDirection=function(e){.99999<e.y?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(wd.set(e.z,0,-e.x).normalize(),e=Math.acos(e.y),this.quaternion.setFromAxisAngle(wd,e))},bd.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},bd.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},bd.prototype.copy=function(e){return Hr.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},bd.prototype.clone=function(){return(new this.constructor).copy(this)},Cd.prototype=(0,y.default)(Xu.prototype),Cd.prototype.constructor=Cd;var Md=4,Ed=8,Td=Math.pow(2,Ed),Sd=[.125,.215,.35,.446,.526,.582],Ld=Ed-Md+1+Sd.length,kd=20,Rd=(Oo={},(0,s.default)(Oo,yn,0),(0,s.default)(Oo,_n,1),(0,s.default)(Oo,An,2),(0,s.default)(Oo,wn,3),(0,s.default)(Oo,bn,4),(0,s.default)(Oo,Cn,5),(0,s.default)(Oo,xn,6),Oo),Nd=new Nh,Pd=function(e){var t=new Float32Array(e),n=new vr(0,1,0);return(n=new xc({defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:Rd[yn]},outputEncoding:{value:Rd[yn]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:W,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",n}(kd),Od=null,Dd=null,Fd=(er=function(){for(var e=[],t=[],n=[],r=Ed,i=0;i<Ld;i++){var o=Math.pow(2,r);t.push(o);var a=1/o;Ed-Md<i?a=Sd[i-Ed+Md-1]:0==i&&(a=0),n.push(a);for(var s=[o=-(a=1/(o-1))/2,o,a=1+a/2,o,a,a,o,o,a,a,o,a],u=new Float32Array(108),l=new Float32Array(72),c=new Float32Array(36),h=0;h<6;h++){var f=h%3*2/3-1,d=[f,d=2<h?0:-1,0,f+2/3,d,0,f+2/3,d+1,0,f,d,0,f+2/3,d+1,0,f,d+1,0];u.set(d,18*h),l.set(s,12*h),d=[h,h,h,h,h,h],c.set(d,6*h)}(a=new uo).setAttribute("position",new Hi(u,3)),a.setAttribute("uv",new Hi(l,2)),a.setAttribute("faceIndex",new Hi(c,1)),e.push(a),Md<r&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}(),er._lodPlanes),Bd=er._sizeLods,Gd=er._sigmas,zd=null,Ud=null,Vd=null,Hd=(er=1/(Oo=(1+Math.sqrt(5))/2),[new vr(1,1,1),new vr(-1,1,1),new vr(1,1,-1),new vr(-1,1,-1),new vr(0,Oo,er),new vr(0,Oo,-er),new vr(er,0,Oo),new vr(-er,0,Oo),new vr(Oo,er,0),new vr(-Oo,er,0)]);function jd(e){Ud=e,qd(Pd)}function Wd(e){var t={magFilter:Ue,minFilter:Ue,generateMipmaps:!1,type:e?e.type:Ke,format:e?e.format:pt,encoding:e?e.encoding:An,depthBuffer:!1,stencilBuffer:!1},n=Xd(t);return n.depthBuffer=!e,zd=Xd(t),n}function Yd(e){zd.dispose(),Ud.setRenderTarget(Vd),e.scissorTest=!1,e.setSize(e.width,e.height)}function qd(e){var t=new jr;t.add(new Eo(Fd[0],e)),Ud.compile(t,Nd)}function Xd(e){return(e=new fr(3*Td,3*Td,e)).texture.mapping=De,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Zd(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function Jd(e){var t=Ud.autoClear;Ud.autoClear=!1;for(var n=1;n<Ld;n++)Kd(e,n-1,n,Math.sqrt(Gd[n]*Gd[n]-Gd[n-1]*Gd[n-1]),Hd[(n-1)%Hd.length]);Ud.autoClear=t}function Kd(e,t,n,r,i){Qd(e,zd,t,n,r,"latitudinal",i),Qd(zd,e,n,n,r,"longitudinal",i)}function Qd(e,t,n,r,i,o,a){"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");var s=new jr;s.add(new Eo(Fd[r],Pd));var u=Pd.uniforms,l=Bd[n]-1,c=i/(l=isFinite(i)?Math.PI/(2*l):2*Math.PI/(2*kd-1)),h=isFinite(i)?1+Math.floor(3*c):kd;kd<h&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(h," samples when the maximum is set to ").concat(kd));for(var f=[],d=0,p=0;p<kd;++p){var g=p/c,m=Math.exp(-g*g/2);f.push(m),0==p?d+=m:p<h&&(d+=2*m)}for(p=0;p<f.length;p++)f[p]=f[p]/d;u.envMap.value=e.texture,u.samples.value=h,u.weights.value=f,u.latitudinal.value="latitudinal"===o,a&&(u.poleAxis.value=a),u.dTheta.value=l,u.mipInt.value=Ed-n,u.inputEncoding.value=Rd[e.texture.encoding],u.outputEncoding.value=Rd[e.texture.encoding],e=Bd[r],Zd(t,g=3*Math.max(0,Td-2*e),r=(0===r?0:2*Td)+2*e*(Ed-Md<r?r-Ed+Md:0),3*e,2*e),Ud.setRenderTarget(t),Ud.render(s,Nd)}function $d(){var e;return(e=new xc({uniforms:{envMap:{value:null},texelSize:{value:e=new ar(1,1)},inputEncoding:{value:Rd[yn]},outputEncoding:{value:Rd[yn]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:W,depthTest:!1,depthWrite:!1})).type="EquirectangularToCubeUV",e}function ep(){var e=new xc({uniforms:{envMap:{value:null},inputEncoding:{value:Rd[yn]},outputEncoding:{value:Rd[yn]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:W,depthTest:!1,depthWrite:!1});return e.type="CubemapToCubeUV",e}jd.prototype={constructor:jd,fromScene:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.1,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:100;Vd=Ud.getRenderTarget();var i=Wd();return function(e,t,n,r){var i=new jo(90,1,t,n),o=[1,1,1,1,-1,1],a=[1,1,-1,-1,-1,1],s=Ud.outputEncoding,u=Ud.toneMapping,l=Ud.toneMappingExposure,c=Ud.getClearColor(),h=Ud.getClearAlpha();Ud.toneMapping=Ce,Ud.toneMappingExposure=1,Ud.outputEncoding=yn,e.scale.z*=-1,(t=e.background)&&t.isColor&&(t.convertSRGBToLinear(),n=Math.max(t.r,t.g,t.b),n=Math.min(Math.max(Math.ceil(Math.log2(n)),-128),127),t=t.multiplyScalar(Math.pow(2,-n)),n=(n+128)/255,Ud.setClearColor(t,n),e.background=null);for(var f=0;f<6;f++){var d=f%3;0==d?(i.up.set(0,o[f],0),i.lookAt(a[f],0,0)):1==d?(i.up.set(0,0,o[f]),i.lookAt(0,a[f],0)):(i.up.set(0,o[f],0),i.lookAt(0,0,a[f])),Zd(r,d*Td,2<f?Td:0,Td,Td),Ud.setRenderTarget(r),Ud.render(e,i)}Ud.toneMapping=u,Ud.toneMappingExposure=l,Ud.outputEncoding=s,Ud.setClearColor(c,h),e.scale.z*=-1}(e,n,r,i),0<t&&Kd(i,0,0,t),Jd(i),Yd(i),i},fromEquirectangular:function(e){return e.magFilter=Ue,e.minFilter=Ue,e.generateMipmaps=!1,this.fromCubemap(e)},fromCubemap:function(e){Vd=Ud.getRenderTarget();var t=Wd(e);return function(e,t){var n=new jr;e.isCubeTexture?null==Dd&&(Dd=ep()):null==Od&&(Od=$d());var r=e.isCubeTexture?Dd:Od;n.add(new Eo(Fd[0],r)),(r=r.uniforms).envMap.value=e,e.isCubeTexture||r.texelSize.value.set(1/e.image.width,1/e.image.height),r.inputEncoding.value=Rd[e.encoding],r.outputEncoding.value=Rd[e.encoding],Zd(t,0,0,3*Td,2*Td),Ud.setRenderTarget(t),Ud.render(n,Nd)}(e,t),Jd(t),Yd(t),t},compileCubemapShader:function(){null==Dd&&qd(Dd=ep())},compileEquirectangularShader:function(){null==Od&&qd(Od=$d())},dispose:function(){Pd.dispose(),null!=Dd&&Dd.dispose(),null!=Od&&Od.dispose();for(var e=0;e<Fd.length;e++)Fd[e].dispose()}},er=0,t.LineStrip=er,er=1,t.LinePieces=er,er=0,t.NoColors=er;var tp=1;t.FaceColors=tp;var np=2;function rp(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),hh.call(this,e),this.type="catmullrom",this.closed=!0}function ip(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),hh.call(this,e),this.type="catmullrom"}function op(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),hh.call(this,e),this.type="catmullrom"}t.VertexColors=np,rh.create=function(e,t){return e.prototype=(0,y.default)(rh.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},(0,m.default)(wh.prototype,{createPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getPoints(e),this.createGeometry(e)},createSpacedPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getSpacedPoints(e),this.createGeometry(e)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new Po,n=0,r=e.length;n<r;n++){var i=e[n];t.vertices.push(new vr(i.x,i.y,i.z||0))}return t}}),(0,m.default)(bh.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),rp.prototype=(0,y.default)(hh.prototype),ip.prototype=(0,y.default)(hh.prototype),op.prototype=(0,y.default)(hh.prototype),(0,m.default)(op.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),sd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},td.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},(0,m.default)(Xc.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Gh.extractUrlBase(e)}}),Xc.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},(0,m.default)(jh.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),(0,m.default)(jf.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),(0,m.default)(ii.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Qo.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},qf.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},(0,m.default)(or,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),or.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),or.ceilPowerOfTwo(e)}}),(0,m.default)(sr.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),(0,m.default)(Cr.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new vr).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,o)}}),_i.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},pr.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},(0,m.default)(gi.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),(0,m.default)(Li.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),(0,m.default)(Li,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Li.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Li.getNormal(e,t,n,r)}}),(0,m.default)(Ch.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Jl(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new uc(this,e)}}),(0,m.default)(ar.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),(0,m.default)(vr.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),(0,m.default)(hr.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),(0,m.default)(Po.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),(0,m.default)(Hr.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),(0,v.default)(Hr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),(0,m.default)(Eo.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),(0,v.default)(Eo.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),(0,v.default)(Tu.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),(0,g.default)(Ru.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Su.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},(0,g.default)(rh.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),jo.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},(0,v.default)(Mh.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),(0,v.default)(Hi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===qn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(qn)}}}),(0,m.default)(Hi.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?qn:Yn),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),(0,m.default)(uo.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new Hi(arguments[1],arguments[2])))},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),(0,v.default)(uo.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),(0,v.default)(Bf.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),(0,v.default)(su.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===qn},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),(0,m.default)(su.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?qn:Yn),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),(0,m.default)(Kl.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),(0,v.default)(Df.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),(0,v.default)(zi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Pi}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),(0,v.default)(wc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),(0,v.default)(Vo.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),(0,m.default)(iu.prototype,{clearTarget:function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),(0,v.default)(iu.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?_n:yn}}}),(0,v.default)(Ks.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),(0,v.default)(fr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),(0,v.default)(mf.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new tf).load(e,(function(e){t.setBuffer(e)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),If.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},qo.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},er={merge:function(e,t,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,t=t.geometry),e.merge(t,r,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},t.GeometryUtils=er,ur.crossOrigin=void 0,ur.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new nh;return i.setCrossOrigin(this.crossOrigin),r=i.load(e,n,void 0,r),t&&(r.mapping=t),r},ur.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new th;return i.setCrossOrigin(this.crossOrigin),r=i.load(e,n,void 0,r),t&&(r.mapping=t),r},ur.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},ur.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},er={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},t.SceneUtils=er,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"115"}}))},function(e,t,n){var r=n(37),i=n(166),o=n(127),a=n(125)("IE_PROTO"),s=function(){},u="prototype",l=function(){var e=n(121)("iframe"),t=o.length;for(e.style.display="none",n(168).appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;t--;)delete l[u][o[t]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[u]=r(e),n=new s,s[u]=null,n[a]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(167),i=n(127);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=!0},function(e,t,n){var r=n(36).f,i=n(52),o=n(29)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t){e.exports={}},function(e,t,n){var r=n(44);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(54),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){var r=n(22);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={ZH:"zh",EN:"en",CHN:"zh"},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e),this.currentModel=null,this.isToggleViewMode=!1,this.externalLoadingCount=0}return(0,a.default)(e,[{key:"dispose",value:function(e){for(var t in this[e])this[e][t]=void 0}}]),e}(),n=n=new n,t.default=n},function(e,t,n){"use strict";n(109)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(124),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){},function(e,t,n){"use strict";var r=n(282)(!0);n(133)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e=this._t,t=this._i;return t>=e.length?{value:void 0,done:!0}:(t=r(e,t),this._i+=t.length,{value:t,done:!1})}))},function(e,t,n){n(284);for(var r=n(20),i=n(51),o=n(81),a=n(29)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var l,c=s[u];(l=(l=r[c])&&l.prototype)&&!l[a]&&i(l,a,c),o[c]=o.Array}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e=e.exports={version:"2.6.12"},"number"==typeof __e&&(__e=e)},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=!1},function(e,t,n){var r=n(136);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(138),i=n(60);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(180),i=n(140).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){"use strict";var r=n(38),i=n(39),o=n(143),a=n(104);n(106)("match",1,(function(e,t,n,s){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=s(n,e,this);if(t.done)return t.value;var u=r(e),l=String(this);if(!u.global)return a(u,l);var c=u.unicode;u.lastIndex=0;for(var h=[],f=0;null!==(d=a(u,l));){var d=String(d[0]);h[f]=d,""===d&&(u.lastIndex=o(l,i(u.lastIndex),c)),f++}return 0===f?null:h}]}))},function(e,t,n){"use strict";var r=n(105),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){if("object"!=s(n=n.call(e,t)))throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){var r=n(69),i=n(24)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?e:o?r(t):"Object"==(e=r(t))&&"function"==typeof t.callee?"Arguments":e}},function(e,t,n){"use strict";n(305);var r,i=n(45),o=n(40),a=n(26),s=n(60),u=n(24),l=n(144),c=u("species"),h=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),f=(r=(n=/(?:)/).exec,n.exec=function(){return r.apply(this,arguments)},2===(n="ab".split(n)).length&&"a"===n[0]&&"b"===n[1]);e.exports=function(e,t,n){var r,d,p=u(e),g=!a((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),m=g?!a((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[c]=function(){return n}),n[p](""),!t})):void 0;g&&m&&("replace"!==e||h)&&("split"!==e||f)||(r=/./[p],m=n(s,p,""[e],(function(e,t,n,i,o){return t.exec===l?g&&!o?{done:!0,value:r.call(t,n,i)}:{done:!0,value:e.call(n,t,i)}:{done:!1}})),n=m[0],d=m[1],i(String.prototype,e,n),o(RegExp.prototype,p,2==t?function(e,t){return d.call(e,this,t)}:function(e){return d.call(e,this)}))}},function(e,t,n){"use strict";var r=n(38);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";n(306);var r=n(38),i=n(107),o=n(30),a="toString",s=/./[a],u=function(e){n(45)(RegExp.prototype,a,e,!0)};n(26)((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?u((function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)})):s.name!=a&&u((function(){return s.call(this)}))},function(e,t,n){var r=n(23),i=n(26),o=n(60),a=/"/g,s=function(e,t,n,r){var i=String(o(e));return e="<"+t,""!==n&&(e+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),e+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||3<t.split('"').length})),"String",n)}},function(e,t,n){for(var r=n(71),i=n(142),o=n(45),a=n(31),s=n(40),u=n(70),l=(n=n(24))("iterator"),c=n("toStringTag"),h=u.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(f),p=0;p<d.length;p++){var g,m=d[p],v=f[m],y=a[m],_=y&&y.prototype;if(_&&(_[l]||s(_,l,h),_[c]||s(_,c,m),u[m]=h,v))for(g in r)_[g]||o(_,g,r[g],!0)}},function(e,t,n){e.exports=n(338)},function(e,t,n){e.exports=n(342)},function(e,t,n){var r=n(51);e.exports=function(e,t,n){for(var i in t)n&&e[i]?e[i]=t[i]:r(e,i,t[i]);return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n="https://console.fengmap.com/api-s/",t.default=n},function(e,t,n){var r=n(23);r(r.P,"Array",{fill:n(148)}),n(191)("fill")},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.netArea=t.LayerOrder=t.Prop2Alias=t.AliasLayerMap=t.LayerAlias=void 0;var o=i(n(155)),a=i(n(220)),s=i(n(388)),u=i(n(389)),l=i(n(223)),c=i(n(225)),h=i(n(227)),f=i(n(228)),d=i(n(229)),p=i(n(231)),g=i(n(394)),m=i(n(232)),v=i(n(396)),y=i(n(234)),_=i(n(235)),x=i(n(397));r=i(n(236)),i=i(n(237)),n=["extent","model","label","facility","line","locationMarker","text","textMarker","polygonMarker","gradientPolygonMarker","extrudeMarker","imageMarker","stair","externalModel","heatmap","dynmodel","symbol","domMarker","waterMarker","flmMarker"],t.LayerAlias=n,o=new o.default,t.AliasLayerMap=o,o.set("extent",a.default),o.set("externalModel",s.default),o.set("model",u.default),o.set("label",l.default),o.set("facility",c.default),o.set("imageMarker",h.default),o.set("polygonMarker",f.default),o.set("gradientPolygonMarker",d.default),o.set("extrudeMarker",i.default),o.set("textMarker",p.default),o.set("stair",g.default),o.set("heatmap",m.default),o.set("symbol",v.default),o.set("domMarker",y.default),o.set("dynmodel",_.default),o.set("waterMarker",x.default),o.set("flmMarker",r.default),r={extentLayer:"extent",externalModelLayer:"externalModel",labelLayer:"label",modelLayer:"model",poiLayer:"facility",stairLayer:"stair"},t.Prop2Alias=r,r={extent:0,line:2,model:1,externalModel:.5,heatmap:3,polygonMarker:3,gradientPolygonMarker:3,extrudeMarker:3,location:4,facility:3.5,label:4,imageMarker:4,textMarker:4,domMarker:4,waterMarker:3,dynmodel:.5,flmMarker:2},t.LayerOrder=r,r="https://www.fengmap.com/",t.netArea=r},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7));n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(e){return(0,a.default)(this,n),t.call(this,e)}return(0,s.default)(n,[{key:"raycast",value:function(e,t){var n=this,r=new fm.Vector3,i=new fm.Vector3,o=new fm.Vector3,a=new fm.Vector2,s=new fm.Vector2,u=new fm.Matrix4,l=new fm.Vector3,c=new fm.Vector3,h=new fm.Vector3,f=new fm.Vector2,d=new fm.Vector2,p=new fm.Vector2,g=new fm.Vector4,m=function(t,r,i,o,l,c){a.subVectors(t,i).addScalar(.5).multiply(o),e.perspective&&!n.material.sizeAttenuation&&(g.applyMatrix4(n.modelViewMatrix),a.multiplyScalar(Math.abs(g.z))),void 0!==l?(s.x=c*a.x-l*a.y,s.y=l*a.x+c*a.y):s.copy(a),t.copy(r),t.x+=s.x,t.y+=s.y,t.applyMatrix4(u)};!function(e,t){i.setFromMatrixScale(n.matrixWorld),u.getInverse(n.modelViewMatrix).premultiply(n.matrixWorld),o.setFromMatrixPosition(n.modelViewMatrix),0!==(g=n.material.rotation)&&(s=Math.cos(g),a=Math.sin(g));var a,s,g,v=n.center;m(l.set(-.5,-.5,0),o,v,i,a,s),m(c.set(.5,-.5,0),o,v,i,a,s),m(h.set(.5,.5,0),o,v,i,a,s),f.set(0,0),d.set(1,0),p.set(1,1),null===(g=e.ray.intersectTriangle(l,c,h,!1,r))&&(m(c.set(-.5,.5,0),o,v,i,a,s),d.set(0,1),null===(g=e.ray.intersectTriangle(l,h,c,!1,r)))||(a=l.clone().project(e.camera),s=c.clone().project(e.camera),g=h.clone().project(e.camera),(a.x<-1||1<a.x||a.y<-1||1<a.y)&&(s.x<-1||1<s.x||s.y<-1||1<s.y)&&(g.x<-1||1<g.x||g.y<-1||1<g.y)||(g=e.ray.origin.distanceTo(r))<e.near||g>e.far||t.push({distance:g,point:r.clone(),uv:fm.Triangle.getUV(r,l,c,h,f,d,p,new fm.Vector2),face:null,object:n}))}(e,t)}}]),n}(fm.Sprite),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3)),s=(r=i(n(174)),i(n(209)),i(n(248)));n=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,null,[{key:"search",value:function(e,t,n,r){}},{key:"drawNaviRoads",value:function(e){if(e&&e._currentSceneId&&e.dataManager){var t=e.dataManager._sceneDecodeData[e._currentSceneId];if(t){var n=t.floors;if(0!=n.length){var r,i=[{lineWidth:1,alpha:1,lineType:fengmap.FMLineType.FULL,color:"#00FFFF"},{lineWidth:1,alpha:1,lineType:fengmap.FMLineType.FULL,color:"#00FF00"},{lineWidth:1,alpha:1,lineType:fengmap.FMLineType.FULL,color:"#FF00FF"},{lineWidth:1,alpha:1,lineType:fengmap.FMLineType.FULL,color:"#FF0000"}],o=[];for(r in n){var a=n[r].gid;if(null!=a){var u=n[r].geo[0],l=n[r].biz[0],c=n[r].navi[0],h=new s.default({});h._scene=t;var f,d=h.convertToGroup(a,u,l,c);for(f in d.naviSegments){var p,g,m=d.naviSegments[f];m.geoArr&&(p=new fengmap.FMLineMarker,(g=new fengmap.FMSegment).groupId=a,g.points=m.geoArr,g.points.forEach((function(e){e.z=1})),p.addSegment(g),e.drawLineMark(p,i[m.entry]),o.push(p))}}}return o}}}}},{key:"convertPointCoordsByCenter",value:function(e,t){return e.x=e.x-t.x,e.y=e.y-t.y,void 0!==e.z&&void 0!==t.z&&(e.z=e.z-t.z),e}},{key:"convertPointsCoordsByCenter",value:function(e,t){for(var n=0;n<e.length;n++)this.convertPointCoordsByCenter(e[n],t);return e}}]),e}(),(0,r.default)(n,"getLayerByAlias",(function(e,t,n,r){var i=e.getFMGroup(t);if(i&&i.layers){n=[].concat(n);for(var o=[],a=0;a<i.layers.length;a++){var s=i.layers[a];if(s._type_)-1<n.indexOf(s._type_)&&(r&&r(s,s._type_)&&a--,o.push(s));else for(var u=0;u<n.length;u++){var l=n[u];fengmap.Map.layerAlias[l]&&s instanceof fengmap.Map.layerAlias[l]&&(r&&r(s,l)&&a--,o.push(s))}}return 0==o.length?null:1==o.length?o[0]:o}})),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(19));n(32);var a=i(n(2)),s=i(n(3));n=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,null,[{key:"createShape",value:function(e,t){var n=new fm.Shape;n.moveTo(e[0].x,e[0].y);for(var r=1;r<e.length;r++)n.lineTo(e[r].x,e[r].y);return t&&n.lineTo(e[0].x,e[0].y),n}},{key:"createReactShape",value:function(e,t){var n=new fm.Shape;return t/=2,e/=2,n.moveTo(-e,-t),n.lineTo(-e,t),n.lineTo(e,t),n.lineTo(e,-t),n}},{key:"createCircleShape",value:function(e,t){var n=new fm.Shape;return n.absarc(0,0,e,0,2*Math.PI,!1),n}},{key:"createExtrudeBufferGeometry",value:function(e,t){return t={steps:1,depth:t.depth,bevelEnabled:!1,bevelThickness:0,bevelSize:0,bevelOffset:0,bevelSegments:1},new fm.ExtrudeBufferGeometry(e,t)}},{key:"createPointsExtrudeBufferGeometry",value:function(t,n){return t=e.createShape(t,!0),this.createExtrudeBufferGeometry(t,n)}},{key:"createReactExtrudeBufferGeometry",value:function(t,n,r){return n=e.createReactShape(t,n),this.createExtrudeBufferGeometry(n,r)}},{key:"createCircleExtrudeBufferGeometry",value:function(t,n,r){return n=e.createCircleShape(t,n),this.createExtrudeBufferGeometry(n,r)}},{key:"createShapeBufferGeometry",value:function(t){return t=e.createShape(t),new fm.ShapeBufferGeometry(t)}},{key:"createShapeBufferGeometryByCenter",value:function(e,t){var n=new fm.Shape;n.moveTo(e[0].x-t.x,-e[0].y+t.y);for(var r=1;r<e.length;r++)n.lineTo(e[r].x-t.x,-e[r].y+t.y);return n.lineTo(e[0].x-t.x,-e[0].y+t.y),new fm.ShapeBufferGeometry(n)}},{key:"createCenterBufferGeometry",value:function(e,t){for(var n=[],r=0;r<e.length-1;r++)for(var i=2;i<10;i+=2)n.push({x:e[r].x+(e[r+1].x-e[r].x)*i*.1,y:e[r].y+(e[r+1].y-e[r].y)*i*.1,z:e[r].z+(e[r+1].z-e[r].z)*i*.1});n.push({x:n[0].x,y:n[0].y,z:n[0].z});for(var o=new fm.BufferGeometry,a=[],s=[],u=0;u<n.length-1;u++)a.push(n[u].x),a.push(n[u].y),a.push(n[u].z),a.push(n[u+1].x),a.push(n[u+1].y),a.push(n[u+1].z),a.push(t.x),a.push(t.y),a.push(t.z),s.push(0,0,1);var l=new Float32Array(a);return o.setAttribute("position",new fm.Float32BufferAttribute(l,3)),o.setAttribute("gradientAlpha",new fm.Float32BufferAttribute(s,1)),o}},{key:"scalePoints",value:function(e,t,n){for(var r=[],i=0;i<e.length;i++){var o=e[i].x,a=e[i].y,s=e[i].z;r.push({x:o+(o-t.x)*(n-1),y:a+(a-t.y)*(n-1),z:s})}return r}},{key:"scaleValuePoints",value:function(e,t,n){for(var r=[],i=0;i<e.length;i++){var o={x:e[i].x,y:e[i].y,z:e[i].z};o.x-t.x<0?o.x-=n:o.x+=n,o.y-t.y<0?o.y-=n:o.y+=n,r.push(o)}return r}},{key:"closedPoints",value:function(e){var t=e.length;return!(t<3||(e[0].x===e[t-1].x&&e[0].y===e[t-1].y||(e[t]={},(0,o.default)(e[t],e[0])),0))}}]),e}(),t.default=n},function(e,t,n){var r=n(22),i=n(20).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(22);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(78);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t,n){var r=n(126)("keys"),i=n(91);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(12),i=n(20),o="__core-js_shared__",a=i[o]||(i[o]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(79)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){e.exports=n(51)},function(e,t,n){t.f=n(29)},function(e,t,n){var r=n(20),i=n(12),o=n(79),a=n(129),s=n(36).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=!o&&r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(78);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r=n(79),i=n(15),o=n(128),a=n(51),s=n(81),u=n(283),l=n(80),c=n(172),h=n(29)("iterator"),f=!([].keys&&"next"in[].keys()),d="keys",p="values",g=function(){return this};e.exports=function(e,t,n,m,v,y,_){u(n,t,m);var x,A,I=function(e){if(!f&&e in M)return M[e];switch(e){case d:case p:return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",b=v==p,C=!1,M=e.prototype,E=M[h]||M["@@iterator"]||v&&M[v],T=E||I(v),S=v?b?I("entries"):T:void 0;if((m="Array"==t&&M.entries||E)&&(e=c(m.call(new e)))!==Object.prototype&&e.next&&(l(e,w,!0),r||"function"==typeof e[h]||a(e,h,g)),b&&E&&E.name!==p&&(C=!0,T=function(){return E.call(this)}),r&&!_||!f&&!C&&M[h]||a(M,h,T),s[t]=T,s[w]=g,v)if(x={values:b?T:I(p),keys:y?T:I(d),entries:S},_)for(A in x)A in M||o(M,A,x[A]);else i(i.P+i.F*(f||C),t,x);return x}},function(e,t,n){var r=n(15),i=n(12),o=n(43);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},function(e,t,n){var r=n(97),i=n(31),o="__core-js_shared__",a=i[o]||(i[o]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(99)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(179),i=n(98),o=n(101),a=n(82),s=n(58),u=n(176),l=Object.getOwnPropertyDescriptor;t.f=n(30)?l:function(e,t){if(e=o(e),t=a(t,!0),u)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(69);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(135)("keys"),i=n(83);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(38),i=n(300),o=n(140),a=n(139)("IE_PROTO"),s=function(){},u="prototype",l=function(){var e=n(177)("iframe"),t=o.length;for(e.style.display="none",n(182).appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;t--;)delete l[u][o[t]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[u]=r(e),n=new s,s[u]=null,n[a]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(180),i=n(140);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){"use strict";var r=n(183)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){"use strict";var r,i=n(107),o=RegExp.prototype.exec,a=String.prototype.replace,s=o,u="lastIndex",l=(r=/a/,n=/b*/g,o.call(r,"a"),o.call(n,"a"),0!==r[u]||0!==n[u]),c=void 0!==/()??/.exec("")[1];(n=l||c)&&(s=function(e){var t,n,r,s,h=this;return c&&(n=new RegExp("^"+h.source+"$(?!\\s)",i.call(h))),l&&(t=h[u]),r=o.call(h,e),l&&r&&(h[u]=h.global?r.index+r[0].length:t),c&&r&&1<r.length&&a.call(r[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(r[s]=void 0)})),r}),e.exports=s},function(e,t,n){var r=n(23);r(r.P,"String",{repeat:n(310)})},function(e,t,n){var r=n(100),i=n(138),o=n(46),a=n(39),s=n(312);e.exports=function(e,t){var n=1==e,u=2==e,l=3==e,c=4==e,h=6==e,f=5==e||h,d=t||s;return function(t,s,p){for(var g,m,v=o(t),y=i(v),_=r(s,p,3),x=a(y.length),A=0,I=n?d(t,x):u?d(t,0):void 0;A<x;A++)if((f||A in y)&&(m=_(g=y[A],A,v),e))if(n)I[A]=m;else if(m)switch(e){case 3:return!0;case 5:return g;case 6:return A;case 2:I.push(g)}else if(c)return!1;return h?-1:l||c?c:I}}},function(e,t,n){"use strict";var r=n(26);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){"use strict";var r=n(46),i=n(84),o=n(39);e.exports=function(e){for(var t,n=r(this),a=o(n.length),s=i(1<(t=arguments.length)?arguments[1]:void 0,a),u=void 0===(t=2<t?arguments[2]:void 0)?a:i(t,a);s<u;)n[s++]=e;return n}},function(e,t,n){var r=n(41).f,i=n(58),o=n(24)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){n(47)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(47)("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(42),i=n(123),o=n(57),a=n(90),s=n(353);e.exports=function(e,t){var n=1==e,u=2==e,l=3==e,c=4==e,h=6==e,f=5==e||h,d=t||s;return function(t,s,p){for(var g,m,v=o(t),y=i(v),_=r(s,p,3),x=a(y.length),A=0,I=n?d(t,x):u?d(t,0):void 0;A<x;A++)if((f||A in y)&&(m=_(g=y[A],A,v),e))if(n)I[A]=m;else if(m)switch(e){case 3:return!0;case 5:return g;case 6:return A;case 2:I.push(g)}else if(c)return!1;return h?-1:l||c?c:I}}},function(e,t,n){var r=n(78),i=n(29)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?e:o?r(t):"Object"==(e=r(t))&&"function"==typeof t.callee?"Arguments":e}},function(e,t,n){e.exports=n(358)},function(e,t){var n,r;function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}e=e.exports={},function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var s,u=[],l=!1,c=-1;function h(){l&&s&&(l=!1,s.length?u=s.concat(u):c=-1,u.length&&f())}function f(){if(!l){var e=a(h);l=!0;for(var t=u.length;t;){for(s=u,u=[];++c<t;)s&&s[c].run();c=-1,t=u.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||l||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=p,e.addListener=p,e.once=p,e.off=p,e.removeListener=p,e.removeAllListeners=p,e.emit=p,e.prependListener=p,e.prependOnceListener=p,e.listeners=function(e){return[]},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},function(e,t,n){"use strict";(function(e){var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.ProtoBuf=void 0;var o=i(n(53));n(14),n(108),n(61),n(150),n(13),n(116),n(8),n(55),n(21),n(9),n(71),n(110);var a=i(n(0)),s=i(n(35)),u=i(n(25)),l=i(n(11)),c=i(n(34)),h=i(n(63)),f=i(n(112));function d(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function p(e){return!0===(e&&e.__isLong__)}d.__isLong__,(0,a.default)(d.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),d.isLong=p;var g={},m={};function v(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=m[e])?r:(n=_(e,(0|e)<0?-1:0,!0),i&&(m[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=g[e])?r:(n=_(e,e<0?-1:0,!1),i&&(g[e]=n),n)}function y(e,t){if(isNaN(e)||!isFinite(e))return t?T:E;if(t){if(e<0)return T;if(b<=e)return R}else{if(e<=-C)return N;if(C<=e+1)return k}return e<0?y(-e,t).neg():_(e%w|0,e/w|0,t)}function _(e,t,n){return new d(e,t,n)}d.fromInt=v,d.fromNumber=y,d.fromBits=_;var x=Math.pow;function A(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return E;if("number"==typeof t&&(n=t,t=!1),(n=n||10)<2||36<n)throw RangeError("radix");var r;if(0<(r=e.indexOf("-")))throw Error("interior hyphen");if(0===r)return A(e.substring(1),t,n).neg();for(var i=y(x(n,8)),o=E,a=0;a<e.length;a+=8){var u=Math.min(8,e.length-a),l=(0,s.default)(e.substring(a,a+u),n);o=u<8?(u=y(x(n,u)),o.mul(u).add(y(l))):(o=o.mul(i)).add(y(l))}return o.unsigned=t,o}function I(e){return e instanceof d?e:"number"==typeof e?y(e):"string"==typeof e?A(e):_(e.low,e.high,e.unsigned)}d.fromString=A,d.fromValue=I;var w=(r=65536)*r,b=w*w,C=b/2,M=v(i=1<<24),E=v(0);d.ZERO=E;var T=v(0,!0);d.UZERO=T;var S=v(1);d.ONE=S,i=v(1,!0),d.UONE=i;var L=v(-1);d.NEG_ONE=L;var k=_(-1,2147483647,!1);d.MAX_VALUE=k;var R=_(-1,-1,!0);d.MAX_UNSIGNED_VALUE=R;var N=_(0,-2147483648,!1);d.MIN_VALUE=N,(i=d.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},i.toNumber=function(){return this.unsigned?(this.high>>>0)*w+(this.low>>>0):this.high*w+(this.low>>>0)},i.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(N)){var t=y(e),n=this.div(t);return t=n.mul(t).sub(this),n.toString(e)+t.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var r=y(x(e,6),this.unsigned),i=this,o="";;){var a=i.div(r),s=(i.sub(a.mul(r)).toInt()>>>0).toString(e);if((i=a).isZero())return s+o;for(;s.length<6;)s="0"+s;o=""+s+o}},i.getHighBits=function(){return this.high},i.getHighBitsUnsigned=function(){return this.high>>>0},i.getLowBits=function(){return this.low},i.getLowBitsUnsigned=function(){return this.low>>>0},i.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;0<t&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},i.isZero=function(){return 0===this.high&&0===this.low},i.isNegative=function(){return!this.unsigned&&this.high<0},i.isPositive=function(){return this.unsigned||0<=this.high},i.isOdd=function(){return 1==(1&this.low)},i.isEven=function(){return 0==(1&this.low)},i.equals=function(e){return p(e)||(e=I(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},i.eq=i.equals,i.notEquals=function(e){return!this.eq(e)},i.neq=i.notEquals,i.lessThan=function(e){return this.comp(e)<0},i.lt=i.lessThan,i.lessThanOrEqual=function(e){return this.comp(e)<=0},i.lte=i.lessThanOrEqual,i.greaterThan=function(e){return 0<this.comp(e)},i.gt=i.greaterThan,i.greaterThanOrEqual=function(e){return 0<=this.comp(e)},i.gte=i.greaterThanOrEqual,i.compare=function(e){if(p(e)||(e=I(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},i.comp=i.compare,i.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(S)},i.neg=i.negate,i.add=function(e){p(e)||(e=I(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=65535&e.low,l=0,c=0,h=0;return e=0,h+=(e+=i+u)>>>16,c+=(h+=r+s)>>>16,l+=(c+=n+a)>>>16,l+=t+o,_((h&=65535)<<16|(e&=65535),(l&=65535)<<16|(c&=65535),this.unsigned)},i.subtract=function(e){return p(e)||(e=I(e)),this.add(e.neg())},i.sub=i.subtract,i.multiply=function(e){if(this.isZero())return E;if(p(e)||(e=I(e)),e.isZero())return E;if(this.eq(N))return e.isOdd()?N:E;if(e.eq(N))return this.isOdd()?N:E;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(M)&&e.lt(M))return y(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=65535&e.low,l=0,c=0,h=0;return e=0,h+=(e+=i*u)>>>16,c+=(h+=r*u)>>>16,h&=65535,c+=(h+=i*s)>>>16,l+=(c+=n*u)>>>16,c&=65535,l+=(c+=r*s)>>>16,c&=65535,l+=(c+=i*a)>>>16,l+=t*u+n*s+r*a+i*o,_((h&=65535)<<16|(e&=65535),(l&=65535)<<16|(c&=65535),this.unsigned)},i.mul=i.multiply,i.divide=function(e){if(p(e)||(e=I(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?T:E;var t,n;if(this.eq(N))return e.eq(S)||e.eq(L)?N:e.eq(N)?S:(r=this.shr(1).div(e).shl(1)).eq(E)?e.isNegative()?S:L:(t=this.sub(e.mul(r)),n=r.add(t.div(e)));if(e.eq(N))return this.unsigned?T:E;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();for(n=E,t=this;t.gte(e);){for(var r=Math.max(1,Math.floor(t.toNumber()/e.toNumber())),i=Math.ceil(Math.log(r)/Math.LN2),o=i<=48?1:x(2,i-48),a=y(r),s=a.mul(e);s.isNegative()||s.gt(t);)s=(a=y(r-=o,this.unsigned)).mul(e);a.isZero()&&(a=S),n=n.add(a),t=t.sub(s)}return n},i.div=i.divide,i.modulo=function(e){return p(e)||(e=I(e)),this.sub(this.div(e).mul(e))},i.mod=i.modulo,i.not=function(){return _(~this.low,~this.high,this.unsigned)},i.and=function(e){return p(e)||(e=I(e)),_(this.low&e.low,this.high&e.high,this.unsigned)},i.or=function(e){return p(e)||(e=I(e)),_(this.low|e.low,this.high|e.high,this.unsigned)},i.xor=function(e){return p(e)||(e=I(e)),_(this.low^e.low,this.high^e.high,this.unsigned)},i.shiftLeft=function(e){return p(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?_(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):_(0,this.low<<e-32,this.unsigned)},i.shl=i.shiftLeft,i.shiftRight=function(e){return p(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?_(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):_(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},i.shr=i.shiftRight,i.shiftRightUnsigned=function(e){if(p(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?_(this.low>>>e|t<<32-e,t>>>e,this.unsigned):_(32===e?t:t>>>e-32,0,this.unsigned)},i.shru=i.shiftRightUnsigned,i.toSigned=function(){return this.unsigned?_(this.low,this.high,!1):this},i.toUnsigned=function(){return this.unsigned?this:_(this.low,this.high,!0)};var P=function e(t,n,r){if(void 0===t&&(t=e.DEFAULT_CAPACITY),void 0===n&&(n=e.DEFAULT_ENDIAN),void 0===r&&(r=e.DEFAULT_NOASSERT),!r){if((t|=0)<0)throw RangeError("Illegal capacity");n=!!n,r=!!r}this.buffer=0===t?D:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=t,this.littleEndian=n,this.noAssert=r};P.VERSION="5.0.1",P.LITTLE_ENDIAN=!0,P.BIG_ENDIAN=!1,P.DEFAULT_CAPACITY=16,P.DEFAULT_ENDIAN=P.BIG_ENDIAN,P.DEFAULT_NOASSERT=!1,P.Long=d||null;var O=P.prototype;O.__isByteBuffer__,(0,a.default)(O,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var D=new ArrayBuffer(0),F=String.fromCharCode;function B(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function G(){var e=[],t=[];return function(){if(0===arguments.length)return t.join("")+F.apply(String,e);1024<e.length+arguments.length&&(t.push(F.apply(String,e)),e.length=0),Array.prototype.push.apply(e,arguments)}}function z(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,h=n?i-1:0,f=n?-1:1;for(n=e[t+h],h+=f,o=n&(1<<-c)-1,n>>=-c,c+=s;0<c;o=256*o+e[t+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;0<c;a=256*a+e[t+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(n?-1:1);a+=Math.pow(2,r),o-=l}return(n?-1:1)*a*Math.pow(2,o-r)}function U(e,t,n,r,i,o){var a,s,u=8*o-i-1,l=(1<<u)-1,c=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1;for(o=t<0||0===t&&1/t<0?1:0,t=Math.abs(t),isNaN(t)||1/0===t?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-a))<1&&(a--,r*=2),2<=(t+=1<=a+c?h/r:h*Math.pow(2,1-c))*r&&(a++,r/=2),l<=a+c?(s=0,a=l):1<=a+c?(s=(t*r-1)*Math.pow(2,i),a+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));8<=i;e[n+f]=255&s,f+=d,s/=256,i-=8);for(a=a<<i|s,u+=i;0<u;e[n+f]=255&a,f+=d,a/=256,u-=8);e[n+f-d]|=128*o}P.accessor=function(){return Uint8Array},P.allocate=function(e,t,n){return new P(e,t,n)},P.concat=function(e,t,n,r){"boolean"!=typeof t&&"string"==typeof t||(r=n,n=t,t=void 0);for(var i,o=0,a=0,s=e.length;a<s;++a)P.isByteBuffer(e[a])||(e[a]=P.wrap(e[a],t)),0<(i=e[a].limit-e[a].offset)&&(o+=i);if(0===o)return new P(0,n,r);var u,l=new P(o,n,r);for(a=0;a<s;)(i=(u=e[a++]).limit-u.offset)<=0||(l.view.set(u.view.subarray(u.offset,u.limit),l.offset),l.offset+=i);return l.limit=l.offset,l.offset=0,l},P.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},P.type=function(){return ArrayBuffer},P.wrap=function(e,t,n,r){if("string"!=typeof t&&(r=n,n=t,t=void 0),"string"==typeof e)switch(void 0===t&&(t="utf8"),t){case"base64":return P.fromBase64(e,n);case"hex":return P.fromHex(e,n);case"binary":return P.fromBinary(e,n);case"utf8":return P.fromUTF8(e,n);case"debug":return P.fromDebug(e,n);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!==(0,o.default)(e))throw TypeError("Illegal buffer");var i;if(P.isByteBuffer(e))return(i=O.clone.call(e)).markedOffset=-1,i;if(e instanceof Uint8Array)i=new P(0,n,r),0<e.length&&(i.buffer=e.buffer,i.offset=e.byteOffset,i.limit=e.byteOffset+e.byteLength,i.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)i=new P(0,n,r),0<e.byteLength&&(i.buffer=e,i.offset=0,i.limit=e.byteLength,i.view=0<e.byteLength?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");(i=new P(e.length,n,r)).limit=e.length;for(var a=0;a<e.length;++a)i.view[a]=e[a]}return i},O.writeBitSet=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r=t,i=e.length,o=i>>3,a=0;for(t+=this.writeVarint32(i,t);o--;)u=1&!!e[a++]|(1&!!e[a++])<<1|(1&!!e[a++])<<2|(1&!!e[a++])<<3|(1&!!e[a++])<<4|(1&!!e[a++])<<5|(1&!!e[a++])<<6|(1&!!e[a++])<<7,this.writeByte(u,t++);if(a<i){for(var s=0,u=0;a<i;)u|=(1&!!e[a++])<<s++;this.writeByte(u,t++)}return n?(this.offset=t,this):t-r},O.readBitSet=function(e){var t=void 0===e;t&&(e=this.offset);var n=this.readVarint32(e),r=n.value,i=r>>3,o=0,a=[];for(e+=n.length;i--;)u=this.readByte(e++),a[o++]=!!(1&u),a[o++]=!!(2&u),a[o++]=!!(4&u),a[o++]=!!(8&u),a[o++]=!!(16&u),a[o++]=!!(32&u),a[o++]=!!(64&u),a[o++]=!!(128&u);if(o<r)for(var s=0,u=this.readByte(e++);o<r;)a[o++]=!!(u>>s++&1);return t&&(this.offset=e),a},O.readBytes=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}return t=this.slice(t,t+e),n&&(this.offset+=e),t},O.writeBytes=O.append,O.writeInt8=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),--t,this.view[t]=e,n&&(this.offset+=1),this},O.writeByte=O.writeInt8,O.readInt8=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return 128==(128&(e=this.view[e]))&&(e=-(255-e+1)),t&&(this.offset+=1),e},O.readByte=O.readInt8,O.writeUint8=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),--t,this.view[t]=e,n&&(this.offset+=1),this},O.writeUInt8=O.writeUint8,O.readUint8=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return e=this.view[e],t&&(this.offset+=1),e},O.readUInt8=O.readUint8,O.writeInt16=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),n&&(this.offset+=2),this},O.writeShort=O.writeInt16,O.readInt16=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e],n|=this.view[e+1]<<8):(n=this.view[e]<<8,n|=this.view[e+1]),32768==(32768&n)&&(n=-(65535-n+1)),t&&(this.offset+=2),n},O.readShort=O.readInt16,O.writeUint16=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),n&&(this.offset+=2),this},O.writeUInt16=O.writeUint16,O.readUint16=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e],n|=this.view[e+1]<<8):(n=this.view[e]<<8,n|=this.view[e+1]),t&&(this.offset+=2),n},O.readUInt16=O.readUint16,O.writeInt32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),n&&(this.offset+=4),this},O.writeInt=O.writeInt32,O.readInt32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0):(n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),n|=0,t&&(this.offset+=4),n},O.readInt=O.readInt32,O.writeUint32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),n&&(this.offset+=4),this},O.writeUInt32=O.writeUint32,O.readUint32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0):(n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),t&&(this.offset+=4),n},O.readUInt32=O.readUint32,d&&(O.writeInt64=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"==typeof e)e=d.fromNumber(e);else if("string"==typeof e)e=d.fromString(e);else if(!(e&&e instanceof d))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=d.fromNumber(e):"string"==typeof e&&(e=d.fromString(e)),t+=8;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=8,r=e.low,e=e.high,this.littleEndian?(this.view[t+3]=r>>>24&255,this.view[t+2]=r>>>16&255,this.view[t+1]=r>>>8&255,this.view[t]=255&r,t+=4,this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e,t+=4,this.view[t]=r>>>24&255,this.view[t+1]=r>>>16&255,this.view[t+2]=r>>>8&255,this.view[t+3]=255&r),n&&(this.offset+=8),this},O.writeLong=O.writeInt64,O.readInt64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0,e+=4,r=this.view[e+2]<<16,r|=this.view[e+1]<<8,r|=this.view[e],r+=this.view[e+3]<<24>>>0):(r=this.view[e+1]<<16,r|=this.view[e+2]<<8,r|=this.view[e+3],r+=this.view[e]<<24>>>0,e+=4,n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),r=new d(n,r,!1),t&&(this.offset+=8),r},O.readLong=O.readInt64,O.writeUint64=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"==typeof e)e=d.fromNumber(e);else if("string"==typeof e)e=d.fromString(e);else if(!(e&&e instanceof d))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=d.fromNumber(e):"string"==typeof e&&(e=d.fromString(e)),t+=8;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=8,r=e.low,e=e.high,this.littleEndian?(this.view[t+3]=r>>>24&255,this.view[t+2]=r>>>16&255,this.view[t+1]=r>>>8&255,this.view[t]=255&r,t+=4,this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e,t+=4,this.view[t]=r>>>24&255,this.view[t+1]=r>>>16&255,this.view[t+2]=r>>>8&255,this.view[t+3]=255&r),n&&(this.offset+=8),this},O.writeUInt64=O.writeUint64,O.readUint64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0,e+=4,r=this.view[e+2]<<16,r|=this.view[e+1]<<8,r|=this.view[e],r+=this.view[e+3]<<24>>>0):(r=this.view[e+1]<<16,r|=this.view[e+2]<<8,r|=this.view[e+3],r+=this.view[e]<<24>>>0,e+=4,n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),r=new d(n,r,!0),t&&(this.offset+=8),r},O.readUInt64=O.readUint64),O.writeFloat32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=4,U(this.view,e,t,this.littleEndian,23,4),n&&(this.offset+=4),this},O.writeFloat=O.writeFloat32,O.readFloat32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return e=z(this.view,e,this.littleEndian,23,4),t&&(this.offset+=4),e},O.readFloat=O.readFloat32,O.writeFloat64=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=8;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=8,U(this.view,e,t,this.littleEndian,52,8),n&&(this.offset+=8),this},O.writeDouble=O.writeFloat64,O.readFloat64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}return e=z(this.view,e,this.littleEndian,52,8),t&&(this.offset+=8),e},O.readDouble=O.readFloat64,P.MAX_VARINT32_BYTES=5,P.calculateVarint32=function(e){return(e>>>=0)<128?1:e<16384?2:e<1<<21?3:e<1<<28?4:5},P.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},P.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},O.writeVarint32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r,i=P.calculateVarint32(e);t+=i;var o=this.buffer.byteLength;for(o<t&&this.resize((o*=2)>t?o:t),t-=i,e>>>=0;128<=e;)r=127&e|128,this.view[t++]=r,e>>>=7;return this.view[t++]=e,n?(this.offset=t,this):i},O.writeVarint32ZigZag=function(e,t){return this.writeVarint32(P.zigZagEncode32(e),t)},O.readVarint32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=0,r=0;do{if(!this.noAssert&&e>this.limit){var i=Error("Truncated");throw i.truncated=!0,i}}while(i=this.view[e++],n<5&&(r|=(127&i)<<7*n),++n,0!=(128&i));return r|=0,t?(this.offset=e,r):{value:r,length:n}},O.readVarint32ZigZag=function(e){return e=this.readVarint32(e),"object"===(0,o.default)(e)?e.value=P.zigZagDecode32(e.value):e=P.zigZagDecode32(e),e},d&&(P.MAX_VARINT64_BYTES=10,P.calculateVarint64=function(e){"number"==typeof e?e=d.fromNumber(e):"string"==typeof e&&(e=d.fromString(e));var t=e.toInt()>>>0,n=e.shiftRightUnsigned(28).toInt()>>>0;return 0==(e=e.shiftRightUnsigned(56).toInt()>>>0)?0==n?t<16384?t<128?1:2:t<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:e<128?9:10},P.zigZagEncode64=function(e){return"number"==typeof e?e=d.fromNumber(e,!1):"string"==typeof e?e=d.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned()),e.shiftLeft(1).xor(e.shiftRight(63)).toUnsigned()},P.zigZagDecode64=function(e){return"number"==typeof e?e=d.fromNumber(e,!1):"string"==typeof e?e=d.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned()),e.shiftRightUnsigned(1).xor(e.and(d.ONE).toSigned().negate()).toSigned()},O.writeVarint64=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"==typeof e)e=d.fromNumber(e);else if("string"==typeof e)e=d.fromString(e);else if(!(e&&e instanceof d))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=d.fromNumber(e,!1):"string"==typeof e?e=d.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned());var r=P.calculateVarint64(e),i=e.toInt()>>>0,o=e.shiftRightUnsigned(28).toInt()>>>0,a=e.shiftRightUnsigned(56).toInt()>>>0;switch(t+=r,(e=this.buffer.byteLength)<t&&this.resize((e*=2)>t?e:t),t-=r,r){case 10:this.view[t+9]=a>>>7&1;case 9:this.view[t+8]=9!==r?128|a:127&a;case 8:this.view[t+7]=8!==r?o>>>21|128:o>>>21&127;case 7:this.view[t+6]=7!==r?o>>>14|128:o>>>14&127;case 6:this.view[t+5]=6!==r?o>>>7|128:o>>>7&127;case 5:this.view[t+4]=5!==r?128|o:127&o;case 4:this.view[t+3]=4!==r?i>>>21|128:i>>>21&127;case 3:this.view[t+2]=3!==r?i>>>14|128:i>>>14&127;case 2:this.view[t+1]=2!==r?i>>>7|128:i>>>7&127;case 1:this.view[t]=1!==r?128|i:127&i}return n?(this.offset+=r,this):r},O.writeVarint64ZigZag=function(e,t){return this.writeVarint64(P.zigZagEncode64(e),t)},O.readVarint64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=e,r=0,i=0,o=0,a=0;if(r=127&(a=this.view[e++]),128&a&&(r|=(127&(a=this.view[e++]))<<7,(128&a||this.noAssert&&void 0===a)&&(r|=(127&(a=this.view[e++]))<<14,(128&a||this.noAssert&&void 0===a)&&(r|=(127&(a=this.view[e++]))<<21,(128&a||this.noAssert&&void 0===a)&&(i=127&(a=this.view[e++]),(128&a||this.noAssert&&void 0===a)&&(i|=(127&(a=this.view[e++]))<<7,(128&a||this.noAssert&&void 0===a)&&(i|=(127&(a=this.view[e++]))<<14,(128&a||this.noAssert&&void 0===a)&&(i|=(127&(a=this.view[e++]))<<21,(128&a||this.noAssert&&void 0===a)&&(o=127&(a=this.view[e++]),(128&a||this.noAssert&&void 0===a)&&(o|=(127&(a=this.view[e++]))<<7,128&a||this.noAssert&&void 0===a))))))))))throw Error("Buffer overrun");return o=d.fromBits(r|i<<28,i>>>4|o<<24,!1),t?(this.offset=e,o):{value:o,length:e-n}},O.readVarint64ZigZag=function(e){return(e=this.readVarint64(e))&&e.value instanceof d?e.value=P.zigZagDecode64(e.value):e=P.zigZagDecode64(e),e}),O.writeCString=function(e,t){var n=void 0===t;n&&(t=this.offset);var r,i=e.length;if(!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(r=0;r<i;++r)if(0===e.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}i=j.calculateUTF16asUTF8(B(e))[1],t+=i+1;var o=this.buffer.byteLength;return o<t&&this.resize((o*=2)>t?o:t),t-=i+1,j.encodeUTF16toUTF8(B(e),function(e){this.view[t++]=e}.bind(this)),this.view[t++]=0,n?(this.offset=t,this):i},O.readCString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n,r=e,i=-1;return j.decodeUTF8toUTF16(function(){if(0===i)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(i=this.view[e++])?null:i}.bind(this),n=G(),!0),t?(this.offset=e,n()):{string:n(),length:e-r}},O.writeIString=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r=t,i=j.calculateUTF16asUTF8(B(e),this.noAssert)[1];t+=4+i;var o=this.buffer.byteLength;if(o<t&&this.resize((o*=2)>t?o:t),t-=4+i,this.littleEndian?(this.view[t+3]=i>>>24&255,this.view[t+2]=i>>>16&255,this.view[t+1]=i>>>8&255,this.view[t]=255&i):(this.view[t]=i>>>24&255,this.view[t+1]=i>>>16&255,this.view[t+2]=i>>>8&255,this.view[t+3]=255&i),t+=4,j.encodeUTF16toUTF8(B(e),function(e){this.view[t++]=e}.bind(this)),t!==r+4+i)throw RangeError("Illegal range: Truncated data, "+t+" == "+(t+4+i));return n?(this.offset=t,this):t-r},O.readIString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=e,r=this.readUint32(e);return r=this.readUTF8String(r,P.METRICS_BYTES,e+=4),e+=r.length,t?(this.offset=e,r.string):{string:r.string,length:e-n}},P.METRICS_CHARS="c",P.METRICS_BYTES="b",O.writeUTF8String=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r=t,i=j.calculateUTF16asUTF8(B(e))[1];t+=i;var o=this.buffer.byteLength;return o<t&&this.resize((o*=2)>t?o:t),t-=i,j.encodeUTF16toUTF8(B(e),function(e){this.view[t++]=e}.bind(this)),n?(this.offset=t,this):t-r},O.writeString=O.writeUTF8String,P.calculateUTF8Chars=function(e){return j.calculateUTF16asUTF8(B(e))[0]},P.calculateUTF8Bytes=function(e){return j.calculateUTF16asUTF8(B(e))[1]},P.calculateString=P.calculateUTF8Bytes,O.readUTF8String=function(e,t,n){"number"==typeof t&&(n=t,t=void 0);var r=void 0===n;if(r&&(n=this.offset),void 0===t&&(t=P.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,o=0,a=n;if(t===P.METRICS_CHARS){if(i=G(),j.decodeUTF8(function(){return o<e&&n<this.limit?this.view[n++]:null}.bind(this),(function(e){++o,j.UTF8toUTF16(e,i)})),o!==e)throw RangeError("Illegal range: Truncated data, "+o+" == "+e);return r?(this.offset=n,i()):{string:i(),length:n-a}}if(t!==P.METRICS_BYTES)throw TypeError("Unsupported metrics: "+t);if(!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+"+e+") <= "+this.buffer.byteLength)}var s=n+e;if(j.decodeUTF8toUTF16(function(){return n<s?this.view[n++]:null}.bind(this),i=G(),this.noAssert),n!==s)throw RangeError("Illegal range: Truncated data, "+n+" == "+s);return r?(this.offset=n,i()):{string:i(),length:n-a}},O.readString=O.readUTF8String,O.writeVString=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r=t,i=j.calculateUTF16asUTF8(B(e),this.noAssert)[1],o=P.calculateVarint32(i);t+=o+i;var a=this.buffer.byteLength;if(a<t&&this.resize((a*=2)>t?a:t),t-=o+i,t+=this.writeVarint32(i,t),j.encodeUTF16toUTF8(B(e),function(e){this.view[t++]=e}.bind(this)),t!==r+i+o)throw RangeError("Illegal range: Truncated data, "+t+" == "+(t+i+o));return n?(this.offset=t,this):t-r},O.readVString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=e,r=this.readVarint32(e);return r=this.readUTF8String(r.value,P.METRICS_BYTES,e+=r.length),e+=r.length,t?(this.offset=e,r.string):{string:r.string,length:e-n}},O.append=function(e,t,n){"number"!=typeof t&&"string"==typeof t||(n=t,t=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}e instanceof P||(e=P.wrap(e,t));var i=e.limit-e.offset;return i<=0||(n+=i,(t=this.buffer.byteLength)<n&&this.resize((t*=2)>n?t:n),n-=i,this.view.set(e.view.subarray(e.offset,e.limit),n),e.offset+=i,r&&(this.offset+=i)),this},O.appendTo=function(e,t){return e.append(this,t),this},O.assert=function(e){return this.noAssert=!e,this},O.capacity=function(){return this.buffer.byteLength},O.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},O.clone=function(e){var t=new P(0,this.littleEndian,this.noAssert);return e?(t.buffer=new ArrayBuffer(this.buffer.byteLength),t.view=new Uint8Array(t.buffer)):(t.buffer=this.buffer,t.view=this.view),t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},O.compact=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(0===e&&t===this.buffer.byteLength)return this;var n=t-e;if(0===n)return this.buffer=D,this.view=null,0<=this.markedOffset&&(this.markedOffset-=e),this.offset=0,this.limit=0,this;var r=new ArrayBuffer(n),i=new Uint8Array(r);return i.set(this.view.subarray(e,t)),this.buffer=r,this.view=i,0<=this.markedOffset&&(this.markedOffset-=e),this.offset=0,this.limit=n,this},O.copy=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new P(0,this.littleEndian,this.noAssert);var n=t-e,r=new P(n,this.littleEndian,this.noAssert);return r.offset=0,r.limit=n,0<=r.markedOffset&&(r.markedOffset-=e),this.copyTo(r,0,e,t),r},O.copyTo=function(e,t,n,r){var i,o;if(!this.noAssert&&!P.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(o=void 0===t)?e.offset:0|t,n=(i=void 0===n)?this.offset:0|n,r=void 0===r?this.limit:0|r,t<0||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var a=r-n;return 0===a?e:(e.ensureCapacity(t+a),e.view.set(this.view.subarray(n,r),t),i&&(this.offset+=a),o&&(e.offset+=a),this)},O.ensureCapacity=function(e){var t=this.buffer.byteLength;return t<e?this.resize((t*=2)>e?t:e):this},O.fill=function(e,t,n){var r=void 0===t;if(r&&(t=this.offset),"string"==typeof e&&0<e.length&&(e=e.charCodeAt(0)),void 0===t&&(t=this.offset),void 0===n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,t<0||n<t||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(n<=t)return this;for(;t<n;)this.view[t++]=e;return r&&(this.offset=t),this},O.flip=function(){return this.limit=this.offset,this.offset=0,this},O.mark=function(e){if(e=void 0===e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},O.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},O.LE=function(e){return this.littleEndian=void 0===e||!!e,this},O.BE=function(e){return this.littleEndian=void 0!==e&&!e,this},O.prepend=function(e,t,n){"number"!=typeof t&&"string"==typeof t||(n=t,t=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}e instanceof P||(e=P.wrap(e,t));var i=e.limit-e.offset;if(i<=0)return this;var o,a=i-n;return 0<a?(o=new ArrayBuffer(this.buffer.byteLength+a),(t=new Uint8Array(o)).set(this.view.subarray(n,this.buffer.byteLength),i),this.buffer=o,this.view=t,this.offset+=a,0<=this.markedOffset&&(this.markedOffset+=a),this.limit+=a,n+=a):new Uint8Array(this.buffer),this.view.set(e.view.subarray(e.offset,e.limit),n-i),e.offset=e.limit,r&&(this.offset-=i),this},O.prependTo=function(e,t){return e.prepend(this,t),this},O.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},O.remaining=function(){return this.limit-this.offset},O.reset=function(){return 0<=this.markedOffset?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},O.resize=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if((e|=0)<0)throw RangeError("Illegal capacity: 0 <= "+e)}var t;return this.buffer.byteLength<e&&(t=new ArrayBuffer(e),(e=new Uint8Array(t)).set(this.view),this.buffer=t,this.view=e),this},O.reverse=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t||Array.prototype.reverse.call(this.view.subarray(e,t)),this},O.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},O.slice=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},O.toBuffer=function(e){var t=this.offset,n=this.limit;if(!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal limit: Not an integer");if(n>>>=0,t<0||n<t||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}return e||0!==t||n!==this.buffer.byteLength?t===n?D:(e=new ArrayBuffer(n-t),new Uint8Array(e).set(new Uint8Array(this.buffer).subarray(t,n),0),e):this.buffer},O.toArrayBuffer=O.toBuffer,O.toString=function(e,t,n){if(void 0===e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(n=t=e="utf8"),e){case"utf8":return this.toUTF8(t,n);case"base64":return this.toBase64(t,n);case"hex":return this.toHex(t,n);case"binary":return this.toBinary(t,n);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}};var V=function(){for(var e={},t=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],n=[],r=0,i=t.length;r<i;++r)n[t[r]]=r;return e.encode=function(e,n){for(var r,i;null!==(r=e());)n(t[r>>2&63]),i=(3&r)<<4,null!==(r=e())?(n(t[63&((i|=r>>4&15)|r>>4&15)]),i=(15&r)<<2,null!==(r=e())?(n(t[63&(i|r>>6&3)]),n(t[63&r])):(n(t[63&i]),n(61))):(n(t[63&i]),n(61),n(61))},e.decode=function(e,t){var r,i,o;function a(e){throw Error("Illegal character code: "+e)}for(;null!==(r=e());)if(void 0===(i=n[r])&&a(r),null!==(r=e())&&(void 0===(o=n[r])&&a(r),t(i<<2>>>0|(48&o)>>4),null!==(r=e()))){if(void 0===(i=n[r])){if(61===r)break;a(r)}if(t((15&o)<<4>>>0|(60&i)>>2),null!==(r=e())){if(void 0===(o=n[r])){if(61===r)break;a(r)}t((3&i)<<6>>>0|o)}}},e.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)},e}();O.toBase64=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity||t<e)throw RangeError("begin, end");var n;return V.encode(function(){return e<t?this.view[e++]:null}.bind(this),n=G()),n()},P.fromBase64=function(e,t){if("string"!=typeof e)throw TypeError("str");var n=new P(e.length/4*3,t),r=0;return V.decode(B(e),(function(e){n.view[r++]=e})),n.limit=r,n},P.btoa=function(e){return P.fromBinary(e).toBase64()},P.atob=function(e){return P.fromBase64(e).toBinary()},O.toBinary=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity()||t<e)throw RangeError("begin, end");if(e===t)return"";for(var n=[],r=[];e<t;)n.push(this.view[e++]),1024<=n.length&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},P.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var n,r=0,i=e.length,o=new P(i,t);r<i;){if(255<(n=e.charCodeAt(r)))throw RangeError("illegal char code: "+n);o.view[r++]=n}return o.limit=i,o},O.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,i="",o="",a="";n<r;){if(-1!==n&&(i+=(t=this.view[n])<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(o+=32<t&&t<127?String.fromCharCode(t):".")),++n,e&&0<n&&n%16==0&&n!==r){for(;i.length<51;)i+=" ";a+=i+o+"\n",i=o=""}n===this.offset&&n===this.limit?i+=n===this.markedOffset?"!":"|":n===this.offset?i+=n===this.markedOffset?"[":"<":n===this.limit?i+=n===this.markedOffset?"]":">":i+=n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";a+=i+o+"\n"}return e?a:i},P.fromDebug=function(e,t,n){for(var r,i,o=e.length,a=new P((o+1)/3|0,t,n),u=0,l=0,c=!1,h=!1,f=!1,d=!1,p=!1;u<o;){switch(r=e.charAt(u++)){case"!":if(!n){if(h||f||d){p=!0;break}h=f=d=!0}a.offset=a.markedOffset=a.limit=l,c=!1;break;case"|":if(!n){if(h||d){p=!0;break}h=d=!0}a.offset=a.limit=l,c=!1;break;case"[":if(!n){if(h||f){p=!0;break}h=f=!0}a.offset=a.markedOffset=l,c=!1;break;case"<":if(!n){if(h){p=!0;break}h=!0}a.offset=l,c=!1;break;case"]":if(!n){if(d||f){p=!0;break}d=f=!0}a.limit=a.markedOffset=l,c=!1;break;case">":if(!n){if(d){p=!0;break}d=!0}a.limit=l,c=!1;break;case"'":if(!n){if(f){p=!0;break}f=!0}a.markedOffset=l,c=!1;break;case" ":c=!1;break;default:if(!n&&c){p=!0;break}if(i=(0,s.default)(r+e.charAt(u++),16),!n&&(isNaN(i)||i<0||255<i))throw TypeError("Illegal str: Not a debug encoded string");a.view[l++]=i,c=!0}if(p)throw TypeError("Illegal str: Invalid symbol at "+u)}if(!n){if(!h||!d)throw TypeError("Illegal str: Missing offset or limit");if(l<a.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+l+" < "+o)}return a},O.toHex=function(e,t){if(e=void 0===e?this.offset:e,t=void 0===t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);e<t;)(n=this.view[e++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},P.fromHex=function(e,t,n){if(!n){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var r,i=e.length,o=new P(i/2|0,t),a=0,u=0;a<i;a+=2){if(r=(0,s.default)(e.substring(a,a+2),16),!n&&(!isFinite(r)||r<0||255<r))throw TypeError("Illegal str: Contains non-hex characters");o.view[u++]=r}return o.limit=u,o};var H,j=(H={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):(n<2048?t(n>>6&31|192):(n<65536?t(n>>12&15|224):(t(n>>18&7|240),t(n>>12&63|128)),t(n>>6&63|128)),t(63&n|128)),n=null},decodeUTF8:function(e,t){for(var n,r,i,o,a=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0==(128&n))t(n);else if(192==(224&n))null===(r=e())&&a([n,r]),t((31&n)<<6|63&r);else if(224==(240&n))null!==(r=e())&&null!==(i=e())||a([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);null!==(r=e())&&null!==(i=e())&&null!==(o=e())||a([n,r,i,o]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},UTF16toUTF8:function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());)55296<=n&&n<=57343&&null!==(r=e())&&56320<=r&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)},UTF8toUTF16:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(55296+((n-=65536)>>10)),t(n%1024+56320)),n=null},encodeUTF16toUTF8:function(e,t){H.UTF16toUTF8(e,(function(e){H.encodeUTF8(e,t)}))},decodeUTF8toUTF16:function(e,t){H.decodeUTF8(e,(function(e){H.UTF8toUTF16(e,t)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t,n=0;null!==(t=e());)n+=t<128?1:t<2048?2:t<65536?3:4;return n},calculateUTF16asUTF8:function(e){var t=0,n=0;return H.UTF16toUTF8(e,(function(e){++t,n+=e<128?1:e<2048?2:e<65536?3:4})),[t,n]}},H);O.toUTF8=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n;try{j.decodeUTF8toUTF16(function(){return e<t?this.view[e++]:null}.bind(this),n=G())}catch(n){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return n()},P.fromUTF8=function(e,t,n){if(!n&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var r=new P(j.calculateUTF16asUTF8(B(e),!0)[1],t,n),i=0;return j.encodeUTF16toUTF8(B(e),(function(e){r.view[i++]=e})),r.limit=i,r};var W,Y,q,X,Z,J,K={};function Q(e){e.messages&&e.messages.forEach((function(t){t.syntax=e.syntax,Q(t)})),e.enums&&e.enums.forEach((function(t){t.syntax=e.syntax}))}function $(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}t.ProtoBuf=K,K.ByteBuffer=P,K.Long=P.Long||null,K.VERSION="5.0.1",K.WIRE_TYPES={},K.WIRE_TYPES.VARINT=0,K.WIRE_TYPES.BITS64=1,K.WIRE_TYPES.LDELIM=2,K.WIRE_TYPES.STARTGROUP=3,K.WIRE_TYPES.ENDGROUP=4,K.WIRE_TYPES.BITS32=5,K.PACKABLE_WIRE_TYPES=[K.WIRE_TYPES.VARINT,K.WIRE_TYPES.BITS64,K.WIRE_TYPES.BITS32],K.TYPES={int32:{name:"int32",wireType:K.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:K.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:K.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:K.WIRE_TYPES.VARINT,defaultValue:K.Long?K.Long.ZERO:void 0},uint64:{name:"uint64",wireType:K.WIRE_TYPES.VARINT,defaultValue:K.Long?K.Long.UZERO:void 0},sint64:{name:"sint64",wireType:K.WIRE_TYPES.VARINT,defaultValue:K.Long?K.Long.ZERO:void 0},bool:{name:"bool",wireType:K.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:K.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:K.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:K.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:K.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:K.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:K.WIRE_TYPES.BITS64,defaultValue:K.Long?K.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:K.WIRE_TYPES.BITS64,defaultValue:K.Long?K.Long.ZERO:void 0},float:{name:"float",wireType:K.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:K.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:K.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:K.WIRE_TYPES.STARTGROUP,defaultValue:null}},K.MAP_KEY_TYPES=[K.TYPES.int32,K.TYPES.sint32,K.TYPES.sfixed32,K.TYPES.uint32,K.TYPES.fixed32,K.TYPES.int64,K.TYPES.sint64,K.TYPES.sfixed64,K.TYPES.uint64,K.TYPES.fixed64,K.TYPES.bool,K.TYPES.string,K.TYPES.bytes],K.ID_MIN=1,K.ID_MAX=536870911,K.convertFieldsToCamelCase=!1,K.populateAccessors=!0,K.populateDefaults=!0,K.Util=((W={}).IS_NODE=!("object"!==(void 0===e?"undefined":(0,o.default)(e))||e+""!="[object process]"||e.browser),W.XHR=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=null,n=0;n<e.length;n++){try{t=e[n]()}catch(e){continue}break}if(!t)throw Error("XMLHttpRequest is not supported");return t},W.fetch=function(e,t){if(t&&"function"!=typeof t&&(t=null),W.IS_NODE){var r=n(383);if(t)r.readFile(e,(function(e,n){t(e?null:""+n)}));else try{return r.readFileSync(e)}catch(e){return null}}else{var i=W.XHR();if(i.open("GET",e,!!t),i.setRequestHeader("Accept","text/plain"),"function"==typeof i.overrideMimeType&&i.overrideMimeType("text/plain"),!t)return i.send(null),200==i.status||0==i.status&&"string"==typeof i.responseText?i.responseText:null;i.onreadystatechange=function(){4==i.readyState&&(200==i.status||0==i.status&&"string"==typeof i.responseText?t(i.responseText):t(null))},4!=i.readyState&&i.send(null)}},W.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,(function(e,t){return t.toUpperCase()}))},W),K.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},K.DotProto=function(e,t){var n={},r=function(e){this.source=e+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null};(i=r.prototype)._readString=function(){var e='"'===this._stringOpen?t.STRING_DQ:t.STRING_SQ;e.lastIndex=this.index-1;var n=e.exec(this.source);if(!n)throw Error("unterminated string");return this.index=e.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,n[1]},i.next=function(){if(0<this.stack.length)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();var e,n,r;do{for(e=!1;t.WHITESPACE.test(r=this.source.charAt(this.index));)if("\n"===r&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,e=!0}else{if("*"!==(r=this.source.charAt(this.index)))return"/";do{if("\n"===r&&++this.line,++this.index===this.source.length)return null}while(n=r,r=this.source.charAt(this.index),"*"!==n||"/"!==r);++this.index,e=!0}}while(e);if(this.index===this.source.length)return null;var i=this.index;t.DELIM.lastIndex=0;var o=t.DELIM.test(this.source.charAt(i++));if(!o)for(;i<this.source.length&&!t.DELIM.test(this.source.charAt(i));)++i;return'"'!==(o=this.source.substring(this.index,this.index=i))&&"'"!==o||(this._stringOpen=o),o},i.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},i.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},i.omit=function(e){return this.peek()===e&&(this.next(),!0)},i.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},n.Tokenizer=r;var i,o=function(e){this.tn=new r(e),this.proto3=!1};function a(e,n){var r=-1,i=1;if("-"==e.charAt(0)&&(i=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))r=(0,s.default)(e);else if(t.NUMBER_HEX.test(e))r=(0,s.default)(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("illegal id value: "+(i<0?"-":"")+e);r=(0,s.default)(e.substring(1),8)}if(r=i*r|0,!n&&r<0)throw Error("illegal id value: "+(i<0?"-":"")+e);return r}function c(e){var n=1;if("-"==e.charAt(0)&&(n=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return n*(0,s.default)(e,10);if(t.NUMBER_HEX.test(e))return n*(0,s.default)(e.substring(2),16);if(t.NUMBER_OCT.test(e))return n*(0,s.default)(e.substring(1),8);if("inf"===e)return 1/0*n;if("nan"===e)return NaN;if(t.NUMBER_FLT.test(e))return n*(0,u.default)(e);throw Error("illegal number value: "+(n<0?"-":"")+e)}function h(e,t,n){void 0===e[t]?e[t]=n:((0,l.default)(e[t])||(e[t]=[e[t]]),e[t].push(n))}return(i=o.prototype).parse=function(){var e,n,r={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},i=!0;try{for(;e=this.tn.next();)switch(e){case"package":if(!i||null!==r.package)throw Error("unexpected 'package'");if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("illegal package name: "+e);this.tn.skip(";"),r.package=e;break;case"import":if(!i)throw Error("unexpected 'import'");"public"!==(e=this.tn.peek())&&!(n="weak"===e)||this.tn.next(),e=this._readString(),this.tn.skip(";"),n||r.imports.push(e);break;case"syntax":if(!i)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(r.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(r,null),i=!1;break;case"enum":this._parseEnum(r),i=!1;break;case"option":this._parseOption(r);break;case"service":this._parseService(r);break;case"extend":this._parseExtend(r);break;default:throw Error("unexpected '"+e+"'")}}catch(e){throw e.message="Parse error at line "+this.tn.line+": "+e.message,e}return delete r.name,r},o.parse=function(e){return new o(e).parse()},i._readString=function(){var e,t="";do{if("'"!==(e=this.tn.next())&&'"'!==e)throw Error("illegal string delimiter: "+e)}while(t+=this.tn.next(),this.tn.skip(e),'"'===(e=this.tn.peek())||'"'===e);return t},i._readValue=function(e){var n=this.tn.peek();if('"'===n||"'"===n)return this._readString();if(this.tn.next(),t.NUMBER.test(n))return c(n);if(t.BOOL.test(n))return"true"===n.toLowerCase();if(e&&t.TYPEREF.test(n))return n;throw Error("illegal value: "+n)},i._parseOption=function(e,n){var r=this.tn.next(),i=!1;if("("===r&&(i=!0,r=this.tn.next()),!t.TYPEREF.test(r))throw Error("illegal option name: "+r);var o=r;i&&(this.tn.skip(")"),o="("+o+")",r=this.tn.peek(),t.FQTYPEREF.test(r)&&(o+=r,this.tn.next())),this.tn.skip("="),this._parseOptionValue(e,o),n||this.tn.skip(";")},i._parseOptionValue=function(e,n){var r=this.tn.peek();if("{"!==r)h(e.options,n,this._readValue(!0));else for(this.tn.skip("{");"}"!==(r=this.tn.next());){if(!t.NAME.test(r))throw Error("illegal option name: "+n+"."+r);this.tn.omit(":")?h(e.options,n+"."+r,this._readValue(!0)):this._parseOptionValue(e,n+"."+r)}},i._parseService=function(e){var n=this.tn.next();if(!t.NAME.test(n))throw Error("illegal service name at line "+this.tn.line+": "+n);var r={name:n,rpc:{},options:{}};for(this.tn.skip("{");"}"!==(n=this.tn.next());)if("option"===n)this._parseOption(r);else{if("rpc"!==n)throw Error("illegal service token: "+n);this._parseServiceRPC(r)}this.tn.omit(";"),e.services.push(r)},i._parseServiceRPC=function(e){var n="rpc",r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal rpc service method name: "+r);var i=r,o={request:null,response:null,request_stream:!1,response_stream:!1,options:{}};if(this.tn.skip("("),"stream"===(r=this.tn.next()).toLowerCase()&&(o.request_stream=!0,r=this.tn.next()),!t.TYPEREF.test(r))throw Error("illegal rpc service request type: "+r);if(o.request=r,this.tn.skip(")"),"returns"!==(r=this.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+r);if(this.tn.skip("("),"stream"===(r=this.tn.next()).toLowerCase()&&(o.response_stream=!0,r=this.tn.next()),o.response=r,this.tn.skip(")"),"{"===(r=this.tn.peek())){for(this.tn.next();"}"!==(r=this.tn.next());){if("option"!==r)throw Error("illegal rpc service token: "+r);this._parseOption(o)}this.tn.omit(";")}else this.tn.skip(";");void 0===e[n]&&(e[n]={}),e[n][i]=o},i._parseMessage=function(e,n){var r=!!n,i=this.tn.next(),o={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!t.NAME.test(i))throw Error("illegal "+(r?"group":"message")+" name: "+i);for(o.name=i,r&&(this.tn.skip("="),n.id=a(this.tn.next()),o.isGroup=!0),"["===(i=this.tn.peek())&&n&&this._parseFieldOptions(n),this.tn.skip("{");"}"!==(i=this.tn.next());)if(t.RULE.test(i))this._parseMessageField(o,i);else if("oneof"===i)this._parseMessageOneOf(o);else if("enum"===i)this._parseEnum(o);else if("message"===i)this._parseMessage(o);else if("option"===i)this._parseOption(o);else if("service"===i)this._parseService(o);else if("extensions"===i)o.extensions=this._parseExtensionRanges();else if("reserved"===i)this._parseIgnored();else if("extend"===i)this._parseExtend(o);else{if(!t.TYPEREF.test(i))throw Error("illegal message token: "+i);if(!this.proto3)throw Error("illegal field rule: "+i);this._parseMessageField(o,"optional",i)}return this.tn.omit(";"),e.messages.push(o),o},i._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},i._parseMessageField=function(e,n,r){if(!t.RULE.test(n))throw Error("illegal message field rule: "+n);var i,o={rule:n,type:"",name:"",options:{},id:0};if("map"===n){if(r)throw Error("illegal type: "+r);if(this.tn.skip("<"),i=this.tn.next(),!t.TYPE.test(i)&&!t.TYPEREF.test(i))throw Error("illegal message field type: "+i);if(o.keytype=i,this.tn.skip(","),i=this.tn.next(),!t.TYPE.test(i)&&!t.TYPEREF.test(i))throw Error("illegal message field: "+i);if(o.type=i,this.tn.skip(">"),i=this.tn.next(),!t.NAME.test(i))throw Error("illegal message field name: "+i);o.name=i,this.tn.skip("="),o.id=a(this.tn.next()),"["===(i=this.tn.peek())&&this._parseFieldOptions(o),this.tn.skip(";")}else if("group"===(r=void 0!==r?r:this.tn.next())){if(n=this._parseMessage(e,o),!/^[A-Z]/.test(n.name))throw Error("illegal group name: "+n.name);o.type=n.name,o.name=n.name.toLowerCase(),this.tn.omit(";")}else{if(!t.TYPE.test(r)&&!t.TYPEREF.test(r))throw Error("illegal message field type: "+r);if(o.type=r,i=this.tn.next(),!t.NAME.test(i))throw Error("illegal message field name: "+i);o.name=i,this.tn.skip("="),o.id=a(this.tn.next()),"["===(i=this.tn.peek())&&this._parseFieldOptions(o),this.tn.skip(";")}return e.fields.push(o),o},i._parseMessageOneOf=function(e){var n=this.tn.next();if(!t.NAME.test(n))throw Error("illegal oneof name: "+n);var r,i=n,o=[];for(this.tn.skip("{");"}"!==(n=this.tn.next());)(r=this._parseMessageField(e,"optional",n)).oneof=i,o.push(r.id);this.tn.omit(";"),e.oneofs[i]=o},i._parseFieldOptions=function(e){this.tn.skip("[");for(var t=!0;"]"!==this.tn.peek();)t||this.tn.skip(","),this._parseOption(e,!0),t=!1;this.tn.next()},i._parseEnum=function(e){var n={name:"",values:[],options:{}},r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal name: "+r);for(n.name=r,this.tn.skip("{");"}"!==(r=this.tn.next());)if("option"===r)this._parseOption(n);else{if(!t.NAME.test(r))throw Error("illegal name: "+r);this.tn.skip("=");var i={name:r,id:a(this.tn.next(),!0)};"["===(r=this.tn.peek())&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),n.values.push(i)}this.tn.omit(";"),e.enums.push(n)},i._parseExtensionRanges=function(){var t,n,r,i=[];do{for(n=[];;){switch(t=this.tn.next()){case"min":r=e.ID_MIN;break;case"max":r=e.ID_MAX;break;default:r=c(t)}if(n.push(r),2===n.length)break;if("to"!==this.tn.peek()){n.push(r);break}this.tn.next()}}while(i.push(n),this.tn.omit(","));return this.tn.skip(";"),i},i._parseExtend=function(e){var n=this.tn.next();if(!t.TYPEREF.test(n))throw Error("illegal extend reference: "+n);var r={ref:n,fields:[]};for(this.tn.skip("{");"}"!==(n=this.tn.next());)if(t.RULE.test(n))this._parseMessageField(r,n);else{if(!t.TYPEREF.test(n))throw Error("illegal extend token: "+n);if(!this.proto3)throw Error("illegal field rule: "+n);this._parseMessageField(r,"optional",n)}return this.tn.omit(";"),e.messages.push(r),r},i.toString=function(){return"Parser at line "+this.tn.line},n.Parser=o,n}(K,K.Lang),K.Reflect=function(e){var t={},n=function(e,t,n){this.builder=e,this.parent=t,this.name=n,this.className};(d=n.prototype).fqn=function(){for(var e=this.name,t=this;null!=(t=t.parent);)e=t.name+"."+e;return e},d.toString=function(e){return(e?this.className+" ":"")+this.fqn()},d.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},t.T=n;var r=function(e,t,r,i,o){n.call(this,e,t,r),this.className="Namespace",this.children=[],this.options=i||{},this.syntax=o||"proto2"},i=r.prototype=(0,c.default)(n.prototype);i.getChildren=function(e){if(null==(e=e||null))return this.children.slice();for(var t=[],n=0,r=this.children.length;n<r;++n)this.children[n]instanceof e&&t.push(this.children[n]);return t},i.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof g.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof g.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},i.getChild=function(e){for(var t="number"==typeof e?"id":"name",n=0,r=this.children.length;n<r;++n)if(this.children[n][t]===e)return this.children[n];return null},i.resolve=function(e,n){var r,i="string"==typeof e?e.split("."):e,o=this,a=0;if(""===i[a]){for(;null!==o.parent;)o=o.parent;a++}do{do{if(!(o instanceof t.Namespace)){o=null;break}if(!(r=o.getChild(i[a]))||!(r instanceof t.T)||n&&!(r instanceof t.Namespace)){o=null;break}}while(o=r,++a<i.length);if(null!=o)break;if(null!==this.parent)return this.parent.resolve(e,n)}while(null!=o);return o},i.qn=function(e){for(var n=[],r=e;n.unshift(r.name),null!==(r=r.parent););for(var i=1;i<=n.length;i++){var o=n.slice(n.length-i);if(e===this.resolve(o,e instanceof t.Namespace))return o.join(".")}return e.fqn()},i.build=function(){for(var e,t={},n=this.children,i=0,o=n.length;i<o;++i)(e=n[i])instanceof r&&(t[e.name]=e.build());return a.default&&(0,a.default)(t,"$options",{value:this.buildOpt()}),t},i.buildOpt=function(){for(var e={},t=(0,h.default)(this.options),n=0,r=t.length;n<r;++n){var i=t[n],o=this.options[t[n]];e[i]=o}return e},i.getOption=function(e){return void 0===e?this.options:void 0!==this.options[e]?this.options[e]:null},t.Namespace=r;var u=function(t,n,r,i){if(this.type=t,this.resolvedType=n,this.isMapKey=r,this.syntax=i,r&&e.MAP_KEY_TYPES.indexOf(t)<0)throw Error("Invalid map key type: "+t.name)},d=u.prototype;function p(t,n){if(t&&"number"==typeof t.low&&"number"==typeof t.high&&"boolean"==typeof t.unsigned&&t.low==t.low&&t.high==t.high)return new e.Long(t.low,t.high,void 0===n?t.unsigned:n);if("string"==typeof t)return e.Long.fromString(t,n||!1,10);if("number"==typeof t)return e.Long.fromNumber(t,n||!1);throw Error("not convertible to Long")}u.defaultFieldValue=function(t){if("string"==typeof t&&(t=e.TYPES[t]),void 0===t.defaultValue)throw Error("default value for type "+t.name+" is not supported");return t==e.TYPES.bytes?new P(0):t.defaultValue},d.verifyValue=function(t){var n=this;function r(e,t){throw Error("Illegal value for "+n.toString(!0)+" of type "+n.type.name+": "+e+" ("+t+")")}switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:return("number"!=typeof t||t==t&&t%1!=0)&&r((0,o.default)(t),"not an integer"),4294967295<t?0|t:t;case e.TYPES.uint32:case e.TYPES.fixed32:return("number"!=typeof t||t==t&&t%1!=0)&&r((0,o.default)(t),"not an integer"),t<0?t>>>0:t;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:if(e.Long)try{return p(t,!1)}catch(i){r((0,o.default)(t),i.message)}else r((0,o.default)(t),"requires Long.js");case e.TYPES.uint64:case e.TYPES.fixed64:if(e.Long)try{return p(t,!0)}catch(i){r((0,o.default)(t),i.message)}else r((0,o.default)(t),"requires Long.js");case e.TYPES.bool:return"boolean"!=typeof t&&r((0,o.default)(t),"not a boolean"),t;case e.TYPES.float:case e.TYPES.double:return"number"!=typeof t&&r((0,o.default)(t),"not a number"),t;case e.TYPES.string:return"string"==typeof t||t&&t instanceof String||r((0,o.default)(t),"not a string"),""+t;case e.TYPES.bytes:return P.isByteBuffer(t)?t:P.wrap(t,"base64");case e.TYPES.enum:for(var i=this.resolvedType.getChildren(e.Reflect.Enum.Value),a=0;a<i.length;a++){if(i[a].name==t)return i[a].id;if(i[a].id==t)return i[a].id}if("proto3"===this.syntax)return("number"!=typeof t||t==t&&t%1!=0)&&r((0,o.default)(t),"not an integer"),(4294967295<t||t<0)&&r((0,o.default)(t),"not in range for uint32"),t;r(t,"not a valid enum value");case e.TYPES.group:case e.TYPES.message:if(t&&"object"===(0,o.default)(t)||r((0,o.default)(t),"object expected"),t instanceof this.resolvedType.clazz)return t;if(t instanceof e.Builder.Message){var s={};for(a in t)t.hasOwnProperty(a)&&(s[a]=t[a]);t=s}return new this.resolvedType.clazz(t)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+t+" (undefined type "+this.type+")")},d.calculateLength=function(t,n){if(null===n)return 0;var r;switch(this.type){case e.TYPES.int32:return n<0?P.calculateVarint64(n):P.calculateVarint32(n);case e.TYPES.uint32:return P.calculateVarint32(n);case e.TYPES.sint32:return P.calculateVarint32(P.zigZagEncode32(n));case e.TYPES.fixed32:case e.TYPES.sfixed32:case e.TYPES.float:return 4;case e.TYPES.int64:case e.TYPES.uint64:return P.calculateVarint64(n);case e.TYPES.sint64:return P.calculateVarint64(P.zigZagEncode64(n));case e.TYPES.fixed64:case e.TYPES.sfixed64:return 8;case e.TYPES.bool:return 1;case e.TYPES.enum:return P.calculateVarint32(n);case e.TYPES.double:return 8;case e.TYPES.string:return r=P.calculateUTF8Bytes(n),P.calculateVarint32(r)+r;case e.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");return P.calculateVarint32(n.remaining())+n.remaining();case e.TYPES.message:return r=this.resolvedType.calculate(n),P.calculateVarint32(r)+r;case e.TYPES.group:return(r=this.resolvedType.calculate(n))+P.calculateVarint32(t<<3|e.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")},d.encodeValue=function(t,n,r){if(null===n)return r;switch(this.type){case e.TYPES.int32:n<0?r.writeVarint64(n):r.writeVarint32(n);break;case e.TYPES.uint32:r.writeVarint32(n);break;case e.TYPES.sint32:r.writeVarint32ZigZag(n);break;case e.TYPES.fixed32:r.writeUint32(n);break;case e.TYPES.sfixed32:r.writeInt32(n);break;case e.TYPES.int64:case e.TYPES.uint64:r.writeVarint64(n);break;case e.TYPES.sint64:r.writeVarint64ZigZag(n);break;case e.TYPES.fixed64:r.writeUint64(n);break;case e.TYPES.sfixed64:r.writeInt64(n);break;case e.TYPES.bool:"string"==typeof n?r.writeVarint32("false"===n.toLowerCase()?0:!!n):r.writeVarint32(n?1:0);break;case e.TYPES.enum:r.writeVarint32(n);break;case e.TYPES.float:r.writeFloat32(n);break;case e.TYPES.double:r.writeFloat64(n);break;case e.TYPES.string:r.writeVString(n);break;case e.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");var i=n.offset;r.writeVarint32(n.remaining()),r.append(n),n.offset=i;break;case e.TYPES.message:i=(new P).LE(),this.resolvedType.encode(n,i),r.writeVarint32(i.offset),r.append(i.flip());break;case e.TYPES.group:this.resolvedType.encode(n,r),r.writeVarint32(t<<3|e.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")}return r},d.decode=function(t,n,r){if(n!=this.type.wireType)throw Error("Unexpected wire type for element");var i,o;switch(this.type){case e.TYPES.int32:return 0|t.readVarint32();case e.TYPES.uint32:return t.readVarint32()>>>0;case e.TYPES.sint32:return 0|t.readVarint32ZigZag();case e.TYPES.fixed32:return t.readUint32()>>>0;case e.TYPES.sfixed32:return 0|t.readInt32();case e.TYPES.int64:return t.readVarint64();case e.TYPES.uint64:return t.readVarint64().toUnsigned();case e.TYPES.sint64:return t.readVarint64ZigZag();case e.TYPES.fixed64:return t.readUint64();case e.TYPES.sfixed64:return t.readInt64();case e.TYPES.bool:return!!t.readVarint32();case e.TYPES.enum:return t.readVarint32();case e.TYPES.float:return t.readFloat();case e.TYPES.double:return t.readDouble();case e.TYPES.string:return t.readVString();case e.TYPES.bytes:if(o=t.readVarint32(),t.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+t.remaining());return(i=t.clone()).limit=i.offset+o,t.offset+=o,i;case e.TYPES.message:return o=t.readVarint32(),this.resolvedType.decode(t,o);case e.TYPES.group:return this.resolvedType.decode(t,-1,r)}throw Error("[INTERNAL] Illegal decode type")},d.valueFromString=function(t){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:case e.TYPES.uint32:case e.TYPES.fixed32:return this.verifyValue((0,s.default)(t));case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:case e.TYPES.uint64:case e.TYPES.fixed64:return this.verifyValue(t);case e.TYPES.bool:return"true"===t;case e.TYPES.string:return this.verifyValue(t);case e.TYPES.bytes:return P.fromBinary(t)}},d.valueToString=function(t){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===e.TYPES.bytes?t.toString("binary"):t.toString()},t.Element=u;var g=function(e,t,n,i,o,a){r.call(this,e,t,n,i,a),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!o,this._fields=null,this._fieldsById=null,this._fieldsByName=null};function m(t,n){var r=n.readVarint32(),i=7&r,o=r>>>3;switch(i){case e.WIRE_TYPES.VARINT:for(;128==(128&(r=n.readUint8())););break;case e.WIRE_TYPES.BITS64:n.offset+=8;break;case e.WIRE_TYPES.LDELIM:r=n.readVarint32(),n.offset+=r;break;case e.WIRE_TYPES.STARTGROUP:m(o,n);break;case e.WIRE_TYPES.ENDGROUP:if(o===t)return!1;throw Error("Illegal GROUPEND after unknown group: "+o+" ("+t+" expected)");case e.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+t+": "+i)}return!0}(d=g.prototype=(0,c.default)(r.prototype)).build=function(t){if(this.clazz&&!t)return this.clazz;var n=function(e,t){var n=t.getChildren(e.Reflect.Message.Field),r=t.getChildren(e.Reflect.Message.OneOf),i=function i(a,s){e.Builder.Message.call(this);for(var u,c=0,h=r.length;c<h;++c)this[r[c].name]=null;for(c=0,h=n.length;c<h;++c){var f=n[c];this[f.name]=f.repeated?[]:f.map?new e.Map(f):null,!f.required&&"proto3"!==t.syntax||null===f.defaultValue||(this[f.name]=f.defaultValue)}if(0<arguments.length)if(1!==arguments.length||null===a||"object"!==(0,o.default)(a)||!("function"!=typeof a.encode||a instanceof i)||(0,l.default)(a)||a instanceof e.Map||P.isByteBuffer(a)||a instanceof ArrayBuffer||e.Long&&a instanceof e.Long)for(c=0,h=arguments.length;c<h;++c)void 0!==(u=arguments[c])&&this.$set(n[c].name,u);else this.$set(a)},s=i.prototype=(0,c.default)(e.Builder.Message.prototype);s.add=function(n,r,i){var o=t._fieldsByName[n];if(!i){if(!o)throw Error(this+"#"+n+" is undefined");if(!(o instanceof e.Reflect.Message.Field))throw Error(this+"#"+n+" is not a field: "+o.toString(!0));if(!o.repeated)throw Error(this+"#"+n+" is not a repeated field");r=o.verifyValue(r,!0)}return null===this[n]&&(this[n]=[]),this[n].push(r),this},s.$add=s.add,s.set=function(n,r,i){if(n&&"object"===(0,o.default)(n)){for(var a in i=r,n)n.hasOwnProperty(a)&&void 0!==(r=n[a])&&this.$set(a,r,i);return this}var s,u=t._fieldsByName[n];if(i)this[n]=r;else{if(!u)throw Error(this+"#"+n+" is not a field: undefined");if(!(u instanceof e.Reflect.Message.Field))throw Error(this+"#"+n+" is not a field: "+u.toString(!0));this[u.name]=r=u.verifyValue(r)}return u&&u.oneof&&(s=this[u.oneof.name],null!==r?(null!==s&&s!==u.name&&(this[s]=null),this[u.oneof.name]=u.name):s===n&&(this[u.oneof.name]=null)),this},s.$set=s.set,s.get=function(n,r){if(r)return this[n];if(!((r=t._fieldsByName[n])&&r instanceof e.Reflect.Message.Field))throw Error(this+"#"+n+" is not a field: undefined");if(!(r instanceof e.Reflect.Message.Field))throw Error(this+"#"+n+" is not a field: "+r.toString(!0));return this[r.name]},s.$get=s.get;for(var u=0;u<n.length;u++){var h=n[u];h instanceof e.Reflect.Message.ExtensionField||t.builder.options.populateAccessors&&function(e){var n=(n=e.originalName.replace(/(_[a-zA-Z])/g,(function(e){return e.toUpperCase().replace("_","")}))).substring(0,1).toUpperCase()+n.substring(1),r=e.originalName.replace(/([A-Z])/g,(function(e){return"_"+e})),i=function(t,n){return this[e.name]=n?t:e.verifyValue(t),this},o=function(){return this[e.name]};null===t.getChild("set"+n)&&(s["set"+n]=i),null===t.getChild("set_"+r)&&(s["set_"+r]=i),null===t.getChild("get"+n)&&(s["get"+n]=o),null===t.getChild("get_"+r)&&(s["get_"+r]=o)}(h)}function d(t,n,r,i){if(null===t||"object"!==(0,o.default)(t)){if(i&&i instanceof e.Reflect.Enum){var a=e.Reflect.Enum.getName(i.object,t);if(null!==a)return a}return t}if(P.isByteBuffer(t))return n?t.toBase64():t.toBuffer();if(e.Long.isLong(t))return r?t.toString():e.Long.fromValue(t);var s;if((0,l.default)(t))return s=[],t.forEach((function(e,t){s[t]=d(e,n,r,i)})),s;if(s={},t instanceof e.Map){for(var u=t.entries(),c=u.next();!c.done;c=u.next())s[t.keyElem.valueToString(c.value[0])]=d(c.value[1],n,r,t.valueElem.resolvedType);return s}var h,f=t.$type,p=void 0;for(h in t)t.hasOwnProperty(h)&&(f&&(p=f.getChild(h))?s[h]=d(t[h],n,r,p.resolvedType):s[h]=d(t[h],n,r));return s}return s.encode=function(e,n){"boolean"==typeof e&&(n=e,e=void 0);var r=!1;e||(e=new P,r=!0);var i=e.littleEndian;try{return t.encode(this,e.LE(),n),(r?e.flip():e).LE(i)}catch(n){throw e.LE(i),n}},i.encode=function(e,t,n){return new i(e).encode(t,n)},s.calculate=function(){return t.calculate(this)},s.encodeDelimited=function(e,n){var r=!1;e||(e=new P,r=!0);var i=(new P).LE();return t.encode(this,i,n).flip(),e.writeVarint32(i.remaining()),e.append(i),r?e.flip():e},s.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},s.toArrayBuffer=s.encodeAB,s.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},s.toBuffer=s.encodeNB,s.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},s.toBase64=s.encode64,s.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},s.toHex=s.encodeHex,s.toRaw=function(e,t){return d(this,!!e,!!t,this.$type)},s.encodeJSON=function(){return(0,f.default)(d(this,!0,!0,this.$type))},i.decode=function(e,n,r){"string"==typeof n&&(r=n,n=-1),"string"==typeof e&&(e=P.wrap(e,r||"base64")),r=(e=P.isByteBuffer(e)?e:P.wrap(e)).littleEndian;try{var i=t.decode(e.LE());return e.LE(r),i}catch(n){throw e.LE(r),n}},i.decodeDelimited=function(e,n){if("string"==typeof e&&(e=P.wrap(e,n||"base64")),(e=P.isByteBuffer(e)?e:P.wrap(e)).remaining()<1)return null;var r=e.offset;if(n=e.readVarint32(),e.remaining()<n)return e.offset=r,null;try{var i=t.decode(e.slice(e.offset,e.offset+n).LE());return e.offset+=n,i}catch(r){throw e.offset+=n,r}},i.decode64=function(e){return i.decode(e,"base64")},i.decodeHex=function(e){return i.decode(e,"hex")},i.decodeJSON=function(e){return new i(JSON.parse(e))},s.toString=function(){return t.toString()},a.default&&((0,a.default)(i,"$options",{value:t.buildOpt()}),(0,a.default)(s,"$options",{value:i.$options}),(0,a.default)(i,"$type",{value:t}),(0,a.default)(s,"$type",{value:t})),i}(e,this);this._fields=[],this._fieldsById={},this._fieldsByName={};for(var r,i=0,s=this.children.length;i<s;i++)if((r=this.children[i])instanceof y||r instanceof g||r instanceof x){if(n.hasOwnProperty(r.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+r.toString(!0)+" cannot override static property '"+r.name+"'");n[r.name]=r.build()}else if(r instanceof g.Field)r.build(),this._fields.push(r),this._fieldsById[r.id]=r,this._fieldsByName[r.name]=r;else if(!(r instanceof g.OneOf||r instanceof _))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[i].toString(!0));return this.clazz=n},d.encode=function(e,t,n){for(var r,i,o=null,a=0,s=this._fields.length;a<s;++a)i=e[(r=this._fields[a]).name],r.required&&null===i?null===o&&(o=r):r.encode(n?i:r.verifyValue(i),t,e);if(null===o)return t;var u=Error("Missing at least one required field for "+this.toString(!0)+": "+o);throw u.encoded=t,u},d.calculate=function(e){for(var t,n,r=0,i=0,o=this._fields.length;i<o;++i){if(n=e[(t=this._fields[i]).name],t.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);r+=t.calculate(n,e)}return r},d.decode=function(t,n,r){n="number"==typeof n?n:-1;for(var i,o,a,s,u,l=t.offset,c=new this.clazz;t.offset<l+n||-1===n&&0<t.remaining();){if(a=(i=t.readVarint32())>>>3,(o=7&i)===e.WIRE_TYPES.ENDGROUP){if(a!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(r?r+" expected":"not a group")+")");break}if(s=this._fieldsById[a])s.repeated&&!s.options.packed?c[s.name].push(s.decode(o,t)):s.map?(u=s.decode(o,t),c[s.name].set(u[0],u[1])):(c[s.name]=s.decode(o,t),s.oneof&&(null!==(u=c[s.oneof.name])&&u!==s.name&&(c[u]=null),c[s.oneof.name]=s.name));else switch(o){case e.WIRE_TYPES.VARINT:t.readVarint32();break;case e.WIRE_TYPES.BITS32:t.offset+=4;break;case e.WIRE_TYPES.BITS64:t.offset+=8;break;case e.WIRE_TYPES.LDELIM:var h=t.readVarint32();t.offset+=h;break;case e.WIRE_TYPES.STARTGROUP:for(;m(a,t););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+o)}}for(var f=0,d=this._fields.length;f<d;++f)if(null===c[(s=this._fields[f]).name])if("proto3"===this.syntax)c[s.name]=s.defaultValue;else{if(s.required){var p=Error("Missing at least one required field for "+this.toString(!0)+": "+s.name);throw p.decoded=c,p}e.populateDefaults&&null!==s.defaultValue&&(c[s.name]=s.defaultValue)}return c},t.Message=g;var v=function(t,r,i,o,a,s,u,l,c,h){n.call(this,t,r,s),this.className="Message.Field",this.required="required"===i,this.repeated="repeated"===i,this.map="map"===i,this.keyType=o||null,this.type=a,this.resolvedType=null,this.id=u,this.options=l||{},this.defaultValue=null,this.oneof=c||null,this.syntax=h||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof g.ExtensionField||(this.name=e.Util.toCamelCase(this.name))};(d=v.prototype=(0,c.default)(n.prototype)).build=function(){this.element=new u(this.type,this.resolvedType,!1,this.syntax),this.map&&(this.keyElement=new u(this.keyType,void 0,!0,this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=u.defaultFieldValue(this.type)},d.verifyValue=function(t,n){n=n||!1;var r=this;function i(e,t){throw Error("Illegal value for "+r.toString(!0)+" of type "+r.type.name+": "+e+" ("+t+")")}if(null===t)return this.required&&i((0,o.default)(t),"required"),"proto3"===this.syntax&&this.type!==e.TYPES.message&&i((0,o.default)(t),"proto3 field without field presence cannot be null"),null;if(!this.repeated||n)return this.map&&!n?t instanceof e.Map?t:(t instanceof Object||i((0,o.default)(t),"expected ProtoBuf.Map or raw object for map field"),new e.Map(this,t)):(!this.repeated&&(0,l.default)(t)&&i((0,o.default)(t),"no array expected"),this.element.verifyValue(t));(0,l.default)(t)||(t=[t]);for(var a=[],s=0;s<t.length;s++)a.push(this.element.verifyValue(t[s]));return a},d.hasWirePresence=function(t,n){if("proto3"!==this.syntax)return null!==t;if(this.oneof&&n[this.oneof.name]===this.name)return!0;switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:case e.TYPES.uint32:case e.TYPES.fixed32:return 0!==t;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:case e.TYPES.uint64:case e.TYPES.fixed64:return 0!==t.low||0!==t.high;case e.TYPES.bool:return t;case e.TYPES.float:case e.TYPES.double:return 0!==t;case e.TYPES.string:return 0<t.length;case e.TYPES.bytes:return 0<t.remaining();case e.TYPES.enum:return 0!==t;case e.TYPES.message:return null!==t;default:return!0}},d.encode=function(t,n,r){if(null===this.type||"object"!==(0,o.default)(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===t||this.repeated&&0==t.length)return n;try{if(this.repeated)if(this.options.packed&&0<=e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)){n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.ensureCapacity(n.offset+=1);for(var i=n.offset,a=0;a<t.length;a++)this.element.encodeValue(this.id,t[a],n);var s,u=n.offset-i,l=P.calculateVarint32(u);1<l&&(s=n.slice(i,n.offset),i+=l-1,n.offset=i,n.append(s)),n.writeVarint32(u,i-l)}else for(a=0;a<t.length;a++)n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,t[a],n);else this.map?t.forEach((function(t,r,i){var o=P.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,r)+P.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,t);n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.writeVarint32(o),n.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,r,n),n.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,t,n)}),this):this.hasWirePresence(t,r)&&(n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,t,n))}catch(r){throw Error("Illegal value for "+this.toString(!0)+": "+t+" ("+r+")")}return n},d.calculate=function(t,n){if(t=this.verifyValue(t),null===this.type||"object"!==(0,o.default)(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===t||this.repeated&&0==t.length)return 0;var r,i,a=0;try{if(this.repeated)if(this.options.packed&&0<=e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)){for(a+=P.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),i=0,r=0;r<t.length;r++)i+=this.element.calculateLength(this.id,t[r]);a+=P.calculateVarint32(i),a+=i}else for(r=0;r<t.length;r++)a+=P.calculateVarint32(this.id<<3|this.type.wireType),a+=this.element.calculateLength(this.id,t[r]);else this.map?t.forEach((function(t,n,r){t=P.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,n)+P.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,t),a+=P.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),a+=P.calculateVarint32(t),a+=t}),this):this.hasWirePresence(t,n)&&(a+=P.calculateVarint32(this.id<<3|this.type.wireType),a+=this.element.calculateLength(this.id,t))}catch(n){throw Error("Illegal value for "+this.toString(!0)+": "+t+" ("+n+")")}return a},d.decode=function(t,n,r){if(!(!this.map&&t==this.type.wireType||!r&&this.repeated&&this.options.packed&&t==e.WIRE_TYPES.LDELIM||this.map&&t==e.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+t+" ("+this.type.wireType+" expected)");if(t==e.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&0<=e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)&&!r){for(var i=n.readVarint32(),o=(i=n.offset+i,[]);n.offset<i;)o.push(this.decode(this.type.wireType,n,!0));return o}if(this.map){var a=u.defaultFieldValue(this.keyType),s=u.defaultFieldValue(this.type);if(i=n.readVarint32(),n.remaining()<i)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+i+" required but got only "+n.remaining());var l=n.clone();for(l.limit=l.offset+i,n.offset+=i;0<l.remaining();){var c=l.readVarint32();if(t=7&c,1==(c>>>=3))a=this.keyElement.decode(l,t,c);else{if(2!==c)throw Error("Unexpected tag in map field key/value submessage");s=this.element.decode(l,t,c)}}return[a,s]}return this.element.decode(n,t,this.id)},t.Message.Field=v,d=function(e,t,n,r,i,o,a){v.call(this,e,t,n,null,r,i,o,a),this.extension},d.prototype=(0,c.default)(v.prototype),t.Message.ExtensionField=d,d=function(e,t,r){n.call(this,e,t,r),this.fields=[]},t.Message.OneOf=d;var y=function(e,t,n,i,o){r.call(this,e,t,n,i,o),this.className="Enum",this.object=null};y.getName=function(e,t){for(var n,r=(0,h.default)(e),i=0;i<r.length;++i)if(e[n=r[i]]===t)return n;return null},(d=y.prototype=(0,c.default)(r.prototype)).build=function(t){if(this.object&&!t)return this.object;for(var n=new e.Builder.Enum,r=this.getChildren(y.Value),i=0,o=r.length;i<o;++i)n[r[i].name]=r[i].id;return a.default&&(0,a.default)(n,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=n},t.Enum=y,d=function(e,t,r,i){n.call(this,e,t,r),this.className="Enum.Value",this.id=i},d.prototype=(0,c.default)(n.prototype),t.Enum.Value=d;var _=function(e,t,r,i){n.call(this,e,t,r),this.field=i};_.prototype=(0,c.default)(n.prototype),t.Extension=_;var x=function(e,t,n,i){r.call(this,e,t,n,i),this.className="Service",this.clazz=null};(d=x.prototype=(0,c.default)(r.prototype)).build=function(t){return this.clazz&&!t?this.clazz:this.clazz=function(e,t){for(var n=function(t){e.Builder.Service.call(this),this.rpcImpl=t||function(e,t,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},r=n.prototype=(0,c.default)(e.Builder.Service.prototype),i=t.getChildren(e.Reflect.Service.RPCMethod),s=0;s<i.length;s++)!function(e){r[e.name]=function(n,r){try{try{n=e.resolvedRequestType.clazz.decode(P.wrap(n))}catch(n){if(!(n instanceof TypeError))throw n}if(null===n||"object"!==(0,o.default)(n))throw Error("Illegal arguments");n instanceof e.resolvedRequestType.clazz||(n=new e.resolvedRequestType.clazz(n)),this.rpcImpl(e.fqn(),n,(function(n,i){if(n)r(n);else{null===i&&(i="");try{i=e.resolvedResponseType.clazz.decode(i)}catch(n){}i&&i instanceof e.resolvedResponseType.clazz?r(null,i):r(Error("Illegal response type received in service method "+t.name+"#"+e.name))}}))}catch(n){setTimeout(r.bind(this,n),0)}},n[e.name]=function(t,r,i){new n(t)[e.name](r,i)},a.default&&((0,a.default)(n[e.name],"$options",{value:e.buildOpt()}),(0,a.default)(r[e.name],"$options",{value:n[e.name].$options}))}(i[s]);return a.default&&((0,a.default)(n,"$options",{value:t.buildOpt()}),(0,a.default)(r,"$options",{value:n.$options}),(0,a.default)(n,"$type",{value:t}),(0,a.default)(r,"$type",{value:t})),n}(e,this)},t.Service=x;var A=function(e,t,r,i){n.call(this,e,t,r),this.className="Service.Method",this.options=i||{}};return(d=A.prototype=(0,c.default)(n.prototype)).buildOpt=i.buildOpt,t.Service.Method=A,i=function(e){function t(t,n,r,i,o,a,s,u){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,r,i,o,a,s){A.call(this,e,t,n,s),this.className="Service.RPCMethod",this.requestName=r,this.responseName=i,this.requestStream=o,this.responseStream=a,this.resolvedRequestType=null,this.resolvedResponseType=null})),i.prototype=(0,c.default)(A.prototype),t.Service.RPCMethod=i,t}(K),K.Builder=(Y=K,q=K.Lang,X=K.Reflect,Z=function(e){this.ns=new X.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},i=Z.prototype,Z.isMessage=function(e){return"string"==typeof e.name&&void 0===e.values&&void 0===e.rpc},Z.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&void 0!==e.id},Z.isEnum=function(e){return"string"==typeof e.name&&!(void 0===e.values||!(0,l.default)(e.values)||0===e.values.length)},Z.isService=function(e){return!("string"!=typeof e.name||"object"!==(0,o.default)(e.rpc)||!e.rpc)},Z.isExtend=function(e){return"string"==typeof e.ref},i.reset=function(){return this.ptr=this.ns,this},i.define=function(e){if("string"!=typeof e||!q.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach((function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new X.Namespace(this,this.ptr,e)),this.ptr=t}),this),this},i.create=function(e){if(!e)return this;if((0,l.default)(e)){if(0===e.length)return this;e=e.slice()}else e=[e];for(var t=[e];0<t.length;){if(e=t.pop(),!(0,l.default)(e))throw Error("not a valid namespace: "+(0,f.default)(e));for(;0<e.length;){var n=e.shift();if(Z.isMessage(n)){var r=new X.Message(this,this.ptr,n.name,n.options,n.isGroup,n.syntax),i={};n.oneofs&&(0,h.default)(n.oneofs).forEach((function(e){r.addChild(i[e]=new X.Message.OneOf(this,r,e))}),this),n.fields&&n.fields.forEach((function(e){if(null!==r.getChild(0|e.id))throw Error("duplicate or invalid field id in "+r.name+": "+e.id);if(e.options&&"object"!==(0,o.default)(e.options))throw Error("illegal field options in "+r.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=i[e.oneof]))throw Error("illegal oneof in "+r.name+"#"+e.name+": "+e.oneof);e=new X.Message.Field(this,r,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,n.syntax),t&&t.fields.push(e),r.addChild(e)}),this);var a=[];if(n.enums&&n.enums.forEach((function(e){a.push(e)})),n.messages&&n.messages.forEach((function(e){a.push(e)})),n.services&&n.services.forEach((function(e){a.push(e)})),n.extensions&&("number"==typeof n.extensions[0]?r.extensions=[n.extensions]:r.extensions=n.extensions),this.ptr.addChild(r),0<a.length){t.push(e),e=a,a=null,this.ptr=r,r=null;continue}a=null}else if(Z.isEnum(n))r=new X.Enum(this,this.ptr,n.name,n.options,n.syntax),n.values.forEach((function(e){r.addChild(new X.Enum.Value(this,r,e.name,e.id))}),this),this.ptr.addChild(r);else if(Z.isService(n))r=new X.Service(this,this.ptr,n.name,n.options),(0,h.default)(n.rpc).forEach((function(e){var t=n.rpc[e];r.addChild(new X.Service.RPCMethod(this,r,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))}),this),this.ptr.addChild(r);else{if(!Z.isExtend(n))throw Error("not a valid definition: "+(0,f.default)(n));if(r=this.ptr.resolve(n.ref,!0))n.fields.forEach((function(e){if(null!==r.getChild(0|e.id))throw Error("duplicate extended field id in "+r.name+": "+e.id);if(r.extensions){var t=!1;if(r.extensions.forEach((function(n){e.id>=n[0]&&e.id<=n[1]&&(t=!0)})),!t)throw Error("illegal extended field id in "+r.name+": "+e.id+" (not within valid ranges)")}var n=e.name;this.options.convertFieldsToCamelCase&&(n=Y.Util.toCamelCase(n));var i=new X.Message.ExtensionField(this,r,e.rule,e.type,this.ptr.fqn()+"."+n,e.id,e.options);n=new X.Extension(this,this.ptr,e.name,i),i.extension=n,this.ptr.addChild(n),r.addChild(i)}),this);else if(!/\.?google\.protobuf\./.test(n.ref))throw Error("extended message "+n.ref+" is not defined")}n=null,r=null}e=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},i.import=function(e,t){var r="/";if("string"==typeof t){if(Y.Util.IS_NODE&&(t=n(214).resolve(t)),!0===this.files[t])return this.reset();this.files[t]=!0}else if("object"===(0,o.default)(t)){var i=t.root;if(Y.Util.IS_NODE&&(i=n(214).resolve(i)),(0<=i.indexOf("\\")||0<=t.file.indexOf("\\"))&&(r="\\"),i=i+r+t.file,!0===this.files[i])return this.reset();this.files[i]=!0}if(e.imports&&0<e.imports.length){var a;i=!1,"object"===(0,o.default)(t)?(this.importRoot=t.root,i=!0,a=this.importRoot,t=t.file,(0<=a.indexOf("\\")||0<=t.indexOf("\\"))&&(r="\\")):"string"==typeof t?this.importRoot?a=this.importRoot:0<=t.indexOf("/")?""===(a=t.replace(/\/[^\/]*$/,""))&&(a="/"):0<=t.indexOf("\\")?(a=t.replace(/\\[^\\]*$/,""),r="\\"):a=".":a=null;for(var s=0;s<e.imports.length;s++)if("string"==typeof e.imports[s]){if(!a)throw Error("cannot determine import root");var u=e.imports[s];if("google/protobuf/descriptor.proto"!==u&&(u=a+r+u,!0!==this.files[u])){/\.proto$/i.test(u)&&!Y.DotProto&&(u=u.replace(/\.proto$/,".json"));var l=Y.Util.fetch(u);if(null===l)throw Error("failed to import '"+u+"' in '"+t+"': file not found");/\.json$/i.test(u)?this.import(JSON.parse(l+""),u):this.import(Y.DotProto.Parser.parse(l),u)}}else t?/\.(\w+)$/.test(t)?this.import(e.imports[s],t.replace(/^(.+)\.(\w+)$/,(function(e,t,n){return t+"_import"+s+"."+n}))):this.import(e.imports[s],t+"_import"+s):this.import(e.imports[s]);i&&(this.importRoot=null)}e.package&&this.define(e.package),e.syntax&&Q(e);var c=this.ptr;return e.options&&(0,h.default)(e.options).forEach((function(t){c.options[t]=e.options[t]})),e.messages&&(this.create(e.messages),this.ptr=c),e.enums&&(this.create(e.enums),this.ptr=c),e.services&&(this.create(e.services),this.ptr=c),e.extends&&this.create(e.extends),this.reset()},i.resolveAll=function(){var e;if(null==this.ptr||"object"===(0,o.default)(this.ptr.type))return this;if(this.ptr instanceof X.Namespace)this.ptr.children.forEach((function(e){this.ptr=e,this.resolveAll()}),this);else if(this.ptr instanceof X.Message.Field){if(q.TYPE.test(this.ptr.type))this.ptr.type=Y.TYPES[this.ptr.type];else{if(!q.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(e=(this.ptr instanceof X.Message.ExtensionField?this.ptr.extension:this.ptr).parent.resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=e,e instanceof X.Enum){if(this.ptr.type=Y.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==e.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(e instanceof X.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=e.isGroup?Y.TYPES.group:Y.TYPES.message}}if(this.ptr.map){if(!q.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=Y.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof Y.Reflect.Service.Method){if(!(this.ptr instanceof Y.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((e=this.ptr.parent.resolve(this.ptr.requestName,!0))&&e instanceof Y.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=e,!((e=this.ptr.parent.resolve(this.ptr.responseName,!0))&&e instanceof Y.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=e}else if(!(this.ptr instanceof Y.Reflect.Message.OneOf||this.ptr instanceof Y.Reflect.Extension||this.ptr instanceof Y.Reflect.Enum.Value))throw Error("illegal object in namespace: "+(0,o.default)(this.ptr)+": "+this.ptr);return this.reset()},i.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(var t="string"==typeof e?e.split("."):e,n=this.result,r=0;r<t.length;r++){if(!n[t[r]]){n=null;break}n=n[t[r]]}return n},i.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},i.toString=function(){return"Builder"},Z.Message=function(){},Z.Enum=function(){},Z.Service=function(){},Z),K.Map=(J=K.Reflect,e=function(e,t){if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new J.Element(e.keyType,null,!0,e.syntax),this.valueElem=new J.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},(0,a.default)(this,"size",{get:function(){return(0,h.default)(this.map).length}}),t)for(var n=(0,h.default)(t),r=0;r<n.length;r++){var i=this.keyElem.valueFromString(n[r]),o=this.valueElem.verifyValue(t[n[r]]);this.map[this.keyElem.valueToString(i)]={key:i,value:o}}},(i=e.prototype).clear=function(){this.map={}},i.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));return e=t in this.map,delete this.map[t],e},i.entries=function(){for(var e,t=[],n=(0,h.default)(this.map),r=0;r<n.length;r++)t.push([(e=this.map[n[r]]).key,e.value]);return $(t)},i.keys=function(){for(var e=[],t=(0,h.default)(this.map),n=0;n<t.length;n++)e.push(this.map[t[n]].key);return $(e)},i.values=function(){for(var e=[],t=(0,h.default)(this.map),n=0;n<t.length;n++)e.push(this.map[t[n]].value);return $(e)},i.forEach=function(e,t){for(var n,r=(0,h.default)(this.map),i=0;i<r.length;i++)e.call(t,(n=this.map[r[i]]).value,n.key,this)},i.set=function(e,t){return e=this.keyElem.verifyValue(e),t=this.valueElem.verifyValue(t),this.map[this.keyElem.valueToString(e)]={key:e,value:t},this},i.get=function(e){if((e=this.keyElem.valueToString(this.keyElem.verifyValue(e)))in this.map)return this.map[e].value},i.has=function(e){return(e=this.keyElem.valueToString(this.keyElem.verifyValue(e)))in this.map},e),K.loadProto=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=void 0),K.loadJson(K.DotProto.Parser.parse(e),t,n)},K.protoFromString=K.loadProto,K.loadProtoFile=function(e,t,n){if(t&&"object"===(0,o.default)(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return K.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,K.loadProto(r,n,e))}catch(r){t(r)}else t(Error("Failed to fetch file"))}));var r=K.Util.fetch("object"===(0,o.default)(e)?e.root+"/"+e.file:e);return null===r?null:K.loadProto(r,n,e)},K.protoFromFile=K.loadProtoFile,K.newBuilder=function(e){return void 0===(e=e||{}).convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=K.convertFieldsToCamelCase),void 0===e.populateAccessors&&(e.populateAccessors=K.populateAccessors),new K.Builder(e)},K.loadJson=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),t&&"object"===(0,o.default)(t)||(t=K.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t.import(e,n),t.resolveAll(),t},K.loadJsonFile=function(e,t,n){if(t&&"object"===(0,o.default)(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return K.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,K.loadJson(JSON.parse(r),n,e))}catch(r){t(r)}else t(Error("Failed to fetch file"))}));var r=K.Util.fetch("object"===(0,o.default)(e)?e.root+"/"+e.file:e);return null===r?null:K.loadJson(JSON.parse(r),n,e)}}).call(this,n(156))},function(e,t,n){"use strict";var r=n(16),i=n(17),o=n(18),a=n(11),s=n(0);n(13),n(14);var u=n(1);s(t,"__esModule",{value:!0}),t.default=void 0,n(9),n(8),n(21),n(103),n(62);var l=u(n(35)),c=u(n(19)),h=u(n(48)),f=u(n(2)),d=u(n(3)),p=u(n(86)),g=u(n(219));function m(e,t){var n=void 0!==i&&e[o]||e["@@iterator"];if(!n){if(a(e)||(n=v(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw s}}}}function v(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(){function e(t,n,r){(0,f.default)(this,e),this.groups={},this._id=t,this._center=new fm.Vector2,this._mapcenter=new fm.Vector2(n.scene.x,n.scene.y),this._theme=null,this.parent=r,this.layerGroups=n.scene.layerGroups,this._bbox={max:new fm.Vector2(-1/0,-1/0),min:new fm.Vector2(1/0,1/0)},this._bboxTh={max:new fm.Vector2(-1/0,-1/0),min:new fm.Vector2(1/0,1/0)},this._bbox.max.x=n.scene.maxX,this._bbox.max.y=n.scene.maxY,this._bbox.min.x=n.scene.minX,this._bbox.min.y=n.scene.minY,this._bboxTh.max.x=n.scene.maxX-n.scene.x,this._bboxTh.max.y=n.scene.maxY-n.scene.y,this._bboxTh.min.x=n.scene.minX-n.scene.x,this._bboxTh.min.y=n.scene.minY-n.scene.y,this._groupIds=[],this.initGroupByData(n),this._spcace=(0,l.default)(n.scene.layerGroups[0].height)}return(0,d.default)(e,[{key:"getNeedLoadGroup",value:function(e,t){var n,r=[],i=m(this.layerGroups);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=-1<e.indexOf(o.gid);t&&(a=!a),!o.loaded&&a&&r.push({gid:o.gid,url:this.getGroupLoadUrl(o.gname,o.gid),layerData:o})}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"getGroupLoadUrl",value:function(e,t){return"floor."+e}},{key:"getLastAndNextName",value:function(e,t){e=""+e;var n,r,i,o=m(this.layerGroups);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.gid===t-1&&(n="_"+a.gname),a.gid===t+1&&(r="_"+a.gname)}}catch(e){o.e(e)}finally{o.f()}return e+((n=n||"_no")+(r||"_no"))}},{key:"initGroupByData",value:function(e){var t=e.floors;this._groupLength=t.length;for(var n=0;n<t.length;n++)this.addGroup(t[n].gid,t[n],e.scene.layerGroups[n])}},{key:"addGroup",value:function(e,t,n){this._groupIds.push(e),(t=new g.default(e,t,n)).hideWithFree=this.parent.map.MapOptions.autoDispose,t.parent=this,n=(0,l.default)(e),t.height=this._space*n,-1<this.parent.map.visibleGroupIDs.indexOf(e)?t.visible=!0:t.visible=!1,this.groups[e+""]=t}},{key:"changeTheme",value:function(e,t){var n=this;this._theme=e;var r,i,o=["extent","model","label","facility"],a=function(t){n.groups[t].traverseByAlias(o,(function(i,o){switch(o){case"extent":r=e;break;case"model":r=(r=n.parent.map.MapOptions.useStoreApply?e.getStoreApplyTheme(i.bdata.fid):void 0)||e.getModelTheme(i.bdata),r=(0,c.default)(r,{logoPath:e.data.logoPath});break;case"label":r=e.getLabelTheme(i.bdata);break;case"facility":r=e.getPoiTheme(i.bdata)}i.renderNodeInited&&(i.setByTheme(r),n.parent.checkMaterialAlpha(i.renderNode,(0,l.default)(t)),"model"==o&&n.parent.checkMaterialAlpha(i.line,(0,l.default)(t)))}))};for(i in this.groups)a(i)}},{key:"getAllGroupLayerByAlias",value:function(e,t){for(var n in this.groups){var r,i=m(n=this.groups[n].layers[e]);try{for(i.s();!(r=i.n()).done;)t(r.value)}catch(e){i.e(e)}finally{i.f()}}}},{key:"getFacilityByFilter",value:function(e,t){var n,r=[],i=m(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=this.groups[o];if(a){for(var s=0,u=["imageMarker","textMarker","facility"];s<u.length;s++){var l,c=u[s],h=m(a.getLayers(c));try{for(h.s();!(l=h.n()).done;)for(var f=l.value,d=0;d<f.scene.children.length;d++)t&&!t(f.scene.children[d])||r.push(f.scene.children[d])}catch(e){h.e(e)}finally{h.f()}}for(var p=a._locationScene.children,g=0;g<p.length;g++)t&&!t(p[g])||r.push(p[g])}}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"getSpriteInfo",value:function(e,t,n,r){e.updateMatrixWorld(!0);var i=(i=(i=(new fm.Vector3).setFromMatrixPosition(e.matrixWorld)).applyMatrix4(n.matrixWorldInverse)).applyMatrix4(n.projectionMatrix),o=(r=e.mapNode.size/r*2,t?((o=this.parent._map.labelLanguage==p.default.ZH?e.mapNode.name:e.mapNode.ename)&&(r*=a=o.split("%rn%").length),r/e.material.userData.scaleRatio):r);"PerspectiveCamera"===n.type&&(i.x*=n.aspect);var a={x:i.x-o/2,y:i.y+r/2};return n={x:i.x+o/2,y:i.y-r/2},"micromessenger"==(r=window.navigator.userAgent.toLowerCase()).match(/MicroMessenger/i)&&(a.x=i.x-o,n.x=i.x+o),{target:e,z:e.mapNode.eid,position:i,leftTop:a,rightDown:n}}},{key:"getMarkers",value:function(e,t,n){var r=[];if(!(h=this.groups[e]))return r;var i,o=m(e=h.getLayers("facility"));try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.needAvoid)for(var s=0;s<a.scene.children.length;s++){var u,l=a.scene.children[s];l.mapNode.needAvoid&&l.mapNode.show&&(u=this.getSpriteInfo(l,!1,t,n),r.push(u))}}}catch(e){o.e(e)}finally{o.f()}var c,h,f=m(h=h.getLayers("label"));try{for(f.s();!(c=f.n()).done;)for(var d=c.value,p=0;p<d.scene.children.length;p++){var g,v=d.scene.children[p];v.mapNode.needAvoid&&d.needAvoid&&v.mapNode.show&&(v.mapNode.renderNode.visible=!0,g=this.getSpriteInfo(v,!0,t,n),r.push(g))}}catch(e){f.e(e)}finally{f.f()}return r.sort((function(e,t){return e.z-t.z})),r}},{key:"getAllImageMarker",value:function(e){var t=[];if(!(e=this.groups[e]))return t;for(var n=e.layers.imageMarker,r=0;r<n.length;r++)for(var i=0;i<n[r].scene.children.length;i++){var o=n[r].scene.children[i];t.push(o)}return t}},{key:"getUserMarkers",value:function(e,t,n){var r=[];if(!(e=this.groups[e]))return r;for(var i=e.layers.imageMarker,o=0;o<i.length;o++){var a=[];if(i[o].needAvoid){for(var s=0;s<i[o].scene.children.length;s++){var u=i[o].scene.children[s];u.mapNode.needAvoid&&u.mapNode.show&&(u=this.getSpriteInfo(u,!1,t,n),a.push(u))}r.push(a)}}for(var l=e.layers.textMarker,c=0;c<l.length;c++){var h=[];if(l[c].needAvoid){for(var f=0;f<l[c].scene.children.length;f++){var d=l[c].scene.children[f];d.mapNode.needAvoid&&d.mapNode.show&&(d=this.getSpriteInfo(d,!0,t,n),h.push(d))}r.push(h)}}return r}},{key:"getNodesExceptFacility",value:function(e,t){var n,r=[],i=m(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=this.groups[o];a&&a.everyLayers(["facility","label","imageMarker","textMarker","dynmodel"],(function(e){for(var n=0;n<e.children.length;n++)t&&!t(e.children[n])||r.push(e.children[n])}))}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"getDynnodes",value:function(e,t){var n,r=[],i=m(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=this.groups[o];a&&a.getDynmodel((function(t){for(var n=0;n<t.children.length;n++)e&&!e(t.children[n])||r.push(t.children[n])}))}}catch(t){i.e(t)}finally{i.f()}return r}},{key:"getGroupsModels",value:function(e){var t,n=[],r=m(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=this.groups[i];if(o){var a,s=m(o.getLayers("model"));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.checkSceneNode(),n=n.concat(u.scene.children)}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"getGroupsExternalModels",value:function(e){var t,n=[],r=m(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=this.groups[i];if(o){var a,s=m(o.getLayers("externalModel"));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.checkSceneNode();for(var l=0;l<u.scene.children.length;l++)u.scene.children[l].traverse((function(e){e instanceof fm.Mesh&&n.push(e)}))}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"getGroupsNodelsByFilter",value:function(e,t,n){var r,i=[],o=m(e);try{for(o.s();!(r=o.n()).done;){var a,s=r.value,u=this.groups[s];for(a in u.layers)if(t===a){var l,c=m(u.layers[a]);try{for(c.s();!(l=c.n()).done;)l.value.traverse((function(e){n(e)&&i.push({nodeType:e.nodeType,typeID:e.bdata&&e.bdata.type,data:e.bdata,target:e})}))}catch(e){c.e(e)}finally{c.f()}}}}catch(e){o.e(e)}finally{o.f()}return i}},{key:"getNodesExpectExtent",value:function(e){var t,n=[],r=m(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.groups[i].everyLayers(["extent"],(function(e){n.push.apply(n,(0,h.default)(e.children))}))}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"getRenderGroup",value:function(){var e,t=[];for(e in this.groups)this.groups[e].visible&&t.push(this.groups[e]);return t.sort((function(e,t){return e.getHeight()-t.getHeight()}))}},{key:"getLastRenderArray",value:function(){var e,t=[];for(e in this.groups)t.push.apply(t,(0,h.default)(this.groups[e].alwaysShowMarkers));return t}},{key:"getHeight",value:function(e){return this.groups[""+e]?this.groups[""+e].getHeight():this._space*e}},{key:"setLabelLanguage",value:function(e){for(var t in this.groups)this.groups[t].traverseByAlias(["label"],(function(t){t.setByLanguage(e)}))}},{key:"mapcenter",get:function(){return(new fm.Vector2).copy(this._mapcenter)}},{key:"dispose",value:function(){for(var e in this.groups)this.groups[e].dispose(),this.groups[e].parent=void 0,this.groups[e]=void 0;this.groups=void 0,this._theme&&(this._theme.dispose(),this._theme=void 0)}},{key:"groupLength",get:function(){return this._groupIds.length}},{key:"groupIds",get:function(){return this._groupIds}},{key:"center",get:function(){return(new fm.Vector2).copy(this._center)},set:function(e){this._center=e}},{key:"theme",get:function(){return this._theme},set:function(e){this._theme=e}},{key:"bbox",get:function(){return this._bbox}},{key:"bboxTh",get:function(){return this._bboxTh}},{key:"space",get:function(){return this._space},set:function(e){for(var t in this._space=e,this.groups){var n=(0,l.default)(t);this.groups[t].height=e*n}}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(56);function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={ALL_LINES_TYPE:40,TOP_LINES_TYPE:41},t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={RIGHT:1,LEFT:2,BOTTOM:3,TOP:4,RIGHT_BOTTOM:5,LEFT_BOTTOM:6,RIGHT_TOP:7,LEFT_TOP:8,CENTER:9},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.LineMaterial=void 0;var o=i(n(111)),a=(i=i(n(34)),n(75));a.UniformsLib.line2={linewidth:{value:1},resolution:{value:new a.Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},a.ShaderLib.line2={uniforms:a.UniformsUtils.merge([a.UniformsLib.common,a.UniformsLib.fog,a.UniformsLib.line2]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <premultiplied_alpha_fragment>\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\n\t\t}\n\t\t"},n=function(e){a.ShaderMaterial.call(this,{type:"LineMaterial",uniforms:a.UniformsUtils.clone(a.ShaderLib.line2.uniforms),vertexShader:a.ShaderLib.line2.vertexShader,fragmentShader:a.ShaderLib.line2.fragmentShader,clipping:!0}),this.dashed=!1,(0,o.default)(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},lineWidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}}}),this.setValues(e)},t.LineMaterial=n,n.prototype=(0,i.default)(a.ShaderMaterial.prototype),n.prototype.constructor=n,n.prototype.isLineMaterial=!0},function(e,t,n){"use strict";var r=n(16),i=n(17),o=n(18),a=n(11),s=n(4),u=n(0);n(13),n(14),n(8);var l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(19));n(9),n(145);var h=l(n(48)),f=l(n(2)),d=l(n(3)),p=l(n(5)),g=l(n(6)),m=l(n(7));u=l(n(10)),n(255);var v=l(n(256)),y=l(n(439)),_=l(n(258)),x=l(n(254)),A=n(73);function I(e,t){var n=void 0!==i&&e[o]||e["@@iterator"];if(!n){if(a(e)||(n=w(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw s}}}}function w(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e){var t,n=I(this._lineNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.line.material.uniforms.offset.value.y-=.001*e.delTime,this.passed&&r.gid===this._passedGid&&(r.line.material.uniforms.miny.value=this.specific)}}catch(e){n.e(e)}finally{n.f()}};u=function(e){(0,p.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!s)return!1;if(s.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(s(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,m.default)(e);return r=t?(n=(0,m.default)(this).constructor,s(r,arguments,n)):r.apply(this,arguments),(0,g.default)(this,r)}}(n);function n(){var e;return(0,f.default)(this,n),(e=t.call(this))._renderNode=null,e._segment=[],e._noAnimate=!0,e._lineDis=[],e._lineNodes=[],e._style=null,e._secLen=60,e._hwProp=10,e._passed=!0,e._passedColor="#aeaeae",e._specific=0,e}return(0,d.default)(n,[{key:"addSegment",value:function(e){this._segment.push(e)}},{key:"convertPointByCenter",value:function(e,t){return[e.x-t.x,e.z,-e.y+t.y]}},{key:"segPointsToLinePnts",value:function(e){for(var t,n,r=[],i=0;i<this._segment.points.length;i++)0<i&&i<this._segment.points.length-1&&this._segment.points[i-1],r.push.apply(r,(0,h.default)(this.convertPointByCenter(this._segment.points[i],e))),0!==i&&(t=new fm.Vector3(this._segment.points[i].x,this._segment.points[i].y,this._segment.points[i].z),n=new fm.Vector3(this._segment.points[i-1].x,this._segment.points[i-1].y,this._segment.points[i-1].z),this._lineDis.push(t.distanceTo(n)));return r}},{key:"getIndexDis",value:function(e){for(var t=0,n=0;n<this._lineDis.length;n++)n<e&&(t+=this._lineDis[n]);return t}},{key:"computerUVY",value:function(){for(var e,t=[],n=this.getIndexDis(this._lineDis.length),r=0;r<this._segment.points.length;r++)0===r?t.push(0):r===this._segment.points.length-1?t.push(1):(e=this.getIndexDis(r)/n,t.push(e),t.push(e));return t}},{key:"initLine",value:function(e,t,n){this._style=t;var r=this.getLineTextureParams(t.lineType,t.lineWidth,t.godColor,t.godEdgeColor,t.color);t.mapUrl?t.useMap=!0:(t.useMap=r.useMap,t.map=n.nodeManager.materialManager[r.txtureCommand](r),t.map.minFilter=fm.LinearFilter,t.map.generateMipmaps=!1,t.map.anisotropy=4);for(var i=this._segment.length-1;-1<i;i--){var o,a,s,u=this.createLine(this._segment[i],e,t,n),l=n.getFMGroup(this._segment[i].groupId);l?(this._lineNodes.push({line:u,gid:this._segment[i].groupId,seg:this._segment[i],isCross:!1}),l.addLine(u),-1<i-1&&this._segment[i].groupId!=this._segment[i-1].groupId&&((o=n.getFMGroup(this._segment[i-1].groupId))?(a=o.height+o.offsetHeight,s=(0,c.default)({},this._segment[i-1].points[this._segment[i-1].points.length-1]),l=(0,c.default)({},this._segment[i].points[0]),(u=n.getFMGroup(this._segment[i].groupId))?(s.z=a-u.height-u.offsetHeight+s.z-l.z,(s=new _.default([s,l])).groupId=this._segment[i].groupId,l=this.createLine(s,e,t,n),this._lineNodes.push({line:l,gid:this._segment[i-1].groupId,gidAn:this._segment[i].groupId,seg:s,isCross:!0}),o.addLine(l)):console.warn(A.tileMessage.noGroup)):console.warn(A.tileMessage.noGroup))):console.warn(A.tileMessage.noGroup)}this._noAnimate=t.noAnimate,this._noAnimate||n.on("frameLoop",C.bind(this))}},{key:"conputeMaterialRepeat",value:function(e,t,n,r){t=t.allLength*n.getPixelTo3DdisByGid(t.groupId),r=Math.floor(t*window.devicePixelRatio/r),e.uniforms.repeat.value.y=r}},{key:"resetRepeat",value:function(e){var t,n=I(this._lineNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.conputeMaterialRepeat(r.line.material,r.seg,e,this._secLen)}}catch(e){n.e(e)}finally{n.f()}}},{key:"rebuildLine",value:function(e,t,n,r){this.removeByMap(t);for(var i=this._style,o=this._segment.length-1;-1<o;o--){var a,s,u,l=this.createLine(this._segment[o],e,i,t),h=t.getFMGroup(this._segment[o].groupId);this._lineNodes.push({line:l,gid:this._segment[o].groupId,seg:this._segment[o],isCross:!1}),h.addLine(l),-1<o-1&&this._segment[o].groupId!=this._segment[o-1].groupId&&(s=(a=t.getFMGroup(this._segment[o-1].groupId)).height+a.offsetHeight,u=(0,c.default)({},this._segment[o].points[this._segment[o].points.length-1]),h=(0,c.default)({},this._segment[o-1].points[0]),l=t.getFMGroup(this._segment[o].groupId),u.z=s-l.height-l.offsetHeight+u.z-h.z,(u=new _.default([u,h])).groupId=this._segment[o].groupId,h=this.createLine(u,e,i,t),this._lineNodes.push({line:h,gid:this._segment[o-1].groupId,gidAn:this._segment[o].groupId,seg:u,isCross:!0}),a.addLine(h))}this.hideOrShowBy(n,r)}},{key:"removeByMap",value:function(e,t){var n,r=I(this._lineNodes);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.line.material.dispose(),i.line.geometry.dispose(),e.getFMGroup(i.gid).removeLine(i.line)}}catch(e){r.e(e)}finally{r.f()}t&&e.off("frameLoop",C),this._lineNodes.length=0}},{key:"dispose",value:function(e){this.removeByMap(e,!0)}},{key:"hideOrShowBy",value:function(e,t){var n,r=I(this._lineNodes);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.isCross?e.indexOf(i.gid)<0||e.indexOf(i.gidAn)<0?i.line.visible=!1:i.line.visible=!0:-1<e.indexOf(i.gid)?i.line.visible=!0:i.line.visible=!1}}catch(e){r.e(e)}finally{r.f()}}},{key:"createLine",value:function(e,t,n,r){var i=(o=r.getFMGroup(e.groupId)).height+o.offsetHeight,o=new fm.Vector3(0,i,0);i=new v.default,e.needSmooth=!1!==n.smooth,e.initSegement(t,n.radius);for(var a=[],s=0;s<e.linePoints.length;s++)a.push(e.linePoints[s]);t=e.uvys,i.setPositions(a),i.setUvys(t);var u=new fm.LineMaterial({color:n.color,linewidth:5,vertexColors:fm.VertexColors,dashed:!1,transparent:!0});return u.resolution.set(n.resolution.x,n.resolution.y),u.linewidth=n.lineWidth,n.useMap&&(u.defines.USE_MMAP=!0,n.mapUrl?(n.useMap=!0,r.nodeManager.materialManager.loadTexture(n.mapUrl,(function(e){u.uniforms.mmap.value=e,e.minFilter=fm.LinearFilter,e.generateMipmaps=!1,e.anisotropy=4,e.wrapS=fm.RepeatWrapping,e.wrapT=fm.RepeatWrapping,u.needsUpdate=!0}))):(u.uniforms.mmap.value=n.map,n.map.wrapS=fm.RepeatWrapping,n.map.wrapT=fm.RepeatWrapping),this.conputeMaterialRepeat(u,e,r,this._secLen),u.needsUpdate=!0),(i=new y.default(i,u)).computeLineDistances(),i.position.set(o.x,o.y,o.z),i}},{key:"initLinePoints",value:function(e,t){var n=new v.default;n.setPositions(e),(e=new fm.LineMaterial({color:t.color,linewidth:t.lineWidth,vertexColors:fm.VertexColors,dashed:!1,transparent:!0})).lineWidth=t.lineWidth,e.resolution.set(t.resolution.x,t.resolution.y),this._renderNode=new y.default(n,e),this._renderNode.computeLineDistances()}},{key:"moveUv",value:function(e){if(this._noAnimate){var t,n=I(this._lineNodes);try{for(n.s();!(t=n.n()).done;)t.value.line.material.uniforms.offset.value.y-=e}catch(e){n.e(e)}finally{n.f()}}}},{key:"getLineTextureParams",value:function(e,t,n,r,i){var o=(t=t||6)*this._hwProp;this._secLen=o;var a={type:"normal",width:128,height:128,color:"#ff0000",arrowHeightPercent:.6,arrowWidthPercent:1,arrowPercent:.1,lineType:null,dashArray:[2,1],txtureCommand:"createNormalLineTexture",godHeightPercent:1,godEdgePercent:.2,godArrowPercent:.15,arrawWidth:20,godColor:"#33cc61",godEdgeColor:"#4a82d2",godArrowColor:"#F4FEFB",godArrowXScale:4,godArrowWidthPercent:.9};switch(n&&(a.godColor=n),r&&(a.godEdgeColor=r),i&&(a.color=i),e){case x.default.FULL:a.useMap=!1;break;case x.default.DOTTED:a.dashArray=[1,1],a.useMap=!0;break;case x.default.DOT_DASH:a.dashArray=[2.5,1,.5,1],a.useMap=!0;break;case x.default.CENTER:a.dashArray=[3,1,1.5,1],a.useMap=!0;break;case x.default.DASH:a.dashArray=[2,1],a.useMap=!0;break;case x.default.DOUBLE_DOT_DASH:a.dashArray=[2.5,.5,.5,.5,.5,.5],a.useMap=!0;break;case x.default.TRI_DOT_DASH:a.dashArray=[2.5,.5,.5,.5,.5,.5,.5,.5],a.useMap=!0;break;case x.default.ARROW:a.dashArray=[5,0],a.useMap=!0,a.txtureCommand="createArrowLineTexture";break;case x.default.FMARROW:a.width=5*t,a.height=5*o,a.arrawWidth=a.height/12,a.dashArray=[7,0],a.useMap=!0,a.txtureCommand="createArrowWidthBackTexture";break;default:a.useMap=!1}return a}},{key:"setPassed",value:function(e,t){for(var n=0,r=0,i=[],o=0;o<this._segment.length;o++)if(this._segment[o].groupId===e){i=this._segment[o]._points;break}for(var a=0;a<i.length;a++)0!==a&&(t<a&&(r+=Math.abs(Math.sqrt(Math.pow(i[a].y-i[a-1].y,2)+Math.pow(i[a].x-i[a-1].x,2)))),n+=Math.abs(Math.sqrt(Math.pow(i[a].y-i[a-1].y,2)+Math.pow(i[a].x-i[a-1].x,2))));this._specific=r/n,this._passedGid=e}},{key:"renderNode",get:function(){return this._renderNode}},{key:"segment",get:function(){return this._segment}},{key:"passed",get:function(){return this._passed},set:function(e){this._passed=e}},{key:"passedColor",get:function(){return this._passedColor},set:function(e){this._passedColor=e}},{key:"specific",get:function(){return this._specific},set:function(e){this._specific=e}}]),n}(u.default),t.default=u},function(e,t,n){e.exports=!n(33)&&!n(43)((function(){return 7!=Object.defineProperty(n(121)("div"),"a",{get:function(){return 7}}).a}))},function(e,t){var n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==("undefined"==typeof window?"undefined":s(window))&&(n=window)}e.exports=n},function(e,t,n){var r=n(36),i=n(37),o=n(77);e.exports=n(33)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,u=0;u<s;)r.f(e,n=a[u++],t[n]);return e}},function(e,t,n){var r=n(52),i=n(67),o=n(272)(!1),a=n(125)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=a&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){n=n(20).document,e.exports=n&&n.documentElement},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(167),i=n(127).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(92),i=n(74),o=n(67),a=n(122),s=n(52),u=n(164),l=Object.getOwnPropertyDescriptor;t.f=n(33)?l:function(e,t){if(e=o(e),t=a(t,!0),u)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(52),i=n(57),o=n(125)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(0);e.exports=function(e,t,n){return t in e?r(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(289)},function(e,t,n){e.exports=!n(30)&&!n(26)((function(){return 7!=Object.defineProperty(n(177)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(44),i=n(31).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(44),i=n(297).set;e.exports=function(e,t,n){var o;return(t=t.constructor)!==n&&"function"==typeof t&&(o=t.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(58),i=n(101),o=n(181)(!1),a=n(139)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=a&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var r=n(101),i=n(39),o=n(84);e.exports=function(e){return function(t,n,a){var s,u=r(t),l=i(u.length),c=o(a,l);if(e&&n!=n){for(;c<l;)if((s=u[c++])!=s)return!0}else for(;c<l;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){n=n(31).document,e.exports=n&&n.documentElement},function(e,t,n){var r=n(54),i=n(60);e.exports=function(e){return function(t,n){var o,a=String(i(t)),s=r(n);return t=a.length,s<0||t<=s?e?"":void 0:(n=a.charCodeAt(s))<55296||56319<n||s+1===t||(o=a.charCodeAt(s+1))<56320||57343<o?e?a.charAt(s):n:e?a.slice(s,s+2):o-56320+(n-55296<<10)+65536}}},function(e,t,n){n(47)("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){for(var r,i=n(31),o=n(40),a=(n=n(83))("typed_array"),s=n("view"),u=n=!(!i.ArrayBuffer||!i.DataView),l=0,c="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(r=i[c[l++]])?(o(r.prototype,a,!0),o(r.prototype,s,!0)):u=!1;e.exports={ABV:n,CONSTR:u,TYPED:a,VIEW:s}},function(e,t,n){var r=n(45);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(54),i=n(39);e.exports=function(e){if(void 0===e)return 0;var t=r(e);if(t!==(e=i(t)))throw RangeError("Wrong length!");return e}},function(e,t,n){var r=n(58),i=n(46),o=n(139)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var r=n(38),i=n(136),o=n(24)("species");e.exports=function(e,t){var n;return void 0===(e=r(e).constructor)||null==(n=r(e)[o])?t:i(n)}},function(e,t,n){var r=n(24)("unscopables"),i=Array.prototype;null==i[r]&&n(40)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){"use strict";var r=n(99),i=n(23),o=n(45),a=n(40),s=n(70),u=n(319),l=n(149),c=n(189),h=n(24)("iterator"),f=!([].keys&&"next"in[].keys()),d="keys",p="values",g=function(){return this};e.exports=function(e,t,n,m,v,y,_){u(n,t,m);var x,A,I=function(e){if(!f&&e in M)return M[e];switch(e){case d:case p:return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",b=v==p,C=!1,M=e.prototype,E=M[h]||M["@@iterator"]||v&&M[v],T=E||I(v),S=v?b?I("entries"):T:void 0;if((m="Array"==t&&M.entries||E)&&(e=c(m.call(new e)))!==Object.prototype&&e.next&&(l(e,w,!0),r||"function"==typeof e[h]||a(e,h,g)),b&&E&&E.name!==p&&(C=!0,T=function(){return E.call(this)}),r&&!_||!f&&!C&&M[h]||a(M,h,T),s[t]=T,s[w]=g,v)if(x={values:b?T:I(p),keys:y?T:I(d),entries:S},_)for(A in x)A in M||o(M,A,x[A]);else i(i.P+i.F*(f||C),t,x);return x}},function(e,t,n){"use strict";var r=n(31),i=n(41),o=n(30),a=n(24)("species");e.exports=function(e){e=r[e],o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){n(47)("Int16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(47)("Uint32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){var r=n(44),i=n(69),o=n(24)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){"use strict";var r=n(38),i=n(326),o=n(104);n(106)("search",1,(function(e,t,n,a){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){if((s=a(n,e,this)).done)return s.value;var t=r(e),s=String(this);return e=t.lastIndex,i(e,0)||(t.lastIndex=0),s=o(t,s),i(t.lastIndex,e)||(t.lastIndex=e),null===s?-1:s.index}]}))},function(e,t,n){"use strict";var r=n(33),i=n(77),o=n(131),a=n(92),s=n(57),u=n(123),l=Object.assign;e.exports=!l||n(43)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var n=s(e),l=arguments.length,c=1,h=o.f,f=a.f;c<l;)for(var d,p=u(arguments[c++]),g=h?i(p).concat(h(p)):i(p),m=g.length,v=0;v<m;)d=g[v++],r&&!f.call(p,d)||(n[d]=p[d]);return n}:l},function(e,t,n){var r=n(15),i=n(89),o=n(43),a=n(152),s=(n="["+a+"]",RegExp("^"+n+n+"*")),u=RegExp(n+n+"*$"),l=(n=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()}));t=i[e]=s?t(l):a[e],n&&(i[n]=t),r(r.P+r.F*s,"String",i)},n.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(u,"")),e});e.exports=n},function(e,t,n){e.exports=n(351)},function(e,t,n){var r=n(37);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){throw void 0!==(n=e.return)&&r(n.call(e)),t}}},function(e,t,n){var r=n(81),i=n(29)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){var r=n(154),i=n(29)("iterator"),o=n(81);e.exports=n(12).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){"use strict";var r=n(20),i=n(15),o=n(68),a=n(43),s=n(51),u=n(113),l=n(72),c=n(114),h=n(22),f=n(80),d=n(36).f,p=n(153)(0),g=n(33);e.exports=function(e,t,n,m,v,y){var _=r[e],x=_,A=v?"set":"add",I=x&&x.prototype,w={};return g&&"function"==typeof x&&(y||I.forEach&&!a((function(){(new x).entries().next()})))?(x=t((function(t,n){c(t,x,e,"_c"),t._c=new _,null!=n&&l(n,v,t[A],t)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var t="add"==e||"set"==e;e in I&&(!y||"clear"!=e)&&s(x.prototype,e,(function(n,r){return c(this,x,e),t||!y||h(n)?(r=this._c[e](0===n?0:n,r),t?this:r):"get"==e&&void 0}))})),y||d(x.prototype,"size",{get:function(){return this._c.size}})):(x=m.getConstructor(t,e,v,A),u(x.prototype,n),o.NEED=!0),f(x,e),w[e]=x,i(i.G+i.W+i.F,w),y||m.setStrong(x,e,v),x}},function(e,t,n){"use strict";var r=n(15);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";var r=n(15),i=n(56),o=n(42),a=n(72);e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,s,u=arguments[1];return i(this),(t=void 0!==u)&&i(u),null==e?new this:(n=[],t?(r=0,s=o(u,arguments[2],2),a(e,!1,(function(e){n.push(s(e,r++))}))):a(e,!1,n.push,n),new this(n))}})}},function(e,t,n){"use strict";var r=n(20),i=n(12),o=n(36),a=n(33),s=n(29)("species");e.exports=function(e){e=("function"==typeof i[e]?i:r)[e],a&&e&&!e[s]&&o.f(e,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(29)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";n(14);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(48)),h=l(n(53)),f=l(n(2)),d=l(n(3)),p=l(n(96)),g=l(n(5)),m=l(n(6)),v=l(n(7));n(55),n(13),n(103),n(197),n(8),n(61),n(9),n(21);var y,_=l(n(112)),x=l(n(25)),A=l(n(11)),I=l(n(35)),w=l(n(63)),b=l(n(211)),C=l(n(380)),M=l(n(49)),E=l(n(27)),T=l(n(418)),S=l(n(66)),L=l(n(87)),k=l(n(65)),R=l(n(244)),N=(u=l(n(245)),l(n(28))),P=l(n(246)),O=l(n(50)),D=l(n(420)),F=n(73),B=l(n(115)),G=l(n(215)),z=l(n(247)),U=l(n(119)),V=n(73),H=l(n(249)),j=l(n(426)),W=l(n(427)),Y=n(117);function q(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=X(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function X(e,t){if(e){if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function J(e){var t=this.MapOptions.mapThemeURL+"/"+this.MapOptions.defaultThemeName+"/"+this.MapOptions.defaultThemeName+".theme",n=this;this.fmServer.getTheme(t,(function(t){n.initTheme(n.MapOptions.defaultThemeName,t,(function(t){var r,i=null,o=n.MapOptions.mapServerURL,a="GET";"fengmap"===n.MapOptions.mapServerURL?(o=B.default+"sdk/auth/downMaps",n.obtainMapRoute&&(o=B.default+"sdk/auth/obtainMapRoute"),n.MapOptions.tile&&(o=B.default+"sdk/authLayered/downMaps",n.obtainMapRoute&&(o=B.default+"sdk/authLayered/obtainMapRoute")),r={newFlag:"2",mapId:(r=G.default.getCerityData(n.MapOptions.key,n.MapOptions.appName,e)).mapId,keyValue:r.appKey,appName:r.appName,webUrl:r.webURL,keyType:3,isSeparate:n.MapOptions.tile},i=(0,_.default)(r),a="POST"):n.obtainMapRoute=!1,n.obtainMapRoute?n.fmServer.getUrl(o,e,n.MapOptions.tile,i,a,(function(e,r){e=e.replace('"',"").replace('"',""),n.fmServer.getScene(e,null,n.MapOptions.tile,null,"GET",(function(e,o){n.dataExcute(t,e,r,i)}),(function(e){y&&y(e)}))}),(function(e){y&&y(e)})):n.fmServer.getScene(o,e,n.MapOptions.tile,i,a,(function(e,r){n.dataExcute(t,e,r,i)}),(function(e){y&&y(e)})),n._currentSceneId=e}))}))}u=function(e){(0,g.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,v.default)(e);return i=t?(n=(0,v.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,m.default)(this,i)}}(n);function n(e){var r;return(0,f.default)(this,n),(r=t.call(this)).uuid=fm.Math.generateUUID(),L.default[r.uuid]={},r.is_ctrl_camera=!1,r.target_dis=4500,e.enabledPanRange&&(r.is_ctrl_camera=e.enabledPanRange),void 0!==e.cameramovedis&&(r.target_dis=e.cameramovedis),r.MapOptions=new C.default(e),r.fmServer=new b.default,r.dataManager=new M.default,r.nodeManager=new E.default(r.MapOptions,(0,p.default)(r)),r.isMarkerTip=!1,e.isMarkerTip&&(r.isMarkerTip=!0),r.isMarkerMove=!1,e.isMarkerMove&&(r.isMarkerMove=!0),r.render=null,r.getRenderOption(),e.lightEffects?L.default.light=!0:L.default.light=!1,r.renderer=new H.default(r.MapOptions,(0,p.default)(r)),r.controls=new fm.OrbitControls("3d"===r.MapOptions.defaultViewMode?r.renderer.perspectiveCamera:r.renderer.orthographicCamera,r.renderer.canvas,(0,p.default)(r)),r.mapScaleLevels=[295829355.45,147914677.73,73957338.86,36978669.43,18489334.72,9244667.36,4622333.68,2311166.84,1155583.42,577791.71,288895.85,144447.93,72223.96,36111.98,18056,9028,4514,2257,1128,564,282,141,70,35,17,8,4,2,1],r._mapScaleLevel=20,r._mapScale=564,r._minScale=1,r._maxScale=295829355.45,r._minScaleLevel=1,r._maxScaleLevel=29,r._animaters=[],r._windowPops=[],r._currentSceneId="10347",r._currentFocusGroup=r.MapOptions.defaultFocusGroup,r._visibleGroups=r.MapOptions.defaultVisibleGroups,r._viewMode=r.MapOptions.defaultViewMode,r.renderer.viewMode=r.MapOptions.defaultViewMode,r._currentTime=(new Date).getTime(),r._showAllGroup=!1,r._lineMarkers=[],r._lastMoveEvent=null,r._mouseHoverTime=0,r._mouseHoverStart=!0,r._compassBG=r.MapOptions.compassBg,r._compassFG=r.MapOptions.compassFg,r.getMapScaleInfo(),r.scaleLevelInit(),r.controlEventInit(),r._loopHander=requestAnimationFrame(r.update.bind((0,p.default)(r))),r.allowRender=!0,r._sweep={},r.isOneShot=!0,r.pickFilterFunction=null,r.animationMixers=[],r.hoverFilterFunction=null,r._eventId=0,r._modelSelectColor={r:.97,g:.388,b:.196,a:1},r._fullScreen=!1,r._enterControl=new z.default,r._enterControl.enableMapHover=r.MapOptions.modelHoverEffect,r._allowfps=60,r._renderTime=0,r.controls.setEnterCtrl(r._enterControl),r.otherFocus=[],r.autoRotateBymodel=!1,r.autoRotateBymodelSpeed=1,r.autoRotateBymodelPause=!1,r.tileLoading=!1,r.letUpdate=!1,r._shotIndex=0,r.isOneShot=!0,r.selectedObjects=[],r.isFpsDisplay=!1,r.stats=null,e.isFpsDisplay&&(r.isFpsDisplay=e.isFpsDisplay),r.isFpsDisplay&&(r.stats=new D.default,r.stats.showPanel(0),document.body.appendChild(r.stats.dom)),r.obtainMapRoute=!0,r.videoMemory=new j.default((0,p.default)(r)),r.getStation(),r.animaModels=[],r.isRangeHidden=!0,void 0!==e.isScaleRangeHidden&&(r.isRangeHidden=e.isScaleRangeHidden),r.layerRenderOrder=Y.LayerOrder,r.fmnewMarkerLayer=new W.default((0,p.default)(r)),r._renderNodeNumber=100,r}return(0,d.default)(n,[{key:"addNewDom",value:function(e){this.fmnewMarkerLayer.addMarker(e)}},{key:"removeNewDom",value:function(e){this.fmnewMarkerLayer.removeMarker(e)}},{key:"getRenderOption",value:function(){try{this.MapOptions.logarithmicDepthBuffer?this.render=new fm.WebGLRenderer({antialias:!0,alpha:!0,logarithmicDepthBuffer:!0}):this.render=new fm.WebGLRenderer({antialias:!0,alpha:!0})}catch(e){return console.error("WebGLRenderer ERROR: ",e),(new fengmap.MapError).noWebGL(this.renderOption.container),!1}this.canvas=this.render.domElement;var e=this.MapOptions.container.clientWidth,t=this.MapOptions.container.clientHeight;return this.perspectiveCamera=new fm.PerspectiveCamera(35,e/t,2,1e5),this.orthographicCamera=new fm.OrthographicCamera(-e/2,e/2,t/2,-t/2,1,1e5),!0}},{key:"isOnLine",value:function(e,t){var n=new Image;n.onload=function(){e&&e()},n.onerror=function(){t&&t()},n.style.display="none",n.src="http://www.baidu.com/img/baidu_sylogo1.gif?"+(""+Math.random()).slice(-6)}},{key:"openMapById",value:function(e,t){var n,r=this;function i(){"fengmap"===n.MapOptions.mapServerURL?G.default.checkIsOnLine((function(){G.default.checkOnLine(n.MapOptions.key,n.MapOptions.appName,e,(function(t){J.call(n,e,!0)}),(function(r){r?(console.warn(r.error_code,r.error_message),t&&t({msg:"线上验证失败!",data:r})):(console.warn("offLine 2"),J.call(n,e))}),"POST")}),(function(){console.warn("offLine 1"),J.call(n,e)}),1e3):J.call(n,e)}function o(){J.call(n,e)}y=t,e?this.MapOptions.key?/^[a-zA-z\d]{32}$/.test(this.MapOptions.key)?this.MapOptions.appName?(this._zopStep_=1,n=this,"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)?fengmap.Weixin.miniProgram.getEnv((function(e){e.miniprogram?(r.nodeManager._materialManager.is_Weixin=!0,r.nodeManager._materialManager.is_WeixinMini=!0):(r.nodeManager._materialManager.is_Weixin=!0,r.nodeManager._materialManager.is_WeixinMini=!1),r.MapOptions.useCompatibleOnLineCheck?r.isOnLine(i,o):(navigator.onLine?i:o)()})):this.MapOptions.useCompatibleOnLineCheck?this.isOnLine(i,o):(navigator.onLine?i:o)()):console.warn(decodeURIComponent(F.cerityMessage.warn_noappname)):console.warn(decodeURIComponent(F.cerityMessage.warn_keynotright)):console.warn(decodeURIComponent(F.cerityMessage.warn_nokey)):console.warn(decodeURIComponent(F.cerityMessage.warn_nomapid))}},{key:"search",value:function(e,t,n){return U.default.search(this,e,t,n)}},{key:"changeFocusToGroup",value:function(e){var t=this,n=this.nodeManager.getSceneCenter(this._currentSceneId),r=this.controls.target.y;if(this.currentFocusGroup=e.gid,n=this.nodeManager.getHeight(this._currentSceneId,this.currentFocusGroup)+n.y,!this.MapOptions.focusAnimateMode)return this.controls.panUp(n-r),this.controls.update(),e.callback&&e.callback(),void this.setRenderList();L.default[this.uuid].currentGroupChangeAnimater&&(L.default[this.uuid].currentGroupChangeAnimater.stop(),this.removeAnimater(L.default[this.uuid].currentGroupChangeAnimater));var i=new S.default({h:r},{h:n},e.duration?1e3*e.duration:800,(function(){t.removeAnimater(i),L.default[t.uuid].currentGroupChangeAnimater=null,e.callback&&e.callback()}),(function(n,r){t.controls.panUp(r.h),e.update&&e.update()})).start();L.default[this.uuid].currentGroupChangeAnimater=i,this._animaters.push(i)}},{key:"dataExcute",value:function(e,t,n,r){var i=this;if(this&&this.MapOptions){var o=new fm.Color(e.selectedColor);if(this._modelSelectColor.r=o.r,this._modelSelectColor.g=o.g,this._modelSelectColor.b=o.b,0===this.MapOptions.defaultBackgroundColor?this.MapOptions.defaultBackgroundColor=0:this.MapOptions.defaultBackgroundColor||(this.MapOptions.defaultBackgroundColor=k.default.toColor(e.data.viewtheme.clearcolor)),null===this.MapOptions.defaultBackgroundAlpha&&(this.MapOptions.defaultBackgroundAlpha=(0,x.default)(e.data.viewtheme.clearalpha)),this.renderer.setClearColor(this.MapOptions.defaultBackgroundColor,this.MapOptions.defaultBackgroundAlpha),this.dataManager.putRawScene(t,n),o=this.dataManager.parseScene(n,this.MapOptions.tile,this.MapOptions.license,this.obtainMapRoute)){if(!(t=!o.scene.key||G.default.checkOffLine(this.MapOptions.key,this.MapOptions.appName,"",o.scene.key)))return console.warn(decodeURIComponent(F.cerityMessage.warn_offline)),void(y&&y({message:decodeURIComponent(F.cerityMessage.warn_local)}));this.dataManager.putDecodeScene(o,n),this.nodeManager.conformatScene(o,n,e),this.groupSpace=this.MapOptions.defaultGroupSpace,this.initCameraPosition(),this.renderer.perspectiveCamera.position,e=this.renderer.getFrustumByViewMode(this._viewMode);var a=this.getVisibleGroups();if(this.MapOptions.tile){var s=this.nodeManager.getSceneById(this._currentSceneId);s.sdata=r;var u=s.getNeedLoadGroup(a);this.tileLoading=!0;for(var l=-1,c=0;c<u.length;c++)if(u[c].gid&&u[c].gid==this._currentFocusGroup){l=c;break}if(l<0)return void console.error(V.tileMessage.noFocus);this.loadAndExcuteData(u,s,l,!0,(function(e){i.nodeManager.checkNodeByFrustum(i.dataManager.getDecodeScene(i._currentSceneId),i.renderer.getFrustumByViewMode(i._viewMode),i.getVisibleGroups(),i.mapScaleLevel,n),i.setRenderList(),i.avoidMarkers(),u.splice(l,1),function(){var e=function(){var e=s.getNeedLoadGroup(a,!0);e.length<1?i.dispatchEvent({type:"loadComplete"}):i.loadAndExcuteData(e,s,0,!1,(function(t){i.tileLoading=!1,t===e.length-1&&i.dispatchEvent({type:"loadComplete"})}))};if(u.length<1)return i.dispatchEvent({type:"visibleGroupLoaded"}),void e();i.loadAndExcuteData(u,s,0,!1,(function(t){i.nodeManager.checkNodeByFrustum(i.dataManager.getDecodeScene(i._currentSceneId),i.renderer.getFrustumByViewMode(i._viewMode),i.getVisibleGroups(),i.mapScaleLevel,n),i.setRenderList(),i.avoidMarkers(),t===u.length-1&&(i.dispatchEvent({type:"visibleGroupLoaded"}),e())}))}()}))}else this.nodeManager.checkNodeByFrustum(o,e,a,this.mapScaleLevel,n),this.setRenderList(),this.avoidMarkers(),this.dispatchEvent({type:"visibleGroupLoaded"}),this.dispatchEvent({type:"loadComplete"}),this.renderer.setClearColor(this.MapOptions.defaultBackgroundColor,this.MapOptions.defaultBackgroundAlpha);this.letUpdate=!0,setTimeout((function(){i.animationPlay()}),3e3)}}}},{key:"animationPlay",value:function(){for(var e=0;e<this.animaModels.length;e++){for(var t=this.animaModels[e].animations,n=this.animaModels[e].model,r=new fm.AnimationMixer(n),i={},o=0;o<t.length;o++){var a=t[o],s=r.clipAction(a);i[a.name]=s}this.addAnimationMixer(r),i[t[0].name].clampWhenFinished=!0,i[t[0].name].reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(.2).play()}}},{key:"loadAndExcuteData",value:function(e,t,n,r,i){var o=this,a=e[n];this.fmServer.getFloor(this.MapOptions.mapServerURL,a.url,this._currentSceneId,a.gid,(function(s,u,l,c){l={geo:[(l=o.dataManager.parseFloor(s,u,l))[0]],biz:[l[1]],navi:[l[2]],gid:c},o.dataManager.getDecodeScene(o._currentSceneId).floors.push(l),a.layerData.loaded=!0,t.addGroup(c,l,a.layerData),i&&i(n),r||++n<e.length&&o.loadAndExcuteData(e,t,n,!1,i)}),t.sdata,this.obtainMapRoute)}},{key:"moveLinesUv",value:function(e){var t,n=q(this._lineMarkers);try{for(n.s();!(t=n.n()).done;)t.value.moveUv(e)}catch(e){n.e(e)}finally{n.f()}}},{key:"resetLineRepeat",value:function(){var e,t=q(this._lineMarkers);try{for(t.s();!(e=t.n()).done;)e.value.resetRepeat(this)}catch(e){t.e(e)}finally{t.f()}}},{key:"hideOrShowLine",value:function(){var e,t=this.groupIDs[this.groupIDs.length-1],n=q(this._lineMarkers);try{for(n.s();!(e=n.n()).done;)e.value.hideOrShowBy(this._visibleGroups,t)}catch(e){n.e(e)}finally{n.f()}}},{key:"getVisibleGroups",value:function(){return this._visibleGroups}},{key:"setVisibleGroups",value:function(e){this._visibleGroups=e,this.checkNode(),this.setRenderList(),this.dispatchEvent({type:"visibleGroupIDsChanged",gids:e})}},{key:"getFloorIdByGid",value:function(e){return(e=this.getFMGroup(e))._groupMessage.floorid}},{key:"initCameraPosition",value:function(){var e,t=this.getCameraDistanceByScale(this.mapScale),n=this.MapOptions.defaultViewCenter;try{n?(e=this.nodeManager.getSceneById(this._currentSceneId).mapcenter,n.x-=e.x,n.y-=e.y,n.z=-n.y,n.y=0):n=this.nodeManager.getSceneById(this._currentSceneId).center;var r=this.nodeManager.getHeight(this._currentSceneId,this._currentFocusGroup);n.z=0,n.y+=r,this.controls.target=(new fm.Vector3).copy(n)}catch(e){console.error(V.mapOptionMessage.defaultViewCenterError)}"3d"===this._viewMode?(this.controls.minPolarAngle=(90-this.MapOptions.defaultMaxTiltAngle)*fm.Math.DEG2RAD,this.controls.maxPolarAngle=(90-this.MapOptions.defaultMinTiltAngle)*fm.Math.DEG2RAD,e=(90-this.MapOptions.defaultTiltAngle)*fm.Math.DEG2RAD,r=t*Math.cos(e),e=t*Math.sin(e),e=new fm.Vector3(0,r,e),this.controls.object.position.set(n.x+e.x,n.y+e.y,n.z+e.z),this.controls.object.lookAt(n),this.renderer.orthographicCamera.position.set(n.x+e.x,n.y+e.y,n.z+e.z),this.renderer.orthographicCamera.lookAt(n)):(i=this.getCameraScaleByScale(this.mapScale),this.controls.minPolarAngle=0,this.controls.maxPolarAngle=0,this.controls.object.position.set(n.x,n.y+t,n.z),this.controls.object.zoom=1/i,this.controls.object.lookAt(n),this.renderer.orthographicCamera.updateProjectionMatrix());var i=this.MapOptions.computePoseToAngle();this.controls.rotateLeft(i*fm.Math.DEG2RAD),this._changePanrange(t,n),this.controls.update()}},{key:"_changePanrange",value:function(e,t){var n;this.MapOptions.enabledPanRange&&(n=this.nodeManager.getSceneById(this._currentSceneId).bboxTh,this.controls.viewBox=new fm.Box3(new fm.Vector3(n.min.x,0,n.min.y),new fm.Vector3(n.max.x,this.getGroupHeight(this.groupIDs[this.groupIDs.length-1])+this.groupSpace,n.max.y)),this.controls.viewBox.min.multiplyScalar(.5),this.controls.viewBox.max.multiplyScalar(.5),this.controls.useRange=!0)}},{key:"scaleLevelInit",value:function(){var e;this.MapOptions.mapScaleLevelRange&&this.setMapScaleLevelRange(this.MapOptions.mapScaleLevelRange),this.MapOptions.mapScaleRange&&this.setMapScaleRange(this.MapOptions.mapScaleRange),this.MapOptions.defaultMapScaleLevel&&(e=this.MapOptions.defaultMapScaleLevel,this._mapScaleLevel=e,this._mapScale=this.levelToScale(e)),this.MapOptions.defaultMapScale&&(this.mapScale=this.MapOptions.defaultMapScale)}},{key:"setMapScaleRange",value:function(e,t){(0,A.default)(e)?(this.minScale=e[0],this.maxScale=e[1]):(this.minScale=e,this.maxScale=t)}},{key:"setMapScaleLevelRange",value:function(e,t){(0,A.default)(e)?(this.minScaleLevel=e[0],this.maxScaleLevel=e[1]):(this.minScaleLevel=e,this.maxScaleLevel=t)}},{key:"showSingerOrMultiGroup",value:function(e){this._showAllGroup=e,this.visibleGroupIDs=e?this.getCurrGroupIds().slice(0):[this._currentFocusGroup]}},{key:"removeAnimater",value:function(e){-1<(e=this._animaters.indexOf(e))&&this._animaters.splice(e,1)}},{key:"dollyOut",value:function(){var e=this,t=1,n=new S.default({scale:1},{scale:2},500,(function(){e.removeAnimater(n)}),(function(n){var r=n.scale/t;t=n.scale,e.controls.dollyOut(r)})).start();this._animaters.push(n)}},{key:"dollyIn",value:function(){var e=this,t=1,n=new S.default({scale:1},{scale:2},500,(function(){e.removeAnimater(n)}),(function(n){var r=n.scale/t;t=n.scale,e.controls.dollyIn(r)})).start();this._animaters.push(n)}},{key:"zoomIn",value:function(){this.dollyIn()}},{key:"zoomOut",value:function(){this.dollyOut()}},{key:"checkNode",value:function(){var e,t,n,r;this.renderer&&(e=this.renderer.getFrustumByViewMode(this._viewMode),t=this._currentSceneId,n=this.dataManager.getDecodeScene(t),r="top"===this._viewMode?this.getScaleByCameraScale():this.getScaleByCameraDistance(),r=this.scaleTolevel(r),this.nodeManager.checkNodeByFrustum(n,e,this.getVisibleGroups(),r,t))}},{key:"getCurrDecodeData",value:function(){var e=this._currentSceneId;return this.dataManager.getDecodeScene(e)}},{key:"setBackgroundColor",value:function(e,t){var n=this;"string"==typeof e&&(e=(0,I.default)(e.replace("#","0x"))),setTimeout((function(){n.renderer.setClearColor(e,t)}),500)}},{key:"setBackground",value:function(e){this.renderer.setClearColor(0,0),this.renderer.setBackground(e)}},{key:"addAnimationMixer",value:function(e){this.animationMixers.push(e)}},{key:"setRenderList",value:function(){var e=this;if(this.nodeManager){if(1<this.visibleGroupIDs.length)try{for(var t=this.nodeManager._scenes[this._currentSceneId].groups[this.focusGroupID]._layers.extent[0]._scene.rotation.y,n=0;n<this.visibleGroupIDs.length;n++)this.visibleGroupIDs[n]!==this.focusGroupID&&function(){var r=e.nodeManager._scenes[e._currentSceneId].groups[e.visibleGroupIDs[n]]._layers;(0,w.default)(r).forEach((function(e){"domMarker"!==e&&0<(e=r[e]).length&&(e[0]._scene.rotation.y=t)}))}()}catch(e){}var r=this.nodeManager.getRenderList();this.renderer.renderList=r,this.renderer.resetSpriteSize()}}},{key:"rushRenderNode",value:function(){this.setRenderList(),this.renderer.resetSpriteSize()}},{key:"controlEventInit",value:function(){var e=this;this.controls.addEventListener("change",(function(){e.checkNode(),e.setRenderList(),e.avoidMarkers(),e.renderer.compassNode&&(e.renderer.compassNode.material.uniforms.rotation.value=-e.controls.getAzimuthalAngle()),t="top"===e._viewMode?e.getScaleByCameraScale():e.getScaleByCameraDistance(),e.dispatchEvent({type:"mapViewChanged"}),.5<Math.abs(t-e._mapScale)&&e.dispatchEvent({type:"scaleLevelChanged",scale:t}),e._mapScale=t;var t=e.scaleTolevel(t);t!==e._mapScaleLevel&&(e._mapScaleLevel=t,e.dispatchEvent({type:"mapScaleLevelChanged",mapScale:t})),e._mapScaleLevel=t,e.renderer.resetSpriteSize(),e.moveLinesUv(.01),e.resetLineRepeat(),e.renderer.resetLocationsSize()}));var t=0,n=null;this.isMarkerMove&&this.MapOptions.container.addEventListener("mousedown",(function(r){var i={x:2*r.offsetX/e.MapOptions.container.clientWidth-1,y:1-2*r.offsetY/e.MapOptions.container.clientHeight};t=(new Date).getTime(),n=setInterval((function(){var r;500<(new Date).getTime()-t&&(0<(r=e.nodeManager.getFacility(e._currentSceneId,e.getVisibleGroups(),i,e.renderer.getCameraByViewMode(e._viewMode))).length&&e.dispatchEvent({type:"press",target:r[0].object.mapNode}),clearInterval(n))}),250)})),this.controls.addEventListener("mouseup",(function(t){var r=t.mousePoint,i={x:2*r.x/r.w-1,y:1-2*r.y/r.h};e._eventId++,r=e.dispatchClickEvent(i,t.event),t.mouseButton===fm.MOUSE.LEFT&&r&&null!=r.target&&(4!=r.target._nodeType?e.modelFire(i):e.selectNull()),e.checkCompassClick(i),null!==n&&(clearInterval(n),n=null),e.dispatchEvent({type:"pressover"})})),this.controls.addEventListener("mousemove",(function(t){(e.isMarkerTip||e.isMarkerMove)&&e.mouseIntoInfo(t),e._lastMoveEvent=t,e._mouseHoverTime=0,e._mouseHoverStart=!0,null!==n&&(clearInterval(n),n=null)}))}},{key:"mouseIntoInfo",value:function(e){e={x:2*(e=e.mousePoint).x/e.w-1,y:1-2*e.y/e.h},this.isMarkerTip||(0!==(e=this.nodeManager.getFacility(this._currentSceneId,this.getVisibleGroups(),e,this.renderer.getCameraByViewMode(this._viewMode))).length?this.dispatchEvent({type:"hover",target:e[0].object.mapNode}):this.dispatchEvent({type:"mouseleave"}))}},{key:"checkCompassClick",value:function(e){var t;this.renderer&&this.renderer.compassNode&&this.showCompass&&(t=this.renderer.compassNode.userData,O.default.pointIsInRect(e,t.coord,t.width,t.width)&&this.dispatchEvent({type:"mapClickCompass",target:this.renderer.compassNode}))}},{key:"dispatchClickEvent",value:function(e,t){if(this._enterControl.enableMapSingleTap){var n=this.nodeManager.getNode(this._currentSceneId,this.getVisibleGroups(),e,this.renderer.getCameraByViewMode(this._viewMode)),r=this.nodeManager.getFacility(this._currentSceneId,this.getVisibleGroups(),e,this.renderer.getCameraByViewMode(this._viewMode)),i=this.nodeManager.getExternalModels(this._currentSceneId,this.getVisibleGroups(),e,this.renderer.getCameraByViewMode(this._viewMode)),o={type:"mapClickNode",target:null,mouse:t.mouse,domEvent:t,eventInfo:{domEvent:t,coord:null,eventID:this._eventId},nodeType:null};if(n.length<1&&r.length<1&&i.length<1)return this.dispatchEvent(o),{target:!0};if(1<=r.length&&(a=0,this.pickFilterFunction&&((e=this.pickFilterFunction({nodeType:r[0].object.mapNode.nodeType,typeID:r[0].object.mapNode.bdata&&r[0].object.mapNode.bdata.type,data:r[0].object.mapNode.bdata}))||(a=1)),u={type:"mapClickNode",target:r[0].object.mapNode,mouse:t.mouse,domEvent:t,eventInfo:{domEvent:t,coord:{x:r[0].object.mapNode.x,y:r[0].object.mapNode.y},eventID:this._eventId},mapCoord:{x:r[0].object.mapNode.x,y:r[0].object.mapNode.y},nodeType:r[0].object.mapNode.nodeType},1===a?this.dispatchEvent(o):this.dispatchEvent(u)),1<=n.length){var a=0;this.pickFilterFunction&&((s=this.pickFilterFunction({nodeType:n[0].object.mapNode.nodeType,typeID:n[0].object.mapNode.bdata&&n[0].object.mapNode.bdata.type,data:n[0].object.mapNode.bdata}))||(a=1));var s=(new fm.Vector3).copy(n[0].point),u={type:"mapClickNode",target:n[0].object.mapNode,mouse:t.mouse,domEvent:t,eventInfo:{domEvent:t,threeCoord:s,coord:{x:s.x+this.center.x,y:this.center.y-s.z},eventID:this._eventId},mapCoord:{x:s.x+this.center.x,y:this.center.y-s.z},nodeType:n[0].object.mapNode.nodeType};if(1===a)return this.dispatchEvent(o),o;this.dispatchEvent(u)}return 1<=i.length?(o=(new fm.Vector3).copy(i[0].point),u={type:"mapClickNode",target:function(e){for(;!e.mapNode;)e=e.parent;return e.mapNode}(i[0].object),mouse:t.mouse,domEvent:t,eventInfo:{domEvent:t,threeCoord:o,coord:{x:o.x+this.center.x,y:this.center.y-o.z},eventID:this._eventId},mapCoord:{x:o.x+this.center.x,y:this.center.y-o.z},nodeType:35},this.dispatchEvent(u),u):void 0}}},{key:"getDatasByAlias",value:function(e,t,n){return n=n||function(){return!0},this.nodeManager.getSceneById(this._currentSceneId).getGroupsNodelsByFilter([e],t,n)}},{key:"mouseHoverEventFire",value:function(e){var t,n,r,i,o,a;this._mouseHoverStart&&(this._mouseHoverTime>this.MapOptions.modelHoverTime?this._enterControl.enableMapHover&&this._lastMoveEvent&&(i={x:2*(n=(t=this._lastMoveEvent).mousePoint).x/n.w-1,y:1-2*n.y/n.h},r=this.nodeManager.getNode(this._currentSceneId,this.getVisibleGroups(),i,this.renderer.getCameraByViewMode(this._viewMode)),a=this.nodeManager.getFacility(this._currentSceneId,this.getVisibleGroups(),i,this.renderer.getCameraByViewMode(this._viewMode)),r.length<1&&a.length<1||(r[0]&&(i=(new fm.Vector3).copy(r[0].point),o={type:"mapHoverNode",target:r[0].object.mapNode,mouse:n,eventInfo:{domEvent:t.event,threeCoord:r[0].point,eventID:t.eventID,coord:{x:i.x+this.center.x,y:r[0].object.mapNode.y-i.z}},groupID:r[0].object.mapNode.groupID,nodeType:r[0].object.mapNode.nodeType},this.hoverFilterFunction?(i=this.hoverFilterFunction({nodeType:r[0].object.mapNode.nodeType,typeID:r[0].object.mapNode.bdata&&r[0].object.mapNode.bdata.type,data:r[0].object.mapNode.bdata}))&&(r[0].object.mapNode.nodeType===N.default.MODEL&&this.MapOptions.modelHoverEffect&&this.storeSelect(r[0].object),this.dispatchEvent(o)):(r[0].object.mapNode.nodeType===N.default.MODEL&&this.MapOptions.modelHoverEffect&&this.storeSelect(r[0].object),this.dispatchEvent(o))),a[0]&&(o=(new fm.Vector3).copy(a[0].point),o={type:"mapHoverNode",target:a[0].object.mapNode,mouse:n,eventInfo:{domEvent:t.event,threeCoord:a[0].point,eventID:t.eventID,coord:{x:o.x+this.center.x,y:a[0].object.mapNode.y-o.z}},groupID:a[0].object.mapNode.groupID,nodeType:a[0].object.mapNode.nodeType},this.hoverFilterFunction?(a=this.hoverFilterFunction({nodeType:a[0].object.mapNode.nodeType,typeID:a[0].object.mapNode.bdata&&a[0].object.mapNode.bdata.type,data:a[0].object.mapNode.bdata}))&&this.dispatchEvent(o):this.dispatchEvent(o)),this._mouseHoverStart=!1,this._mouseHoverTime=0)):this._mouseHoverTime+=e)}},{key:"selectNull",value:function(){if(L.default[this.uuid].currentModel){L.default[this.uuid].currentAnimater&&(L.default[this.uuid].currentAnimater.stop(),L.default[this.uuid].currentAnimater=void 0);var e=L.default[this.uuid].currentModel;if(void 0===L.default[this.uuid].currentModel.material.length)e.material.color=L.default[this.uuid].currentModel.material.userData.color,e.material.opacity=L.default[this.uuid].currentModel.material.userData.opacity,e.material.userData.opacity=void 0,e.material.userData.color=void 0,e.material.update=!0,L.default[this.uuid].currentModel=void 0;else{for(var t=0;t<L.default[this.uuid].currentModel.material.length;t++)e.material[t].color=L.default[this.uuid].currentModel.material[t].userData.color,e.material[t].opacity=L.default[this.uuid].currentModel.material[t].userData.opacity,e.material[t].userData.opacity=void 0,e.material[t].userData.color=void 0,e.material[t].update=!0;L.default[this.uuid].currentModel=void 0}}}},{key:"callAllLayersByAlias",value:function(e,t){this.nodeManager.getSceneById(this._currentSceneId).getAllGroupLayerByAlias(e,t)}},{key:"storeSelect",value:function(e){var t,n,r=this,i=e;if(e.nodeType&&e.nodeType===N.default.MODEL){if(!e.renderNodeInited)return;i=e.renderNode}if(L.default[this.uuid].currentModel&&L.default[this.uuid].currentModel!==i)if(L.default[this.uuid].currentAnimater&&(L.default[this.uuid].currentAnimater.stop(),L.default[this.uuid].currentAnimater=void 0),void 0===L.default[this.uuid].currentModel.material.length)L.default[this.uuid].currentModel.material.color=L.default[this.uuid].currentModel.material.userData.color,L.default[this.uuid].currentModel.material.opacity=L.default[this.uuid].currentModel.material.userData.opacity,L.default[this.uuid].currentModel.material.update=!0;else for(var o=0;o<L.default[this.uuid].currentModel.material.length;o++)L.default[this.uuid].currentModel.material[o].color=L.default[this.uuid].currentModel.material[o].userData.color,L.default[this.uuid].currentModel.material[o].opacity=L.default[this.uuid].currentModel.material[o].userData.opacity,L.default[this.uuid].currentModel.material[o].update=!0;if(L.default[this.uuid].currentModel=i,void 0===i.material.length)i.material.userData.color||(i.material.userData.color=i.material.color,i.material.userData.opacity=i.material.opacity);else for(var a=0;a<i.material.length;a++)i.material[a].userData.color||(i.material[a].userData.color=i.material[a].color,i.material[a].userData.opacity=i.material[a].opacity);L.default[this.uuid].currentAnimater||(0===(t=this._modelSelectColor.a)&&(t=1),n=new S.default({r:this._modelSelectColor.r/2,g:this._modelSelectColor.g/2,b:this._modelSelectColor.b/2,a:t/2},this._modelSelectColor,500,(function(){r.removeAnimater(n),L.default[r.uuid].currentAnimater=null}),(function(e){if(void 0===i.material.length)i.material.userData.color&&(i.material.color=new fm.Color(e.r,e.g,e.b),i.material.opacity=t,i.material.update=!0);else for(var n=0;n<i.material.length;n++)i.material[n].userData.color&&(i.material[n].color=new fm.Color(e.r,e.g,e.b),i.material[n].opacity=t,i.material[n].update=!0)})),L.default[this.uuid].currentAnimater=n,n.start(),this._animaters.push(n))}},{key:"modelFire",value:function(e){var t=[],n=[];if(this.MapOptions)if(this.MapOptions.lightEffects)t=this.nodeManager.getExternalModels(this._currentSceneId,this.getVisibleGroups(),e,this.renderer.getCameraByViewMode(this._viewMode)),n=this.nodeManager.getModel(this._currentSceneId,this.getVisibleGroups(),e,this.renderer.getCameraByViewMode(this._viewMode)),(n=t.concat(n)).length<1?this.selectNull():this.MapOptions.modelSelectedEffect&&this.storeSelect(n[0].object);else if((t=this.nodeManager.getModelExternal(this._currentSceneId,this.getVisibleGroups(),e,this.renderer.getCameraByViewMode(this._viewMode))).length<1)this.selectNull();else if(this.MapOptions.modelSelectedEffect){for(var r=0;r<t.length&&!t[r].object.visible;r++);this.storeSelect(t[r].object)}}},{key:"setModelSelectColor",value:function(e,t){var n=new fm.Color;n.set(e),this._modelSelectColor={r:n.r,g:n.g,b:n.b,a:t}}},{key:"checkMarkerAvoid",value:function(e){if(!(e.length<1)){for(var t=e[0],n=[],r=1;r<e.length;r++)O.default.isRectCross(t.leftTop,t.rightDown,e[r].leftTop,e[r].rightDown)?e[r].target.visible=!1:(e[r].target.visible=!0,n.push(e[r]));1<n.length&&this.checkMarkerAvoid(n)}}},{key:"avoidMarkers",value:function(){var e=this.nodeManager.getSceneById(this._currentSceneId);if(e){for(var t=this.renderer.getCameraByViewMode(this._viewMode),n=0;n<this._visibleGroups.length;n++){var r=e.getMarkers(this._visibleGroups[n],t,this.renderer.domElementHeight);this.checkMarkerAvoid(r);for(var i=e.getUserMarkers(this._visibleGroups[n],t,this.renderer.domElementHeight),o=0;o<i.length;o++)this.checkMarkerAvoid(i[o])}this.fmnewMarkerLayer.avoidDomMarkers()}}},{key:"addAnimater",value:function(e){this._animaters.push(e)}},{key:"initTheme",value:function(e,t,n){var r=this.MapOptions.themeFileType||t.filetype||t.fileType||t.image,i=new T.default(this.MapOptions.mapThemeURL,e);i.clearColor=this.MapOptions.defaultBackgroundColor,i.clearAlpha=this.MapOptions.defaultBackgroundAlpha,i.version=this.MapOptions.themeVersion,"rtheme"==r?(e=this.MapOptions.mapThemeURL+"/"+this.MapOptions.themeName+"/"+e+".rtheme",this.fmServer.getTheme(e,(function(e){i.rtheme=e,i.data=t,n&&(i.fileType=r,n(i))}),(function(){i.rtheme=null,console.warn("以 rtheme 格式加入资源失败!")}))):(i.rtheme=null,i.data=t,n&&n(i)),this._modelSelectColor=i.getModelSelectColor()}},{key:"levelToScale",value:function(e){return this.mapScaleLevels[e-1]}},{key:"scaleTolevel",value:function(e){if(e>this.mapScaleLevels[0])return 1;if(e<this.mapScaleLevels[this.mapScaleLevels.length-1])return this.mapScaleLevels.length;for(var t=0;t<this.mapScaleLevels.length-1;t++)if(e>=this.mapScaleLevels[t+1]&&e<=this.mapScaleLevels[t])return e-this.mapScaleLevels[t+1]<this.mapScaleLevels[t]-e?t+2:t+1}},{key:"getMapScaleInfo",value:function(){for(var e,t,n=56;n<2e3;n++)!0===matchMedia("(max-resolution: "+n+"dpi)").matches&&(e=n/window.devicePixelRatio);window.screen.deviceXDPI?e=window.screen.deviceXDPI:((t=document.createElement("DIV")).style.cssText="width:1in;height:1in;position:absolute;left:0px;top:0px;z-index:99;visibility:hidden",document.body.appendChild(t),e=(0,I.default)(t.offsetWidth),t.parentNode.removeChild(t)),this._pixelsPerCentimeter=e/2.54}},{key:"getOrthoCameraSizeByPerspectiveCamera",value:function(e,t,r){e instanceof n&&(r=t,t=e.controls,e=e.mapView.camera);var i=e.fov,o=e.aspect;return e=null!=r?r:t.target.distanceTo(e.position),{top:(i=Math.tan(i*fm.Math.DEG2RAD/2)*e)||1,right:o=(o=(e=2*i)*o)/2}}},{key:"getCameraDistanceByScale",value:function(e){var t=this.renderer.perspectiveCamera.fov;return e/100*(this.renderer.domElementHeight/this._pixelsPerCentimeter)/2/Math.tan(t/2*fm.Math.DEG2RAD)}},{key:"getScaleByCameraDistance",value:function(){var e=this.renderer.perspectiveCamera.fov;return(new fm.Vector3).copy(this.controls.object.position).sub(this.controls.target).length()*(100*Math.tan(e/2*fm.Math.DEG2RAD)*2/(this.renderer.domElementHeight/this._pixelsPerCentimeter))}},{key:"getCameraScaleByScale",value:function(e){var t=this.renderer.orthographicCamera.top,n=this.renderer.orthographicCamera.bottom;return e/(Math.abs(t-n)*this._pixelsPerCentimeter*100/this.renderer.domElementHeight)}},{key:"getScaleByCameraScale",value:function(){var e=this.renderer.orthographicCamera.top,t=this.renderer.orthographicCamera.bottom;return(t=Math.abs(e-t)*this._pixelsPerCentimeter*100/this.renderer.domElementHeight)/this.renderer.orthographicCamera.zoom}},{key:"getLayerByAlias",value:function(e,t,n){var r=[];return(e=this.getFMGroup(e)).traverseByAlias([t],(function(e,t){r.push(e),n&&n(e)}),!0),r}},{key:"moveTo",value:function(e){return this._moveTo(e,!1)}},{key:"_moveTo",value:function(e,t){var n,r=this,i=this.center,o=e.x-i.x,a=-e.y+i.y,s=this.controls.target.x,u=this.controls.target.z,l=e.groupID;if(i=l?(n=this.controls.target.y,this.currentFocusGroup=l,this.nodeManager.getHeight(this._currentSceneId,this.currentFocusGroup)):(n=0,0),!this.MapOptions.moveToAnimateMode&&!t)return l&&this.controls.panUp(i-n),this.controls.panAdd({x:o-s,z:a-u,y:0}),this.controls.update(),null;L.default[this.uuid].currentMoveMapAnimater&&(L.default[this.uuid].currentMoveMapAnimater.stop(),this.removeAnimater(L.default[this.uuid].currentMoveMapAnimater));var c=new S.default({h:n,x:s,z:u},{h:i,x:o,z:a},e.time?1e3*e.time:500,(function(){r.removeAnimater(c),L.default[r.uuid].currentMoveMapAnimater=null,e.callback&&e.callback()}),(function(t,n){l&&r.controls.panUp(n.h),r.controls.panAdd({x:n.x,z:n.z,y:0}),r.controls.update(),e.update&&e.update()})).start();return L.default[this.uuid].currentMoveMapAnimater=c,this._animaters.push(c),c}},{key:"moveToCenter",value:function(e){var t;"object"!==(0,h.default)(e)?(t=this.center,this.moveTo({x:t.x,y:t.y,groupID:e||this.focusGroupID})):this.moveTo(e)}},{key:"rotateTo",value:function(e){var t=this,n=this.controls.getAzimuthalAngle(),r=-e.to%360*fm.Math.DEG2RAD,i=r,o=0;r-n!=0&&(o=Math.sin(r-n)/Math.abs(Math.sin(r-n))*Math.acos(Math.cos(r-n))),r=n+o,L.default[this.uuid].currentRotateAnimater&&(L.default[this.uuid].currentRotateAnimater.stop(),this.removeAnimater(L.default[this.uuid].currentRotateAnimater));var a=new S.default({theta:n},{theta:r},e.duration?1e3*e.duration:500,(function(){t.removeAnimater(a),t.controls.setUpdate(void 0,void 0,void 0,i),e.callback&&e.callback()}),(function(n,r){t.controls.setUpdate(void 0,r.theta),e.update&&e.update()})).start();return L.default[this.uuid].currentRotateAnimater=a,this._animaters.push(a),a}},{key:"scaleTo",value:function(e,t){var n=this;if(e.scale){var r=e.scale,i=this.mapScale,o=this.getCameraDistanceByScale(r),a=this.controls.object.position.distanceTo(this.controls.target),s=(new fm.Vector3).copy(this.controls.object.position).sub(this.controls.target).normalize();if(!this.MapOptions.scaleToAnimateMode&&!t)return t=(new fm.Vector3).copy(s).multiplyScalar(o-a),this.controls.setUpdate(0,0,t),t=this.getCameraScaleByScale(r),this.renderer.orthographicCamera.zoom=1/t,this.renderer.orthographicCamera.updateProjectionMatrix(),this.renderer.resetSpriteSize(),null;var u=new S.default({phi:a,scale:i},{phi:o,scale:r},e.duration?1e3*e.duration:500,(function(t){n.removeAnimater(u),e.callback&&e.callback(),n.renderer.resetSpriteSize()}),(function(t,r){r=(new fm.Vector3).copy(s).multiplyScalar(r.phi),n.controls.setUpdate(0,0,r),e.update&&e.update(),t=n.getCameraScaleByScale(t.scale),n.renderer.orthographicCamera.zoom=1/t,n.renderer.orthographicCamera.updateProjectionMatrix()})).start();return this._animaters.push(u),u}}},{key:"scaleLevelIn",value:function(){var e=this.scaleLevel;e--,this.scaleLevelTo({level:e})}},{key:"scaleLevelOut",value:function(){var e=this.scaleLevel;e++,this.scaleLevelTo({level:e})}},{key:"scaleLevelTo",value:function(e){var t=this;if(e.level){var n=this.levelToScale(e.level),r=this.mapScale,i=this.getCameraDistanceByScale(n),o=this.controls.object.position.distanceTo(this.controls.target),a=(new fm.Vector3).copy(this.controls.object.position).sub(this.controls.target).normalize();if(!e.duration){var s=(new fm.Vector3).copy(a).multiplyScalar(i-o);return this.controls.setUpdate(0,0,s),s=this.getCameraScaleByScale(n),this.renderer.orthographicCamera.zoom=1/s,this.renderer.orthographicCamera.updateProjectionMatrix(),void this.controls.update()}var u=new S.default({phi:o,scale:r},{phi:i,scale:n},e.duration?1e3*e.duration:500,(function(n){t.removeAnimater(u),e.callback&&e.callback(),t.renderer.resetSpriteSize()}),(function(n,r){r=(new fm.Vector3).copy(a).multiplyScalar(r.phi),t.controls.setUpdate(0,0,r),e.update&&e.update(),n=t.getCameraScaleByScale(n.scale),t.renderer.orthographicCamera.zoom=1/n,t.renderer.orthographicCamera.updateProjectionMatrix()})).start();return this._animaters.push(u),u}}},{key:"tiltTo",value:function(e){var t=this;if(0!==e.to&&e.to){var n=this.controls.getPolarAngle(),r=(90-e.to)*fm.Math.DEG2RAD,i=new S.default({phi:n},{phi:r},e.duration?1e3*e.duration:500,(function(n){t.removeAnimater(i),e.callback&&e.callback(),t.renderer.resetSpriteSize()}),(function(n,r){t.controls.setUpdate(r.phi),e.update&&e.update(n)})).start();return this._animaters.push(i),i}}},{key:"fullScreenAvaliable",value:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},{key:"coordMapToScreen",value:function(e,t,n){var r=this.threeCenter,i=this.center,o=this.controls.object;return t=this.getRotationCoord(e,t,!0),r=(t=new fm.Vector3(t.x-i.x,r.y+n,-t.y+r.y+i.y)).project(o),i=this.renderer.container.clientWidth,o=this.renderer.container.clientHeight,i=i/2*t.x+i/2,t=-o/2*t.y+o/2,o=!0,(1<Math.abs(r.x)||1<Math.abs(r.y)||1<Math.abs(r.z))&&(o=!1),{x:i,y:t,domvisible:o}}},{key:"getRotationCoord",value:function(e,t,n){var r=e-this.center.x,i=t-this.center.y,o=1;n&&(o=-1);var a=this.nodeManager._scenes[this._currentSceneId].groups[this.focusGroupID]._layers.extent[0]._scene.rotation.y;return n=Math.sin(o*a)*i+Math.cos(o*a)*r,a=Math.cos(o*a)*i-Math.sin(o*a)*r,{x:e+(r=n-r),y:t+(i=a-i)}}},{key:"coordScreenToMap",value:function(e,t,n,r,i){var o=this.controls.object,a=this.center,s=this.threeCenter,u=this.getFMGroup(this._currentFocusGroup).height;if(null!=u&&(n=void 0===n?u+this.MapOptions.pickCoordHeight:n,u=null,u=r?new fm.Vector3(e,t,n):new fm.Vector3(e/this.renderer.domElementWidth*2-1,1-t/this.renderer.domElementHeight*2,.5),e=new fm.Vector3,t=new fm.Vector3,o&&o.isPerspectiveCamera?(e.setFromMatrixPosition(o.matrixWorld),t.set(u.x,u.y,.5).unproject(o).sub(e).normalize()):o&&o.isOrthographicCamera&&(e.set(u.x,u.y,(o.near+o.far)/(o.near-o.far)).unproject(o),t.set(0,0,-1).transformDirection(o.matrixWorld)),o=(o=new fm.Vector3(0,1,0)).dot(t),!(Math.abs(o)<1e-4)))return s=-e.y+n+s.y,s/=t.y,s=(new fm.Vector3).copy(e).add((new fm.Vector3).copy(t).multiplyScalar(s)),i?s:{x:s.x+a.x,y:a.y-s.z,z:n}}},{key:"getScalelevelValueByVectics",value:function(e,t){return this.scaleTolevel(this.getScaleValueByVectics(e,t))}},{key:"getScaleValueByVectics",value:function(e,t){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y),i=this.renderer.domElementHeight;return e=null,(t=this.renderer.domElementWidth)<=i?n/r<=t/i?100*r/(i/+this._pixelsPerCentimeter):100*n/(t/+this._pixelsPerCentimeter):n/r<=t/i?100*r/(i/=+this._pixelsPerCentimeter):100*n/(t/=+this._pixelsPerCentimeter)}},{key:"toggleToTop",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e3;this.controls.minPolarAngle=0,this.controls.update();var r=this.controls.getPolarAngle();L.default[this.uuid].curPolarAngle=r,this.MapOptions.viewModeAnimateMode||(n=.001);var i=new S.default({phi:r},{phi:0},n,(function(n){t.removeAnimater(i),t.controls.maxPolarAngle=0;var r=t.getScaleByCameraDistance();r=t.getCameraScaleByScale(r),t.renderer.orthographicCamera.zoom=1/r,t.renderer.orthographicCamera.quaternion.copy(t.controls.object.quaternion),t.renderer.orthographicCamera.position.copy(t.controls.object.position),t.renderer.orthographicCamera.updateProjectionMatrix(),t.controls.object=t.renderer.orthographicCamera,e&&e(),t.renderer.resetSpriteSize(),L.default[t.uuid].isToggleViewMode=!1}),(function(e,n){t.controls.setUpdate(n.phi)})).start();L.default[this.uuid].isToggleViewMode=!0,this._animaters.push(i)}},{key:"toggleTo3D",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e3;this.controls.maxPolarAngle=(90-this.MapOptions.defaultMinTiltAngle)*fm.Math.DEG2RAD;var r=this.getScaleByCameraScale();r=this.getCameraDistanceByScale(r),this.renderer.perspectiveCamera.quaternion.copy(this.controls.object.quaternion),this.renderer.perspectiveCamera.position.copy(this.controls.object.position),this.renderer.perspectiveCamera.position.setY(this.controls.target.y+r),this.renderer.perspectiveCamera.updateMatrix(),this.controls.object=this.renderer.perspectiveCamera,this.renderer.resetSpriteSize(),r=L.default[this.uuid].curPolarAngle||(90-this.MapOptions.defaultTiltAngle)*fm.Math.DEG2RAD,this.MapOptions.viewModeAnimateMode||(n=.001);var i=new S.default({phi:0},{phi:r},n,(function(n){e&&e(),t.removeAnimater(i),L.default[t.uuid].isToggleViewMode=!1,t.renderer.resetSpriteSize()}),(function(e,n){t.controls.setUpdate(n.phi)})).start();L.default[this.uuid].isToggleViewMode=!0,this._animaters.push(i)}},{key:"getPixelTo3DdisByGid",value:function(e){var t,n,r=(new fm.Vector3).copy(this.controls.target),i=this.nodeManager.getSceneCenter(this._currentSceneId);return r.y=this.getFMGroup(e).height+this.getFMGroup(e).offsetHeight+i.y,10/("top"===this._viewMode?(i=this.renderer.orthographicCamera.top,n=this.renderer.orthographicCamera.bottom,10*Math.abs(i-n)/this.renderer.domElementHeight/this.renderer.orthographicCamera.zoom):(t=this.renderer.perspectiveCamera.near,n=this.renderer.perspectiveCamera.fov,r=this.controls.object.position.distanceTo(r),(n=10*t*Math.tan(n/2*fm.Math.DEG2RAD)*2/this.renderer.domElementHeight)*r/t))}},{key:"dispose",value:function(){cancelAnimationFrame(this._loopHander),this.dispatchEvent({type:"dispose"});var e,t=q(this._lineMarkers);try{for(t.s();!(e=t.n()).done;)e.value.dispose(this)}catch(e){t.e(e)}finally{t.f()}this.nodeManager.dispose(),this.dataManager.dispose(),this.controls.dispose(),this.renderer.dispose(),L.default.dispose(this.uuid),this._lineMarkers.length=0,this._windowPops.length=0,this.nodeManager=void 0,this.dataManager=void 0,this.controls=void 0,this.renderer=void 0,this.fmServer=void 0,this.MapOptions=void 0}},{key:"disposeById",value:function(e){this.nodeManager.disposeById(e),this.dataManager.disposeById(e)}},{key:"addLocationMarker",value:function(e){e.map=this,e.scene=this.nodeManager.getSceneById(this._currentSceneId),e.initSprite(this.nodeManager),this.addLocationToGroup(e,this._currentSceneId,e.groupID),e.renderNode.updateMatrixWorld(!0),this.renderer.setLocationSize(e.renderNode,e.size)}},{key:"addLocationToGroup",value:function(e,t,n){(n=this.nodeManager.getGroup(t,n)).addLocation(e)}},{key:"removeLocationMarker",value:function(e){this.removeLocationByGroup(e,this._currentSceneId,e.groupID),e.dispose()}},{key:"removeLocationByGroup",value:function(e,t,n){(n=this.nodeManager.getGroup(t,n)).removeLocation(e)}},{key:"addLineMarker",value:function(e,t){var n=this.center;e.initLine(n,t,this),this._lineMarkers.push(e),e.hideOrShowBy(this.visibleGroupIDs)}},{key:"removeLineMarker",value:function(e){var t=this._lineMarkers.indexOf(e);-1<t&&this._lineMarkers.splice(t,1),e.removeByMap(this)}},{key:"removeAllMarkers",value:function(){for(var e=this._lineMarkers.length-1;-1<e;e--)this._lineMarkers[e].removeByMap(this);this._lineMarkers.length=0}},{key:"clearLineMark",value:function(e){if(e)if((0,A.default)(e)){var t,n=q(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.removeLineMarker(r)}}catch(e){n.e(e)}finally{n.f()}}else this.removeLineMarker(e);else this.removeAllMarkers()}},{key:"drawLineMark",value:function(e,t,n){t.resolution=new fm.Vector2(this.renderer.container.clientWidth,this.renderer.container.clientHeight);var r=this.renderer.getCameraByViewMode(this._viewMode);t.near=r.near,t.far=r.far,t.url&&(t.map=this.nodeManager.materialManager.loadTexture(t.url,(function(e){})),t.map.wrapS=fm.RepeatWrapping,t.map.wrapT=fm.RepeatWrapping),this.addLineMarker(e,t),n&&n()}},{key:"setLastRender",value:function(){var e=this.nodeManager.getSceneById(this._currentSceneId);e&&(e=e.getLastRenderArray(),this.renderer.setBackRender(e))}},{key:"update",value:function(){if(this._loopHander=requestAnimationFrame(this.update.bind(this)),this.letUpdate){this.isFpsDisplay&&this.stats.begin();var e=(new Date).getTime(),t=e-this._currentTime;this._currentTime=e,this.mouseHoverEventFire(t);var n,r=q(this._animaters);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.enable&&i.run(t)}}catch(e){r.e(e)}finally{r.f()}var o,a=q(this.animationMixers);try{for(a.s();!(o=a.n()).done;)o.value.update(t/1e3)}catch(e){a.e(e)}finally{a.f()}this.dispatchEvent({type:"frameLoop",delTime:t}),this.is_ctrl_camera?(e=this.controls.target.x,u=this.controls.target.z,(u=Math.sqrt(e*e+u*u))>this.target_dis?this.controls.reset():(this.controls.saveState(),this.controls.update())):this.controls.update();var s,u=!1;this._renderTime+=t,1e3/this._allowfps<this._renderTime&&(s=this._renderTime,this._renderTime=0,u=!0),this.renderer&&u&&(this.updatePopsPosition(),this.allowRender&&(this.setLastRender(),this.renderer.update(this._viewMode)),this.dispatchEvent({type:"update",fps:1e3/s})),this.isFpsDisplay&&this.stats.end()}}},{key:"on",value:function(e,t){this.addEventListener(e,t)}},{key:"off",value:function(e,t){this.removeEventListener(e,t)}},{key:"registeredPop",value:function(e){this._windowPops.push(e)}},{key:"logoutPop",value:function(e){-1<(e=this._windowPops.indexOf(e))&&this._windowPops.splice(e,1)}},{key:"updatePopsPosition",value:function(){var e,t=this.renderer.getCameraByViewMode(this._viewMode),n=q(this._windowPops);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.updatePopPosition(r,t)}}catch(e){n.e(e)}finally{n.f()}}},{key:"updatePopPosition",value:function(e,t){t=t||this.renderer.getCameraByViewMode(this._viewMode);var n,r=new fm.Vector3;e.threeCoord?r.copy(e.threeCoord):e.marker?e.marker instanceof P.default?0<e.marker._meshes.length&&(e.marker._meshes[0].updateMatrixWorld(),e.marker._meshes[0].updateMatrixWorld(!0),r=(new fm.Vector3).setFromMatrixPosition(e.marker._meshes[0].matrixWorld)):(e.marker.renderNode.parent.updateMatrixWorld(),e.marker.renderNode.updateMatrixWorld(!0),r=(new fm.Vector3).setFromMatrixPosition(e.marker.renderNode.matrixWorld)):(n=this.center,r=r.set(e.coord.x-n.x,this.getFMGroup(e.coord.groupID).getHeight()+e.coord.height,-e.coord.y+n.y)),t=((r=r.project(t)).x+1)/2*this.renderer.container.clientWidth,r=(1-r.y)/2*this.renderer.container.clientHeight,e.updateCoord(t,r)}},{key:"getFMGroup",value:function(e){return this.nodeManager.getGroup(this._currentSceneId,e)}},{key:"getGroupHeight",value:function(e){var t=50;return this.getFMGroup(e)&&(t=this.getFMGroup(e).getHeight()),t}},{key:"getContainer",value:function(){return this.renderer.container}},{key:"getCurrGroupLength",value:function(){this.nodeManager.getGroupLength(this._currentSceneId)}},{key:"getCurrGroupIds",value:function(){return this.nodeManager.getGroupIds(this._currentSceneId)}},{key:"Printing",value:function(e){var t,n,r=this;if(this.isOneShot=!0,this.nodeManager._scenes[""+this._currentSceneId].groups[""+this._currentFocusGroup]._layers.textMarker[0])for(var i=0;i<this.nodeManager._scenes[""+this._currentSceneId].groups[""+this._currentFocusGroup]._layers.textMarker[0].textMarkers.length;i++)this.nodeManager._scenes[""+this._currentSceneId].groups[""+this._currentFocusGroup]._layers.textMarker[0].textMarkers[i]._renderNode&&(this.nodeManager._scenes[""+this._currentSceneId].groups[""+this._currentFocusGroup]._layers.textMarker[0].textMarkers[i]._renderNode.visible=!0);for(t in this.nodeManager._scenes[""+this._currentSceneId].groups[""+this._currentFocusGroup]._layers.facility[0]._facility)this.nodeManager._scenes[""+this._currentSceneId].groups[""+this._currentFocusGroup]._layers.facility[0]._facility[""+t]._renderNode&&(this.nodeManager._scenes[""+this._currentSceneId].groups[""+this._currentFocusGroup]._layers.facility[0]._facility[""+t]._renderNode.visible=!0);for(n in this.nodeManager._scenes[""+this._currentSceneId].groups[""+this._currentFocusGroup]._layers.label[0]._labels)this.nodeManager._scenes[""+this._currentSceneId].groups[""+this._currentFocusGroup]._layers.label[0]._labels[""+n]._renderNode&&(this.nodeManager._scenes[""+this._currentSceneId].groups[""+this._currentFocusGroup]._layers.label[0]._labels[""+n]._renderNode.visible=!0);var o=this.mapScaleLevel,a={level:21};this.scaleLevelTo(a);var s=this.controls.target.x,u=this.controls.target.z;this.controls.panAdd({x:-s,z:-u,y:0});var l,c,h,f,d=this.renderer.renderer.domElement.width,p=this.renderer.renderer.domElement.height,g=this.tiltAngle,m=this.rotateAngle;this.tiltAngle=90,this.rotateAngle=0,"3d"===this._viewMode?(l=this.renderer.orthographicCamera.zoom,this.viewMode="top",this.on("viewModeChange",(function(){var t=document.createElement("canvas");t.width=6*d,t.height=6*p;var n=t.getContext("2d");r._shot(t,n,0,l,s,u,o,"3d",g,m,e)}))):(c=this.renderer.orthographicCamera.zoom,(h=document.createElement("canvas")).width=6*d,h.height=6*p,f=h.getContext("2d"),a="top",this._shot(h,f,0,c,s,u,o,a,g,m,e))}},{key:"_shot",value:function(e,t,n,r,i,o,a,s,u,l,c){if(this.isOneShot&&n<36){var h=null,f=null;n<6?(h=0,f=+n):n<12?(h=1,f=n-6):n<18?(h=2,f=n-12):n<24?(h=3,f=n-18):n<30?(h=4,f=n-24):n<36&&(h=5,f=n-30);var d=this,p=this.renderer.renderer.domElement.width,g=this.renderer.renderer.domElement.height;this.renderer.orthographicCamera.setViewOffset(p,g,2.5*-p+p*h,2.5*-g+g*f,p,g),this.renderer.orthographicCamera.updateProjectionMatrix();var m=new Image;m.indexI=h,m.indexJ=f;var v={};return v.level=a,m.onload=function(n){d._shotIndex++,t.drawImage(n.path[0],p*n.path[0].indexI,g*n.path[0].indexJ),36===d._shotIndex&&(e.toBlob((function(e){c(e),d.renderer.orthographicCamera.zoom=6*r,d.renderer.orthographicCamera.updateProjectionMatrix(),d.viewMode=s,d.renderer.orthographicCamera.clearViewOffset(),d.checkNode(),d.setRenderList(),d.controls.panAdd({x:i,z:o,y:0}),d.tiltAngle=u,d.rotateAngle=l,d.scaleLevelTo(v),d.renderer.resetSpriteSize(),d.controls.update(),d.renderer.update(),d.isOneShot=!1})),d._shotIndex=0)},this.checkNode(),this.setRenderList(),this.renderer.resetSpriteSize(),this.controls.update(),this.renderer.update(),m.src=this.renderer.renderer.domElement.toDataURL(),n++,this._shot(e,t,n,r,i,o,a,s,u,l,c)}}},{key:"screenshot",value:function(e,t,n,r,i){var o=t.x-e.x,a=t.y-e.y;(f={x:0,y:0}).x=(t.x+e.x)/2,f.y=(t.y+e.y)/2;var s=this.renderer.container.getElementsByTagName("canvas")[0].style.width,u=this.renderer.container.getElementsByTagName("canvas")[0].style.height,l=s.split("p")[0],c=u.split("p")[0],h=(t.x-e.x)/(t.y-e.y)>l/c?l/(t.x-e.x):c/(t.y-e.y),f=(t=f.x-l/2,e=f.y-c/2,document.getElementsByTagName("canvas")[0]),d=document.createElement("canvas"),p=document.createElement("canvas"),g=document.createElement("canvas"),m=window.devicePixelRatio,v=new Image;("3d"===this.viewMode?this.renderer.perspectiveCamera:this.renderer.orthographicCamera).setViewOffset(l*h,c*h,l*(h-1)/2+t*h,c*(h-1)/2+e*h,l,c),this.renderer.update(),d.width=o*h*m,d.height=a*h*m,d.style.width=o*h*m+"px",d.style.height=a*h*m+"px",n?(p.width=1240*Math.pow(1.414,r-1),p.height=1754*Math.pow(1.414,r-1),p.style.width=1240*Math.pow(1.414,r-1)+"px",p.style.height=1754*Math.pow(1.414,r-1)+"px"):(p.height=1240*Math.pow(1.414,r-1),p.width=1754*Math.pow(1.414,r-1),p.style.height=1240*Math.pow(1.414,r-1)+"px",p.style.width=1754*Math.pow(1.414,r-1)+"px"),g.height=a*Math.pow(1.414,r-1),g.width=o*Math.pow(1.414,r-1),g.style.height=a*Math.pow(1.414,r-1)+"px",g.style.width=o*Math.pow(1.414,r-1)+"px",v.src=f.toDataURL("image/png"),("3d"===this.viewMode?this.renderer.perspectiveCamera:this.renderer.orthographicCamera).clearViewOffset();var y=d.getContext("2d"),_=p.getContext("2d"),x=g.getContext("2d"),A=this;v.onload=function(){A.viewMode,y.drawImage(v,-(l*m-o*h*m)/2,-(c*m-a*h*m)/2);var e=new Image;e.src=d.toDataURL("image/png"),e.onload=function(){var t=Math.min(1240*Math.pow(1.414,r-1)/(o*h),1754*Math.pow(1.414,r-1)/(a*h)),n=(p.width-o*h*t)/2,s=(p.height-a*h*t)/2;_.drawImage(e,n,s,o*h*t,a*h*t),x.drawImage(e,0,0,o*Math.pow(1.414,r-1),a*Math.pow(1.414,r-1));var u=p.toDataURL("image/png"),l=g.toDataURL("image/png");-1<navigator.userAgent.indexOf("Edge")||-1<navigator.userAgent.indexOf(".NET4.0C")?i(u,s=null,l,t=null):p.toBlob((function(e){g.toBlob((function(t){i(u,e,l,t)}))}))}}}},{key:"enableKeys",value:function(e){this.controls.enableKeys=e}},{key:"getSearchObjects",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=null;5===e[n].nodeType?r="model":4===e[n].nodeType?r="extent":12===e[n].nodeType?r="label":11===e[n].nodeType?r="facility":35===e[n].nodeType&&(r="externalModel"),t.push(this.getFMGroup(e[n].groupID).getNodeByLayerId(r,e[n].ID))}return t}},{key:"getEffectRenderer",value:function(){var e=new EffectRenderer(this.MapOptions,this);return this.renderer=e,e}},{key:"getCompassOffset",value:function(){return{left:this.MapOptions.compassOffset[0],top:this.MapOptions.compassOffset[1]}}},{key:"setCompassOffset",value:function(e,t){this.MapOptions.compassOffset[0]=t,this.MapOptions.compassOffset[1]=e,this.renderer.resetCompass()}},{key:"getCompassScale",value:function(){return this.MapOptions.compassSize}},{key:"setCompassScale",value:function(e){this.MapOptions.compassSize=e,this.renderer.resetCompass()}},{key:"getStation",value:function(){var e={};-1<navigator.userAgent.indexOf("Opera")&&(e.userAgent="Opera"),-1<navigator.userAgent.indexOf("Firefox")&&(e.userAgent="FF"),-1<navigator.userAgent.indexOf("Chrome")&&(e.userAgent="Chrome"),-1<navigator.userAgent.indexOf("Safari")&&0===navigator.userAgent.indexOf("Chrome")&&(e.userAgent="Safari"),-1<navigator.userAgent.indexOf("compatible")&&-1<navigator.userAgent.indexOf("MSIE")&&!isOpera&&(e.userAgent="IE"),-1<navigator.userAgent.indexOf("Trident")&&(e.userAgent="Edge"),e.sdkVersion=R.default.VERSION+"."+R.default.BUILD,e.appName=this.MapOptions.appName;var t=(n=document.createElement("canvas")).getContext("experimental-webgl"),n=t.getExtension("WEBGL_debug_renderer_info");e.gpu=n?t.getParameter(n.UNMASKED_RENDERER_WEBGL):null,e.os=navigator.platform;for(var r=!0,i=navigator.userAgent,o=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),a=0;a<o.length;a++)if(0<i.indexOf(o[a])){r=!1;break}r&&(e.device="pc"),e.appkey=this.MapOptions.key,e.product="JS",n=(0,_.default)(e);var s=new XMLHttpRequest;return s.open("POST",B.default+"sdk/collect",!0),s.setRequestHeader("Content-type","application/json"),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.onreadystatechange=function(e){4===s.readyState&&s.status},s.send(n),e}},{key:"getVideoMemoryAmount",value:function(e){return this.videoMemory.getVideoMemoryAmount(e)}},{key:"setCompass",value:function(e){var t,n,r,i,o;this.renderer.compassNode||(t=this.renderer.getAspect(),n=this.renderer.getScaleByPixels(1,this.MapOptions.compassSize),r=-this.renderer.getScaleByPixels(1,o[1]),i=this.renderer.getScaleByPixels(1,o[0])/t,o=this.renderer.getCompassOffset(this.MapOptions.compassPosition,n,t,i,r),this.renderer.compassNode=this.nodeManager.createCompassNode(n,this._compassBG,this._compassFG,o.ox,o.oy),this.renderer.compassNode.material.uniforms.rotation.value=this.controls.getAzimuthalAngle())}},{key:"showAllGroup",get:function(){return this._showAllGroup}},{key:"compass",get:function(){var e=this,t=this.renderer,n=this.nodeManager.materialManager;return{setBgImage:function(r){e._compassBG=r,t.compassNode&&(t.compassNode.material.uniforms.mapBack.value=n.loadTexture(r,(function(e){t.compassNode.material.needsUpdate=!0})))},setFgImage:function(r){e._compassFG=r,t.compassNode&&(t.compassNode.material.uniforms.mapfront.value=n.loadTexture(r,(function(e){t.compassNode.material.needsUpdate=!0})))}}}},{key:"modelSelectColor",get:function(){return this._modelSelectColor}},{key:"groupIDs",get:function(){var e=[];return e.push.apply(e,(0,c.default)(this.nodeManager.getSceneById(this._currentSceneId).groupIds)),e}},{key:"visibleGroupIDs",get:function(){return this.getVisibleGroups()},set:function(e){this._visibleGroups=e,this.hideOrShowLine(),this.checkNode(),this.setRenderList(),this.avoidMarkers(),this.renderer.resetSpriteSize(),this.dispatchEvent({type:"visibleGroupIDsChanged",gids:e})}},{key:"mapScaleLevel",get:function(){return this._mapScaleLevel},set:function(e){var t,n;"object"===(0,h.default)(e)&&(t=e.duration,n=e.callback,e=e.level),e<this.minScaleLevel?e=this.minScaleLevel:e>this.maxScaleLevel&&(e=this.maxScaleLevel),this.scaleLevelTo({level:e,duration:t,callback:n}),this._mapScale=this.levelToScale(e),this._mapScaleLevel=e}},{key:"mapScale",get:function(){return this._mapScale},set:function(e){e<this.minScale?e=this.minScale:e>this.maxScale&&(e=this.maxScale),this.scaleTo({scale:e}),this._mapScaleLevel=this.scaleTolevel(e),this._mapScale=e}},{key:"scaleLevel",get:function(){return this.mapScaleLevel}},{key:"maxScale",get:function(){return this._maxScale},set:function(e){e<=this.mapScaleLevels[this.mapScaleLevels.length-1]?e=this.mapScaleLevels[this.mapScaleLevels.length-2]:e>this.mapScaleLevels[0]&&(e=this.mapScaleLevels[0]),this._minScaleLevel=this.scaleTolevel(e),this._maxScale=e,this.controls.maxDistance=this.getCameraDistanceByScale(this._maxScale),this.controls.minZoom=1/this.getCameraScaleByScale(this._maxScale)}},{key:"minScale",get:function(){return this._minScale},set:function(e){e<this.mapScaleLevels[this.mapScaleLevels.length-1]?e=this.mapScaleLevels[this.mapScaleLevels.length-1]:e>=this.mapScaleLevels[0]&&(e=this.mapScaleLevels[1]),this._maxScaleLevel=this.scaleTolevel(e),this._minScale=e,this.controls.minDistance=this.getCameraDistanceByScale(this._minScale),this.controls.maxZoom=1/this.getCameraScaleByScale(this._minScale)}},{key:"minScaleLevel",get:function(){return this._minScaleLevel},set:function(e){e<1&&(e=1),29<=e&&(e=28),this._maxScale=this.levelToScale(e),this.controls.maxDistance=this.getCameraDistanceByScale(this._maxScale),this.controls.minZoom=1/this.getCameraScaleByScale(this._maxScale),this._minScaleLevel=e}},{key:"maxScaleLevel",get:function(){return this._maxScaleLevel},set:function(e){e<=1&&(e=2),29<e&&(e=29),this._minScale=this.levelToScale(e),this._maxScaleLevel=e,this.controls.minDistance=this.getCameraDistanceByScale(this._minScale),this.controls.maxZoom=1/this.getCameraScaleByScale(this._minScale)}},{key:"maxFps",get:function(){return this._allowfps},set:function(e){this._allowfps=e}},{key:"viewMode",get:function(){return this._viewMode},set:function(e){var t,n,r=this;L.default[this.uuid].isToggleViewMode||(t=function(){r.dispatchEvent({type:"viewModeChange",mode:e})},"3d"==e&&"3d"!=this._viewMode?(this.renderer.viewMode=e,this._viewMode=e,n=this.nodeManager.getRenderList(),this.renderer.renderList=n,this.toggleTo3D((function(){t()}),1e3*this.MapOptions.viewModeAnimateTime)):"top"==e&&"top"!=this._viewMode&&this.toggleToTop((function(){r._viewMode=e,r.renderer.viewMode=e;var n=r.nodeManager.getRenderList();r.renderer.renderList=n,t()}),1e3*this.MapOptions.viewModeAnimateTime))}},{key:"showCompass",get:function(){return this.renderer.showCompass},set:function(e){var t,n,r,i;e&&!this.renderer.compassNode&&(t=this.renderer.getAspect(),n=this.renderer.getScaleByPixels(1,this.MapOptions.compassSize),i=-this.renderer.getScaleByPixels(1,this.MapOptions.compassOffset[1]),r=this.renderer.getScaleByPixels(1,this.MapOptions.compassOffset[0])/t,i=this.renderer.getCompassOffset(this.MapOptions.compassPosition,n,t,r,i),this.renderer.compassNode=this.nodeManager.createCompassNode(n,this._compassBG,this._compassFG,i.ox,i.oy),this.renderer.compassNode.material.uniforms.rotation.value=-this.controls.getAzimuthalAngle()),this.renderer.showCompass=e}},{key:"currentFocusGroup",get:function(){return this._currentFocusGroup},set:function(e){this._currentFocusGroup=e,1<this.visibleGroupIDs.length?-1<this.visibleGroupIDs.indexOf(e)||(this.visibleGroupIDs.push(e),this.visibleGroupIDs=this.visibleGroupIDs,this.checkNode(),this.setRenderList()):this.visibleGroupIDs=[e],this.dispatchEvent({type:"focusGroupIDChanged",gid:e})}},{key:"focusGroupID",get:function(){return this.currentFocusGroup},set:function(e){this.changeFocusToGroup({gid:e})}},{key:"center",get:function(){return(new fm.Vector3).copy(this.nodeManager.getSceneById(this._currentSceneId).mapcenter)}},{key:"threeCenter",get:function(){return(new fm.Vector3).copy(this.nodeManager.getSceneById(this._currentSceneId).center)}},{key:"maxX",get:function(){return this.nodeManager.getSceneById(this._currentSceneId).bbox.max.x}},{key:"maxY",get:function(){return this.nodeManager.getSceneById(this._currentSceneId).bbox.max.y}},{key:"minX",get:function(){return this.nodeManager.getSceneById(this._currentSceneId).bbox.min.x}},{key:"minY",get:function(){return this.nodeManager.getSceneById(this._currentSceneId).bbox.min.y}},{key:"groupSpace",get:function(){return this.nodeManager.getSceneById(this._currentSceneId).space},set:function(e){var t=this.nodeManager.getSceneById(this._currentSceneId);t.space=e;var n=t.mapcenter,r=this.groupIDs[this.groupIDs.length-1];this.nodeManager.checkNodeByFrustum(this.dataManager.getDecodeScene(this._currentSceneId),this.renderer.getFrustumByViewMode(this._viewMode),this.getVisibleGroups(),this.mapScaleLevel,this._currentSceneId);var i,o=q(this._lineMarkers);try{for(o.s();!(i=o.n()).done;)i.value.rebuildLine(n,this,this._visibleGroups,r)}catch(e){o.e(e)}finally{o.f()}}},{key:"themeName",get:function(){return this.nodeManager.getSceneById(this._currentSceneId).theme.themeName},set:function(e){var t=this.MapOptions.mapThemeURL+"/"+e+"/"+e+".theme",n=this,r=this.nodeManager.getSceneById(this._currentSceneId);r.theme.themeName!==e&&(this.MapOptions.defaultThemeName=e,this.fmServer.getTheme(t,(function(t){n.initTheme(e,t,(function(e){n.setBackgroundColor(e.clearColor,e.clearAlpha),r.theme=e,r.changeTheme(e)}))})))}},{key:"setThemeByJson",value:function(e,t){var n=this,r=this.nodeManager.getSceneById(this._currentSceneId);n.initTheme(e,t,(function(e){n.setBackgroundColor(e.clearColor,e.clearAlpha),r.theme=e,r.changeTheme(e)}))}},{key:"setAutoRotateBymodel",value:function(e){this.autoRotateBymodel=e}},{key:"getAutoRotateBymodel",value:function(){return this.autoRotateBymodel}},{key:"setAutoRotateBymodelSpeed",value:function(e){this.autoRotateBymodelSpeed=e}},{key:"getAutoRotateBymodelSpeed",value:function(){return this.autoRotateBymodelSpeed}},{key:"fullScreen",get:function(){return this._fullScreen},set:function(e){var t=(t=this.renderer.container)||document.body;try{e?(t.webkitRequestFullScreen||t.mozRequestFullScreen).call(t):(document.webkitCancelFullScreen||document.mozCancelFullScreen).call(document),this._fullScreen=e}catch(e){console.error(e)}}},{key:"rotateAngle",get:function(){return-this.controls.getAzimuthalAngle()*fm.Math.RAD2DEG},set:function(e){(e=-e*fm.Math.DEG2RAD)>Math.PI?e-=2*Math.PI:e<-Math.PI&&(e=2*Math.PI+e),e<this.controls.minAzimuthAngle&&(e=this.controls.minAzimuthAngle),e>this.controls.maxAzimuthAngle&&(e=this.controls.maxAzimuthAngle),this.controls.setUpdate(void 0,void 0,void 0,e),this.controls.update()}},{key:"maxTitleAngle",get:function(){return(Math.PI/2-this.controls.minPolarAngle)*fm.Math.RAD2DEG},set:function(e){"3d"===this._viewMode&&(this.controls.minPolarAngle=(90-e)*fm.Math.DEG2RAD),this.MapOptions.defaultMaxTiltAngle=e}},{key:"minTitleAngle",get:function(){return(Math.PI/2-this.controls.maxPolarAngle)*fm.Math.RAD2DEG},set:function(e){"3d"===this._viewMode&&(this.controls.maxPolarAngle=(90-e)*fm.Math.DEG2RAD),this.MapOptions.defaultMinTiltAngle=e}},{key:"labelLanguage",get:function(){return this.MapOptions.defaultLabelLanguage},set:function(e){var t;e!==this.labelLanguage&&(this.MapOptions.defaultLabelLanguage=e,(t=this.nodeManager.getSceneById(this._currentSceneId))&&t.setLabelLanguage(e))}},{key:"backgroundColor",set:function(e){this.renderer.renderer.setClearColor((0,I.default)(e))}},{key:"tiltAngle",get:function(){return(Math.PI/2-this.controls.getPolarAngle())*fm.Math.RAD2DEG},set:function(e){(e=(90-e)*fm.Math.DEG2RAD)<this.controls.minPolarAngle&&(e=this.controls.minPolarAngle),e>this.controls.maxPolarAngle&&(e=this.controls.maxPolarAngle),this.controls.setUpdate(void 0,void 0,void 0,void 0,e)}},{key:"listGroups",get:function(){return this.dataManager.getDecodeScene(this._currentSceneId).scene.layerGroups}},{key:"layerLocalHeight",get:function(){return 0}},{key:"gestureEnableController",get:function(){return this._enterControl}}]),n}(u.default),t.default=u},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(55);var o=i(n(2)),a=i(n(3)),s=i(n(212)),u=i(n(115));n=function(){function e(){(0,o.default)(this,e),this.netArea=u.default}return(0,a.default)(e,[{key:"getScene",value:function(e,t,n,r,i,o,a){var u=n?t+".scene":t,l=null===t?e:e+"/"+u+".fmap";u=new s.default,r&&(n||(l=e),u.setRequestHeader({"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"})),u.requestMethod=i||"GET",u.sendData=r,u.setResponseType("arraybuffer"),u.getFile(l,(function(e){o(e,t)}),(function(e){console.error("网络请求错误"),a&&a(e)}))}},{key:"getFloor",value:function(e,t,n,r,i,o,a){var u,l,c;a?this.getUrlFloor(e,t,n,r,i,o):(u=new s.default,"fengmap"==e&&(e=this.netArea+"sdk/authLayered/downMaps",u.requestMethod="POST",u.sendData=o,u.setRequestHeader({"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"})),l=e+"/"+n+"."+t+".biz.fmap",o=e+"/"+n+"."+t+".geo.fmap",c=e+"/"+n+"."+t+".navi.fmap",u.setResponseType("arraybuffer"),u.getFile(o,(function(e){u.getFile(l,(function(t){u.getFile(c,(function(n){i(e,t,n,r)}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")})))}},{key:"getUrlFloor",value:function(e,t,n,r,i,o){var a=new s.default;"fengmap"==e&&(e=this.netArea+"sdk/authLayered/obtainMapRoute",a.requestMethod="POST",a.sendData=o,a.setRequestHeader({"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"}));var u=e+"/"+n+"."+t+".biz.fmap",l=e+"/"+n+"."+t+".geo.fmap",c=e+"/"+n+"."+t+".navi.fmap",h=this;a.getFile(l,(function(e){a.getFile(u,(function(t){a.getFile(c,(function(n){var a=n.replace('"',"").replace('"',""),s=t.replace('"',"").replace('"',"");n=e.replace('"',"").replace('"',""),h.getUrlFloorData(s,n,a,r,o,i)}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")}))}},{key:"getUrlFloorData",value:function(e,t,n,r,i,o){var a=new s.default;a.sendData=null,a.requestMethod="GET",a.setRequestHeader({"X-Requested-With":"XMLHttpRequest"}),a.setResponseType("arraybuffer"),a.getFile(t,(function(t){a.getFile(e,(function(e){a.getFile(n,(function(n){o(t,e,n,r)}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")}))}},{key:"getTheme",value:function(e,t){(new s.default).getFile(e,(function(e){e=JSON.parse(e),t(e)}),(function(){}))}},{key:"getData",value:function(e,t,n,r,i,o){var a=new s.default;a.requestMethod=r||"GET",a.sendData=i,a.setRequestHeader(o),a.getFile(e,(function(e){e=JSON.parse(e),t(e)}),(function(e){n(e)}))}},{key:"getUrl",value:function(e,t,n,r,i,o,a){var u=e+"/"+(l=n?t+".scene":t)+".fmap",l=new s.default;r&&(n||(u=e),l.setRequestHeader({"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"})),l.requestMethod=i||"GET",l.sendData=r,l.getFile(u,(function(e){o(e,t)}),(function(e){console.error("网络请求错误"),a&&a(e)}))}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e),this.requestMethod="GET",this._requestHeader={},this.sendData=null}return(0,a.default)(e,[{key:"getFile",value:function(e,t,n,r,i){void 0!==this._path&&(e=this._path+e);var o,a=new XMLHttpRequest;for(o in a.open(this.requestMethod,e,!0),a.addEventListener("load",(function(e){var r=this.response;200===this.status||0===this.status||201===this.status?(0===this.status&&console.warn("FMMap FileLoader: HTTP Status 0 received."),t(r)):n(r)}),!1),a.addEventListener("progress",(function(e){r&&r()}),!1),a.addEventListener("error",(function(e){n()}),!1),a.addEventListener("abort",(function(e){i&&i()}),!1),void 0!==this._responseType&&(a.responseType=this._responseType),void 0!==this._withCredentials&&(a.withCredentials=this._withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this._mimeType?this._mimeType:"text/plain"),this._requestHeader)a.setRequestHeader(o,this._requestHeader[o]);a.send(this.sendData)}},{key:"setPath",value:function(e){return this._path=e,this}},{key:"setResponseType",value:function(e){return this._responseType=e,this}},{key:"setWithCredentials",value:function(e){return this._withCredentials=e,this}},{key:"setMimeType",value:function(e){return this._mimeType=e,this}},{key:"setRequestHeader",value:function(e){return e&&(this._requestHeader=e),this}}]),e}(),t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={NORTH:"n",n:0,SOUTH:"s",s:180,WEST:"w",w:-90,EAST:"e",e:90,NORTH_EAST:"ne",ne:45,NORTH_WEST:"nw",nw:-45,SOUTH_EAST:"se",se:135,SOUTH_WEST:"sw",sw:-135},t.default=n},function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;0<=r;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",i=!1,o=arguments.length-1;-1<=o&&!i;o--){var a=0<=o?arguments[o]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,i="/"===a.charAt(0))}return(i?"/":"")+(t=n(r(t.split("/"),(function(e){return!!e})),!i).join("/"))||"."},t.normalize=function(e){var o=t.isAbsolute(e),a="/"===i(e,-1);return(e=n(r(e.split("/"),(function(e){return!!e})),!o).join("/"))||o||(e="."),e&&a&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;0<=n&&""===e[n];n--);return n<t?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}var l=[];for(u=s;u<i.length;u++)l.push("..");return(l=l.concat(o.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,o=e.length-1;1<=o;--o)if(47===(t=e.charCodeAt(o))){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){return e=function(e){"string"!=typeof e&&(e+="");for(var t=0,n=-1,r=!0,i=e.length-1;0<=i;--i)if(47===e.charCodeAt(i)){if(!r){t=i+1;break}}else-1===n&&(r=!1,n=i+1);return-1===n?"":e.slice(t,n)}(e),t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,o=0,a=e.length-1;0<=a;--a){var s=e.charCodeAt(a);if(47===s){if(i)continue;n=a+1;break}-1===r&&(i=!1,r=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1)}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===n+1?"":e.slice(t,r)};var i=function(e,t,n){return e.substr(t,n)}}).call(this,n(156))},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(112));n(13);var a=i(n(216)),s=i(n(386)),u=new((i=i(n(211))).default),l={check:(n=u.netArea)+"sdk/check",onlineCheck:n+"sdk/auth/web",fmFileServer:n+"sdk/auth/downMaps"},c=(i=function(e,t,n){return!(!e||"string"!=typeof t||32!=t.length||null!=e&&""!=e&&(t=a.default.decryption(t,"026685bf295f587b5dffc1f18d5dc27c"),n=s.default.encryption(n),t=a.default.decryption(t,n),t!=e))},function(e,t,n){return n=n||"fengmap.localhost:",t=s.default.encryption(n+t),a.default.decryption(e,t)}),h=(n=function(){var e,t=((e=new Date).getFullYear(),e.getMonth()+1),n=(e=e.getDate())%2==0?1:-1;return""+Math.max(Math.pow(e%10+ +n,2)+n*t,0)+Math.abs(2*e+n*t)},n(),function(e,t,n){c(e,t);var r=window.location.host,i=r.indexOf(":");return-1<i&&(r=r.slice(0,i)),{webURL:r=r||"0.0.0.0",appKey:e,mapId:n,appName:t}});i={checkOffLine:function(e,t,n,r){return(n=n||r)==c(e,t)},checkIsOnLine:function(e,t,n){u.getData(l.check,(function(t){e&&e()}),(function(e){t&&t()}))},checkOnLine:function(e,t,n,r,i,a){var s=l.onlineCheck;n=h(e,t,n),n=(0,o.default)(n),u.getData(s,(function(e){e?e.success?r&&r(e):i&&i(e):i&&i()}),(function(e){e?(e=JSON.parse(e),i&&i(e)):i&&i()}),a,n,{"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"})},checkLicense:i,getCerityData:h,ls:0},t.default=i},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(14),n(108);var o,a,s,u,l,c,h,f,d,p,g,m=i(n(35));o=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],a=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],s=0,u=0,l=[2,0,0,0],c=function(e,t){var n=0,r=0,i=0;for(r=0;r<8;r++)1&t&&(n^=e),i=128&e,e<<=1,i&&(e^=27),t>>=1;return n},h=function(e,t,n){for(var r=0;r<4;r++)e[0+r]^=t[16*n+4*r],e[4+r]^=t[16*n+4*r+1],e[8+r]^=t[16*n+4*r+2],e[12+r]^=t[16*n+4*r+3]},f=function(e){for(var t,n,r,i=1;i<4;i++)for(n=0;n<i;){for(r=e[4*i+4-1],t=3;0<t;t--)e[4*i+t]=e[4*i+t-1];e[4*i+0]=r,n++}},d=function(e){for(var t,n,r,i=0;i<4;i++)for(t=0;t<4;t++)n=(240&e[4*i+t])>>4,r=15&e[4*i+t],e[4*i+t]=a[16*n+r]},p=function(e){for(var t=0;t<4;t++)e[t]=o[16*((240&e[t])>>4)+(15&e[t])]},g=function(e){return(0,m.default)(e,16)},n={decryption:function(e,t){for(var n=Array(16),r=0;r<16;r++)n[r]=16*g(t.substr(2*r,1))+g(t.substr(2*r+1,1));var i=Array(16);for(r=0;r<16;r++)i[r]=16*g(e.substr(2*r,1))+g(e.substr(2*r+1,1));var o=Array(16);switch(r=[],n.length){default:case 16:s=4,u=10;break;case 24:s=6,u=12;break;case 32:s=8,u=14}for(var a=r=Array(16*(u+1)),m=Array(4),v=4*(u+1),y=0;y<s;y++)a[4*y+0]=n[4*y+0],a[4*y+1]=n[4*y+1],a[4*y+2]=n[4*y+2],a[4*y+3]=n[4*y+3];for(y=s;y<v;y++){if(m[0]=a[4*(y-1)+0],m[1]=a[4*(y-1)+1],m[2]=a[4*(y-1)+2],m[3]=a[4*(y-1)+3],0==y%s){var _=void 0,x=void 0;for(_=(n=m)[0],x=0;x<3;x++)n[x]=n[x+1];if(n[3]=_,p(m),1==(n=y/s))l[0]=1;else if(1<n)for(l[0]=2,n--;0<n-1;)l[0]=c(l[0],2),n--;n=m,_=l,(x=m)[0]=n[0]^_[0],x[1]=n[1]^_[1],x[2]=n[2]^_[2],x[3]=n[3]^_[3]}else 6<s&&4==y%s&&p(m);a[4*y+0]=a[4*(y-s)+0]^m[0],a[4*y+1]=a[4*(y-s)+1]^m[1],a[4*y+2]=a[4*(y-s)+2]^m[2],a[4*y+3]=a[4*(y-s)+3]^m[3]}for(a=Array(16),m=0;m<4;m++)for(y=0;y<4;y++)a[4*m+y]=i[m+4*y];for(h(a,r,u),i=u-1;1<=i;i--)for(f(a),d(a),h(a,r,i),m=a,y=[14,9,13,11],v=x=void 0,n=Array(4),_=Array(4),v=0;v<4;v++){for(x=0;x<4;x++)n[x]=m[4*x+v];x=y;var A=n,I=_;for(I[0]=c(x[0],A[0])^c(x[3],A[1])^c(x[2],A[2])^c(x[1],A[3]),I[1]=c(x[1],A[0])^c(x[0],A[1])^c(x[3],A[2])^c(x[2],A[3]),I[2]=c(x[2],A[0])^c(x[1],A[1])^c(x[0],A[2])^c(x[3],A[3]),I[3]=c(x[3],A[0])^c(x[2],A[1])^c(x[1],A[2])^c(x[0],A[3]),x=0;x<4;x++)m[4*x+v]=_[x]}for(f(a),d(a),h(a,r,0),m=0;m<4;m++)for(y=0;y<4;y++)o[m+4*y]=a[4*m+y];for(i="",r=0;r<16;++r)(a=o[r].toString(16)).length<2&&(a="0"+a),i+=a;return i}},t.default=n},function(e,n,r){"use strict";var i=r(0),o=r(1);i(n,"__esModule",{value:!0}),n.default=void 0;var a=o(r(25));r(21);var s=o(r(2)),u=o(r(3)),l=l||{};l.GLEN1=15,l.GLEN2=6,l.GLEN3=17,r=function(){function e(){(0,s.default)(this,e),this._points,this._holes}return(0,u.default)(e,[{key:"parse",value:function(e){if(this._points=[],this._holes=[],0==e.indexOf("MULTIPOLYGON((("))for(var t=e.substring(l.GLEN1,e.length-3).split(/\),\(/),n=0;n<t.length;n++){var r=t[n].split(/,/);if(0==n)for(var i=0;i<r.length;i++){var o=r[i].split(" ");this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])})}else{var s=[];for(i=0;i<r.length;i++)o=r[i].split(" "),s.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});this._holes.push(s)}}else if(0==e.indexOf("POINT("))o=e.substring(l.GLEN2,e.length-1).split(" "),this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});else if(0==e.indexOf("MULTILINESTRING(("))for(r=e.substring(l.GLEN3,e.length-2).split(","),i=0;i<r.length;i++)o=r[i].split(" "),this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});return this}},{key:"toFixed",value:function(e){return+e.toFixed(2)}},{key:"parsePnt",value:function(e){if(this._points=[],0==e.indexOf("MULTIPOLYGON((("))for(var t=e.substring(l.GLEN1,e.length-3).split(","),n=0;n<t.length;n++){var r=t[n].split(" ");this._points.push({x:(0,a.default)(r[0]),y:(0,a.default)(r[1])})}else if(0==e.indexOf("POINT("))r=e.substring(l.GLEN2,e.length-1).split(" "),this._points.push({x:(0,a.default)(r[0]),y:(0,a.default)(r[1])});else if(0==e.indexOf("MULTILINESTRING(("))for(t=e.substring(l.GLEN3,e.length-2).split(","),n=0;n<t.length;n++)r=t[n].split(" "),this._points.push({x:(0,a.default)(r[0]),y:(0,a.default)(r[1])});return this}},{key:"toPntStrip",value:function(e){var t=[],n=this._points.length;if(!0===e){if(1<=n)for(var r=0;r<n-1;r++){var i=this._points[r];t.push(i.x,i.y)}}else for(r=0;r<n;r++)i=this._points[r],t.push(i.x,i.y);return t}},{key:"mergePnts",value:function(e){for(var t=[],n=e.length,r=0;r<n;r++){for(var i=e[r],o={x:this.toFixed(i.x),y:this.toFixed(i.y)},a=t.length,s=!1,u=0;u<a;u++){var l=t[u];if(l.x==o.x&&l.y==o.y){s=!0;break}}s||t.push(o)}return t}},{key:"toStrip",value:function(e){var n=[];if((r=this._points.length)<=0)return n;for(var r=this._points.splice(r-1,1)[0],i=this.mergePnts(this._points),o=i.length,a=0;a<o;a++){var s=i[a];n.push(s.x,s.y)}return!0===e||(t={x:this.toFixed(r.x),y:this.toFixed(r.y)},n.push(t.x,t.y),this._points.push(r)),n}},{key:"hasHoles",value:function(){return null!=this._holes&&0<this._holes.length}},{key:"toStripHoles",value:function(e){for(var n=[],r=0;r<this._holes.length;r++){for(var i=this._holes[r],o=[],a=i.length,s=(a=i.splice(a-1,1)[0],this.mergePnts(i)),u=s.length,l=0;l<u;l++){var c=s[l];o.push(c.x,c.y)}!0===e||(t={x:this.toFixed(a.x),y:this.toFixed(a.y)},o.push(t.x,t.y)),n.push(o)}return n}},{key:"holes",get:function(){return this._holes},set:function(e){this._holes=e}},{key:"points",get:function(){return this._points},set:function(e){this._points=e}}]),e}(),n.default=r},function(e,n,r){"use strict";var i=r(0),o=r(1);i(n,"__esModule",{value:!0}),n.default=void 0;var a=o(r(2)),s=o(r(3));r=function(){function e(){(0,a.default)(this,e),this._points,this._holes}return(0,s.default)(e,[{key:"parse",value:function(e,t){this._points=[],this._holes=[];for(var n=0,r=0;r<e.length;r++){var i;if("number"==typeof(i=(i=e[r].idxs)||e[r]))for(;n<i;)this._points.push({x:t[n],y:t[n+1]}),n+=2;else for(var o=0;o<i.length;o++)for(var a=i[o];n<a;)this._points.push({x:t[n],y:t[n+1]}),n+=2}return this}},{key:"parseGeometry",value:function(e,t){this._points=[],this._holes=[];for(var n=0,r=0;r<e.length;r++){var i;if("number"==typeof(i=(i=e[r].idxs)||e[r]))for(;n<i;)this._points.push({x:t[n],y:t[n+1]}),n+=2;else for(var o=0;o<i.length;o++)if(0===o)for(var a=i[o];n<a;)this._points.push({x:t[n],y:t[n+1]}),n+=2;else{for(var s=[],u=i[o];n<u;)s.push({x:t[n],y:t[n+1]}),n+=2;this._holes.push(s)}}return this}},{key:"mergePnts",value:function(e){for(var t=[],n=e.length,r=0;r<n;r++){for(var i=e[r],o={x:this.toFixed(i.x),y:this.toFixed(i.y)},a=t.length,s=!1,u=0;u<a;u++){var l=t[u];if(l.x==o.x&&l.y==o.y){s=!0;break}}s||t.push(o)}return t}},{key:"toStrip",value:function(e){var n=[];if((r=this._points.length)<=0)return n;for(var r=this._points.splice(r-1,1)[0],i=this._points,o=i.length,a=0;a<o;a++){var s=i[a];n.push(s.x,s.y)}return!0===e||(t={x:this.toFixed(r.x),y:this.toFixed(r.y)},n.push(t.x,t.y),this._points.push(r)),n}},{key:"toFixed",value:function(e){return+e.toFixed(2)}},{key:"hasHoles",value:function(){return null!=this._holes&&0<this._holes.length}},{key:"toStripHoles",value:function(e){for(var n=[],r=0;r<this._holes.length;r++){for(var i=this._holes[r],o=[],a=i.length,s=(a=i.splice(a-1,1)[0],this.mergePnts(i)),u=s.length,l=0;l<u;l++){var c=s[l];o.push(c.x,c.y)}!0===e||(t={x:this.toFixed(a.x),y:this.toFixed(a.y)},o.push(t.x,t.y)),n.push(o)}return n}},{key:"holes",get:function(){return this._holes},set:function(e){this._holes=e}},{key:"points",get:function(){return this._points},set:function(e){this._points=e}}]),e}(),n.default=r},function(e,t,n){"use strict";n(13),n(14),n(8);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(63));n(9),n(59);var h=l(n(48)),f=l(n(2)),d=l(n(3)),p=l(n(5)),g=l(n(6)),m=l(n(7)),v=(u=l(n(10)),n(117)),y=(l(n(398)),l(n(50))),_=l(n(49));function x(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=A(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function A(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,m.default)(e);return i=t?(n=(0,m.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,g.default)(this,i)}}u=function(e){(0,p.default)(n,e);var t=w(n);function n(e,r,i){return(0,f.default)(this,n),(e=t.call(this,e))._layers={},e.initLayers(),e.initLayersByData(r),e._visible=!0,e._groupMessage=i,e._locations=[],e._height=i.height,e._locationScene=new fm.Scene,e._locationScene.userData.type="location",e._locationScene.position.setY(e._height),e._locationScene.updateMatrix(),e._locationScene.updateWorldMatrix(),e._offsetHeight=0,e._lineScene=new fm.Scene,e._lineScene.userData.type="line",e.externalModels={},e.isGroup=!0,e.alwaysShowMarkers=[],e._groupAlias=i.alias,e._groupDesc=i.desc,e._groupName=i.gname,e._hideWithFree=!1,e.modelShadow={},e._group=new fm.Scene,e._mainLight=null,e.initScene(),e}return(0,d.default)(n,[{key:"initScene",value:function(){this._layers.extent[0]&&this._group.add(this._layers.extent[0]._scene),this._layers.model[0]&&this._group.add(this._layers.model[0]._scene)}},{key:"getHeight",value:function(){return this.height+this._offsetHeight}},{key:"getOrCreateLayer",value:function(e){return this._layers[e][0]||((t=new(t=v.AliasLayerMap.get(e))).scene.position.setY(this._height),t.scene.updateMatrix(),t.scene.updateWorldMatrix(),t.parent=this,t._scene.visible=!0,this._layers[e].push(t),this.parent.parent.map.setRenderList()),this._layers[e][0];var t}},{key:"getLayers",value:function(e){var t=[];return e=this._layers[e],t.push.apply(t,(0,h.default)(e)),t}},{key:"getDynmodel",value:function(e){for(var t=this._layers.dynmodel,n=0;n<t.length;n++){var r=t[n].scene;r&&e(r)}}},{key:"everyLayers",value:function(e,t){if(this._layers)for(var n in this._layers)if(!(-1<e.indexOf(n)))for(var r=this._layers[n],i=0;i<r.length;i++){var o=r[i].scene;o&&t(o)}}},{key:"getNodeByLayerId",value:function(e,t){if(this._layers)return this._layers[e][0]?this._layers[e][0].getNodeById(t):void 0}},{key:"bcross",value:function(e,t){var n=e.renderNode.boundingBox.min,r=e.renderNode.boundingBox.max;return e=t.renderNode.boundingBox.min,t=t.renderNode.boundingBox.max,y.default.isRectCross(new vector2(n.x,n.z),new vector2(r.x,r.z),new vector2(e.x,e.z),new vector2(t.x,t.z))}},{key:"mergeModels",value:function(e){var t,n=this._layers.model[0],r=[];for(t in n._models)n._models[t].FID in e&&r.push(n._models[t]);var i,o=x(this.checkModelsNearly(r).l);try{for(o.s();!(i=o.n()).done;){var a=i.value;n.removeNode(a)}}catch(e){o.e(e)}finally{o.f()}}},{key:"mergeModel",value:function(e,t){var n=new ThreeBSP(e.renderNode.geometry);return t=new ThreeBSP(t.renderNode.geometry),t=(t=n.union(t.tree)).toMesh(e.material),e._renderNode=t}},{key:"couldMerge",value:function(e,t){return e=new ThreeBSP(e.renderNode.geometry),t=new ThreeBSP(t.renderNode.geometry),0<(t=e.intersect(t.tree)).tree.polygons.length}},{key:"checkModelsNearly",value:function(e){for(var t=[],n=0;n<e.length;n++){for(var r=0,i=0;i<e.length;i++)this.bcross(e[n],e[i])&&r++;r||t.push(n)}for(var o=t.length-1;-1<o;o--){var a=e.indexOf(e[t[o]]);-1<a&&e.splice(a,1)}for(var s=0,u=1,l=[],c=[];0<e.length;)if(this.couldMerge(e[s],e[u])){var h=this.mergeM(e[s],e[u]);c.push(e[u]),e.splice(u,1),e.splice(s,1),e.push(h),s=0,u=1}else{if(u!==e.length-1)return u++,{e:l,l:c};h=e.splice(s,1),l.push(h),s=0,u=1}}},{key:"traverse",value:function(e){if(this._layers)for(var t in this._layers)for(var n=this._layers[t],r=0;r<n.length;r++)e(n[r])}},{key:"traverseByAlias",value:function(e,t,n){var r=this;if(this._layers)for(var i=function(i){var o=e[i],a=r._layers[o];if(a)for(var s=0;s<a.length;s++)n?t(a[s],o):a[s].traverse((function(e){t(e,o)}))},o=0;o<e.length;o++)i(o)}},{key:"setExtentImage",value:function(e){var t,n=this.parent.parent.materialManager.loadTexture(e,(function(){})),r=x(e=this.getLayers("extent"));try{for(r.s();!(t=r.n()).done;){var i,o=t.value;for(i in o.extents){var a=o.extents[i];a.renderNode.material.map&&a.renderNode.material.map.dispose(),a.renderNode.material.map=n,a.renderNode.material.needsUpdate=!0}}}catch(e){r.e(e)}finally{r.f()}}},{key:"clearExtentImage",value:function(){var e,t=x(this.getLayers("extent"));try{for(t.s();!(e=t.n()).done;){var n,r=e.value;for(n in r.extents){var i=r.extents[n];i.renderNode.material.map.dispose(),i.renderNode.material.map=null,i.renderNode.material.needsUpdate=!0}}}catch(e){t.e(e)}finally{t.f()}}},{key:"_getLayers",value:function(e){if(this._layers){var t,n={};for(t in this._layers){for(var r=this._layers[t],i=[],o=0;o<r.length;o++){e&&r[o].checkSceneNode();var a=r[o].scene;r[o].visible&&a&&i.push(a)}n[t]=i}return n}}},{key:"initLayers",value:function(){var e,t=x(v.LayerAlias);try{for(t.s();!(e=t.n()).done;){var n=e.value;this._layers[n]=[]}}catch(e){t.e(e)}finally{t.f()}}},{key:"initLayersByData",value:function(e){var t,n=e.geo[0],r=e.biz[0],i=x(e=(0,c.default)(n));try{for(i.s();!(t=i.n()).done;){var o,a=t.value;n[a]&&0<n[a].length&&v.Prop2Alias[a]&&((o=new(v.AliasLayerMap.get(v.Prop2Alias[a]))(n[a],r[a])).scene.position.setY(this._height),o.scene.updateMatrix(),o.scene.updateWorldMatrix(),o.parent=this,this._layers[v.Prop2Alias[a]].push(o))}}catch(e){i.e(e)}finally{i.f()}}},{key:"removeAlwaysShowMarker",value:function(e){-1<(e=this.alwaysShowMarkers.indexOf(e))&&this.alwaysShowMarkers.splice(e,1)}},{key:"dispose",value:function(){for(var e in this.alwaysShowMarkers.length=0,this.layers){for(var t=this.layers[e],n=0;n<t.length;n++)t[n].dispose(),t[n].parent=void 0;t.length=0,this._layers[e]=void 0}for(var r=this._locationScene.children.length-1;-1<r;r--)this._locationScene.remove(this._locationScene.children[r]);var i,o=x(this._locations);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.parent=void 0,a.dispose()}}catch(e){o.e(e)}finally{o.f()}this._groupMessage=void 0,this._layers=void 0}},{key:"addLayer",value:function(e){e.parent=this,e.scene.position.setY(this._height),e.scene.updateMatrix(),e.scene.updateWorldMatrix(),this._layers[e.alias].push(e),this.parent.parent.map.setRenderList(),(e.prepareInited||0<e.prepareInitObjects.length)&&e.initPrepare()}},{key:"removeLayer",value:function(e){e.removeAll&&e.removeAll(),e.parent=void 0;var t=this._layers[e.alias].indexOf(e);-1<t&&this._layers[e.alias].splice(t,1),this.parent.parent.map.setRenderList()}},{key:"getLayer",value:function(e){var t=this._layers[e];return 1<t.length?((e=[]).push.apply(e,(0,h.default)(t)),e):t[0]}},{key:"getFirstLayer",value:function(e){return this._layers[layer.alias][0]}},{key:"addLocation",value:function(e){e.parent=this,this._locations.push(e),this._locationScene.add(e.renderNode)}},{key:"removeLocation",value:function(e){var t=this._locations.indexOf(e);e.isAlwaysShow&&this.removeAlwaysShowMarker(e),e.parent=void 0,-1<t&&this._locations.splice(t,1),this._locationScene.remove(e.renderNode)}},{key:"getCenterPosition",value:function(){return new fm.Vector3(this.parent.center.x,this.parent.center.y+this._height,0)}},{key:"getModelMeshs",value:function(){var e,t=[],n=x(this._layers.model);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,h.default)(r.getAllMesh()))}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"getExtentMeshs",value:function(){var e,t=[],n=x(this._layers.extent);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,h.default)(r.getAllMesh()))}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"applyHeatMap",value:function(e){e&&(e.renderToMap(this._groupId),this.heatmap_=e)}},{key:"removeHeatMap",value:function(e){e.disposeHeatMap(this._groupId),this.heatmap_=null}},{key:"addLine",value:function(e){this._lineScene.add(e)}},{key:"removeLine",value:function(e){this._lineScene.remove(e)}},{key:"locationScene",get:function(){return this._locationScene}},{key:"lineScene",get:function(){return this._lineScene}},{key:"groupAlias",get:function(){return this._groupAlias}},{key:"groupDesc",get:function(){return this._groupDesc}},{key:"groupName",get:function(){return this._groupName}},{key:"groupHeight",get:function(){return this._groupHeight}},{key:"height",get:function(){return this._height},set:function(e){this._height=e,this.traverse((function(t){t.scene.position.setY(e),t.scene.updateMatrix(),t.scene.updateWorldMatrix()})),this._locationScene.position.setY(e),this._locationScene.updateMatrix(),this._locationScene.updateWorldMatrix()}},{key:"layers",get:function(){return this._layers}},{key:"visible",get:function(){return this._visible},set:function(e){this._hideWithFree&&(e||this.traverseByAlias(["extent","label","facility","model"],(function(e){e.releaseGpuMemory()}))),this._visible=e}},{key:"offsetHeight",get:function(){return this._offsetHeight},set:function(e){this._offsetHeight=e}},{key:"hideWithFree",set:function(e){this._hideWithFree=e}},{key:"mapCoord",get:function(){return(new fm.Vector2).copy(this.parent.mapcenter)}},{key:"mapCoordRange",get:function(){for(var e=[{x:Number.MAX_VALUE,y:Number.MAX_VALUE},{x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}],t=this._layers.extent,n=0;n<t.length;n++){var r,i=t[n]._extents;for(r in i)for(var o=i[r],a=o.gdata.geo,s=(null!==a?_.default.convertGeo2Geometry(a):_.default.convertArray2Geometry(o.gdata.idxs,o.gdata.pts)).vertices,u=0;u<s.length;u++)u%2==0?(s[u]<e[0].x&&(e[0].x=s[u]),s[u]>e[1].x&&(e[1].x=s[u])):(s[u]<e[0].y&&(e[0].y=s[u]),s[u]>e[1].y&&(e[1].y=s[u]))}return e}}]),n}(u.default),t.default=u},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(8),n(9);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(i=o(n(10)),o(n(387)));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}i=function(e){(0,u.default)(n,e);var t=f(n);function n(e,r){var i;return(0,a.default)(this,n),(i=t.call(this,"extentLayer"))._scene=new fm.Scene,i._scene.name="extent",i._scene.userData.type="extent",i._extents={},i.initNode(e,r),i._visible=!0,i.initLight(),i.putLight(),i}return(0,s.default)(n,[{key:"initLight",value:function(){this._ambientLight=new fm.AmbientLight(7631988),this._target=new fm.Object3D,this._mainLight=new fm.DirectionalLight(8947848,1.2),this._mainLight.position.set(-1,1,1).normalize(),this._mainLight.castShadow=!1,this._mainLight.target=this._target,this._secondLight=new fm.DirectionalLight(3355443),this._secondLight.position.set(-.5,1,-1).normalize(),this._secondLight.target=this._target}},{key:"initNode",value:function(e,t){for(var n=0;n<e.length;n++)this.createNode(e[n],t[n])}},{key:"createNode",value:function(e,t){(t=new h.default(e,t)).parent=this,this._extents[""+t.eid]=t}},{key:"addNodes",value:function(e){e.parent=this,e.renderNode&&this._scene.add(e.renderNode),this._extents[""+e.eid]=e}},{key:"putLight",value:function(){var e=this;this.scene.add(this._mainLight),this.scene.add(this._ambientLight),this.scene.add(this._secondLight),this.scene.add(this._target),this.scene.removeLight=function(){e.removeLight()}}},{key:"removeLight",value:function(){this.scene.remove(this._mainLight),this.scene.remove(this._ambientLight),this.scene.remove(this._secondLight)}},{key:"disposeLight",value:function(){this._mainLight=void 0,this._ambientLight=void 0,this._secondLight=void 0}},{key:"getNodeById",value:function(e){return this._extents[""+e]}},{key:"traverse",value:function(e){for(var t in this._extents)e&&e(this._extents[t])}},{key:"getVideoMemoryAmount",value:function(){var e=null;return this.traverse((function(t){t._renderNode&&t._renderNode.geometry&&t._renderNode.geometry._bufferGeometry&&(e+=t._renderNode.geometry._bufferGeometry.attributes.position.array.byteLength,e+=t._renderNode.geometry._bufferGeometry.attributes.color.array.byteLength,e+=t._renderNode.geometry._bufferGeometry.attributes.normal.array.byteLength,e+=t._renderNode.geometry._bufferGeometry.attributes.uv.array.byteLength)})),e}},{key:"checkSceneNode",value:function(){for(var e in this._scene.children.length=0,this._extents)this._extents[e].visible&&this._extents[e].renderNode&&this._scene.add(this._extents[e].renderNode);this.putLight()}},{key:"getAllMesh",value:function(){var e,t=[];for(e in this._extents)this._extents[e].renderNode&&t.push(this._extents[e].renderNode);return t}},{key:"dispose",value:function(){for(var e in this._extents)this._extents[e].dispose(),this._scene.remove(this._extents[e].renderNode),this._extents[e].parent=void 0,this._extents[e]=void 0;this.removeLight(),this.disposeLight(),this._scene.length=0,this._scene=void 0}},{key:"extents",get:function(){return this._extents},set:function(e){this._extents=e}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.parent&&this.parent.parent&&this.parent.parent.parent&&this.parent.parent.parent.map.setRenderList()}},{key:"show",get:function(){return this.visible},set:function(e){this.visible=e}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";n(13),n(14);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(11)),h=l(n(35));n(8),n(21),n(9);var f=l(n(2)),d=l(n(3)),p=l(n(5)),g=l(n(6)),m=l(n(7)),v=(u=l(n(10)),l(n(28))),y=l(n(65));function _(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=x(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function x(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,m.default)(e);return i=t?(n=(0,m.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,g.default)(this,i)}}u=function(e){(0,p.default)(n,e);var t=I(n);function n(e,r){var i;return(0,f.default)(this,n),(i=t.call(this,r.eid,v.default.EXTERANL_MODEL))._parseData=null,i._isInitMesh=!0,i._visible=!0,i._renderNode=null,i._geometry=void 0,i._line=null,i._bdata=r,i._selected=!1,i._preColor=null,i._preOpacity=null,i.name=r.name,i.FID=r.fid,i.ID=r.eid,i.typeID=r.type,i.gdata=e,i}return(0,d.default)(n,[{key:"initMesh",value:function(e,t){this._geometry&&(this._renderNode=new fm.Mesh(this._geometry.geometry,e),this._renderNode.mapNode=this,this._renderNode.scale.set(-1,1,1),this._renderNode.rotation.set(Math.PI/2,0,0,"XYZ"),this._renderNode.position.copy(t),this._renderNode.parent=this.parent.scene,this._renderNode.visible=this.show)}},{key:"setByTheme",value:function(e){var t=this._renderNode.material,n=this._renderNode;if((0,c.default)(t)){var r,i=_(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.color=new fm.Color(y.default.toColor(e.color)),o.userData.opacity=t.opacity}}catch(e){i.e(e)}finally{i.f()}}else t.color=new fm.Color(y.default.toColor(e.color)),t.userData.opacity=t.opacity;var a=e.scale.split(","),s=e.rotate.split(",");e.translate.split(","),n.scale.set((0,h.default)(a[0]),(0,h.default)(a[1]),(0,h.default)(a[2])),n.rotation.set((0,h.default)(s[0])*fm.Math.DEG2RAD,(0,h.default)(s[2])*fm.Math.DEG2RAD,(0,h.default)(s[1])*fm.Math.DEG2RAD)}},{key:"checkByFrustum",value:function(e){this._renderNode&&("Mesh"===this._renderNode.type||"Scene"===this._renderNode.type&&this._renderNode.traverse((function(e){fm.Mesh})),this._renderNode.updateMatrixWorld(!0),this.visible=!0)}},{key:"setColor",value:function(e,t){var n=this;this._renderNode.traverse((function(r){if(r instanceof fm.Mesh)if(void 0!==r.material.length)for(var i=0;i<r.material.length;i++)r.material[i].defaultcolorinfo||(r.material[i].defaultcolorinfo={color:r.material[i].color,opacity:r.material[i].opacity}),n._preColor=r.material[i].color,r.material[i].color=new fm.Color(y.default.toRgba(e)),n._preOpacity=r.material[i].opacity,"number"==typeof t&&(r.material[i].opacity=t),r.material[i].needsUpdate=!0;else r.material.defaultcolorinfo||(r.material.defaultcolorinfo={color:r.material.color,opacity:r.material.opacity}),n._preColor=r.material.color,r.material.color=new fm.Color(y.default.toRgba(e)),n._preOpacity=r.material.opacity,"number"==typeof t&&(r.material.opacity=t),r.material.needsUpdate=!0}))}},{key:"setColorToDefault",value:function(){this._renderNode.traverse((function(e){if(e instanceof fm.Mesh)if(void 0!==e.material.length)for(var t=0;t<e.material.length;t++)e.material[t].defaultcolorinfo&&(e.material[t].color=e.material[t].defaultcolorinfo.color,e.material[t].opacity=e.material[t].defaultcolorinfo.opacity,e.material[t].needsUpdate=!0);else e.material.color=e.material.defaultcolorinfo.color,e.material.opacity=e.material.defaultcolorinfo.opacity,e.material.needsUpdate=!0}))}},{key:"gradientColor",value:function(){var e,t,n=this;this._renderNode&&(this._renderNode.material.userData.color=this._renderNode.material.color,t=this.findParent(NodeManager),t=(e=t.map).modelSelectColor,animater=new Animater({r:t.r/2,g:t.g/2,b:t.b/2,a:t.a/2},t,500,(function(){e.removeAnimater(animater),animater=void 0}),(function(e){n._renderNode.material.color=new fm.Color(e.r,e.g,e.b),n._renderNode.material.alpha=e.a,n._renderNode.material.update=!0})).start(),e.addAnimater(animater))}},{key:"clearGradient",value:function(){var e;this._renderNode&&(e=(e=this.findParent(NodeManager)).map,animater&&e.removeAnimater(animater),this._renderNode.material.color=this._renderNode.material.userData.color,this._renderNode.material.userData.color=void 0)}},{key:"dispose",value:function(){if(this._renderNode&&"Mesh"===this._renderNode.type){for(var e in this._renderNode.material.uniforms)e.value instanceof fm.Texture&&e.value.dispose();if((0,c.default)(this._renderNode.material)){var t,n=_(this._renderNode.material);try{for(n.s();!(t=n.n()).done;)t.value.dispose()}catch(e){n.e(e)}finally{n.f()}}else this._renderNode.material.dispose();this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.geometry=void 0,this._geometry=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0}}},{key:"visible",get:function(){return this._visible},set:function(e){e?this.parent.scene.children.indexOf(this._renderNode)<0&&this._renderNode&&this.parent.scene.add(this._renderNode):(this._renderNode&&this.parent.scene.remove(this._renderNode),this._renderNode.parent=this.parent.scene),this._visible=e}},{key:"renderNode",get:function(){return this._renderNode},set:function(e){this.parent&&(this._renderNode=e,this._renderNode.mapNode=this,this.parent.scene.children.indexOf(this._renderNode)<0&&this._renderNode&&this.parent.scene.add(this._renderNode))}},{key:"bdata",get:function(){return this._bdata},set:function(e){this._bdata=e}}]),n}(u.default),t.default=u},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(25)),s=o(n(19)),u=o(n(390));n(8),n(21),n(9);var l,c,h=o(n(2)),f=o(n(3)),d=o(n(5)),p=o(n(6)),g=o(n(7)),m=(i=o(n(10)),o(n(28))),v=o(n(27)),y=o(n(66)),_=o(n(49)),x=o(n(50));function A(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,g.default)(e);return i=t?(n=(0,g.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,p.default)(this,i)}}i=function(e){(0,d.default)(n,e);var t=A(n);function n(e,r){var i;return(0,h.default)(this,n),(i=t.call(this,r.eid,m.default.MODEL))._parseData=null,i._isInitMesh=!0,i._visible=!0,i._renderNode=null,i._data=null,i._geometry,i._shape,i.currHeight=2,i._line=null,i._modelColor=null,i._modeAlpha=1,i._lineColor=null,i._lineAlpha=1,i._selected=!1,i._sgstat=!1,i._flashColor=null,i._card={top:null,left:null,right:null,front:null,back:null},i.precolor={useModel:!1,useStroke:!1,mcolor:null,strokeColor:null,malpha:1,strokeAlpha:1},i.FID=r.fid,i.ID=r.eid,i.ename=r.ename,i.name=r.name,i.typeID=r.type,i.minlevel=r.minlevel,i.maxlevel=r.maxlevel,i.bdata=r,i.gdata=e,i.preSelect=!1,i}return(0,f.default)(n,[{key:"initMesh",value:function(e,t,n){this._geometry&&(this._renderNode=new fm.Mesh(this._geometry.geometry,e),this._renderNode.mapNode=this,this._modelColor=e.color,this._modelAlpha=e.opacity,this._renderNode.scale.set(1,-1,1),this._renderNode.rotation.set(Math.PI/2,0,0,"XYZ"),this._renderNode.position.copy(t),this._renderNode.frustumCulled=!1,this._renderNode.parent=this.parent.scene,this._renderNode.castShadow=!0,this._renderNode.name="oneModel",n&&(this._renderNode.material.uniforms={maxPos:{value:10},minPos:{value:0},relativeModelMatrix:{value:this._renderNode.matrixWorld}}),this.renderNodeInited=!0,this.precolor.useModel&&(this.precolor.mcolor&&(e.color=this.precolor.mcolor),"number"==typeof this.precolor.malpha&&(e.opacity=this.precolor.malpha)),this.preSelect&&(this.selected=!0,this.preSelect=!1))}},{key:"releaseGpuMemory",value:function(){this.renderNode&&(this._geometry=null,this._data=null,this.renderNodeInited=!1,this.renderNode.parent.remove(this.renderNode),this.dispose())}},{key:"restoreGpuMemeory",value:function(){}},{key:"getBbox",value:function(){}},{key:"getRadius1",value:function(){return this._renderNode.geometry.boundingSphere.radius}},{key:"getRadius",value:function(){for(var e={x:this._renderNode._x-this.parent.parent.parent.mapcenter.x,y:this._renderNode._y-this.parent.parent.parent.mapcenter.y},t=[],n=this._renderNode.geometry.vertices,r=0;r<n.length;r++){var i,o={};o.vertex=n[r],o.distance=Math.abs(Math.sqrt(Math.pow(n[r].x-e.x,2)+Math.pow(n[r].y-e.y,2))),t.length<2?t.push(o):2===t.length?t[0].distance>t[1].distance&&(i=null,i=t.shift(),t.push(i)):o.distance<t[1].distance&&(o.distance<t[0].distance?(i=null,t.pop(),i=t.shift(),t.push(o),t.push(i)):(t.pop(),t.push(o)))}var a={x:(t[0].vertex.x+t[1].vertex.x)/2,y:(t[0].vertex.y+t[1].vertex.y)/2};return a=Math.abs(Math.sqrt(Math.pow(a.x-e.x,2)+Math.pow(a.y-e.y,2))),t[0].distance<a?t[0].distance:a}},{key:"setByTheme",value:function(e){var t,n,r;this._renderNode&&(n=(t=this.findParent(v.default)).materialManager.createNormalMaterial(e),r=t.materialManager.createLineMaterial(e),this._lineColor=r.color,this._lineAlpha=r.opacity,this._modelColor=n.color,this._modeAlpha=n.opacity,this._renderNode.material.dispose(),this._renderNode.material=n,this._line&&(this._line.material=r),this._geometry=null,this._card.top&&this.removeStoreImage(),e.image&&e.sizes&&(n=e.sizes.split(","),r=[],e.coords&&(r=e.coords.split(",")),this.addStoreImage({image:e.image?t._map.MapOptions.mapThemeURL+"/"+t._map.MapOptions.defaultThemeName+"/"+e.image:"",angle:e.angle||0,size:[(0,a.default)(n[0]),(0,a.default)(n[1])],mapCoord:e.coords?new fm.Vector2((0,a.default)(r[0]),(0,a.default)(r[1])):void 0})))}},{key:"initLine",value:function(e,t){if(this._geometry){var n=(new fm.Geometry).setFromPoints(this._geometry.shape.getPoints());n&&0<n.vertices.length&&n.vertices.push(n.vertices[0]);for(var r=[],i=n.vertices.length,o=0;o<i;o++)0==o||o==i-1?r.push(n.vertices[o]):r.push(n.vertices[o],n.vertices[o]);n.vertices=r;var a=new fm.LineSegments(n,e);if(this._lineColor=e.color,this._lineAlpha=e.opacity,a.castShadow=!1,a.position.setZ(.005*-t),a.geometry.computeBoundingSphere(),this.precolor.useStroke&&(e.color=this.precolor.strokeColor,e.opacity=this.precolor.strokeAlpha),this._geometry.shape.holes)for(var s=0;s<this._geometry.shape.holes.length;s++)u(a,this._geometry.shape.holes[s].curves);this._line=a,this._line.frustumCulled=!1,this._line.matrixAutoUpdate=!1,this._renderNode.add(a),this._shape=this._geometry.shape,this._geometry=null}function u(t,n){for(var r=0;r<n.length;r++){var i=[];i.push(new fm.Vector3(n[r].v1.x,n[r].v1.y,0)),i.push(new fm.Vector3(n[r].v2.x,n[r].v2.y,0)),i=(new fm.BufferGeometry).setFromPoints(i),i=new fm.LineSegments(i,e),t.add(i)}}}},{key:"setHeight",value:function(e){this.currHeight&&(this._renderNode.scale.z*=e/this.currHeight,this._renderNode.position.y+=e-this.currHeight),this.currHeight=e}},{key:"checkByFrustum",value:function(e){var t=!0;this._renderNode&&(this._renderNode.updateMatrixWorld(!0),t=e.intersectsObject(this._renderNode)),this.visible=t}},{key:"setColor",value:function(e,t){if(!this._renderNode)return this.precolor.mcolor=e&&new fm.Color(e),this.precolor.malpha=t,void(this.precolor.useModel=!0);e&&(this._renderNode.material.color=new fm.Color(e)),"number"==typeof t&&(this._renderNode.material.opacity=t,t!==this._renderNode.material.userData.opacity&&(this._renderNode.material.userData.opacity=t))}},{key:"setFlashColor",value:function(e){this._flashColor=new fm.Color(e)}},{key:"setStrokeColor",value:function(e,t){if(!this._renderNode)return this.precolor.strokeColor=new fm.Color(e),this.precolor.strokeAlpha=t,void(this.precolor.useStroke=!0);this._line.material.color=new fm.Color(e),this._line.material.opacity=t}},{key:"setColorToDefault",value:function(){this._renderNode&&(this._renderNode.material.color=this._modelColor,this._renderNode.material.opacity=this._modelAlpha,this._modelAlpha!==this._renderNode.material.userData.opacity&&(this._renderNode.material.userData.opacity=this._modelAlpha))}},{key:"setStrokeColorToDefault",value:function(){this._line.material.color=this._lineColor,this._line.material.opacity=this._lineAlpha}},{key:"addStoreImage",value:function(e){var t,n=this.findParent(v.default),r=this.parent.parent.parent,i=r.mapcenter,o=e.mapCoord||this.mapCoord;this._renderNode&&e.image&&(e=(0,s.default)({size:[5,5],height:.1,angle:0,offset:[0,0]},e),this._card.top&&this.removeStoreImage(),r=new fm.PlaneBufferGeometry(1,1,1,1),t=new fm.MeshLambertMaterial({transparent:!0,depthWrite:!1,visible:!1}),n.materialManager.loadTexture(e.image,(function(e){e.anisotropy=4,e.minFilter=fm.LinearFilter,t.map=e,t.needsUpdate=!0,t.visible=!0})),(r=new fm.Mesh(r,t)).scale.set(e.size[0],e.size[1],-1),r.position.set(e.offset[0]+o.x-i.x,e.offset[1]+o.y-i.y,-e.height),r.rotation.z=-e.angle*fm.Math.DEG2RAD,r.renderOrder=10,this._renderNode.add(r),this._card.top=r)}},{key:"getUvTransForm",value:function(){var e;((e=this.parent.parent.parent).center,e=e.bbox).max.x,e.min.x,e.max.y,e.min.y,this.renderNode}},{key:"removeStoreImage",value:function(){this._card.top&&(this._renderNode.remove(this._card.top),this._card.top.geometry.dispose(),this._card.top.material.map&&this._card.top.material.map.dispose(),this._card.top.material.dispose(),this._card.top=null)}},{key:"dispose",value:function(){this._renderNode&&(this._line&&(this._renderNode.remove(this._line),this._line.material.dispose(),this._line.geometry.dispose(),this._line=void 0),this.removeStoreImage(),this._renderNode.material.dispose(),this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.geometry=void 0,this._geometry=void 0,this._data=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0)}},{key:"flash",value:function(){var e,t,n,r=this;this._renderNode&&(this._renderNode.material.userData.color=this._renderNode.material.color,e=this.findParent(v.default).map,null,t=null===this._flashColor?e.modelSelectColor:this._flashColor,n={r:t.r/2,g:t.g/2,b:t.b/2,a:t.a/2},l=function(e){var t=(Math.sin((new Date).getTime()/180)+1)/2;r._renderNode.material.color=new fm.Color(n.r*(1+t),n.g*(1+t),n.b*(1+t))},e.on("frameLoop",l))}},{key:"stopFlash",value:function(){this._renderNode&&(this.findParent(v.default).map.off("frameLoop",l),this._renderNode.material.color=this._renderNode.material.userData.color)}},{key:"gradientColor",value:function(){var e,t,n=this;this._renderNode&&(this._renderNode.material.userData.color=this._renderNode.material.color,t=this.findParent(v.default),t=(e=t.map).modelSelectColor,c=new y.default({r:t.r/2,g:t.g/2,b:t.b/2,a:t.a/2},t,500,(function(){e.removeAnimater(c),c=void 0}),(function(e){n._renderNode.material.color=new fm.Color(e.r,e.g,e.b),n._renderNode.material.alpha=e.a,n._renderNode.material.update=!0})).start(),e.addAnimater(c))}},{key:"clearGradient",value:function(){var e;this._renderNode&&(e=(e=this.findParent(v.default)).map,c&&e.removeAnimater(c),this._renderNode.material.color=this._renderNode.material.userData.color,this._renderNode.material.userData.color=void 0)}},{key:"distanceToPoint",value:function(e){var t=this._shape.getPoints();if(x.default.isInPolygon(e,t))return 0;for(var n=u.default,r=0;r<t.length-1;r++){var i=x.default.pointDistanceToLine(e,t[r],t[r+1],new fm.Vector2);i<n&&(n=i)}return n}},{key:"selected",get:function(){return this._selected},set:function(e){e!==this._selected&&(this._selected=e,this.renderNodeInited?e?this.gradientColor():this.clearGradient():this.preSelect=!0)}},{key:"visible",get:function(){return this._visible},set:function(e){e?this.parent.scene.children.indexOf(this._renderNode)<0&&this._renderNode&&this.parent.scene.add(this._renderNode):this._renderNode&&(this.parent.scene.remove(this._renderNode),this._renderNode.parent=this.parent.scene),this._visible=e}},{key:"renderNode",get:function(){return this._renderNode},set:function(e){this._renderNode=e}},{key:"mapCoord",get:function(){var e=this.parent.parent.parent.parent.map.dataManager.file_ver,t=this.parent.parent.layers.label[0].labels[""+this._eid];if(t){if(t.renderNodeInited)return{x:t.x,y:t.y,z:this.height};var n;return{x:(n=1===e?_.default.convertGeo2Points(t.gdata.geo):_.default.convertArrayPoints(t.gdata.idxs,t.gdata.pts)).vertices[0].x,y:n.vertices[0].y,z:this.height}}return{x:null,y:null,z:null}}},{key:"label",get:function(){return this.parent.parent.layers.label[0].labels[""+this._eid]}},{key:"height",get:function(){return this.renderNodeInited?this._height:this.gdata.height},set:function(e){this._height=e}},{key:"line",get:function(){return this._line}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(8),n(9);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(i=o(n(10)),o(n(224)));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}i=function(e){(0,u.default)(n,e);var t=f(n);function n(e,r){var i;return(0,a.default)(this,n),(i=t.call(this))._scene=new fm.Scene,i._scene.userData.type="label",i._scene.name="label",i.alias="label",i._labels={},i.initNode(e,r),i.needAvoid=!0,i._visible=!0,i}return(0,s.default)(n,[{key:"traverse",value:function(e){for(var t in this._labels)e&&e(this._labels[t])}},{key:"getVideoMemoryAmount",value:function(){var e=null;return this.traverse((function(t){var n;t._renderNode&&(e+=t._renderNode.geometry.attributes.position.array.byteLength,e+=t._renderNode.geometry.attributes.uv.array.byteLength,t._renderNode.material.map&&(n=t._renderNode.material.map.image.width*t._renderNode.material.map.image.height*32/8,e+=n))})),e}},{key:"initNode",value:function(e,t){for(var n=0;n<e.length;n++)this.createNode(e[n],t[n])}},{key:"createNode",value:function(e,t){(t=new h.default(e,t)).parent=this,this._labels[""+t.eid]=t}},{key:"addNodes",value:function(e){e.parent=this,e.renderNode&&this._scene.add(e.renderNode),this._labels[""+e.eid]=e}},{key:"allShow",value:function(){for(var e=0;e<this._scene.children.length;e++)this._scene.children[e].visible=!0}},{key:"getNodeById",value:function(e){return this._labels[""+e]}},{key:"checkSceneNode",value:function(){for(var e in this._scene.children.length=0,this._labels)this._labels[e].visible&&this._labels[e].renderNode&&this._scene.add(this._labels[e].renderNode)}},{key:"dispose",value:function(){for(var e in this._labels)this._labels[e].dispose(),this._scene.remove(this._labels[e].renderNode),this._labels[e].parent=void 0,this._labels[e]=void 0;this._scene=void 0}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.parent&&this.parent.parent&&this.parent.parent.parent&&this.parent.parent.parent.map.rushRenderNode()}},{key:"show",get:function(){return this.visible},set:function(e){this.visible=e}},{key:"labels",get:function(){return this._labels}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(8),n(9),n(64);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(i=o(n(10)),o(n(28))),f=o(n(27)),d=o(n(118)),p=o(n(86)),g=o(n(49));function m(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}i=function(e){(0,u.default)(n,e);var t=m(n);function n(e,r){var i;return(0,a.default)(this,n),(i=t.call(this,r.eid,h.default.LABEL))._isInitSprite=!0,i._visible=!0,i._renderNode=null,i._geometry=void 0,i._size=20,i._theme=void 0,i.bdata=r,i.ename=r.ename,i._text=r.name,i.gdata=e,i.FID=r.fid,i.ID=r.eid,i.name=r.name,i.typeID=r.type,i.minlevel=r.minlevel,i.maxlevel=r.maxlevel,i}return(0,s.default)(n,[{key:"checkByFrustum",value:function(e){var t=!0;this._renderNode&&(this._renderNode.updateMatrixWorld(!0),t=e.intersectsSprite(this._renderNode)),this.visible=t}},{key:"initSprite",value:function(e,t){e&&(this._renderNode=new d.default(e),this._renderNode.position.copy(t),this._renderNode.mapNode=this,this._renderNode.frustumCulled=!0,this.renderNodeInited=!0,this._renderNode.parent=this.parent.scene,this._renderNode.visible=this.show,this._renderNode.name="spirit")}},{key:"setText",value:function(e){var t;this._renderNode&&this._theme&&(t=this.findParent(f.default),this._renderNode.material.map&&this._renderNode.material.map.dispose(),this._renderNode.material&&this._renderNode.material.dispose(),this._renderNode.material=t.materialManager.createLabelMaterial(e,this._theme),this._text=e,this.setSize())}},{key:"releaseGpuMemory",value:function(){this.renderNode&&(this.renderNodeInited=!1,this._isInitSprite=!1,this.tryInit=!1,this.renderNode.parent.remove(this.renderNode),this.dispose())}},{key:"setByLanguage",value:function(e){var t,n=e===p.default.EN?this.bdata.ename:this.bdata.name;if(!n)return this.visible=!1,void this.dispose();this._renderNode?this.setText(n):this.tryInit&&!this.renderNodeInited&&(t=this.findParent(f.default),e=this.parent.parent.parent.theme.getLabelTheme(this.bdata),this._theme=e,e=t.materialManager.createLabelMaterial(n,e),this.initSprite(e,this.pos),this.setSize()),this.visible=!0}},{key:"setByTheme",value:function(e){var t;this._text&&(t=this.findParent(f.default),this._theme=e,this._size=1.4*e.fontsize,this._renderNode.material.map&&this._renderNode.material.map.dispose(),this._renderNode.material&&this._renderNode.material.dispose(),this._renderNode&&(this._renderNode.material=t.materialManager.createLabelMaterial(this._text,this._theme)),this.setSize())}},{key:"setSize",value:function(){this.findParent(f.default).map.renderer.setLabelSize(this._renderNode,this._size)}},{key:"dispose",value:function(){this._renderNode&&(this._renderNode.material.dispose(),this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.geometry=void 0,this.geometry=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0,this.renderNodeInited=!1)}},{key:"mapCoord",get:function(){var e=this.parent.parent.parent.parent.map.dataManager.file_ver,t=this;if(t){if(t.renderNodeInited)return{x:t.x,y:t.y,z:this.height};var n;return{x:(n=1===e?g.default.convertGeo2Points(t.gdata.geo):g.default.convertArrayPoints(t.gdata.idxs,t.gdata.pts)).vertices[0].x,y:n.vertices[0].y,z:this.height}}return{x:null,y:null,z:null}}},{key:"model",get:function(){return this.parent.parent.layers.model[0].models[""+this._eid]}},{key:"visible",get:function(){return this._visible},set:function(e){this._renderNode&&(e?this.parent.scene.children.indexOf(this._renderNode)<0&&this._renderNode&&this.parent.scene.add(this._renderNode):(this.parent.scene.remove(this._renderNode),this._renderNode.parent=this.parent.scene)),this._visible=e}},{key:"renderNode",get:function(){return this._renderNode},set:function(e){this._renderNode=e}},{key:"size",get:function(){return this._size},set:function(e){this._size=e}},{key:"theme",set:function(e){this._theme=e}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(9);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(i=o(n(10)),o(n(226)));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}i=function(e){(0,u.default)(n,e);var t=f(n);function n(e,r){var i;return(0,a.default)(this,n),(i=t.call(this))._scene=new fm.Scene,i._scene.userData.type="facility",i.alias="facility",i._facility={},i.needAvoid=!0,i.initNode(e,r),i._visible=!0,i}return(0,s.default)(n,[{key:"initNode",value:function(e,t){if(e)for(var n=0;n<e.length;n++)this.createNode(e[n],t[n])}},{key:"createNode",value:function(e,t){(t=new h.default(e,t)).parent=this,this._facility[""+t.eid]=t}},{key:"addNodes",value:function(e){e.parent=this,e.renderNode&&this._scene.add(e.renderNode),this._facility[""+e.eid]=e}},{key:"traverse",value:function(e){for(var t in this._facility)e&&e(this._facility[t])}},{key:"getNodeById",value:function(e){return this._facility[""+e]}},{key:"getVideoMemoryAmount",value:function(){var e=null;return this.traverse((function(t){var n;t._renderNode&&(e+=t._renderNode.geometry.attributes.position.array.byteLength,e+=t._renderNode.geometry.attributes.uv.array.byteLength,t._renderNode.material.map&&(n=t._renderNode.material.map.image.width*t._renderNode.material.map.image.height*32/8,e+=n))})),e}},{key:"checkSceneNode",value:function(){for(var e in this._scene.children.length=0,this._facility)this._facility[e].visible&&this._facility[e].renderNode&&this._scene.add(this._facility[e].renderNode)}},{key:"dispose",value:function(){for(var e in this._facility)this._facility[e].dispose(),this._scene.remove(this._facility[e].renderNode),this._facility[e].parent=void 0,this._facility[e]=void 0;this._scene=void 0}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.parent&&this.parent.parent&&this.parent.parent.parent&&this.parent.parent.parent.map.setRenderList()}},{key:"show",get:function(){return this.visible},set:function(e){this.visible=e}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(19)),s=o(n(25));n(8),n(9);var u=o(n(2)),l=o(n(3)),c=o(n(5)),h=o(n(6)),f=o(n(7)),d=(i=o(n(10)),o(n(28))),p=o(n(27)),g=o(n(118)),m=o(n(49));function v(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,f.default)(e);return i=t?(n=(0,f.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,h.default)(this,i)}}i=function(e){(0,c.default)(n,e);var t=v(n);function n(e,r){var i;return(0,u.default)(this,n),(i=t.call(this,r.eid,d.default.FACILITY))._isInitSprite=!0,i._visible=!0,i._renderNode=null,i._geometry=void 0,i._size=20,i.bdata=r,i.gdata=e,i.FID=r.fid,i.ID=r.eid,i.ename=r.ename,i.name=r.name,i.typeID=r.type,i.minlevel=r.minlevel,i.maxlevel=r.maxlevel,i}return(0,l.default)(n,[{key:"checkByFrustum",value:function(e){var t=!0;this._renderNode&&(this._renderNode.updateMatrixWorld(!0),t=e.intersectsObject(this._renderNode)),this.visible=t}},{key:"jump",value:function(e){var t,n,r,i,o=this;this._renderNode&&!this._isJumping&&(this._isJumping=!0,"number"==typeof(t=(0,a.default)({height:8,times:0,duration:1,delay:0},e)).height&&"number"==typeof t.times&&"number"==typeof t.duration&&"number"==typeof t.delay&&(t.duration*=1e3,t.delay*=1e3,t.all=t.duration+t.delay,t.halfDuration=t.duration/2,n=t.height-this._height,this._origonY=this._renderNode.position.y,r=(new Date).getTime(),e=this.findParent(p.default),i=e.map,this.jumpEvent=function(e){var a;o._renderNode?(a=(new Date).getTime()-r,0!=t.times&&a/t.all>t.times?o.stopJump():(a%=t.all)>t.duration?o._renderNode.position.y!=o._origonY&&(o._renderNode.position.y=o._origonY):(a=1-(a=a/t.halfDuration-1)*a,o._renderNode.position.y=o._origonY+n*a)):i.off("frameLoop",o.jumpEvent)},i.on("frameLoop",this.jumpEvent)))}},{key:"stopJump",value:function(){this._renderNode&&this.jumpEvent&&(this._renderNode.position.y=this._origonY,this._isJumping=!1,this.findParent(p.default).map.off("frameLoop",this.jumpEvent))}},{key:"boost",value:function(e){var t,n,r,i=this;this._renderNode&&!this._isBoosting&&(this._isBoosting=!0,"number"==typeof(t=(0,a.default)({size:8,ratio:0,duration:1,delay:0},e)).size&&"number"==typeof t.ratio&&"number"==typeof t.duration&&"number"==typeof t.delay&&(t.duration*=1e3,t.delay*=1e3,t.all=t.duration+t.delay,t.halfDuration=t.duration/2,n=t.size-this._size,this._origonSize=this._size,e=this.findParent(p.default),r=e.map,this.boostEvent=function(e){var o;i._renderNode?(o=(new Date).getTime(),o=Math.sin(o*t.ratio)/2+.5,i._size=i._origonSize+o*n,i.setSize()):r.off("frameLoop",i.boostEvent)},r.on("frameLoop",this.boostEvent)))}},{key:"stopBoost",value:function(){this._renderNode&&this.boostEvent&&(this._size=this._origonSize,this._isBoosting=!1,this.findParent(p.default).map.off("frameLoop",this.boostEvent),this.setSize())}},{key:"initSprite",value:function(e,t){this._renderNode=new g.default(e),this._renderNode.mapNode=this,this._renderNode.frustumCulled=!1,this._renderNode.position.copy(t),this._renderNode.parent=this.parent.scene,this.renderNodeInited=!0,this._renderNode.visible=this.show,this._renderNode.name="spirit"}},{key:"releaseGpuMemory",value:function(){this.renderNode&&(this.renderNodeInited=!1,this.renderNode.parent.remove(this.renderNode),this.dispose())}},{key:"setByTheme",value:function(e){this._renderNode&&(e=this.findParent(p.default).materialManager.createPoiMaterial(e),this._renderNode.material.dispose(),this._renderNode.material=e)}},{key:"setSize",value:function(){this.findParent(p.default).map.renderer.setFacilitySize(this._renderNode,this._size)}},{key:"dispose",value:function(){this._renderNode&&(this._renderNode.material.dispose(),this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.geometry=void 0,this.geometry=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0)}},{key:"visible",get:function(){return this._visible},set:function(e){e?this.parent.scene.children.indexOf(this._renderNode)<0&&(this._renderNode&&this.parent.scene.add(this._renderNode),this.setSize()):(this._renderNode&&this.parent.scene.remove(this._renderNode),this._renderNode&&(this._renderNode.parent=this.parent.scene)),this._visible=e,this._visible=e}},{key:"renderNode",get:function(){return this._renderNode},set:function(e){this._renderNode=e}},{key:"size",get:function(){return this._size},set:function(e){this._size=(0,s.default)(e)}},{key:"mapCoord",get:function(){var e=this.parent.parent.parent.parent.map.dataManager.file_ver,t=this;if(t){if(t.renderNodeInited)return{x:t.x,y:t.y,z:this.height};var n;return{x:(n=1===e?m.default.convertGeo2Points(t.gdata.geo):m.default.convertArrayPoints(t.gdata.idxs,t.gdata.pts)).vertices[0].x,y:n.vertices[0].y,z:this.height}}return{x:null,y:null,z:null}}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";n(13),n(14),n(8);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0,n(9);var c=l(n(48)),h=l(n(2)),f=l(n(3)),d=l(n(5)),p=l(n(6)),g=l(n(7));function m(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=v(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function v(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(e){(0,d.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,g.default)(e);return i=t?(n=(0,g.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,p.default)(this,i)}}(n);function n(){var e;return(0,h.default)(this,n),(e=t.call(this))._scene=new fm.Scene,e._scene.userData.type="imageMarker",e.alias="imageMarker",e.imageMarkers=[],e._visible=!0,e.needAvoid=!0,e.prepareInitObjects=[],e}return(0,f.default)(n,[{key:"addMarker",value:function(e){e.parent=this,e.isInitSprite||e.initSprite()?this.pushImageMarker(e):this.prepareInitObjects.push(e),this.parent.parent.parent._map.avoidMarkers()}},{key:"initPrepare",value:function(){var e,t=m(this.prepareInitObjects);try{for(t.s();!(e=t.n()).done;){var n,r=e.value;r.initSprite()&&(-1<(n=this.prepareInitObjects.indexOf(r))&&this.prepareInitObjects.splice(n,1),this.pushImageMarker(r))}}catch(e){t.e(e)}finally{t.f()}}},{key:"pushImageMarker",value:function(e){this.imageMarkers.push(e),e.renderNode&&this._scene.add(e.renderNode)}},{key:"removeAll",value:function(){var e,t=m(this.imageMarkers);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.removeNode(n,!0)}}catch(e){t.e(e)}finally{t.f()}this.imageMarkers.length=0}},{key:"untiedMarker",value:function(e){e.parent=void 0,this._scene.remove(e.renderNode)}},{key:"removeNode",value:function(e,t){e.parent=void 0,this._scene.remove(e.renderNode),e.isAlwaysShow&&(this.parent.removeAlwaysShowMarker(e.renderNode),e.show=!1),e.dispose(),t||-1<(e=this.imageMarkers.indexOf(e))&&this.imageMarkers.splice(e,1)}},{key:"removeMarker",value:function(e){this.removeNode(e)}},{key:"checkSceneNode",value:function(){this._scene.children.length=0;var e,t=m(this.imageMarkers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.visible&&n.renderNode&&this._scene.add(n.renderNode)}}catch(e){t.e(e)}finally{t.f()}}},{key:"traverse",value:function(e){var t,n=m(this.imageMarkers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e&&e(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"dispose",value:function(){var e,t=m(this.imageMarkers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.dispose(),this._scene.remove(n.renderNode),n.parent=void 0}}catch(e){t.e(e)}finally{t.f()}this.imageMarkers.length=0,this._scene=void 0}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.parent&&this.parent.parent&&this.parent.parent.parent&&this.parent.parent.parent.map.setRenderList()}},{key:"show",get:function(){return this.visible},set:function(e){this.visible=e}},{key:"markers",get:function(){var e=[];return e.push.apply(e,(0,c.default)(this.imageMarkers)),e}}]),n}((n=l(n(10))).default),t.default=n},function(e,t,n){"use strict";n(13),n(14),n(8);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0,n(9);var c=l(n(2)),h=l(n(3)),f=l(n(5)),d=l(n(6)),p=l(n(7));function g(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=m(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function m(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(e){(0,f.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,p.default)(e);return i=t?(n=(0,p.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,d.default)(this,i)}}(n);function n(){var e;return(0,c.default)(this,n),(e=t.call(this))._scene=new fm.Scene,e._scene.userData.type="polygonMarker",e.alias="polygonMarker",e.polygonMarkers=[],e._visible=!0,e.prepareInitObjects=[],e}return(0,h.default)(n,[{key:"addMarker",value:function(e){e.parent=this,e.isInitPolygon||e.initPolygon()?this.pushPolygonMarker(e):this.prepareInitObjects.push(e)}},{key:"traverse",value:function(e){var t,n=g(this.polygonMarkers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e&&e(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"initPrepare",value:function(){var e,t=g(this.prepareInitObjects);try{for(t.s();!(e=t.n()).done;){var n,r=e.value;r.initPolygon()&&(-1<(n=this.prepareInitObjects.indexOf(r))&&this.prepareInitObjects.splice(n,1),this.pushPolygonMarker(r))}}catch(e){t.e(e)}finally{t.f()}}},{key:"pushPolygonMarker",value:function(e){this.polygonMarkers.push(e),e.renderNode&&this._scene.add(e.renderNode)}},{key:"removeAll",value:function(){var e,t=g(this.polygonMarkers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parent=void 0,this._scene.remove(n.renderNode),n.dispose()}}catch(e){t.e(e)}finally{t.f()}this.polygonMarkers.length=0}},{key:"removeNode",value:function(e){this.removeMarker(e)}},{key:"removeMarker",value:function(e){e.parent=void 0,this._scene.remove(e.renderNode),e.dispose(),-1<(e=this.polygonMarkers.indexOf(e))&&this.polygonMarkers.splice(e,1)}},{key:"checkSceneNode",value:function(){this._scene.children.length=0;var e,t=g(this.polygonMarkers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.visible&&n.renderNode&&this._scene.add(n.renderNode)}}catch(e){t.e(e)}finally{t.f()}}},{key:"markers",get:function(){return this.polygonMarkers}},{key:"dispose",value:function(){var e,t=g(this.polygonMarkers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.dispose(),this._scene.remove(n.renderNode),n.parent=void 0}}catch(e){t.e(e)}finally{t.f()}this.polygonMarkers.length=0,this._scene=void 0}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.parent&&this.parent.parent&&this.parent.parent.parent&&this.parent.parent.parent.map.setRenderList()}},{key:"show",get:function(){return this.visible},set:function(e){this.visible=e}}]),n}((n=l(n(10))).default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(5)),u=o(n(6)),l=o(n(7));n=function(e){(0,s.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this))._scene.userData.type="gradientPolygonMarker",e.alias="gradientPolygonMarker",e}return n}((n=o(n(230))).default),t.default=n},function(e,t,n){"use strict";n(13),n(14),n(8);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(2)),h=l(n(3)),f=l(n(5)),d=l(n(6)),p=l(n(7));function g(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=m(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function m(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(e){(0,f.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,p.default)(e);return i=t?(n=(0,p.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,d.default)(this,i)}}(n);function n(){var e;return(0,c.default)(this,n),(e=t.call(this))._markers=[],e.prepareInitMarkers=[],e}return(0,h.default)(n,[{key:"addMarker",value:function(e){e.parent=this,e.isInit||e.init()?this.pushMarker(e):this.prepareInitMarkers.push(e)}},{key:"traverse",value:function(e){var t,n=g(this._markers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e&&e(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"initPrepare",value:function(){var e,t=g(this.prepareInitMarkers);try{for(t.s();!(e=t.n()).done;){var n,r=e.value;r.init()&&(-1<(n=this.prepareInitMarkers.indexOf(r))&&this.prepareInitMarkers.splice(n,1),this.pushMarker(r))}}catch(e){t.e(e)}finally{t.f()}}},{key:"pushMarker",value:function(e){this._markers.push(e),e.renderNode&&this._scene.add(e.renderNode)}},{key:"removeAll",value:function(){var e,t=g(this._markers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parent=void 0,this._scene.remove(n.renderNode),n.dispose()}}catch(e){t.e(e)}finally{t.f()}this._markers.length=0}},{key:"removeNode",value:function(e){this.removeMarker(e)}},{key:"removeMarker",value:function(e){e.parent=void 0,this._scene.remove(e.renderNode),e.dispose(),-1<(e=this._markers.indexOf(e))&&this._markers.splice(e,1)}},{key:"checkSceneNode",value:function(){this._scene.children.length=0;var e,t=g(this._markers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.visible&&n.renderNode&&this._scene.add(n.renderNode)}}catch(e){t.e(e)}finally{t.f()}}},{key:"markers",get:function(){return this._markers}},{key:"dispose",value:function(){var e,t=g(this._markers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.dispose(),this._scene.remove(n.renderNode),n.parent=void 0}}catch(e){t.e(e)}finally{t.f()}this._markers.length=0,this._scene=void 0}}]),n}((n=l(n(393))).default),t.default=n},function(e,t,n){"use strict";n(13),n(14);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0,n(8),n(9);var c=l(n(2)),h=l(n(3)),f=l(n(5)),d=l(n(6)),p=l(n(7));function g(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=m(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function m(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(e){(0,f.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,p.default)(e);return i=t?(n=(0,p.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,d.default)(this,i)}}(n);function n(){var e;return(0,c.default)(this,n),(e=t.call(this))._scene=new fm.Scene,e._scene.userData.type="textMarker",e._scene.name="textMarker",e.alias="textMarker",e.textMarkers=[],e._visible=!0,e.prepareInitObjects=[],e}return(0,h.default)(n,[{key:"addMarker",value:function(e){e.parent=this,e.isInitSprite||e.initSprite()?this.pushImageMarker(e):this.prepareInitObjects.push(e)}},{key:"traverse",value:function(e){var t,n=g(this.textMarkers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e&&e(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"initPrepare",value:function(){var e,t=g(this.prepareInitObjects);try{for(t.s();!(e=t.n()).done;){var n,r=e.value;r.initSprite()&&(-1<(n=this.prepareInitObjects.indexOf(r))&&this.prepareInitObjects.splice(n,1),this.pushImageMarker(r))}}catch(e){t.e(e)}finally{t.f()}}},{key:"pushImageMarker",value:function(e){this.textMarkers.push(e),e.renderNode&&this._scene.add(e.renderNode)}},{key:"removeAll",value:function(){var e,t=g(this.textMarkers);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.removeNode(n,!0)}}catch(e){t.e(e)}finally{t.f()}this.textMarkers.length=0}},{key:"untiedMarker",value:function(e){e.parent=void 0,this._scene.remove(e.renderNode)}},{key:"removeNode",value:function(e,t){e.parent=void 0,this._scene.remove(e.renderNode),e.isAlwaysShow&&(this.parent.removeAlwaysShowMarker(e.renderNode),e.show=!1),e.dispose(),t||-1<(e=this.textMarkers.indexOf(e))&&this.textMarkers.splice(e,1)}},{key:"removeMarker",value:function(e){this.removeNode(e)}},{key:"checkSceneNode",value:function(){this._scene.children.length=0;var e,t=g(this.textMarkers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.visible&&n.renderNode&&this._scene.add(n.renderNode)}}catch(e){t.e(e)}finally{t.f()}}},{key:"dispose",value:function(){var e,t=g(this.textMarkers);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.dispose(),this._scene.remove(n.renderNode),n.parent=void 0}}catch(e){t.e(e)}finally{t.f()}this.textMarkers.length=0,this._scene=void 0}},{key:"markers",get:function(){return this.textMarkers}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.parent&&this.parent.parent&&this.parent.parent.parent&&this.parent.parent.parent.map.setRenderList()}},{key:"show",get:function(){return this.visible},set:function(e){this.visible=e}}]),n}((n=l(n(10))).default),t.default=n},function(e,t,n){"use strict";n(13),n(14),n(8);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0,n(9);var c=l(n(2)),h=l(n(3)),f=l(n(5)),d=l(n(6)),p=l(n(7)),g=(u=l(n(10)),l(n(27))),m=l(n(395));function v(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=y(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function y(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}u=function(e){(0,f.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,p.default)(e);return i=t?(n=(0,p.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,d.default)(this,i)}}(n);function n(e){var r;return(0,c.default)(this,n),(r=t.call(this))._scene=new fm.Scene,r._scene.userData.type="heatmap",r.alias="heatmap",r._prepareInited=!1,r._randomInited=!0,r._randomNum=0,r._gradient=null==e.gradient?{.45:"rgb(0,0,255)",.55:"rgb(0,255,255)",.65:"rgb(0,255,0)",.95:"yellow",1:"rgb(255,0,0)"}:e.gradient,r._points=null,r._opacity="number"==typeof e.opacity?e.opacity:.5,r._prepareInitObjects=[],r._visible=!0,r}return(0,h.default)(n,[{key:"init",value:function(){if((r=this.findParent(g.default))&&this._points){var e=this.parent.parent,t=this.parent.getHeight(),n=e.center,r=(r=r.materialManager).getHeatMapGradient(this._gradient),i=new m.default({},{},r);i.material.opacity=this._opacity;var o,a=v(this._points);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=i.clone();u.position.set(s.x,n.y+3+t,s.y-n.y),u.mapNode=this,this._scene.add(u)}}catch(r){a.e(r)}finally{a.f()}this._prepareInited=!1}else this._prepareInited=!0}},{key:"initPrepare",value:function(){this._randomInited||(this.randomPoints(this._randomNum,!0),this._randomInited=!0,this._randomNum=0),this._points,this.init()}},{key:"removeAll",value:function(){var e=this._scene;if(e){for(var t=e.children.length-1;-1<t;t--){var n=e.children[t];e.remove(n),n.mapNode=void 0,n.geometry.dispose(),n.material.dispose(),n.material.map.dispose()}e.children.length=0}this._points.length=0}},{key:"clearPoints",value:function(){this.removeAll()}},{key:"addPoints",value:function(e){this._points=e,this.init()}},{key:"randomPoints",value:function(e,t){if(!this.findParent(g.default))return this._prepareInited=!0,this._randomInited=!1,void(this._randomNum=e);for(var n=this.parent.parent.bbox,r=n.max.x-n.min.x,i=n.max.y-n.min.y,o=[],a=0;a<e;a++)o.push({x:Math.random()*r+n.min.x,y:Math.random()*i+n.min.y});this._points=o,t||this.init()}},{key:"dispose",value:function(){this.removeAll(),this._scene=void 0,this._gradient=void 0}},{key:"scene",get:function(){return this._scene}},{key:"prepareInited",get:function(){return this._prepareInited}},{key:"prepareInitObjects",get:function(){return this._prepareInitObjects}},{key:"visible",get:function(){return this._visible}}]),n}(u.default),t.default=u},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(32),n(151),n(61);var o=i(n(2)),a=i(n(3));i(n(216)),n=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,[{key:"createGeometry",value:function(e,t,n,r){for(var i=new Float32Array((t+1)*n*3),o=new Float32Array((t+1)*n*2),a=new Uint16Array(t*n*2*3),s=0;s<t+1;s++)for(var u=s/t*e,l=4/Math.sqrt(2*Math.PI)*Math.exp(-u*u/2/r)/Math.sqrt(r),c=0;c<n;c++){var h=c/n*Math.PI*2,f=u*Math.sin(h),d=u*Math.cos(h),p=s*n*3+3*c;i[p]=d,i[p+1]=l,i[p+2]=f;var g=s*n*2+2*c;o[g]=c/n,o[g+1]=s/t,s<t&&(h=void 0,d=void 0,p=void 0,f=void 0,p=(h=s*n+c)+n,f=(d=c+1===n?s*n:h+1)+n,a[g=s*n*6+6*c]=h,a[g+1]=d,a[g+2]=p,a[g+3]=d,a[g+4]=f,a[g+5]=p)}return{index:a,uv:o,vertice:i}}},{key:"computerArcLineByPoints",value:function(e,t,n,r,i){var o=(new fm.Vector3).copy(e).distanceTo(t),a=(new fm.Vector3).copy(n).distanceTo(t),s=(new fm.Vector3).copy(e),u=(new fm.Vector3).copy(e),l=[];r<o&&(s=(new fm.Vector3).copy(t).add((new fm.Vector3).copy(e).sub(t).normalize().multiplyScalar(r)),l.push(s)),r<a&&(u=(new fm.Vector3).copy(t).add((new fm.Vector3).copy(n).sub(t).normalize().multiplyScalar(r)));for(var c=new fm.QuadraticBezierCurve3(s,t,u),h=0;h<i-1;h++){var f=(h+1)/i;f=c.getPoint(f),l.push(f)}return r<a&&l.push(u),l}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(88);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(i=o(n(10)),o(n(27)));i=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this))._scene=new fm.Scene,e._scene.userData.type="domMarker",e.alias="domMarker",e._visible=!0,e.domMarkers=[],e.anchor=9,e.temp=[],e}return(0,s.default)(n,[{key:"addMarker",value:function(e){e.parent=this,this.domMarkers.push(e);var t=(n=new Date).getTime(),n=Math.random();e._param.id="domMarker"+t+n,e.initDom(e._param),(e=this.findParent(h.default))&&(this._displayMarker(),e._map.on("update",this._moveMarker.bind(this)),e._map.on("focusGroupIDChanged",this._displayMarker.bind(this)),e._map.on("visibleGroupIDsChanged",this._displayMarker.bind(this)))}},{key:"_moveMarker",value:function(){var e=this.findParent(h.default);if(e)for(var t=0;t<this.domMarkers.length;t++){var n,r=this.domMarkers[t],i=r.domNode;i&&(n=null,n=r.gid?r.height?r.height+e._map.groupSpace*r.gid:e._map.groupSpace*r.gid:r.height?r.height+this.height:this.height,n=e._map.coordMapToScreen(r.x,r.y,n),i.style.left=this._anchor(r,n).left,i.style.top=this._anchor(r,n).top,n.domvisible?r._show&&(i.style.display="block"):i.style.display="none")}}},{key:"_anchor",value:function(e,t){var n=null,r=null;switch(e.anchor){case 9:default:n=t.x-e.domWidth/2+"px",r=t.y-e.domHeight/2+"px";break;case 5:n=t.x-e.domWidth+"px",r=t.y-e.domHeight+"px";break;case 6:n=t.x+"px",r=t.y-e.domHeight+"px";break;case 7:n=t.x-e.domWidth+"px",r=t.y+"px";break;case 8:n=t.x+"px",r=t.y+"px";break;case 1:n=t.x-e.domWidth+"px",r=t.y-e.domHeight/2+"px";break;case 2:n=t.x+"px",r=t.y-e.domHeight/2+"px";break;case 3:n=t.x-e.domWidth/2+"px",r=t.y-e.domHeight+"px";break;case 4:n=t.x-e.domWidth/2+"px",r=t.y+"px"}return{left:n,top:r}}},{key:"_displayMarker",value:function(){var e=this.findParent(h.default);if(e)if(1===e._map._visibleGroups.length)if(this.parent.eid===e._map.focusGroupID)for(var t=0;t<this.domMarkers.length;t++)this.domMarkers[t].show&&(this.domMarkers[t].domNode.style.display="block",this.domMarkers[t].domNode.style.opacity=1);else for(var n=0;n<this.domMarkers.length;n++)this.domMarkers[n].domNode.style.display="none",this.domMarkers[n].domNode.style.opacity=e._map.MapOptions.focusAlpha;else if(this.parent.eid===e._map.focusGroupID)for(var r=0;r<this.domMarkers.length;r++)this.domMarkers[r].show&&(this.domMarkers[r].domNode.style.display="block",this.domMarkers[r].domNode.style.opacity=1);else for(var i=0;i<this.domMarkers.length;i++)this.domMarkers[i].show&&(this.domMarkers[i].domNode.style.display="block",this.domMarkers[i].domNode.style.opacity=e._map.MapOptions.focusAlpha)}},{key:"removeMarker",value:function(e){if(void 0===e)return null;e.parent=null;var t=document.getElementById(e._param.id);t&&(t.parentNode.removeChild(t),t=null),-1<(e=this.domMarkers.indexOf(e))&&this.domMarkers.splice(e,1)}},{key:"removeAll",value:function(){if(void 0===this.domMarkers.length)return null;for(var e=0;e<this.domMarkers.length;e++){var t=document.getElementById(this.domMarkers[e]._param.id);t&&(t.parentNode.removeChild(t),t=null)}this.domMarkers.length=0}},{key:"dispose",value:function(){this.removeAll()}},{key:"scene",get:function(){return this._scene}},{key:"height",get:function(){return this.parent._height}},{key:"show",get:function(){return this.show},set:function(e){if(void 0===this.domMarkers.length)return null;for(var t=0;t<this.domMarkers.length;t++){var n=document.getElementById(this.domMarkers[t]._param.id);n&&(n.style.display=e?"block":"none")}}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(8),n(9);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7));n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this,"dynmodel"))._scene=new fm.Scene,e._scene.userData.type="dynmodel",e._scene.name="dynmodel",e.alias="dynmodel",e._models={},e.prepareInitObjects=[],e._visible=!0,e.initLight(),e.putLight(),e}return(0,s.default)(n,[{key:"initLight",value:function(){this._ambientLight=new fm.AmbientLight(7631988),this._target=new fm.Object3D,this._mainLight=new fm.DirectionalLight(8947848,1.2),this._mainLight.position.set(-1,1,1).normalize(),this._mainLight.target=this._target,this._secondLight=new fm.DirectionalLight(3355443),this._secondLight.position.set(-.5,1,-1).normalize(),this._secondLight.target=this._target}},{key:"addNodes",value:function(e){e.parent=this,e.renderNode&&this._scene.add(e.renderNode),this._models[""+e.eid]=e}},{key:"removeNode",value:function(e){this.removeMarker(e)}},{key:"removeMarker",value:function(e){e.parent=void 0;var t=this;void 0!==e.renderNode&&null!==e.renderNode&&(e.renderNode.traverse((function(n){var r;n instanceof fm.Mesh&&(n.material.transparent=!0,e._fadeOut?r=setInterval((function(){.05<n.material.opacity?n.material.opacity-=.05:(clearInterval(r),t._scene.remove(e.renderNode))}),200):t._scene.remove(e.renderNode))})),e.dispose())}},{key:"untiedMarker",value:function(e){e.parent=void 0,this._scene.remove(e.renderNode)}},{key:"putLight",value:function(){var e=this;this.scene.add(this._mainLight),this.scene.add(this._ambientLight),this.scene.add(this._secondLight),this.scene.add(this._target),this.scene.removeLight=function(){e.removeLight()}}},{key:"removeLight",value:function(){this.scene.remove(this._mainLight),this.scene.remove(this._ambientLight),this.scene.remove(this._secondLight)}},{key:"disposeLight",value:function(){this._mainLight=void 0,this._ambientLight=void 0,this._secondLight=void 0}},{key:"getNodeById",value:function(e){return this._models[""+e]}},{key:"traverse",value:function(e){for(var t in this._models)e&&e(this._models[t])}},{key:"checkSceneNode",value:function(){for(var e in this._scene.children.length=0,this._models)this._models[e].visible&&this._models[e].renderNode&&this._scene.add(this._models[e].renderNode);this.putLight()}},{key:"getAllMesh",value:function(){var e,t=[];for(e in this._models)this._models[e].renderNode&&t.push(this._models[e].renderNode);return t}},{key:"dispose",value:function(){for(var e in this._models)this._models[e].dispose(),this._scene.remove(this._models[e].renderNode),this._models[e].parent=void 0,this._models[e]=void 0;this.removeLight(),this.disposeLight(),this._scene.length=0,this._scene=void 0}},{key:"models",get:function(){return this._models},set:function(e){this._models=e}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.parent&&this.parent.parent&&this.parent.parent.parent&&this.parent.parent.parent.map.setRenderList()}},{key:"show",get:function(){return this.visible},set:function(e){this.visible=e}}]),n}((n=o(n(10))).default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(8);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7));n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this))._scene=new fm.Scene,e._scene.userData.type="flmMarker",e._scene.name="flmMarker",e.alias="flmMarker",e.lines=[],e._visible=!0,e}return(0,s.default)(n,[{key:"addMarker",value:function(e){e.parent=this,e.initLine(),e.renderNode&&this._scene.add(e.renderNode),this.lines.push(e)}},{key:"removeMarker",value:function(e){if(!e.renderNode)return!1;for(var t=0;t<this.lines.length;t++)if(this.lines[t].renderNode.uuid===e.renderNode.uuid){this.lines.splice(t,1);break}this._scene.remove(e.renderNode)}},{key:"removeAll",value:function(){for(var e=0;e<this.lines.length;e++)this._scene.remove(this.lines[e].renderNode);this.lines=[]}},{key:"dispose",value:function(){for(var e=0;e<this.lines.length;e++)this._scene.remove(this.lines[e].renderNode),this.lines[e].parent=void 0,this.lines[e]=void 0;this._scene.length=0,this._scene=void 0}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible}}]),n}((n=o(n(10))).default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(5)),u=o(n(6)),l=o(n(7));n=function(e){(0,s.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this))._scene.userData.type="extrudeMarker",e.alias="extrudeMarker",e}return n}((n=o(n(230))).default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(32);var a=o(n(2)),s=o(n(5)),u=o(n(6)),l=o(n(7));n=function(e){(0,s.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}(n);function n(){(0,a.default)(this,n);var e=t.call(this),r=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);return r=new fm.InterleavedBuffer(r,5),e.setIndex([0,1,2,0,2,3]),e.setAttribute("position",new fm.InterleavedBufferAttribute(r,3,0,!1)),e.setAttribute("uv",new fm.InterleavedBufferAttribute(r,2,3,!1)),e}return n}(fm.BufferGeometry),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(53)),a=i(n(407)),s=i(n(11)),u=(r=i(n(34)),i(n(19))),l=i(n(63));function c(e){this.manager=void 0!==e?e:fm.DefaultLoadingManager,this.dracoLoader=null,this.ddsLoader=null}function h(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}n(150),n(8),n(414),n(14),n(71),n(110),n(13),n(145),n(55),n(9),n(184),n(194),n(151),n(195),n(32),n(62),c.prototype={constructor:c,crossOrigin:"anonymous",load:function(e,t,n,r){var i=this,o=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:fm.LoaderUtils.extractUrlBase(e);i.manager.itemStart(e);var a=function(t){r?r(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},s=new fm.FileLoader(i.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),"use-credentials"===i.crossOrigin&&s.setWithCredentials(!0),s.load(e,(function(n){try{i.parse(n,o,(function(r){t(r,n),i.manager.itemEnd(e)}),a)}catch(e){a(e)}}),n,a)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,n,r){var i,o={};if("string"==typeof e)i=e;else if(fm.LoaderUtils.decodeText(new Uint8Array(e,0,4))===m){try{o[f.KHR_BINARY_GLTF]=new _(e)}catch(e){return void(r&&r(e))}i=o[f.KHR_BINARY_GLTF].content}else i=fm.LoaderUtils.decodeText(new Uint8Array(e));var a=JSON.parse(i);if(void 0===a.asset||a.asset.version[0]<2)r&&r(new Error("fm.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(a.extensionsUsed)for(var s=0;s<a.extensionsUsed.length;++s){var u=a.extensionsUsed[s],l=a.extensionsRequired||[];switch(u){case f.KHR_LIGHTS_PUNCTUAL:o[u]=new p(a);break;case f.KHR_MATERIALS_UNLIT:o[u]=new g;break;case f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[u]=new I;break;case f.KHR_DRACO_MESH_COMPRESSION:o[u]=new x(a,this.dracoLoader);break;case f.MSFT_TEXTURE_DDS:o[f.MSFT_TEXTURE_DDS]=new d(this.ddsLoader);break;case f.KHR_TEXTURE_TRANSFORM:o[f.KHR_TEXTURE_TRANSFORM]=new A;break;default:0<=l.indexOf(u)&&console.warn('fm.GLTFLoader: Unknown extension "'+u+'".')}}(t=new z(a,o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager})).parse(n,r)}}};var f={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function d(e){if(!e)throw new Error("fm.GLTFLoader: Attempting to load .dds texture without importing fm.DDSLoader");this.name=f.MSFT_TEXTURE_DDS,this.ddsLoader=e}function p(e){this.name=f.KHR_LIGHTS_PUNCTUAL,e=e.extensions&&e.extensions[f.KHR_LIGHTS_PUNCTUAL]||{},this.lightDefs=e.lights||[]}function g(){this.name=f.KHR_MATERIALS_UNLIT}p.prototype.loadLight=function(e){var t,n=this.lightDefs[e],r=new fm.Color(16777215);void 0!==n.color&&r.fromArray(n.color);var i=void 0!==n.range?n.range:0;switch(n.type){case"directional":(t=new fm.DirectionalLight(r)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new fm.PointLight(r)).distance=i;break;case"spot":(t=new fm.SpotLight(r)).distance=i,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,t.angle=n.spot.outerConeAngle,t.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('fm.GLTFLoader: Unexpected light type, "'+n.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==n.intensity&&(t.intensity=n.intensity),t.name=n.name||"light_"+e,a.default.resolve(t)},g.prototype.getMaterialType=function(){return fm.MeshBasicMaterial},g.prototype.extendParams=function(e,t,n){var r=[];e.color=new fm.Color(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;return i&&((0,s.default)(i.baseColorFactor)&&(t=i.baseColorFactor,e.color.fromArray(t),e.opacity=t[3]),void 0!==i.baseColorTexture&&r.push(n.assignTexture(e,"map",i.baseColorTexture))),a.default.all(r)};var m="glTF",v=12,y={JSON:1313821514,BIN:5130562};function _(e){this.name=f.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,v);if(this.header={magic:fm.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==m)throw new Error("fm.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("fm.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var n=new DataView(e,v),r=0;r<n.byteLength;){var i=n.getUint32(r,!0);r+=4;var o,a=n.getUint32(r,!0);r+=4,a===y.JSON?(o=new Uint8Array(e,v+r,i),this.content=fm.LoaderUtils.decodeText(o)):a===y.BIN&&(a=v+r,this.body=e.slice(a,a+i)),r+=i}if(null===this.content)throw new Error("fm.GLTFLoader: JSON content not found.")}function x(e,t){if(!t)throw new Error("fm.GLTFLoader: No DRACOLoader instance provided.");this.name=f.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function A(){this.name=f.KHR_TEXTURE_TRANSFORM}function I(){return{name:f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return fm.ShaderMaterial},extendParams:function(e,t,n){var r=t.extensions[this.name],i=fm.ShaderLib.standard,o=fm.UniformsUtils.clone(i.uniforms),u=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),l=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),c=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),h=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n");return t=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),t=i.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",u).replace("#include <metalnessmap_pars_fragment>",l).replace("#include <roughnessmap_fragment>",c).replace("#include <metalnessmap_fragment>",h).replace("#include <lights_physical_fragment>",t),delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new fm.Color).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},e.vertexShader=i.vertexShader,e.fragmentShader=t,e.uniforms=o,e.defines={STANDARD:""},e.color=new fm.Color(1,1,1),e.opacity=1,t=[],(0,s.default)(r.diffuseFactor)&&(o=r.diffuseFactor,e.color.fromArray(o),e.opacity=o[3]),void 0!==r.diffuseTexture&&t.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new fm.Color(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new fm.Color(1,1,1),(0,s.default)(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture&&(r=r.specularGlossinessTexture,t.push(n.assignTexture(e,"glossinessMap",r)),t.push(n.assignTexture(e,"specularMap",r))),a.default.all(t)},createMaterial:function(e){var t=new fm.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var n=this.specularGlossinessParams,r=0,i=n.length;r<i;r++){var o=e[n[r]];t[n[r]]=o&&o.isColor?o.clone():o}return t},refreshUniforms:function(e,t,n,r,i){var o,a,s;!0===i.isGLTFSpecularGlossinessMaterial&&(o=i.uniforms,a=i.defines,o.opacity.value=i.opacity,o.diffuse.value.copy(i.color),o.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),o.map.value=i.map,o.specularMap.value=i.specularMap,o.alphaMap.value=i.alphaMap,o.lightMap.value=i.lightMap,o.lightMapIntensity.value=i.lightMapIntensity,o.aoMap.value=i.aoMap,o.aoMapIntensity.value=i.aoMapIntensity,i.map?s=i.map:i.specularMap?s=i.specularMap:i.displacementMap?s=i.displacementMap:i.normalMap?s=i.normalMap:i.bumpMap?s=i.bumpMap:i.glossinessMap?s=i.glossinessMap:i.alphaMap?s=i.alphaMap:i.emissiveMap&&(s=i.emissiveMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),o.uvTransform.value.copy(s.matrix)),i.envMap&&(o.envMap.value=i.envMap,o.envMapIntensity.value=i.envMapIntensity,o.flipEnvMap.value=i.envMap.isCubeTexture?-1:1,o.reflectivity.value=i.reflectivity,o.refractionRatio.value=i.refractionRatio,o.maxMipLevel.value=e.properties.get(i.envMap).__maxMipLevel),o.specular.value.copy(i.specular),o.glossiness.value=i.glossiness,o.glossinessMap.value=i.glossinessMap,o.emissiveMap.value=i.emissiveMap,o.bumpMap.value=i.bumpMap,o.normalMap.value=i.normalMap,o.displacementMap.value=i.displacementMap,o.displacementScale.value=i.displacementScale,o.displacementBias.value=i.displacementBias,null!==o.glossinessMap.value&&void 0===a.USE_GLOSSINESSMAP&&(a.USE_GLOSSINESSMAP="",a.USE_ROUGHNESSMAP=""),null===o.glossinessMap.value&&void 0!==a.USE_GLOSSINESSMAP&&(delete a.USE_GLOSSINESSMAP,delete a.USE_ROUGHNESSMAP))}}}function w(e,t,n,r){fm.Interpolant.call(this,e,t,n,r)}x.prototype.decodePrimitive=function(e,t){var n,r=this.json,i=this.dracoLoader,o=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,u={},l={},c={};for(n in s){var h=S[n]||n.toLowerCase();u[h]=s[n]}for(n in e.attributes){var f,d;h=S[n]||n.toLowerCase(),void 0!==s[n]&&(f=r.accessors[e.attributes[n]],d=C[f.componentType],c[h]=d,l[h]=!0===f.normalized)}return t.getDependency("bufferView",o).then((function(e){return new a.default((function(t){i.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n];void 0!==(n=l[n])&&(r.normalized=n)}t(e)}),u,c)}))}))},A.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('fm.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},w.prototype=(0,r.default)(fm.Interpolant.prototype),w.prototype.constructor=w,w.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r,o=0;o!==r;o++)t[o]=n[i+o];return t},w.prototype.beforeStart_=w.prototype.copySampleValue_,w.prototype.afterEnd_=w.prototype.copySampleValue_,w.prototype.interpolate_=function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,u=3*a,l=r-t,c=e*u,h=c-u,f=-2*(t=(n=(r=(n-t)/l)*r)*r)+3*n,d=t-n,p=1-f,g=d-n+r,m=0;m!==a;m++){var v=o[h+m+a],y=o[h+m+s]*l,_=o[c+m+a],x=o[c+m]*l;i[m]=p*v+g*y+f*_+d*x}return i};var b,C={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},M={9728:fm.NearestFilter,9729:fm.LinearFilter,9984:fm.NearestMipmapNearestFilter,9985:fm.LinearMipmapNearestFilter,9986:fm.NearestMipmapLinearFilter,9987:fm.LinearMipmapLinearFilter},E={33071:fm.ClampToEdgeWrapping,33648:fm.MirroredRepeatWrapping,10497:fm.RepeatWrapping},T={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},S={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},L={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},k={CUBICSPLINE:void 0,LINEAR:fm.InterpolateLinear,STEP:fm.InterpolateDiscrete},R={"image/png":fm.RGBAFormat,"image/jpeg":fm.RGBFormat};function N(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function P(e,t,n){for(var r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function O(e,t){void 0!==t.extras&&("object"===(0,o.default)(t.extras)?(0,u.default)(e.userData,t.extras):console.warn("fm.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function D(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&(0,s.default)(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length)for(e.morphTargetDictionary={},n=0,r=i.length;n<r;n++)e.morphTargetDictionary[i[n]]=n;else console.warn("fm.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function F(e){var t=e.extensions&&e.extensions[f.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+B(t.attributes):e.indices+":"+B(e.attributes)+":"+e.mode}function B(e){for(var t="",n=(0,l.default)(e).sort(),r=0,i=n.length;r<i;r++)t+=n[r]+":"+e[n[r]]+";";return t}function G(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,n=e.itemSize,r=e.array.slice(0,t*n),i=0,o=0;i<t;++i)r[o++]=e.getX(i),2<=n&&(r[o++]=e.getY(i)),3<=n&&(r[o++]=e.getZ(i)),4<=n&&(r[o++]=e.getW(i));return new fm.BufferAttribute(r,n,e.normalized)}return e.clone()}function z(e,t,n){this.json=e||{},this.extensions=t||{},this.options=n||{},this.cache=new h,this.primitiveCache={},this.textureLoader=new fm.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new fm.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function U(e,t,n){var r,i,o=t.attributes,s=[];function u(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(r in o){var l=S[r]||r.toLowerCase();l in e.attributes||s.push(u(o[r],l))}return void 0===t.indices||e.index||(i=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)})),s.push(i)),O(e,t),a.default.all(s).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,i=!1,o=0,s=t.length;o<s&&(void 0!==(h=t[o]).POSITION&&(r=!0),void 0!==h.NORMAL&&(i=!0),!r||!i);o++);if(!r&&!i)return a.default.resolve(e);var u=[],l=[];for(o=0,s=t.length;o<s;o++){var c,h=t[o];r&&(c=void 0!==h.POSITION?n.getDependency("accessor",h.POSITION):e.attributes.position,u.push(c)),i&&(c=void 0!==h.NORMAL?n.getDependency("accessor",h.NORMAL):e.attributes.normal,l.push(c))}return a.default.all([a.default.all(u),a.default.all(l)]).then((function(n){for(var o=n[0],a=n[1],s=0,u=o.length;s<u;s++)e.attributes.position!==o[s]&&(o[s]=G(o[s]));for(s=0,u=a.length;s<u;s++)e.attributes.normal!==a[s]&&(a[s]=G(a[s]));for(s=0,u=t.length;s<u;s++){var l=t[s],c="morphTarget"+s;if(r&&void 0!==l.POSITION){var h=o[s];h.name=c;for(var f=e.attributes.position,d=0,p=h.count;d<p;d++)h.setXYZ(d,h.getX(d)+f.getX(d),h.getY(d)+f.getY(d),h.getZ(d)+f.getZ(d))}if(i&&void 0!==l.NORMAL){var g=a[s];g.name=c;var m=e.attributes.normal;for(d=0,p=g.count;d<p;d++)g.setXYZ(d,g.getX(d)+m.getX(d),g.getY(d)+m.getY(d),g.getZ(d)+m.getZ(d))}}return r&&(e.morphAttributes.position=o),i&&(e.morphAttributes.normal=a),e}))}(e,t.targets,n):e}))}function V(e,t,n,r){var i=n.nodes[e];return r.getDependency("node",e).then((function(e){return void 0===i.skin?e:r.getDependency("skin",i.skin).then((function(e){for(var n=[],i=0,o=(t=e).joints.length;i<o;i++)n.push(r.getDependency("node",t.joints[i]));return a.default.all(n)})).then((function(n){return e.traverse((function(e){if(e.isMesh){for(var r=[],i=[],o=0,a=n.length;o<a;o++){var s=n[o];s?(r.push(s),s=new fm.Matrix4,void 0!==t.inverseBindMatrices&&s.fromArray(t.inverseBindMatrices.array,16*o),i.push(s)):console.warn('fm.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}e.bind(new fm.Skeleton(r,i),e.matrixWorld)}})),e}));var t})).then((function(e){t.add(e);var o=[];if(i.children)for(var s=i.children,u=0,l=s.length;u<l;u++){var c=s[u];o.push(V(c,e,n,r))}return a.default.all(o)}))}z.prototype.parse=function(e,t){var n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.markDefs(),a.default.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){t={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}},P(i,t,r),O(t,r),e(t)})).catch(t)},z.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r={},i={},o=0,a=t.length;o<a;o++)for(var s=t[o].joints,u=0,l=s.length;u<l;u++)e[s[u]].isBone=!0;for(var c=0,h=e.length;c<h;c++){var f=e[c];void 0!==f.mesh&&(void 0===r[f.mesh]&&(r[f.mesh]=i[f.mesh]=0),r[f.mesh]++,void 0!==f.skin&&(n[f.mesh].isSkinnedMesh=!0))}this.json.meshReferences=r,this.json.meshUses=i},z.prototype.getDependency=function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this.loadMesh(t);break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this.loadBufferView(t);break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this.loadMaterial(t);break;case"texture":r=this.loadTexture(t);break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;case"light":r=this.extensions[f.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r},z.prototype.getDependencies=function(e){var t,n,r=this.cache.get(e);return r||(t=this,n=this.json[e+("mesh"===e?"es":"s")]||[],r=a.default.all(n.map((function(n,r){return t.getDependency(e,r)}))),this.cache.add(e,r)),r},z.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("fm.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return a.default.resolve(this.extensions[f.KHR_BINARY_GLTF].body);var r=this.options;return new a.default((function(e,i){n.load(N(t.uri,r.path),e,void 0,(function(){i(new Error('fm.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},z.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))},z.prototype.loadAccessor=function(e){var t=this,n=this.json,r=this.json.accessors[e];return void 0===r.bufferView&&void 0===r.sparse?a.default.resolve(null):(e=[],void 0!==r.bufferView?e.push(this.getDependency("bufferView",r.bufferView)):e.push(null),void 0!==r.sparse&&(e.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),e.push(this.getDependency("bufferView",r.sparse.values.bufferView))),a.default.all(e).then((function(e){var i,o,a=e[0],s=T[r.type],u=C[r.componentType],l=(p=u.BYTES_PER_ELEMENT)*s,c=r.byteOffset||0,h=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,f=!0===r.normalized,d=h&&h!==l?(i=Math.floor(c/h),o="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+i+":"+r.count,(l=t.cache.get(o))||(g=new u(a,i*h,r.count*h/p),l=new fm.InterleavedBuffer(g,h/p),t.cache.add(o,l)),new fm.InterleavedBufferAttribute(l,s,c%h/p,f)):(g=null===a?new u(r.count*s):new u(a,c,r.count*s),new fm.BufferAttribute(g,s,f));if(void 0!==r.sparse){var p=T.SCALAR,g=(c=C[r.sparse.indices.componentType],r.sparse.indices.byteOffset||0),m=(f=r.sparse.values.byteOffset||0,new c(e[1],g,r.sparse.count*p)),v=new u(e[2],f,r.sparse.count*s);null!==a&&d.setArray(d.array.slice());for(var y=0,_=m.length;y<_;y++){var x=m[y];if(d.setX(x,v[y*s]),2<=s&&d.setY(x,v[y*s+1]),3<=s&&d.setZ(x,v[y*s+2]),4<=s&&d.setW(x,v[y*s+3]),5<=s)throw new Error("fm.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return d})))},z.prototype.loadTexture=function(e){var t=this,n=this.json,r=this.options,i=this.textureLoader,o=window.URL||window.webkitURL,s=n.textures[e],u=s.extensions||{},l=u[f.MSFT_TEXTURE_DDS]?n.images[u[f.MSFT_TEXTURE_DDS].source]:n.images[s.source],c=l.uri,h=!1;return void 0!==l.bufferView&&(c=t.getDependency("bufferView",l.bufferView).then((function(e){return h=!0,e=new Blob([e],{type:l.mimeType}),c=o.createObjectURL(e)}))),a.default.resolve(c).then((function(e){var n=new fm.LoadingManager,o=(o=n.getHandler(e))||(u[f.MSFT_TEXTURE_DDS]?t.extensions[f.MSFT_TEXTURE_DDS].ddsLoader:i);return new a.default((function(t,n){o.load(N(e,r.path),t,void 0,n)}))})).then((function(e){!0===h&&o.revokeObjectURL(c),e.flipY=!1,void 0!==s.name&&(e.name=s.name),l.mimeType in R&&(e.format=R[l.mimeType]);var t=(t=n.samplers||{})[s.sampler]||{};return e.magFilter=M[t.magFilter]||fm.LinearFilter,e.minFilter=M[t.minFilter]||fm.LinearMipmapLinearFilter,e.wrapS=E[t.wrapS]||fm.RepeatWrapping,e.wrapT=E[t.wrapT]||fm.RepeatWrapping,e}))},z.prototype.assignTexture=function(e,t,n){var r=this;return this.getDependency("texture",n.index).then((function(i){if(!i.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":i.format=fm.RGBFormat}var o;r.extensions[f.KHR_TEXTURE_TRANSFORM]&&(o=void 0!==n.extensions?n.extensions[f.KHR_TEXTURE_TRANSFORM]:void 0)&&(i=r.extensions[f.KHR_TEXTURE_TRANSFORM].extendTexture(i,o)),e[t]=i}))},z.prototype.assignFinalMaterial=function(e){var t,n,r,i=e.geometry,o=e.material,a=this.extensions,s=void 0!==i.attributes.tangent,u=void 0!==i.attributes.color,c=void 0===i.attributes.normal,h=!0===e.isSkinnedMesh,d=0<(0,l.default)(i.morphAttributes).length,p=d&&void 0!==i.morphAttributes.normal;e.isPoints?(n="PointsMaterial:"+o.uuid,(t=this.cache.get(n))||(t=new fm.PointsMaterial,fm.Material.prototype.copy.call(t,o),t.color.copy(o.color),t.map=o.map,t.lights=!1,this.cache.add(n,t)),o=t):e.isLine&&(n="LineBasicMaterial:"+o.uuid,(r=this.cache.get(n))||(r=new fm.LineBasicMaterial,fm.Material.prototype.copy.call(r,o),r.color.copy(o.color),r.lights=!1,this.cache.add(n,r)),o=r),(s||u||c||h||d)&&(n="ClonedMaterial:"+o.uuid+":",o.isGLTFSpecularGlossinessMaterial&&(n+="specular-glossiness:"),h&&(n+="skinning:"),s&&(n+="vertex-tangents:"),u&&(n+="vertex-colors:"),c&&(n+="flat-shading:"),d&&(n+="morph-targets:"),p&&(n+="morph-normals:"),(r=this.cache.get(n))||(r=o.isGLTFSpecularGlossinessMaterial?a[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(o):o.clone(),h&&(r.skinning=!0),s&&(r.vertexTangents=!0),u&&(r.vertexColors=fm.VertexColors),c&&(r.flatShading=!0),d&&(r.morphTargets=!0),p&&(r.morphNormals=!0),this.cache.add(n,r)),o=r),o.aoMap&&void 0===i.attributes.uv2&&void 0!==i.attributes.uv&&i.addAttribute("uv2",new fm.BufferAttribute(i.attributes.uv.array,2)),o.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=a[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=o},z.prototype.loadMaterial=function(e){var t,n,r=this,i=this.json,o=this.extensions,u=i.materials[e],l={},c=u.extensions||{};i=[],c[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]?(e=o[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS],t=e.getMaterialType(),i.push(e.extendParams(l,u,r))):c[f.KHR_MATERIALS_UNLIT]?(n=o[f.KHR_MATERIALS_UNLIT],t=n.getMaterialType(),i.push(n.extendParams(l,u,r))):(t=fm.MeshStandardMaterial,h=u.pbrMetallicRoughness||{},l.color=new fm.Color(1,1,1),l.opacity=1,(0,s.default)(h.baseColorFactor)&&(n=h.baseColorFactor,l.color.fromArray(n),l.opacity=n[3]),void 0!==h.baseColorTexture&&i.push(r.assignTexture(l,"map",h.baseColorTexture)),l.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,l.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(i.push(r.assignTexture(l,"metalnessMap",h.metallicRoughnessTexture)),i.push(r.assignTexture(l,"roughnessMap",h.metallicRoughnessTexture)))),!0===u.doubleSided&&(l.side=fm.DoubleSide);var h=u.alphaMode||"OPAQUE";return"BLEND"===h?l.transparent=!0:(l.transparent=!1,"MASK"===h&&(l.alphaTest=void 0!==u.alphaCutoff?u.alphaCutoff:.5)),void 0!==u.normalTexture&&t!==fm.MeshBasicMaterial&&(i.push(r.assignTexture(l,"normalMap",u.normalTexture)),l.normalScale=new fm.Vector2(1,1),void 0!==u.normalTexture.scale&&l.normalScale.set(u.normalTexture.scale,u.normalTexture.scale)),void 0!==u.occlusionTexture&&t!==fm.MeshBasicMaterial&&(i.push(r.assignTexture(l,"aoMap",u.occlusionTexture)),void 0!==u.occlusionTexture.strength&&(l.aoMapIntensity=u.occlusionTexture.strength)),void 0!==u.emissiveFactor&&t!==fm.MeshBasicMaterial&&(l.emissive=(new fm.Color).fromArray(u.emissiveFactor)),void 0!==u.emissiveTexture&&t!==fm.MeshBasicMaterial&&i.push(r.assignTexture(l,"emissiveMap",u.emissiveTexture)),a.default.all(i).then((function(){var e=t===fm.ShaderMaterial?o[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(l):new t(l);return void 0!==u.name&&(e.name=u.name),e.map&&(e.map.encoding=fm.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=fm.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=fm.sRGBEncoding),O(e,u),u.extensions&&P(o,e,u),e}))},z.prototype.loadGeometries=function(e){var t=this,n=this.extensions,r=this.primitiveCache;function i(e){return n[f.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return U(n,e,t)}))}for(var o=[],s=0,u=e.length;s<u;s++){var l=e[s],c=F(l),h=r[c];h?o.push(h.promise):(h=l.extensions&&l.extensions[f.KHR_DRACO_MESH_COMPRESSION]?i(l):U(new fm.BufferGeometry,l,t),r[c]={primitive:l,promise:h},o.push(h))}return a.default.all(o)},z.prototype.loadMesh=function(e){for(var t=this,n=this.json.meshes[e],r=n.primitives,i=[],o=0,s=r.length;o<s;o++){var u=void 0===r[o].material?b=b||new fm.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:fm.FrontSide}):this.getDependency("material",r[o].material);i.push(u)}return a.default.all(i).then((function(i){return t.loadGeometries(r).then((function(o){for(var a=[],s=0,u=o.length;s<u;s++){var c,h=o[s],f=r[s],d=i[s];if(4===f.mode||5===f.mode||6===f.mode||void 0===f.mode)!0!==(c=new(!0===n.isSkinnedMesh?fm.SkinnedMesh:fm.Mesh)(h,d)).isSkinnedMesh||c.geometry.attributes.skinWeight.normalized||c.normalizeSkinWeights(),5===f.mode?c.drawMode=fm.TriangleStripDrawMode:6===f.mode&&(c.drawMode=fm.TriangleFanDrawMode);else if(1===f.mode)c=new fm.LineSegments(h,d);else if(3===f.mode)c=new fm.Line(h,d);else if(2===f.mode)c=new fm.LineLoop(h,d);else{if(0!==f.mode)throw new Error("fm.GLTFLoader: Primitive mode unsupported: "+f.mode);c=new fm.Points(h,d)}0<(0,l.default)(c.geometry.morphAttributes).length&&D(c,n),c.name=n.name||"mesh_"+e,1<o.length&&(c.name+="_"+s),O(c,n),t.assignFinalMaterial(c),a.push(c)}if(1===a.length)return a[0];var p=new fm.Group;for(s=0,u=a.length;s<u;s++)p.add(a[s]);return p}))}))},z.prototype.loadCamera=function(e){var t,n=this.json.cameras[e];if(e=n[n.type])return"perspective"===n.type?t=new fm.PerspectiveCamera(fm.Math.radToDeg(e.yfov),e.aspectRatio||1,e.znear||1,e.zfar||2e6):"orthographic"===n.type&&(t=new fm.OrthographicCamera(e.xmag/-2,e.xmag/2,e.ymag/2,e.ymag/-2,e.znear,e.zfar)),void 0!==n.name&&(t.name=n.name),O(t,n),a.default.resolve(t);console.warn("fm.GLTFLoader: Missing camera parameters.")},z.prototype.loadSkin=function(e){var t={joints:(e=this.json.skins[e]).joints};return void 0===e.inverseBindMatrices?a.default.resolve(t):this.getDependency("accessor",e.inverseBindMatrices).then((function(e){return t.inverseBindMatrices=e,t}))},z.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],n=[],r=[],i=[],o=[],s=[],u=0,l=t.channels.length;u<l;u++){var c=t.channels[u],h=t.samplers[c.sampler],f=c.target,d=void 0!==f.node?f.node:f.id,p=void 0!==t.parameters?t.parameters[h.input]:h.input;c=void 0!==t.parameters?t.parameters[h.output]:h.output,n.push(this.getDependency("node",d)),r.push(this.getDependency("accessor",p)),i.push(this.getDependency("accessor",c)),o.push(h),s.push(f)}return a.default.all([a.default.all(n),a.default.all(r),a.default.all(i),a.default.all(o),a.default.all(s)]).then((function(n){for(var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=[],l=0,c=r.length;l<c;l++){var h,f=r[l],d=i[l],p=o[l],g=a[l],m=s[l];if(void 0!==f){switch(f.updateMatrix(),f.matrixAutoUpdate=!0,L[m.path]){case L.weights:h=fm.NumberKeyframeTrack;break;case L.rotation:h=fm.QuaternionKeyframeTrack;break;default:h=fm.VectorKeyframeTrack}var v=f.name||f.uuid,y=void 0!==g.interpolation?k[g.interpolation]:fm.InterpolateLinear,_=[];L[m.path]===L.weights?f.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&_.push(e.name||e.uuid)})):_.push(v);var x,A=p.array;if(p.normalized){if(A.constructor===Int8Array)x=1/127;else if(A.constructor===Uint8Array)x=1/255;else if(A.constructor==Int16Array)x=1/32767;else{if(A.constructor!==Uint16Array)throw new Error("fm.GLTFLoader: Unsupported output accessor component type.");x=1/65535}for(var I=new Float32Array(A.length),b=0,C=A.length;b<C;b++)I[b]=A[b]*x;A=I}for(b=0,C=_.length;b<C;b++){var M=new h(_[b]+"."+L[m.path],d.array,A,y);"CUBICSPLINE"===g.interpolation&&(M.createInterpolant=function(e){return new w(this.times,this.values,this.getValueSize()/3,e)},M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),u.push(M)}}}return n=void 0!==t.name?t.name:"animation_"+e,new fm.AnimationClip(n,void 0,u)}))},z.prototype.loadNode=function(e){var t=this.json,n=this.extensions,r=this,i=t.meshReferences,o=t.meshUses,s=t.nodes[e];return e=[],void 0!==s.mesh&&e.push(r.getDependency("mesh",s.mesh).then((function(e){if(1<i[s.mesh]){var t=o[s.mesh]++,n=e.clone();n.name+="_instance_"+t,n.onBeforeRender=e.onBeforeRender;for(var r=0,a=n.children.length;r<a;r++)n.children[r].name+="_instance_"+t,n.children[r].onBeforeRender=e.children[r].onBeforeRender}else n=e;return void 0!==s.weights&&n.traverse((function(e){if(e.isMesh)for(var t=0,n=s.weights.length;t<n;t++)e.morphTargetInfluences[t]=s.weights[t]})),n}))),void 0!==s.camera&&e.push(r.getDependency("camera",s.camera)),s.extensions&&s.extensions[f.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[f.KHR_LIGHTS_PUNCTUAL].light&&e.push(r.getDependency("light",s.extensions[f.KHR_LIGHTS_PUNCTUAL].light)),a.default.all(e).then((function(e){var t,r=!0===s.isBone?new fm.Bone:1<e.length?new fm.Group:1===e.length?e[0]:new fm.Object3D;if(r!==e[0])for(var i=0,o=e.length;i<o;i++)r.add(e[i]);return void 0!==s.name&&(r.userData.name=s.name,r.name=fm.PropertyBinding.sanitizeNodeName(s.name)),O(r,s),s.extensions&&P(n,r,s),void 0!==s.matrix?((t=new fm.Matrix4).fromArray(s.matrix),r.applyMatrix(t)):(void 0!==s.translation&&r.position.fromArray(s.translation),void 0!==s.rotation&&r.quaternion.fromArray(s.rotation),void 0!==s.scale&&r.scale.fromArray(s.scale)),r}))},z.prototype.loadScene=function(e){var t=this.json,n=this.extensions,r=(e=this.json.scenes[e],new fm.Scene);void 0!==e.name&&(r.name=e.name),O(r,e),e.extensions&&P(n,r,e);for(var i=e.nodes||[],o=[],s=0,u=i.length;s<u;s++)o.push(V(i[s],r,t,this));return a.default.all(o).then((function(){return r}))},r=c,t.default=r},function(e,t,n){var r=n(37),i=n(56),o=n(29)("species");e.exports=function(e,t){var n;return void 0===(e=r(e).constructor)||null==(n=r(e)[o])?t:i(n)}},function(e,t,n){var r,i=n(42),o=n(169),a=n(168),s=n(121),u=n(20),l=u.process,c=u.setImmediate,h=u.clearImmediate,f=u.MessageChannel,d=u.Dispatch,p=0,g={},m="onreadystatechange",v=function(){var e,t=+this;g.hasOwnProperty(t)&&(e=g[t],delete g[t],e())},y=function(e){v.call(e.data)};c&&h||(c=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return g[++p]=function(){o("function"==typeof e?e:Function(e),t)},r(p),p},h=function(e){delete g[e]},"process"==n(78)(l)?r=function(e){l.nextTick(i(v,e,1))}:d&&d.now?r=function(e){d.now(i(v,e,1))}:f?(n=new f,f=n.port2,n.port1.onmessage=y,r=i(f.postMessage,f,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(r=function(e){u.postMessage(e+"","*")},u.addEventListener("message",y,!1)):r=m in s("script")?function(e){a.appendChild(s("script"))[m]=function(){a.removeChild(this),v.call(e)}}:function(e){setTimeout(i(v,e,1),0)}),e.exports={set:c,clear:h}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(37),i=n(22),o=n(159);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(e=n.resolve)(t),n.promise}},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={VERSION:"2.7.3",BUILD:3},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(13);var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){void 0!==this._listeners&&void 0!==(e=this._listeners[e])&&-1!==(t=e.indexOf(t))&&e.splice(t,1)}},{key:"dispatchEvent",value:function(e){var t;if(void 0!==this._listeners&&void 0!==(t=(t=this._listeners)[e.type]))for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}]),e}(),t.default=n},function(e,t,n){"use strict";n(13),n(14);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(63));n(8),n(9),n(62);var h=l(n(2)),f=l(n(3)),d=l(n(5)),p=l(n(6)),g=l(n(7)),m=(u=l(n(10)),l(n(27))),v=l(n(66)),y=l(n(28));function _(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=x(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function x(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,g.default)(e);return i=t?(n=(0,g.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,p.default)(this,i)}}u=function(e){(0,d.default)(n,e);var t=I(n);function n(e,r){var i;return(0,h.default)(this,n),(i=t.call(this,r.id||fm.Math.generateUUID(),y.default.DYNMODEL))._url=r.url,i._loader=e.nodeManager.getDynLoader(),i._mixer=null,i._renderNode=null,i._gltf=null,i._visible=!0,i._actions={},i._color=r.color,i._scale=r.scale,i._rotation=r.rotation,i._moveAnimater=null,i._isMoving=!1,i._map=e,i._mapCenter=(new fm.Vector2).copy(e.center),i._meshes=[],i._fadeIn=r.fadeIn,i._fadeOut=r.fadeOut,i.init(e,r.coord,r.callback),i}return(0,f.default)(n,[{key:"init",value:function(e,t,n){var r=this;this._loader?(this._height="number"==typeof t.z?t.z:5,this._loader.load(this._url,(function(i){r._fadeIn&&r.fadeIn(i.scene),r._gltf=i,r._renderNode=i.scene,r._renderNode.name="oneModel",r._getMeshes(r._renderNode,r._meshes),r._color&&r.setColor(r._color),r._scale&&r.setScale(r._scale),r._rotation&&r.setRotate(r._rotation),r._renderNode.mapNode=r,r._mixer=new fm.AnimationMixer(r._renderNode),e.addAnimationMixer(r._mixer);var o,a=_(i.animations);try{for(a.s();!(o=a.n()).done;){var s=o.value;r._actions[s.name]=r._mixer.clipAction(s)}}catch(i){a.e(i)}finally{a.f()}r.setPosition(t.x,t.y,0,r._height),r.renderNodeInited=!0,r.visible=!0,n&&n(r)}))):console.error("外部模型加载器缺失")}},{key:"lookAt",value:function(e){var t,n;this.parent&&this.parent.parent?(n=this._map.center,t=this.parent.parent.height,n=new fm.Vector3(e.x-n.x,t+e.z,-e.y+n.y),this._renderNode.lookAt(n)):console.warn("请将模型加载进入地图！")}},{key:"setPosition",value:function(e,t,n,r){"number"==typeof n&&0<n&&this.moveToGroup(n),n=this._mapCenter,this._height=r,this._x=e,this._y=t,this._renderNode.position.set(this._x-n.x,this._height,n.y-this._y)}},{key:"rotateTo",value:function(e){var t=this,n=this._renderNode.rotation.y,r=e.to%360*fm.Math.DEG2RAD;this.rotateAnimater&&(this.rotateAnimater.stop(),this._map.removeAnimater(this.rotateAnimater));var i=new v.default({angle:n},{angle:r},e.duration?1e3*e.duration:500,(function(){t._map.removeAnimater(i),t.rotateAnimater=null,e.callback&&e.callback()}),(function(n){t._renderNode.rotation.y=n.angle,e.update&&e.update()})).start();this._map.addAnimater(i),this.rotateAnimater=i}},{key:"setRotate",value:function(e){this._renderNode.rotation.y=e%360*fm.Math.DEG2RAD}},{key:"setScale",value:function(e){for(var t=this._renderNode.children,n=0;n<t.length;n++)t[n].scale.x=e,t[n].scale.y=e,t[n].scale.z=e}},{key:"setColor",value:function(e){for(var t=new fm.Color(e),n=this._meshes,r=0;r<n.length;r++){var i=n[r];i.material.color.r=t.r,i.material.color.g=t.g,i.material.color.b=t.b}}},{key:"fadeIn",value:function(e){e.traverse((function(e){var t;e instanceof fm.Mesh&&(e.material.transparent=!0,e.material.opacity=0,t=setInterval((function(){e.material.opacity<1?e.material.opacity+=.05:clearInterval(t)}),200))}))}},{key:"setHeight",value:function(e){this.setPosition(this._x,this._y,0,e)}},{key:"setAngle",value:function(e){this._renderNode&&(this._renderNode.rotation.y=e*fm.Math.DEG2RAD)}},{key:"startAction",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.2,n=2<arguments.length?arguments[2]:void 0;(e=this._actions[e])&&(n&&(e.clampWhenFinished=!0,e.loop=fm.LoopOnce),e.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(t).play())}},{key:"stopAction",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.2;(e=this._actions[e])&&e.fadeOut(t)}},{key:"getActionList",value:function(){return(0,c.default)(this._actions)}},{key:"moveTo",value:function(e){var t,n,r,i,o=this;this._isMoving||(t=this.findParent(m.default),n=e.x,r=e.y,e.time||(e.time=.5),i=new v.default({x:this.x,y:this.y},{x:n,y:r},1e3*e.time,(function(){t.map.removeAnimater(i),o._moveAnimater=null,o._isMoving=!1,e.callback&&e.callback()}),(function(t){o.setPosition(t.x,t.y,0,o._height),e.update&&e.update(t)})).start(),this._isMoving=!0,t.map.addAnimater(i),this._moveAnimater=i)}},{key:"stopMoveTo",value:function(){var e=this.findParent(m.default);this._moveAnimater&&this._moveAnimater.stop(),e.map.removeAnimater(this._moveAnimater),this._isMoving=!1,this._moveAnimater=null}},{key:"moveToGroup",value:function(e){this.findParent(m.default),this.parent.parent.groupID!==e&&(this.parent.parent.parent.groups[""+e]?(this._groupId=e,e=this.parent.parent.parent.groups[""+e].getOrCreateLayer("dynmodel"),this.parent.untiedMarker(this),e.addNodes(this)):console.warn(tileMessage.noGroup))}},{key:"_getMeshes",value:function(e,t){if(e instanceof fm.Mesh)e.material=e.material.clone(),t.push(e);else if(e.children)for(var n=0;n<e.children.length;n++)this._getMeshes(e.children[n],t)}},{key:"visible",get:function(){return this._visible},set:function(e){e?this.parent&&this.parent.scene.children.indexOf(this._renderNode)<0&&this._renderNode&&this.parent.scene.add(this._renderNode):(this._renderNode&&this.parent.scene.remove(this._renderNode),this._renderNode.parent=this.parent.scene),this._visible=e}},{key:"renderNode",get:function(){return this._renderNode},set:function(e){this._renderNode=e,this._renderNode.mapNode=this,this.parent.scene.children.indexOf(this._renderNode)<0&&this._renderNode&&this.parent.scene.add(this._renderNode)}},{key:"mapCoord",get:function(){if(this.parent&&this.parent.parent){var e=this._map.center,t=this.parent.parent.height,n=this._renderNode.position;return new fm.Vector3(n.x+e.x,e.y-n.z,-t+n.y)}console.warn("请将模型加载进入地图！")}},{key:"getRandomNumber",value:function(){for(var e=new Array,t=0;t<100;t++)e[t]=t+1;return e.sort((function(){return.5-Math.random()})),e[Math.floor(100*Math.random())]}},{key:"dispose",value:function(){this._renderNode.mapNode=null}}]),n}(u.default),t.default=u},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2));n=function e(){(0,o.default)(this,e),this.enableMapPan=!0,this.enableMapRotate=!0,this.enableMapIncline=!0,this.enableMapPinch=!0,this.enableMapSingleTap=!0,this.enableMapHover=!1},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(21);var o=i(n(2)),a=i(n(3)),s=i(n(212)),u=i(n(217)),l=i(n(218));n=function(){function e(t){(0,o.default)(this,e),this._options=t,this._staticNaviScene=null,this._wktReader=new u.default,this._scene=null}return(0,a.default)(e,[{key:"setScene",value:function(e){this._scene=e}},{key:"queryScene",value:function(e,t,n){var r,i=this;this._options.useStatic?(r=this._options.naviServerURL+"/"+e+".fmap",new s.default(r,(function(e){e=i._convertStatic1(e),t(e.scene_data)}),!0)):(r=this._options.naviServerURL+"/"+e,new s.default(r,(function(e){e=i._convertSite1(e),t(e.scene_data)}),!0))}},{key:"queryNaviData",value:function(e,t,n,r){var i,o,a,u,l=this;this._options.useStatic?(i=l._convertStatic2(t),n(i)):(o=null,a=null,u=null,l=this,new s.default(this._options.naviServerURL+"/group_v2/"+e+"/"+t+"/geo",(function(e){null!=(o=e)&&null!=a&&null!=u&&(e=l._convertSite2(t,o,a,u),n(e))}),!0),new s.default(this._options.naviServerURL+"/group_v2/"+e+"/"+t+"/biz",(function(e){a=e,null!=o&&null!=a&&null!=u&&(e=l._convertSite2(t,o,a,u),n(e))}),!0),new s.default(this._options.naviServerURL+"/group_v2/"+e+"/"+t+"/navi",(function(e){u=e,null!=o&&null!=a&&null!=u&&(e=l._convertSite2(t,o,a,u),n(e))}),!0))}},{key:"convertToGroup",value:function(e,t,n,r){return this._convertToGroup(e,t,n,r)}},{key:"convertGeo2Geometry",value:function(e,t){return this._convertGeo2Geometry(e,t)}},{key:"convertArray2Geometry",value:function(e,t){return this._convertArray2Geometry(e,t)}},{key:"_convertSite1",value:function(e){return{scene_data:fmSceneDecode(e)}}},{key:"_convertSite2",value:function(e,t,n,r){return t=fmFloorGeoDecode(t),n=fmFloorBizDecode(n),r=fmFloorNaviDecode(r),this._convertToGroup(e,t,n,r)}},{key:"_convertGeo2Geometry",value:function(e,t){return{points:(e=this._wktReader.parse(e))._points,holes:e._holes}}},{key:"_convertArray2Geometry",value:function(e,t){return{points:(t=(new l.default).parseGeometry(e,t))._points,holes:t._holes}}},{key:"_tempFlipX",value:function(e){if(e&&"string"!=typeof e)for(var t in e){var n=e[t];if("vertices"==t||"vertex"==t)for(var r in n)r%2==0&&(n[r]=-n[r]);else"scene_data"==t?(n.x=-n.x,n.defCenX=-n.defCenX):this._tempFlipX(n)}}},{key:"_convertStringToArray",value:function(e){if(""==e||!e)return[];var t=[],n=e;return e=[],0<=n.indexOf("|")||0<=n.indexOf("-")||0<=n.indexOf(",")?(e=n.split(/[|,-]/),t.push.apply(t,e)):t.push(n),t}},{key:"_convertStatic1",value:function(e){return this._staticNaviScene=fmMapDecode(e,!1),{scene_data:this._staticNaviScene.scene}}},{key:"_convertStatic2",value:function(e){for(var t=this._staticNaviScene.floors,n=0;n<t.length;n++){var r=t[n];if(r.gid==e)return this._convertToGroup(e,r.geo[0],r.biz[0],r.navi[0])}return null}},{key:"_convertToGroup",value:function(e,t,n,r){for(var i={},o=[],a=[],s=[],u=[],l=[],c=this._scene.scene.file_ver,h=0,f=t.extentLayer.length;h<f;h++){var d=t.extentLayer[h],p=1===c?this._convertGeo2Geometry(d.geo):this._convertArray2Geometry(d.idxs,d.pts);d.geoArr=p.points,d.holes=p.holes,a.push(d)}for(var g=0,m=t.labelLayer.length;g<m;g++)i[t.labelLayer[g].eid]=t.labelLayer[g];for(var v=0,y=t.modelLayer.length;v<y;v++){var _=t.modelLayer[v],x=n.modelLayer[v],A={};A.fid=x.fid,A.eid=_.eid,A.pass=x.pass,A.center=(1===c?this._convertGeo2Geometry(i[_.eid].geo):this._convertArray2Geometry(i[_.eid].idxs,i[_.eid].pts)).points[0],x=null,x=1===c?this._convertGeo2Geometry(_.geo):this._convertArray2Geometry(_.idxs,_.pts),A.geoArr=x.points,A.holes=x.holes,o.push(A)}for(var I=0,w=r.naviNodes.length;I<w;I++){var b=r.naviNodes[I];b.geoArr=(1===c?this._convertGeo2Geometry(b.geo):this._convertArray2Geometry(b.idxs,b.pts)).points[0],b.linkSegArr=this._convertStringToArray(b.linkSeg),b.liftFloorArr=this._convertStringToArray(b.liftFloor),s.push(b)}for(var C=0,M=r.naviSegments.length;C<M;C++){var E=r.naviSegments[C];E.geoArr=(1===c?this._convertGeo2Geometry(E.geo):this._convertArray2Geometry(E.idxs,E.pts)).points,E.m_Id=r.mid,u.push(E)}if(r.naviZones){var T=0;for(M=r.naviZones.length;T<M;T++){var S=r.naviZones[T],L=1===c?this._convertGeo2Geometry(S.geo):this._convertArray2Geometry(S.idxs,S.pts);S.geoArr=L.points,S.holes=L.holes,S.m_Id=r.mid,l.push(S)}}return{gid:e,extentLayer:a,modelLayer:o,naviSegments:u,naviNodes:s,naviZones:l}}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(16),i=n(17),o=n(18),a=n(11),s=n(0);n(13),n(14);var u=n(1);s(t,"__esModule",{value:!0}),t.default=void 0;var l=u(n(35));n(8),n(62),n(55);var c=u(n(2)),h=u(n(3)),f=n(117),d=u(n(238)),p=u(n(424)),g=u(n(87)),m=n(250);function v(e,t){var n=void 0!==i&&e[o]||e["@@iterator"];if(!n){if(a(e)||(n=y(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw s}}}}function y(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(){function e(t,n){(0,c.default)(this,e),this.container=t.container,this.renderer=null,this.htmlrender=null,this.htmlscene=new fm.Scene,this._map=n,this._clearColor=16777215,this._clearAlpha=1,this._viewMode=n._viewMode,this._w=this.container.clientWidth,this._h=this.container.clientHeight,this._spriteRenderHeight=15,this._poiSpriteHeight=15,this._logarithmicDepthBuffer="boolean"==typeof t.logarithmicDepthBuffer&&t.logarithmicDepthBuffer,this.init(),this._envMap=null,this._renderList=[],this._showCompass=!1,this._compassNode=null,this._lineMarkerScene=new fm.Scene,this._backrenderScene=new fm.Scene,this.background=new fm.Scene,this._backrenderScene.userData.type="lastScene",this._firstRender=!1,this.particleEffect=null,this.isParticleEffect=!1,this.isSkyEffect=!1,this.SkyEffect=null,this.autoTime=!1,this._time=(new Date).getTime(),this._delTime=(new Date).getTime(),this._sweep={},this._sweep.startPoint=null,this._sweep.length=0,this._sweep.min=0,this._sweep.maxR=10,this._sweep.minR=0,this.reflectEffect=null,function(e,t){var n,r,i;g.default.d&&((r=g.default.d()).minFilter=fm.LinearFilter,r.generateMipmaps=!1,i=.4,n=new fm.Vector2(i,.12*i/.5),(i=new p.default).transparent=!0,i.uniforms.scale={value:n},e=-1*(.5*n.x/e-1),n=-1*(1-.5*n.y),i.uniforms.offset={value:new fm.Vector2(e,n)},i.uniforms.mmap={value:r},i.needsUpdate=!0,r=new d.default,(i=new fm.Mesh(r,i)).frustumCulled=!1,g.default[t.uuid].f=i)}(this._w/this._h,n)}return(0,h.default)(e,[{key:"getFrustumByViewMode",value:function(e){return(e="3d"===e?this.perspectiveCamera:this.orthographicCamera).updateMatrixWorld(!0),(new fm.Frustum).setFromProjectionMatrix((new fm.Matrix4).multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse))}},{key:"getScaleByPixels",value:function(e,t){return t/(e/2*this.domElementHeight)}},{key:"setBackground",value:function(e){this.background.background=(new fm.TextureLoader).load(e)}},{key:"setParticleEffect",value:function(e){this.particleEffect=e}},{key:"setSkyEffect",value:function(e){this.skyEffect=e}},{key:"setReflectEffect",value:function(e){this.reflectEffect=e}},{key:"resetCompass",value:function(){var e,t,n,r;this.compassNode&&(e=this.getAspect(),t=this.getScaleByPixels(1,this._map.MapOptions.compassSize),r=-this.getScaleByPixels(1,this._map.MapOptions.compassOffset[1]),n=this.getScaleByPixels(1,this._map.MapOptions.compassOffset[0])/e,r=this.getCompassOffset(this._map.MapOptions.compassPosition,t,e,n,r),this.compassNode.material.uniforms.scale={value:t},this.compassNode.material.uniforms.offset={value:new fm.Vector2(r.ox,r.oy)},this.compassNode.userData.coord={x:r.ox,y:r.oy},this.compassNode.userData.width=.5*t)}},{key:"getCompassOffset",value:function(e,t,n,r,i){var o=1,a=1;switch(e){case 3:o=-1;break;case 2:a=-1;break;case 4:a=-1,o=-1}return{ox:(n=o*(.5*t/n-1))+r,oy:(t=a*(1-.5*t))+i}}},{key:"resetLocationsSize",value:function(){var e,t=v(this.renderList);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("location"===n.userData.type){var r,i=v(n.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.setLocationSize(o,o.mapNode.size)}}catch(e){i.e(e)}finally{i.f()}}}}catch(e){t.e(e)}finally{t.f()}}},{key:"setLocationSize",value:function(e,t){var n;"3d"===this._viewMode?((n=new fm.Matrix4).multiplyMatrices(this.perspectiveCamera.matrixWorldInverse,e.matrixWorld),n=(new fm.Vector3).applyMatrix4(n),n=t/(this.container.clientHeight/(2*Math.tan(this.perspectiveCamera.fov*fm.Math.DEG2RAD/2)))*Math.abs(n.z),e.scale.set(n,n,n)):(t=t*Math.abs(this.orthographicCamera.top-this.orthographicCamera.bottom)/this.orthographicCamera.zoom/this.container.clientHeight,e.scale.set(t,t,t))}},{key:"setLabelSize",value:function(e,t){var n;"3d"===this._viewMode?(n=t/(this.container.clientHeight/(2*Math.tan(this.perspectiveCamera.fov*fm.Math.DEG2RAD/2))),isNaN(n)&&(n=1),e.scale.set(n,n,n)):(t=t*Math.abs(this.orthographicCamera.top-this.orthographicCamera.bottom)/this.orthographicCamera.zoom/this.container.clientHeight,isNaN(t)&&(t=1),e.scale.set(t,t,t)),e.scale.multiplyScalar(e.material.userData.mspriteScale),e.scale.setX(e.scale.x/e.material.userData.scaleRatio)}},{key:"setFacilitySize",value:function(e,t){var n=1;t="3d"===this._viewMode?t/(this.container.clientHeight/(2*Math.tan(this.perspectiveCamera.fov*fm.Math.DEG2RAD/2))):t*Math.abs(this.orthographicCamera.top-this.orthographicCamera.bottom)/this.orthographicCamera.zoom/this.container.clientHeight,e.material.userData.scaleRatio&&(n=e.material.userData.scaleRatio),e.scale.set(t,t/n,t)}},{key:"setImageMarkerSize",value:function(e){var t=1,n="3d"===this._viewMode?e.material.userData.size/(this.container.clientHeight/(2*Math.tan(this.perspectiveCamera.fov*fm.Math.DEG2RAD/2))):e.material.userData.size*Math.abs(this.orthographicCamera.top-this.orthographicCamera.bottom)/this.orthographicCamera.zoom/this.container.clientHeight;e.material&&(t=e.material.userData.scaleRatio),isNaN(t)&&(t=1),e.scale.set(n,n/t,n)}},{key:"parseGroup",value:function(e){var t=[],n=e._getLayers(!1);this.getShadowScene();var r,i=this.shadowscene.children;for(r in n){var o=n[r];if(!this.needshadow||"model"!==r&&"extent"!==r){var a,s=v(o);try{for(s.s();!(a=s.n()).done;){var u=a.value;u.renderOrder=f.LayerOrder[r],void 0===u.renderOrder&&(u.renderOrder=0),u.e_id=e.eid,t.push(u)}}catch(e){s.e(e)}finally{s.f()}}else{var l,c=v(o[0].children);try{for(c.s();!(l=c.n()).done;){var h=l.value;h instanceof fm.Mesh&&i.push(h)}}catch(e){c.e(e)}finally{c.f()}}}return this.needshadow&&(this.shadowscene.renderOrder=f.LayerOrder.model,t.push(this.shadowscene)),e.locationScene.renderOrder=f.LayerOrder.location,t.push(e.locationScene),e.lineScene.renderOrder=f.LayerOrder.line,t.push(e.lineScene),t}},{key:"getShadowScene",value:function(){this.shadowscene=new fm.Scene;var e=new fm.AmbientLight(7631988),t=new fm.Object3D,n=new fm.DirectionalLight(8947848,1.2);n.position.set(-1,1,1),n.target=t,n.castShadow=!0,n.shadow.camera=new fm.OrthographicCamera(-100,100,100,-100,.5,1e3),n.shadow.mapSize.width=720*window.devicePixelRatio,n.shadow.mapSize.height=610*window.devicePixelRatio;var r=new fm.DirectionalLight(3355443);r.position.set(-.5,1,-1).normalize(),r.target=t,this.shadowscene.add(n),this.shadowscene.add(e),this.shadowscene.add(r),this.shadowscene.add(t)}},{key:"parseList",value:function(e,t){var n=this,r=[];if(e){var i,o=v(e);try{for(o.s();!(i=o.n()).done;){var a,s=v(i.value);try{var u=function(){for(var e=a.value,t=n.parseGroup(e),i=[],o=0;o<t.length;o++)"model"===t[o].name||"dynmodel"===t[o].name?t[o].traverse((function(e){"oneModel"===e.name&&i.push(e)})):"extent"===t[o].name&&t[o].traverse((function(e){"oneExtent"===e.name&&i.push(e)}));for(var s=0;s<t.length;s++)if("waterMarker"===t[s].name){var u=!1;if(t[s].traverse((function(e){if(e instanceof fm.Mesh&&"water"===e.name)return u=!0})),u)for(var l=0;l<i.length;l++)t[s].add(i[l])}t.sort((function(e,t){return e.renderOrder-t.renderOrder})),r=r.concat(t)};for(s.s();!(a=s.n()).done;)u()}catch(e){s.e(e)}finally{s.f()}}}catch(e){o.e(e)}finally{o.f()}}return r}},{key:"setBackRender",value:function(e){this._backrenderScene.children=e}},{key:"init",value:function(){this.renderer=this._map.render,this.renderer.setClearColor(this._clearColor,this._clearAlpha);var e=this.container.clientWidth,t=this.container.clientHeight;return this.renderer.setSize(e,t),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=fm.PCFSoftShadowMap,this.renderer.autoClear=!1,this.canvas=this._map.canvas,this.container.appendChild(this.canvas),this.orthographicCamera=this._map.orthographicCamera,this.perspectiveCamera=this._map.perspectiveCamera,this.htmlrender=new m.CSS2DRenderer,this.htmlrender.setSize(e,t),this.htmlrender.domElement.style.top="0px",this.htmlrender.domElement.style.left="0px",this.htmlrender.domElement.style.position="absolute",this.htmlrender.domElement.style.pointerEvents="none",this.container.appendChild(this.htmlrender.domElement),!0}},{key:"getCameraByViewMode",value:function(e){return"3d"===e?this.perspectiveCamera:this.orthographicCamera}},{key:"getCurrentCamera",value:function(){return this.getCameraByViewMode(this._viewMode)}},{key:"resetSpriteSize",value:function(){var e,t=v(this.renderList);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("facility"===n.userData.type){var r,i=v(n.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.setFacilitySize(o,o.mapNode.size)}}catch(e){i.e(e)}finally{i.f()}}else if("label"===n.userData.type){var a,s=v(n.children);try{for(s.s();!(a=s.n()).done;){var u=a.value;this.setLabelSize(u,u.mapNode.size)}}catch(e){s.e(e)}finally{s.f()}}else if("imageMarker"===n.userData.type){var l,c=v(n.children);try{for(c.s();!(l=c.n()).done;){var h=l.value;this.setImageMarkerSize(h)}}catch(e){c.e(e)}finally{c.f()}}else if("textMarker"===n.userData.type){var f,d=v(n.children);try{for(d.s();!(f=d.n()).done;){var p=f.value;this.setLabelSize(p,p.mapNode.size)}}catch(e){d.e(e)}finally{d.f()}}}}catch(e){t.e(e)}finally{t.f()}}},{key:"getAspect",value:function(){return this._w/this._h}},{key:"resize",value:function(){this.renderer.setSize(this._w,this._h),this.perspectiveCamera.aspect=this._w/this._h,this.resizeWater(this._w/this._h),this.perspectiveCamera.updateProjectionMatrix(),this.orthographicCamera.left=-this._w/2,this.orthographicCamera.right=this._w/2,this.orthographicCamera.top=this._h/2,this.orthographicCamera.bottom=-this._h/2,this.orthographicCamera.updateProjectionMatrix(),this.htmlrender.setSize(this._w,this._h)}},{key:"resizeWater",value:function(e){var t;g.default[this._map.uuid].f&&(t=.4,t=new fm.Vector2(t,.12*t/.5),g.default[this._map.uuid].f.material.uniforms.scale={value:t},isNaN(e),e=-1*(.5*t.x/e-1),t=-1*(1-.5*t.y),g.default[this._map.uuid].f.material.uniforms.offset={value:new fm.Vector2(e,t)})}},{key:"resizeLine",value:function(){var e,t=v(this.renderList);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("line"===n.userData.type){var r,i=v(n.children);try{for(i.s();!(r=i.n()).done;)r.value.material.resolution.set(this.domElementWidth,this.domElementHeight)}catch(e){i.e(e)}finally{i.f()}}}}catch(e){t.e(e)}finally{t.f()}}},{key:"update",value:function(){var e=this;this._firstRender||(this._map.dispatchEvent({type:"firstRender"}),this._firstRender=!0),(5<Math.abs(this._w-this.container.clientWidth)||5<Math.abs(this._h-this.container.clientHeight))&&(this._w=this.container.clientWidth,this._h=this.container.clientHeight,this.resize(),this.resetSpriteSize(),this.resetLocationsSize(),this._map.updatePopsPosition(),this.resizeLine(),this.resetCompass());var t="3d"===this._viewMode?this.perspectiveCamera:this.orthographicCamera,n=this.renderList;if(n&&this.renderer){for(var r,i,o=0;o<n.length;o++){if("waterMarker"===n[o].name&&n[o].traverse((function(e){"water"===e.name&&(e.material.uniforms.time.value+=1/60)})),"flmMarker"===n[o].name)for(var a,s,u,l,c=0;c<n[o].children.length;c++)n[o].children[c].userData.frustumUpdate&&(this._map.nodeManager.checkNodeByFrustum(this._map.dataManager.getDecodeScene(this._map._currentSceneId),this._map.renderer.getFrustumByViewMode(this._map._viewMode),this._map.getVisibleGroups(),this._map.mapScaleLevel,this._map._currentSceneId),n[o].children[c].userData.frustumUpdate=!1),(new Date).getTime()-n[o].children[c].userData.time>20/n[o].children[c].userData.speed&&(s=(a=n[o].children[c].userData.colors).pop(),u=a.pop(),l=a.pop(),a.splice(0,0,s),a.splice(0,0,u),a.splice(0,0,l),n[o].children[c].geometry.setColors(a),n[o].children[c].userData.time=(new Date).getTime());var h=1;this._map._sweep.speed&&(h=this._map._sweep.speed),this._map.MapOptions.isNeedSweep&&(this._map._sweep.se2N&&function(){var t=((new Date).getTime()-e._time)/40*h,r=void(t=e._map._sweep.se2N.clone().multiplyScalar(t));e._sweep.startPoint||(e._sweep.startPoint=e._map._sweep.startPoint.clone()),e._sweep.length<=e._map._sweep.length?(r=e._sweep.startPoint.add(t),e._sweep.length+=t.length()):(e._sweep.startPoint=e._map._sweep.startPoint.clone(),r=e._map._sweep.startPoint,e._sweep.length=0),n[o].traverse((function(t){"isNeedSweep"===t.name&&(t.material.uniforms.moveP.value=r,t.material.uniforms.sweepW.value=e._map._sweep.width,t.material.uniforms.sweepH.value=e._map._sweep.height,t.material.uniforms.se2N.value=e._map._sweep.se2N,t.material.uniforms.se2RN.value=e._map._sweep.se2RN)}))}(),this._sweep.maxR<this._map._sweep.maxRadius?(this._sweep.maxR+=((new Date).getTime()-this._time)/40,this._sweep.minR+=((new Date).getTime()-this._time)/40):(this._sweep.maxR=this._map._sweep.minRadius+this._map._sweep.widthR,this._sweep.minR=this._map._sweep.minRadius),n[o].traverse((function(t){"isNeedSweep"===t.name&&(t.material.uniforms.maxR.value=e._sweep.maxR,t.material.uniforms.minR.value=e._sweep.minR)})))}if(this.renderer.clear(),this.renderer.clearDepth(),this._envMap&&this.renderer.render(this._envMap,t),null!==this.skyEffect&&this.isSkyEffect&&(this.skyEffect.render(t),this.autoTime&&(r=864e5,i=60*(i=new Date).getHours()*60*1e3+60*i.getMinutes()*1e3+1e3*i.getSeconds()+i.getMilliseconds(),r=2/r,i-=216e5,this.skyEffect._inclination=r*i,this.skyEffect._setPosition(this.skyEffect._inclination))),this.lightEffects)this.effectRender(t);else{void 0!==this.background.background&&this.renderer.render(this.background,t);var f=null;try{f=this._map.nodeManager._scenes[this._map._currentSceneId].groups[this._map.focusGroupID]._layers.extent[0]._scene.rotation.y}catch(t){}var d,p=v(n);try{for(p.s();!(d=p.n()).done;){var m=d.value;null!==f&&this.rotateLeft(f,m),this.renderer.render(m,t)}}catch(t){p.e(t)}finally{p.f()}null!==f&&this.rotateLeft(f,this.htmlscene),this.isHeatMap&&this.renderer.render(this.heatMapEffect._scene,t),t.layers.set(0),this._showCompass&&this._compassNode&&this.renderer.render(this._compassNode,t)}this.htmlrender.render(this.htmlscene,t),g.default[this._map.uuid].f&&this.renderer.render(g.default[this._map.uuid].f,t),null!==this.particleEffect&&this.isParticleEffect&&this.particleEffect.render(t),null!==this.reflectEffect&&this.reflectEffect.render(),this._time=(new Date).getTime()}}},{key:"rotateLeft",value:function(e,t){this._map.autoRotateBymodel&&!this._map.autoRotateBymodelPause&&(t.rotation.y=e,t.rotation.y-=2*Math.PI/60/60*this._map.autoRotateBymodelSpeed)}},{key:"setSceneNodeLayers",value:function(e,t){var n,r=v(e.children);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.mapNode&&!i.mapNode.picLoading&&i.layers.set(t)}}catch(e){r.e(e)}finally{r.f()}}},{key:"setClearColor",value:function(e,t){"string"==typeof e&&0<=e.indexOf("#")?this._clearColor=(0,l.default)(e.replace("#","0x")):this._clearColor=e,this._clearAlpha="number"==typeof t?t:1,this.renderer.setClearColor(this._clearColor,this._clearAlpha)}},{key:"setEnvMap",value:function(e){var t;e&&e.path&&e.format&&(t=e.path,e=e.format,e=(new fm.CubeTextureLoader).load([t+"px"+e,t+"nx"+e,t+"py"+e,t+"ny"+e,t+"pz"+e,t+"nz"+e]),this._envMap||(this._envMap=new fm.Scene),this._envMap.background=e)}},{key:"dispose",value:function(){this._envMap&&(this._envMap=void 0);var e=this.renderList;if(e){var t,n=v(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r){for(var i=r.children.length-1;-1<i;i--)r.remove(r.children[i]);r.children.length=0,r=void 0}}}catch(e){n.e(e)}finally{n.f()}}this._compassNode&&(this._compassNode.material.dispose(),this._compassNode.geometry.dispose());for(var o=this._lineMarkerScene.children.length-1;-1<o;o--)this._lineMarkerScene.remove(this._lineMarkerScene.children[o]);this._map=void 0,this.renderer.dispose(),this.renderer.forceContextLoss(),this.container.removeChild(this.canvas),this.canvas=void 0,this.renderer=void 0,this.container=void 0}},{key:"renderList",get:function(){return this._renderList},set:function(e){this._renderList=this.parseList(e,void 0)}},{key:"domElementHeight",get:function(){return this.container.clientHeight}},{key:"domElementWidth",get:function(){return this.container.clientWidth}},{key:"viewMode",set:function(e){this._viewMode=e}},{key:"showCompass",get:function(){return this._showCompass},set:function(e){this._showCompass=e}},{key:"compassNode",get:function(){return this._compassNode},set:function(e){this._compassNode=e}},{key:"lineMarkerScene",get:function(){return this._lineMarkerScene}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.CSS2DRenderer=t.CSS2DObject=void 0,r=i(n(34));var o=i(n(200)),a=n(75),s=function(e){a.Object3D.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))};t.CSS2DObject=s,(s.prototype=(0,r.default)(a.Object3D.prototype)).constructor=s,r=function(){var e,t,n,r,i=this,u=new a.Vector3,l=new a.Matrix4,c=new a.Matrix4,h={objects:new o.default},f=document.createElement("div");f.style.overflow="hidden",this.domElement=f,this.getSize=function(){return{width:e,height:t}},this.setSize=function(i,o){n=(e=i)/2,r=(t=o)/2,f.style.width=i+"px",f.style.height=o+"px"};var d,p,g=function e(t,o,a){var l,d;t instanceof s&&(t.onBeforeRender(i,o,a),u.setFromMatrixPosition(t.matrixWorld),u.applyMatrix4(c),l=t.element,d="translate(-50%,-50%) translate("+(u.x*n+n)+"px,"+(-u.y*r+r)+"px)",l.style.WebkitTransform=d,l.style.MozTransform=d,l.style.oTransform=d,l.style.transform=d,l.style.display=t.visible&&-1<=u.z&&u.z<=1?"":"none",d={distanceToCameraSquared:m(a,t)},h.objects.set(t,d),l.parentNode!==f&&f.appendChild(l),t.onAfterRender(i,o,a));for(var p=0,g=t.children.length;p<g;p++)e(t.children[p],o,a)},m=(d=new a.Vector3,p=new a.Vector3,function(e,t){return d.setFromMatrixPosition(e.matrixWorld),p.setFromMatrixPosition(t.matrixWorld),d.distanceToSquared(p)});this.render=function(e,t){!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),l.copy(t.matrixWorldInverse),c.multiplyMatrices(t.projectionMatrix,l),g(e,e,t)}},t.CSS2DRenderer=r},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={LEFT_TOP:1,LEFT_BOTTOM:2,RIGHT_TOP:3,RIGHT_BOTTOM:4},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.LineGeometry=void 0,n(32),r=i(n(19)),i=i(n(34));var o=n(253);n=function(){o.LineSegmentsGeometry.call(this),this.type="LineGeometry"},t.LineGeometry=n,n.prototype=(0,r.default)((0,i.default)(o.LineSegmentsGeometry.prototype),{constructor:n,isLineGeometry:!0,setPositions:function(e){for(var t=e.length-3,n=new Float32Array(2*t),r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return o.LineSegmentsGeometry.prototype.setPositions.call(this,n),this},setColors:function(e){for(var t=e.length-3,n=new Float32Array(2*t),r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return o.LineSegmentsGeometry.prototype.setColors.call(this,n),this},fromLine:function(e){return(e=e.geometry).isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.position.array),this},copy:function(){return this}})},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.LineSegmentsGeometry=void 0,n(32);var o,a,s=i(n(19)),u=(r=i(n(34)),i(n(11))),l=n(75);n=function(){l.InstancedBufferGeometry.call(this),this.type="LineSegmentsGeometry",this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new l.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new l.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))},t.LineSegmentsGeometry=n,n.prototype=(0,s.default)((0,r.default)(l.InstancedBufferGeometry.prototype),{constructor:n,isLineSegmentsGeometry:!0,applyMatrix:function(e){var t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.data.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},setPositions:function(e){e instanceof Float32Array?t=e:(0,u.default)(e)&&(t=new Float32Array(e));var t=new l.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceStart",new l.InterleavedBufferAttribute(t,3,0)),this.setAttribute("instanceEnd",new l.InterleavedBufferAttribute(t,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},setColors:function(e){e instanceof Float32Array?t=e:(0,u.default)(e)&&(t=new Float32Array(e));var t=new l.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceColorStart",new l.InterleavedBufferAttribute(t,3,0)),this.setAttribute("instanceColorEnd",new l.InterleavedBufferAttribute(t,3,3)),this},fromWireframeGeometry:function(e){return this.setPositions(e.attributes.position.array),this},fromEdgesGeometry:function(e){return this.setPositions(e.attributes.position.array),this},fromMesh:function(e){return this.fromWireframeGeometry(new l.WireframeGeometry(e.geometry)),this},fromLineSegements:function(e){return(e=e.geometry).isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.position.array),this},computeBoundingBox:(a=new l.Box3,function(){null===this.boundingBox&&(this.boundingBox=new l.Box3);var e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),a.setFromBufferAttribute(t),this.boundingBox.union(a))}),computeBoundingSphere:(o=new l.Vector3,function(){null===this.boundingSphere&&(this.boundingSphere=new l.Sphere),null===this.boundingBox&&this.computeBoundingBox();var e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){var n=this.boundingSphere.center;this.boundingBox.getCenter(n);for(var r=0,i=0,a=e.count;i<a;i++)o.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(o)),o.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(o));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}),toJSON:function(){}})},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={FULL:"full",DOTTED:"dotted",DOT_DASH:"dotDash",CENTER:"center",DASH:"dash",DOUBLE_DOT_DASH:"doubleDotDash",TRI_DOT_DASH:"triDotDash",NORMAL:"normal",ARROW:"arrow",RAW:"raw",FMARROW:"fmarrow",TEXTURE:"texture"},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(111));n=i(n(34)),fm.UniformsLib.line={linewidth:{value:1},resolution:{value:new fm.Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1},mmap:{value:null},offset:{value:new fm.Vector2(0,0)},repeat:{value:new fm.Vector2(1,1)},miny:{value:0},pcolor:{value:new fm.Color(11447982)}},fm.ShaderLib.line={uniforms:fm.UniformsUtils.merge([fm.UniformsLib.common,fm.UniformsLib.fog,fm.UniformsLib.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute float uvyStart;\n\t\tattribute float uvyEnd;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\t\tattribute vec2 uv2;\n\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec2 vUv2;\n\t\tvarying float uvScale;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\t\t\t\n\t\t\tfloat duvy = uvyEnd - uvyStart;\n\t\t\tfloat uvy = uvyStart + duvy * uv2.y;\n\t\t\t// vUv2 = vec2(uv2.x ,uvy);\n\t\t\tvUv2 = ( position.y < 0.5 ) ? vec2(uv2.x ,uvyStart) : vec2(uv2.x ,uvyEnd);\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tfloat scaleDir = length(dir);\n\t\t\tuvScale = 0.05/scaleDir;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform vec2 repeat;\n\t\tuniform vec2 offset;\n\t\tuniform float miny;\n\t\tuniform vec3 pcolor;\n\t\t\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\t\t\n\t\t\n\n\t\t\tuniform sampler2D mmap;\n\n\t\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying float uvScale;\n\t\tvarying vec2 vUv;\n\t\tvarying vec2 vUv2;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\t// if ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t// \tfloat a = vUv.x;\n\t\t\t// \tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t// \tfloat len2 = a * a + b * b;\n\n\t\t\t// \tif ( len2 > 1.0 ) discard;\n\n\t\t\t// }\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t\n\t\t\t#ifdef USE_MMAP\n\t\t\t\n\t\t\t\tif(vUv2.y>miny){\t\t\t\t\n\t\t\t\t\tdiffuseColor = texture2D( mmap, vUv2 * repeat + offset );\n\t\t\t\t}else{\n\t\t\t\t\tdiffuseColor = vec4(pcolor,1.0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t#endif\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\tgl_FragColor = diffuseColor;\n\n\t\t\t#include <premultiplied_alpha_fragment>\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\n\t\t}\n\t\t"},fm.LineMaterial=function(e){fm.ShaderMaterial.call(this,{type:"LineMaterial",uniforms:fm.UniformsUtils.clone(fm.ShaderLib.line.uniforms),vertexShader:fm.ShaderLib.line.vertexShader,fragmentShader:fm.ShaderLib.line.fragmentShader}),this.dashed=!1,(0,o.default)(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}}}),this.setValues(e)},fm.LineMaterial.prototype=(0,n.default)(fm.ShaderMaterial.prototype),fm.LineMaterial.prototype.constructor=fm.LineMaterial,fm.LineMaterial.prototype.isLineMaterial=!0,fm.LineMaterial.prototype.copy=function(e){return fm.ShaderMaterial.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.resolution=e.resolution,this},n=fm.LineMaterial,t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(32);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=o(n(257));n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this)).type="LineGeometry",e.isLineGeometry=!0,e}return(0,s.default)(n,[{key:"setPositions",value:function(e){for(var t=e.length-3,n=new Float32Array(2*t),r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return this.test="ddd",(new h.default).setPositions.call(this,n),this}},{key:"setColors",value:function(e){for(var t=e.length-3,n=new Float32Array(2*t),r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return(new h.default).setColors.call(this,n),this}},{key:"fromLine",value:function(e){return(e=e.geometry).isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.position.array),this}},{key:"copy",value:function(e){return this}}]),n}(h.default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(11));n(32);var s=o(n(2)),u=o(n(3)),l=o(n(5)),c=o(n(6)),h=o(n(7));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.default)(e);return i=t?(n=(0,h.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,c.default)(this,i)}}n=function(e){(0,l.default)(n,e);var t=f(n);function n(){var e;return(0,s.default)(this,n),(e=t.call(this)).type="LineSegmentsGeometry",new fm.BufferGeometry,e.isLineSegmentsGeometry=!0,e.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),e.setAttribute("position",new fm.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),e.setAttribute("uv",new fm.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2)),e.setAttribute("uv2",new fm.Float32BufferAttribute([0,0,1,0,0,1/3,1,1/3,0,2/3,1,2/3,0,1,1,1],2)),e}return(0,u.default)(n,[{key:"applyMatrix",value:function(e){var t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(e.applyToBufferAttribute(t),e.applyToBufferAttribute(n),t.data.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"setPositions",value:function(e){e instanceof Float32Array?t=e:(0,a.default)(e)&&(t=new Float32Array(e));var t=new fm.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceStart",new fm.InterleavedBufferAttribute(t,3,0)),this.setAttribute("instanceEnd",new fm.InterleavedBufferAttribute(t,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}},{key:"setColors",value:function(e){e instanceof Float32Array?t=e:(0,a.default)(e)&&(t=new Float32Array(e));var t=new fm.InstancedInterleavedBuffer(t,6,1);return this.addAttribute("instanceColorStart",new fm.InterleavedBufferAttribute(t,3,0)),this.addAttribute("instanceColorEnd",new fm.InterleavedBufferAttribute(t,3,3)),this}},{key:"setUvys",value:function(e){e instanceof Float32Array?t=e:(0,a.default)(e)&&(t=new Float32Array(e));var t=new fm.InstancedInterleavedBuffer(t,2,1);return this.setAttribute("uvyStart",new fm.InterleavedBufferAttribute(t,1,0)),this.setAttribute("uvyEnd",new fm.InterleavedBufferAttribute(t,1,1)),this}},{key:"fromWireframeGeometry",value:function(e){return this.setPositions(e.attributes.position.array),this}},{key:"fromEdgesGeometry",value:function(e){return this.setPositions(e.attributes.position.array),this}},{key:"fromMesh",value:function(e){return this.fromWireframeGeometry(new fm.WireframeGeometry(e.geometry)),this}},{key:"fromLineSegements",value:function(e){return(e=e.geometry).isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.position.array),this}},{key:"computeBoundingBox",value:function(){var e=new fm.Box3;null===this.boundingBox&&(this.boundingBox=new fm.Box3);var t=this.attributes.instanceStart,n=this.attributes.instanceEnd;void 0!==t&&void 0!==n&&(this.boundingBox.setFromBufferAttribute(t),e.setFromBufferAttribute(n),this.boundingBox.union(e))}},{key:"computeBoundingSphere",value:function(){var e=new fm.Vector3;null===this.boundingSphere&&(this.boundingSphere=new fm.Sphere),null===this.boundingBox&&this.computeBoundingBox();var t=this.attributes.instanceStart,n=this.attributes.instanceEnd;if(void 0!==t&&void 0!==n){var r=this.boundingSphere.center;this.boundingBox.getCenter(r);for(var i=0,o=0,a=t.count;o<a;o++)e.fromBufferAttribute(t,o),i=Math.max(i,r.distanceToSquared(e)),e.fromBufferAttribute(n,o),i=Math.max(i,r.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("fm.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}},{key:"toJSON",value:function(){}},{key:"clone",value:function(){}},{key:"copy",value:function(e){return this}}]),n}(fm.InstancedBufferGeometry),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(48)),a=i(n(2)),s=i(n(3)),u=i(n(233)),l=i(n(50));n=function(){function e(t){(0,a.default)(this,e),this._points=t||null,this._groupId=0,this._lineDis=[],this._linePoints=null,this._screenPoints=[],this._screenDis=[],this._radiusPoint=[],this._radiuInit=!1,this._uvys=null,this._minRadius=1,this.needSmooth=!0}return(0,s.default)(e,[{key:"initSegement",value:function(e,t){"number"!=typeof t&&(t=this._minRadius),this._linePoints=this.pointsToLinePnts(e,t),this._uvys=this.computerUVY()}},{key:"pointsToRadius",value:function(e){for(var t,n,r=[],i=new u.default,a=0;a<this._points.length;a++)0<a&&a<this._points.length-1?(n=l.default.distanceOfTwoPoints(r[r.length-1],this._points[a]),(t=.5*((t=l.default.distanceOfTwoPoints(this._points[a],this._points[a+1]))<n?t:n))<(n=e)&&(n=t),r.push.apply(r,(0,o.default)(i.computerArcLineByPoints(r[r.length-1],this._points[a],this._points[a+1],n||1,12)))):r.push(this._points[a]);this._radiusPoint=r,this._radiuInit=!0}},{key:"pointsToLinePnts",value:function(e,t){this.needSmooth?this._radiuInit||this.pointsToRadius(t):((t=[]).push.apply(t,(0,o.default)(this._points)),this._radiusPoint=t);for(var n=[],r=0;r<this._radiusPoint.length;r++){var i=this._radiusPoint[r].x-e.x,a=this._radiusPoint[r].z,s=-this._radiusPoint[r].y+e.y;n.push(i,a,s),0!==r&&(a=new fm.Vector3(this._radiusPoint[r].x,this._radiusPoint[r].y,this._radiusPoint[r].z),s=new fm.Vector3(this._radiusPoint[r-1].x,this._radiusPoint[r-1].y,this._radiusPoint[r-1].z),this._lineDis.push(a.distanceTo(s)))}return n}},{key:"getIndexDis",value:function(e){for(var t=0,n=0;n<this._lineDis.length;n++)n<e&&(t+=this._lineDis[n]);return t}},{key:"computerUVY",value:function(){for(var e,t=[],n=this.getIndexDis(this._lineDis.length),r=0;r<this._radiusPoint.length;r++)0===r?t.push(0):r===this._radiusPoint.length-1?t.push(1):(e=this.getIndexDis(r)/n,t.push(e),t.push(e));return t}},{key:"computeScreenCoord",value:function(e,t,n,r){for(var i=[],o=0,a=[],s=e.matrixWorldInverse,u=0;u<this._linePoints.length;u+=3){var l=this._linePoints[u],c=this._linePoints[u+1],h=this._linePoints[u+2];(h=(h=new fm.Vector3(l+r.x,c+r.y,h+r.z)).applyMatrix4(s)).z,e.near,h=h.applyMatrix4(e.projectionMatrix),h=new fm.Vector2(t/2+t/2*h.x,n/2-n/2*h.y),i.push(h),2<u&&(o+=h=h.distanceTo(i[Math.round(u/3)-1]),a.push(h))}return this._screenPoints=i,this._screenDis=a,o}},{key:"_calcMinRadius",value:function(){if(this.points){this._minRadius=1;for(var e=0;e<this._points.length-1;e++){var t=this._points[e],n=this._points[e+1];n=.368*l.default.distanceOfTwoPoints(t,n),this._minRadius>n&&(this._minRadius=n)}}}},{key:"points",get:function(){return this._points},set:function(e){this._points=e}},{key:"groupId",get:function(){return this._groupId},set:function(e){this._groupId=e}},{key:"allLength",get:function(){return this.getIndexDis(this._lineDis.length)}},{key:"linePoints",get:function(){return this._linePoints}},{key:"uvys",get:function(){return this._uvys}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(59);var o=(n=i(n(442))).default;function a(e,t){return t.max-e.max}function s(e,t,n,r){this.x=e,this.y=t,this.h=n,this.d=function(e,t,n){for(var r=!1,i=1/0,o=0;o<n.length;o++)for(var a=n[o],s=0,l=a.length,c=l-1;s<l;c=s++){var h=a[s],f=a[c];h[1]>t!=f[1]>t&&e<(f[0]-h[0])*(t-h[1])/(f[1]-h[1])+h[0]&&(r=!r),i=Math.min(i,u(e,t,h,f))}return(r?1:-1)*Math.sqrt(i)}(e,t,r),this.max=this.d+this.h*Math.SQRT2}function u(e,t,n,r){var i=n[0],o=n[1],a=r[0]-i,s=r[1]-o,u=i;return n=o,0===a&&0===s||(1<(o=((e-i)*a+(t-o)*s)/(a*a+s*s))?(u=r[0],n=r[1]):0<o&&(u+=a*o,n+=s*o)),(a=e-u)*a+(s=t-n)*s}n=function(e,t){t=t||1;for(var n=Number.MAX_VALUE,r=Number.MAX_VALUE,i=Number.MIN_VALUE,u=Number.MIN_VALUE,l=0;l<e[0].length;l++){var c=e[0][l];c[0]<n&&(n=c[0]),c[1]<r&&(r=c[1]),c[0]>i&&(i=c[0]),c[1]>u&&(u=c[1])}var h=i-n,f=u-r,d=Math.min(h,f),p=d/2;if(0===d)return[n,r];for(var g=new o(void 0,a),m=n;m<i;m+=d)for(var v=r;v<u;v+=d)g.push(new s(m+p,v+p,p,e));var y=function(e){for(var t=0,n=0,r=0,i=e[0],o=0,a=i.length,u=a-1;o<a;u=o++){var l=i[o],c=i[u],h=l[0]*c[1]-c[0]*l[1];n+=(l[0]+c[0])*h,r+=(l[1]+c[1])*h,t+=3*h}return 0===t?new s(i[0][0],i[0][1],0,e):new s(n/t,r/t,0,e)}(e);for((f=new s(n+h/2,r+f/2,0,e)).d>y.d&&(y=f),g.length;0<g.length;){var _=g.pop();_.d>y.d&&(y=_),_.max-y.d<=t||(p=_.h/2,g.push(new s(_.x-p,_.y-p,p,e)),g.push(new s(_.x+p,_.y-p,p,e)),g.push(new s(_.x-p,_.y+p,p,e)),g.push(new s(_.x+p,_.y+p,p,e)))}return[y.x,y.y]},t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7));n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(e,r){return(0,a.default)(this,n),(r=t.call(this,e,r))._renderNode=null,r._isInit=!1,r}return(0,s.default)(n,[{key:"init",value:function(){}},{key:"dispose",value:function(){this._renderNode&&(this._renderNode.material.dispose(),this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.geometry=void 0,this._geometry=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0)}},{key:"renderNode",get:function(){return this._renderNode}},{key:"isInit",get:function(){return this._isInit}}]),n}((n=o(n(10))).default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(19)),s=o(n(2)),u=o(n(3)),l=o(n(5)),c=o(n(6)),h=o(n(7)),f=o(n(50)),d=o(n(259)),p=(i=o(n(260)),o(n(446))),g=o(n(120));function m(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.default)(e);return i=t?(n=(0,h.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,c.default)(this,i)}}i=function(e){(0,l.default)(n,e);var t=m(n);function n(e,r,i){return(0,s.default)(this,n),(r=t.call(this,e,r))._alpha=void 0!==i.alpha?i.alpha:1,r._color=void 0!==i.color?i.color:"#FF0000",r._height=void 0!==i.height?i.height:1,r._lineColor=i.lineColor||i.color||"#FF0000",r._points=[],r.position={x:0,y:0},r._points.type?(r._points=void 0!==i.points?(0,a.default)(i.points):[],"rectangle"===r._points.type&&r._points.startPoint&&r._points.startPoint.x&&r._points.startPoint.y?(r.position.x=r._points.startPoint.x+r._points.width/2,r.position.y=r._points.startPoint.y-r._points.height/2):(r.position.x=r._points.center.x,r.position.y=r._points.center.y)):r._points.constructor===Array&&(void 0!==i.points&&(0,a.default)(r._points,i.points),g.default.closedPoints(r._points),p.default.polygonArea(r._points)<0&&r._points.reverse()),r._edgesLine=null,r}return(0,u.default)(n,[{key:"contain",value:function(e){if(!this._points)return!1;if(!this.parent)return!1;if(!this.parent.parent)return!1;if("circle"===this._points.type){if(Math.sqrt((e.x-this.position.x)*(e.x-this.position.x)+(e.y-this.position.y)*(e.y-this.position.y))<this._points.r)return!0}else{if("rectangle"!==this._points.type)return f.default.pointInPolygon2d(this._points,e,this._points.length);if(Math.abs(e.x-this.position.x)<this._points.width/2&&Math.abs(e.y-this.position.y)<this._points.height/2)return!0}return!1}},{key:"setColor",value:function(e){this._renderNode.material.color=new fm.Color(e),this._color=e}},{key:"setAlpha",value:function(e){this._renderNode.material.opacity=e,this._alpha=e}},{key:"setLineColor",value:function(e){this._edgesLine.material.color=new fm.Color(e)}},{key:"center",get:function(){for(var e=this.parent.parent,t=(e.parent.mapcenter,[]),n=0;n<this._linePoints.length;n+=3)t.push([this._linePoints[n],this._linePoints[n+1]]);return e=null,e=(0,d.default)([t],.01),"circle"!=this._points.type&&"rectangle"!=this._points.type?{x:this.position.x+e[0],y:this.position.y-e[1],z:this._height}:{x:this.position.x+e[0],y:this.position.y+e[1],z:this._height}}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(8);var o=i(n(2));n=function e(){(0,o.default)(this,e),this.circle,this.polygon,this.eName,this.FID,this.groupID,this.ID,this.keyword,this.name,this.typeID,this.nodeType,this.startPoint,this.pathPoints,this.bufferRadius},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(35)),a=i(n(11)),s=i(n(25));n(8),n(14),n(108),n(9),n(21);var u=i(n(2)),l=i(n(3));n=function(){function e(t){(0,u.default)(this,e),this._data=t,this.Graphics=new fengmap.inner.Graphics}return(0,l.default)(e,[{key:"check2",value:function(e,t,n,r,i,u,l){var c,h,f="",d="",p="";n.name&&(f=n.name),n.eName&&(d=n.eName),n.keyword&&(p=n.keyword),n.circle&&(c=n.circle),n.polygon&&(h=2<n.polygon.length?new SearchPolygon(n.polygon,!0):null);var g=e.name,m=e.ename,v=e.type,y=void 0===n.typeID||!(!n.typeID||!v)&&-1<(y="number"==typeof n.typeID?[n.typeID]:n.typeID).indexOf((0,o.default)(v));if(v=!1,m&&d&&-1<m.toLowerCase().indexOf(d.toLowerCase())&&(v=!0),m&&p&&-1<m.toLowerCase().indexOf(p.toLowerCase())&&(v=!0),g&&p&&-1<g.toLowerCase().indexOf(p.toLowerCase())&&(v=!0),g&&f&&-1<g.toLowerCase().indexOf(f.toLowerCase())&&(v=!0),p||d||f||(v=!0),x=void 0===n.FID||!(!e.fid||!n.FID)&&(x=n.FID,x=(0,a.default)(x)?x.map((function(e){return e.toString()})):[x.toString()],-1<x.indexOf(e.fid.toString())),_=void 0===n.ID||!(!e.eid||!n.ID)&&(_=n.ID,(0,a.default)(_)?fids=fids.map((function(e){return e.toString()})):_=[_.toString()],-1<_.indexOf(e.eid.toString())),x=v&&y&&x&&_){if(c){var _=t.geo;"model"===r&&i&&(_=i);var x=_.substring(6,_.length-1).split(" "),A=(_=(0,s.default)(x[0]),x=(0,s.default)(x[1]),c.center),I=Math.sqrt((_-A.x)*(_-A.x)+(x-A.y)*(x-A.y));if(I<c.radius)return l&&(l.distance=I),!0;if("model"==r){var w=null,b=this._map.getFMGroup(u).getNodeByLayerId("model",e.eid);l.target=b,b&&b._data&&(w=b._data.vertices),null==w&&(w=DataManager.convertGeo2Geometry(t.geo).vertices);for(var C=w.length/2,M=0;M<C-1;M++){var E=2*M;if(Graphics.pointDistanceToLine(A,{x:w[E],y:w[E+1]},{x:w[E+2],y:w[E+3]},{})<c.radius)return l&&(l.distance=I),!0}if(Graphics.pointInPolygonVector2d(w,A,w.length))return l.distance=I,!0}return!1}if(!h)return!0;if(b=t.geo,"model"===r&&i&&(b=i),b=b.substring(6,b.length-1).split(" "),b={x:(0,s.default)(b[0]),y:(0,s.default)(b[1])},h.contain(b))return l.distance=h.distanceToPoint(b),!0;if("model"==r&&(r=null,e=this._map.getFMGroup(u).getNodeByLayerId("model",e.eid),l.target=e,e&&e._data&&(r=e._data.vertices),null==r&&(r=DataManager.convertGeo2Geometry(t.geo).vertices),h.containXYArray(r)))return l.distance=h.distanceToPoint(b),!0}return!1}},{key:"check",value:function(e,t,n,r,i,o){if(void 0!==n.FID&&n.FID!==e.fid)return!1;if(void 0!==n.groupID&&""+n.groupID!=""+o)return!1;if(void 0!==n.ID&&n.ID!==e.eid)return!1;if(void 0!==n.name&&n.name!==e.name)return!1;if(void 0!==n.eName&&n.eName!==e.ename)return!1;if(void 0!==n.typeID)if(n.typeID instanceof Array){if(-1===n.typeID.indexOf(e.type))return!1}else if(n.typeID!==e.type)return!1;if(void 0!==n.keyword)if(e.name&&e.ename){if(e.name.toLowerCase().indexOf(n.keyword.toLowerCase())<0&&e.ename&&e.ename.toLowerCase().indexOf(n.keyword.toLowerCase())<0)return!1}else if(e.name&&!e.ename){if(e.name.toLowerCase().indexOf(n.keyword.toLowerCase())<0)return!1}else if(!e.name&&e.ename){if(e.ename.toLowerCase().indexOf(n.keyword.toLowerCase())<0)return!1}else if(!e.name&&!e.ename)return!1;return!0}},{key:"everyModel",value:function(e,t){for(var n=e.biz[0].modelLayer.length,r=0;r<n;r++)t(e.biz[0].modelLayer[r],e.geo[0].modelLayer[r],"model",e.geo[0].labelLayer[r])}},{key:"everyExternalModel",value:function(e,t){var n=e.biz[0].externalModelLayer.length,r=e.geo[0].externalModelLayer.length;e.geo[0].labelLayer.length,r<n&&(n=r);for(var i=0;i<n;i++)e.gid,t(e.biz[0].externalModelLayer[i],e.geo[0].externalModelLayer[i],"externalModel",e.geo[0].externalModelLayer[i])}},{key:"everyFacility",value:function(e,t){for(var n=e.biz[0].poiLayer.length,r=0;r<n;r++)t(e.biz[0].poiLayer[r],e.geo[0].poiLayer[r],"poi")}},{key:"everyLabel",value:function(e,t){for(var n=e.biz[0].labelLayer.length,r=0;r<n;r++)t(e.biz[0].labelLayer[r],e.geo[0].labelLayer[r],"label")}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2));n=function e(t){(0,o.default)(this,e),this._data=t},t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(5)),u=o(n(6)),l=o(n(7));n=function(e){(0,s.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}(n);function n(e,r){return(0,a.default)(this,n),(e=t.call(this,e))._map=r,e.Graphics=fengmap.inner.Graphics,e}return n}((n=o(n(264))).default),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(269),n(372),n(374),n(375);var o=i(n(209)),a=i(n(119)),s=i(n(220)),u=i(n(251)),l=(i(n(428)),i(n(28))),c=(i(n(160)),i(n(431))),h=i(n(227)),f=i(n(223)),d=i(n(225)),p=i(n(432)),g=i(n(433)),m=(i(n(434)),i(n(236)),i(n(437))),v=i(n(254)),y=i(n(163)),_=i(n(258)),x=i(n(441)),A=i(n(443)),I=i(n(447)),w=i(n(228)),b=i(n(229)),C=i(n(237)),M=i(n(246)),E=i(n(235)),T=i(n(232)),S=i(n(231)),L=i(n(234)),k=i(n(449)),R=i(n(450)),N=i(n(451)),P=i(n(262)),O=i(n(461)),D=i(n(462)),F=i(n(463)),B=i(n(464)),G=i(n(86)),z=i(n(213)),U=i(n(465)),V=i(n(466)),H=i(n(224)),j=i(n(222)),W=i(n(226)),Y=i(n(221)),q=i(n(219)),X=i(n(10)),Z=i(n(467)),J=i(n(247)),K=i(n(468)),Q=i(n(244)),$=i(n(161)),ee=i(n(249)),te=i(n(50)),ne=i(n(245)),re=i(n(49)),ie=i(n(65)),oe=i(n(163)),ae=i(n(469)),se=i(n(248)),ue=i(n(470)),le=n(117);r=i(n(471)),i=i(n(472)),n(473),ue={VERSION:Q.default.VERSION,BUILD:Q.default.BUILD,Map:o.default,FMMap:o.default,MapUtil:a.default,controlPositon:u.default,FMControlPosition:u.default,FMViewMode:B.default,FMDynamicModel:M.default,FMNewDomMarker:p.default,FMDynamicModelLayer:E.default,FMLanguageType:G.default,FMNodeType:l.default,FMImageMarker:c.default,FMTextMarker:g.default,FMLocationMarker:m.default,FMLineMarker:y.default,FMExtentLayer:s.default,FMSegment:_.default,FMPolygonMarker:x.default,FMGradientPolygonMarker:A.default,FMExtrudeMarker:I.default,FMPolygonMarkerLayer:w.default,FMGradientPolygonMarkerLayer:b.default,FMExtrudeMarkerLayer:C.default,FMImageMarkerLayer:h.default,FMLabelLayer:f.default,FMFacilityLayer:d.default,FMHeatMapLayer:T.default,FMHeatMap:R.default,FMSearchRequest:P.default,FMSearchAnalyser:N.default,FMLineType:v.default,FMNaviModule:O.default,FMNaviMode:O.default,FMTextAlign:D.default,FMNaviPriority:F.default,FMRouteCalcuResult:U.default,FMMapCoord:V.default,FMGroup:q.default,FMLabel:H.default,FMStoreModel:j.default,FMElement:Y.default,FMExternalModel:Y.default,FMFacility:W.default,FMNode:X.default,FMDirection:z.default,FMScreenCoord:Z.default,FMMapGestureEnableController:J.default,FMTextMarkerLayer:S.default,FMDomMarkerLayer:L.default,FMDomMarker:k.default,FMMapCoordTransformer:K.default,MapCoordTransform:K.default,FMMarkerAnchor:$.default,FMLayerOrder:le.LayerOrder,FMRenderer:ee.default,Weixin:i.default,FMCalculator:r.default,inner:{Graphics:te.default,FMSegment:_.default,FMNaviMode:O.default,FMNaviPriority:F.default,FMRouteCalcuResult:U.default,EventDispatcher:ne.default,DataManager:re.default,FMUtil:ie.default,FMImageMarker:c.default,FMLineMarker:oe.default,FMLocationMarker:m.default,FMLanguageType:G.default,NaviDataType:ae.default,NaviService:se.default,FMMapCoord:V.default,BoundingBox:ue.default}},window.fm=fm,window.fengmap=ue,window.weixin_Mini=i.default,t.default=ue},function(e,t,n){n(268);var r=n(12).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(15);r(r.S+r.F*!n(33),"Object",{defineProperty:n(36).f})},function(e,t,n){(function(t){e.exports=t.fm=n(75)}).call(this,n(165))},function(e,t,n){n(271),e.exports=n(12).Reflect.construct},function(e,t,n){var r=n(15),i=n(76),o=n(56),a=n(37),s=n(22),u=n(43),l=n(274),c=(n(20).Reflect||{}).construct,h=u((function(){function e(){}return!(c((function(){}),[],e)instanceof e)})),f=!u((function(){c((function(){}))}));r(r.S+r.F*(h||f),"Reflect",{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(f&&!h)return c(e,t,n);if(e!=n)return r=n.prototype,n=i(s(r)?r:Object.prototype),r=Function.apply.call(e,n,t),s(r)?r:n;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(l.apply(e,r))}})},function(e,t,n){var r=n(67),i=n(90),o=n(273);e.exports=function(e){return function(t,n,a){var s,u=r(t),l=i(u.length),c=o(a,l);if(e&&n!=n){for(;c<l;)if((s=u[c++])!=s)return!0}else for(;c<l;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(124),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){"use strict";var r=n(56),i=n(22),o=n(169),a=[].slice,s={};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),u=function r(){var i=n.concat(a.call(arguments));return this instanceof r?function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)}(t,i.length,i):o(t,i,e)};return i(t.prototype)&&(u.prototype=t.prototype),u}},function(e,t,n){n(276),n(93),n(279),n(280),e.exports=n(12).Symbol},function(e,t,n){"use strict";var r=n(20),i=n(52),o=n(33),a=n(15),u=n(128),l=n(68).KEY,c=n(43),h=n(126),f=n(80),d=n(91),p=n(29),g=n(129),m=n(130),v=n(277),y=n(132),_=n(37),x=n(22),A=n(57),I=n(67),w=n(122),b=n(74),C=n(76),M=n(278),E=n(171),T=n(131),S=n(36),L=n(77),k=E.f,R=S.f,N=M.f,P=r.Symbol,O=r.JSON,D=O&&O.stringify,F="prototype",B=p("_hidden"),G=p("toPrimitive"),z={}.propertyIsEnumerable,U=h("symbol-registry"),V=h("symbols"),H=h("op-symbols"),j=Object[F],W="function"==typeof P&&!!T.f,Y=!(ee=r.QObject)||!ee[F]||!ee[F].findChild,q=o&&c((function(){return 7!=C(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=k(j,t);r&&delete j[t],R(e,t,n),r&&e!==j&&R(j,t,r)}:R,X=function(e){var t=V[e]=C(P[F]);return t._k=e,t},Z=W&&"symbol"==s(P.iterator)?function(e){return"symbol"==s(e)}:function(e){return e instanceof P},J=function e(t,n,r){return t===j&&e(H,n,r),_(t),n=w(n,!0),_(r),i(V,n)?(r.enumerable?(i(t,B)&&t[B][n]&&(t[B][n]=!1),r=C(r,{enumerable:b(0,!1)})):(i(t,B)||R(t,B,b(1,{})),t[B][n]=!0),q(t,n,r)):R(t,n,r)},K=function(e,t){_(e);for(var n,r=v(t=I(t)),i=0,o=r.length;i<o;)J(e,n=r[i++],t[n]);return e},Q=function(e){var t=z.call(this,e=w(e,!0));return!(this===j&&i(V,e)&&!i(H,e))&&(!(t||!i(this,e)||!i(V,e)||i(this,B)&&this[B][e])||t)},$=function(e,t){if(e=I(e),t=w(t,!0),e!==j||!i(V,t)||i(H,t)){var n=k(e,t);return!n||!i(V,t)||i(e,B)&&e[B][t]||(n.enumerable=!0),n}},ee=(h=function(e){for(var t,n=N(I(e)),r=[],o=0;n.length>o;)i(V,t=n[o++])||t==B||t==l||r.push(t);return r},function(e){for(var t,n=e===j,r=N(n?H:I(e)),o=[],a=0;r.length>a;)!i(V,t=r[a++])||n&&!i(j,t)||o.push(V[t]);return o});W||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=d(0<arguments.length?arguments[0]:void 0);return o&&Y&&q(j,e,{configurable:!0,set:function t(n){this===j&&t.call(H,n),i(this,B)&&i(this[B],e)&&(this[B][e]=!1),q(this,e,b(1,n))}}),X(e)},u(P[F],"toString",(function(){return this._k})),E.f=$,S.f=J,n(170).f=M.f=h,n(92).f=Q,T.f=ee,o&&!n(79)&&u(j,"propertyIsEnumerable",Q,!0),g.f=function(e){return X(p(e))}),a(a.G+a.W+a.F*!W,{Symbol:P});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)p(te[ne++]);for(var re=L(p.store),ie=0;re.length>ie;)m(re[ie++]);a(a.S+a.F*!W,"Symbol",{for:function(e){return i(U,e+="")?U[e]:U[e]=P(e)},keyFor:function(e){if(!Z(e))throw TypeError(e+" is not a symbol!");for(var t in U)if(U[t]===e)return t},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),a(a.S+a.F*!W,"Object",{create:function(e,t){return void 0===t?C(e):K(C(e),t)},defineProperty:J,defineProperties:K,getOwnPropertyDescriptor:$,getOwnPropertyNames:h,getOwnPropertySymbols:ee}),ee=c((function(){T.f(1)})),a(a.S+a.F*ee,"Object",{getOwnPropertySymbols:function(e){return T.f(A(e))}}),O&&a(a.S+a.F*(!W||c((function(){var e=P();return"[null]"!=D([e])||"{}"!=D({a:e})||"{}"!=D(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;i<arguments.length;)r.push(arguments[i++]);if(n=t=r[1],(x(t)||void 0!==e)&&!Z(e))return y(t)||(t=function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Z(t))return t}))),r[1]=t,D.apply(O,r)}}),P[F][G]||n(51)(P[F],G,P[F].valueOf),f(P,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(e,t,n){var r=n(77),i=n(131),o=n(92);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,s=n(e),u=o.f,l=0;s.length>l;)u.call(e,a=s[l++])&&t.push(a);return t}},function(e,t,n){var r=n(67),i=n(170).f,o={}.toString,a="object"==("undefined"==typeof window?"undefined":s(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t,n){n(130)("asyncIterator")},function(e,t,n){n(130)("observable")},function(e,t,n){n(94),n(95),e.exports=n(129).f("iterator")},function(e,t,n){var r=n(124),i=n(89);e.exports=function(e){return function(t,n){var o,a=String(i(t)),s=r(n);return t=a.length,s<0||t<=s?e?"":void 0:(n=a.charCodeAt(s))<55296||56319<n||s+1===t||(o=a.charCodeAt(s+1))<56320||57343<o?e?a.charAt(s):n:e?a.slice(s,s+2):o-56320+(n-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(76),i=n(74),o=n(80),a={};n(51)(a,n(29)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){"use strict";var r=n(285),i=n(173),o=n(81),a=n(67);e.exports=n(133)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t,n){n(287);var r=n(12).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){var r=n(15);r(r.S,"Object",{create:n(76)})},function(e,t,n){var r=n(175);function i(t,n){return e.exports=i=r||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,i(t,n)}e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){n(290),e.exports=n(12).Object.setPrototypeOf},function(e,t,n){var r=n(15);r(r.S,"Object",{setPrototypeOf:n(291).set})},function(e,t,n){var r=n(22),i=n(37),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(42)(Function.call,n(171).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){e.exports=n(293)},function(e,t,n){n(294),e.exports=n(12).Object.getPrototypeOf},function(e,t,n){var r=n(57),i=n(172);n(134)("getPrototypeOf",(function(){return function(e){return i(r(e))}}))},function(e,t,n){(n=n(23))(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){e.exports=n(135)("native-function-to-string",Function.toString)},function(e,t,n){var r=n(44),i=n(38),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(100)(Function.call,n(137).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){var r=n(23),i=n(60),o=n(26),a=n(299),s=(n="["+a+"]",RegExp("^"+n+n+"*")),u=RegExp(n+n+"*$"),l=(n=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()}));t=i[e]=s?t(l):a[e],n&&(i[n]=t),r(r.P+r.F*s,"String",i)},n.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(u,"")),e});e.exports=n},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(41),i=n(38),o=n(142);e.exports=n(30)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,u=0;u<s;)r.f(e,n=a[u++],t[n]);return e}},function(e,t,n){var r=n(23);r(r.S,"Number",{isInteger:n(302)})},function(e,t,n){var r=n(44),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){var r=n(23);r(r.S,"Math",{sign:n(304)})},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t,n){"use strict";var r=n(144);n(23)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){n(30)&&"g"!=/./g.flags&&n(41).f(RegExp.prototype,"flags",{configurable:!0,get:n(107)})},function(e,t,n){var r=n(23);r(r.S+r.F,"Object",{assign:n(308)})},function(e,t,n){"use strict";var r=n(30),i=n(142),o=n(309),a=n(179),s=n(46),u=n(138),l=Object.assign;e.exports=!l||n(26)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var n=s(e),l=arguments.length,c=1,h=o.f,f=a.f;c<l;)for(var d,p=u(arguments[c++]),g=h?i(p).concat(h(p)):i(p),m=g.length,v=0;v<m;)d=g[v++],r&&!f.call(p,d)||(n[d]=p[d]);return n}:l},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){"use strict";var r=n(54),i=n(60);e.exports=function(e){var t=String(i(this)),n="",o=r(e);if(o<0||1/0==o)throw RangeError("Count can't be negative");for(;0<o;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t,n){"use strict";var r=n(23),i=n(46),o=n(82);r(r.P+r.F*n(26)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=i(this),n=o(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(313);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(44),i=n(314),o=n(24)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(69);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r=n(31),i=n(30),o=n(99),a=n(185),s=n(40),u=n(186),l=n(26),c=n(187),h=n(54),f=n(39),d=n(188),p=n(102).f,g=n(41).f,m=n(148),v=n(149),y="ArrayBuffer",_="DataView",x="prototype",A="Wrong index!",I=r[y],w=r[_],b=r.Math,C=r.RangeError,M=r.Infinity,E=I,T=b.abs,S=b.pow,L=b.floor,k=b.log,R=b.LN2,N=(n="buffer",r="byteLength",b="byteOffset",i?"_b":n),P=i?"_l":r,O=i?"_o":b;function D(e,t,n){var r,i,o=new Array(n),a=8*n-t-1,s=(1<<a)-1,u=s>>1,l=23===t?S(2,-24)-S(2,-77):0,c=0,h=e<0||0===e&&1/e<0?1:0;for((e=T(e))!=e||e===M?(i=e!=e?1:0,r=s):(r=L(k(e)/R),e*(n=S(2,-r))<1&&(r--,n*=2),2<=(e+=1<=r+u?l/n:l*S(2,1-u))*n&&(r++,n/=2),s<=r+u?(i=0,r=s):1<=r+u?(i=(e*n-1)*S(2,t),r+=u):(i=e*S(2,u-1)*S(2,t),r=0));8<=t;o[c++]=255&i,i/=256,t-=8);for(r=r<<t|i,a+=t;0<a;o[c++]=255&r,r/=256,a-=8);return o[--c]|=128*h,o}function F(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,l=127&(n=e[u--]);for(n>>=7;0<s;l=256*l+e[u],u--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=t;0<s;r=256*r+e[u],u--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:n?-M:M;r+=S(2,t),l-=a}return(n?-1:1)*r*S(2,l-t)}function B(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function G(e){return[255&e]}function z(e){return[255&e,e>>8&255]}function U(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function V(e){return D(e,52,8)}function H(e){return D(e,23,4)}function j(e,t,n){g(e[x],t,{get:function(){return this[n]}})}function W(e,t,n,r){var i=+n;if((n=d(i))+t>e[P])throw C(A);return i=e[N]._b,e=n+e[O],t=i.slice(e,e+t),r?t:t.reverse()}function Y(e,t,n,r,i,o){if((n=d(n=+n))+t>e[P])throw C(A);for(var a=e[N]._b,s=n+e[O],u=r(+i),l=0;l<t;l++)a[s+l]=u[o?l:t-l-1]}if(a.ABV){if(!l((function(){I(1)}))||!l((function(){new I(-1)}))||l((function(){return new I,new I(1.5),new I(NaN),I.name!=y}))){I=function(e){return c(this,I),new E(d(e))};for(var q,X=I[x]=E[x],Z=p(E),J=0;Z.length>J;)(q=Z[J++])in I||s(I,q,E[q]);o||(X.constructor=I)}X=new w(new I(2));var K=w[x].setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||u(w[x],{setInt8:function(e,t){K.call(this,e,t<<24>>24)},setUint8:function(e,t){K.call(this,e,t<<24>>24)}},!0)}else I=function(e){c(this,I,y),e=d(e),this._b=m.call(new Array(e),0),this[P]=e},w=function(e,t,n){c(this,w,_),c(e,I,_);var r=e[P];if((t=h(t))<0||r<t)throw C("Wrong offset!");if(r<t+(n=void 0===n?r-t:f(n)))throw C("Wrong length!");this[N]=e,this[O]=t,this[P]=n},i&&(j(I,r,"_l"),j(w,n,"_b"),j(w,r,"_l"),j(w,b,"_o")),u(w[x],{getInt8:function(e){return W(this,1,e)[0]<<24>>24},getUint8:function(e){return W(this,1,e)[0]},getInt16:function(e){return((e=W(this,2,e,arguments[1]))[1]<<8|e[0])<<16>>16},getUint16:function(e){return(e=W(this,2,e,arguments[1]))[1]<<8|e[0]},getInt32:function(e){return B(W(this,4,e,arguments[1]))},getUint32:function(e){return B(W(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return F(W(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return F(W(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){Y(this,1,e,G,t)},setUint8:function(e,t){Y(this,1,e,G,t)},setInt16:function(e,t){Y(this,2,e,z,t,arguments[2])},setUint16:function(e,t){Y(this,2,e,z,t,arguments[2])},setInt32:function(e,t){Y(this,4,e,U,t,arguments[2])},setUint32:function(e,t){Y(this,4,e,U,t,arguments[2])},setFloat32:function(e,t){Y(this,4,e,H,t,arguments[2])},setFloat64:function(e,t){Y(this,8,e,V,t,arguments[2])}});v(I,y),v(w,_),s(w[x],a.VIEW,!0),t[y]=I,t[_]=w},function(e,t,n){var r=n(70),i=n(24)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){var r=n(105),i=n(24)("iterator"),o=n(70);e.exports=n(97).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(141),i=n(98),o=n(149),a={};n(40)(a,n(24)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(24)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(46),i=n(84),o=n(39);e.exports=[].copyWithin||function(e,t){var n=r(this),a=o(n.length),s=i(e,a),u=i(t,a),l=(t=2<arguments.length?arguments[2]:void 0,Math.min((void 0===t?a:i(t,a))-u,a-s)),c=1;for(u<s&&s<u+l&&(c=-1,u+=l-1,s+=l-1);0<l--;)u in n?n[s]=n[u]:delete n[s],s+=c,u+=c;return n}},function(e,t,n){n(47)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0)},function(e,t,n){n(47)("Int32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(47)("Float64",8,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){"use strict";var r=n(23),i=n(146)(2);r(r.P+r.F*!n(147)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var r=n(31),i=n(178),o=n(41).f,a=n(102).f,s=n(196),u=n(107),l=p=r.RegExp,c=p.prototype,h=/a/g,f=/a/g,d=new p(h)!==h;if(n(30)&&(!d||n(26)((function(){return f[n(24)("match")]=!1,p(h)!=h||p(f)==f||"/a/i"!=p(h,"i")})))){for(var p=function(e,t){var n=this instanceof p,r=s(e),o=void 0===t;return!n&&r&&e.constructor===p&&o?e:i(d?new l(r&&!o?e.source:e,t):l((r=e instanceof p)?e.source:e,r&&o?u.call(e):t),n?this:c,p)},g=function(e){e in p||o(p,e,{configurable:!0,get:function(){return l[e]},set:function(t){l[e]=t}})},m=a(l),v=0;m.length>v;)g(m[v++]);c.constructor=p,p.prototype=c,n(45)(r,"RegExp",p)}n(193)("RegExp")},function(e,t,n){(n=n(23))(n.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){e.exports=n(330)},function(e,t,n){n(331),e.exports=Math.pow(2,-52)},function(e,t,n){(n=n(15))(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){e.exports=n(333)},function(e,t,n){n(334),e.exports=n(12).Number.isInteger},function(e,t,n){var r=n(15);r(r.S,"Number",{isInteger:n(335)})},function(e,t,n){var r=n(22),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){n(337),e.exports=n(12).Object.assign},function(e,t,n){var r=n(15);r(r.S+r.F,"Object",{assign:n(198)})},function(e,t,n){n(339);var r=n(12).Object;e.exports=function(e,t){return r.defineProperties(e,t)}},function(e,t,n){var r=n(15);r(r.S+r.F*!n(33),"Object",{defineProperties:n(166)})},function(e,t,n){n(341),e.exports=n(12).Array.isArray},function(e,t,n){var r=n(15);r(r.S,"Array",{isArray:n(132)})},function(e,t,n){var r=(n=n(12)).JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},function(e,t,n){n(344),e.exports=n(12).parseFloat},function(e,t,n){var r=n(15);n=n(345),r(r.G+r.F*(parseFloat!=n),{parseFloat:n})},function(e,t,n){var r=n(20).parseFloat,i=n(199).trim;e.exports=1/r(n(152)+"-0")!=-1/0?function(e){var t=i(String(e),3);return 0===(e=r(t))&&"-"==t.charAt(0)?-0:e}:r},function(e,t,n){n(347),e.exports=n(12).parseInt},function(e,t,n){var r=n(15);n=n(348),r(r.G+r.F*(parseInt!=n),{parseInt:n})},function(e,t,n){var r=n(20).parseInt,i=n(199).trim,o=(n=n(152),/^[-+]?0[xX]/);e.exports=8!==r(n+"08")||22!==r(n+"0x16")?function(e,t){return e=i(String(e),3),r(e,t>>>0||(o.test(e)?16:10))}:r},function(e,t,n){n(350),e.exports=n(12).Object.keys},function(e,t,n){var r=n(57),i=n(77);n(134)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t,n){n(93),n(95),n(352),n(356),n(357),e.exports=n(12).WeakMap},function(e,t,n){"use strict";var r,i=n(20),o=n(153)(0),a=n(128),s=n(68),u=n(198),l=n(355),c=n(22),h=n(85),f=n(85),d=!i.ActiveXObject&&"ActiveXObject"in i,p="WeakMap",g=s.getWeak,m=Object.isExtensible,v=l.ufstore,y=function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},_=(i={get:function(e){if(c(e)){var t=g(e);return!0===t?v(h(this,p)).get(e):t?t[this._i]:void 0}},set:function(e,t){return l.def(h(this,p),e,t)}},e.exports=n(204)(p,y,i,l,!0,!0));f&&d&&(u((r=l.getConstructor(y,p)).prototype,i),s.NEED=!0,o(["delete","has","get","set"],(function(e){var t=_.prototype,n=t[e];a(t,e,(function(t,i){return!c(t)||m(t)?n.call(this,t,i):(this._f||(this._f=new r),i=this._f[e](t,i),"set"==e?this:i)}))})))},function(e,t,n){var r=n(354);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(22),i=n(132),o=n(29)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(113),i=n(68).getWeak,o=n(37),a=n(22),s=n(114),u=n(72),l=n(153),c=n(52),h=n(85),f=l(5),d=l(6),p=0,g=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},v=function(e,t){return f(e.a,(function(e){return e[0]===t}))};m.prototype={get:function(e){if(e=v(this,e))return e[1]},has:function(e){return!!v(this,e)},set:function(e,t){var n=v(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=d(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var l=e((function(e,r){s(e,l,t,"_i"),e._t=t,e._i=p++,e._l=void 0,null!=r&&u(r,n,e[o],e)}));return r(l.prototype,{delete:function(e){if(!a(e))return!1;var n=i(e);return!0===n?g(h(this,t)).delete(e):n&&c(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=i(e);return!0===n?g(h(this,t)).has(e):n&&c(n,this._i)}}),l},def:function(e,t,n){var r=i(o(t),!0);return!0===r?g(e).set(t,n):r[e._i]=n,e},ufstore:g}},function(e,t,n){n(205)("WeakMap")},function(e,t,n){n(206)("WeakMap")},function(e,t,n){n(93),n(94),n(95),n(359),n(361),n(364),n(365),e.exports=n(12).Map},function(e,t,n){"use strict";var r=n(360),i=n(85),o="Map";e.exports=n(204)(o,(function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}}),{get:function(e){return(e=r.getEntry(i(this,o),e))&&e.v},set:function(e,t){return r.def(i(this,o),0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";var r=n(36).f,i=n(76),o=n(113),a=n(42),s=n(114),u=n(72),l=n(133),c=n(173),h=n(207),f=n(33),d=n(68).fastKey,p=n(85),g=f?"_s":"size",m=function(e,t){var n,r=d(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,l){var c=e((function(e,r){s(e,c,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[g]=0,null!=r&&u(r,n,e[l],e)}));return o(c.prototype,{clear:function(){for(var e=p(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[g]=0},delete:function(e){var n,r=p(this,t),i=m(r,e);return i&&(n=i.n,e=i.p,delete r._i[i.i],i.r=!0,e&&(e.n=n),n&&(n.p=e),r._f==i&&(r._f=n),r._l==i&&(r._l=e),r[g]--),!!i},forEach:function(e){p(this,t);for(var n,r=a(e,1<arguments.length?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!m(p(this,t),e)}}),f&&r(c.prototype,"size",{get:function(){return p(this,t)[g]}}),c},def:function(e,t,n){var r,i=m(e,t);return i?i.v=n:(e._l=i={i:r=d(t,!0),k:t,v:n,p:n=e._l,n:void 0,r:!1},e._f||(e._f=i),n&&(n.n=i),e[g]++,"F"!==r&&(e._i[r]=i)),e},getEntry:m,setStrong:function(e,t,n){l(e,t,(function(e,n){this._t=p(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?c(0,"keys"==t?n.k:"values"==t?n.v:[n.k,n.v]):(e._t=void 0,c(1))}),n?"entries":"values",!n,!0),h(t)}}},function(e,t,n){var r=n(15);r(r.P+r.R,"Map",{toJSON:n(362)("Map")})},function(e,t,n){var r=n(154),i=n(363);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,n){var r=n(72);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},function(e,t,n){n(205)("Map")},function(e,t,n){n(206)("Map")},function(e,t,n){e.exports=n(367)},function(e,t,n){n(368),e.exports=n(12).Object.freeze},function(e,t,n){var r=n(22),i=n(68).onFreeze;n(134)("freeze",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){n(94),n(370),e.exports=n(12).Array.from},function(e,t,n){"use strict";var r=n(42),i=n(15),o=n(57),a=n(201),s=n(202),u=n(90),l=n(371),c=n(203);i(i.S+i.F*!n(208)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,h,f=o(e),d="function"==typeof this?this:Array,p=arguments.length,g=1<p?arguments[1]:void 0,m=void 0!==g,v=0;if(e=c(f),m&&(g=r(g,2<p?arguments[2]:void 0,2)),null==e||d==Array&&s(e))for(n=new d(t=u(f.length));v<t;v++)l(n,v,m?g(f[v],v):f[v]);else for(h=e.call(f),n=new d;!(i=h.next()).done;v++)l(n,v,m?a(h,g,[i.value,v],!0):i.value);return n.length=v,n}})},function(e,t,n){"use strict";var r=n(36),i=n(74);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){(function(t){e.exports=t.TWEEN=n(373)}).call(this,n(165))},function(e,t,n){(function(n){var r=function(){this._tweens={},this._tweensAddedDuringUpdate={}};r.prototype={getAll:function(){return Object.keys(this._tweens).map(function(e){return this._tweens[e]}.bind(this))},removeAll:function(){this._tweens={}},add:function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},remove:function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},update:function(e,t){var n=Object.keys(this._tweens);if(0===n.length)return!1;for(e=void 0!==e?e:o.now();0<n.length;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var i=this._tweens[n[r]];i&&!1===i.update(e)&&(i._isPlaying=!1,t||delete this._tweens[n[r]])}n=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var i,o=new r;o.Group=r,o._nextId=0,o.nextId=function(){return o._nextId++},"undefined"==typeof self&&void 0!==n&&n.hrtime?o.now=function(){var e=n.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?o.now=self.performance.now.bind(self.performance):void 0!==Date.now?o.now=Date.now:o.now=function(){return(new Date).getTime()},o.Tween=function(e,t){this._object=e,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=o.Easing.Linear.None,this._interpolationFunction=o.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=t||o,this._id=o.nextId()},o.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(e,t){return this._valuesEnd=e,void 0!==t&&(this._duration=t),this},duration:function(e){return this._duration=e,this},start:function(e){for(var t in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==e?"string"==typeof e?o.now()+parseFloat(e):e:o.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[t]instanceof Array){if(0===this._valuesEnd[t].length)continue;this._valuesEnd[t]=[this._object[t]].concat(this._valuesEnd[t])}void 0!==this._object[t]&&(this._valuesStart[t]=this._object[t],this._valuesStart[t]instanceof Array==0&&(this._valuesStart[t]*=1),this._valuesStartRepeat[t]=this._valuesStart[t]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){return this.update(1/0),this},stopChainedTweens:function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop()},group:function(e){return this._group=e,this},delay:function(e){return this._delayTime=e,this},repeat:function(e){return this._repeat=e,this},repeatDelay:function(e){return this._repeatDelayTime=e,this},yoyo:function(e){return this._yoyo=e,this},easing:function(e){return this._easingFunction=e,this},interpolation:function(e){return this._interpolationFunction=e,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(e){return this._onStartCallback=e,this},onUpdate:function(e){return this._onUpdateCallback=e,this},onRepeat:function(e){return this._onRepeatCallback=e,this},onComplete:function(e){return this._onCompleteCallback=e,this},onStop:function(e){return this._onStopCallback=e,this},update:function(e){var t,n,r,i,o,a;if(e<this._startTime)return!0;for(t in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(e-this._startTime)/this._duration,n=0===this._duration||1<n?1:n,r=this._easingFunction(n),this._valuesEnd)void 0!==this._valuesStart[t]&&(i=this._valuesStart[t]||0,(o=this._valuesEnd[t])instanceof Array?this._object[t]=this._interpolationFunction(o,r):("string"==typeof o&&(o="+"===o.charAt(0)||"-"===o.charAt(0)?i+parseFloat(o):parseFloat(o)),"number"==typeof o&&(this._object[t]=i+(o-i)*r)));if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,n),1!==n)return!0;if(0<this._repeat){for(t in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)"string"==typeof this._valuesEnd[t]&&(this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(this._valuesEnd[t])),this._yoyo&&(a=this._valuesStartRepeat[t],this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=a),this._valuesStart[t]=this._valuesStartRepeat[t];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,null!==this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,u=this._chainedTweens.length;s<u;s++)this._chainedTweens[s].start(this._startTime+this._duration);return!1}},o.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-o.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*o.Easing.Bounce.In(2*e):.5*o.Easing.Bounce.Out(2*e-1)+.5}}},o.Interpolation={Linear:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),a=o.Interpolation.Utils.Linear;return t<0?a(e[0],e[1],r):1<t?a(e[n],e[n-1],n-r):a(e[i],e[n<i+1?n:i+1],r-i)},Bezier:function(e,t){for(var n=0,r=e.length-1,i=Math.pow,a=o.Interpolation.Utils.Bernstein,s=0;s<=r;s++)n+=i(1-t,r-s)*i(t,s)*e[s]*a(r,s);return n},CatmullRom:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),a=o.Interpolation.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(i=Math.floor(r=n*(1+t))),a(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i)):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-r)-e[0]):1<t?e[n]-(a(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):a(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],r-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=o.Interpolation.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:(i=[1],function(e){var t=1;if(i[e])return i[e];for(var n=e;1<n;n--)t*=n;return i[e]=t,t}),CatmullRom:function(e,t,n,r,i){var o=.5*(n-e),a=.5*(r-t);return(2*t-2*n+o+a)*(r=i*(e=i*i))+(-3*t+3*n-2*o-a)*e+o*i+t}}},void 0===(r=function(){return o}.apply(t,r=[]))||(e.exports=r)}).call(this,n(156))},function(e,t,n){"use strict";var r=n(1),i=r(n(34)),o=r(n(111));n(9),n(14),n(71),n(110),n(61),r(n(2)),r(n(3)),fm.OrbitControls=function(e,t,n){var r,i,o,a,s,u,l,c,h,f;this.object=e,this.map=n,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new fm.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:fm.MOUSE.LEFT,MIDDLE:fm.MOUSE.MIDDLE,RIGHT:fm.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.rangeCenter=new fm.Vector3,this.rangeRadius=500,this.useRange=!1,this.enterCtrl=null,this.setEnterCtrl=function(e){this.enterCtrl=e},this.getPolarAngle=function(){return x.phi},this.getAzimuthalAngle=function(){return x.theta},this.setPolarAngle=function(e){x.phi=e},this.setAzimuthalAngle=function(e){x.theta=e},this.addPolarAngle=function(e){x.phi+=e},this.addAzimuthalAngle=function(e){x.theta+=e},this.panAdd=function(e){w.add(e)},this.saveState=function(){d.target0.copy(d.target),d.position0.copy(d.object.position),d.zoom0=d.object.zoom},this.reset=function(){d.target.copy(d.target0),d.object.position.copy(d.position0),d.object.zoom=d.zoom0,d.object.updateProjectionMatrix(),d.dispatchEvent(p),d.update(),y=v.NONE},this.setUpdate=function(e,t,n,u,l){r=e,i=t,o=n,a=u,s=s||l},this.update=(u=new fm.Vector3,l=(new fm.Quaternion).setFromUnitVectors(e.up,new fm.Vector3(0,1,0)),c=l.clone().inverse(),h=new fm.Vector3,f=new fm.Quaternion,function(){var e=d.object.position;u.copy(e).sub(d.target),u.applyQuaternion(l);var t,n=x.theta;return x.setFromVector3(u),x.theta=n,y!==v.NONE?d.map.autoRotateBymodelPause=!0:d.map.autoRotateBymodelPause=!1,d.autoRotate&&y===v.NONE&&B(2*Math.PI/60/60*d.autoRotateSpeed),x.theta+=A.theta,x.phi+=A.phi,"number"==typeof a&&(x.theta=a),"number"==typeof s&&(x.phi=s),"number"==typeof r&&(x.phi+=r),i&&"number"==typeof i&&(x.theta+=i),x.theta=Math.max(d.minAzimuthAngle,Math.min(d.maxAzimuthAngle,x.theta)),x.phi=Math.max(d.minPolarAngle,Math.min(d.maxPolarAngle,x.phi)),x.makeSafe(),x.radius*=I,x.radius=Math.max(d.minDistance,Math.min(d.maxDistance,x.radius)),this.useRange?((t=(new fm.Vector3).setFromMatrixPosition(d.object.matrixWorld)).add(w),t=(new fm.Matrix4).copy(d.object.matrixWorld).setPosition(t),t=(new fm.Matrix4).getInverse(t),(t=(new fm.Frustum).setFromProjectionMatrix((new fm.Matrix4).multiplyMatrices(d.object.projectionMatrix,t))).intersectsBox(d.viewBox)&&d.target.add(w)):d.target.add(w),u.setFromSpherical(x),u.applyQuaternion(c),o&&u.add(o),this.useRange?((t=(new fm.Vector3).setFromMatrixPosition(d.object.matrixWorld)).add(u),t=(new fm.Matrix4).copy(d.object.matrixWorld).setPosition(t),t=(new fm.Matrix4).getInverse(t),(t=(new fm.Frustum).setFromProjectionMatrix((new fm.Matrix4).multiplyMatrices(d.object.projectionMatrix,t))).intersectsBox(d.viewBox)&&e.copy(d.target).add(u)):e.copy(d.target).add(u),d.object.lookAt(d.target),!0===d.enableDamping?(A.theta*=1-d.dampingFactor,A.phi*=1-d.dampingFactor,w.multiplyScalar(1-d.dampingFactor)):(A.set(0,0,0),w.set(0,0,0)),r=void 0,i=void 0,o=void 0,a=void 0,s=void 0,I=1,!!(b||h.distanceToSquared(d.object.position)>_||8*(1-f.dot(d.object.quaternion))>_)&&(d.dispatchEvent(p),h.copy(d.object.position),f.copy(d.object.quaternion),b=!1,!0)}),this.dispose=function(){d.domElement.removeEventListener("contextmenu",oe,!1),d.domElement.removeEventListener("mousedown",Z,!1),d.domElement.removeEventListener("wheel",ee,!1),d.domElement.removeEventListener("touchstart",ne,!1),d.domElement.removeEventListener("touchend",ie,!1),d.domElement.removeEventListener("touchmove",re,!1),d.domElement.removeEventListener("mouseup",K,!1),d.domElement.removeEventListener("mousemove",Q,!1),window.PointerEvent&&!window.TouchEvent&&(d.domElement.removeEventListener("pointerdown",ue,!1),d.domElement.removeEventListener("pointermove",le,!1),d.domElement.removeEventListener("pointerup",ce,!1)),document.removeEventListener("mousemove",J,!1),document.removeEventListener("mouseup",$,!1),window.removeEventListener("keydown",te,!1),this.enterCtrl=void 0,this.domElement=void 0,this.object=void 0};var d=this,p={type:"change"},g={type:"start"},m={type:"end"},v={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4,TOUCH_PAN:5,TOUCH_DOLLY_ROTATE:6},y=v.NONE,_=1e-6,x=new fm.Spherical,A=new fm.Spherical,I=1,w=new fm.Vector3,b=!1,C=new fm.Vector2,M=new fm.Vector2,E=new fm.Vector2,T=new fm.Vector2,S=new fm.Vector2,L=(new fm.Vector2,new fm.Vector2),k=new fm.Vector2,R=new fm.Vector2,N=new fm.Vector2,P=new fm.Vector2,O=new fm.Vector2,D=new fm.Vector2;function F(){return Math.pow(.95,d.zoomSpeed)}function B(e){d.enterCtrl&&!d.enterCtrl.enableMapRotate||(A.theta-=e)}function G(e){d.enterCtrl&&!d.enterCtrl.enableMapIncline||(A.phi-=e)}this.rotateLeft=function(e){B(e)};var z,U,V=(z=new fm.Vector3,function(e,t){z.setFromMatrixColumn(t,0),z.multiplyScalar(-e),w.add(z)}),H=(U=new fm.Vector3,function(e,t){!0===d.screenSpacePanning?U.setFromMatrixColumn(t,1):(U.setFromMatrixColumn(t,0),U.crossVectors(d.object.up,U)),U.multiplyScalar(e),w.add(U)});this.panUp=function(e){var t=new fm.Vector3;t.y=1,t.multiplyScalar(e),w.add(t)};var j,W=(j=new fm.Vector3,function(e,t){var n,r;d.enterCtrl&&!d.enterCtrl.enableMapPan||(n=d.domElement===document?d.domElement.body:d.domElement,d.object.isPerspectiveCamera?(r=d.object.position,j.copy(r).sub(d.target),r=j.length(),r*=Math.tan(d.object.fov/2*Math.PI/180),V(2*e*r/n.clientHeight,d.object.matrix),H(2*t*r/n.clientHeight,d.object.matrix)):d.object.isOrthographicCamera?(V(e*(d.object.right-d.object.left)/d.object.zoom/n.clientWidth,d.object.matrix),H(t*(d.object.top-d.object.bottom)/d.object.zoom/n.clientHeight,d.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),d.enablePan=!1))});function Y(e){d.enterCtrl&&!d.enterCtrl.enableMapPinch||(d.object.isPerspectiveCamera?I/=e:d.object.isOrthographicCamera?(d.object.zoom=Math.max(d.minZoom,Math.min(d.maxZoom,d.object.zoom*e)),d.object.updateProjectionMatrix(),I/=e,b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),d.enableZoom=!1))}function q(e){d.enterCtrl&&!d.enterCtrl.enableMapPinch||(d.object.isPerspectiveCamera?I*=e:d.object.isOrthographicCamera?(d.object.zoom=Math.max(d.minZoom,Math.min(d.maxZoom,d.object.zoom/e)),d.object.updateProjectionMatrix(),b=!0,I*=e):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),d.enableZoom=!1))}function X(e){L.set(e.clientX,e.clientY)}function Z(e){if(D.set(e.clientX,e.clientY,d.enabled),!1!==d.enabled){switch(e.preventDefault(),e.button){case d.mouseButtons.LEFT:if(!1===d.enablePan)return;X(e),y=v.PAN;break;case d.mouseButtons.MIDDLE:if(!1===d.enableZoom)return;(function(e){N.set(e.clientX,e.clientY)})(e),y=v.DOLLY;break;case d.mouseButtons.RIGHT:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===d.enablePan)return;X(e),y=v.PAN}else{if(!1===d.enableRotate)return;(function(e){C.set(e.clientX,e.clientY)})(e),y=v.ROTATE}}y!==v.NONE&&(document.addEventListener("mousemove",J,!1),document.addEventListener("mouseup",$,!1),d.dispatchEvent(g))}}function J(e){if(!1!==d.enabled)switch(e.preventDefault(),y){case v.ROTATE:if(!1===d.enableRotate)return;!function(e){M.set(e.clientX,e.clientY),E.subVectors(M,C).multiplyScalar(d.rotateSpeed),e=d.domElement===document?d.domElement.body:d.domElement,B(2*Math.PI*E.x/e.clientHeight),G(2*Math.PI*E.y/e.clientHeight),C.copy(M)}(e);break;case v.DOLLY:if(!1===d.enableZoom)return;!function(e){P.set(e.clientX,e.clientY),O.subVectors(P,N),0<O.y?Y(F()):O.y<0&&q(F()),N.copy(P)}(e);break;case v.PAN:if(!1===d.enablePan)return;!function(e){k.set(e.clientX,e.clientY),R.subVectors(k,L).multiplyScalar(d.panSpeed),W(R.x,R.y),L.copy(k)}(e)}}function K(e){D.distanceTo(new fm.Vector2(e.clientX,e.clientY))<5&&d.dispatchEvent({type:"mouseup",mousePoint:{x:e.offsetX,y:e.offsetY,w:d.domElement.clientWidth,h:d.domElement.clientHeight},event:e,mouseButton:e.button})}function Q(e){d.dispatchEvent({type:"mousemove",mousePoint:{x:e.offsetX,y:e.offsetY,w:d.domElement.clientWidth,h:d.domElement.clientHeight},event:e})}function $(e){!1!==d.enabled&&(document.removeEventListener("mousemove",J,!1),document.removeEventListener("mouseup",$,!1),d.dispatchEvent(m),y=v.NONE)}function ee(e){!1===d.enabled||!1===d.enableZoom||y!==v.NONE&&y!==v.ROTATE||(e.preventDefault(),e.stopPropagation(),d.dispatchEvent(g),function(e){e.deltaY<0?q(F()):0<e.deltaY&&Y(F())}(e),d.dispatchEvent(m))}function te(e){!1!==d.enabled&&!1!==d.enableKeys&&!1!==d.enablePan&&function(e){switch(e.keyCode){case d.keys.UP:W(0,d.keyPanSpeed),d.update();break;case d.keys.BOTTOM:W(0,-d.keyPanSpeed),d.update();break;case d.keys.LEFT:W(d.keyPanSpeed,0),d.update();break;case d.keys.RIGHT:W(-d.keyPanSpeed,0),d.update()}}(e)}function ne(e){if(!1!==d.enabled){switch(e.preventDefault(),d.map&&d.map.eventTransform&&(e=d.map.eventTransform(e)),D.set(e.changedTouches[0].pageX,e.changedTouches[0].pageY),e.touches.length){case 1:d.enablePan&&(r=e.touches[0].pageX,i=e.touches[0].pageY,L.set(r,i)),y=v.TOUCH_PAN;break;case 2:if(!1===d.enableZoom&&!1===d.enableRotate)return;var t,n,r,i;y=v.TOUCH_DOLLY_ROTATE,d.enableZoom&&(t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+n*n),N.set(0,n)),d.enableRotate&&(r=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY),C.set(r,i),r=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,T.set(r,i));break;default:y=v.NONE}y!==v.NONE&&d.dispatchEvent(g)}}function re(e){if(!1!==d.enabled)switch(e.preventDefault(),e.stopPropagation(),d.map&&d.map.eventTransform&&(e=d.map.eventTransform(e)),e.touches.length){case 1:if(y!==v.TOUCH_PAN)return;if(d.enablePan){var t=e.touches[0].pageX,n=e.touches[0].pageY;if(t<0)break;k.set(t,n),R.subVectors(k,L).multiplyScalar(d.panSpeed),W(R.x,R.y),L.copy(k)}break;case 2:if(!1===d.enableRotate&&!1===d.enableZoom)return;if(y!==v.TOUCH_DOLLY_ROTATE)return;var r,i,o;d.enableZoom&&(i=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(i*i+o*o),P.set(0,r),O.set(0,Math.pow(P.y/N.y,d.zoomSpeed)),Y(O.y),N.copy(P)),d.enableRotate&&(i=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,S.set(i,o),r=T.angle(),i=S.angle(),M.set(.5*(e.touches[0].pageX+e.touches[1].pageX),.5*(e.touches[0].pageY+e.touches[1].pageY)),E.subVectors(M,C).multiplyScalar(d.rotateSpeed),o=d.domElement===document?d.domElement.body:d.domElement,B((-i+r)*d.rotateSpeed),G(2*Math.PI*E.y/o.clientHeight),C.copy(M),T.copy(S));break;default:y=v.NONE}}function ie(e){var t,n;!1!==d.enabled&&(d.map&&d.map.eventTransform&&(e=d.map.eventTransform(e)),t=D.distanceTo(new fm.Vector2(e.changedTouches[0].pageX,e.changedTouches[0].pageY)),n=d.domElement.getBoundingClientRect(),t<5&&d.dispatchEvent({type:"mouseup",mousePoint:{x:e.changedTouches[0].pageX-n.left,y:e.changedTouches[0].pageY-n.top,w:d.domElement.clientWidth,h:d.domElement.clientHeight},event:e,mouseButton:fm.MOUSE.LEFT}),d.dispatchEvent(m),y=v.NONE)}function oe(e){!1!==d.enabled&&e.preventDefault()}this.dollyIn=function(e){Y(e)},this.dollyOut=function(e){q(e)},this.mapMouseDown=Z,this.mapMouseUp=K,d.domElement.addEventListener("contextmenu",oe,!1),d.domElement.addEventListener("mouseup",K,!1),d.domElement.addEventListener("mousemove",Q,!1),d.domElement.addEventListener("mousedown",Z,!1),d.domElement.addEventListener("wheel",ee,!1);var ae={touches:[],changedTouches:[],preventDefault:function(){},stopPropagation:function(){}};function se(e){return{pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,pageX:e.clientX,pageY:e.clientY}}function ue(e){if("touch"==e.pointerType){switch(ae.touches.length){case 0:var t={startClientX:e.clientX,startClientY:e.clientY,clientX:e.clientX,clientY:e.clientY,pageY:e.clientY,pageX:e.clientX,pointerId:e.pointerId};ae.touches.push(se(t)),ae.changedTouches.push(se(t)),y=v.TOUCH_PAN;break;case 1:t={startClientX:e.clientX,startClientY:e.clientY,clientX:e.clientX,clientY:e.clientY,pageY:e.clientY,pageX:e.clientX,pointerId:e.pointerId},ae.touches.push(se(t)),ae.changedTouches.push(se(t)),y=v.TOUCH_DOLLY_ROTATE;break;default:y=v.NONE}1<ae.touches.length&&ne(ae)}else ae={touches:[],changedTouches:[],preventDefault:function(){},stopPropagation:function(){}}}function le(e){if(!("touch"!=e.pointerType&&ae.touches.length<2)){for(var t=0,n=ae.touches.length;t<n;t++)ae.touches[t].pointerId==e.pointerId&&(ae.touches[t].clientX=e.clientX,ae.touches[t].clientY=e.clientY,ae.touches[t].pageY=e.clientY,ae.touches[t].pageX=e.clientX,ae.changedTouches[t].clientX=e.clientX,ae.changedTouches[t].clientY=e.clientY,ae.changedTouches[t].pageY=e.clientY,ae.changedTouches[t].pageX=e.clientX);1<ae.touches.length&&re(ae)}}function ce(e){if("touch"==e.pointerType){1<ae.touches.length&&ie(ae);for(var t=ae.touches.length-1;-1<t;t--)ae.touches[t].pointerId==e.pointerId&&(ae.touches.splice(t,1),ae.changedTouches.splice(t,1))}else ae={touches:[],changedTouches:[],preventDefault:function(){},stopPropagation:function(){}}}window.PointerEvent&&!window.TouchEvent&&(d.domElement.addEventListener("pointerdown",ue,!1),d.domElement.addEventListener("pointermove",le,!1),d.domElement.addEventListener("pointerup",ce,!1)),d.domElement.addEventListener("touchstart",ne,!1),d.domElement.addEventListener("touchend",ie,!1),d.domElement.addEventListener("touchmove",re,!1),window.addEventListener("keydown",te,!1),this.update()},fm.OrbitControls.prototype=(0,i.default)(fm.EventDispatcher.prototype),fm.OrbitControls.prototype.constructor=fm.OrbitControls,(0,o.default)(fm.OrbitControls.prototype,{center:{get:function(){return console.warn("fm.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("fm.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("fm.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("fm.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("fm.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("fm.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("fm.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("fm.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("fm.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("fm.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("fm.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("fm.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("fm.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}})},function(e,t,n){"use strict";n(13),fm.Evento={convert:function(e,t){return t=t||{},e.on=function(n,r){return(t[n]=t[n]||[]).push(r),e},e.getHandlers=function(e){return t[e]},e.once=function(t,n){function r(){n.apply(e.off(t,r),arguments)}return r.h=n,e.on(t,r)},e.off=function(n,r){for(var i=t[n],o=0;r&&i&&i[o];o++)i[o]!=r&&i[o].h!=r||i.splice(o--,1);return r||delete t[n],e},e.emit=function(n){for(var r=t[n],i=0;r&&r[i];)r[i++].apply(e,r.slice.call(arguments,1));return e},e.offAll=function(){for(var e in t)t[e]=[],delete t[e];t=void 0},e}}},function(e,t,n){var r=n(11),i=n(210);e.exports=function(e){if(r(e))return i(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(17),i=n(18),o=n(16);e.exports=function(e){if(void 0!==r&&null!=e[i]||null!=e["@@iterator"])return o(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(16),i=n(210);e.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(19));n(55);var a=i(n(2)),s=i(n(3)),u=i(n(86)),l=i(n(213)),c=i(n(115));n=function(){function e(t){(0,a.default)(this,e);var n=window.location.protocol;n=c.default.replace("FMCloud/","").replace("www.fengmap.com","source.fengmap.com")+"webtheme",this._key=null,this._appName=null,this._mapServerURL="fengmap",this._mapThemeURL=n,this._container=document.body,this._compassOffset=[28,20],this._compassSize=50,this._compassFg=null,this._compassBg=null,this.compassPosition=1,this._defaultThemeName="2001",this._focusAnimateMode=!0,this._focusAnimateTime=.3,this._focusAlphaMode=!0,this._focusAlpha=.1,this._viewModeAnimateMode=!0,this._viewModeAnimateTime=.3,this._moveToAnimateMode=!0,this._moveToAnimateTime=.3,this._scaleToAnimateMode=!0,this._modelSelectedEffect=!0,this._modelHoverEffect=!1,this._modelHoverTime=1e3,this.minScaleLevel=0,this.maxScaleLevel=6,this.defaultScaleLevel=3,this.mapScaleLevelRange=[16,23],this.mapScaleRange=null,this.defaultMapScaleLevel=20,this.defaultMapScale=null,this.minViewDistance=2e3,this.defaultVisibleGroups=[1],this.defaultFocusGroup=1,this.defaultViewMode="3d",this.shadowEnabled=!1,this.lightAngleX=45,this.lightAngleY=45,this.shadowSize=2048,this.shadowAlpha=.6,this.storeImageAngle=0,this.naviLineAnimation=!0,this.controlsRotateThreshold=.03,this.controlsScaleThreshold=.03,this.defaultGroupSpace=50,this.passiveMode=!1,this.themeVersion=null,this.themeFileType=null,this.cornerRoundLimit=1,this.stairsConfig={},this.defaultControlsPose=-15,this.defaultTiltAngle=30,this.defaultMaxTiltAngle=90,this.defaultMinTiltAngle=30,this.extentHeight=0,this.poiLabelFadeMode=!1,this.poiLabelFadeSpeed=5,this.defaultBackgroundColor=null,this.defaultBackgroundAlpha=null,this.storeImageDistanceEnabled=!1,this.storeImageDistance=500,this.useStoreApply=!0,this.frameRate=12,this.defaultViewCenter=null,this.pickCoordHeight=1,this.modelFileSuffix="js",this.enabledFXAA=!1,this.dynamicTextureScale=1,this.enabledPanRange=!1,this.tile=!1,this.levelShowOffset=0,this.lightEffects=!1,this.defaultLabelLanguage=u.default.ZH,this.font={family:'"Microsoft Yahei","微软雅黑",Tahoma,Arial'},(0,o.default)(this,t)}return(0,s.default)(e,[{key:"computePoseToAngle",value:function(){return"number"==typeof this.defaultControlsPose?this.defaultControlsPose:this.defaultControlsPose?l.default[this.defaultControlsPose]||-15:void 0}},{key:"key",get:function(){return this._key},set:function(e){this._key=e}},{key:"appName",get:function(){return this._appName},set:function(e){this._appName=e}},{key:"mapServerURL",get:function(){return this._mapServerURL},set:function(e){this._mapServerURL=e}},{key:"mapThemeURL",get:function(){return this._mapThemeURL},set:function(e){this._mapThemeURL=e}},{key:"container",get:function(){return this._container},set:function(e){this._container=e}},{key:"compassOffset",get:function(){return this._compassOffset},set:function(e){this._compassOffset=e}},{key:"compassSize",get:function(){return this._compassSize},set:function(e){this._compassSize=e}},{key:"compassFg",get:function(){return this._compassFg},set:function(e){this._compassFg=e}},{key:"compassBg",get:function(){return this._compassBg},set:function(e){this._compassBg=e}},{key:"defaultThemeName",get:function(){return this._defaultThemeName},set:function(e){this._defaultThemeName=e}},{key:"focusAnimateMode",get:function(){return this._focusAnimateMode},set:function(e){this._focusAnimateMode=e}},{key:"focusAnimateTime",get:function(){return this._focusAnimateTime},set:function(e){this._focusAnimateTime=e}},{key:"focusAlphaMode",get:function(){this._focusAlphaMode},set:function(e){this._focusAlphaMode=e}},{key:"focusAlpha",get:function(){return this._focusAlpha},set:function(e){this._focusAlpha=e}},{key:"viewModeAnimateMode",get:function(){return this._viewModeAnimateMode},set:function(e){this._viewModeAnimateMode=e}},{key:"moveToAnimateMode",get:function(){return this._moveToAnimateMode},set:function(e){this._moveToAnimateMode=e}},{key:"scaleToAnimateMode",get:function(){return this._scaleToAnimateMode},set:function(e){this._scaleToAnimateMode=e}},{key:"viewModeAnimateTime",get:function(){return this._viewModeAnimateTime},set:function(e){this._viewModeAnimateTime=e}},{key:"modelHoverTime",get:function(){return this._modelHoverTime},set:function(e){e<300&&(e=300),this._modelHoverTime=e}},{key:"modelHoverEffect",get:function(){return this._modelHoverEffect},set:function(e){this._modelHoverEffect=e}},{key:"modelSelectedEffect",get:function(){return this._modelSelectedEffect},set:function(e){this._modelSelectedEffect=e}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(16),i=n(17),o=n(18),a=n(11),s=n(0);n(14),n(8);var u=n(1);s(t,"__esModule",{value:!0}),t.default=void 0,n(13);var l=u(n(2)),c=u(n(3)),h=u(n(382)),f=u(n(384)),d=u(n(385)),p=u(n(215));function g(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(){function e(){(0,l.default)(this,e)}return(0,c.default)(e,[{key:"mapDecode",value:function(e,t,n){var r=h.default.build("Map").decode(e);if(e="%E8%AF%B7%E8%BE%93%E5%85%A5%E6%AD%A3%E7%A1%AE%E7%9A%84license.",p.default.ls&&!p.default.checkLicense(r.key,t,n))return console.warn(decodeURIComponent(e)),null;for(var i={scene:null,floors:[]},o=0,a=r.buffers.length;o<a;o++){var s,u,l,c=r.buffers[o],g=c.len,m=c.data.offset,v=c.data.offset+g.low,y=c.data.buffer;1==c.btype?(u=d.default.build("Scene").decode(y.slice(m,v)),i.scene=u):(s=c.gid,u=(g=this.containsFloor(s,i.floors)).floor,g.index<0&&(u.gid=s,u.biz=[],u.navi=[],u.geo=[]),2==c.btype&&(l=f.default.build("FloorGeo").decode(y.slice(m,v)),u.geo.push(l)),3==c.btype&&(l=f.default.build("FloorBiz").decode(y.slice(m,v)),u.biz.push(l)),4==c.btype&&(v=f.default.build("FloorNavi").decode(y.slice(m,v)),u.navi.push(v)),g.index<0?i.floors.push(u):i.floors[g.index]=u)}return i}},{key:"containsFloor",value:function(e,t){for(var n=0,r=t.length;n<r;n++)if(t[n].gid==e)return{index:n,floor:t[n]};return{index:-1,floor:{}}}},{key:"sceneDecode",value:function(e,t,n){var r=d.default.build("Scene").decode(e);return e="%E8%AF%B7%E8%BE%93%E5%85%A5%E6%AD%A3%E7%A1%AE%E7%9A%84license.",p.default.ls&&!p.default.checkLicense(r.key,t,n)?(console.warn(decodeURIComponent(e)),null):r}},{key:"floorGeoDecode",value:function(e){return f.default.build("FloorGeo").decode(e)}},{key:"floorBizDecode",value:function(e){return f.default.build("FloorBiz").decode(e)}},{key:"floorNaviDecode",value:function(e){return f.default.build("FloorNavi").decode(e)}},{key:"disposeRoot",value:function(e){var t,n=e.ns,r=function(e,t){var n=void 0!==i&&e[o]||e["@@iterator"];if(!n){if(a(e)||(n=g(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw s}}}}(n.children);try{for(r.s();!(t=r.n()).done;){var s=t.value;s.builder=void 0,s.parent=void 0,s.children.length=0,s._fields.length=0,s._fieldsById=void 0,s._fieldsByName=void 0}}catch(e){r.e(e)}finally{r.f()}n.children.length=0,e.ns=void 0,e.ptr=void 0}},{key:"dispose",value:function(){}}]),e}(),t.default=n},function(e,t,n){"use strict";n(0)(t,"__esModule",{value:!0}),t.default=void 0,n=(n=n(157)).ProtoBuf.newBuilder({}).import({messages:[{name:"Map",fields:[{rule:"required",type:"string",name:"mid",id:1},{rule:"required",type:"int32",name:"file_ver",id:2},{rule:"required",type:"uint64",name:"date_ver",id:3},{rule:"required",type:"string",name:"mname",id:4},{rule:"required",type:"string",name:"hash_code",id:5},{rule:"optional",type:"string",name:"key",id:6},{rule:"optional",type:"string",name:"file_date",id:7},{rule:"optional",type:"string",name:"desc",id:8},{rule:"optional",type:"bool",name:"read_only",id:9,options:{default:!1}},{rule:"repeated",type:"Buffer",name:"buffers",id:10}],messages:[{name:"Buffer",fields:[{rule:"required",type:"int32",name:"gid",id:1},{rule:"required",type:"int32",name:"file_ver",id:2},{rule:"required",type:"int32",name:"btype",id:3},{rule:"required",type:"uint64",name:"len",id:4},{rule:"required",type:"bytes",name:"data",id:5}]}]}]}),t.default=n},function(e,t){},function(e,t,n){"use strict";n(0)(t,"__esModule",{value:!0}),t.default=void 0,n=(n=n(157)).ProtoBuf.newBuilder({}).import({messages:[{name:"FloorGeo",syntax:"proto2",fields:[{rule:"required",type:"string",name:"mid",id:1},{rule:"required",type:"int32",name:"gid",id:2},{rule:"optional",type:"float",name:"height",id:3},{rule:"repeated",type:"GeneralGeoInfo",name:"extentLayer",id:4},{rule:"repeated",type:"GeneralGeoInfo",name:"modelLayer",id:5},{rule:"repeated",type:"GeneralGeoInfo",name:"labelLayer",id:6},{rule:"repeated",type:"GeneralGeoInfo",name:"poiLayer",id:7},{rule:"repeated",type:"GeneralGeoInfo",name:"polygonLayer",id:8},{rule:"repeated",type:"GeneralGeoInfo",name:"polygonLabelLayer",id:9},{rule:"repeated",type:"GeneralGeoInfo",name:"liftLayer",id:10},{rule:"repeated",type:"GeneralGeoInfo",name:"stairLayer",id:11},{rule:"repeated",type:"GeneralGeoInfo",name:"escalatorLayer",id:12},{rule:"repeated",type:"GeneralGeoInfo",name:"externalModelLayer",id:13}],messages:[{name:"GeneralGeoInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"geo",id:2},{rule:"optional",type:"float",name:"height",id:3},{rule:"optional",type:"float",name:"area",id:4},{rule:"repeated",type:"Indexinfo",name:"idxs",id:5},{rule:"repeated",type:"double",name:"pts",id:6}],messages:[{name:"Indexinfo",syntax:"proto2",fields:[{rule:"repeated",type:"int32",name:"idxs",id:1}]}]}]},{name:"FloorBiz",syntax:"proto2",fields:[{rule:"required",type:"string",name:"mid",id:1},{rule:"required",type:"int32",name:"gid",id:2},{rule:"repeated",type:"ExtentBizInfo",name:"extentLayer",id:3},{rule:"repeated",type:"ModelBizInfo",name:"modelLayer",id:4},{rule:"repeated",type:"LabelBizInfo",name:"labelLayer",id:5},{rule:"repeated",type:"POIBizInfo",name:"poiLayer",id:6},{rule:"repeated",type:"PolygonBizInfo",name:"polygonLayer",id:7},{rule:"repeated",type:"LiftBizInfo",name:"liftLayer",id:8},{rule:"repeated",type:"StairBizInfo",name:"stairLayer",id:9},{rule:"repeated",type:"PolygonLabelBizInfo",name:"polygonLabelLayer",id:10},{rule:"repeated",type:"ExternalModelBizInfo",name:"externalModelLayer",id:11}],messages:[{name:"ExtentBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5}]},{name:"ModelBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5},{rule:"optional",type:"int32",name:"minlevel",id:6},{rule:"optional",type:"int32",name:"maxlevel",id:7},{rule:"optional",type:"int32",name:"pass",id:8},{rule:"optional",type:"string",name:"floorID",id:9}]},{name:"LabelBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5},{rule:"optional",type:"int32",name:"minlevel",id:6},{rule:"optional",type:"int32",name:"maxlevel",id:7}]},{name:"PolygonBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5}]},{name:"POIBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5},{rule:"optional",type:"int32",name:"minlevel",id:6},{rule:"optional",type:"int32",name:"maxlevel",id:7}]},{name:"LiftBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"int32",name:"flag",id:4},{rule:"optional",type:"string",name:"floor",id:5},{rule:"optional",type:"int32",name:"minlevel",id:6},{rule:"optional",type:"int32",name:"maxlevel",id:7}]},{name:"StairBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"int32",name:"flag",id:4},{rule:"optional",type:"int32",name:"minlevel",id:5},{rule:"optional",type:"int32",name:"maxlevel",id:6}]},{name:"PolygonLabelBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"float",name:"width",id:4},{rule:"optional",type:"string",name:"name",id:5},{rule:"optional",type:"string",name:"ename",id:6},{rule:"optional",type:"float",name:"angle",id:7}]},{name:"ExternalModelBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5},{rule:"optional",type:"int32",name:"minlevel",id:6},{rule:"optional",type:"int32",name:"maxlevel",id:7}]}]},{name:"FloorNavi",syntax:"proto2",fields:[{rule:"required",type:"string",name:"mid",id:1},{rule:"required",type:"int32",name:"gid",id:2},{rule:"repeated",type:"NaviNode",name:"naviNodes",id:3},{rule:"repeated",type:"NaviSegment",name:"naviSegments",id:4},{rule:"repeated",type:"NaviZone",name:"naviZones",id:5},{rule:"repeated",type:"NaviModel",name:"naviModels",id:6},{rule:"repeated",type:"int32",name:"nextFloors",id:7}],messages:[{name:"NaviNode",syntax:"proto2",fields:[{rule:"optional",type:"int32",name:"nodeId",id:1},{rule:"optional",type:"int32",name:"nodeType",id:2},{rule:"optional",type:"int32",name:"liftType",id:3},{rule:"optional",type:"int32",name:"liftFlag",id:4},{rule:"optional",type:"int32",name:"liftEntry",id:5},{rule:"optional",type:"string",name:"liftFloor",id:6},{rule:"optional",type:"string",name:"linkSeg",id:7},{rule:"optional",type:"string",name:"geo",id:8},{rule:"optional",type:"int32",name:"entranceType",id:9},{rule:"optional",type:"string",name:"entranceFloor",id:10},{rule:"optional",type:"int32",name:"doortype",id:11},{rule:"repeated",type:"int32",name:"idxs",id:12},{rule:"repeated",type:"double",name:"pts",id:13}]},{name:"NaviSegment",syntax:"proto2",fields:[{rule:"optional",type:"int32",name:"segmentId",id:1},{rule:"optional",type:"int32",name:"snode",id:2},{rule:"optional",type:"int32",name:"enode",id:3},{rule:"optional",type:"double",name:"length",id:4},{rule:"optional",type:"int32",name:"rank",id:5},{rule:"optional",type:"string",name:"name",id:6},{rule:"optional",type:"int32",name:"entry",id:7},{rule:"optional",type:"string",name:"desc",id:8},{rule:"optional",type:"string",name:"geo",id:9},{rule:"optional",type:"int32",name:"through",id:10},{rule:"repeated",type:"int32",name:"idxs",id:11},{rule:"repeated",type:"double",name:"pts",id:12}]},{name:"NaviZone",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"id",id:1},{rule:"required",type:"int32",name:"type",id:2,options:{default:0}},{rule:"optional",type:"string",name:"geo",id:3},{rule:"repeated",type:"int32",name:"rejects",id:4},{rule:"repeated",type:"int32",name:"idxs",id:5},{rule:"repeated",type:"double",name:"pts",id:6}]},{name:"NaviModel",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"id",id:1},{rule:"repeated",type:"int32",name:"doorids",id:2},{rule:"repeated",type:"int32",name:"nodetypes",id:3},{rule:"repeated",type:"int32",name:"entrytypes",id:4}]}]}]}),t.default=n},function(e,t,n){"use strict";n(0)(t,"__esModule",{value:!0}),t.default=void 0,n=(n=n(157)).ProtoBuf.newBuilder({}).import({messages:[{name:"Scene",fields:[{rule:"required",type:"string",name:"mid",id:19},{rule:"required",type:"int32",name:"file_ver",id:20},{rule:"required",type:"uint64",name:"date_ver",id:21},{rule:"required",type:"string",name:"mname",id:22},{rule:"required",type:"string",name:"hash_code",id:23},{rule:"optional",type:"string",name:"key",id:24},{rule:"optional",type:"string",name:"desc",id:25},{rule:"optional",type:"bool",name:"read_only",id:26,options:{default:!1}},{rule:"optional",type:"float",name:"x",id:1},{rule:"optional",type:"float",name:"y",id:2},{rule:"optional",type:"float",name:"z",id:3},{rule:"optional",type:"float",name:"minX",id:4},{rule:"optional",type:"float",name:"minY",id:5},{rule:"optional",type:"float",name:"maxX",id:6},{rule:"optional",type:"float",name:"maxY",id:7},{rule:"optional",type:"string",name:"defGid",id:8},{rule:"optional",type:"float",name:"defCenX",id:9},{rule:"optional",type:"float",name:"defCenY",id:10},{rule:"optional",type:"float",name:"defCenZ",id:11},{rule:"optional",type:"float",name:"height",id:12},{rule:"optional",type:"float",name:"rotateAngleX",id:13},{rule:"optional",type:"float",name:"rotateAngleY",id:14},{rule:"optional",type:"float",name:"rotateAngleZ",id:15},{rule:"optional",type:"float",name:"scale",id:16},{rule:"optional",type:"string",name:"scaleLevel",id:17},{rule:"repeated",type:"LayerGroup",name:"layerGroups",id:18}],messages:[{name:"Layer",fields:[{rule:"optional",type:"int32",name:"lid",id:1},{rule:"optional",type:"string",name:"lname",id:2},{rule:"optional",type:"string",name:"alias",id:3},{rule:"optional",type:"Type",name:"ltype",id:4},{rule:"optional",type:"float",name:"offsetX",id:5},{rule:"optional",type:"float",name:"offsetY",id:6},{rule:"optional",type:"float",name:"height",id:7},{rule:"optional",type:"float",name:"rotateAngleX",id:8},{rule:"optional",type:"float",name:"rotateAngleY",id:9},{rule:"optional",type:"float",name:"rotateAngleZ",id:10},{rule:"optional",type:"float",name:"minScaleLevel",id:11},{rule:"optional",type:"float",name:"maxScaleLevel",id:12},{rule:"optional",type:"bool",name:"isVisible",id:13},{rule:"optional",type:"bool",name:"isSelectable",id:14},{rule:"optional",type:"bool",name:"isEditable",id:15},{rule:"optional",type:"string",name:"desc",id:16}],enums:[{name:"Type",values:[{name:"GEOPOINT",id:1},{name:"GEOPOINT_ESCALATOR",id:2},{name:"GEOPOINT_LIFT",id:3},{name:"GEOPOINT_STAIR",id:4},{name:"GEOPOINT_PANORAMA",id:5},{name:"GEOPOINT_POI",id:6},{name:"GEOPOINT_STORELABEL",id:7},{name:"GEOPOINT_NAVINODE",id:8},{name:"GEOPOINT_MODEL",id:9},{name:"GEOLINE",id:20},{name:"GEOLINE_NAVISEGMENT",id:21},{name:"GEOLINE_BORDER",id:22},{name:"GEOPOLYGON",id:30},{name:"GEOPOLYGON_EXTENT",id:31},{name:"GEOPOLYGON_STORE",id:32},{name:"GEOPOLYGON_LABEL",id:33},{name:"RASTERATA",id:40},{name:"OVERLAYDATA",id:50}]}]},{name:"LayerGroup",fields:[{rule:"optional",type:"int32",name:"gid",id:1},{rule:"optional",type:"string",name:"gname",id:2},{rule:"optional",type:"string",name:"alias",id:3},{rule:"optional",type:"float",name:"height",id:4},{rule:"optional",type:"string",name:"desc",id:5},{rule:"repeated",type:"Layer",name:"layers",id:6}]}]}]}),t.default=n},function(e,t,n){"use strict";var r;function i(e,t){var n=(65535&e)+(65535&t);return(t=(e>>16)+(t>>16)+(n>>16))<<16|65535&n}function o(e,t,n,r,o,a){return i(function(e,t){return e<<t|e>>>32-t}(i(i(t,e),i(r,a)),o),n)}function a(e,t,n,r,i,a,s){return o(t&n|~t&r,e,t,i,a,s)}function s(e,t,n,r,i,a,s){return o(t&r|n&~r,e,t,i,a,s)}function u(e,t,n,r,i,a,s){return o(t^n^r,e,t,i,a,s)}function l(e,t,n,r,i,a,s){return o(n^(t|~r),e,t,i,a,s)}function c(e,t){var n,r,o,c;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var h=1732584193,f=-271733879,d=-1732584194,p=271733878,g=0;g<e.length;g+=16)n=h,r=f,o=d,c=p,h=a(h,f,d,p,e[g],7,-680876936),p=a(p,h,f,d,e[g+1],12,-389564586),d=a(d,p,h,f,e[g+2],17,606105819),f=a(f,d,p,h,e[g+3],22,-1044525330),h=a(h,f,d,p,e[g+4],7,-176418897),p=a(p,h,f,d,e[g+5],12,1200080426),d=a(d,p,h,f,e[g+6],17,-1473231341),f=a(f,d,p,h,e[g+7],22,-45705983),h=a(h,f,d,p,e[g+8],7,1770035416),p=a(p,h,f,d,e[g+9],12,-1958414417),d=a(d,p,h,f,e[g+10],17,-42063),f=a(f,d,p,h,e[g+11],22,-1990404162),h=a(h,f,d,p,e[g+12],7,1804603682),p=a(p,h,f,d,e[g+13],12,-40341101),d=a(d,p,h,f,e[g+14],17,-1502002290),h=s(h,f=a(f,d,p,h,e[g+15],22,1236535329),d,p,e[g+1],5,-165796510),p=s(p,h,f,d,e[g+6],9,-1069501632),d=s(d,p,h,f,e[g+11],14,643717713),f=s(f,d,p,h,e[g],20,-373897302),h=s(h,f,d,p,e[g+5],5,-701558691),p=s(p,h,f,d,e[g+10],9,38016083),d=s(d,p,h,f,e[g+15],14,-660478335),f=s(f,d,p,h,e[g+4],20,-405537848),h=s(h,f,d,p,e[g+9],5,568446438),p=s(p,h,f,d,e[g+14],9,-1019803690),d=s(d,p,h,f,e[g+3],14,-187363961),f=s(f,d,p,h,e[g+8],20,1163531501),h=s(h,f,d,p,e[g+13],5,-1444681467),p=s(p,h,f,d,e[g+2],9,-51403784),d=s(d,p,h,f,e[g+7],14,1735328473),h=u(h,f=s(f,d,p,h,e[g+12],20,-1926607734),d,p,e[g+5],4,-378558),p=u(p,h,f,d,e[g+8],11,-2022574463),d=u(d,p,h,f,e[g+11],16,1839030562),f=u(f,d,p,h,e[g+14],23,-35309556),h=u(h,f,d,p,e[g+1],4,-1530992060),p=u(p,h,f,d,e[g+4],11,1272893353),d=u(d,p,h,f,e[g+7],16,-155497632),f=u(f,d,p,h,e[g+10],23,-1094730640),h=u(h,f,d,p,e[g+13],4,681279174),p=u(p,h,f,d,e[g],11,-358537222),d=u(d,p,h,f,e[g+3],16,-722521979),f=u(f,d,p,h,e[g+6],23,76029189),h=u(h,f,d,p,e[g+9],4,-640364487),p=u(p,h,f,d,e[g+12],11,-421815835),d=u(d,p,h,f,e[g+15],16,530742520),h=l(h,f=u(f,d,p,h,e[g+2],23,-995338651),d,p,e[g],6,-198630844),p=l(p,h,f,d,e[g+7],10,1126891415),d=l(d,p,h,f,e[g+14],15,-1416354905),f=l(f,d,p,h,e[g+5],21,-57434055),h=l(h,f,d,p,e[g+12],6,1700485571),p=l(p,h,f,d,e[g+3],10,-1894986606),d=l(d,p,h,f,e[g+10],15,-1051523),f=l(f,d,p,h,e[g+1],21,-2054922799),h=l(h,f,d,p,e[g+8],6,1873313359),p=l(p,h,f,d,e[g+15],10,-30611744),d=l(d,p,h,f,e[g+6],15,-1560198380),f=l(f,d,p,h,e[g+13],21,1309151649),h=l(h,f,d,p,e[g+4],6,-145523070),p=l(p,h,f,d,e[g+11],10,-1120210379),d=l(d,p,h,f,e[g+2],15,718787259),f=l(f,d,p,h,e[g+9],21,-343485551),h=i(h,n),f=i(f,r),d=i(d,o),p=i(p,c);return[h,f,d,p]}function h(e){for(var t="",n=32*e.length,r=0;r<n;r+=8)t+=String.fromCharCode(e[r>>5]>>>r%32&255);return t}function f(e){var t=[];for(t[(e.length>>2)-1]=void 0,r=0;r<t.length;r+=1)t[r]=0;for(var n=8*e.length,r=0;r<n;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t}function d(e){for(var t,n="0123456789abcdef",r="",i=0;i<e.length;i+=1)t=e.charCodeAt(i),r+=n.charAt(t>>>4&15)+n.charAt(15&t);return r}function p(e){return unescape(encodeURIComponent(e))}function g(e){return function(e){return h(c(f(e),8*e.length))}(p(e))}function m(e){return d(g(e))}(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,r=function(e){return function(e,t,n){return m(e)}(e)},n={encryption:function(e){return r(e)}},t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(8);var a=o(n(25)),s=o(n(2)),u=o(n(3)),l=o(n(5)),c=o(n(6)),h=o(n(7)),f=(i=o(n(10)),o(n(28)));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.default)(e);return i=t?(n=(0,h.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,c.default)(this,i)}}i=function(e){(0,l.default)(n,e);var t=d(n);function n(e,r){var i;return(0,s.default)(this,n),(i=t.call(this,r.eid,f.default.FLOOR))._parseData=null,i._isInitMesh=!0,i._visible=!0,i._renderNode=null,i._geometry=void 0,i.bdata=r,i.gdata=e,i}return(0,u.default)(n,[{key:"initMesh",value:function(e,t,n,r){this._geometry&&(this._renderNode=new fm.Mesh(this._geometry.geometry,e),this._renderNode.mapNode=this,e.color=new fm.Color(n),r=(0,a.default)(r),e.opacity=r,e.userData.opacity=r,e.transparent=!0,this._renderNode.scale.set(1,-1,1),this._renderNode.rotation.set(Math.PI/2,0,0,"XYZ"),this._renderNode.position.copy(t),this._renderNode.frustumCulled=!1,this._renderNode.parent=this.parent.scene,this._renderNode.visible=this.show,this._renderNode.receiveShadow=!0,this.renderNodeInited=!0,this._renderNode.name="oneExtent",this._geometry=null)}},{key:"setByTheme",value:function(e){this._renderNode&&(this._renderNode.material.color=new fm.Color(e.floorColor),this._renderNode.material.alpha=e.floorOpacity,this._renderNode.material.userData.opacity=e.floorOpacity)}},{key:"checkByFrustum",value:function(e){this._renderNode&&this._renderNode.updateMatrixWorld(!0),this.visible=!0}},{key:"releaseGpuMemory",value:function(){this.renderNode&&(this._geometry=null,this.renderNodeInited=!1,this.renderNode.parent.remove(this.renderNode),this.dispose())}},{key:"restoreGpuMemeory",value:function(){}},{key:"getBbox",value:function(){}},{key:"dispose",value:function(){this._renderNode&&(this._renderNode.material.dispose(),this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.geometry=void 0,this._geometry=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0)}},{key:"isInitMesh",get:function(){return this._isInitMesh},set:function(e){this._isInitMesh=e}},{key:"visible",get:function(){return this._visible},set:function(e){e?this.parent.scene.children.indexOf(this._renderNode)<0&&this._renderNode&&this.parent.scene.add(this._renderNode):(this._renderNode&&this.parent.scene.remove(this._renderNode),this._renderNode.parent=this.parent.scene),this._visible=e}},{key:"renderNode",get:function(){return this._renderNode},set:function(e){this._renderNode=e}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(9);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(i=o(n(10)),o(n(221))),f=o(n(87));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}o(n(27)),i=function(e){(0,u.default)(n,e);var t=d(n);function n(e,r,i){var o;return(0,a.default)(this,n),(o=t.call(this,"externalModelLayer"))._scene=new fm.Scene,o._scene.userData.type="externalModel",o.alias="externalModel",o._models={},o.initNode(e,r),o._visible=!0,o.initLight(),o.putLight(),o}return(0,s.default)(n,[{key:"initNode",value:function(e,t){for(var n=0;n<e.length;n++)this.createNode(e[n],t[n])}},{key:"createNode",value:function(e,t){(t=new h.default(e,t)).parent=this,this._models[""+t.eid]=t}},{key:"addNodes",value:function(e){e.parent=this,e.renderNode&&this._scene.add(e.renderNode),this._models[""+e.eid]=e}},{key:"traverse",value:function(e){for(var t in this._models)e&&e(this._models[t])}},{key:"initLight",value:function(){this._target=new fm.Object3D,this._mainLight=new fm.DirectionalLight(8947848,1.2),this._mainLight.position.set(-1,1,1).normalize(),this._mainLight.target=this._target,this._secondLight=new fm.DirectionalLight(3355443),this._secondLight.position.set(-.5,1,-1).normalize(),this._secondLight.target=this._target}},{key:"putLight",value:function(){f.default.light?this._ambientLight=new fm.AmbientLight(4210752):(this._ambientLight=new fm.AmbientLight(16777215,.46),this.scene.add(this._mainLight),this.scene.add(this._secondLight),this.scene.add(this._target)),this.scene.add(this._ambientLight),this.scene.removeLight=function(){}}},{key:"removeLight",value:function(){this.scene.remove(this._mainLight),this.scene.remove(this._ambientLight),this.scene.remove(this._secondLight),this.scene.add(this._target)}},{key:"disposeLight",value:function(){this._mainLight=void 0,this._ambientLight=void 0}},{key:"getNodeById",value:function(e){return this._models[""+e]}},{key:"checkSceneNode",value:function(){for(var e in this._scene.children.length=0,this._models)this._models[e].visible&&this._models[e].renderNode&&this._scene.add(this._models[e].renderNode);this.putLight()}},{key:"dispose",value:function(){for(var e in this._models)this._models[e].dispose(),this._scene.remove(this._models[e].renderNode),this._models[e].parent=void 0,this._models[e]=void 0;this.removeLight(),this.disposeLight(),this._scene.length=0,this._scene=void 0}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.parent&&this.parent.parent&&this.parent.parent.parent&&this.parent.parent.parent.map.setRenderList()}},{key:"show",get:function(){return this.visible},set:function(e){this.visible=e}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(8),n(9);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(i=o(n(10)),o(n(222)));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}i=function(e){(0,u.default)(n,e);var t=f(n);function n(e,r){var i;return(0,a.default)(this,n),(i=t.call(this,"modelLayer"))._scene=new fm.Scene,i._scene.name="model",i._scene.userData.type="model",i.alias="model",i._models={},i.initNode(e,r),i._visible=!0,i.initLight(),i.putLight(),i}return(0,s.default)(n,[{key:"initNode",value:function(e,t){for(var n=0;n<e.length;n++)this.createNode(e[n],t[n])}},{key:"createNode",value:function(e,t){(t=new h.default(e,t)).parent=this,this._models[""+t.eid]=t}},{key:"addNodes",value:function(e){e.parent=this,e.renderNode&&this._scene.add(e.renderNode),this._models[""+e.eid]=e}},{key:"removeNode",value:function(e){e.renderNode&&this._scene.remove(e.renderNode)}},{key:"traverse",value:function(e){for(var t in this._models)e&&e(this._models[t])}},{key:"initLight",value:function(){this._ambientLight=new fm.AmbientLight(7631988),this._target=new fm.Object3D,this._mainLight=new fm.DirectionalLight(8947848,1.2),this._mainLight.name="directionalLight",this._mainLight.position.set(-1,1,1).normalize(),this._mainLight.target=this._target,this._secondLight=new fm.DirectionalLight(3355443),this._secondLight.position.set(-.5,1,-1).normalize(),this._secondLight.target=this._target}},{key:"putLight",value:function(){var e=this;this.scene.add(this._mainLight),this.scene.add(this._secondLight),this.scene.add(this._ambientLight),this.scene.add(this._target),this.scene.removeLight=function(){e.removeLight()}}},{key:"removeLight",value:function(){this.scene.remove(this._mainLight),this.scene.remove(this._ambientLight),this.scene.remove(this._secondLight)}},{key:"disposeLight",value:function(){this._mainLight=void 0,this._ambientLight=void 0}},{key:"getNodeById",value:function(e){return this._models[""+e]}},{key:"checkSceneNode",value:function(){for(var e in this._scene.children.length=0,this._models)this._models[e].visible&&this._models[e].renderNode&&this._scene.add(this._models[e].renderNode);this.putLight()}},{key:"getAllMesh",value:function(){var e,t=[];for(e in this._models)this._models[e].renderNode&&t.push(this._models[e].renderNode);return t}},{key:"getVideoMemoryAmount",value:function(){var e=null;return this.traverse((function(t){t._renderNode&&t._renderNode.geometry&&t._renderNode.geometry._bufferGeometry&&(e+=t._renderNode.geometry._bufferGeometry.attributes.position.array.byteLength,e+=t._renderNode.geometry._bufferGeometry.attributes.color.array.byteLength,e+=t._renderNode.geometry._bufferGeometry.attributes.normal.array.byteLength,e+=t._renderNode.geometry._bufferGeometry.attributes.uv.array.byteLength)})),e}},{key:"dispose",value:function(){for(var e in this._models)this._models[e].dispose(),this._scene.remove(this._models[e].renderNode),this._models[e].parent=void 0,this._models[e]=void 0;this.removeLight(),this.disposeLight(),this._scene.length=0,this._scene=void 0}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.parent&&this.parent.parent&&this.parent.parent.parent&&this.parent.parent.parent.map.setRenderList()}},{key:"show",get:function(){return this.visible},set:function(e){this.visible=e}}]),n}(i.default),t.default=i},function(e,t,n){e.exports=n(391)},function(e,t,n){n(392),e.exports=9007199254740991},function(e,t,n){(n=n(15))(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7));n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this))._scene=new fm.Scene,e}return(0,s.default)(n,[{key:"scene",get:function(){return this._scene}},{key:"show",get:function(){return this.visible},set:function(e){this.visible=e}}]),n}((n=o(n(10))).default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7));n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this))._scene=new fm.Scene,e}return(0,s.default)(n,[{key:"checkSceneNode",value:function(){}},{key:"scene",get:function(){return this._scene}},{key:"dispose",value:function(){}}]),n}((n=o(n(10))).default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(5)),u=o(n(6)),l=o(n(7)),c=o(n(233));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}n=function(e){(0,s.default)(n,e);var t=h(n);function n(e,r,i){var o;return(0,a.default)(this,n),o=t.call(this,e,r),i&&(r=(e=new c.default).createGeometry(1.5,20,24,.5),(e=new fm.BufferGeometry).addAttribute("position",new fm.Float32BufferAttribute(r.vertice,3)),e.addAttribute("uv",new fm.Float32BufferAttribute(r.uv,2)),e.setIndex(new fm.Uint16BufferAttribute(r.index,1)),o.geometry=e,o.material=new fm.MeshBasicMaterial({map:i,depthTest:!1}),o.material.side=2,o.material.transparent=!0),o}return n}(fm.Mesh),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(5)),u=o(n(6)),l=o(n(7));n=function(e){(0,s.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}(n);function n(){return(0,a.default)(this,n),t.call(this)}return n}((n=o(n(10))).default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(8);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7));n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this))._scene=new fm.Scene,e._scene.name="waterMarker",e._scene.userData.type="waterMarker",e._visible=!0,e.waters=[],e.initLight(),e.putLight(),e}return(0,s.default)(n,[{key:"addMarker",value:function(e){e.parent=this,e.isInitWater||(e.initWater(),e.renderNode&&(this.waters.push(e),this._scene.add(e.renderNode),e.floorNode&&this._scene.add(e.floorNode)))}},{key:"removeMarker",value:function(e){if(!e.renderNode)return!1;for(var t=0;t<this.waters.length;t++)if(this.waters[t].renderNode.uuid===e.renderNode.uuid){this.waters.splice(t,1);break}this._scene.remove(e.renderNode)}},{key:"removeAll",value:function(){for(var e=0;e<this.waters.length;e++)this._scene.remove(this.waters[e].renderNode);this.waters=[]}},{key:"checkSceneNode",value:function(){this._scene.children.length=0;for(var e=0;e<this.waters.length;e++)this.waters[e].visible&&this.waters[e].renderNode&&this._scene.add(this.waters[e].renderNode)}},{key:"initLight",value:function(){this._ambientLight=new fm.AmbientLight(7631988),this._target=new fm.Object3D,this._mainLight=new fm.DirectionalLight(8947848,1.2),this._mainLight.position.set(-1,1,1).normalize(),this._mainLight.target=this._target,this._secondLight=new fm.DirectionalLight(3355443),this._secondLight.position.set(-.5,1,-1).normalize(),this._secondLight.target=this._target}},{key:"putLight",value:function(){var e=this;this.scene.add(this._mainLight),this.scene.add(this._ambientLight),this.scene.add(this._secondLight),this.scene.add(this._target),this.scene.removeLight=function(){e.removeLight()}}},{key:"dispose",value:function(){for(var e=0;e<this.waters.length;e++)this._scene.remove(this.waters[e].renderNode),this.waters[e].parent=void 0,this.waters[e]=void 0;this._scene.length=0,this._scene=void 0}},{key:"scene",get:function(){return this._scene}},{key:"visible",get:function(){return this._visible}}]),n}((n=o(n(10))).default),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(61),n(13),n(9);var o=i(n(53)),a=i(n(2)),s=i(n(3)),u=1e-5;n=function(){function e(t){(0,a.default)(this,e);var n,r,i,s,u,f,d,p=[];if(this.Polygon=l,this.Vertex=c,this.Node=h,t instanceof fm.Geometry)this.matrix=new fm.Matrix4;else{if(!(t instanceof fm.Mesh)){if(t instanceof h)return this.tree=t,this.matrix=new fm.Matrix4,this;throw"ThreeBSP: Given geometry is unsupported"}t.updateMatrix(),this.matrix=t.matrix.clone(),t=t.geometry}for(n=0,r=t.faces.length;n<r;n++){if(i=t.faces[n],u=t.faceVertexUvs[0][n],d=new l,i instanceof fm.Face3)s=t.vertices[i.a],f=u?new fm.Vector2(u[0].x,u[0].y):null,(s=new c(s.x,s.y,s.z,i.vertexNormals[0],f)).applyMatrix4(this.matrix),d.vertices.push(s),s=t.vertices[i.b],f=u?new fm.Vector2(u[1].x,u[1].y):null,(s=new c(s.x,s.y,s.z,i.vertexNormals[1],f)).applyMatrix4(this.matrix),d.vertices.push(s),s=t.vertices[i.c],f=u?new fm.Vector2(u[2].x,u[2].y):null,(s=new c(s.x,s.y,s.z,i.vertexNormals[2],f)).applyMatrix4(this.matrix),d.vertices.push(s);else{if(!(0,o.default)(fm.Face4))throw"Invalid face type at index "+n;s=t.vertices[i.a],f=u?new fm.Vector2(u[0].x,u[0].y):null,(s=new c(s.x,s.y,s.z,i.vertexNormals[0],f)).applyMatrix4(this.matrix),d.vertices.push(s),s=t.vertices[i.b],f=u?new fm.Vector2(u[1].x,u[1].y):null,(s=new c(s.x,s.y,s.z,i.vertexNormals[1],f)).applyMatrix4(this.matrix),d.vertices.push(s),s=t.vertices[i.c],f=u?new fm.Vector2(u[2].x,u[2].y):null,(s=new c(s.x,s.y,s.z,i.vertexNormals[2],f)).applyMatrix4(this.matrix),d.vertices.push(s),s=t.vertices[i.d],f=u?new fm.Vector2(u[3].x,u[3].y):null,(s=new c(s.x,s.y,s.z,i.vertexNormals[3],f)).applyMatrix4(this.matrix),d.vertices.push(s)}d.calculateProperties(),p.push(d)}this.tree=new h(p)}return(0,s.default)(e,[{key:"subtract",value:function(t){var n=this.tree.clone();return t=t.tree.clone(),n.invert(),n.clipTo(t),t.clipTo(n),t.invert(),t.clipTo(n),t.invert(),n.build(t.allPolygons()),n.invert(),(n=new e(n)).matrix=this.matrix,n}},{key:"union",value:function(t){var n=this.tree.clone();return t=t.tree.clone(),n.clipTo(t),t.clipTo(n),t.invert(),t.clipTo(n),t.invert(),n.build(t.allPolygons()),(n=new e(n)).matrix=this.matrix,n}},{key:"intersect",value:function(t){var n=this.tree.clone();return t=t.tree.clone(),n.invert(),t.clipTo(n),t.invert(),n.clipTo(t),t.clipTo(n),n.build(t.allPolygons()),n.invert(),(n=new e(n)).matrix=this.matrix,n}},{key:"toGeometry",value:function(){for(var e,t,n,r,i,o,a,s=(new fm.Matrix4).getInverse(this.matrix),u=new fm.Geometry,l=this.tree.allPolygons(),c=l.length,h={},f=0;f<c;f++)for(n=(t=l[f]).vertices.length,e=2;e<n;e++)a=[],o=t.vertices[0],a.push(new fm.Vector2(o.uv.x,o.uv.y)),(o=new fm.Vector3(o.x,o.y,o.z)).applyMatrix4(s),r=void 0!==h[o.x+","+o.y+","+o.z]?h[o.x+","+o.y+","+o.z]:(u.vertices.push(o),h[o.x+","+o.y+","+o.z]=u.vertices.length-1),o=t.vertices[e-1],a.push(new fm.Vector2(o.uv.x,o.uv.y)),(o=new fm.Vector3(o.x,o.y,o.z)).applyMatrix4(s),i=void 0!==h[o.x+","+o.y+","+o.z]?h[o.x+","+o.y+","+o.z]:(u.vertices.push(o),h[o.x+","+o.y+","+o.z]=u.vertices.length-1),o=t.vertices[e],a.push(new fm.Vector2(o.uv.x,o.uv.y)),(o=new fm.Vector3(o.x,o.y,o.z)).applyMatrix4(s),o=void 0!==h[o.x+","+o.y+","+o.z]?h[o.x+","+o.y+","+o.z]:(u.vertices.push(o),h[o.x+","+o.y+","+o.z]=u.vertices.length-1),o=new fm.Face3(r,i,o,new fm.Vector3(t.normal.x,t.normal.y,t.normal.z)),u.faces.push(o),u.faceVertexUvs[0].push(a);return u}},{key:"toMesh",value:function(e){var t=this.toGeometry();return(e=new fm.Mesh(t,e)).position.setFromMatrixPosition(this.matrix),e.rotation.setFromRotationMatrix(this.matrix),e}}]),e}(),t.default=n;var l=function(){function e(t,n,r){(0,a.default)(this,e),t instanceof Array||(t=[]),this.vertices=t,0<t.length?this.calculateProperties():this.normal=this.w=void 0}return(0,s.default)(e,[{key:"calculateProperties",value:function(){var e=this.vertices[0],t=this.vertices[1],n=this.vertices[2];return this.normal=t.clone().subtract(e).cross(n.clone().subtract(e)).normalize(),this.w=this.normal.clone().dot(e),this}},{key:"clone",value:function(){for(var t=new e,n=0,r=this.vertices.length;n<r;n++)t.vertices.push(this.vertices[n].clone());return t.calculateProperties(),t}},{key:"flip",value:function(){var e,t=[];for(this.normal.multiplyScalar(-1),this.w*=-1,e=this.vertices.length-1;0<=e;e--)t.push(this.vertices[e]);return this.vertices=t,this}},{key:"classifyVertex",value:function(e){return(e=this.normal.dot(e)-this.w)<-u?2:u<e?1:0}},{key:"classifySide",value:function(e){for(var t,n=0,r=0,i=e.vertices.length,o=0;o<i;o++)t=e.vertices[o],1===(t=this.classifyVertex(t))?n++:2===t&&r++;return n===i&&0===r?1:0===n&&r===i?2:0<n&&0<r?3:0}},{key:"splitPolygon",value:function(t,n,r,i,o){var a=this.classifySide(t);if(0===a)(0<this.normal.dot(t.normal)?n:r).push(t);else if(1===a)i.push(t);else if(2===a)o.push(t);else{for(var s,u,l,c,h=[],f=[],d=0,p=t.vertices.length;d<p;d++)c=(d+1)%p,u=t.vertices[d],l=t.vertices[c],s=this.classifyVertex(u),c=this.classifyVertex(l),2!=s&&h.push(u),1!=s&&f.push(u),3==(s|c)&&(c=(this.w-this.normal.dot(u))/this.normal.dot(l.clone().subtract(u)),c=u.interpolate(l,c),h.push(c),f.push(c));3<=h.length&&i.push(new e(h).calculateProperties()),3<=f.length&&o.push(new e(f).calculateProperties())}}}]),e}(),c=function(){function e(t,n,r,i,o){(0,a.default)(this,e),this.x=t,this.y=n,this.z=r,this.normal=i||new fm.Vector3,this.uv=o||new fm.Vector2}return(0,s.default)(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.z,this.normal.clone(),this.uv.clone())}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"subtract",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"cross",value:function(e){var t=this.x,n=this.y,r=this.z;return this.x=n*e.z-r*e.y,this.y=r*e.x-t*e.z,this.z=t*e.y-n*e.x,this}},{key:"normalize",value:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.x/=e,this.y/=e,this.z/=e,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lerp",value:function(e,t){return this.add(e.clone().subtract(this).multiplyScalar(t)),this.normal.add(e.normal.clone().sub(this.normal).multiplyScalar(t)),this.uv.add(e.uv.clone().sub(this.uv).multiplyScalar(t)),this}},{key:"interpolate",value:function(e,t){return this.clone().lerp(e,t)}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z;return e=e.elements,this.x=e[0]*t+e[4]*n+e[8]*r+e[12],this.y=e[1]*t+e[5]*n+e[9]*r+e[13],this.z=e[2]*t+e[6]*n+e[10]*r+e[14],this}}]),e}(),h=function(){function e(t){(0,a.default)(this,e);var n,r,i=[],o=[];if(this.polygons=[],this.front=this.back=void 0,t instanceof Array&&0!==t.length){for(this.divider=t[0].clone(),n=0,r=t.length;n<r;n++)this.divider.splitPolygon(t[n],this.polygons,this.polygons,i,o);0<i.length&&(this.front=new e(i)),0<o.length&&(this.back=new e(o))}}return(0,s.default)(e,[{key:"isConvex",value:function(e){for(var t,n=0;n<e.length;n++)for(t=0;t<e.length;t++)if(n!==t&&2!==e[n].classifySide(e[t]))return!1;return!0}},{key:"build",value:function(t){var n,r,i=[],o=[];for(this.divider||(this.divider=t[0].clone()),n=0,r=t.length;n<r;n++)this.divider.splitPolygon(t[n],this.polygons,this.polygons,i,o);0<i.length&&(this.front||(this.front=new e),this.front.build(i)),0<o.length&&(this.back||(this.back=new e),this.back.build(o))}},{key:"allPolygons",value:function(){var e=this.polygons.slice();return this.front&&(e=e.concat(this.front.allPolygons())),this.back&&(e=e.concat(this.back.allPolygons())),e}},{key:"clone",value:function(){var t=new e;return t.divider=this.divider.clone(),t.polygons=this.polygons.map((function(e){return e.clone()})),t.front=this.front&&this.front.clone(),t.back=this.back&&this.back.clone(),t}},{key:"invert",value:function(){for(var e,t=0,n=this.polygons.length;t<n;t++)this.polygons[t].flip();return this.divider.flip(),this.front&&this.front.invert(),this.back&&this.back.invert(),e=this.front,this.front=this.back,this.back=e,this}},{key:"clipPolygons",value:function(e){var t,n,r,i;if(!this.divider)return e.slice();for(r=[],i=[],t=0,n=e.length;t<n;t++)this.divider.splitPolygon(e[t],r,i,r,i);return this.front&&(r=this.front.clipPolygons(r)),i=this.back?this.back.clipPolygons(i):[],r.concat(i)}},{key:"clipTo",value:function(e){this.polygons=e.clipPolygons(this.polygons),this.front&&this.front.clipTo(e),this.back&&this.back.clipTo(e)}}]),e}()},function(e,t,n){"use strict";var r=n(16),i=n(17),o=n(18),a=n(11),s=n(0);n(13),n(14),n(8);var u=n(1);s(t,"__esModule",{value:!0}),t.default=void 0,n(9),n(21),n(116),n(103),n(64),n(400);var l=u(n(25)),c=u(n(35)),h=u(n(19)),f=u(n(2)),d=u(n(3)),p=u(n(65)),g=n(401),m=n(402);function v(e,t){var n=void 0!==i&&e[o]||e["@@iterator"];if(!n){if(a(e)||(n=y(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw s}}}}function y(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(){function e(t){(0,f.default)(this,e),this._data={},this._textureData={},this._textureArray=[],this.font=t,this._textData={},this.extrudeMaterial={},this.is_Weixin=!1,this.is_WeixinMini=!1}return(0,d.default)(e,[{key:"createBasicMaterial",value:function(e){var t=new fm.MeshBasicMaterial;return e?(t.color=new fm.Color(e.color),t.transparent=!0,t.depthWrite=!0,t.opacity=(0,l.default)(e.alpha),t.userData.opacity=(0,l.default)(e.alpha)):t.userData.opacity=1,t}},{key:"createNormalMaterial",value:function(e){var t=new fm.MeshLambertMaterial;return e?(t.color=new fm.Color(e.color),t.transparent=!0,t.depthWrite=!0,t.opacity=(0,l.default)(e.alpha),t.userData.opacity=(0,l.default)(e.alpha)):t.userData.opacity=1,t}},{key:"createPhysicMaterial",value:function(e){var t=new fm.MeshStandardMaterial({roughness:.5,metalness:.5});return e?(t.color=new fm.Color(e.color),t.transparent=!0,t.depthWrite=!0,t.opacity=(0,l.default)(e.alpha),t.userData.opacity=(0,l.default)(e.alpha)):t.userData.opacity=1,t}},{key:"createMeshPhongMaterial",value:function(e){var t=new fm.MeshPhongMaterial({shininess:50,specular:16777215});return e?(t.color=new fm.Color(e.color),t.transparent=!0,t.depthWrite=!0,t.opacity=(0,l.default)(e.alpha),t.userData.opacity=(0,l.default)(e.alpha)):t.userData.opacity=1,t}},{key:"createLineMaterial",value:function(e){if(!e)return new fm.LineBasicMaterial({color:"#ff0000",linewidth:1,transparent:!0,opacity:1});var t="#ff0000";return t={color:t="number"==typeof e.strokeColor?e.strokeColor:e.strokeColor||"#ff0000",linewidth:1,transparent:!0,opacity:(0,l.default)(e.alpha)},(t=new fm.LineBasicMaterial(t)).userData.opacity=(0,l.default)(e.alpha),t}},{key:"createPoiMaterial",value:function(e,t,n,r){var i,o,a=this,s=new fm.SpriteMaterial;return s.sizeAttenuation=!1,s.opacity=1,s.userData.opacity=1,s.depthTest=!!n,s.depthWrite=!!n,s.transparent=!0,s.side=2,s.priority=r,s.visible=!1,this._textureData[e.imageUrl]?((o=this._textureData[e.imageUrl]).minFilter=fm.LinearFilter,o.generateMipmaps=!1,o.needsUpdate=!0,s.map=o,s.needsUpdate=!0,s.userData.scaleRatio=o.scaleRatio,s.visible=!0,t&&t()):((i=new Image).crossOrigin="Anonymous",r=navigator.userAgent,r=(o=/(msie\s|trident.*rv:)([\w.]+)/).exec(r.toLowerCase()),i.onload=null!==r?new function(){var n=new fm.Texture(i);n.minFilter=fm.LinearFilter,n.generateMipmaps=!1,n.needsUpdate=!0,n.scaleRatio=i.width/i.height,s.userData.scaleRatio=n.scaleRatio,s.map=n,s.needsUpdate=!0,s.visible=!0,a._textureData[e.imageUrl]=n,a._textureArray.push(n),t&&t()}:function(){var n=new fm.Texture(i);n.minFilter=fm.LinearFilter,n.generateMipmaps=!1,n.needsUpdate=!0,n.scaleRatio=i.width/i.height,s.userData.scaleRatio=n.scaleRatio,s.map=n,s.needsUpdate=!0,s.visible=!0,a._textureData[e.imageUrl]=n,a._textureArray.push(n),t&&t()},i.src=e.imageSrc),s}},{key:"createLabelMaterial",value:function(e,t,n){var r,i,o,a=this,s=new fm.SpriteMaterial;return s.sizeAttenuation=!1,s.opacity=(0,l.default)(t.alpha),s.userData.opacity=(0,l.default)(t.alpha),s.depthTest=!!n,s.depthWrite=!!n,s.transparent=!0,s.side=2,s.opacity=1,s.visible=!1,t.imageSrc?this._data[t.imageUrl]?(i=this._data[t.imageUrl],i=this.excuteLabelTexture(e,i,t),s.map=i,this._textureArray.push(i),s.userData.scaleRatio=s.map.scaleRatio,s.userData.mspriteScale=s.map.mspriteScale,s.needsUpdate=!0,s.visible=!0):(r=new Image,i=a.excuteLabelTexture(e,!0,t,!0),r.crossOrigin="Anonymous",s.userData.scaleRatio=i.scaleRatio,s.userData.mspriteScale=i.mspriteScale,o=navigator.userAgent,o=(i=/(msie\s|trident.*rv:)([\w.]+)/).exec(o.toLowerCase()),r.onload=null!==o?new function(){var n=a.excuteLabelTexture(e,r,t);s.map=n,a._textureArray.push(n),s.needsUpdate=!0,s.visible=!0,a._data[t.imageUrl]=r}:function(){var n=a.excuteLabelTexture(e,r,t);s.map=n,a._textureArray.push(n),s.needsUpdate=!0,s.visible=!0,a._data[t.imageUrl]=r},r.src=t.imageSrc):(o=this.excuteLabelTexture(e,!1,t),s.map=o,this._textureArray.push(o),s.userData.scaleRatio=s.map.scaleRatio,s.userData.mspriteScale=s.map.mspriteScale,s.needsUpdate=!0,s.visible=!0),s}},{key:"excuteSDFLabelTexture",value:function(e,t,n,r){var i=12,o=2;t||(i=0,o=0);var a=1,s=2,u=document.createElement("canvas"),l=u.getContext("2d"),h=this.font.family;l.font="14px "+h;var f=-1<e.indexOf("%rn%");if(f){var d,g=e.split("%rn%"),m=0,y=0,_=v(g);try{for(_.s();!(d=_.n()).done;){var x=d.value;m=Math.max(l.measureText(x).width,m),y+=14}}catch(e){_.e(e)}finally{_.f()}y+=2*(g.length-1),a=g.length,A=m+o+i+6,I=Math.max(y,i)+6}else var A=l.measureText(e).width+o+i+6,I=Math.max(14,i)+6;if(r)return{scaleRatio:I/A,mspriteScale:a};u.width=A,u.height=I,u.style.width=A+"px",u.style.height=I+"px",(n.platecolor||n.platestrokecolor)&&(r=n.platecolor.split(","),n.platecolor&&(l.fillStyle="rgb(".concat((0,c.default)(r[0]),",").concat((0,c.default)(r[1]),",").concat((0,c.default)(r[2]),")")),l.lineWidth=1,this.drawRadiuRect(l,A,I,5,{x:0,y:0}),n.platecolor&&l.fill(),n.platestrokecolor&&(b=n.platestrokecolor.split(","),l.strokeStyle="rgb(".concat((0,c.default)(b[0]),",").concat((0,c.default)(b[1]),",").concat((0,c.default)(b[2]),")"),l.stroke()),l.beginPath());var w=i+o,b=(I-i)/2;if(o=(I-14)/2,l.font="14px "+h,l.textBaseline="top",l.strokeStyle=p.default.toRgba(n.strokecolor),l.lineWidth=s,I=0,h=!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),s=navigator.vendor&&-1<navigator.vendor.indexOf("Apple")&&navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS"),(-1<navigator.userAgent.indexOf("Edge")||h||s)&&(I=-4),I*=1,f)for(var C=3,M=0;M<g.length;M++)M&&(C+=16),l.strokeText(g[M],w,C);else l.strokeText(e,w,o+1.5+I);if(l.fillStyle=p.default.toRgba(n.fillcolor),f)for(var E=3,T=0;T<g.length;T++)T&&(E+=16),l.fillText(g[T],w,E);else l.fillText(e,w,o+1.5+I);return t&&l.drawImage(t,0,b,i,i),(i=new fm.CanvasTexture(u)).minFilter=fm.LinearFilter,i.generateMipmaps=!1,i.scaleRatio=u.height/u.width,i.mspriteScale=a,i}},{key:"excuteLabelTexture",value:function(e,t,n,r){var i=2,o=1.5*i,a=1.2*(n=(0,h.default)({},n)).fontsize*i,s=2*i;t||(a=0,s=5*i);var u=2*i,c=3*i,f=3*i,d=n.fontsize*i*1.2,g=1,m=2*i,y=document.createElement("canvas"),_=y.getContext("2d"),x=this.font.family;_.font=d+"px "+x;var A=-1<e.indexOf("%rn%");if(A){var I,w=e.split("%rn%"),b=0,C=0,M=v(w);try{for(M.s();!(I=M.n()).done;){var E=I.value;b=Math.max(_.measureText(E).width,b),C+=d}}catch(e){M.e(e)}finally{M.f()}C+=(w.length-1)*u,T=b+s+a+2*f,g=(S=Math.max(C,a)+2*c)/(d+2*c)}else var T=_.measureText(e).width+s+a+2*f,S=Math.max(d,a)+2*c;if(r)return{scaleRatio:S/T,mspriteScale:g};y.width=T,y.height=S,y.style.width=T+"px",y.style.height=S+"px",(n.platecolor||n.platestrokecolor)&&(n.platecolor&&(_.fillStyle=p.default.toRgba(n.platecolor)),_.lineWidth=i,this.drawRadiuRect(_,T-a,S,5*i,{x:0+a,y:0}),n.platecolor&&_.fill(),n.platestrokecolor&&(_.strokeStyle=p.default.toRgba(n.platestrokecolor),_.stroke()),_.beginPath());var L=a+s;f=(S-a)/2,r=(S-d)/2,_.font=d+"px "+x,_.textBaseline="top",_.lineWidth=m*(n.strokewidth||1),s=1,n.strokewidth&&(s=(0,l.default)(n.strokewidth)),S=0;var k,R=!1,N=navigator.mimeTypes;for(k in N)"application/vnd.chromium.remoting-viewer"==N[k].type&&(R=!0);if(R&&(S=-4-(d-28)/6),x=!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),m=navigator.vendor&&-1<navigator.vendor.indexOf("Apple")&&navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS"),(-1<navigator.userAgent.indexOf("Edge")||x||m)&&(S=-4-(d-28)/6),(-1<navigator.userAgent.indexOf("QQBrowser")||x||m)&&(S=-4-(d-28)/6),(-1<navigator.userAgent.indexOf(".NET4.0C")||x||m)&&(S=-4-(d-28)/6),S*=i,i=0,!this.is_Weixin||this.is_WeixinMini||x||m||(i=10),n.strokecolor&&0!==s)if(_.strokeStyle=p.default.toRgba(n.strokecolor),A)for(var P=c,O=0;O<w.length;O++)O&&(P+=d+u),t?_.strokeText(w[O],L,P):"left"==n.textAlign?(_.textAlign="left",_.strokeText(w[O],0,P)):"right"==n.textAlign?(_.textAlign="right",_.strokeText(w[O],T,P)):(_.textAlign="center",_.strokeText(w[O],T/2,P));else t?_.strokeText(e,L,r+o+S+i):"left"==n.textAlign?_.strokeText(e,0,r+o+S+i):"right"==n.textAlign?(_.textAlign="right",_.strokeText(e,T,r+o+S+i)):(_.textAlign="center",_.strokeText(e,T/2,r+o+S+i));if(_.fillStyle=p.default.toRgba(n.fillcolor),A)for(var D=c,F=0;F<w.length;F++)F&&(D+=d+u),t?_.fillText(w[F],L,D):"left"===n.textAlign?(_.textAlign="left",_.fillText(w[F],0,D)):"right"===n.textAlign?(_.textAlign="right",_.fillText(w[F],T,D)):(_.textAlign="center",_.fillText(w[F],T/2,D));else t?_.fillText(e,L,r+o+S+i):"left"==n.textAlign?(_.textAlign="left",_.fillText(e,0,r+o+S+i)):"right"==n.textAlign?(_.textAlign="right",_.fillText(e,T,r+o+S+i)):(_.textAlign="center",_.fillText(e,T/2,r+o+S+i));return t&&_.drawImage(t,0,f,a,a),(a=new fm.CanvasTexture(y)).minFilter=fm.LinearFilter,a.generateMipmaps=!1,a.scaleRatio=y.height/y.width,a.mspriteScale=g,a}},{key:"createTextMaterial",value:function(e,t){var n=new fm.SpriteMaterial;return n.sizeAttenuation=!1,n.opacity=(0,l.default)(1),n.userData.opacity=(0,l.default)(1),n.depthTest=!1,n.depthWrite=!1,n.transparent=!0,n.side=2,t=this.executeTexTexture(e,t),n.map=t,n.size=t.size,n.userData.scaleRatio=n.map.scaleRatio,n.userData.mspriteScale=n.map.mspriteScale,n.needsUpdate=!0,n}},{key:"executeTexTexture",value:function(e,t,n,r){this.parent;var i=24,o=4;n||(i=0,o=0);var a,s,u=6,l=1,c=(n=document.createElement("canvas")).getContext("2d"),h=this.font.family,f=0,d=0,g=v(e);try{for(g.s();!(s=g.n()).done;){var m=s.value,y=2*m.fontsize;c.font=y+"px "+h,f=Math.max(c.measureText(m.text).width,f),d+=y}}catch(e){g.e(e)}finally{g.f()}if(d+=4*(e.length-1),l=e.length,a=f+o+i+2*u,u=Math.max(d,i)+12,r)return{scaleRatio:u/a,mspriteScale:l};n.width=a,n.height=u,n.style.width=a+"px",n.style.height=u+"px",t.platecolor&&(c.fillStyle=p.default.toRgba(t.platecolor),c.lineWidth=2,this.drawRadiuRect(c,a,u,10,{x:0,y:0}),c.fill(),t.platestrokecolor&&(c.strokeStyle=p.default.toRgba(t.platestrokecolor),c.stroke()),c.beginPath());var _,x=4,A=!1,I=navigator.mimeTypes;for(_ in I)"application/vnd.chromium.remoting-viewer"==I[_].type&&(A=!0);u=-6,u+=8*(e.length-1),A&&(x=u-(d-28)/6),i=!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),o=navigator.vendor&&-1<navigator.vendor.indexOf("Apple")&&navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS"),(-1<navigator.userAgent.indexOf("Edge")||i||o)&&(x=u-(d-28)/6),(-1<navigator.userAgent.indexOf("QQBrowser")||i||o)&&(x=u-(d-28)/6),(-1<navigator.userAgent.indexOf(".NET4.0C")||i||o)&&(x=u-(d-28)/6),c.textBaseline="top";for(var w,b=6,C=0;C<e.length;C++)e[C].strokecolor&&(c.lineWidth=4,w=2*e[C].fontsize,c.font=w+"px "+h,c.strokeStyle=p.default.toRgba(e[C].strokecolor),C&&(b+=2*e[C-1].fontsize+4),0==t.textAlign?(c.textAlign="left",c.strokeText(e[C].text,0,b+x)):2==t.textAlign?(c.textAlign="right",c.strokeText(e[C].text,a,b+x)):(c.textAlign="center",c.strokeText(e[C].text,a/2,b+x)));b=6;for(var M=0;M<e.length;M++){var E=2*e[M].fontsize;c.font=E+"px "+h,c.fillStyle=p.default.toRgba(e[M].fontcolor),M&&(b+=2*e[M-1].fontsize+4),0==t.textAlign?(c.textAlign="left",c.fillText(e[M].text,0,b+x)):2==t.textAlign?(c.textAlign="right",c.fillText(e[M].text,a,b+x)):(c.textAlign="center",c.fillText(e[M].text,a/2,b+x))}(u=new fm.CanvasTexture(n)).minFilter=fm.LinearFilter,u.generateMipmaps=!1,u.scaleRatio=n.height/n.width,u.mspriteScale=l;for(var T=0,S=(l=null,0);S<e.length;S++)T+=e[S].fontsize;return l=1<e.length?(T+4*(e.length-1)+6)/e.length:T+6,u.size=l,u}},{key:"drawRadiuRect",value:function(e,t,n,r,i){var o=i,a={x:i.x+t,y:i.y},s={x:i.x,y:i.y+n},u={x:i.x+t,y:i.y+n},l={x:o.x+r,y:o.y},c={x:a.x-r,y:a.y},h={x:a.x,y:a.y+r},f={x:u.x,y:u.y-r},d={x:u.x-r,y:u.y};t={x:s.x+r,y:s.y},i={x:s.x,y:s.y-r},n={x:o.x,y:o.y+r},e.beginPath(),e.moveTo(l.x,l.y),e.lineTo(c.x,c.y),e.arcTo(a.x,a.y,h.x,h.y,r),e.lineTo(f.x,f.y),e.arcTo(u.x,u.y,d.x,d.y,r),e.lineTo(t.x,t.y),e.arcTo(s.x,s.y,i.x,i.y,r),e.lineTo(n.x,n.y),e.arcTo(o.x,o.y,l.x,l.y,r),e.closePath()}},{key:"measureText",value:function(e,t,n){var r=document.createElement("div");return r.style.fontSize=n+"px",r.style.position="absolute",r.style.fontStyle=e,r.style.whiteSpace="nowrap",r.innerHTML=t,t={width:r.clientWidth,height:r.clientHeight},document.body.removeChild(r),t}},{key:"loadTexture",value:function(e,t){var n=this,r=new fm.Texture;if("string"!=typeof e)return r.image=e,r.needsUpdate=!0,t(r),r;"data"!==e.substring(0,4)&&this._textureData[e]&&t(this._textureData[e]);var i=new Image;return i.crossOrigin="Anonymous",this._textureArray.push(r),i.onload=function(){r.image=i,"data"!==e.substring(0,4)&&(n._textureData[e]=r),r.needsUpdate=!0,t(r)},i.src=e,r}},{key:"getHeatMapGradient",value:function(e){var t=document.createElement("canvas"),n=t.getContext("2d");t.width=8,t.height=128,t.style.width="8px",t.style.height="128px";var r,i=n.createLinearGradient(0,0,8,128);for(r in e)i.addColorStop(r,e[r]);return n.fillStyle=i,n.fillRect(0,0,8,128),t=new fm.CanvasTexture(t),this._textureArray.push(t),t}},{key:"createNormalLineTexture",value:function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=e.width,i=e.height;t.width=r,t.height=i,t.style.width=r+"px",t.style.height=i+"px";var o=0,a=e.dashArray,s=a.reduce((function(e,t){return e+t})),u=new fm.Matrix3;u.set(Math.cos(Math.PI/2),-Math.sin(Math.PI/2),+r/2,Math.sin(Math.PI/2),Math.cos(Math.PI/2),+i/2,0,0,1);var l=new fm.Matrix3;return l.set(1,0,-r/2,0,1,-i/2,0,0,1),u.multiply(l),u=u.elements,n.transform(u[0],u[3],u[1],u[4],u[2],u[6]),a.forEach((function(t,r){r%2==0&&(n.fillStyle=e.color,n.fillRect(o/s*e.width,0,t/s*e.width,e.height)),o+=t})),new fm.CanvasTexture(t)}},{key:"createArrowLineTexture",value:function(e){var t=e,n=document.createElement("canvas"),r=n.getContext("2d"),i=e.width,o=e.height;n.width=i,n.height=o,n.style.width=i+"px",n.style.height=o+"px";var a=(1-t.arrowHeightPercent)*t.height/2,s=t.height*t.arrowHeightPercent,u=new fm.Matrix3;return u.set(Math.cos(Math.PI/2),-Math.sin(Math.PI/2),+i/2,Math.sin(Math.PI/2),Math.cos(Math.PI/2),+o/2,0,0,1),(e=new fm.Matrix3).set(1,0,-i/2,0,1,-o/2,0,0,1),u.multiply(e),u=u.elements,r.transform(u[0],u[3],u[1],u[4],u[2],u[6]),r.beginPath(),r.moveTo(0,a),u=t.width*(t.arrowWidthPercent-t.arrowPercent),r.lineTo(u,a),r.lineTo(t.width*t.arrowWidthPercent,a+s/2),r.lineTo(u,a+s),r.lineTo(0,a+s),r.lineTo(t.width*t.arrowPercent,a+s/2),r.closePath(),r.fillStyle=t.color,r.fill(),new fm.CanvasTexture(n)}},{key:"createArrowWidthBackTexture",value:function(e){var t=e,n=document.createElement("canvas"),r=n.getContext("2d"),i=e.width,o=e.height;n.width=i,n.height=o,n.style.width=i+"px",n.style.height=o+"px",r.fillStyle=t.godEdgeColor,r.fillRect(0,0,t.width,t.height);var a=t.width*(1-t.godEdgePercent);r.fillStyle=t.godColor,r.fillRect((t.width-a)/2,0,a,t.height),r.fillStyle="#ffffff",r.shadowOffsetX=-2,r.shadowOffsetY=2,r.shadowBlur=4,r.shadowColor="rgba(0,0,0,0.5)";var s={x:t.width/2,y:t.height/2};return e=t.height*t.godArrowPercent,i=a*t.godArrowWidthPercent,o=t.arrawWidth||10,a=s.x-i/2,s=s.y+e/2,r.beginPath(),r.moveTo(a,s),r.lineTo(a,s+o),r.lineTo(a+i/2,s-e+o),r.lineTo(a+i,s+o),r.lineTo(a+i,s),r.lineTo(a+i/2,s-e),r.closePath(),r.fillStyle=t.godArrowColor,r.fill(),new fm.CanvasTexture(n)}},{key:"rotateCanvas",value:function(e,t,n,r){var i=document.createElement("canvas"),o=i.getContext("2d");i.width=n,i.height=r,i.style.width=n+"px",i.style.height=r+"px",o.drawImage(e,0,0,n,r)}},{key:"dispose",value:function(){var e,t,n,r,i=v(this._textureArray);try{for(i.s();!(e=i.n()).done;)e.value.dispose()}catch(e){i.e(e)}finally{i.f()}for(t in this._textureArray.length=0,this._textureData)this._textureData[t]=void 0;for(n in this.data)this._data[n]=void 0;for(r in this.extrudeMaterial)this.extrudeMaterial[r].dispose()}},{key:"data",get:function(){return this._data},set:function(e){this._data=e}},{key:"textureData",get:function(){return this._textureData},set:function(e){this._textureData=e}},{key:"textureArray",get:function(){return this._textureArray},set:function(e){this._textureArray=e}},{key:"getExtrudeMaterial",value:function(e,t){if(this.extrudeMaterial[e+t])return this.extrudeMaterial[e+t];var n=new fm.RawShaderMaterial({uniforms:{color:{value:new fm.Color(e)},alpha:{value:t}},vertexShader:g.RawExtrudeVertShader,fragmentShader:m.RawExtrudeFragShader});return n.transparent=!0,this.extrudeMaterial[e+t]=n,n}}]),e}(),t.default=n},function(e,t,n){"use strict";n(109)("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}}))},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.RawExtrudeVertShader=void 0,n="\nprecision mediump float;\nprecision mediump int;\n\nattribute vec3 position;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nvoid main() {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n ",t.RawExtrudeVertShader=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.RawExtrudeFragShader=void 0,n="\nprecision mediump float;\nprecision mediump int;\n\nuniform vec3 color;\nuniform float alpha;\n\nvoid main() {\n    gl_FragColor = vec4(color,alpha);\n}\n ",t.RawExtrudeFragShader=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(5)),u=o(n(6)),l=o(n(7)),c=o(n(404));n=function(e){(0,s.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}(n);function n(){var e;return(0,a.default)(this,n),(e=t.call(this,{uniforms:{diffuse:{value:new fm.Vector3(1,1,1)},offset:{value:new fm.Vector2},rotation:{value:0},scale:{value:1}},vertexShader:c.default.vert,fragmentShader:c.default.frag})).depthTest=!1,e}return n}(fm.ShaderMaterial),t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={vert:"     \nuniform vec2 offset;    // 位置偏移\nuniform float rotation; // 用弧度表示的当前水平旋转角度\nuniform float scale;    // 缩放\n\nvarying vec2 vUv;\n\nvoid main() {\n\n  vUv = uv;\n  vec2 rotatedPosition;\n  rotatedPosition.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\n  rotatedPosition.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n\n  rotatedPosition.x *= scale * abs(projectionMatrix[0][0] / projectionMatrix[1][1]);\n  rotatedPosition.y *= scale;\n  \n  rotatedPosition.xy += offset;\n  gl_Position = vec4(rotatedPosition,0.0,1.0);\n}\n",frag:"\n\nuniform vec3 diffuse;\nuniform sampler2D mapBack;\nuniform sampler2D mapfront;\n\n#include <common>\n\nvarying vec2 vUv;\n\nvoid main() {\n    vec4 diffuseColor = vec4( diffuse, 1.0 );\n    diffuseColor = texture2D( mapfront, vUv );\n   \n    vec4 backColor = vec4(1.0 , 0.0 ,0.0 ,1.0);\n    backColor = texture2D( mapBack, vUv );\n\n    float alphacomp = backColor.a + diffuseColor.a * (1.0 - backColor.a);\n    vec3 resultColor = diffuseColor.rgb *  diffuseColor.a + backColor.rgb * (1.0 - diffuseColor.a);\n    gl_FragColor = vec4(resultColor , alphacomp);\n}\n"},t.default=n},function(e,t,n){"use strict";var r=n(16),i=n(17),o=n(18),a=n(11),s=n(0);n(13),n(14),n(8);var u=n(1);s(t,"__esModule",{value:!0}),t.default=void 0,n(21);var l=u(n(2)),c=u(n(3)),h=u(n(406)),f=u(n(239)),d=u(n(115));function p(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(){function e(t,n,r){(0,l.default)(this,e),this.preLoadModels={},this.waitingBacks={},this.waitingNodes=[],this._path=t,this.isRemote=n,this.key=r,this.externalLoadingCount=0}return(0,c.default)(e,[{key:"load",value:function(e){var t,n=this;this.externalLoadingCount++;var r=this.isRemote?d.default+"webmodel/":this._path,i=this.preLoadModels[e].modelUrl.split("."),o="js"===i[1]?(t=new h.default,i[0]+".js?keyValue="+this.key):"gltf"===i[1]?(t=new f.default,i[0]+".gltf?keyValue="+this.key):(t=new f.default,i[0]+".glb?keyValue="+this.key);this.isRemote&&(o=i[0]+"/"+o),t.setPath(r),this.preLoadModels[e].isLoading=!0,t.load(o,(function(t,r){for(var o in n.waitingBacks[e])(o=n.waitingBacks[e][o])(t,r,i[1]);n.externalLoadingCount--,n.externalLoadingCount<1&&n.loaded&&n.loaded(),n.preLoadModels[e].isGltf="js"!==i[1],n.preLoadModels[e].geometry=t,n.preLoadModels[e].material=r,n.waitingBacks[e].length=0,n.preLoadModels[e].isLoading=!1,n.preLoadModels[e].loaded=!0}),(function(e){}),(function(t){console.error(t),n.externalLoadingCount--,n.externalLoadingCount<1&&n.loaded&&n.loaded(),n.preLoadModels[e].isLoading=!1}))}},{key:"addWaitingBacks",value:function(e,t,n){this.waitingBacks[e]||(this.waitingBacks[e]={}),this.waitingBacks[e][n]||(this.waitingBacks[e][n]=t)}},{key:"setLoadedBack",value:function(e){this.loaded=e}},{key:"checkAndLoadwaiting",value:function(){var e,t=function(e,t){var n=void 0!==i&&e[o]||e["@@iterator"];if(!n){if(a(e)||(n=p(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw s}}}}(this.waitingNodes);try{for(t.s();!(e=t.n()).done;)e.value}catch(e){t.e(e)}finally{t.f()}}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);function o(e){"boolean"==typeof e&&(console.warn("fm.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:fm.DefaultLoadingManager,this.withCredentials=!1}r(t,"__esModule",{value:!0}),t.default=void 0,n(8),(0,(n=i(n(19))).default)(o.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=this,o=void 0===this.path?fm.LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=o+"maps/";var a=new fm.FileLoader(this.manager);a.setPath(this.path),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){var r=JSON.parse(n);void 0===(n=r.metadata)||void 0===(n=n.type)||"object"!==n.toLowerCase()?(r=i.parse(r,o),t(r.geometry,r.materials)):console.error("fm.JSONLoader: "+e+" should be loaded with fm.ObjectLoader instead.")}),n,r)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var n=new fm.Geometry;return function(e,t){function n(e,t){return e&1<<t}var r,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y,_,x,A,I,w,b,C,M,E,T,S=e.faces,L=e.vertices,k=e.normals,R=e.colors,N=e.scale,P=0;if(void 0!==e.uvs){for(r=0;r<e.uvs.length;r++)e.uvs[r].length&&P++;for(r=0;r<P;r++)t.faceVertexUvs[r]=[]}for(a=0,s=L.length;a<s;)(_=new fm.Vector3).x=L[a++]*N,_.y=L[a++]*N,_.z=L[a++]*N,t.vertices.push(_);for(a=0,s=S.length;a<s;)if(f=n(y=S[a++],0),d=n(y,1),p=n(y,3),g=n(y,4),m=n(y,5),v=n(y,6),y=n(y,7),f){if((A=new fm.Face3).a=S[a],A.b=S[a+1],A.c=S[a+3],(I=new fm.Face3).a=S[a+1],I.b=S[a+2],I.c=S[a+3],a+=4,d&&(h=S[a++],A.materialIndex=h,I.materialIndex=h),o=t.faces.length,p)for(r=0;r<P;r++)for(C=e.uvs[r],t.faceVertexUvs[r][o]=[],t.faceVertexUvs[r][o+1]=[],i=0;i<4;i++)E=C[2*(c=S[a++])],T=C[2*c+1],M=new fm.Vector2(E,T),2!==i&&t.faceVertexUvs[r][o].push(M),0!==i&&t.faceVertexUvs[r][o+1].push(M);if(g&&(l=3*S[a++],A.normal.set(k[l++],k[l++],k[l]),I.normal.copy(A.normal)),m)for(r=0;r<4;r++)l=3*S[a++],b=new fm.Vector3(k[l++],k[l++],k[l]),2!==r&&A.vertexNormals.push(b),0!==r&&I.vertexNormals.push(b);if(v&&(w=R[u=S[a++]],A.color.setHex(w),I.color.setHex(w)),y)for(r=0;r<4;r++)w=R[u=S[a++]],2!==r&&A.vertexColors.push(new fm.Color(w)),0!==r&&I.vertexColors.push(new fm.Color(w));t.faces.push(A),t.faces.push(I)}else{if((x=new fm.Face3).a=S[a++],x.b=S[a++],x.c=S[a++],d&&(h=S[a++],x.materialIndex=h),o=t.faces.length,p)for(r=0;r<P;r++)for(C=e.uvs[r],t.faceVertexUvs[r][o]=[],i=0;i<3;i++)E=C[2*(c=S[a++])],T=C[2*c+1],M=new fm.Vector2(E,T),t.faceVertexUvs[r][o].push(M);if(g&&(l=3*S[a++],x.normal.set(k[l++],k[l++],k[l])),m)for(r=0;r<3;r++)l=3*S[a++],b=new fm.Vector3(k[l++],k[l++],k[l]),x.vertexNormals.push(b);if(v&&(u=S[a++],x.color.setHex(R[u])),y)for(r=0;r<3;r++)u=S[a++],x.vertexColors.push(new fm.Color(R[u]));t.faces.push(x)}}(e,n),function(e,t){var n=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var r=0,i=e.skinWeights.length;r<i;r+=n){var o=e.skinWeights[r],a=1<n?e.skinWeights[r+1]:0,s=2<n?e.skinWeights[r+2]:0,u=3<n?e.skinWeights[r+3]:0;t.skinWeights.push(new fm.Vector4(o,a,s,u))}if(e.skinIndices)for(r=0,i=e.skinIndices.length;r<i;r+=n){var l=e.skinIndices[r],c=1<n?e.skinIndices[r+1]:0,h=2<n?e.skinIndices[r+2]:0,f=3<n?e.skinIndices[r+3]:0;t.skinIndices.push(new fm.Vector4(l,c,h,f))}t.bones=e.bones,t.bones&&0<t.bones.length&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,n),function(e,t){var n=e.scale;if(void 0!==e.morphTargets)for(var r=0,i=e.morphTargets.length;r<i;r++){t.morphTargets[r]={},t.morphTargets[r].name=e.morphTargets[r].name,t.morphTargets[r].vertices=[];for(var o=t.morphTargets[r].vertices,a=e.morphTargets[r].vertices,s=0,u=a.length;s<u;s+=3){var l=new fm.Vector3;l.x=a[s]*n,l.y=a[s+1]*n,l.z=a[s+2]*n,o.push(l)}}if(void 0!==e.morphColors&&0<e.morphColors.length){console.warn('fm.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var c=t.faces,h=e.morphColors[0].colors;for(r=0,i=c.length;r<i;r++)c[r].color.fromArray(h,3*r)}}(e,n),function(e,t){var n=[],r=[];void 0!==e.animation&&r.push(e.animation),void 0!==e.animations&&(e.animations.length?r=r.concat(e.animations):r.push(e.animations));for(var i=0;i<r.length;i++){var o=fm.AnimationClip.parseAnimation(r[i],t.bones);o&&n.push(o)}t.morphTargets&&(e=fm.AnimationClip.CreateClipsFromMorphTargetSequences(t.morphTargets,10),n=n.concat(e)),0<n.length&&(t.animations=n)}(e,n),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:n}:{geometry:n,materials:t=fm.Loader.prototype.initMaterials(e.materials,this.resourcePath||t,this.crossOrigin)}}}),n=o,t.default=n},function(e,t,n){e.exports=n(408)},function(e,t,n){n(93),n(94),n(95),n(409),n(412),n(413),e.exports=n(12).Promise},function(e,t,n){"use strict";var r,i,o,a,s=n(79),u=n(20),l=n(42),c=n(154),h=n(15),f=n(22),d=n(56),p=n(114),g=n(72),m=n(240),v=n(241).set,y=n(410)(),_=n(159),x=n(242),A=n(411),I=n(243),w="Promise",b=u.TypeError,C=u.process,M=C&&C.versions,E=M&&M.v8||"",T=u[w],S="process"==c(C),L=function(){},k=i=_.f,R=(c=!!function(){try{var e=T.resolve(1),t=(e.constructor={})[n(29)("species")]=function(e){e(L,L)};return(S||"function"==typeof PromiseRejectionEvent)&&e.then(L)instanceof t&&0!==E.indexOf("6.6")&&-1===A.indexOf("Chrome/66")}catch(e){}}(),function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t}),N=function(e,t){var n;e._n||(e._n=!0,n=e._c,y((function(){for(var r=e._v,i=1==e._s,o=0,a=function(t){var n,o,a,s=i?t.ok:t.fail,u=t.resolve,l=t.reject,c=t.domain;try{s?(i||(2==e._h&&D(e),e._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&(c.exit(),a=!0)),n===t.promise?l(b("Promise-chain cycle")):(o=R(n))?o.call(n,u,l):u(n)):l(r)}catch(t){c&&!a&&c.exit(),l(t)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&P(e)})))},P=function(e){v.call(u,(function(){var t,n,r=e._v,i=O(e);if(i&&(t=x((function(){S?C.emit("unhandledRejection",r,e):(n=u.onunhandledrejection)?n({promise:e,reason:r}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",r)})),e._h=S||O(e)?2:1),e._a=void 0,i&&t.e)throw t.v}))},O=function(e){return 1!==e._h&&0===(e._a||e._c).length},D=function(e){v.call(u,(function(){var t;S?C.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})}))},F=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),N(t,!0))},B=function e(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw b("Promise can't be resolved itself");(n=R(t))?y((function(){var i={_w:r,_d:!1};try{n.call(t,l(e,i,1),l(F,i,1))}catch(e){F.call(i,e)}})):(r._v=t,r._s=1,N(r,!1))}catch(t){F.call({_w:r,_d:!1},t)}}};c||(T=function(e){p(this,T,w,"_h"),d(e),r.call(this);try{e(l(B,this,1),l(F,this,1))}catch(e){F.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(113)(T.prototype,{then:function(e,t){var n=k(m(this,T));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=S?C.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&N(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=l(B,e,1),this.reject=l(F,e,1)},_.f=k=function(e){return e===T||e===a?new o(e):i(e)}),h(h.G+h.W+h.F*!c,{Promise:T}),n(80)(T,w),n(207)(w),a=n(12)[w],h(h.S+h.F*!c,w,{reject:function(e){var t=k(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(s||!c),w,{resolve:function(e){return I(s&&this===a?T:this,e)}}),h(h.S+h.F*!(c&&n(208)((function(e){T.all(e).catch(L)}))),w,{all:function(e){var t=this,n=k(t),r=n.resolve,i=n.reject,o=x((function(){var n=[],o=0,a=1;g(e,!1,(function(e){var s=o++,u=!1;n.push(void 0),a++,t.resolve(e).then((function(e){u||(u=!0,n[s]=e,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=k(t),r=n.reject,i=x((function(){g(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t,n){var r=n(20),i=n(241).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,u="process"==n(78)(a);e.exports=function(){var e,t,n,l,c,h=function(){var n,r;for(u&&(n=a.domain)&&n.exit();e;){r=e.fn,e=e.next;try{r()}catch(n){throw e?f():t=void 0,n}}t=void 0,n&&n.enter()},f=u?function(){a.nextTick(h)}:!o||r.navigator&&r.navigator.standalone?s&&s.resolve?(n=s.resolve(void 0),function(){n.then(h)}):function(){i.call(r,h)}:(l=!0,c=document.createTextNode(""),new o(h).observe(c,{characterData:!0}),function(){c.data=l=!l});return function(n){n={fn:n,next:void 0},t&&(t.next=n),e||(e=n,f()),t=n}}},function(e,t,n){n=(n=n(20)).navigator,e.exports=n&&n.userAgent||""},function(e,t,n){"use strict";var r=n(15),i=n(12),o=n(20),a=n(240),s=n(243);r(r.P+r.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then((function(){return n}))}:e,n?function(n){return s(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){"use strict";var r=n(15),i=n(159),o=n(242);r(r.S,"Promise",{try:function(e){var t=i.f(this);return((e=o(e)).e?t.reject:t.resolve)(e.v),t.promise}})},function(e,t,n){"use strict";var r=n(183)(!0);n(192)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e=this._t,t=this._i;return t>=e.length?{value:void 0,done:!0}:(t=r(e,t),this._i+=t.length,{value:t,done:!1})}))},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3)),s=i(n(239));n=function(){function e(){(0,o.default)(this,e),this.dynamicModel={},this.loader=new s.default}return(0,a.default)(e,[{key:"load",value:function(e,t,n){var r=this;this.dynamicModel[e]?0==this.dynamicModel[e].loadComplete?(this.dynamicModel[e].scbs.push(t),this.dynamicModel[e].fcbs.push(n)):this.dynamicModel[e].error?n&&n(this.dynamicModel[e].error):t&&this.loader.parse(this.dynamicModel[e].data,fm.LoaderUtils.extractUrlBase(e),(function(e){t(e)}),(function(){})):(this.dynamicModel[e]={gltf:null,loadComplete:!1,error:null,scbs:[],fcbs:[]},this.dynamicModel[e].scbs.push(t),this.dynamicModel[e].fcbs.push(n),this.loader.load(e,(function(t,n){r.dynamicModel[e].gltf=t,r.dynamicModel[e].data=n,r.dynamicModel[e].loadComplete=!0;for(var i=r.dynamicModel[e].scbs,o=function(t){i[t]&&r.loader.parse(r.dynamicModel[e].data,fm.LoaderUtils.extractUrlBase(e),(function(e){i[t](e)}),(function(){}))},a=0;a<i.length;a++)o(a)}),void 0,(function(t){r.dynamicModel[e].error=t,r.dynamicModel[e].loadComplete=!0;for(var n=r.dynamicModel[e].fcbs,i=0;i<n.length;i++)n[i]&&n[i](t)})))}},{key:"dispose",value:function(){this.dynamicModel={},this.loader=null}}]),e}(),t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.vertexShader=void 0,n="\n varying vec4 v_position;\n//  varying vec3 vReflect;\n uniform mat4 relativeModelMatrix;\n//  uniform vec3 cameraPosition2;\n\n #define STANDARD\n varying vec3 vViewPosition;\n #ifndef FLAT_SHADED\n \tvarying vec3 vNormal;\n \t#ifdef USE_TANGENT\n \t\tvarying vec3 vTangent;\n \t\tvarying vec3 vBitangent;\n \t#endif\n #endif\n #define PI 3.14159265359\n #define PI2 6.28318530718\n #define PI_HALF 1.5707963267949\n #define RECIPROCAL_PI 0.31830988618\n #define RECIPROCAL_PI2 0.15915494\n #define LOG2 1.442695\n #define EPSILON 1e-6\n #ifndef saturate\n #define saturate(a) clamp( a, 0.0, 1.0 )\n #endif\n #define whiteComplement(a) ( 1.0 - saturate( a ) )\n float pow2( const in float x ) { return x*x; }\n float pow3( const in float x ) { return x*x*x; }\n float pow4( const in float x ) { float x2 = x*x; return x2*x2; }\n float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\n highp float rand( const in vec2 uv ) {\n \tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n \thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n \treturn fract(sin(sn) * c);\n }\n #ifdef HIGH_PRECISION\n \tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n #else\n \tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n \tfloat precisionSafeLength( vec3 v ) {\n \t\tfloat maxComponent = max3( abs( v ) );\n \t\treturn length( v / maxComponent ) * maxComponent;\n \t}\n #endif\n struct IncidentLight {\n \tvec3 color;\n \tvec3 direction;\n \tbool visible;\n };\n struct ReflectedLight {\n \tvec3 directDiffuse;\n \tvec3 directSpecular;\n \tvec3 indirectDiffuse;\n \tvec3 indirectSpecular;\n };\n struct GeometricContext {\n \tvec3 position;\n \tvec3 normal;\n \tvec3 viewDir;\n #ifdef CLEARCOAT\n \tvec3 clearcoatNormal;\n #endif\n };\n vec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n \treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n }\n vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n \treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n }\n vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n \tfloat distance = dot( planeNormal, point - pointOnPlane );\n \treturn - distance * planeNormal + point;\n }\n float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n \treturn sign( dot( point - pointOnPlane, planeNormal ) );\n }\n vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n \treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n }\n mat3 transposeMat3( const in mat3 m ) {\n \tmat3 tmp;\n \ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n \ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n \ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n \treturn tmp;\n }\n float linearToRelativeLuminance( const in vec3 color ) {\n \tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n \treturn dot( weights, color.rgb );\n }\n bool isPerspectiveMatrix( mat4 m ) {\n   return m[ 2 ][ 3 ] == - 1.0;\n }\n #ifdef USE_UV\n \t#ifdef UVS_VERTEX_ONLY\n \t\tvec2 vUv;\n \t#else\n \t\tvarying vec2 vUv;\n \t#endif\n \tuniform mat3 uvTransform;\n #endif\n #if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n \tattribute vec2 uv2;\n \tvarying vec2 vUv2;\n \tuniform mat3 uv2Transform;\n #endif\n #ifdef USE_DISPLACEMENTMAP\n \tuniform sampler2D displacementMap;\n \tuniform float displacementScale;\n \tuniform float displacementBias;\n #endif\n #ifdef USE_COLOR\n \tvarying vec3 vColor;\n #endif\n #ifdef USE_FOG\n \tvarying float fogDepth;\n #endif\n #ifdef USE_MORPHTARGETS\n \tuniform float morphTargetBaseInfluence;\n \t#ifndef USE_MORPHNORMALS\n \tuniform float morphTargetInfluences[ 8 ];\n \t#else\n \tuniform float morphTargetInfluences[ 4 ];\n \t#endif\n #endif\n #ifdef USE_SKINNING\n \tuniform mat4 bindMatrix;\n \tuniform mat4 bindMatrixInverse;\n \t#ifdef BONE_TEXTURE\n \t\tuniform highp sampler2D boneTexture;\n \t\tuniform int boneTextureSize;\n \t\tmat4 getBoneMatrix( const in float i ) {\n \t\t\tfloat j = i * 4.0;\n \t\t\tfloat x = mod( j, float( boneTextureSize ) );\n \t\t\tfloat y = floor( j / float( boneTextureSize ) );\n \t\t\tfloat dx = 1.0 / float( boneTextureSize );\n \t\t\tfloat dy = 1.0 / float( boneTextureSize );\n \t\t\ty = dy * ( y + 0.5 );\n \t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n \t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n \t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n \t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n \t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n \t\t\treturn bone;\n \t\t}\n \t#else\n \t\tuniform mat4 boneMatrices[ MAX_BONES ];\n \t\tmat4 getBoneMatrix( const in float i ) {\n \t\t\tmat4 bone = boneMatrices[ int(i) ];\n \t\t\treturn bone;\n \t\t}\n \t#endif\n #endif\n #ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): uniforms for area light shadows\n\n\t#endif\n\t*/\n\n#endif\n #ifdef USE_LOGDEPTHBUF\n \t#ifdef USE_LOGDEPTHBUF_EXT\n \t\tvarying float vFragDepth;\n \t\tvarying float vIsPerspective;\n \t#else\n \t\tuniform float logDepthBufFC;\n \t#endif\n #endif\n #if 0 > 0\n \tvarying vec3 vClipPosition;\n #endif\n void main() {\n    // vec3 worldPosition2 = ( modelMatrix * vec4( position, 1.0 )).xyz;\n    // vec3 cameraToVertex = normalize( worldPosition2 - cameraPosition2 );\n    // vReflect = reflect( cameraToVertex, normal );\n \tvec4 pos = vec4(position, 1.0);\n \tv_position = relativeModelMatrix * pos;\n\n #ifdef USE_UV\n \tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n #endif\n #if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n \tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n #endif\n #ifdef USE_COLOR\n \tvColor.xyz = color.xyz;\n #endif\n vec3 objectNormal = vec3( normal );\n #ifdef USE_TANGENT\n \tvec3 objectTangent = vec3( tangent.xyz );\n #endif\n #ifdef USE_MORPHNORMALS\n \tobjectNormal *= morphTargetBaseInfluence;\n \tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n \tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n \tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n \tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n #endif\n #ifdef USE_SKINNING\n \tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n \tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n \tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n \tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n #endif\n #ifdef USE_SKINNING\n \tmat4 skinMatrix = mat4( 0.0 );\n \tskinMatrix += skinWeight.x * boneMatX;\n \tskinMatrix += skinWeight.y * boneMatY;\n \tskinMatrix += skinWeight.z * boneMatZ;\n \tskinMatrix += skinWeight.w * boneMatW;\n \tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n \tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n \t#ifdef USE_TANGENT\n \t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n \t#endif\n #endif\n vec3 transformedNormal = objectNormal;\n #ifdef USE_INSTANCING\n \tmat3 m = mat3( instanceMatrix );\n \ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n \ttransformedNormal = m * transformedNormal;\n #endif\n transformedNormal = normalMatrix * transformedNormal;\n #ifdef FLIP_SIDED\n \ttransformedNormal = - transformedNormal;\n #endif\n #ifdef USE_TANGENT\n \tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n \t#ifdef FLIP_SIDED\n \t\ttransformedTangent = - transformedTangent;\n \t#endif\n #endif\n #ifndef FLAT_SHADED\n \tvNormal = normalize( transformedNormal );\n \t#ifdef USE_TANGENT\n \t\tvTangent = normalize( transformedTangent );\n \t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n \t#endif\n #endif\n vec3 transformed = vec3( position );\n #ifdef USE_MORPHTARGETS\n \ttransformed *= morphTargetBaseInfluence;\n \ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n \ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n \ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n \ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n \t#ifndef USE_MORPHNORMALS\n \ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n \ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n \ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n \ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n \t#endif\n #endif\n #ifdef USE_SKINNING\n \tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n \tvec4 skinned = vec4( 0.0 );\n \tskinned += boneMatX * skinVertex * skinWeight.x;\n \tskinned += boneMatY * skinVertex * skinWeight.y;\n \tskinned += boneMatZ * skinVertex * skinWeight.z;\n \tskinned += boneMatW * skinVertex * skinWeight.w;\n \ttransformed = ( bindMatrixInverse * skinned ).xyz;\n #endif\n #ifdef USE_DISPLACEMENTMAP\n \ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n #endif\n vec4 mvPosition = vec4( transformed, 1.0 );\n #ifdef USE_INSTANCING\n \tmvPosition = instanceMatrix * mvPosition;\n #endif\n mvPosition = modelViewMatrix * mvPosition;\n gl_Position = projectionMatrix * mvPosition;\n #ifdef USE_LOGDEPTHBUF\n \t#ifdef USE_LOGDEPTHBUF_EXT\n \t\tvFragDepth = 1.0 + gl_Position.w;\n \t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n \t#else\n \t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n \t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n \t\t\tgl_Position.z *= gl_Position.w;\n \t\t}\n \t#endif\n #endif\n #if 0 > 0\n \tvClipPosition = - mvPosition.xyz;\n #endif\n \tvViewPosition = - mvPosition.xyz;\n #if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n \tvec4 worldPosition = vec4( transformed, 1.0 );\n \t#ifdef USE_INSTANCING\n \t\tworldPosition = instanceMatrix * worldPosition;\n \t#endif\n \tworldPosition = modelMatrix * worldPosition;\n #endif\n #ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update vAreaShadowCoord with area light info\n\n\t#endif\n\t*/\n\n#endif\n #ifdef USE_FOG\n \tfogDepth = -mvPosition.z;\n #endif\n }\n ",t.vertexShader=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.fragmentShader=void 0,n="\n    \nuniform bool isNeedSweep;\nuniform bool isRect;\nuniform bool isAnnulus;\n\nuniform float sweepW;\nuniform float sweepH;\nuniform vec2 se2N;\nuniform vec2 se2RN;\nuniform vec2 moveP;\n\nbool isInRectW(vec2 v, vec2 a, float w){\n    float a1 = abs(dot(v,a));\n    return a1 < w;\n}\nbool isInRectH(vec2 v, vec2 a, float h){\n    float a1 = abs(dot(v,a));\n    return a1 < h;\n}\n\nvarying vec2 v_Uv;\nvarying vec4 v_position;\n\n\nuniform vec2 circleC;\nuniform float maxR;\nuniform float minR;\nbool isMaxCircle(vec3 a, vec2 b, float r){\n    float c = sqrt(pow((a.x-b.x),2.0)+pow((a.z-b.y),2.0));\n    return c <= r;\n}\n\nbool isMinCircle(vec3 a, vec2 b, float r){\n    float c = sqrt(pow((a.x-b.x),2.0)+pow((a.z-b.y),2.0));\n    return c > r;\n}\n\n#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\n\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t\n    if(isRect){\n            \n        vec2 v = vec2(v_position.x-moveP.x,v_position.z-moveP.y);\n        if(float(isInRectW(v,se2N,sweepW) && isInRectH(v,se2RN,sweepH)) != 0.0 && isNeedSweep){\n            gl_FragColor = vec4(mix(vec3(1.0, 1.0, 0.36)*0.8, gl_FragColor.rgb, 0.5), 1.0);\n            gl_FragColor.rgb = toneMapping( gl_FragColor.rgb ); \n        }\n        \n    }\n    \n    if(isAnnulus){\n    \n        if(float(isMaxCircle(v_position.xyz,circleC,maxR) && isMinCircle(v_position.xyz,circleC,minR) ) != 0.0 && isNeedSweep){\n            gl_FragColor = vec4(mix(vec3(0.3, 1.0, 0.86),gl_FragColor.rgb,0.91), 1.0);\n            gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n        }\n        // gl_FragColor = vec4(1.0,0.1,0.1,1.0);\n    }\n    \n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",t.fragmentShader=n},function(e,t,n){"use strict";var r=n(16),i=n(17),o=n(18),a=n(11),s=n(0);n(13),n(14);var u=n(1);s(t,"__esModule",{value:!0}),t.default=void 0;var l=u(n(19)),c=u(n(25));n(21),n(8),n(64);var h=u(n(2)),f=u(n(3)),d=u(n(65));function p(e,t){var n=void 0!==i&&e[o]||e["@@iterator"];if(!n){if(a(e)||(n=g(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw s}}}}function g(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}u(n(419)),n=function(){function e(t,n){(0,h.default)(this,e),this._themeName=n,this._themeUrl=t,this._data=null,this._type2theme={},this._poiimagetheme={},this._storePoiThemes={},this._storeLabelTypeDic={},this._storeLabelThemeDic={},this._storethemes={},this._externalModelTheme={},this._defaultTheme={color:16777215,alpha:1,strokeColor:16777215,strokeWidth:2},this._labelDefaultTheme={alpha:"0.9",fillcolor:"30,30,30",fontsize:"14.0",id:"109",image:!1,strokecolor:"255,255,255"},this.clearColor=16777215,this.clearAlpha=1,this._modelOpacity=.875,this._floorColor=16776960,this._floorOpacity=.875,this._selectedColor=16750950,this._labelStyle,this._labelSelectedStyle,this._facilitySize,this._poiMatClones={},this._storeApply={},this.navigateStyle_={color:16711680,lineWidth:8,alpha:.8,dash:{size:1,gap:1}}}return(0,f.default)(e,[{key:"initExteralModelTheme",value:function(){if(this._data.externalmodelapply){var e,t=p(this._data.externalmodelapply);try{for(t.s();!(e=t.n()).done;){var n,r=e.value,i=p(r.fids.split(","));try{for(i.s();!(n=i.n()).done;){var o,a=n.value,s=void 0,u=p(this._data.externalmodeltheme);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(c.id===r.normalid){s=c;break}}}catch(e){u.e(e)}finally{u.f()}this._externalModelTheme[a]=(0,l.default)({color:s.color,model:s.model},r),this._externalModelTheme[a].fids=void 0}}catch(e){i.e(e)}finally{i.f()}}}catch(e){t.e(e)}finally{t.f()}}}},{key:"initStoreTheme",value:function(){var e={};this._defaultTheme=this._data.storetheme[0],this.storeThemes=e;for(var t=0;t<this._data.storetheme.length;t++){var n=this._data.storetheme[t];n.color=d.default.toColor(n.color),n.strokeColor=d.default.toColor(n.strokecolor),n.strokeWidth=n.strokewidth,n.alpha=n.alpha,e[n.id]=n}var r=this._data.floorapply;for(t in r){var i=r[t];if(i.typeapply)for(var o in i.typeapply){var a=i.typeapply[o];if(a.normalid){n=e[a.normalid],(o=e[a.selectedid])&&(this._selectedColor=d.default.toColor(o.color));var s,u=a.type.split(",");for(s in u)this._type2theme[u[s]]=n}}}var l=this._data.extenttheme;this._floorColor=d.default.toColor(l[0].color),this._floorOpacity=(0,c.default)(l[0].alpha)}},{key:"initLabelTheme",value:function(){var e=this._data.storelabeltheme;if(this.storeLabelThemeDic={},this.storeLabelTypeDic={},e){0<e.length&&(this._labelStyle=e[0],1<e.length&&(this._labelSelectedStyle=e[1]));for(var t=0;t<e.length;t++)this.storeLabelThemeDic[e[t].id]=e[t];var n=this._data.floorstorelabelapply;if(n)for(t=0;t<n.length;t++){var r=n[t].typeapply;if("0"==n[t].floorid)for(var i=0;i<r.length;i++)for(var o=r[i],a=o.type.split(","),s=0;s<a.length;s++)this.storeLabelTypeDic[a[s]]=o}var u=this.data.storelabelapply;this._labelFidTheme={};var l,c=this._labelFidTheme,h=p(u);try{for(h.s();!(l=h.n()).done;){var f=l.value;if(f.fids){var d,g=p(f.fids.split(","));try{for(g.s();!(d=g.n()).done;)c[d.value]=this.storeLabelThemeDic[f.normalid]}catch(e){g.e(e)}finally{g.f()}}}}catch(e){h.e(e)}finally{h.f()}}}},{key:"initPoiTheme",value:function(){this._poiimagetheme={};var e,t=this._data.poiimagetheme,n={};for(e in this.storePoiThemes=n,t){var r=t[e];r.imagename&&(n[r.id]=r)}var i,o=this.data.floorpoiimageapply;for(i in o){var a=o[i];if(a.typeapply)for(var s in a.typeapply)if((s=a.typeapply[s]).normalid){var u,l=n[s.normalid],c=s.type.split(",");for(u in c)this._poiimagetheme[c[u]]=l}}var h=this.data.poiimageapply;this._poiFidTheme={};var f,d=this._poiFidTheme,g=p(h);try{for(g.s();!(f=g.n()).done;){var m=f.value;if(m.fids){var v,y=p(m.fids.split(","));try{for(y.s();!(v=y.n()).done;)d[v.value]=n[m.normalid]}catch(e){y.e(e)}finally{y.f()}}}}catch(e){g.e(e)}finally{g.f()}}},{key:"getStoreApplyTheme",value:function(e){var t,n=p(this._data.storeapply);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.fids===e){var i,o=p(this._data.storetheme);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.id==r.normalid)return(0,l.default)({},a,r)}}catch(e){o.e(e)}finally{o.f()}}}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"themeName",get:function(){return this._themeName}},{key:"data",get:function(){return this._data},set:function(e){this._data=e,this.initStoreTheme(),this.initLabelTheme(),this.initPoiTheme(),this.initExteralModelTheme(),this.clearColor=d.default.toColor(this._data.viewtheme.clearcolor),this.clearAlpha=(0,c.default)(this._data.viewtheme.clearalpha)}},{key:"getRThemeTexture",value:function(e){if(this.rtheme)for(var t,n=0;n<this.rtheme.fmis.length;n++)if((t=this.rtheme.fmis[n]).name==e)return t.content;return null}},{key:"getModelSelectColor",value:function(){var e,t=(e=this._data.storetheme[1]).color;return{r:(t>>16&255)/255,g:(t>>8&255)/255,b:(255&t)/255,a:e=(0,c.default)(e.alpha)}}},{key:"getModelTheme",value:function(e){return e&&(e=this._type2theme[e.type])||this._defaultTheme}},{key:"getPoiTheme",value:function(e){var t=e.type;return e=e.fid,e=(e=this._poiFidTheme[e])||this._poiimagetheme[t],e=(0,l.default)(e||this._poiimagetheme[0],{}),"rtheme"==this.fileType?e.imageSrc=this.getRThemeTexture(e.imagename):e.imageSrc=this._themeUrl+"/"+this.themeName+"/"+e.imagename,e.imageUrl=this._themeUrl+"/"+this.themeName+"/"+e.imagename,e.imagehead=this._themeUrl+"/"+this.themeName+"/",e}},{key:"getLabelTheme",value:function(e){var t,n=e.type;return e=e.fid,n=this.storeLabelTypeDic[n],e&&(t=this._labelFidTheme[e]),n||t?n&&(t=t||this.storeLabelThemeDic[n.normalid]||this._labelStyle):t=this._labelStyle,(t=t||this._labelDefaultTheme).fillcolor&&t.alpha&&t.fontsize||(n={fillcolor:"0,0,0",alpha:"1.0",fontsize:"12.0"},t=(0,l.default)(t,n)),t.image?("rtheme"==this.fileType?t.imageSrc=this.getRThemeTexture(t.image):t.imageSrc=this._themeUrl+"/"+this.themeName+"/"+t.image,t.imageUrl=this._themeUrl+"/"+this.themeName+"/"+t.image):t.imageSrc=!1,t}},{key:"getExteralModelTheme",value:function(e){return this._externalModelTheme[e]}},{key:"dispose",value:function(){this._type2theme=void 0,this._poiimagetheme=void 0,this._storePoiThemes=void 0,this._storeLabelTypeDic=void 0,this._storeLabelThemeDic=void 0,this._storethemes=void 0,this._data=void 0}},{key:"storeLabelTypeDic",get:function(){return this._storeLabelTypeDic},set:function(e){this._storeLabelTypeDic=e}},{key:"storeLabelThemeDic",get:function(){return this._storeLabelThemeDic},set:function(e){this._storeLabelThemeDic=e}},{key:"storePoiThemes",get:function(){return this._storePoiThemes},set:function(e){this._storePoiThemes=e}},{key:"storethemes",get:function(){return this._storethemes},set:function(e){this._storethemes=e}},{key:"themeUrl",get:function(){return this._themeUrl},set:function(e){this.themeUrl=e}},{key:"floorColor",get:function(){return this._floorColor},set:function(e){this._floorColor=e}},{key:"floorOpacity",get:function(){return this._floorOpacity},set:function(e){this._floorOpacity=e}},{key:"selectedColor",get:function(){return this._selectedColor}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(16),i=n(17),o=n(18),a=n(11),s=n(0);n(13),n(14),n(8);var u=n(1);s(t,"__esModule",{value:!0}),t.default=void 0;var l=u(n(19)),c=u(n(2)),h=u(n(3));function f(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(){function e(t){(0,c.default)(this,e),this._data=t,this._Nodes=[]}return(0,h.default)(e,[{key:"updateNodes",value:function(){var e,t=function(e,t){var n=void 0!==i&&e[o]||e["@@iterator"];if(!n){if(a(e)||(n=f(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw s}}}}(this._Nodes);try{for(t.s();!(e=t.n()).done;)e.value.setByTheme(this._data)}catch(e){t.e(e)}finally{t.f()}}},{key:"addNodes",value:function(e){this._Nodes.push(e)}},{key:"removeNodes",value:function(e){-1<(e=this._Nodes.indexOf(e))&&this._Nodes.splice(e,1)}},{key:"changeData",value:function(e){(0,l.default)(this._data,e)}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=(o=n(1))(n(421)),i=o(n(53)),o=function(){var e=function e(){var t=0,n=document.createElement("div");function i(e){return n.appendChild(e.dom),e}function o(e){for(var r=0;r<n.children.length;r++)n.children[r].style.display=r===e?"block":"none";t=e}n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",(function(e){e.preventDefault(),o(++t%n.children.length)}),!1);var a,s=(0,r.default)(),u=s,l=0,c=i(new e.Panel("FPS","#0ff","#002")),h=i(new e.Panel("MS","#0f0","#020"));return self.performance&&self.performance.memory&&(a=i(new e.Panel("MB","#f08","#201"))),o(0),{REVISION:16,dom:n,addPanel:i,showPanel:o,begin:function(){s=(0,r.default)()},end:function(){l++;var e,t=(0,r.default)();return h.update(t-s,200),u+1e3<=t&&(c.update(1e3*l/(t-u),100),u=t,l=0,a&&(e=performance.memory,a.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576))),t},update:function(){s=this.end()},domElement:n,setMode:o}};return e.Panel=function(e,t,n){var r=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,u=48*a,l=3*a,c=2*a,h=3*a,f=15*a,d=74*a,p=30*a,g=document.createElement("canvas");g.width=s,g.height=u,g.style.cssText="width:80px;height:48px";var m=g.getContext("2d");return m.font="bold "+9*a+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=n,m.fillRect(0,0,s,u),m.fillStyle=t,m.fillText(e,l,c),m.fillRect(h,f,d,p),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(h,f,d,p),{dom:g,update:function(u,v){r=Math.min(r,u),i=Math.max(i,u),m.fillStyle=n,m.globalAlpha=1,m.fillRect(0,0,s,f),m.fillStyle=t,m.fillText(o(u)+" "+e+" ("+o(r)+"-"+o(i)+")",l,c),m.drawImage(g,h+a,f,d-a,p,h,f,d-a,p),m.fillRect(h+d-a,f,a,p),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(h+d-a,f,a,o((1-u/v)*p))}}},e};"object"===(0,i.default)(t)&&void 0!==e?e.exports=o():void 0===(o="function"==typeof o?o.call(t,n,t,e):o)||(e.exports=o)},function(e,t,n){e.exports=n(422)},function(e,t,n){n(423),e.exports=n(12).Date.now},function(e,t,n){(n=n(15))(n.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(5)),u=o(n(6)),l=o(n(7)),c=o(n(425));n=function(e){(0,s.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}(n);function n(e){return(0,a.default)(this,n),(e=t.call(this,e)).uniforms.offset={value:new fm.Vector2},e.uniforms.rotation={value:0},e.uniforms.scale={value:new fm.Vector2(1,1)},e.depthTest=!1,e.vertexShader=c.default.vert,e.fragmentShader=c.default.frag,e}return n}(fm.ShaderMaterial),t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={vert:"\n                      \n                        uniform vec2 offset;\n                        uniform float rotation;\n                        uniform vec2 scale;\n                        varying vec2 vUv;\n                        void main() {\n                          vUv = uv;\n                  \n                          \n                          vec2 rotatedPosition;\n                            rotatedPosition.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\n                            rotatedPosition.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n                      \n        \n                            rotatedPosition.x *= scale.x * abs(projectionMatrix[0][0] / projectionMatrix[1][1]);\n                            rotatedPosition.y *= scale.y;\n                          \n                          rotatedPosition.xy += offset;\n                          gl_Position = vec4(rotatedPosition,0.0,1.0);\n                        }\n                        ",frag:"\n                    uniform vec3 diffuse;\n                    uniform sampler2D mmap;\n                    #include <common>\n                    varying vec2 vUv;\n               \n                    void main() {\n                \n                        // vec2 muv = vec2(vUv.x , 1.0 - vUv.y);\n                        vec4 diffuseColor = texture2D( mmap, vUv );\n                       \n                        \n                        gl_FragColor = diffuseColor;\n                    }\n                    "},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(t){(0,o.default)(this,e),this.videoMemoryAmount=null,this._map=t}return(0,a.default)(e,[{key:"getVideoMemoryAmount",value:function(e){if(this._map.nodeManager){var t,n=this._map.nodeManager._scenes[""+e].groups;for(t in n)this.videoMemoryAmount+=n[""+t].layers.facility[0].getVideoMemoryAmount(),this.videoMemoryAmount+=n[""+t].layers.model[0].getVideoMemoryAmount(),this.videoMemoryAmount+=n[""+t].layers.extent[0].getVideoMemoryAmount(),this.videoMemoryAmount+=n[""+t].layers.label[0].getVideoMemoryAmount();return this.videoMemoryAmount}}},{key:"_addAmount",value:function(e){this.videoMemoryAmount+=e}},{key:"_subtractAmount",value:function(e){this.videoMemoryAmount-=e}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3)),s=i(n(50));n=function(){function e(t){var n=this;(0,o.default)(this,e),this._map=t,this._domMarkers=[],this._map.on("focusGroupIDChanged",(function(e){for(var t=0;t<n._domMarkers.length;t++)n._domMarkers[t].groupID!==e.gid?n._domMarkers[t]._renderNode.element.childNodes[0].style.display="none":n._domMarkers[t]._show&&(n._domMarkers[t]._renderNode.element.childNodes[0].style.display="block")}))}return(0,a.default)(e,[{key:"addMarker",value:function(e){var t=(n=new Date).getTime(),n=Math.random();e._id="domMarker"+t+n,e.parent=this,e.init(this._map),this._domMarkers.push(e)}},{key:"removeMarker",value:function(e){this._map.renderer.htmlscene.remove(e._renderNode);for(var t=-1,n=0;n<this._domMarkers.length;n++)if(this._domMarkers[n]._id===e._id){t=n;break}this._domMarkers.splice(t,1)}},{key:"removeAll",value:function(){for(;0<this._domMarkers.length;)this.removeMarker(this._domMarkers[0])}},{key:"checkDomMarkerAvoid",value:function(e){if(!(e.length<1)){for(var t=e[0],n=[],r=1;r<e.length;r++)s.default.isRectCross(t.leftTop,t.rightDown,e[r].leftTop,e[r].rightDown)?e[r].target.element.childNodes[0].style.display="none":(e[r].target.element.childNodes[0].style.display="block",n.push(e[r]));1<n.length&&(n.reverse(),this.checkDomMarkerAvoid(n))}}},{key:"avoidDomMarkers",value:function(){for(var e=this._domMarkers,t=[],n=0;n<e.length;n++)e[n].groupID===this._map.focusGroupID&&e[n]._show&&e[n].needAvoid&&(e[n]._renderNode.element.childNodes[0].style.display="block",t.push(e[n]._getMarkerInfo()));this.checkDomMarkerAvoid(t)}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(35));n(55),n(9);var a,s=i(n(48)),u=i(n(2)),l=i(n(3)),c=i(n(65)),h=i(n(251)),f=i(n(429));n=function(){function e(t,n){(0,u.default)(this,e),this._map=t,this._ctlOpt=new f.default(n),this._btnWidth=42,this._showBtnCount=this._ctlOpt.showBtnCount||5,this._foucusId=this._map.currentFocusGroup,this._scrollSpeed=10,this._btnPanel=null,this._mainPanel=null,this._ctlOpt.offset||(this._ctlOpt.offset={x:0,y:0}),this._ctlOpt.needAllLayerBtn=null==this._ctlOpt.needAllLayerBtn||this._ctlOpt.needAllLayerBtn,this._allLayer=this._ctlOpt.allLayer||!1,this._allLayer&&this._map.showSingerOrMultiGroup(this._allLayer),this.uuid=null,this.init(),this.scrollTopAn_=new c.default.scrollTopAnFun}return(0,l.default)(e,[{key:"init",value:function(){var e,t=this,n=(e=new Date).getFullYear(),r=e.getMonth(),i=e.getDate(),o=e.getHours(),a=e.getMinutes();o<10&&(o="0"+o),a<10&&(a="0"+a),(e=e.getSeconds())<10&&(e="0"+e),i=n+"/"+r+"/"+i+"/"+o+":"+a+":"+e,this.uuid=String(5*Math.random()).replace(/^(.*\..{4}).*$/,"$1")+i;var s=this.createPanel(this._btnWidth);this._mainPanel=s,this.checkPosition(this._ctlOpt.position,this._ctlOpt.offset,s),this._map.getContainer().appendChild(s),o=this._map.listGroups.map((function(e){return e.gid})),a=o.length,e=this._showBtnCount,i=!0,a<=this._showBtnCount&&(e=a,i=!1),a=this.createMultiSwitchButton(this._ctlOpt.imgURL+(this._ctlOpt.allLayer?"layers.png":"layer.png")),this._ctlOpt.needAllLayerBtn&&s.appendChild(a),this._switchBtn=a,i&&s.appendChild(this.createScrollButton(this._ctlOpt.imgURL+"arrow1.png","top"));var u=this.createGroupBtnPanel(e*this._btnWidth+2*(e-1));s.appendChild(u),this._btnPanel=u;for(var l=this._map.listGroups,c=l.length-1;-1<c;c--)u.appendChild(this.createGroupButton(l[c],this._btnWidth)),0<c&&u.appendChild(this.createHr());i&&s.appendChild(this.createScrollButton(this._ctlOpt.imgURL+"arrow2.png","buttom")),u.scrollTop=this.getCenterScrolltopById(this._foucusId,o.length),document.getElementById("gid_"+this._foucusId+this.uuid).style.color="rgb(30, 130, 250)",this.eventBtnPanelInit(u),this.eventPanelInit(s,u,o),this.eventSwitchBtn(a);var h=function(e){var n=t._map.listGroups.map((function(e){return e.gid}));e.gid<n[0]||e.gid>n[n.length-1]||(u.scrollTop=t.getCenterScrolltopById(e.gid,n.length),t.setFocusStaus(e.gid))},f=function(e){1<e.gids.length?t.setLayerStatus(!0):t.setLayerStatus(!1)};this._map.on("focusGroupIDChanged",h),this._map.on("visibleGroupIDsChanged",f),this._map.on("dispose",(function(e){t._map.off("focusGroupIDChanged",h),t._map.off("visibleGroupIDsChanged",f),t._map.getContainer().removeChild(s)})),this._$=function(e){return(t.map?t.map.mapView.container_:document).querySelector(e)}}},{key:"eventSwitchBtn",value:function(e){var t=this;e.addEventListener("click",(function(n){t._allLayer=!t._allLayer,t._allLayer?e.firstElementChild.src=t._ctlOpt.imgURL+"layers.png":e.firstElementChild.src=t._ctlOpt.imgURL+"layer.png",t._map.showSingerOrMultiGroup(t._allLayer)}))}},{key:"eventBtnPanelInit",value:function(e){var t=this,n=this;n.changeScrollBtnPic(),c.default.bindEvent(e,"label","click",(function(){n.foucusId=(0,o.default)(this.dataset.gid),n.setFocusStaus(this.dataset.gid)}));var r=function(r){n.changeScrollBtnPic();var i=0;r.wheelDelta?i+=-r.wheelDelta:r.detail&&(i+=r.detail),t.scrollTopAn_({el:e,to:e.scrollTop,form:e.scrollTop+i})};e.addEventListener("mousewheel",r,{passive:!0}),e.addEventListener("MozMousePixelScroll",r,!1),e.addEventListener("touchstart",this.touchstart.bind(this),!1),e.addEventListener("touchmove",this.touchmove.bind(this),!1),e.addEventListener("touchend",this.touchend.bind(this),!0)}},{key:"touchstart",value:function(e){e.preventDefault(),this.touchStartPointY=e.touches[0].pageY,this.touchPointX=e.touches[0].pageX,this.touchPointY=e.touches[0].pageY}},{key:"touchmove",value:function(e){e.preventDefault(),this.touchEndPointX=e.touches[0].pageX,this.touchEndPointY=e.touches[0].pageY,this.handleTouchEnd(e)}},{key:"handleTouchEnd",value:function(e){var t,n=this,r=null;0<(e=e||window.event).changedTouches.length&&(n.touchEndPointX=e.changedTouches[0].pageX,n.touchEndPointY=e.changedTouches[0].pageY),(r=e.target)instanceof HTMLSpanElement==1&&(r=r.parentElement),0!=(t=-(r=n.touchEndPointY-n.touchPointY))&&(n.touchPointX=n.touchEndPointX,n.touchPointY=n.touchEndPointY,n=n._$(".fm-layer-list"),this.scrollTopAn_({el:n,to:n.scrollTop,form:n.scrollTop+t}))}},{key:"touchend",value:function(e){var t=this,n=null;0<(e=e||window.event).changedTouches.length&&(t.touchEndPointX=e.changedTouches[0].pageX,t.touchEndPointY=e.changedTouches[0].pageY),(n=e.target)instanceof HTMLSpanElement==1&&(n=n.parentElement),(e=Math.abs(t.touchEndPointY-t.touchStartPointY))<5&&0<=e&&n&&(n=(0,o.default)(n.dataset.gid),isNaN(n)||(t.foucusId=n,t.setFocusStaus(n)))}},{key:"eventPanelInit",value:function(e,t,n){var r=this;e.onselectstart=function(){return!1},e.style.MozUserSelect="none",c.default.bindEvent(e,".scroll","click",(function(e){var i=n.length-Math.floor(t.scrollTop/44)-(r._showBtnCount-1),o=t.scrollTop%44,a=i+r._showBtnCount-1+(0<o?1:0),s=0;if(this.id==="scroll_top"+r.uuid){var u=r._foucusId+1;if(u=Math.min(n[n.length-1],u),r.foucusId==u)return;r.foucusId=u,u<i?s-=0<o?44-o:0:u<=a+1&&u===a+1&&(s-=44+(0<o?44-o:0))}else{if(u=r._foucusId-1,u=Math.max(n[0],u),r.foucusId==u)return;r.foucusId=u,a<u?s+=0<o?o:0:i-1<=u&&u===i-1&&(s+=44+(0<o?o:0))}0!=s&&r.scrollTopAn_({el:t,to:t.scrollTop,form:t.scrollTop+s})}))}},{key:"getCenterScrolltopById",value:function(e,t){return(e=t-e-Math.floor(this._showBtnCount/2))*(this._btnWidth+2)}},{key:"createPanel",value:function(e){var t=document.createElement("div");return t.innerHTML='\n            <div class="fm-control-groups" style ="z-index: 20;width: 42px; position: absolute; background-color: white; box-shadow: rgba(0, 0, 0, 0.3) 2px 2px 3px; border-radius: 2px; top: 30px; right: 30px;"></div>\n        '.trim(),t.firstChild}},{key:"createGroupBtnPanel",value:function(e){var t=document.createElement("div");return e='\n            <div style = "overflow: hidden; height: '.concat(e,'px;" class="fm-layer-list"> </div\n        '),t.innerHTML=e.trim(),t.firstChild}},{key:"createMultiSwitchButton",value:function(e){var t=document.createElement("div");return e='\n            <div class="fm-control-groups-layer fm-btn-layer" style="padding: 10px; cursor: pointer;">\n                <img src="'.concat(e,'" style="width: 22px; height: 22px;">\n            </div>\n            '),t.innerHTML=e.trim(),t.firstChild}},{key:"createHr",value:function(){var e=document.createElement("div");return e.innerHTML='\n            <hr style="height: 1px; border-top: 1px solid rgba(153, 153, 153, 0.45); border-right: none; border-bottom: none; border-left: none; border-image: initial; width: 60%; margin: 0px 20%;">\n        '.trim(),e.firstChild}},{key:"createScrollButton",value:function(e,t){var n=document.createElement("div");return e='\n            <div class="scroll" id="scroll_'.concat(t+this.uuid,'" style="height: 18px; background: url(&quot;').concat(e,'&quot;) 50% 50% no-repeat; cursor: pointer;"></div>\n        '),n.innerHTML=e.trim(),n.firstChild}},{key:"createGroupButton",value:function(e,t){var n=document.createElement("div");return e="<label  data-gid=".concat(e.gid,' id="gid_').concat(e.gid+this.uuid,'" style="display: inline-block; text-align: center; width: ').concat(t,"px; height: ").concat(t,"px; line-height: ").concat(t,'px; margin: 0px; cursor: pointer; font-size: 0.8em; font-weight: bold; color: rgb(102, 102, 102);">\n                        <span>').concat(e.alias&&e.alias.toUpperCase()||e.gname.toUpperCase(),"</span>\n                    </label>"),n.innerHTML=e.trim(),n.firstChild}},{key:"changeScrollBtnPic",value:function(){var e=this._foucusId,t=this._map.listGroups.map((function(e){return e.gid})),n=document.getElementById("scroll_buttom"+this.uuid),r=document.getElementById("scroll_top"+this.uuid);e==t[0]?n&&(n.style.backgroundImage="url("+this._ctlOpt.imgURL+"arrow4.png)"):n&&(n.style.backgroundImage="url("+this._ctlOpt.imgURL+"arrow2.png)"),e==t[t.length-1]?r&&(r.style.backgroundImage="url("+this._ctlOpt.imgURL+"arrow3.png)"):r&&(r.style.backgroundImage="url("+this._ctlOpt.imgURL+"arrow1.png)")}},{key:"changeFocusGroup",value:function(e){this.foucusId=e}},{key:"changeGroupsSelect",value:function(e){this.setLayerStatus(e),this._map.showSingerOrMultiGroup(e)}},{key:"setLayerStatus",value:function(e){this._allLayer=e,this._allLayer?this._switchBtn.firstElementChild.src=this._ctlOpt.imgURL+"layers.png":this._switchBtn.firstElementChild.src=this._ctlOpt.imgURL+"layer.png"}},{key:"checkPosition",value:function(e,t,n){switch(n.style.left="",n.style.right="",n.style.top="",n.style.bottom="",e){case h.default.LEFT_TOP:n.style.left=t.x+"px",n.style.top=t.y+"px";break;case h.default.RIGHT_TOP:n.style.right=-t.x+"px",n.style.top=t.y+"px";break;case h.default.LEFT_BOTTOM:n.style.left=t.x+"px",n.style.bottom=-t.y+"px";break;case h.default.RIGHT_BOTTOM:n.style.right=-t.x+"px",n.style.bottom=-t.y+"px";break;default:n.style.left=t.x+"px",n.style.top=t.y+"px"}}},{key:"onChange",value:function(e){a=e}},{key:"foucusId",get:function(){return this._map.currentFocusGroup},set:function(e){var t=[];t.push.apply(t,(0,s.default)(this._map.visibleGroupIDs)),1==t.length?this._map.visibleGroupIDs=[e]:-1<this._map.visibleGroupIDs.indexOf(e)||(t.push(e),this._map.visibleGroupIDs=t),this._map.changeFocusToGroup({gid:e}),a&&a([e],1<this._map.visibleGroupIDs.length)}},{key:"setFocusStaus",value:function(e){document.getElementById("gid_"+this._foucusId+this.uuid).style.color="rgb(102, 102, 102)",this._foucusId=(0,o.default)(e),document.getElementById("gid_"+this._foucusId+this.uuid).style.color="rgb(30, 130, 250)",this.changeScrollBtnPic()}},{key:"allLayer",get:function(){return this._map.showAllGroup}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(19)),a=i(n(2)),s=i(n(430));n=function e(t){(0,a.default)(this,e),this.size=s.default.FMMap_CONTROL_NORMAL,this.position=null,this.offset=new fm.Vector2(0,0),this.imgURL="resource/style/wedgets/img/",(0,o.default)(this,t)},t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={FMMap_CONTROL_SMALL:"small",FMMap_CONTROL_NORMAL:"normal"},t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(19));n(88),n(8),n(9);var s=o(n(2)),u=o(n(3)),l=o(n(5)),c=o(n(6)),h=o(n(7)),f=(i=o(n(10)),o(n(27))),d=o(n(158)),p=o(n(66)),g=o(n(28)),m=o(n(118)),v=o(n(161)),y=n(73);i=function(e){(0,l.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.default)(e);return i=t?(n=(0,h.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,c.default)(this,i)}}(n);function n(e){var r;return(0,s.default)(this,n),(r=t.call(this,0,g.default.IMAGE_MARKER)).isInitSprite=!1,r._url=e.url,r._size=e.size,r._height=0,r._offsetHeight=e.height||0,r._renderNode=null,r._visible=!0,r._opx=e.x||0,r._opy=e.y||0,r._callBack=e.callback,r._moveAnimater=null,r._isMoving=!1,r._depth=e.depth,r._isJumping=!1,r._origonY=0,r.center=r.getCenterByAnchor(e.anchor),r.picLoading=!1,r.needAvoid=!0,r.markername=e.name,r}return(0,u.default)(n,[{key:"initSprite",value:function(){var e=this,t=this.findParent(f.default);if(!t)return!1;var n=!0;(i=t.materialManager.createPoiMaterial({imageUrl:this._url,imageSrc:this._url,alpha:1},(function(){e._renderNode?(e.picLoading=!1,e._renderNode.layers.set(0),e._renderNode.frustumCulled=!1,t.map.renderer.setImageMarkerSize(e._renderNode)):n=!1}),this._depth,this._priority)).userData.size=this._size,this._renderNode=new m.default(i),this._renderNode.markername=this.markername,n&&(this.picLoading=!0,this._renderNode.layers.set(2)),this._renderNode.mapNode=this,this._renderNode.parent=this.parent.scene,this._renderNode.center.set(this.center.x,this.center.y),t.map.renderer.setImageMarkerSize(this._renderNode),this._renderNode.visible=this.show,this._renderNode.name="spirit",this.isInitSprite=!0;var r=this.parent.parent.groupID,i=this.parent.parent.parent.mapcenter;return this._opx&&this._opy?(this._x=this._opx,this._y=this._opy):(this._x=i.x,this._y=i.y),this.setPosition(this.x,this.y,r,this._offsetHeight),this._callBack&&this._callBack(this),!0}},{key:"setPosition",value:function(e,t,n,r){var i=this.findParent(d.default);i?("number"==typeof n&&0<n&&this.moveToGroup(n),n=i.center,i=i.mapcenter,this._height=r,this._x=e,this._y=t,this._renderNode.position.set(this._x-i.x,n.y+this._height,n.y-this._y+i.y)):console.error("Can't change position before map init Marker")}},{key:"getPosition",value:function(){return{x:this._y,y:this._y,z:this._height,groupID:this.parent.parent.groupID}}},{key:"moveTo",value:function(e){var t,n,r,i,o,a=this;this._isMoving||(t=this.findParent(f.default),n=e.x,r=e.y,i=e.height||this._height,o=new p.default({x:this.x,y:this.y,height:this._height},{x:n,y:r,height:i},1e3*e.time,(function(){t.map.removeAnimater(o),a._moveAnimater=null,a._isMoving=!1,e.callback()}),(function(t){a.setPosition(t.x,t.y,0,t.height),e.update(t)})).start(),this._isMoving=!0,t.map.addAnimater(o),this._moveAnimater=o)}},{key:"moveToGroup",value:function(e){var t=this.findParent(f.default);this.parent.parent.groupID!==e&&(this.parent.parent.parent.groups[""+e]?(this._groupId=e,e=this.parent.parent.parent.groups[""+e].getOrCreateLayer("imageMarker"),this.parent.untiedMarker(this),e.addMarker(this),this._renderNode.material.opacity=.9,t.map.renderer.setImageMarkerSize(this._renderNode)):console.warn(y.tileMessage.noGroup))}},{key:"stopMoveTo",value:function(){var e=this.findParent(f.default);this._moveAnimater&&this._moveAnimater.stop(),e.map.removeAnimater(this._moveAnimater),this._isMoving=!1,this._moveAnimater=null}},{key:"jump",value:function(e){var t,n,r,i,o=this;this._renderNode&&!this._isJumping&&(this._isJumping=!0,"number"==typeof(t=(0,a.default)({height:8,times:0,duration:1,delay:0},e)).height&&"number"==typeof t.times&&"number"==typeof t.duration&&"number"==typeof t.delay&&(t.duration*=1e3,t.delay*=1e3,t.all=t.duration+t.delay,t.halfDuration=t.duration/2,n=t.height-this._height,this._origonY=this._renderNode.position.y,r=(new Date).getTime(),e=this.findParent(f.default),i=e.map,this.jumpEvent=function(e){var a;o._renderNode?(a=(new Date).getTime()-r,0!=t.times&&a/t.all>t.times?o.stopJump():(a%=t.all)>t.duration?o._renderNode.position.y!=o._origonY&&(o._renderNode.position.y=o._origonY):(a=1-(a=a/t.halfDuration-1)*a,o._renderNode.position.y=o._origonY+n*a)):i.off("frameLoop",o.jumpEvent)},i.on("frameLoop",this.jumpEvent)))}},{key:"stopJump",value:function(){this._renderNode&&this.jumpEvent&&(this._renderNode.position.y=this._origonY,this._isJumping=!1,this.findParent(f.default).map.off("frameLoop",this.jumpEvent))}},{key:"url",get:function(){return this._url},set:function(e){var t=this.findParent(f.default);if(!t)return!1;(t=t.materialManager.createPoiMaterial({imageUrl:e,imageSrc:e,alpha:1})).userData.size=this._size,this._renderNode.material.dispose(),this._renderNode.material=t,this._url=e}},{key:"setSize",value:function(){this.findParent(f.default).map.renderer.setFacilitySize(this._renderNode,this._size)}},{key:"dispose",value:function(){this.parent&&this.parent.removeMarker(this),this._renderNode&&(this._renderNode.material.dispose(),this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.geometry=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0)}},{key:"getCenterByAnchor",value:function(e){var t=new fm.Vector2(.5,.5);switch(e){case v.default.LEFT:t.setX(0);break;case v.default.RIGHT:t.setX(1);break;case v.default.TOP:t.setY(1);break;case v.default.BOTTOM:t.setY(0);break;case v.default.LEFT_TOP:t.set(0,1);break;case v.default.RIGHT_TOP:t.set(1,1);break;case v.default.LEFT_BOTTOM:t.set(0,0);break;case v.default.RIGHT_BOTTOM:t.set(1,0)}return t}},{key:"renderNode",get:function(){return this._renderNode}},{key:"visible",get:function(){return this._visible},set:function(e){e?this.parent.scene.children.indexOf(this._renderNode)<0&&this._renderNode&&this.parent.scene.add(this._renderNode):this._renderNode&&this.parent.scene.remove(this._renderNode),this._visible=e}},{key:"size",get:function(){return this._size},set:function(e){this._size=e}},{key:"height",set:function(e){this._height=e,this._renderNode.position.y=this._height}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(64),n(88);var o=i(n(2)),a=i(n(3)),s=n(250);n=function(){function e(t){(0,o.default)(this,e),this._visible=!0,this.x=t.x,this.y=t.y,this.domContent=t.domContent,this.fontSize=t.fontsize,this._id=null,this.anchor=t.anchor,this.domWidth=t.domWidth,this.domHeight=t.domHeight,this._height=t.height,this._param=t,this.alpha=t.alpha,this.groupID=t.groupID,this._left=null,this._scale=.05,void 0!==t.scale&&(this._scale=t.scale),this._top=null,this._isRuning=!1,this._map=null,this._renderNode=null,this._show=!0,this.needAvoid=!1,void 0!==t.needAvoid&&(this.needAvoid=t.needAvoid),this.parent=null}return(0,a.default)(e,[{key:"init",value:function(e){this._map=e,void 0===this.groupID&&(this.groupID=this._map.focusGroupID),(n=document.createElement("div")).innerHTML=this.domContent;var t=new s.CSS2DObject(n),n=(e=this.x-this._map.center.x,this._map.center.y-this.y);t.position.x=e,t.position.y=this._map.getFMGroup(this.groupID)._height+this._height,t.position.z=n,this._renderNode=t,this._map.renderer.htmlscene.add(t),this.groupID!==this._map.focusGroupID?t.element.childNodes[0].style.display="none":t.element.childNodes[0].style.display="block"}},{key:"_getMarkerInfo",value:function(){var e=this._map.renderer.domElementHeight,t=this._renderNode,n=this._map.renderer.getCameraByViewMode(this._map._viewMode);t.updateMatrixWorld(!0);var r=(i=(r=(new fm.Vector3).setFromMatrixPosition(t.matrixWorld)).applyMatrix4(n.matrixWorldInverse)).applyMatrix4(n.projectionMatrix),i=t.element.childNodes[0].offsetHeight/e;return e=t.element.childNodes[0].offsetWidth/this._map.renderer.domElementWidth,"PerspectiveCamera"===n.type&&(r.x*=n.aspect),{target:t,position:r,leftTop:n={x:r.x-e,y:r.y+i},rightDown:i={x:r.x+e,y:r.y-i}}}},{key:"show",get:function(){return this._show},set:function(e){this._show=e,this._renderNode.element.childNodes[0].style.display=e?"block":"none"}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(19));n(8),n(64),n(21),n(88),n(9);var s=o(n(2)),u=o(n(3)),l=o(n(5)),c=o(n(6)),h=o(n(7)),f=(i=o(n(10)),o(n(27))),d=o(n(118)),p=o(n(158)),g=o(n(66)),m=o(n(28)),v=o(n(161)),y=n(73);function _(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.default)(e);return i=t?(n=(0,h.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,c.default)(this,i)}}i=function(e){(0,l.default)(n,e);var t=_(n);function n(e,r){var i;if((0,s.default)(this,n),(i=t.call(this,0,m.default.TEXT_MARKER))._text=e.name,i._param=e,i.isInitSprite=!1,i._opx=e.x||0,i._opy=e.y||0,i._height=e.height||0,i._renderNode=null,i._visible=!0,i._isRuning=!1,i._size=1.4*e.fontsize,i._callBack=e.callback,i._fillcolor=e.fillcolor,i._platecolor=e.platecolor,i._platestrokecolor=e.platestrokecolor,i._fontsize=e.fontsize,i._strokecolor=e.strokecolor,i._content=e.content,i.needAvoid=!1,!i._content){i.needAvoid=!0;for(var o=i._text.split("%rn%"),a=[],u=0;u<o.length;u++)a.push({text:o[u],fontsize:i._fontsize,fontcolor:i._fillcolor,strokecolor:i._strokecolor});i._content=a}return i._scale=e.scale,i._target=r,i._moveAnimater=null,i.center=i.getCenterByAnchor(e.anchor),i.picLoading=!1,i}return(0,u.default)(n,[{key:"getCenterByAnchor",value:function(e){var t=new fm.Vector2(.5,.5);switch(e){case v.default.LEFT:t.setX(0);break;case v.default.RIGHT:t.setX(1);break;case v.default.TOP:t.setY(1);break;case v.default.BOTTOM:t.setY(0);break;case v.default.LEFT_TOP:t.set(0,1);break;case v.default.RIGHT_TOP:t.set(1,1);break;case v.default.LEFT_BOTTOM:t.set(0,0);break;case v.default.RIGHT_BOTTOM:t.set(1,0)}return t}},{key:"initSprite",value:function(){var e=this.findParent(f.default);if(!e)return!1;var t=e.materialManager.createTextMaterial(this._content,(0,a.default)({alpha:1},this._param),this._param.depth);return this._size=t.size,t.userData.size=t.size,this._renderNode=new d.default(t),this._renderNode.mapNode=this,this._renderNode.frustumCulled=!1,this._target?this.setTsize():e.map.renderer.setLabelSize(this._renderNode,t.size),this._renderNode.center.set(this.center.x,this.center.y),this.isInitSprite=!0,e=this.parent.parent.parent.mapcenter,this._target?(t=this._target.mapCoord,this._x=t.x,this._y=t.y):this._opx&&this._opy?(this._x=this._opx,this._y=this._opy):(this._x=e.x,this._y=e.y),this._height,this.setPosition(this.x,this.y,0,this._height),this._callBack&&this._callBack(),this._renderNode.visible=this.show,this._renderNode.name="spirit",!0}},{key:"redraw",value:function(){var e=this.findParent(f.default);if(!e)return!1;this.renderNode&&(e=e.materialManager.createTextMaterial(this._content,(0,a.default)({alpha:1},this._param)),this.renderNode.material.map.dispose(),this.renderNode.material.dispose(),this.renderNode.material=e)}},{key:"setTsize",value:function(){var e=(e=this._target).getNearestDis();this.renderNode&&(this.setSize(e*this._scale),this.renderNode.material.sizeAttenuation=!0)}},{key:"setSize",value:function(e){var t=this.findParent(f.default);this._size=e,t.map.renderer.setLabelSize(this._renderNode,e||this._size,!!e)}},{key:"setPosition",value:function(e,t,n,r){var i=this.findParent(p.default);i?("number"==typeof n&&0<n&&this.moveToGroup(n),i=i.mapcenter,this._height=r,this._x=e,this._y=t,this._renderNode.position.set(this._x-i.x,this._height,-this._y+i.y)):console.error("Can't change position before map init Marker")}},{key:"getPosition",value:function(){return{x:this._x,y:this._y,z:this._height,groupID:this.parent.parent.groupID}}},{key:"moveTo",value:function(e){var t,n,r,i,o=this;this._isRuning||(t=this.findParent(f.default),n=e.x,r=e.y,i=new g.default({x:this.x,y:this.y},{x:n,y:r},1e3*e.time,(function(){t.map.removeAnimater(i),o._moveAnimater=null,o._isRuning=!1,e.callback()}),(function(t){o.setPosition(t.x,t.y,0,0),e.update(t)})).start(),this._isRuning=!0,t.map.addAnimater(i),this._moveAnimater=i)}},{key:"moveToGroup",value:function(e){var t=this.findParent(f.default),n=this.parent.parent.groupID;n!==e&&(this.parent.parent.parent.groups[""+e]?(n=this.parent.parent.parent.groups[""+e].getOrCreateLayer("textMarker"),this._groupId=e,this.parent.untiedMarker(this),this._renderNode.material.opacity=.9,n.addMarker(this),t.map.renderer.setLabelSize(this._renderNode,this._renderNode.material.userData.size)):console.warn(y.tileMessage.noGroup))}},{key:"stopMoveTo",value:function(){var e=this.findParent(f.default);this._moveAnimater&&this._moveAnimater.stop(),e.map.removeAnimater(this._moveAnimater)}},{key:"dispose",value:function(){this._renderNode&&(this._renderNode.material.texture&&this._renderNode.material.texture.dispose(),this._renderNode.material.dispose(),this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.geometry=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0)}},{key:"name",get:function(){return this._text},set:function(e){this._text=e,this.reDraw()}},{key:"reDraw",value:function(){var e=this.findParent(f.default);if(!e)return!1;var t=e.materialManager.createLabelMaterial(this._text,(0,a.default)({alpha:1},this._param));t.userData.size=this._size,this._renderNode.material.dispose(),this._renderNode.material=void 0,this._renderNode.material=t,e.map.renderer.setLabelSize(this._renderNode,this._size)}},{key:"renderNode",get:function(){return this._renderNode}},{key:"visible",get:function(){return this._visible},set:function(e){e?this.parent.scene.children.indexOf(this._renderNode)<0&&this._renderNode&&this.parent.scene.add(this._renderNode):this._renderNode&&this.parent.scene.remove(this._renderNode),this._visible=e}},{key:"size",get:function(){return this._size}},{key:"fillcolor",get:function(){return this._fillcolor},set:function(e){this._fillcolor=e,this._param.fillcolor=e,this.reDraw()}},{key:"fontsize",get:function(){return this._fontsize}},{key:"strokecolor",get:function(){return this._strokecolor},set:function(e){this._strokecolor=e,this._param.strokecolor=e,this.reDraw()}},{key:"content",set:function(e){this._content=e}},{key:"height",set:function(e){this._height=e,this._renderNode.position.y=this._height}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(8);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(o=o(n(10)),n(252)),f=n(162),d=n(435);o=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(e){var r;return(0,a.default)(this,n),(r=t.call(this,e))._renderNode=null,r._lineLength=void 0!==e.lineLength?e.lineLength:5,r._center=e.center,r._minDistance=r._getMinDistance(e.points),r._points=r._getPoints(e.points),r._backgroundColor=e.backgroundColor,r._color=e.color,r._colors=r._getColor(),r._opacity=e.opacity,r._lineWidth=e.lineWidth,r._speed=e.speed,r._show=!0,r}return(0,s.default)(n,[{key:"initLine",value:function(){var e=new h.LineGeometry;e.setPositions(this._points),e.setColors(this._colors);var t=new f.LineMaterial({lineWidth:this._lineWidth,vertexColors:fm.VertexColors});t.uniforms.opacity.value=this._opacity,t.resolution.set(this.parent.parent.parent.parent._map.renderer._w,this.parent.parent.parent.parent._map.renderer._h),this._renderNode=new d.Line2(e,t),this._renderNode.mapNode=this,this._renderNode.name="line",this._renderNode.userData.colors=this._colors,this._renderNode.userData.speed=this._speed,this._renderNode.userData.frustumUpdate=!0,this._renderNode.userData.time=(new Date).getTime(),t=this.parent.parent.parent.mapcenter,this._x=t.x,this._y=t.y}},{key:"_getMinDistance",value:function(e){for(var t=0,n=0,r=0;r<e.length;r+=3){var i=new fm.Vector3(e[r],e[r+2],-e[r+1]),o=new fm.Vector3(e[r+3],e[r+5],-e[r+4]);n=i.distanceToSquared(o),0===r?t=i.distanceToSquared(o):n<t&&(t=n)}return Math.sqrt(t)}},{key:"_getPoints",value:function(e){for(var t=[],n=0;n<e.length-3;n+=3)for(var r=new fm.Vector3(e[n]-this._center.x,e[n+2],-e[n+1]+this._center.y),i=new fm.Vector3(e[n+3]-this._center.x,e[n+5],-e[n+4]+this._center.y),o=new fm.LineCurve3(r,i),a=(i=r.distanceTo(i),i=Math.ceil(i/(this._minDistance*this._lineLength)),o.getPoints(i)),s=0;s<a.length;s++)t.push(a[s].x,a[s].y,a[s].z);return t}},{key:"_getColor",value:function(){for(var e=[],t=new fm.Color(this._color),n=new fm.Color(this._backgroundColor),r=0;r<this._points.length/3;r++)3*r<3*this._lineLength?e.push(t.r,t.g,t.b):e.push(n.r,n.g,n.b);return e}},{key:"setColor",value:function(e){this._color=e,this._colors=this._getColor(),this._renderNode.userData.colors=this._colors}},{key:"setBackgroundColor",value:function(e){this._backgroundColor=e,this._colors=this._getColor(),this._renderNode.userData.colors=this._colors}},{key:"setOpacity",value:function(e){this._renderNode.material.uniforms.opacity.vaule=e}},{key:"renderNode",get:function(){return this._renderNode}},{key:"show",get:function(){return this._show},set:function(e){this._renderNode.visible=e,this._show=e,this._renderNode.userData.frustumUpdate=!0}}]),n}(o.default),t.default=o},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.Line2=void 0,r=i(n(19)),i=i(n(34));var o=n(436),a=n(252),s=n(162);n=function(e,t){o.LineSegments2.call(this),this.type="Line2",this.geometry=void 0!==e?e:new a.LineGeometry,this.material=void 0!==t?t:new s.LineMaterial({color:16777215*Math.random()})},t.Line2=n,n.prototype=(0,r.default)((0,i.default)(o.LineSegments2.prototype),{constructor:n,isLine2:!0})},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.LineSegments2=void 0,n(32),r=i(n(19)),i=i(n(34));var o,a,s,u,l,c,h,f,d,p=n(75),g=n(253),m=n(162);n=function(e,t){p.Mesh.call(this),this.type="LineSegments2",this.geometry=void 0!==e?e:new g.LineSegmentsGeometry,this.material=void 0!==t?t:new m.LineMaterial({color:16777215*Math.random()})},t.LineSegments2=n,n.prototype=(0,r.default)((0,i.default)(p.Mesh.prototype),{constructor:n,isLineSegments2:!0,computeLineDistances:(f=new p.Vector3,d=new p.Vector3,function(){for(var e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,r=new Float32Array(2*t.data.count),i=0,o=0,a=t.data.count;i<a;i++,o+=2)f.fromBufferAttribute(t,i),d.fromBufferAttribute(n,i),r[o]=0===o?0:r[o-1],r[o+1]=r[o]+f.distanceTo(d);var s=new p.InstancedInterleavedBuffer(r,2,1);return e.setAttribute("instanceDistanceStart",new p.InterleavedBufferAttribute(s,1,0)),e.setAttribute("instanceDistanceEnd",new p.InterleavedBufferAttribute(s,1,1)),this}),raycast:(o=new p.Vector4,a=new p.Vector4,s=new p.Vector4,u=new p.Vector3,l=new p.Matrix4,c=new p.Line3,h=new p.Vector3,function(e,t){null===e.camera&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');var n=e.ray,r=e.camera,i=r.projectionMatrix,f=this.geometry,d=(e=this.material).resolution,g=e.linewidth,m=f.attributes.instanceStart,v=f.attributes.instanceEnd;n.at(1,s),s.w=1,s.applyMatrix4(r.matrixWorldInverse),s.applyMatrix4(i),s.multiplyScalar(1/s.w),s.x*=d.x/2,s.y*=d.y/2,s.z=0,u.copy(s);var y=this.matrixWorld;l.multiplyMatrices(r.matrixWorldInverse,y);for(var _=0,x=m.count;_<x;_++){o.fromBufferAttribute(m,_),a.fromBufferAttribute(v,_),o.w=1,a.w=1,o.applyMatrix4(l),a.applyMatrix4(l),o.applyMatrix4(i),a.applyMatrix4(i),o.multiplyScalar(1/o.w),a.multiplyScalar(1/a.w);var A=o.z<-1&&a.z<-1,I=1<o.z&&1<a.z;A||I||(o.x*=d.x/2,o.y*=d.y/2,a.x*=d.x/2,a.y*=d.y/2,c.start.copy(o),c.start.z=0,c.end.copy(a),c.end.z=0,A=c.closestPointToPointParameter(u,!0),c.at(A,h),A=-1<=(I=p.Math.lerp(o.z,a.z,A))&&I<=1,I=u.distanceTo(h)<.5*g,A&&I&&(c.start.fromBufferAttribute(m,_),c.end.fromBufferAttribute(v,_),c.start.applyMatrix4(y),c.end.applyMatrix4(y),A=new p.Vector3,I=new p.Vector3,n.distanceSqToSegment(c.start,c.end,I,A),t.push({point:I,pointOnLine:A,distance:n.origin.distanceTo(I),object:this,face:null,faceIndex:_,uv:null,uv2:null})))}})})},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(9);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(i=o(n(10)),o(n(438))),f=o(n(28)),d=o(n(66)),p=n(73);i=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(e){var r;return(0,a.default)(this,n),(r=t.call(this,0,f.default.LOCATION_MARKER))._size=e.size||20,r._url=e.url,r._groupId=e.groupID||1,r._x=e.x||r._x,r._y=e.y||r._y,r._dheight=e.height||2.1,r._gid=e.groupID||1,r._scene=null,r._renderNode=null,r._map=null,r._callBack=e.callback,r.rotateAnimater=null,r}return(0,s.default)(n,[{key:"initSprite",value:function(e){var t=this,n=new h.default,r=new fm.MeshBasicMaterial,i=!0;return e.materialManager.loadTexture(this._url,(function(e){e.minFilter=fm.LinearFilter,e.generateMipmaps=!1,e.flipY=!1,r.map=e,r.needsUpdate=!0,t._renderNode?(t.picLoading=!1,t._renderNode.layers.set(0)):i=!1,t._map.renderer.resetLocationsSize()})),r.side=2,r.transparent=!0,this._renderNode=new fm.Mesh(n,r),this._renderNode.mapNode=this,i&&(this.picLoading=!0,this._renderNode.layers.set(2)),n=this._scene.mapcenter,this._x&&this._y||(this._x=n.x,this._y=n.y),this._callBack&&this._callBack(this),this.setPosition({x:this._x,y:this._y}),!0}},{key:"setPosition",value:function(e){if(this._scene){void 0!==e.zOffset&&(this._dheight=e.zOffset),void 0!==e.height&&(this._dheight=e.height);var t=this._scene.groups[this._gid];if(e.groupID&&e.groupID!==this._gid){var n=t,r=this._scene.groups[e.groupID];if(!r)return void console.warn(p.tileMessage.noGroup);n.removeLocation(this),r.addLocation(this),t=r,this.isAlwaysShow&&this.alwaysShow(),this._gid=e.groupID,this._groupId=this._gid}t=this._scene.mapcenter,this._x=e.x,this._y=e.y,this._renderNode.position.set(this._x-t.x,this._dheight,-this._y+t.y)}else console.error("Can't change position before map init Marker")}},{key:"rotate",value:function(e){this._renderNode.rotation.y=e*fm.Math.DEG2RAD}},{key:"rotateTo",value:function(e){var t=this,n=this.renderNode.rotation.y,r=e.to%360*fm.Math.DEG2RAD,i=r,o=0;r-n!=0&&(o=Math.sin(r-n)/Math.abs(Math.sin(r-n))*Math.acos(Math.cos(r-n))),o=n+o,this.rotateAnimater&&(this.rotateAnimater.stop(),this._map.removeAnimater(this.rotateAnimater));var a=new d.default({angle:n},{angle:o},e.duration?1e3*e.duration:500,(function(){t._map.removeAnimater(a),t.rotateAnimater=null,t._renderNode.rotation.y=i,e.callback&&e.callback()}),(function(n){t._renderNode.rotation.y=n.angle,e.update&&e.update()})).start();this._map.addAnimater(a),this.rotateAnimater=a}},{key:"moveTo",value:function(e){var t,n,r,i=this;this._isRuning||(t=e.x,n=e.y,r=new d.default({x:this._x,y:this._y},{x:t,y:n},e.time?1e3*e.time:500,(function(){i._map.removeAnimater(r),i._moveAnimater=null,i._isRuning=!1,e.callback&&e.callback()}),(function(t){i.setPosition({x:t.x,y:t.y,groupID:0,height:i._dheight}),e.update&&e.update(t)})).start(),this._isRuning=!0,this._map.addAnimater(r),this._moveAnimater=r)}},{key:"stopMoveTo",value:function(){var e=this._map.nodeManager;this._moveAnimater&&this._moveAnimater.stop(),e.map.removeAnimater(this._moveAnimater)}},{key:"alwaysShow",value:function(){var e;this._alwaysShow=!0;for(var t=this.parent;t;){if(t.isGroup){e=t;break}t=t.parent}e&&this.renderNode&&(this.renderNode.material.depthTest=!1,e.alwaysShowMarkers.push(this.renderNode))}},{key:"dispose",value:function(){this.parent&&this.parent.removeLocation(this),this.parent=null,this._renderNode&&(this._renderNode.material.dispose(),this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.geometry=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0)}},{key:"direction",get:function(){return this.renderNode.rotation.y},set:function(e){this.renderNode.rotation.y=e*fm.Math.DEG2RAD}},{key:"scene",set:function(e){this._scene=e}},{key:"map",set:function(e){this._map=e}},{key:"size",get:function(){return this._size}},{key:"renderNode",get:function(){return this._renderNode}},{key:"groupID",get:function(){return this._groupId}},{key:"height",get:function(){return this._dheight}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(32);var a=o(n(2)),s=o(n(5)),u=o(n(6)),l=o(n(7));n=function(e){(0,s.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}(n);function n(){(0,a.default)(this,n);var e=t.call(this),r=new Float32Array([-.5,0,-.5,0,0,.5,0,-.5,1,0,.5,0,.5,1,1,-.5,0,.5,0,1]);return r=new fm.InterleavedBuffer(r,5),e.setIndex([0,1,2,0,2,3]),e.addAttribute("position",new fm.InterleavedBufferAttribute(r,3,0,!1)),e.addAttribute("uv",new fm.InterleavedBufferAttribute(r,2,3,!1)),e}return n}(fm.BufferGeometry),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7));i=o(n(440)),o(n(256)),o(n(255)),i=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(e,r){return(0,a.default)(this,n),(r=t.call(this,e,r)).type="Line2",r.isLine2=!0,r}return(0,s.default)(n,[{key:"copy",value:function(){}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(32);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7));o(n(257)),n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(e,r){return(0,a.default)(this,n),(r=t.call(this,e,r)).type="LineSegments2",r.isLineSegments2=!0,r}return(0,s.default)(n,[{key:"computeLineDistances",value:function(){for(var e=new fm.Vector3,t=new fm.Vector3,n=this.geometry,r=n.attributes.instanceStart,i=n.attributes.instanceEnd,o=new Float32Array(2*r.data.count),a=0,s=0,u=r.data.count;a<u;a++,s+=2)e.fromBufferAttribute(r,a),t.fromBufferAttribute(i,a),o[s]=0===s?0:o[s-1],o[s+1]=o[s]+e.distanceTo(t);var l=new fm.InstancedInterleavedBuffer(o,2,1);return n.setAttribute("instanceDistanceStart",new fm.InterleavedBufferAttribute(l,1,0)),n.setAttribute("instanceDistanceEnd",new fm.InterleavedBufferAttribute(l,1,1)),this}},{key:"copy",value:function(e){return this}}]),n}(fm.Mesh),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(9),n(32);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=o(n(28)),f=o(n(27)),d=o(n(163)),p=o(n(50)),g=o(n(259)),m=o(n(120));n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(e){var r;return(0,a.default)(this,n),(r=t.call(this,0,h.default.POLYGON_MARKER))._alpha=void 0!==e.alpha?e.alpha:1,r._color=void 0!==e.color?e.color:"#FF0000",r._dheight=e.height||0,r._lineColor=e.lineColor||e.color||"#FF0000",r._lineWidth="number"==typeof e.lineWidth?e.lineWidth:2,r._points=void 0!==e.points?e.points:[],e.points.type&&("rectangle"===e.points.type&&e.points.startPoint&&e.points.startPoint.x&&e.points.startPoint.y?(r._x=e.points.startPoint.x+e.points.width/2,r._y=e.points.startPoint.y-e.points.height/2):(r._x=e.points.center.x,r._y=e.points.center.y)),r._line=null,r._linePoints=null,r}return(0,s.default)(n,[{key:"initPolygon",value:function(){return this.init()}},{key:"init",value:function(){if(!this._points)return!1;if(!this.parent)return!1;if(!this.parent.parent)return!1;var e=this.findParent(f.default);if(!e)return!1;var t={};t.resolution=new fm.Vector2(e.map.renderer.container.clientWidth,e.map.renderer.container.clientHeight);var n=e.map.renderer.getCameraByViewMode(e.map._viewMode);t.near=n.near,t.far=n.far,t.color=this._lineColor,t.alpha=1,t.lineWidth=this._lineWidth,e=this.parent.parent,(n=new fm.MeshBasicMaterial).transparent=!0,n.opacity=this._alpha,n.color=new fm.Color(this._color),n.side=2,n.depthTest=!1,e.getCenterPosition();var r=e.parent.mapcenter;switch(this._x||(this._x=r.x),this._y||(this._y=r.y),this._dheight?this._height=this._dheight:this._height=0,this._points.type){case"circle":for(var i=this.createCircleGeometry(this._points.radius,this._points.segments),o=new Float32Array(i.attributes.position.array.length-3),a=0;a<i.attributes.position.array.length;a++)2<a&&(o[a-3]=i.attributes.position.array[a]);break;case"rectangle":for(var s=(i=this.createReactGeometry(this._points.width,this._points.height)).attributes.position.array.length,u=i.attributes.position.array,l=(o=new Float32Array(s+3),0);l<s;l++)o[l]=i.attributes.position.array[l];o[s-6]=u[s-3],o[s-5]=u[s-2],o[s-4]=u[s-1],o[s-3]=u[s-6],o[s-2]=u[s-5],o[s-1]=u[s-4],o[s]=u[0],o[s+1]=u[1],o[s+2]=u[2];break;default:var c=(i=m.default.createShapeBufferGeometryByCenter(this._points,r)).attributes.position.array.length;o=new Float32Array(c+3);for(var h=0;h<c;h++)o[h]=i.attributes.position.array[h];o[c]=i.attributes.position.array[0],o[c+1]=i.attributes.position.array[1],o[c+2]=i.attributes.position.array[2]}return this._linePoints=o,(e=new d.default).initLinePoints(o,t),this._line=e,this._renderNode=new fm.Mesh(i,n),this._renderNode.mapNode=this,this._renderNode.add(e.renderNode),this._renderNode.rotation.set(Math.PI/2,0,0,"XYZ"),this._renderNode.position.set(this._x-r.x,this._height,-this._y+r.y),!0}},{key:"contain",value:function(e){if(!this._points)return!1;if(!this.parent)return!1;if(!this.parent.parent)return!1;if("circle"===this._points.type){if(Math.sqrt((e.x-this._x)*(e.x-this._x)+(e.y-this._y)*(e.y-this._y))<this._points.radius)return!0}else{if("rectangle"!==this._points.type)return p.default.pointInPolygon2d(this._points,e,this._points.length);if(Math.abs(e.x-this._x)<this._points.width/2&&Math.abs(e.y-this._y)<this._points.height/2)return!0}return!1}},{key:"createReactGeometry",value:function(e,t){return new fm.PlaneBufferGeometry(e,t)}},{key:"createCircleGeometry",value:function(e,t){return new fm.CircleBufferGeometry(e,t)}},{key:"createPolygonGeometry",value:function(e,t){for(var n=new fm.Shape,r=0;r<e.length;r++)0===r?n.moveTo(e[r].x-t.x,-e[r].y+t.y):n.lineTo(e[r].x-t.x,-e[r].y+t.y);return n.lineTo(e[0].x-t.x,-e[0].y+t.y),new fm.ShapeBufferGeometry(n)}},{key:"setColor",value:function(e){this._renderNode.material.color=new fm.Color(e)}},{key:"setLineColor",value:function(e){this._line._renderNode.material.color=new fm.Color(e)}},{key:"setLineWidth",value:function(e){this._renderNode.children[0].material.linewidth=e}},{key:"setAlpha",value:function(e){this._renderNode.material.opacity=e}},{key:"center",get:function(){for(var e=this.parent.parent,t=(e.parent.mapcenter,[]),n=0;n<this._linePoints.length;n+=3)t.push([this._linePoints[n],this._linePoints[n+1]]);return e=null,e=(0,g.default)([t],.01),"circle"!=this._points.type&&"rectangle"!=this._points.type?{x:this._x+e[0],y:this._y-e[1],z:this._height}:{x:this._x+e[0],y:this._y+e[1],z:this._height}}},{key:"isInitPolygon",get:function(){return this._isInit}},{key:"getPoints",value:function(){if("circle"===this._points.type){for(var e=null,t=[],n=(e=this.createCircleGeometry(this._points.radius,this._points.segments),1);n<e.attributes.position.count;n++)t.push({x:e.attributes.position.array[3*n]+this._x,y:e.attributes.position.array[3*n+1]+this._y});return e.dispose(),t}if("rectangle"!==this._points.type)return this._points;var r=null,i=[];return r=this.createReactGeometry(this._points.width,this._points.height),i.push({x:r.attributes.position.array[0]+this._x,y:r.attributes.position.array[1]+this._y}),i.push({x:r.attributes.position.array[3]+this._x,y:r.attributes.position.array[4]+this._y}),i.push({x:r.attributes.position.array[9]+this._x,y:r.attributes.position.array[10]+this._y}),i.push({x:r.attributes.position.array[6]+this._x,y:r.attributes.position.array[7]+this._y}),r.dispose(),i}}]),n}((n=o(n(260))).default),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));function s(e,t){return e<t?-1:t<e?1:0}n=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:s;if((0,o.default)(this,e),this.data=t,this.length=this.data.length,this.compare=n,0<this.length)for(var r=(this.length>>1)-1;0<=r;r--)this._down(r)}return(0,a.default)(e,[{key:"push",value:function(e){this.data.push(e),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,0<this.length&&(this.data[0]=t,this._down(0)),e}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(e){for(var t=this.data,n=this.compare,r=t[e];0<e;){var i=e-1>>1,o=t[i];if(0<=n(r,o))break;t[e]=o,e=i}t[e]=r}},{key:"_down",value:function(e){for(var t=this.data,n=this.compare,r=this.length>>1,i=t[e];e<r;){var o=1+(e<<1),a=t[o],s=o+1;if(s<this.length&&n(t[s],a)<0&&(o=s,a=t[s]),0<=n(a,i))break;t[e]=a,e=o}t[e]=i}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=o(n(28)),f=o(n(27)),d=o(n(120)),p=n(444),g=n(445),m=o(n(119));n=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(e){var r;return(0,a.default)(this,n),(r=t.call(this,0,h.default.GRADIENT_POLYGON_MARKER,e))._scale=void 0!==e.scale?e.scale:1,r._scaleValue=void 0!==e.scaleValue?e.scaleValue:0,r}return(0,s.default)(n,[{key:"init",value:function(){if(!this._points)return!1;if(!this.parent)return!1;if(!this.parent.parent)return!1;if(!this.findParent(f.default))return!1;var e,t,n=this.parent.parent.parent.mapcenter;switch(this._points.type){case"circle":e=this.createCircleGeometry(this._points.radius,this._points.segments);break;case"rectangle":e=this.createReactGeometry(this._points.width,this._points.height);break;default:m.default.convertPointsCoordsByCenter(this._points,n);var r=this._scalePoints(),i=new fm.Vector3,o=new fm.Box3;o.setFromPoints(r),o.getCenter(i),e=d.default.createCenterBufferGeometry(r,i)}return t=new fm.ShaderMaterial({uniforms:{color:{value:new fm.Color(this._color)},alpha:{value:this._alpha}},vertexShader:p.GradientVertShader,fragmentShader:g.GradientFragShader,depthTest:!0,depthWrite:!1,transparent:!0}),this._renderNode=new fm.Mesh(e,t),this._renderNode.mapNode=this,this._renderNode.rotation.set(-Math.PI/2,0,0,"XYZ"),this._renderNode.position.set(this.position.x,this._height,-this.position.y),!0}},{key:"_scalePoints",value:function(){if(1===this._scale)return this._points;var e=new fm.Vector3,t=new fm.Box3;return t.setFromPoints(this._points),t.getCenter(e),d.default.scalePoints(this._points,e,this._scale)}},{key:"_scaleValuePoints",value:function(){if(0===this._scaleValue)return this._points;var e=new fm.Vector3,t=new fm.Box3;return t.setFromPoints(this._points),t.getCenter(e),d.default.scaleValuePoints(this._points,e,this._scaleValue)}},{key:"createReactGeometry",value:function(e,t){return new fm.PlaneBufferGeometry(e,t)}},{key:"createCircleGeometry",value:function(e,t){return new fm.CircleBufferGeometry(e,t)}}]),n}((n=o(n(261))).default),t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.GradientVertShader=void 0,n="\nattribute float gradientAlpha;\n\nvarying float v_gradientAlpha;\n\nvoid main() {\n  v_gradientAlpha = gradientAlpha;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n ",t.GradientVertShader=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.GradientFragShader=void 0,n="\n\nuniform vec3 color;\nuniform float alpha;\n\nvarying float v_gradientAlpha;\n\nvoid main() {\n  gl_FragColor = vec4(color, alpha * v_gradientAlpha);\n}\n ",t.GradientFragShader=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,null,[{key:"polygonArea",value:function(e){if(e.length<3)return 0;var t=e.length;if(e[0].x===e[t-1].x&&e[0].y===e[t-1].y&&--t,t<3)return 0;e[0].y,e[t-1].x,e[1].x;for(var n=1;n<t-1;++n)e[n].y,e[n-1].x,e[n+1].x;return e[t-1].y*(e[t-2].x-e[0].x)*.5}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(3)),u=o(n(96)),l=o(n(5)),c=o(n(6)),h=o(n(7)),f=o(n(28)),d=o(n(27)),p=o(n(120)),g=o(n(119)),m=(i=o(n(261)),o(n(448))),v=o(n(160));i=function(e){(0,l.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.default)(e);return i=t?(n=(0,h.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,c.default)(this,i)}}(n);function n(e){var r;return(0,a.default)(this,n),(r=t.call(this,0,f.default.EXTRUDE_MARKER,e))._extrudeHeight=void 0!==e.extrudeHeight?e.extrudeHeight:1,r._edgesLine=new m.default((0,u.default)(r),e),r}return(0,s.default)(n,[{key:"init",value:function(){if(!this._points)return!1;if(!this.parent)return!1;if(!this.parent.parent)return!1;var e=this.findParent(d.default);if(!e)return!1;var t,n=this.parent.parent.parent.mapcenter,r={depth:this._extrudeHeight};switch(this._points.type){case"circle":g.default.convertPointCoordsByCenter(this.position,n),t=p.default.createCircleExtrudeBufferGeometry(this._points.radius,this._points.segments,r);break;case"rectangle":g.default.convertPointCoordsByCenter(this.position,n),t=p.default.createReactExtrudeBufferGeometry(this._points.width,this._points.height,r);break;default:g.default.convertPointsCoordsByCenter(this._points,n),t=p.default.createPointsExtrudeBufferGeometry(this._points,r)}return e=e._materialManager.getExtrudeMaterial(this._color,this._alpha),this._renderNode=new fm.Mesh(t,e),this._renderNode.mapNode=this,this._renderNode.rotation.set(-Math.PI/2,0,0,"XYZ"),this._renderNode.position.set(this.position.x,this._height,-this.position.y),this._edgesLine._lineType===v.default.TOP_LINES_TYPE?this.initTopLine():this.initLine(t),!0}},{key:"initLine",value:function(e){this._edgesLine.createLine(e),this._renderNode.add(this._edgesLine._renderNode)}},{key:"initTopLine",value:function(){var e=p.default.createShapeBufferGeometry(this._points);this.initLine(e),this._edgesLine._renderNode.position.setZ(this._extrudeHeight),e.dispose()}},{key:"setColor",value:function(e){var t=this.findParent(d.default);this._renderNode.material=t._materialManager.getExtrudeMaterial(e,this._alpha),this._color=e}},{key:"setAlpha",value:function(e){var t=this.findParent(d.default);this._renderNode.material=t._materialManager.getExtrudeMaterial(this._color,e),this._alpha=e}},{key:"setLineColor",value:function(e){this._edgesLine&&this._edgesLine.setLineColor(e)}},{key:"setLineAlpha",value:function(e){this._edgesLine&&this._edgesLine.setLineAlpha(e)}},{key:"dispose",value:function(){this._renderNode&&(this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.geometry=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0),this._edgesLine&&this._edgesLine.dispose()}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(i=o(n(10)),o(n(28))),f=o(n(160)),d=o(n(27));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}i=function(e){(0,u.default)(n,e);var t=p(n);function n(e,r){var i;return(0,a.default)(this,n),r=r||{},(i=t.call(this,0,h.default.EDGES_LINES_TYPE))._lineType=void 0!==r.lineType?r.lineType:f.default.TOP_LINES_TYPE,i._lineAlpha=void 0!==r.lineAlpha?r.lineAlpha:void 0!==r.alpha?r.alpha:1,i._lineColor=void 0!==r.lineColor?r.lineColor:void 0!==r.color?r.color:"#FF0000",i.parent=e,i._renderNode=null,i}return(0,s.default)(n,[{key:"createLine",value:function(e){var t=new fm.EdgesGeometry(e);e=(e=this.findParent(d.default))._materialManager.getExtrudeMaterial(this._lineColor,this._lineAlpha),this._renderNode=new fm.LineSegments(t,e)}},{key:"setLineColor",value:function(e){var t;e&&(t=this.findParent(d.default),this._renderNode.material=t._materialManager.getExtrudeMaterial(e,this._lineAlpha),this._lineColor=e)}},{key:"setLineAlpha",value:function(e){var t;e&&(t=this.findParent(d.default),this._renderNode.material=t._materialManager.getExtrudeMaterial(this._lineColor,e),this._lineAlpha=e)}},{key:"dispose",value:function(){this._renderNode&&(this._renderNode.geometry.dispose(),this._renderNode.material=void 0,this._renderNode.mapNode=void 0,this._renderNode=void 0)}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0,n(64),n(88),n(8),n(9);var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(i=o(n(10)),o(n(27))),f=o(n(66));i=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(e){var r;return(0,a.default)(this,n),(r=t.call(this,e))._visible=!0,r.x=e.x,r.y=e.y,r.domContent=e.domContent,r.fontSize=e.fontsize,r._id=null,r.anchor=e.anchor,r.domWidth=e.domWidth,r.domHeight=e.domHeight,r.height=e.height,r._param=e,r.alpha=e.alpha,r._left=null,r._top=null,r._isRuning=!1,r}return(0,s.default)(n,[{key:"initDom",value:function(e){var t,n,r=this.findParent(h.default);r&&(t=document.createElement("div"),(n=r._map.renderer.renderer.domElement.parentNode).style.position="absolute",n.appendChild(t),n=null,n=e.height?e.height+this.parent.height:this.parent.height,n=r._map.coordMapToScreen(e.x,e.y,n),t.name="domMarker",t.id=e.id,t.setAttribute("class","domMarker"),this._id=e.id,this.domNode=t,t.style.fontSize=e.fontSize,t.innerHTML=e.domContent,t.style.width=e.domWidth+"px",t.style.height=e.domHeight+"px",this._left=this._anchor(e,n).left,this._top=this._anchor(e,n).top,t.style.left=this._left,t.style.top=this._top,t.style.position="absolute")}},{key:"_anchor",value:function(e,t){var n=null,r=null;switch(e.anchor){case 9:default:n=t.x-e.domWidth/2+"px",r=t.y-e.domHeight/2+"px";break;case 5:n=t.x+"px",r=t.y+"px";break;case 6:n=t.x-e.domWidth+"px",r=t.y+"px";break;case 7:n=t.x+"px",r=t.y-e.domHeight+"px";break;case 8:n=t.x-e.domWidth+"px",r=t.y-e.domHeight+"px";break;case 1:n=t.x+"px",r=t.y-e.domHeight/2+"px";break;case 2:n=t.x-e.domWidth+"px",r=t.y-e.domHeight/2+"px";break;case 3:n=t.x-e.domWidth/2+"px",r=t.y+"px";break;case 4:n=t.x-e.domWidth/2+"px",r=t.y-e.domHeight+"px"}return{left:n,top:r}}},{key:"setPosition",value:function(e,t,n,r){var i=this.findParent(h.default);if(!i)return!1;this.x=e,this.y=t,t=null,0!==n&&(this.gid=n),this.height=r,t=this.height?this.height+i._map.groupSpace*n:i._map.groupSpace*n,t=i._map.coordMapToScreen(this.x,this.y,t),this._left=t.left,this._top=t.top,this.domNode.style.left=this._left,this.domNode.style.top=this._top}},{key:"moveToGroup",value:function(e){this.gid=e}},{key:"moveTo",value:function(e){var t,n,r,i,o=this;this._isRuning||(t=this.findParent(h.default),n=e.x,r=e.y,i=new f.default({x:this.x,y:this.y},{x:n,y:r},1e3*e.time,(function(){t.map.removeAnimater(i),o._moveAnimater=null,o._isRuning=!1,e.callback()}),(function(t){o.setPosition(t.x,t.y,o.groupID,o.height),e.update(t)})).start(),this._isRuning=!0,t.map.addAnimater(i),this._moveAnimater=i)}},{key:"stopMoveTo",value:function(){var e=this.findParent(h.default);this._moveAnimater&&this._moveAnimater.stop(),e.map.removeAnimater(this._moveAnimater),this._isRuning=!1,this._moveAnimater=null}},{key:"show",get:function(){return this._show},set:function(e){this._show=e,this.domNode.style.display=e?"block":"none"}}]),n}(i.default),t.default=i},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(116),n(9),n(8);var o=i(n(35)),a=i(n(25));function s(e,t){this.map_=e,this.texture_=null,this.config(t)}s.create=function(e,t){return new s(e,t)},s.prototype={getDeviceDPI:function(){var e,t=[];return void 0!==window.screen.deviceXDPI?(t[0]=window.screen.deviceXDPI,t[1]=window.screen.deviceYDPI):((e=document.createElement("DIV")).style.cssText="width:1in;height:1in;position:absolute;left:0px;top:0px;z-index:99;visibility:hidden",document.body.appendChild(e),t[0]=(0,o.default)(e.offsetWidth),t[1]=(0,o.default)(e.offsetHeight),e.parentNode.removeChild(e)),t},getDeviceWH:function(e){e=e||{};var t=this.map_.maxX-this.map_.minX,n=this.map_.maxY-this.map_.minY;return t={w:Math.round(t),h:Math.round(n)},n=this.getDeviceDPI(),t.w=(0,o.default)(t.w*n[0]/25.4),t.h=(0,o.default)(t.h*n[1]/25.4),n=1,e=e.maxSize||2048,(t.w>=e||t.h>=e)&&(t.w>=t.h?(n=t.h/t.w,t.w=e,t.h=(0,o.default)(e*n)):(n=t.w/t.h,t.h=e,t.w=(0,o.default)(e*n))),t},getPixXY:function(e,t){return(t={x:e=(e-this.map_.minX)/(this.map_.maxX-this.map_.minX),y:t=(this.map_.maxY-t)/(this.map_.maxY-this.map_.minY)}).x=t.x*this.options.width,t.y=t.y*this.options.height,t},config:function(e){var t=this,n=t.getDeviceWH(e),r=n.w,i=n.h;t.options={width:r,height:i,opacity:e.opacity?255*e.opacity:25500,radius:e.radius||30,bshadow:e.radius?e.radius/20:1.5,maxSize:e.mapSize||2048,boundVal:15e3,shadowBlur:Math.ceil(+e.radius),points:{max:e.max||100,data:[]},gradient:e.gradient||{.45:"rgb(0,0,255)",.55:"rgb(0,255,255)",.65:"rgb(0,255,0)",.95:"yellow",1:"rgb(255,0,0)"},isHeatPlan:e.isHeatPlan,heatHeight:e.heatHeight},e=(n=document.createElement("canvas")).getContext("2d"),n.width=r,n.height=i,t.options.ctx=e,t.options.canvas=n},renderShadow:function(e,t,n,r){var i=this,o=i.options.ctx,s=(i.options.radius,i.options.boundVal),u=(0,a.default)(n/i.options.points.max,10);o.save(),o.shadowColor="rgba(0, 0, 0, "+u+")",o.shadowOffsetX=s,o.shadowOffsetY=s,o.shadowBlur=i.options.shadowBlur,o.beginPath(),o.arc(e-s,t-s,i.options.radius,0,2*Math.PI,!0),o.closePath(),o.fill(),o.restore(),r||i.cachePoint(e,t,n)},colorize:function(){for(var e=this,t=e.options.width,n=e.options.height,r=e.options.ctx,i=(n=r.getImageData(0,0,t,n)).data,o=i.length,a=e.getPalette(),s=e.options.opacity,u=3;u<o;u+=4){var l=i[u],c=4*l;c&&(c=Math.floor(c),(l=s<l?s:l)<.8&&(l=.8),i[u-3]=a[c],i[u-2]=a[c+1],i[u-1]=a[c+2],i[u]=l)}r.putImageData(n,0,0)},renderToMap:function(e){var t=(t=this).options.canvas;t=new fm.Texture(t),this.setTexture(e,t)},disposeHeatMap:function(e){var t;e&&(t=this.map_.getFMGroup(e).getExtentMeshs()[0])._hasHeatMap&&(t._hasHeatMap=!1,t.material.map&&t.material.map.dispose(),this.options.isHeatPlan?(t.material.map=null,t.material.mapMixColor=!1,t.material.transparent=!0,t.material.needsUpdate=!0,this.map_.getFMGroup(e)._layers.model[0]._scene.getObjectByName("directionalLight").remove(this.map_.getFMGroup(e)._layers.model[0]._scene.getObjectByName("heatMap"))):(t=this.map_.getFMGroup(e).getModelMeshs(),this.map_.getFMGroup(e)._layers.model[0]._scene.traverse((function(e){"heatmap"===e.name&&e.parent.remove(e)})),t.forEach((function(e){if("MultiMaterial"===e.material.type)for(var t=e.material.materials.length,n=0;n<t;){var r=e.material.materials[n];r.map=null,r.mapMixColor=!1,r.transparent=!0,r.needsUpdate=!0,n+=0===n?3:2}else{var i=e.material;i.map=null,i.mapMixColor=!1,i.transparent=!0,i.needsUpdate=!0}}))))},getPalette:function(){var e=(n=document.createElement("canvas")).getContext("2d");n.width=1,n.height=256;var t,n,r=(n=this).options.gradient,i=e.createLinearGradient(0,0,1,256);for(t in r)i.addColorStop(t,r[t]);return e.fillStyle=i,e.fillRect(0,0,1,256),e.getImageData(0,0,1,256).data}},s.prototype.cachePoint=function(e,t,n){var r=(i=this).options.points,i=r.data;r.max,i.push([e,t,n])},s.prototype.clearPoints=function(){this.options.points.data=[],this.clear()},s.prototype.addPoint=function(e,t,n){if(e&&t&&n&&(t=this.getPixXY(e,t))){var r=this;r.clear();for(var i=r.options.points.data,o=i.length,a=0;a<o;a++)r.renderShadow(i[a][0],i[a][1],i[a][2],!0);r.renderShadow(t.x,t.y,n,!1),r.colorize()}},s.prototype.getTexture=function(e){return this.clearPoints(),this.addPoints(e),(e=this.options.canvas.cloneNode()).getContext("2d").drawImage(this.options.canvas,0,0),new fm.CanvasTexture(e)},s.prototype.setTexture=function(e,t){var n=this.map_.getFMGroup(e).getExtentMeshs()[0];n._hasHeatMap&&this.disposeHeatMap(e);var r,i=n.material.color,o=n.material.opacity;this.options.isHeatPlan?(n._hasHeatMap=!0,n.material.map=t,n.material.map.needsUpdate=!0,n.material.needsUpdate=!0,(r=n.clone()).name="heatMap",r.material.transparent=!0,r.material.opacity=1,r.material.color=new fm.Color(16777215),r.material.depthTest=!1,r.renderOrder=12,r.material.needsUpdate=!0,r.scale.z=.001,this.options.heatHeight?r.position.y+=this.options.heatHeight:r.position.y+=4,n.material=new fm.MeshLambertMaterial({color:i,opacity:o,transparent:!0}),this.map_.getFMGroup(e)._layers.model[0]._scene.getObjectByName("directionalLight").add(r)):(n._hasHeatMap=!0,n.material.mapMixColor=!0,n.material.map=t,n.material.map.needsUpdate=!0,n.material.needsUpdate=!0,n=this.map_.getFMGroup(e).getModelMeshs(),this.map_.getFMGroup(e)._layers.model[0]._scene.traverse((function(e){if(e instanceof fm.Mesh&&e.mapNode&&!e.mapNode._card.top)for(var n=0;n<e.children.length;n++)if(null!==e.children[n].material.map&&void 0!==e.children[n].material.map){var r=e.geometry,i=e.material;i.opacity=.8,i.needsUpdate=!0;var o=new fm.MeshLambertMaterial({map:t,transparent:!0,blending:fm.CustomBlending,blendEquation:fm.AddEquation,blendSrc:fm.SrcAlphaFactor,blendDst:fm.OneMinusSrcAlphaFactor});o.opacity=.9;for(var a=[i,o],s=new fm.Group,u=0;u<a.length;u++)s.add(new fm.Mesh(r,a[u]));(o=new fm.Mesh(r,o)).name="heatmap",o.renderOrder=11,o.material.depthTest=!1,o.material.depthWrite=!1,e.add(o)}})),n.forEach((function(e){if("MultiMaterial"===e.material.type)for(var n=e.material.materials.length,r=0;r<n;)e.material.materials[r].map=t,e.material.mapMixColor=!0,e.material.materials[r]._color=e.material.materials[r].color.clone(),e.material.materials[r].color=new fm.Color(16777215),e.material.materials[r].map.needsUpdate=!0,e.material.materials[r].needsUpdate=!0,r+=0===r?3:2;else e.material.mapMixColor=!0,e.material.map=t,e.material._color=e.material.color.clone(),1===e.material.opacity&&(e.material.transparent=!1),e.material.map.needsUpdate=!0,e.material.needsUpdate=!0})))},s.prototype.setModelMeshTexture=function(e){if(e&&texture_)if("MultiMaterial"===e.material.type)for(var t=e.material.materials.length,n=0;n<t;)e.material.materials[n].map=texture_,e.material.materials[n]._color=e.material.materials[n].color.clone(),e.material.materials[n].color=new fm.Color(16777215),e.material.materials[n].transparent=!1,e.material.materials[n].map.needsUpdate=!0,e.material.materials[n].needsUpdate=!0,n+=0===n?3:2;else e.material.map=texture_,e.material._color=e.material.color.clone(),e.material.color=new fm.Color(16777215),e.material.transparent=!1,e.material.map.needsUpdate=!0,e.material.needsUpdate=!0},s.prototype.clear=function(){this.options.ctx.clearRect(0,0,this.options.width,this.options.height)},s.prototype.addPoints=function(e){var t=this;t.clear();for(var n=t.options.points.data,r=n.length,i=0;i<r;i++)t.renderShadow(n[i][0],n[i][1],n[i][2],!0);for(var o=e.length,a=0;a<o;a++){var s=this.getPixXY(e[a].x,e[a].y);if(!s)return!0;t.renderShadow(s.x,s.y,e[a].value,!1)}t.colorize()},s.prototype.randomPoints=function(e){var t=this,n=t.options.width,r=t.options.height,i=t.options.points.max;t.clear();for(var o=0;o<e;o++){var a=Math.floor(Math.random()*n+1),s=Math.floor(Math.random()*r+1),u=Math.floor(Math.random()*i+1);t.renderShadow(a,s,u)}t.colorize()},n=s,t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3)),s=(i(n(262)),i(n(452))),u=i(n(453)),l=i(n(454)),c=i(n(457)),h=i(n(458));n=function(){function e(t,n){(0,o.default)(this,e),this._data=n||t.getCurrDecodeData(),this._map=t,this.Graphics=fengmap.Graphics,this.DataManager=new fengmap.inner.DataManager,this.singleAttrQuery=new s.default(this._data,this._map),this.bufferQuery=new l.default(this._data),this.multiAttrQuery=new u.default(this._data,this._map),this.circleQuery=new c.default(this._data),this.polygonQuery=new h.default(this._data)}return(0,a.default)(e,[{key:"query",value:function(e,t){var n=e.queryTypes?this.getQueryResult(e,e.queryTypes):e.circle?this.getQueryResult(e,["SINGLE","CIRCLE"]):this.getQueryResult(e,["SINGLE"]);return t&&t(n),n}},{key:"getQueryResult",value:function(e,t){for(var n=[],r=null,i=0;i<t.length;i++)switch(t[i]){case"SINGLE":default:n.push(this.singleAttrQuery.query(e));break;case"MULTI":n.push(this.multiAttrQuery.query(e));break;case"BUFFER":n.push(this.bufferQuery.query(e,this._map));break;case"CIRCLE":r=this.circleQuery.query(n,e,this._map),(n=[]).push(r);break;case"POLYGON":r=this.polygonQuery.query(n,e,this._map),(n=[]).push(r)}return n[0]}}]),e}(),t.default=n},function(e,t,n){"use strict";n(13),n(14);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(25));n(21),n(8);var h=l(n(48)),f=l(n(2)),d=l(n(3)),p=l(n(5)),g=l(n(6)),m=l(n(7));function v(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(e){(0,p.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,m.default)(e);return i=t?(n=(0,m.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,g.default)(this,i)}}(n);function n(e,r){return(0,f.default)(this,n),(e=t.call(this,e))._map=r,e}return(0,d.default)(n,[{key:"query",value:function(e){var t=[],n=e.groupID;n&&"number"==typeof n&&(n=[n]);var r,i=function(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=v(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}(this._data.floors);try{for(i.s();!(r=i.n()).done;){var u=r.value;(!n||-1<n.indexOf(u.gid))&&t.push.apply(t,(0,h.default)(this.queryGroup(u,e)))}}catch(e){i.e(e)}finally{i.f()}return t}},{key:"queryGroup",value:function(e,t){var n=this,r=this._data.scene.file_ver,i=t.nodeType||fengmap.FMNodeType.ALL;"all"==i&&(i=fengmap.FMNodeType.ALL);var o=[];return i!==fengmap.FMNodeType.EXTERNAL_MODEL&&i!==fengmap.FMNodeType.ALL||this.everyExternalModel(e,(function(i,a,s,u){var l,h=null,f=.1,d=.1;i&&a&&s&&u&&(d=1===r?(h=u.geo.substring(6,u.geo.length-1).split(" "),f=(0,c.default)(h[0]),(0,c.default)(h[1])):(f=(h=u.pts)[0],h[1]),l=a.height,h={},e.gid,n.check(i,a,t,s,u.geo,e.gid,h)&&o.push({ID:i.eid,name:i.name,ename:i.ename,groupID:e.gid,FID:i.fid,typeID:i.type,nodeType:fengmap.FMNodeType.EXTERNAL_MODEL,gdata:a,target:h.target||n._map.getFMGroup(e.gid).getNodeByLayerId("externalModel",i.eid),mapCoord:{x:f,y:d,z:l}}))})),i!==fengmap.FMNodeType.MODEL&&i!==fengmap.FMNodeType.ALL||this.everyModel(e,(function(i,a,s,u){var l,h=null,f=0,d=0;i&&a&&s&&u&&(d=1===r?(h=u.geo.substring(6,u.geo.length-1).split(" "),f=(0,c.default)(h[0]),(0,c.default)(h[1])):(f=(h=u.pts)[0],h[1]),l=a.height,h={},n.check(i,a,t,s,u.geo,e.gid,h)&&o.push({ID:i.eid,name:i.name,ename:i.ename,groupID:e.gid,FID:i.fid,typeID:i.type,nodeType:fengmap.FMNodeType.MODEL,gdata:a,target:h.target||n._map.getFMGroup(e.gid).getNodeByLayerId("model",i.eid),mapCoord:{x:f,y:d,z:l}}))})),i!==fengmap.FMNodeType.FACILITY&&i!==fengmap.FMNodeType.ALL||this.everyFacility(e,(function(i,a,s){var u=null,l=0,h=0;i&&a&&s&&(h=1===r?(u=a.geo.substring(6,a.geo.length-1).split(" "),l=(0,c.default)(u[0]),(0,c.default)(u[1])):(l=(u=a.pts)[0],u[1]),u=a.height,n.check(i,a,t,s,null,e.gid)&&o.push({ID:i.eid,name:i.name,ename:i.ename,groupID:e.gid,FID:i.fid,typeID:i.type,nodeType:fengmap.FMNodeType.FACILITY,gdata:a,target:n._map.getFMGroup(e.gid).getNodeByLayerId("facility",i.eid),mapCoord:{x:l,y:h,z:u}}))})),i!==fengmap.FMNodeType.LABEL&&i!==fengmap.FMNodeType.ALL||this.everyLabel(e,(function(i,a,s){var u=null,l=0,h=0;i&&a&&s&&(h=1===r?(u=a.geo.substring(6,a.geo.length-1).split(" "),l=(0,c.default)(u[0]),(0,c.default)(u[1])):(l=(u=a.pts)[0],u[1]),u=a.height,n.check(i,a,t,s,null,e.gid)&&o.push({ID:i.eid,name:i.name,ename:i.ename,groupID:e.gid,FID:i.fid,typeID:i.type,nodeType:fengmap.FMNodeType.LABEL,gdata:a,target:n._map.getFMGroup(e.gid).getNodeByLayerId("label",i.eid),mapCoord:{x:l,y:h,z:u}}))})),o}}]),n}((n=l(n(263))).default),t.default=n},function(e,t,n){"use strict";n(13),n(14);var r=n(4),i=n(16),o=n(17),a=n(18),s=n(11),u=n(0),l=n(1);u(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(25));n(21),n(8),n(62);var h=l(n(48)),f=l(n(2)),d=l(n(3)),p=l(n(5)),g=l(n(6)),m=l(n(7));function v(e,t){var n=void 0!==o&&e[a]||e["@@iterator"];if(!n){if(s(e)||(n=y(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function y(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(e){(0,p.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,m.default)(e);return i=t?(n=(0,m.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,g.default)(this,i)}}(n);function n(e,r){return(0,f.default)(this,n),(e=t.call(this,e))._map=r,e}return(0,d.default)(n,[{key:"query",value:function(e,t){if(e.pathPoints)return this.distanceSorting(e.groupID,e.pathPoints,e.startPoint,e.bufferRadius);var n=[],r=e.groupID;r&&"number"==typeof r&&(r=[r]),this._data;var i,o=v(this._data.floors);try{for(o.s();!(i=o.n()).done;){var a=i.value;(!r||-1<r.indexOf(a.gid))&&n.push.apply(n,(0,h.default)(this.queryGroup(a,e)))}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"queryGroup",value:function(e,t){var n=this,r=this._data.scene.file_ver,i=t.nodeType||fengmap.FMNodeType.ALL;"all"==i&&(i=fengmap.FMNodeType.ALL);var o=[];return i!==fengmap.FMNodeType.EXTERNAL_MODEL&&i!==fengmap.FMNodeType.ALL||this.everyExternalModel(e,(function(i,a,s,u){var l=null,h=.1,f=1===r?(l=u.geo.substring(6,u.geo.length-1).split(" "),h=(0,c.default)(l[0]),(0,c.default)(l[1])):(h=(l=u.pts)[0],l[1]),d=a.height;l={},n.check(i,a,t,s,u.geo,e.gid,l)&&o.push({ID:i.eid,name:i.name,ename:i.ename,groupID:e.gid,FID:i.fid,typeID:i.type,nodeType:fengmap.FMNodeType.MODEL,distance:"number"==typeof l.distance?l.distance:null,target:l.target||n._map.getFMGroup(e.gid).getNodeByLayerId("externalModel",i.eid),mapCoord:{x:h,y:f,z:d}})})),i!==fengmap.FMNodeType.MODEL&&i!==fengmap.FMNodeType.ALL||this.everyModel(e,(function(i,a,s,u){var l=null,h=0,f=1===r?(l=u.geo.substring(6,u.geo.length-1).split(" "),h=(0,c.default)(l[0]),(0,c.default)(l[1])):(h=(l=u.pts)[0],l[1]),d=a.height;l={},n.check(i,a,t,s,u.geo,e.gid,l)&&o.push({ID:i.eid,name:i.name,ename:i.ename,groupID:e.gid,FID:i.fid,typeID:i.type,nodeType:fengmap.FMNodeType.MODEL,distance:"number"==typeof l.distance?l.distance:null,target:l.target||n._map.getFMGroup(e.gid).getNodeByLayerId("model",i.eid),mapCoord:{x:h,y:f,z:d}})})),i!==fengmap.FMNodeType.FACILITY&&i!==fengmap.FMNodeType.ALL||this.everyFacility(e,(function(i,a,s){var u=null,l=0,h=1===r?(u=a.geo.substring(6,a.geo.length-1).split(" "),l=(0,c.default)(u[0]),(0,c.default)(u[1])):(l=(u=a.pts)[0],u[1]),f=a.height;u={},n.check(i,a,t,s,null,e.gid,u)&&o.push({ID:i.eid,name:i.name,ename:i.ename,groupID:e.gid,FID:i.fid,typeID:i.type,nodeType:fengmap.FMNodeType.FACILITY,distance:"number"==typeof u.distance?u.distance:null,target:n._map.getFMGroup(e.gid).getNodeByLayerId("facility",i.eid),mapCoord:{x:l,y:h,z:f}})})),i!==fengmap.FMNodeType.LABEL&&i!==fengmap.FMNodeType.ALL||this.everyLabel(e,(function(i,a,s){var u=null,l=0,h=1===r?(u=a.geo.substring(6,a.geo.length-1).split(" "),l=(0,c.default)(u[0]),(0,c.default)(u[1])):(l=(u=a.pts)[0],u[1]),f=a.height;u={},n.check(i,a,t,s,null,e.gid,u)&&o.push({ID:i.eid,name:i.name,ename:i.ename,groupID:e.gid,FID:i.fid,typeID:i.type,nodeType:fengmap.FMNodeType.LABEL,distance:"number"==typeof u.distance?u.distance:null,target:n._map.getFMGroup(e.gid).getNodeByLayerId("label",i.eid),mapCoord:{x:l,y:h,z:f}})})),(t.circle||t.polygon)&&o.sort((function(e,t){return"number"==typeof e.distance&&"number"==typeof t.distance?e.distance-t.distance:0})),o}}]),n}((n=l(n(263))).default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(3)),u=o(n(5)),l=o(n(6)),c=o(n(7)),h=(o=o(n(455)),n(456));o=function(e){(0,u.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.default)(e);return i=t?(n=(0,c.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,l.default)(this,i)}}(n);function n(e){return(0,a.default)(this,n),(e=t.call(this,e))._map=null,e}return(0,s.default)(n,[{key:"query",value:function(e,t){return this._map=t,this.distanceSorting(e.groupID,e.pathPoints,e.startPoint,e.bufferRadius)}},{key:"_calcBuffer",value:function(e,t){for(var n=0;n<e.length;n++){var r=[];r.push(e[n].x),r.push(e[n].y),e.splice(n,1,r)}var i=(0,h.straightenPoints)(e);return(0,h.polylineSegBuffers)(i,t)}},{key:"_BMIntersect",value:function(e,t,n){for(var r=0;r<n.length;r++){var i=[];i.push(n[r].x+e.x),i.push(n[r].y+e.y),n.splice(r,1,i)}return(0,h.isSegBuffersIntersecots)(t,n)}},{key:"_BFIntersect",value:function(e,t,n){return e=[e=[n.x+e.x,n.y+e.y]],(0,h.isSegBuffersIntersecots)(t,e)}},{key:"distanceSorting",value:function(e,t,n,r){var i,o,a=this._map.getFMGroup(e).mapCoord,s=[],u=[],l=[],c=[],f=[],d=[],p=this._map.nodeManager._scenes[this._map._currentSceneId].groups[""+e]._layers.model[0]._models,g=this._map.nodeManager._scenes[this._map._currentSceneId].groups[""+e]._layers.facility[0]._facility,m=this._calcBuffer(t,r);for(i in p){var v=p[i]._renderNode.children[0].geometry.vertices.concat();this._BMIntersect(a,m,v)&&(l.push(p[i]),v={model:v,fid:p[i].FID,target:l[l.length-1]},s.push(v))}for(o in g){var y=g[o]._renderNode.position.clone();this._BFIntersect(a,m,y)&&(c.push(p[o]),y={facility:y,fid:g[o].FID,target:c[c.length-1]},u.push(y))}for(var _=0;_<s.length;_++){var x=s[_].model;x={distance:x=(0,h.distPointToPolygon)([n.x,n.y],x),fid:s[_].fid,target:l[_]},f.push(x)}for(var A=0;A<u.length;A++){var I=u[A].facility;I={distance:I=Math.sqrt(Math.pow(n.x-I.x,2)+Math.pow(n.y-I.y,2)),fid:u[A].fid,target:c[A]},d.push(I)}return this._quickSort(f,0,f.length-1),this._quickSort(d,0,d.length-1),s=null,u=null,l=null,c=null,{model:f,facility:d}}},{key:"_quickSort",value:function(e,t,n){for(var r=[[t,n]];0<r.length;){var i=r.pop();if(!(i[0]>=i[1])){for(var o=i[0],a=i[1],s=i[0];o<a;){for(;e[a].distance>=e[s].distance&&s<a;)a--;if(a<=o)break;for(;e[o].distance<=e[s].distance&&o<a;)o++;var u=e[s];e[s]=e[a],e[a]=e[o],e[o]=u,s=o}r.push([i[0],s-1]),r.push([s+1,i[1]])}}}}]),n}(o.default),t.default=o},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(2)),s=o(n(5)),u=o(n(6)),l=o(n(7));n=function(e){(0,s.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);return i=t?(n=(0,l.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,u.default)(this,i)}}(n);function n(e){return(0,a.default)(this,n),t.call(this,e)}return n}((n=o(n(264))).default),t.default=n},function(e,t,n){"use strict";var r=(i=n(1))(n(53)),i=function(e){function t(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=e[(n+1)%e.length];t.push({x1:r[0],y1:r[1],x2:i[0],y2:i[1]})}return t}function n(e,n){var r=!1;return r=function(e,t){for(var n=0;n<e.length;n++)var r=e[n],i=i>r.x?i:r.x,o=o<r.x?o:r.x,a=a>r.y?a:r.y,s=s<r.y?s:r.y;for(n=0;n<t.length;n++)var u=t[n],l=l>u.x?l:u.x,c=c<u.x?c:u.x,h=h>u.y?h:u.y,f=f<u.y?f:u.y;return!(i<=c||l<=o||h<=s||a<=f)}(e,n),0==r?r:(r=function(e,t){for(var n=0;n<e.length;n++)for(var r=e[n],o=0;o<t.length;o++){var a=t[o];if(i(r.x1,r.y1,r.x2,r.y2,a.x1,a.y1,a.x2,a.y2))return!0}return!1}(t(e),t(n)),!!r||!!o(e[0],n)||!!o(n[0],e))}function i(e,t,n,r,i,o,a,s){if(!(Math.min(e,n)<=Math.max(i,a)&&Math.min(o,s)<=Math.max(t,r)&&Math.min(i,a)<=Math.max(e,n)&&Math.min(t,r)<=Math.max(o,s)))return!1;var u=(i-e)*(r-t)-(n-e)*(o-t),l=(a-e)*(r-t)-(n-e)*(s-t);return t=(e-i)*(s-o)-(a-i)*(t-o),o=(n-i)*(s-o)-(a-i)*(r-o),u*l<=1e-8&&t*o<=1e-8}function o(e,t){for(var n=e[0],r=e[1],i=!1,o=0,a=t.length-1;o<t.length;a=o++){var s=t[o][0],u=t[o][1],l=t[a][0],c=t[a][1];(s=r<u!=r<c&&n<(l-s)*(r-u)/(c-u)+s)&&(i=!i)}return i}Array.prototype.merge=function(e){for(var t=0;t<e.length;t++)this.push(e[t]);return this},Array.prototype.print=function(){for(var e=0;e<this.length;e++)this[e][0],this[e][1]};var a=function(){1==arguments.length&&(this.x=arguments[0][0],this.y=arguments[0][1]),2==arguments.length&&(this.x=arguments[0],this.y=arguments[1])};a.prototype.plus=function(e){return new a(this.x+e.x,this.y+e.y)},a.prototype.minus=function(e){return new a(this.x-e.x,this.y-e.y)},a.prototype.div=function(e){return new a(this.x/e,this.y/e)},a.prototype.mul=function(e){return"object"==(0,r.default)(e)&&e instanceof a?this.x*e.x+this.y*e.y:"number"==typeof e?new a(this.x*e,this.y*e):this},a.prototype.crossMul=function(e){return this.x*e.y-e.x*this.y},a.prototype.len=function(){var e=this.x*this.x+this.y*this.y;return Math.sqrt(e)},a.prototype.toList=function(){return[this.x,this.y]};var s=function(e,t,n,r){this._row1=new a(e,t),this._row2=new a(n,r)};s.prototype.mul=function(e){if(e instanceof a)return new a(this._row1.mul(e),this._row2.mul(e))};var u=function(e){return e=3.1415926*e/180,new s(Math.cos(e),-Math.sin(e),Math.sin(e),Math.cos(e))},l=function(e,t,n){t=new a(t),e=new a(e);for(var r=(r=(r=t.minus(e)).div(r.len())).mul(n),i=(n=new s(0,-1,1,0)).mul(r),o=(t.plus(r),e.minus(r),t.plus(i),t.minus(i),e.plus(i),e.minus(i),i.mul(-1)),l=[],c=[],h=0;h<=18;h++){var f=u(10*h),d=f.mul(i);d=e.plus(d),l.push(d.toList()),f=f.mul(o),f=t.plus(f),c.push(f.toList())}return l.merge(c)};function c(e,t,n,r,i,o){var a=(i-n)*(e-n)+(o-r)*(t-r);if(a<=0)return Math.sqrt((e-n)*(e-n)+(t-r)*(t-r));var s=(i-n)*(i-n)+(o-r)*(o-r);return s<=a?Math.sqrt((e-i)*(e-i)+(t-o)*(t-o)):(n+=(i-n)*(s=a/s),s=r+(o-r)*s,Math.sqrt((e-n)*(e-n)+(s-t)*(s-t)))}e.isPolygonIntersects=n,e.isPointInPolygon=o,e.polylineSegBuffers=function(e,n){return function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];n.push(l([i.x1,i.y1],[i.x2,i.y2],t))}return n}(e=t(e),n)},e.isSegBuffersIntersecots=function(e,t){for(var r=0;r<e.length;r++)if(n(e[r],t))return!0;return!1},e.distPointToPolygon=function(e,t){for(var n=999999999999,r=0;r<t.length;r++){var i=t[r],o=t[(r+1)%t.length];(o=c(e[0],e[1],i[0],i[1],o[0],o[1]))<n&&(n=o)}return n},e.straightenPoints=function(e){if(e.length<3)return e;var t=[];t.push(e[0]);for(var n=1;n<e.length-1;n++){var r=new a(t[t.length-1]),i=new a(e[n]).minus(r);r=new a(e[n+1]).minus(new a(e[n])),r=i.crossMul(r),Math.abs(r)<.001||t.push(e[n])}return t.push(e[e.length-1]),t}};"object"===(0,r.default)(t)&&void 0!==e?i(t):(n=[t],void 0===(i="function"==typeof i?i.apply(t,n):i)||(e.exports=i))},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(25));n(21);var s=o(n(2)),u=o(n(3)),l=o(n(5)),c=o(n(6)),h=o(n(7)),f=o(n(49));n=function(e){(0,l.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.default)(e);return i=t?(n=(0,h.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,c.default)(this,i)}}(n);function n(e){return(0,s.default)(this,n),t.call(this,e)}return(0,u.default)(n,[{key:"query",value:function(e,t,n){var r=t.circle,i=[],o=this._data.scene.file_ver;e:for(var s=0;s<e[0].length;s++){var u=e[0][s].gdata;e[0][s].nodeType;var l,c=null,h=0,d=0;d=1===o?(c=(l=u.geo).substring(6,l.length-1).split(" "),h=(0,a.default)(c[0]),(0,a.default)(c[1])):(h=(c=u.pts)[0],c[1]);var p=r.center,g=Math.sqrt((h-p.x)*(h-p.x)+(d-p.y)*(d-p.y));if(g<r.radius)e[0][s].distance=g,i.push(e[0][s]);else if(5===e[0][s].nodeType){var m=null;(d=n.getFMGroup(e[0][s].groupID).getNodeByLayerId("model",e[0][s].ID))&&d._data&&(m=d._data.vertices),null==m&&(m=(1===o?f.default.convertGeo2Geometry(u.geo):f.default.convertArr2Geometry(u.idxs,u.pts)).vertices);for(var v=m.length/2,y=0;y<v-1;y++){var _=2*y;if(this.Graphics.pointDistanceToLine(p,{x:m[_],y:m[_+1]},{x:m[_+2],y:m[_+3]},{})<r.radius){e[0][s].distance=g,i.push(e[0][s]);continue e}}this.Graphics.pointInPolygonVector2d(m,p,m.length)&&(e[0][s].distance=g,i.push(e[0][s]))}}return i}}]),n}((n=o(n(265))).default),t.default=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(1);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(25));n(21);var s=o(n(2)),u=o(n(3)),l=o(n(5)),c=o(n(6)),h=o(n(7)),f=o(n(49)),d=o(n(459));n=function(e){(0,l.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.default)(e);return i=t?(n=(0,h.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,c.default)(this,i)}}(n);function n(e){return(0,s.default)(this,n),t.call(this,e)}return(0,u.default)(n,[{key:"query",value:function(e,t,n){for(var r=this._data.scene.file_ver,i=2<t.polygon.length?new d.default(t.polygon,!0):null,o=[],s=0;s<e[0].length;s++){var u=e[0][s].gdata;e[0][s].nodeType;var l,c=null,h=(c=1===r?(l=u.geo).substring(6,l.length-1).split(" "):u.pts,{x:(0,a.default)(c[0]),y:(0,a.default)(c[1])});i.contain(h)?(e[0][s].distance=i.distanceToPoint(h),o.push(e[0][s])):5===e[0][s].nodeType&&(l=null,(c=n.getFMGroup(e[0][s].groupID).getNodeByLayerId("model",e[0][s].ID))&&c._data&&(l=c._data.vertices),null==l&&(l=(1===r?f.default.convertGeo2Geometry(u.geo):f.default.convertArr2Geometry(u.idxs,u.pts)).vertices),i.containXYArray(l)&&(e[0][s].distance=i.distanceToPoint(h),o.push(e[0][s])))}return o}}]),n}((n=o(n(265))).default),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3)),s=i(n(460));n=function(){function e(t){(0,o.default)(this,e),this._points=t,this._bb=new s.default(t);var n=t.length;t[0].x==t[n-1].x&&t[0].y==t[n-1].y&&n--,this._count=n,this._center=fengmap.inner.Graphics.calcCenterOfGravityPoint(t,this._count)}return(0,a.default)(e,[{key:"contain",value:function(e){return!!this._bb.contain(e)&&fengmap.inner.Graphics.pointInPolygon2d(this._points,e,this._count)}},{key:"containXYArray",value:function(t){for(var n=t.length/2,r=[],i=!1,o=0;o<n;o++){var a={x:t[a=2*o],y:t[a+1]};if(this.contain(a)){i=!0;break}r.push(a)}if(i)return!0;var s=new e(r);if(fengmap.inner.Graphics.isRectCross(this._bb._min,this._bb._max,s._bb._min,s._bb._max))for(var u=0;u<this._count;u++)if(s.contain(this._points[u])){i=!0;break}return!!i}},{key:"distanceToPoint",value:function(e){return fengmap.inner.Graphics.distanceOfTwoPoints(this._center,e)}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(59);var o=i(n(2)),a=i(n(3));n=function(){function e(t){if((0,o.default)(this,e),this._min={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this._max={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE},t)for(var n=t.length,r=0;r<n;r++)this.expandBy(t[r])}return(0,a.default)(e,[{key:"expandBy",value:function(e){e.x<this._min.x&&(this._min.x=e.x),e.y<this._min.y&&(this._min.y=e.y),e.x>this._max.x&&(this._max.x=e.x),e.y>this._max.y&&(this._max.y=e.y)}},{key:"contain",value:function(e){return!(e.x<this._min.x||e.x>this._max.x||e.y<this._min.y||e.y>this._max.y)}}]),e}(),t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={MODULE_SHORTEST:1,MODULE_BEST:2},t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={Left:0,Center:1,Right:2},t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={PRIORITY_DEFAULT:1,PRIORITY_LIFTFIRST:2,PRIORITY_ESCALATORFIRST:3,PRIORITY_STAIRFIRST:4,PRIORITY_LIFTONLY:5,PRIORITY_ESCALATORONLY:6,PRIORITY_STAIRONLY:7,PRIORITY_ACCESSIBLEONLY:8,PRIORITY_LIFTFIRST1:9,PRIORITY_ESCALATORFIRST1:10,PRIORITY_STAIRFIRST1:11},t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={MODE_2D:"top",MODE_3D:"3d"},t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={ROUTE_SUCCESS:1,ROUTE_FAILED_NO_FMDBDATA:2,ROUTE_FAILED_TOO_CLOSE:3,ROUTE_FAILED_NO_DATA_START:4,ROUTE_FAILED_NO_DATA_END:5,ROUTE_FAILED_NO_STAIR:6,ROUTE_FAILED_NOTSUPPORT:7,ROUTE_FAILED_CANNOT_CALCULATE:8,ROUTE_FAILED_CANNOT_ARRIVE:9,ROUTE_FAILED_WAYPOINT_CALCULATE_ERROR:10,ROUTE_FAILED_NO_START_ARRIVAL:11,ROUTE_FAILED_NO_END_ARRIVAL:12,ROUTE_FAILED_OUTLINE:13,ROUTE_FAILED_NO_DOOR_START:14,ROUTE_FAILED_NO_DOOR_END:15},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e),this.x=void 0,this.y=void 0,this.z=void 0,this.gid=void 0}return(0,a.default)(e,[{key:"setGeoPoint",value:function(e){this.x=e.x,this.y=e.y}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2));n=function e(t,n){(0,o.default)(this,e),this.x=void 0===t?0:t,this.y=void 0===n?0:n},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3));n=function(){function e(t,n,r){(0,o.default)(this,e),this._locOrigion=null,this._locRange=null,this._mapOrigion=null,this._mapAxisX=null,this._mapAxisY=null,this._mapRange=null,t&&n&&r&&this.init(t,n,r)}return(0,a.default)(e,[{key:"init",value:function(e,t,n){if(4!=n.length)return!1;this._locOrigion=e,this._locRange=t,this._mapOrigion=n[0],this._mapAxisX={x:n[1].x-n[0].x,y:n[1].y-n[0].y},this._mapAxisY={x:n[3].x-n[0].x,y:n[3].y-n[0].y},this._mapRange={x:this._getVectorLen(this._mapAxisX),y:this._getVectorLen(this._mapAxisY)},this._mapAxisX.x/=this._mapRange.x,this._mapAxisX.y/=this._mapRange.x,this._mapAxisY.x/=this._mapRange.y,this._mapAxisY.y/=this._mapRange.y}},{key:"transform",value:function(e){return e={x:(e={x:(e.x-this._locOrigion.x)/this._locRange.x,y:(e.y-this._locOrigion.y)/this._locRange.y}).x*this._mapRange.x,y:e.y*this._mapRange.y},{x:this._mapOrigion.x+this._mapAxisX.x*e.x+this._mapAxisY.x*e.y,y:this._mapOrigion.y+this._mapAxisX.y*e.x+this._mapAxisY.y*e.y}}},{key:"_getVectorLen",value:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)}}]),e}(),t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={NaviNodeType_NULL:-1,NaviNodeType_COMMON:0,NaviNodeType_SIDE:1,NaviNodeType_FLOOR:2,NaviNodeType_EXTENT:3,NaviLiftType_NULL:0,NaviLiftType_Lift:1,NaviLiftType_Stair:2,NaviLiftType_Escalator:3,NaviLiftType_Accessible:4,NaviLiftEntry_BOTH:0,NaviLiftEntry_UP:1,NaviLiftEntry_DOWN:2,NaviLiftEntry_FORBID:3,NaviEntranceType_NULL:0,NaviEntranceType_EXIT:1,NaviEntranceType_ENTRANCE:2,NaviEntranceType_ACCESS:3,NaviRoadRank_MAIN:1,NaviRoadRank_MINOR:2,NaviRoadRank_NARROW:3,NaviRoadEntry_BOTH:0,NaviRoadEntry_FORWARD:1,NaviRoadEntry_BACK:2,NaviRoadEntry_FORBID:3,NaviRoadPass_NULL:-1,NaviRoadPass_NOT_THROUGH:0,NaviRoadPass_THROUGH:1,NaviZoneType_NULL:-1,NaviZoneType_PASS_UNRESTRAINT:0,NaviZoneType_PASS_THROUGH:1,NaviZoneType_PASS_NOT_THROUGH:2,NaviZoneType_NO_ENTRY:3,NaviZoneType_CORRIDOR:4,NaviModelPassType_PASS_THROUGH:0,NaviModelPassType_PASS_NOT_THROUGH:1,NaviModelPassType_NOT_PASS:2,NaviModelPassType_DECORATE:3,NaviRoadHinderType_HINDER_GENERAL:0,NaviRoadHinderType_HINDER_HIGH:1,NaviObstructType_MODEL:0,NaviObstructType_EXTENT:1},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0,n(59);var o=i(n(2)),a=i(n(3));n=function(){function e(){(0,o.default)(this,e),this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE}return(0,a.default)(e,[{key:"init",value:function(){this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE}},{key:"expandBy",value:function(e){e&&e.x&&e.y&&(this.minX>e.x&&(this.minX=e.x),this.maxX<e.x&&(this.maxX=e.x),this.minY>e.y&&(this.minY=e.y),this.maxY<e.y&&(this.maxY=e.y))}},{key:"isSeparate",value:function(e){return this.minX>e.maxX||this.minY>e.maxY||this.maxX<e.minX||this.maxY<e.minY}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(1);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=i(n(3)),s=i(n(50));n=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,null,[{key:"MercatorToWGS84",value:function(e){var t={},n=e.x/20037508.34*180;return e=e.y/20037508.34*180,e=180/Math.PI*(2*Math.atan(Math.exp(e*Math.PI/180))-Math.PI/2),t.dLong=n,t.dLat=e,t}},{key:"WGS84ToWebMercator",value:function(e){var t={},n=20037508.34*e.x/180;return e=20037508.34*(e=Math.log(Math.tan((90+e.y)*Math.PI/360))/(Math.PI/180))/180,t.x=n,t.y=e,t}},{key:"Contain",value:function(e,t){return e._points.length,"circle"!==e._points.type?"rectangle"!==e._points.type?s.default.pointInPolygon2d(e._points,t,e._points.length):Math.abs(t.x-e._x)<e._points.width/2&&Math.abs(t.y-e._y)<e._points.height/2||void 0:(t=Math.sqrt((t.x-e._x)*(t.x-e._x)+(t.y-e._y)*(t.y-e._y)))<e._points.radius||void 0}},{key:"GetLength",value:function(e,t){var n=e.x-t.x;return t=e.y-t.y,Math.sqrt(n*n+t*t)}},{key:"GetArea",value:function(e){return s.default.calcPolygonArea2d(e)}},{key:"ScreenToWebMercator",value:function(e,t,n,r,i){}},{key:"WebMercatorToScreen",value:function(e){}},{key:"CoordTransform",value:function(){}}]),e}(),t.default=n},function(e,t){var n=window;e.exports=function(e,t){if(!e.jWeixin){var n={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest",openEnterpriseRedPacket:"getRecevieBizHongBaoRequest",startSearchBeacons:"startMonitoringBeacons",stopSearchBeacons:"stopMonitoringBeacons",onSearchBeacons:"onBeaconsInRange",consumeAndShareCard:"consumedShareCard",openAddress:"editAddress"},r=function(){var e,t={};for(e in n)t[n[e]]=e;return t}(),i=e.document,o=i.title,a=navigator.userAgent.toLowerCase(),s=navigator.platform.toLowerCase(),u=!(!s.match("mac")&&!s.match("win")),l=-1!=a.indexOf("wxdebugger"),c=-1!=a.indexOf("micromessenger"),h=-1!=a.indexOf("android"),f=-1!=a.indexOf("iphone")||-1!=a.indexOf("ipad"),d=(a=a.match(/micromessenger\/(\d+\.\d+\.\d+)/)||a.match(/micromessenger\/(\d+\.\d+)/))?a[1]:"",p={initStartTime:k(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},g={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:f?1:h?2:-1,clientVersion:d,url:encodeURIComponent(location.href)},m={},v={_completes:[]},y={state:0,data:{}};R((function(){p.initEndTime=k()}));var _=!1,x=[],A={config:function(t){L("config",m=t);var r=!1!==m.check;R((function(){if(r)b(n.config,{verifyJsApiList:S(m.jsApiList),verifyOpenTagList:S(m.openTagList)},function(){v._complete=function(e){p.preVerifyEndTime=k(),y.state=1,y.data=e},v.success=function(e){g.isPreVerifyOk=0},v.fail=function(e){v._fail?v._fail(e):y.state=-1};var e=v._completes;return e.push((function(){var e;u||l||m.debug||d<"6.0.2"||g.systemType<0||(e=new Image,g.appId=m.appId,g.initTime=p.initEndTime-p.initStartTime,g.preVerifyTime=p.preVerifyEndTime-p.preVerifyStartTime,A.getNetworkType({isInnerInvoke:!0,success:function(t){g.networkType=t.networkType,t="https://open.weixin.qq.com/sdk/report?v="+g.version+"&o="+g.isPreVerifyOk+"&s="+g.systemType+"&c="+g.clientVersion+"&a="+g.appId+"&n="+g.networkType+"&i="+g.initTime+"&p="+g.preVerifyTime+"&u="+g.url,e.src=t}}))})),v.complete=function(t){for(var n=0,r=e.length;n<r;++n)e[n]();v._completes=[]},v}()),p.preVerifyStartTime=k();else{y.state=1;for(var e=v._completes,t=0,i=e.length;t<i;++t)e[t]();v._completes=[]}})),A.invoke||(A.invoke=function(t,n,r){e.WeixinJSBridge&&WeixinJSBridge.invoke(t,M(n),r)},A.on=function(t,n){e.WeixinJSBridge&&WeixinJSBridge.on(t,n)})},ready:function(e){0!=y.state?e():(v._completes.push(e),!c&&m.debug&&e())},error:function(e){d<"6.0.2"||(-1==y.state?e(y.data):v._fail=e)},checkJsApi:function(e){b("checkJsApi",{jsApiList:S(e.jsApiList)},(e._complete=function(e){var t;h&&(t=e.checkResult)&&(e.checkResult=JSON.parse(t)),e=function(e){var t,n=e.checkResult;for(t in n){var i=r[t];i&&(n[i]=n[t],delete n[t])}return e}(e)},e))},onMenuShareTimeline:function(e){C(n.onMenuShareTimeline,{complete:function(){b("shareTimeline",{title:e.title||o,desc:e.title||o,img_url:e.imgUrl||"",link:e.link||location.href,type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareAppMessage:function(e){C(n.onMenuShareAppMessage,{complete:function(t){"favorite"===t.scene?b("sendAppMessage",{title:e.title||o,desc:e.desc||"",link:e.link||location.href,img_url:e.imgUrl||"",type:e.type||"link",data_url:e.dataUrl||""}):b("sendAppMessage",{title:e.title||o,desc:e.desc||"",link:e.link||location.href,img_url:e.imgUrl||"",type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareQQ:function(e){C(n.onMenuShareQQ,{complete:function(){b("shareQQ",{title:e.title||o,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareWeibo:function(e){C(n.onMenuShareWeibo,{complete:function(){b("shareWeiboApp",{title:e.title||o,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareQZone:function(e){C(n.onMenuShareQZone,{complete:function(){b("shareQZone",{title:e.title||o,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},updateTimelineShareData:function(e){b("updateTimelineShareData",{title:e.title,link:e.link,imgUrl:e.imgUrl},e)},updateAppMessageShareData:function(e){b("updateAppMessageShareData",{title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl},e)},startRecord:function(e){b("startRecord",{},e)},stopRecord:function(e){b("stopRecord",{},e)},onVoiceRecordEnd:function(e){C("onVoiceRecordEnd",e)},playVoice:function(e){b("playVoice",{localId:e.localId},e)},pauseVoice:function(e){b("pauseVoice",{localId:e.localId},e)},stopVoice:function(e){b("stopVoice",{localId:e.localId},e)},onVoicePlayEnd:function(e){C("onVoicePlayEnd",e)},uploadVoice:function(e){b("uploadVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadVoice:function(e){b("downloadVoice",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},translateVoice:function(e){b("translateVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},chooseImage:function(e){b("chooseImage",{scene:"1|2",count:e.count||9,sizeType:e.sizeType||["original","compressed"],sourceType:e.sourceType||["album","camera"]},(e._complete=function(e){if(h){var t=e.localIds;try{t&&(e.localIds=JSON.parse(t))}catch(e){}}},e))},getLocation:function(e){b(n.getLocation,{type:(e=e||{}).type||"wgs84"},(e._complete=function(e){delete e.type},e))},previewImage:function(e){b(n.previewImage,{current:e.current,urls:e.urls},e)},uploadImage:function(e){b("uploadImage",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadImage:function(e){b("downloadImage",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},getLocalImgData:function(e){!1===_?(_=!0,b("getLocalImgData",{localId:e.localId},(e._complete=function(e){var t;_=!1,0<x.length&&(t=x.shift(),wx.getLocalImgData(t))},e))):x.push(e)},getNetworkType:function(e){b("getNetworkType",{},(e._complete=function(e){e=function(e){var t=e.errMsg;e.errMsg="getNetworkType:ok";var n=e.subtype;if(delete e.subtype,n)e.networkType=n;else{n=t.indexOf(":");var r=t.substring(n+1);switch(r){case"wifi":case"edge":case"wwan":e.networkType=r;break;default:e.errMsg="getNetworkType:fail"}}return e}(e)},e))},openLocation:function(e){b("openLocation",{latitude:e.latitude,longitude:e.longitude,name:e.name||"",address:e.address||"",scale:e.scale||28,infoUrl:e.infoUrl||""},e)},hideOptionMenu:function(e){b("hideOptionMenu",{},e)},showOptionMenu:function(e){b("showOptionMenu",{},e)},closeWindow:function(e){b("closeWindow",{},e=e||{})},hideMenuItems:function(e){b("hideMenuItems",{menuList:e.menuList},e)},showMenuItems:function(e){b("showMenuItems",{menuList:e.menuList},e)},hideAllNonBaseMenuItem:function(e){b("hideAllNonBaseMenuItem",{},e)},showAllNonBaseMenuItem:function(e){b("showAllNonBaseMenuItem",{},e)},scanQRCode:function(e){b("scanQRCode",{needResult:(e=e||{}).needResult||0,scanType:e.scanType||["qrCode","barCode"]},(e._complete=function(e){var t;f&&(t=e.resultStr)&&(t=JSON.parse(t),e.resultStr=t&&t.scan_code&&t.scan_code.scan_result)},e))},openAddress:function(e){b(n.openAddress,{},(e._complete=function(e){var t=e;t.postalCode=t.addressPostalCode,delete t.addressPostalCode,t.provinceName=t.proviceFirstStageName,delete t.proviceFirstStageName,t.cityName=t.addressCitySecondStageName,delete t.addressCitySecondStageName,t.countryName=t.addressCountiesThirdStageName,delete t.addressCountiesThirdStageName,t.detailInfo=t.addressDetailInfo,delete t.addressDetailInfo,e=t},e))},openProductSpecificView:function(e){b(n.openProductSpecificView,{pid:e.productId,view_type:e.viewType||0,ext_info:e.extInfo},e)},addCard:function(e){for(var t=e.cardList,r=[],i=0,o=t.length;i<o;++i){var a={card_id:(a=t[i]).cardId,card_ext:a.cardExt};r.push(a)}b(n.addCard,{card_list:r},(e._complete=function(e){var t=e.card_list;if(t){for(var n=0,r=(t=JSON.parse(t)).length;n<r;++n){var i=t[n];i.cardId=i.card_id,i.cardExt=i.card_ext,i.isSuccess=!!i.is_succ,delete i.card_id,delete i.card_ext,delete i.is_succ}e.cardList=t,delete e.card_list}},e))},chooseCard:function(e){b("chooseCard",{app_id:m.appId,location_id:e.shopId||"",sign_type:e.signType||"SHA1",card_id:e.cardId||"",card_type:e.cardType||"",card_sign:e.cardSign,time_stamp:e.timestamp+"",nonce_str:e.nonceStr},(e._complete=function(e){e.cardList=e.choose_card_info,delete e.choose_card_info},e))},openCard:function(e){for(var t=e.cardList,r=[],i=0,o=t.length;i<o;++i){var a={card_id:(a=t[i]).cardId,code:a.code};r.push(a)}b(n.openCard,{card_list:r},e)},consumeAndShareCard:function(e){b(n.consumeAndShareCard,{consumedCardId:e.cardId,consumedCode:e.code},e)},chooseWXPay:function(e){b(n.chooseWXPay,E(e),e)},openEnterpriseRedPacket:function(e){b(n.openEnterpriseRedPacket,E(e),e)},startSearchBeacons:function(e){b(n.startSearchBeacons,{ticket:e.ticket},e)},stopSearchBeacons:function(e){b(n.stopSearchBeacons,{},e)},onSearchBeacons:function(e){C(n.onSearchBeacons,e)},openEnterpriseChat:function(e){b("openEnterpriseChat",{useridlist:e.userIds,chatname:e.groupName},e)},launchMiniProgram:function(e){b("launchMiniProgram",{targetAppId:e.targetAppId,path:function(e){if("string"==typeof e&&0<e.length){var t=e.split("?")[0];return t+=".html",void 0!==(e=e.split("?")[1])?t+"?"+e:t}}(e.path),envVersion:e.envVersion},e)},openBusinessView:function(e){b("openBusinessView",{businessType:e.businessType,queryString:e.queryString||"",envVersion:e.envVersion},(e._complete=function(e){if(h){var t=e.extraData;if(t)try{e.extraData=JSON.parse(t)}catch(t){e.extraData={}}}},e))},miniProgram:{navigateBack:function(e){e=e||{},R((function(){b("invokeMiniProgramAPI",{name:"navigateBack",arg:{delta:e.delta||1}},e)}))},navigateTo:function(e){R((function(){b("invokeMiniProgramAPI",{name:"navigateTo",arg:{url:e.url}},e)}))},redirectTo:function(e){R((function(){b("invokeMiniProgramAPI",{name:"redirectTo",arg:{url:e.url}},e)}))},switchTab:function(e){R((function(){b("invokeMiniProgramAPI",{name:"switchTab",arg:{url:e.url}},e)}))},reLaunch:function(e){R((function(){b("invokeMiniProgramAPI",{name:"reLaunch",arg:{url:e.url}},e)}))},postMessage:function(e){R((function(){b("invokeMiniProgramAPI",{name:"postMessage",arg:e.data||{}},e)}))},getEnv:function(t){R((function(){t({miniprogram:"miniprogram"===e.__wxjs_environment})}))}}},I=1,w={};return i.addEventListener("error",(function(e){var t,n,r;h||(n=(t=e.target).tagName,r=t.src,"IMG"!=n&&"VIDEO"!=n&&"AUDIO"!=n&&"SOURCE"!=n||-1!=r.indexOf("wxlocalresource://")&&(e.preventDefault(),e.stopPropagation(),(e=t["wx-id"])||(e=I++,t["wx-id"]=e),w[e]||(w[e]=!0,wx.ready((function(){wx.getLocalImgData({localId:r,success:function(e){t.src=e.localData}})})))))}),!0),i.addEventListener("load",(function(e){var t;h||(e=(t=e.target).tagName,t.src,"IMG"!=e&&"VIDEO"!=e&&"AUDIO"!=e&&"SOURCE"!=e||(t=t["wx-id"])&&(w[t]=!1))}),!0),A}function b(t,n,r){e.WeixinJSBridge?WeixinJSBridge.invoke(t,M(n),(function(e){T(t,e,r)})):L(t,r)}function C(t,n,r){e.WeixinJSBridge?WeixinJSBridge.on(t,(function(e){r&&r.trigger&&r.trigger(e),T(t,e,n)})):L(t,r||n)}function M(e){return(e=e||{}).appId=m.appId,e.verifyAppId=m.appId,e.verifySignType="sha1",e.verifyTimestamp=m.timestamp+"",e.verifyNonceStr=m.nonceStr,e.verifySignature=m.signature,e}function E(e){return{timeStamp:e.timestamp+"",nonceStr:e.nonceStr,package:e.package,paySign:e.paySign,signType:e.signType||"SHA1"}}function T(e,t,n){"openEnterpriseChat"!=e&&"openBusinessView"!==e||(t.errCode=t.err_code),delete t.err_code,delete t.err_desc,delete t.err_detail;var i,o,a,s,u=t.errMsg;switch(u||(u=t.err_msg,delete t.err_msg,o=u,(s=r[a=i=e])&&(a=s),i="ok",o&&(s=o.indexOf(":"),"confirm"==(i=o.substring(s+1))&&(i="ok"),"failed"==i&&(i="fail"),-1!=i.indexOf("failed_")&&(i=i.substring(7)),-1!=i.indexOf("fail_")&&(i=i.substring(5)),"access denied"!=(i=(i=i.replace(/_/g," ")).toLowerCase())&&"no permission to execute"!=i||(i="permission denied"),"config"==a&&"function not exist"==i&&(i="ok"),""==i&&(i="fail")),u=a+":"+i,t.errMsg=u),(n=n||{})._complete&&(n._complete(t),delete n._complete),u=t.errMsg||"",m.debug&&!n.isInnerInvoke&&alert(JSON.stringify(t)),e=u.indexOf(":"),u.substring(e+1)){case"ok":n.success&&n.success(t);break;case"cancel":n.cancel&&n.cancel(t);break;default:n.fail&&n.fail(t)}n.complete&&n.complete(t)}function S(e){if(e){for(var t=0,r=e.length;t<r;++t){var i=e[t];(i=n[i])&&(e[t]=i)}return e}}function L(e,t){var n;!m.debug||t&&t.isInnerInvoke||((n=r[e])&&(e=n),t&&t._complete&&delete t._complete)}function k(){return(new Date).getTime()}function R(t){c&&(e.WeixinJSBridge?t():i.addEventListener&&i.addEventListener("WeixinJSBridgeReady",t,!1))}}(n)},function(e,t,n){"use strict";var r=n(1);n(116);var i=r(n(25));function o(e,t,n,r,i,o){var a,s,u=(e+n)/2,l=(t+r)/2,c=((e-n)*(e-n)+(t-r)*(t-r))/4,h=(p=Math.sqrt(c))*(s=p/Math.sqrt(i*i-c)),f=Math.PI/2,d=(i=(n-e)/(t-r),c=-1,(e-n)/(t-r)),p={x:u+h*(a=(a=1)/(p=Math.sqrt(a*a+i*i))),y:l+h*(p=i/p),theta:f};return f={x:u+h*(c/=s=Math.sqrt(c*c+d*d)),y:l+h*(s=d/s),theta:f},0<(n-e)*(p.y-t)-(r-t)*(p.x-e)?0===o?p:f:0===o?f:p}function a(e,t,n,r){for(var a=0;a<e.length;a++)switch(e[a]){case"m":t.moveTo(r.x+(0,i.default)(e[a+1]),r.y+(0,i.default)(e[a+2])),n.x=r.x+(0,i.default)(e[a+1]),n.y=r.y+(0,i.default)(e[a+2]),r.x=n.x,r.y=n.y,a+=2;break;case"M":t.moveTo((0,i.default)(e[a+1]),(0,i.default)(e[a+2])),n.x=(0,i.default)(e[a+1]),n.y=(0,i.default)(e[a+2]),r.x=n.x,r.y=n.y,a+=2;break;case"l":t.lineTo(n.x+(0,i.default)(e[a+1]),n.y+(0,i.default)(e[a+2])),n.x=n.x+(0,i.default)(e[a+1]),n.y=n.y+(0,i.default)(e[a+2]),a+=2;break;case"L":t.lineTo((0,i.default)(e[a+1]),(0,i.default)(e[a+2])),n.x=(0,i.default)(e[a+1]),n.y=(0,i.default)(e[a+2]),a+=2;break;case"A":var s=(0,i.default)(e[a+1]),u=(0,i.default)(e[a+2]),l=((0,i.default)(e[a+3]),Math.PI,(0,i.default)(e[a+4]),(0,i.default)(e[a+5])),c=n.x,h=n.y,f=(0,i.default)(e[a+6]),d=(0,i.default)(e[a+7]);s===u&&(p=o(c,h,f,d,s,l),t.arcTo(p.x,p.y,f,d,p.theta),n.x=f,n.y=d),a+=7;break;case"a":var p;s=(0,i.default)(e[a+1]),u=(0,i.default)(e[a+2]),(0,i.default)(e[a+3]),Math.PI,(0,i.default)(e[a+4]),l=(0,i.default)(e[a+5]),c=n.x,h=n.y,f=c+(0,i.default)(e[a+6]),d=h+(0,i.default)(e[a+7]),s===u&&(p=o(c,h,f,d,s,l),t.arcTo(p.x,p.y,f,d,p.theta),n.x=f,n.y=d),a+=7;break;case"h":t.lineTo(n.x+(0,i.default)(e[a+1]),n.y),n.x=n.x+(0,i.default)(e[a+1]),a+=1;break;case"H":t.lineTo((0,i.default)(e[a+1]),n.y),n.x=(0,i.default)(e[a+1]),a+=1;break;case"z":case"Z":t.lineTo(r.x,r.y)}}n=r(n(87));var s=["M","0","15.07","L","0.69","1.92","A","2","2","0","0","1","2.66","0","L","11.8","0","l","-0.07","1.37","H","3.09","A","1.09","1.09","0","0","0","2","2.44","l","-0.2","4.44","h","9.37","l","-0.07","1.37","H","1.72","l","-0.36","6.82","Z"],u=["M","13.79","11","l","-0.08","1.63","a","1","1","0","0","0","1","1.08","h","8.53","l","-0.07","1.36","h","-9","A","1.84","1.84","0","0","1","12.31","13","l","0.48","-9.16","h","8.9","a","2","2","0","0","1","2","2","L","23.53","9","A","2.11","2.11","0","0","1","21.47","11","Z","m","8.4","-2.49","l","0.08","-2.16","a","1.07","1.07","0","0","0","-1.09","-1.09","H","14.09","l","-0.22","4.33","H","21","A","1.15","1.15","0","0","0","22.19","8.51","Z"],l=["M","33.94","3.86","a","1.93","1.93","0","0","1","2","1.95","l","-0.47","9.27","H","34.07","l","0.45","-8.72","a","1.09","1.09","0","0","0","-1.09","-1.1","H","26.3","l","-0.51","9.82","H","24.41","L","25","3.85","Z"],c=["M","36.48","17.72","H","45","a","1.16","1.16","0","0","0","1.16","-1.22","l","0.07","-1.43","H","38.72","a","2","2","0","0","1","-2","-2.06","l","0.37","-7.19","a","2","2","0","0","1","2.15","-2","H","48.2","l","-0.69","13.28","a","2.09","2.09","0","0","1","-2.06","2","h","-9","Z","m","9.85","-4.05","l","0.44","-8.45","H","39.53","a","1.07","1.07","0","0","0","-1.08","1.1","l","-0.32","6.27","a","1.16","1.16","0","0","0","1.1","1.1","Z"],h=["M","57.43","11.59","L","63.48","0","h","1.83","l","-0.79","15.05","H","63.15","l","0.67","-12.79","L","57.67","14","h","-0.75","L","52.07","2.34","l","-0.64","12.72","H","50","L","50.83","0","H","52.6","Z"],f=["M","69.6","10.2","l","-2.37","4.87","h","-1.5","L","73.09","0","h","1.49","l","5.77","15.05","h","-1.5","L","77","10.2","Z","m","6.86","-1.39","L","73.74","1.73","L","70.28","8.81","Z"],d=["M","82.95","15.07","H","81.57","L","82.35","0","h","10","a","1.94","1.94","0","0","1","1.85","2","L","93.89","7.4","a","2","2","0","0","1","-2","1.92","H","83.25","Z","m","8.43","-7.15","a","1.13","1.13","0","0","0","1.09","-1.09","l","0.35","-4.37","a","1.1","1.1","0","0","0","-1.08","-1.06","H","83.66","l","-0.34","6.53","Z"];n.default.f=s,n.default.e=u,n.default.n=l,n.default.g=c,n.default.m=h,n.default.a=f,n.default.p=d,n.default.d=function(){var e=document.createElement("canvas"),t=e.getContext("2d");e.width=500,e.height=120,e.style.width="500px",e.style.height="120px";var n={x:0,y:0},r={x:0,y:0};t.transform(5,0,0,5,10,10);var i=t.createLinearGradient(5.9,15.07,5.9,0);return i.addColorStop(0,"#232323"),i.addColorStop(1,"#585858"),t.fillStyle=i,t.beginPath(),a(s,t,r,n),t.closePath(),t.fill(),t.beginPath(),a(u,t,r,n),t.closePath(),t.fill(),t.beginPath(),a(l,t,r,n),t.closePath(),t.fill(),t.beginPath(),a(c,t,r,n),t.closePath(),t.fill(),(i=t.createLinearGradient(57.68,15.07,57.68,0)).addColorStop(0,"#77bf00"),i.addColorStop(1,"#addc0c"),t.fillStyle=i,t.beginPath(),a(h,t,r,n),t.closePath(),t.fill(),t.beginPath(),a(f,t,r,n),t.closePath(),t.fill(),t.beginPath(),a(d,t,r,n),t.closePath(),t.fill(),new fm.CanvasTexture(e)}}],r={},e.m=n,e.c=r,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==s(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(e){return t[e]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=266).default;function e(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return n[t].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n,r};"object"==s(n)&&"object"==s(e)?e.exports=u():(o=[],void 0===(a="function"==typeof(i=u)?i.apply(n,o):i)||(e.exports=a))},473:function(e,n,r){var i,o,a,s;function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}e=r.nmd(e),s=function(){return n=[function(e,t,n){e.exports=n(155)},function(e,t){e=e.exports={version:"2.6.12"},"number"==typeof __e&&(__e=e)},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(8),i=n(1),o=n(62),a=n(28),s=n(24),u="prototype",l=function e(t,n,l){var c,h,f,d=t&e.F,p=t&e.G,g=t&e.S,m=t&e.P,v=t&e.B,y=t&e.W,_=p?i:i[n]||(i[n]={}),x=_[u],A=p?r:g?r[n]:(r[n]||{})[u];for(c in p&&(l=n),l)(h=!d&&A&&void 0!==A[c])&&s(_,c)||(f=(h?A:l)[c],_[c]=p&&"function"!=typeof A[c]?l[c]:v&&h?o(f,r):y&&A[c]==f?function(e){var t=function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)}));return t[u]=e[u],t}(f):m&&"function"==typeof f?o(Function.call,f):f,m&&((_.virtual||(_.virtual={}))[c]=f,t&e.R&&x&&!x[c]&&a(x,c,f)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var r=n(74)("wks"),i=n(41),o=n(5).Symbol,a="function"==typeof o;(e=e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t){e=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=e)},function(e,t,n){e.exports=!n(7)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),"number"==typeof __g&&(__g=e)},function(e,t,n){var r=n(15),i=n(54);e.exports=n(6)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(26),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(0);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r(e,i.key,i)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(68)("wks"),i=n(49),o=n(8).Symbol,a="function"==typeof o;(e=e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t,n){e.exports=!n(19)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(16),i=n(105),o=n(53),a=Object.defineProperty;t.f=n(6)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(21);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(23),i=n(98),o=n(64),a=Object.defineProperty;t.f=n(14)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){return"object"==u(e)?null!==e:"function"==typeof e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(5),i=n(52),o=n(9),a=n(22),s=n(56),u="prototype",l=function e(t,n,l){var c,h,f,d=t&e.F,p=t&e.G,g=t&e.P,m=t&e.B,v=p?r:t&e.S?r[n]||(r[n]={}):(r[n]||{})[u],y=p?i:i[n]||(i[n]={}),_=y[u]||(y[u]={});for(c in p&&(l=n),l)h=((f=!d&&v&&void 0!==v[c])?v:l)[c],f=m&&f?s(h,r):g&&"function"==typeof h?s(Function.call,h):h,v&&a(v,c,h,t&e.U),y[c]!=h&&o(y,c,f),g&&_[c]!=h&&(_[c]=h)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t){e.exports=function(e){return"object"==u(e)?null!==e:"function"==typeof e}},function(e,t,n){var r=n(5),i=n(9),o=n(25),a=n(41)("src"),s=n(177),u="toString",l=(""+s).split(u);n(52).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(u&&(o(n,a)||i(n,a,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,u,(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,n){var r=n(18);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t,n){"use strict";var r=n(61),i=Object.keys||function(e){var t,n=[];for(t in e)n.push(t);return n};e.exports=c,(e=Object.create(n(45))).inherits=n(37);var o=n(147),a=n(96);e.inherits(c,o);for(var s=i(a.prototype),u=0;u<s.length;u++){var l=s[u];c.prototype[l]||(c.prototype[l]=a.prototype[l])}function c(e){if(!(this instanceof c))return new c(e);o.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),c.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},function(e,t,n){var r=n(17),i=n(39);e.exports=n(14)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(102),i=n(47);e.exports=function(e){return r(i(e))}},function(e,t,n){e.exports=n(167)},function(e,t,n){var r=n(47);e.exports=function(e){return Object(r(e))}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(34);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n,r;function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}e=e.exports={},function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var s,u=[],l=!1,c=-1;function h(){l&&s&&(l=!1,s.length?u=s.concat(u):c=-1,u.length&&f())}function f(){if(!l){var e=a(h);l=!0;for(var t=u.length;t;){for(s=u,u=[];++c<t;)s&&s[c].run();c=-1,t=u.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||l||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=p,e.addListener=p,e.once=p,e.off=p,e.removeListener=p,e.removeAllListeners=p,e.emit=p,e.prependListener=p,e.prependOnceListener=p,e.listeners=function(e){return[]},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},function(e,t){e.exports={}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){var n;t&&(e.super_=t,(n=function(){}).prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e)}},function(e,t){var n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==("undefined"==typeof window?"undefined":u(window))&&(n=window)}e.exports=n},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(101),i=n(69);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(26),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){"use strict";n(115)("sub",(function(e){return function(){return e(this,"sub","","")}}))},function(e,t){e.exports={}},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==u(e)},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==u(e)&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==u(e)||void 0===e},t.isBuffer=e.isBuffer}).call(this,n(95).Buffer)},function(e,t,n){var r=n(23),i=n(100),o=n(69),a=n(67)("IE_PROTO"),s=function(){},u="prototype",l=function(){var e=n(99)("iframe"),t=o.length;for(e.style.display="none",n(164).appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;t--;)delete l[u][o[t]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[u]=r(e),n=new s,s[u]=null,n[a]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){e.exports=!0},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){e.exports=n(176)},function(e,t){e=e.exports={version:"2.6.12"},"number"==typeof __e&&(__e=e)},function(e,t,n){var r=n(21);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=!1},function(e,t,n){var r=n(107);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(109),i=n(34);e.exports=function(e){return r(i(e))}},function(e,t,n){e.exports=n(217)},function(e,t,n){var r=n(32),i=n(4)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?e:o?r(t):"Object"==(e=r(t))&&"function"==typeof t.callee?"Arguments":e}},function(e,t,n){"use strict";var r=n(59),i={};i[n(4)("toStringTag")]="z",i+""!="[object z]"&&n(22)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){"use strict";(function(t){void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,r)}));case 4:return t.nextTick((function(){e.call(null,n,r,i)}));default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return t.nextTick((function(){e.apply(null,o)}))}}}:e.exports=t}).call(this,n(35))},function(e,t,n){var r=n(63);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(18);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t,n){var r=n(68)("keys"),i=n(49);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(1),i=n(8),o="__core-js_shared__",a=i[o]||(i[o]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(48)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){e.exports=n(173)},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){"use strict";var r=n(20),i=n(108)(1);r(r.P+r.F*!n(181)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){var r=n(52),i=n(5),o="__core-js_shared__",a=i[o]||(i[o]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(55)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(184),i=n(54),o=n(57),a=n(53),s=n(25),u=n(105),l=Object.getOwnPropertyDescriptor;t.f=n(6)?l:function(e,t){if(e=o(e),t=a(t,!0),u)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(111),i=n(78).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(74)("keys"),i=n(41);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(16),i=n(187),o=n(78),a=n(77)("IE_PROTO"),s=function(){},u="prototype",l=function(){var e=n(106)("iframe"),t=o.length;for(e.style.display="none",n(114).appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;t--;)delete l[u][o[t]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[u]=r(e),n=new s,s[u]=null,n[a]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(17).f,i=n(24),o=n(13)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){t.f=n(13)},function(e,t,n){var r=n(8),i=n(1),o=n(48),a=n(81),s=n(17).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=!o&&r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){"use strict";var r=n(226),i=n(16),o=n(130),a=n(131),s=n(10),u=n(132),l=n(84),c=n(7),h=Math.min,f=[].push,d="split",p="length",g="lastIndex",m=4294967295,v=!c((function(){RegExp(m,"y")}));n(133)("split",2,(function(e,t,n,c){var y="c"=="abbc"[d](/(b)*/)[1]||4!="test"[d](/(?:)/,-1)[p]||2!="ab"[d](/(?:ab)*/)[p]||4!="."[d](/(.?)(.?)/)[p]||1<"."[d](/()()/)[p]||""[d](/.?/)[p]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(i,e,t);for(var o,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,d=void 0===t?m:t>>>0,v=new RegExp(e.source,c+"g");(o=l.call(v,i))&&!(h<(a=v[g])&&(u.push(i.slice(h,o.index)),1<o[p]&&o.index<i[p]&&f.apply(u,o.slice(1)),s=o[0][p],h=a,u[p]>=d));)v[g]===o.index&&v[g]++;return h===i[p]?!s&&v.test("")||u.push(""):u.push(i.slice(h)),u[p]>d?u.slice(0,d):u}:"0"[d](void 0,0)[p]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n;return[function(n,r){var i=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):y.call(String(i),n,r)},function(e,t){if((f=c(y,e,this,t,y!==n)).done)return f.value;var r=i(e),l=String(this),f=o(r,RegExp),d=r.unicode,p=(e=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(v?"y":"g"),new f(v?r:"^(?:"+r.source+")",e)),g=void 0===t?m:t>>>0;if(0===g)return[];if(0===l.length)return null===u(p,l)?[l]:[];for(var _=0,x=0,A=[];x<l.length;){p.lastIndex=v?x:0;var I,w=u(p,v?l:l.slice(x));if(null===w||(I=h(s(p.lastIndex+(v?0:x)),l.length))===_)x=a(l,x,d);else{if(A.push(l.slice(_,x)),A.length===g)return A;for(var b=1;b<=w.length-1;b++)if(A.push(w[b]),A.length===g)return A;x=_=I}}return A.push(l.slice(_)),A}]}))},function(e,t,n){"use strict";var r,i=n(85),o=RegExp.prototype.exec,a=String.prototype.replace,s=o,u="lastIndex",l=(r=/a/,n=/b*/g,o.call(r,"a"),o.call(n,"a"),0!==r[u]||0!==n[u]),c=void 0!==/()??/.exec("")[1];(n=l||c)&&(s=function(e){var t,n,r,s,h=this;return c&&(n=new RegExp("^"+h.source+"$(?!\\s)",i.call(h))),l&&(t=h[u]),r=o.call(h,e),l&&r&&(h[u]=h.global?r.index+r[0].length:t),c&&r&&1<r.length&&a.call(r[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(r[s]=void 0)})),r}),e.exports=s},function(e,t,n){"use strict";var r=n(16);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(20),i=n(114),o=n(32),a=n(42),s=n(10),u=[].slice;r(r.P+r.F*n(7)((function(){i&&u.call(i)})),"Array",{slice:function(e,t){var n=s(this.length),r=o(this);if(t=void 0===t?n:t,"Array"==r)return u.call(this,e,t);for(var i=a(e,n),l=(n=a(t,n),s(n-i)),c=new Array(l),h=0;h<l;h++)c[h]="String"==r?this.charAt(i+h):this[i+h];return c}})},function(e,t,n){"use strict";n(231);var r=n(16),i=n(85),o=n(6),a="toString",s=/./[a],u=function(e){n(22)(RegExp.prototype,a,e,!0)};n(7)((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?u((function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)})):s.name!=a&&u((function(){return s.call(this)}))},function(e,t,n){"use strict";(function(e){var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.ProtoBuf=void 0;var o=i(n(120));n(60),n(87),n(43),n(248),n(86),n(259),n(139),n(136),n(83),n(73),n(91),n(260);var a=i(n(0)),s=i(n(58)),u=i(n(71)),l=i(n(138)),c=i(n(117)),h=i(n(261)),f=i(n(51));function d(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function p(e){return!0===(e&&e.__isLong__)}d.__isLong__,(0,a.default)(d.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),d.isLong=p;var g={},m={};function v(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=m[e])?r:(n=_(e,(0|e)<0?-1:0,!0),i&&(m[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=g[e])?r:(n=_(e,e<0?-1:0,!1),i&&(g[e]=n),n)}function y(e,t){if(isNaN(e)||!isFinite(e))return t?T:E;if(t){if(e<0)return T;if(b<=e)return R}else{if(e<=-C)return N;if(C<=e+1)return k}return e<0?y(-e,t).neg():_(e%w|0,e/w|0,t)}function _(e,t,n){return new d(e,t,n)}d.fromInt=v,d.fromNumber=y,d.fromBits=_;var x=Math.pow;function A(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return E;if("number"==typeof t&&(n=t,t=!1),(n=n||10)<2||36<n)throw RangeError("radix");var r;if(0<(r=e.indexOf("-")))throw Error("interior hyphen");if(0===r)return A(e.substring(1),t,n).neg();for(var i=y(x(n,8)),o=E,a=0;a<e.length;a+=8){var u=Math.min(8,e.length-a),l=(0,s.default)(e.substring(a,a+u),n);o=u<8?(u=y(x(n,u)),o.mul(u).add(y(l))):(o=o.mul(i)).add(y(l))}return o.unsigned=t,o}function I(e){return e instanceof d?e:"number"==typeof e?y(e):"string"==typeof e?A(e):_(e.low,e.high,e.unsigned)}d.fromString=A,d.fromValue=I;var w=(r=65536)*r,b=w*w,C=b/2,M=v(i=1<<24),E=v(0);d.ZERO=E;var T=v(0,!0);d.UZERO=T;var S=v(1);d.ONE=S,i=v(1,!0),d.UONE=i;var L=v(-1);d.NEG_ONE=L;var k=_(-1,2147483647,!1);d.MAX_VALUE=k;var R=_(-1,-1,!0);d.MAX_UNSIGNED_VALUE=R;var N=_(0,-2147483648,!1);d.MIN_VALUE=N,(i=d.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},i.toNumber=function(){return this.unsigned?(this.high>>>0)*w+(this.low>>>0):this.high*w+(this.low>>>0)},i.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(N)){var t=y(e),n=this.div(t);return t=n.mul(t).sub(this),n.toString(e)+t.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var r=y(x(e,6),this.unsigned),i=this,o="";;){var a=i.div(r),s=(i.sub(a.mul(r)).toInt()>>>0).toString(e);if((i=a).isZero())return s+o;for(;s.length<6;)s="0"+s;o=""+s+o}},i.getHighBits=function(){return this.high},i.getHighBitsUnsigned=function(){return this.high>>>0},i.getLowBits=function(){return this.low},i.getLowBitsUnsigned=function(){return this.low>>>0},i.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;0<t&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},i.isZero=function(){return 0===this.high&&0===this.low},i.isNegative=function(){return!this.unsigned&&this.high<0},i.isPositive=function(){return this.unsigned||0<=this.high},i.isOdd=function(){return 1==(1&this.low)},i.isEven=function(){return 0==(1&this.low)},i.equals=function(e){return p(e)||(e=I(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},i.eq=i.equals,i.notEquals=function(e){return!this.eq(e)},i.neq=i.notEquals,i.lessThan=function(e){return this.comp(e)<0},i.lt=i.lessThan,i.lessThanOrEqual=function(e){return this.comp(e)<=0},i.lte=i.lessThanOrEqual,i.greaterThan=function(e){return 0<this.comp(e)},i.gt=i.greaterThan,i.greaterThanOrEqual=function(e){return 0<=this.comp(e)},i.gte=i.greaterThanOrEqual,i.compare=function(e){if(p(e)||(e=I(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},i.comp=i.compare,i.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(S)},i.neg=i.negate,i.add=function(e){p(e)||(e=I(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=65535&e.low,l=0,c=0,h=0;return e=0,h+=(e+=i+u)>>>16,c+=(h+=r+s)>>>16,l+=(c+=n+a)>>>16,l+=t+o,_((h&=65535)<<16|(e&=65535),(l&=65535)<<16|(c&=65535),this.unsigned)},i.subtract=function(e){return p(e)||(e=I(e)),this.add(e.neg())},i.sub=i.subtract,i.multiply=function(e){if(this.isZero())return E;if(p(e)||(e=I(e)),e.isZero())return E;if(this.eq(N))return e.isOdd()?N:E;if(e.eq(N))return this.isOdd()?N:E;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(M)&&e.lt(M))return y(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=65535&e.low,l=0,c=0,h=0;return e=0,h+=(e+=i*u)>>>16,c+=(h+=r*u)>>>16,h&=65535,c+=(h+=i*s)>>>16,l+=(c+=n*u)>>>16,c&=65535,l+=(c+=r*s)>>>16,c&=65535,l+=(c+=i*a)>>>16,l+=t*u+n*s+r*a+i*o,_((h&=65535)<<16|(e&=65535),(l&=65535)<<16|(c&=65535),this.unsigned)},i.mul=i.multiply,i.divide=function(e){if(p(e)||(e=I(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?T:E;var t,n;if(this.eq(N))return e.eq(S)||e.eq(L)?N:e.eq(N)?S:(r=this.shr(1).div(e).shl(1)).eq(E)?e.isNegative()?S:L:(t=this.sub(e.mul(r)),n=r.add(t.div(e)));if(e.eq(N))return this.unsigned?T:E;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();for(n=E,t=this;t.gte(e);){for(var r=Math.max(1,Math.floor(t.toNumber()/e.toNumber())),i=Math.ceil(Math.log(r)/Math.LN2),o=i<=48?1:x(2,i-48),a=y(r),s=a.mul(e);s.isNegative()||s.gt(t);)s=(a=y(r-=o,this.unsigned)).mul(e);a.isZero()&&(a=S),n=n.add(a),t=t.sub(s)}return n},i.div=i.divide,i.modulo=function(e){return p(e)||(e=I(e)),this.sub(this.div(e).mul(e))},i.mod=i.modulo,i.not=function(){return _(~this.low,~this.high,this.unsigned)},i.and=function(e){return p(e)||(e=I(e)),_(this.low&e.low,this.high&e.high,this.unsigned)},i.or=function(e){return p(e)||(e=I(e)),_(this.low|e.low,this.high|e.high,this.unsigned)},i.xor=function(e){return p(e)||(e=I(e)),_(this.low^e.low,this.high^e.high,this.unsigned)},i.shiftLeft=function(e){return p(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?_(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):_(0,this.low<<e-32,this.unsigned)},i.shl=i.shiftLeft,i.shiftRight=function(e){return p(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?_(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):_(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},i.shr=i.shiftRight,i.shiftRightUnsigned=function(e){if(p(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?_(this.low>>>e|t<<32-e,t>>>e,this.unsigned):_(32===e?t:t>>>e-32,0,this.unsigned)},i.shru=i.shiftRightUnsigned,i.toSigned=function(){return this.unsigned?_(this.low,this.high,!1):this},i.toUnsigned=function(){return this.unsigned?this:_(this.low,this.high,!0)};var P=function e(t,n,r){if(void 0===t&&(t=e.DEFAULT_CAPACITY),void 0===n&&(n=e.DEFAULT_ENDIAN),void 0===r&&(r=e.DEFAULT_NOASSERT),!r){if((t|=0)<0)throw RangeError("Illegal capacity");n=!!n,r=!!r}this.buffer=0===t?D:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=t,this.littleEndian=n,this.noAssert=r};P.VERSION="5.0.1",P.LITTLE_ENDIAN=!0,P.BIG_ENDIAN=!1,P.DEFAULT_CAPACITY=16,P.DEFAULT_ENDIAN=P.BIG_ENDIAN,P.DEFAULT_NOASSERT=!1,P.Long=d||null;var O=P.prototype;O.__isByteBuffer__,(0,a.default)(O,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var D=new ArrayBuffer(0),F=String.fromCharCode;function B(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function G(){var e=[],t=[];return function(){if(0===arguments.length)return t.join("")+F.apply(String,e);1024<e.length+arguments.length&&(t.push(F.apply(String,e)),e.length=0),Array.prototype.push.apply(e,arguments)}}function z(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,h=n?i-1:0,f=n?-1:1;for(n=e[t+h],h+=f,o=n&(1<<-c)-1,n>>=-c,c+=s;0<c;o=256*o+e[t+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;0<c;a=256*a+e[t+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(n?-1:1);a+=Math.pow(2,r),o-=l}return(n?-1:1)*a*Math.pow(2,o-r)}function U(e,t,n,r,i,o){var a,s,u=8*o-i-1,l=(1<<u)-1,c=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1;for(o=t<0||0===t&&1/t<0?1:0,t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-a))<1&&(a--,r*=2),2<=(t+=1<=a+c?h/r:h*Math.pow(2,1-c))*r&&(a++,r/=2),l<=a+c?(s=0,a=l):1<=a+c?(s=(t*r-1)*Math.pow(2,i),a+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));8<=i;e[n+f]=255&s,f+=d,s/=256,i-=8);for(a=a<<i|s,u+=i;0<u;e[n+f]=255&a,f+=d,a/=256,u-=8);e[n+f-d]|=128*o}P.accessor=function(){return Uint8Array},P.allocate=function(e,t,n){return new P(e,t,n)},P.concat=function(e,t,n,r){"boolean"!=typeof t&&"string"==typeof t||(r=n,n=t,t=void 0);for(var i,o=0,a=0,s=e.length;a<s;++a)P.isByteBuffer(e[a])||(e[a]=P.wrap(e[a],t)),0<(i=e[a].limit-e[a].offset)&&(o+=i);if(0===o)return new P(0,n,r);var u,l=new P(o,n,r);for(a=0;a<s;)(i=(u=e[a++]).limit-u.offset)<=0||(l.view.set(u.view.subarray(u.offset,u.limit),l.offset),l.offset+=i);return l.limit=l.offset,l.offset=0,l},P.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},P.type=function(){return ArrayBuffer},P.wrap=function(e,t,n,r){if("string"!=typeof t&&(r=n,n=t,t=void 0),"string"==typeof e)switch(void 0===t&&(t="utf8"),t){case"base64":return P.fromBase64(e,n);case"hex":return P.fromHex(e,n);case"binary":return P.fromBinary(e,n);case"utf8":return P.fromUTF8(e,n);case"debug":return P.fromDebug(e,n);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!==(0,o.default)(e))throw TypeError("Illegal buffer");var i;if(P.isByteBuffer(e))return(i=O.clone.call(e)).markedOffset=-1,i;if(e instanceof Uint8Array)i=new P(0,n,r),0<e.length&&(i.buffer=e.buffer,i.offset=e.byteOffset,i.limit=e.byteOffset+e.byteLength,i.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)i=new P(0,n,r),0<e.byteLength&&(i.buffer=e,i.offset=0,i.limit=e.byteLength,i.view=0<e.byteLength?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");(i=new P(e.length,n,r)).limit=e.length;for(var a=0;a<e.length;++a)i.view[a]=e[a]}return i},O.writeBitSet=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r=t,i=e.length,o=i>>3,a=0;for(t+=this.writeVarint32(i,t);o--;)u=1&!!e[a++]|(1&!!e[a++])<<1|(1&!!e[a++])<<2|(1&!!e[a++])<<3|(1&!!e[a++])<<4|(1&!!e[a++])<<5|(1&!!e[a++])<<6|(1&!!e[a++])<<7,this.writeByte(u,t++);if(a<i){for(var s=0,u=0;a<i;)u|=(1&!!e[a++])<<s++;this.writeByte(u,t++)}return n?(this.offset=t,this):t-r},O.readBitSet=function(e){var t=void 0===e;t&&(e=this.offset);var n=this.readVarint32(e),r=n.value,i=r>>3,o=0,a=[];for(e+=n.length;i--;)u=this.readByte(e++),a[o++]=!!(1&u),a[o++]=!!(2&u),a[o++]=!!(4&u),a[o++]=!!(8&u),a[o++]=!!(16&u),a[o++]=!!(32&u),a[o++]=!!(64&u),a[o++]=!!(128&u);if(o<r)for(var s=0,u=this.readByte(e++);o<r;)a[o++]=!!(u>>s++&1);return t&&(this.offset=e),a},O.readBytes=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}return t=this.slice(t,t+e),n&&(this.offset+=e),t},O.writeBytes=O.append,O.writeInt8=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),--t,this.view[t]=e,n&&(this.offset+=1),this},O.writeByte=O.writeInt8,O.readInt8=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return 128==(128&(e=this.view[e]))&&(e=-(255-e+1)),t&&(this.offset+=1),e},O.readByte=O.readInt8,O.writeUint8=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),--t,this.view[t]=e,n&&(this.offset+=1),this},O.writeUInt8=O.writeUint8,O.readUint8=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return e=this.view[e],t&&(this.offset+=1),e},O.readUInt8=O.readUint8,O.writeInt16=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),n&&(this.offset+=2),this},O.writeShort=O.writeInt16,O.readInt16=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e],n|=this.view[e+1]<<8):(n=this.view[e]<<8,n|=this.view[e+1]),32768==(32768&n)&&(n=-(65535-n+1)),t&&(this.offset+=2),n},O.readShort=O.readInt16,O.writeUint16=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),n&&(this.offset+=2),this},O.writeUInt16=O.writeUint16,O.readUint16=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e],n|=this.view[e+1]<<8):(n=this.view[e]<<8,n|=this.view[e+1]),t&&(this.offset+=2),n},O.readUInt16=O.readUint16,O.writeInt32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),n&&(this.offset+=4),this},O.writeInt=O.writeInt32,O.readInt32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0):(n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),n|=0,t&&(this.offset+=4),n},O.readInt=O.readInt32,O.writeUint32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),n&&(this.offset+=4),this},O.writeUInt32=O.writeUint32,O.readUint32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0):(n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),t&&(this.offset+=4),n},O.readUInt32=O.readUint32,d&&(O.writeInt64=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"==typeof e)e=d.fromNumber(e);else if("string"==typeof e)e=d.fromString(e);else if(!(e&&e instanceof d))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=d.fromNumber(e):"string"==typeof e&&(e=d.fromString(e)),t+=8;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=8,r=e.low,e=e.high,this.littleEndian?(this.view[t+3]=r>>>24&255,this.view[t+2]=r>>>16&255,this.view[t+1]=r>>>8&255,this.view[t]=255&r,t+=4,this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e,t+=4,this.view[t]=r>>>24&255,this.view[t+1]=r>>>16&255,this.view[t+2]=r>>>8&255,this.view[t+3]=255&r),n&&(this.offset+=8),this},O.writeLong=O.writeInt64,O.readInt64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0,e+=4,r=this.view[e+2]<<16,r|=this.view[e+1]<<8,r|=this.view[e],r+=this.view[e+3]<<24>>>0):(r=this.view[e+1]<<16,r|=this.view[e+2]<<8,r|=this.view[e+3],r+=this.view[e]<<24>>>0,e+=4,n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),r=new d(n,r,!1),t&&(this.offset+=8),r},O.readLong=O.readInt64,O.writeUint64=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"==typeof e)e=d.fromNumber(e);else if("string"==typeof e)e=d.fromString(e);else if(!(e&&e instanceof d))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=d.fromNumber(e):"string"==typeof e&&(e=d.fromString(e)),t+=8;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=8,r=e.low,e=e.high,this.littleEndian?(this.view[t+3]=r>>>24&255,this.view[t+2]=r>>>16&255,this.view[t+1]=r>>>8&255,this.view[t]=255&r,t+=4,this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e,t+=4,this.view[t]=r>>>24&255,this.view[t+1]=r>>>16&255,this.view[t+2]=r>>>8&255,this.view[t+3]=255&r),n&&(this.offset+=8),this},O.writeUInt64=O.writeUint64,O.readUint64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0,e+=4,r=this.view[e+2]<<16,r|=this.view[e+1]<<8,r|=this.view[e],r+=this.view[e+3]<<24>>>0):(r=this.view[e+1]<<16,r|=this.view[e+2]<<8,r|=this.view[e+3],r+=this.view[e]<<24>>>0,e+=4,n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),r=new d(n,r,!0),t&&(this.offset+=8),r},O.readUInt64=O.readUint64),O.writeFloat32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=4,U(this.view,e,t,this.littleEndian,23,4),n&&(this.offset+=4),this},O.writeFloat=O.writeFloat32,O.readFloat32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return e=z(this.view,e,this.littleEndian,23,4),t&&(this.offset+=4),e},O.readFloat=O.readFloat32,O.writeFloat64=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=8;var r=this.buffer.byteLength;return r<t&&this.resize((r*=2)>t?r:t),t-=8,U(this.view,e,t,this.littleEndian,52,8),n&&(this.offset+=8),this},O.writeDouble=O.writeFloat64,O.readFloat64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}return e=z(this.view,e,this.littleEndian,52,8),t&&(this.offset+=8),e},O.readDouble=O.readFloat64,P.MAX_VARINT32_BYTES=5,P.calculateVarint32=function(e){return(e>>>=0)<128?1:e<16384?2:e<1<<21?3:e<1<<28?4:5},P.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},P.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},O.writeVarint32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r,i=P.calculateVarint32(e);t+=i;var o=this.buffer.byteLength;for(o<t&&this.resize((o*=2)>t?o:t),t-=i,e>>>=0;128<=e;)r=127&e|128,this.view[t++]=r,e>>>=7;return this.view[t++]=e,n?(this.offset=t,this):i},O.writeVarint32ZigZag=function(e,t){return this.writeVarint32(P.zigZagEncode32(e),t)},O.readVarint32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=0,r=0;do{if(!this.noAssert&&e>this.limit){var i=Error("Truncated");throw i.truncated=!0,i}}while(i=this.view[e++],n<5&&(r|=(127&i)<<7*n),++n,0!=(128&i));return r|=0,t?(this.offset=e,r):{value:r,length:n}},O.readVarint32ZigZag=function(e){return e=this.readVarint32(e),"object"===(0,o.default)(e)?e.value=P.zigZagDecode32(e.value):e=P.zigZagDecode32(e),e},d&&(P.MAX_VARINT64_BYTES=10,P.calculateVarint64=function(e){"number"==typeof e?e=d.fromNumber(e):"string"==typeof e&&(e=d.fromString(e));var t=e.toInt()>>>0,n=e.shiftRightUnsigned(28).toInt()>>>0;return 0==(e=e.shiftRightUnsigned(56).toInt()>>>0)?0==n?t<16384?t<128?1:2:t<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:e<128?9:10},P.zigZagEncode64=function(e){return"number"==typeof e?e=d.fromNumber(e,!1):"string"==typeof e?e=d.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned()),e.shiftLeft(1).xor(e.shiftRight(63)).toUnsigned()},P.zigZagDecode64=function(e){return"number"==typeof e?e=d.fromNumber(e,!1):"string"==typeof e?e=d.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned()),e.shiftRightUnsigned(1).xor(e.and(d.ONE).toSigned().negate()).toSigned()},O.writeVarint64=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"==typeof e)e=d.fromNumber(e);else if("string"==typeof e)e=d.fromString(e);else if(!(e&&e instanceof d))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=d.fromNumber(e,!1):"string"==typeof e?e=d.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned());var r=P.calculateVarint64(e),i=e.toInt()>>>0,o=e.shiftRightUnsigned(28).toInt()>>>0,a=e.shiftRightUnsigned(56).toInt()>>>0;switch(t+=r,(e=this.buffer.byteLength)<t&&this.resize((e*=2)>t?e:t),t-=r,r){case 10:this.view[t+9]=a>>>7&1;case 9:this.view[t+8]=9!==r?128|a:127&a;case 8:this.view[t+7]=8!==r?o>>>21|128:o>>>21&127;case 7:this.view[t+6]=7!==r?o>>>14|128:o>>>14&127;case 6:this.view[t+5]=6!==r?o>>>7|128:o>>>7&127;case 5:this.view[t+4]=5!==r?128|o:127&o;case 4:this.view[t+3]=4!==r?i>>>21|128:i>>>21&127;case 3:this.view[t+2]=3!==r?i>>>14|128:i>>>14&127;case 2:this.view[t+1]=2!==r?i>>>7|128:i>>>7&127;case 1:this.view[t]=1!==r?128|i:127&i}return n?(this.offset+=r,this):r},O.writeVarint64ZigZag=function(e,t){return this.writeVarint64(P.zigZagEncode64(e),t)},O.readVarint64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=e,r=0,i=0,o=0,a=0;if(r=127&(a=this.view[e++]),128&a&&(r|=(127&(a=this.view[e++]))<<7,(128&a||this.noAssert&&void 0===a)&&(r|=(127&(a=this.view[e++]))<<14,(128&a||this.noAssert&&void 0===a)&&(r|=(127&(a=this.view[e++]))<<21,(128&a||this.noAssert&&void 0===a)&&(i=127&(a=this.view[e++]),(128&a||this.noAssert&&void 0===a)&&(i|=(127&(a=this.view[e++]))<<7,(128&a||this.noAssert&&void 0===a)&&(i|=(127&(a=this.view[e++]))<<14,(128&a||this.noAssert&&void 0===a)&&(i|=(127&(a=this.view[e++]))<<21,(128&a||this.noAssert&&void 0===a)&&(o=127&(a=this.view[e++]),(128&a||this.noAssert&&void 0===a)&&(o|=(127&(a=this.view[e++]))<<7,128&a||this.noAssert&&void 0===a))))))))))throw Error("Buffer overrun");return o=d.fromBits(r|i<<28,i>>>4|o<<24,!1),t?(this.offset=e,o):{value:o,length:e-n}},O.readVarint64ZigZag=function(e){return(e=this.readVarint64(e))&&e.value instanceof d?e.value=P.zigZagDecode64(e.value):e=P.zigZagDecode64(e),e}),O.writeCString=function(e,t){var n=void 0===t;n&&(t=this.offset);var r,i=e.length;if(!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(r=0;r<i;++r)if(0===e.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}i=j.calculateUTF16asUTF8(B(e))[1],t+=i+1;var o=this.buffer.byteLength;return o<t&&this.resize((o*=2)>t?o:t),t-=i+1,j.encodeUTF16toUTF8(B(e),function(e){this.view[t++]=e}.bind(this)),this.view[t++]=0,n?(this.offset=t,this):i},O.readCString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n,r=e,i=-1;return j.decodeUTF8toUTF16(function(){if(0===i)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(i=this.view[e++])?null:i}.bind(this),n=G(),!0),t?(this.offset=e,n()):{string:n(),length:e-r}},O.writeIString=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r=t,i=j.calculateUTF16asUTF8(B(e),this.noAssert)[1];t+=4+i;var o=this.buffer.byteLength;if(o<t&&this.resize((o*=2)>t?o:t),t-=4+i,this.littleEndian?(this.view[t+3]=i>>>24&255,this.view[t+2]=i>>>16&255,this.view[t+1]=i>>>8&255,this.view[t]=255&i):(this.view[t]=i>>>24&255,this.view[t+1]=i>>>16&255,this.view[t+2]=i>>>8&255,this.view[t+3]=255&i),t+=4,j.encodeUTF16toUTF8(B(e),function(e){this.view[t++]=e}.bind(this)),t!==r+4+i)throw RangeError("Illegal range: Truncated data, "+t+" == "+(t+4+i));return n?(this.offset=t,this):t-r},O.readIString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=e,r=this.readUint32(e);return r=this.readUTF8String(r,P.METRICS_BYTES,e+=4),e+=r.length,t?(this.offset=e,r.string):{string:r.string,length:e-n}},P.METRICS_CHARS="c",P.METRICS_BYTES="b",O.writeUTF8String=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r=t,i=j.calculateUTF16asUTF8(B(e))[1];t+=i;var o=this.buffer.byteLength;return o<t&&this.resize((o*=2)>t?o:t),t-=i,j.encodeUTF16toUTF8(B(e),function(e){this.view[t++]=e}.bind(this)),n?(this.offset=t,this):t-r},O.writeString=O.writeUTF8String,P.calculateUTF8Chars=function(e){return j.calculateUTF16asUTF8(B(e))[0]},P.calculateUTF8Bytes=function(e){return j.calculateUTF16asUTF8(B(e))[1]},P.calculateString=P.calculateUTF8Bytes,O.readUTF8String=function(e,t,n){"number"==typeof t&&(n=t,t=void 0);var r=void 0===n;if(r&&(n=this.offset),void 0===t&&(t=P.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,o=0,a=n;if(t===P.METRICS_CHARS){if(i=G(),j.decodeUTF8(function(){return o<e&&n<this.limit?this.view[n++]:null}.bind(this),(function(e){++o,j.UTF8toUTF16(e,i)})),o!==e)throw RangeError("Illegal range: Truncated data, "+o+" == "+e);return r?(this.offset=n,i()):{string:i(),length:n-a}}if(t!==P.METRICS_BYTES)throw TypeError("Unsupported metrics: "+t);if(!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+"+e+") <= "+this.buffer.byteLength)}var s=n+e;if(j.decodeUTF8toUTF16(function(){return n<s?this.view[n++]:null}.bind(this),i=G(),this.noAssert),n!==s)throw RangeError("Illegal range: Truncated data, "+n+" == "+s);return r?(this.offset=n,i()):{string:i(),length:n-a}},O.readString=O.readUTF8String,O.writeVString=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r=t,i=j.calculateUTF16asUTF8(B(e),this.noAssert)[1],o=P.calculateVarint32(i);t+=o+i;var a=this.buffer.byteLength;if(a<t&&this.resize((a*=2)>t?a:t),t-=o+i,t+=this.writeVarint32(i,t),j.encodeUTF16toUTF8(B(e),function(e){this.view[t++]=e}.bind(this)),t!==r+i+o)throw RangeError("Illegal range: Truncated data, "+t+" == "+(t+i+o));return n?(this.offset=t,this):t-r},O.readVString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=e,r=this.readVarint32(e);return r=this.readUTF8String(r.value,P.METRICS_BYTES,e+=r.length),e+=r.length,t?(this.offset=e,r.string):{string:r.string,length:e-n}},O.append=function(e,t,n){"number"!=typeof t&&"string"==typeof t||(n=t,t=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}e instanceof P||(e=P.wrap(e,t));var i=e.limit-e.offset;return i<=0||(n+=i,(t=this.buffer.byteLength)<n&&this.resize((t*=2)>n?t:n),n-=i,this.view.set(e.view.subarray(e.offset,e.limit),n),e.offset+=i,r&&(this.offset+=i)),this},O.appendTo=function(e,t){return e.append(this,t),this},O.assert=function(e){return this.noAssert=!e,this},O.capacity=function(){return this.buffer.byteLength},O.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},O.clone=function(e){var t=new P(0,this.littleEndian,this.noAssert);return e?(t.buffer=new ArrayBuffer(this.buffer.byteLength),t.view=new Uint8Array(t.buffer)):(t.buffer=this.buffer,t.view=this.view),t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},O.compact=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(0===e&&t===this.buffer.byteLength)return this;var n=t-e;if(0===n)return this.buffer=D,this.view=null,0<=this.markedOffset&&(this.markedOffset-=e),this.offset=0,this.limit=0,this;var r=new ArrayBuffer(n),i=new Uint8Array(r);return i.set(this.view.subarray(e,t)),this.buffer=r,this.view=i,0<=this.markedOffset&&(this.markedOffset-=e),this.offset=0,this.limit=n,this},O.copy=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new P(0,this.littleEndian,this.noAssert);var n=t-e,r=new P(n,this.littleEndian,this.noAssert);return r.offset=0,r.limit=n,0<=r.markedOffset&&(r.markedOffset-=e),this.copyTo(r,0,e,t),r},O.copyTo=function(e,t,n,r){var i,o;if(!this.noAssert&&!P.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(o=void 0===t)?e.offset:0|t,n=(i=void 0===n)?this.offset:0|n,r=void 0===r?this.limit:0|r,t<0||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var a=r-n;return 0===a?e:(e.ensureCapacity(t+a),e.view.set(this.view.subarray(n,r),t),i&&(this.offset+=a),o&&(e.offset+=a),this)},O.ensureCapacity=function(e){var t=this.buffer.byteLength;return t<e?this.resize((t*=2)>e?t:e):this},O.fill=function(e,t,n){var r=void 0===t;if(r&&(t=this.offset),"string"==typeof e&&0<e.length&&(e=e.charCodeAt(0)),void 0===t&&(t=this.offset),void 0===n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,t<0||n<t||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(n<=t)return this;for(;t<n;)this.view[t++]=e;return r&&(this.offset=t),this},O.flip=function(){return this.limit=this.offset,this.offset=0,this},O.mark=function(e){if(e=void 0===e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},O.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},O.LE=function(e){return this.littleEndian=void 0===e||!!e,this},O.BE=function(e){return this.littleEndian=void 0!==e&&!e,this},O.prepend=function(e,t,n){"number"!=typeof t&&"string"==typeof t||(n=t,t=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}e instanceof P||(e=P.wrap(e,t));var i=e.limit-e.offset;if(i<=0)return this;var o,a=i-n;return 0<a?(o=new ArrayBuffer(this.buffer.byteLength+a),(t=new Uint8Array(o)).set(this.view.subarray(n,this.buffer.byteLength),i),this.buffer=o,this.view=t,this.offset+=a,0<=this.markedOffset&&(this.markedOffset+=a),this.limit+=a,n+=a):new Uint8Array(this.buffer),this.view.set(e.view.subarray(e.offset,e.limit),n-i),e.offset=e.limit,r&&(this.offset-=i),this},O.prependTo=function(e,t){return e.prepend(this,t),this},O.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},O.remaining=function(){return this.limit-this.offset},O.reset=function(){return 0<=this.markedOffset?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},O.resize=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if((e|=0)<0)throw RangeError("Illegal capacity: 0 <= "+e)}var t;return this.buffer.byteLength<e&&(t=new ArrayBuffer(e),(e=new Uint8Array(t)).set(this.view),this.buffer=t,this.view=e),this},O.reverse=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t||Array.prototype.reverse.call(this.view.subarray(e,t)),this},O.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},O.slice=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},O.toBuffer=function(e){var t=this.offset,n=this.limit;if(!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal limit: Not an integer");if(n>>>=0,t<0||n<t||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}return e||0!==t||n!==this.buffer.byteLength?t===n?D:(e=new ArrayBuffer(n-t),new Uint8Array(e).set(new Uint8Array(this.buffer).subarray(t,n),0),e):this.buffer},O.toArrayBuffer=O.toBuffer,O.toString=function(e,t,n){if(void 0===e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(n=t=e="utf8"),e){case"utf8":return this.toUTF8(t,n);case"base64":return this.toBase64(t,n);case"hex":return this.toHex(t,n);case"binary":return this.toBinary(t,n);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}};var V=function(){for(var e={},t=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],n=[],r=0,i=t.length;r<i;++r)n[t[r]]=r;return e.encode=function(e,n){for(var r,i;null!==(r=e());)n(t[r>>2&63]),i=(3&r)<<4,null!==(r=e())?(n(t[63&((i|=r>>4&15)|r>>4&15)]),i=(15&r)<<2,null!==(r=e())?(n(t[63&(i|r>>6&3)]),n(t[63&r])):(n(t[63&i]),n(61))):(n(t[63&i]),n(61),n(61))},e.decode=function(e,t){var r,i,o;function a(e){throw Error("Illegal character code: "+e)}for(;null!==(r=e());)if(void 0===(i=n[r])&&a(r),null!==(r=e())&&(void 0===(o=n[r])&&a(r),t(i<<2>>>0|(48&o)>>4),null!==(r=e()))){if(void 0===(i=n[r])){if(61===r)break;a(r)}if(t((15&o)<<4>>>0|(60&i)>>2),null!==(r=e())){if(void 0===(o=n[r])){if(61===r)break;a(r)}t((3&i)<<6>>>0|o)}}},e.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)},e}();O.toBase64=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity||t<e)throw RangeError("begin, end");var n;return V.encode(function(){return e<t?this.view[e++]:null}.bind(this),n=G()),n()},P.fromBase64=function(e,t){if("string"!=typeof e)throw TypeError("str");var n=new P(e.length/4*3,t),r=0;return V.decode(B(e),(function(e){n.view[r++]=e})),n.limit=r,n},P.btoa=function(e){return P.fromBinary(e).toBase64()},P.atob=function(e){return P.fromBase64(e).toBinary()},O.toBinary=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity()||t<e)throw RangeError("begin, end");if(e===t)return"";for(var n=[],r=[];e<t;)n.push(this.view[e++]),1024<=n.length&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},P.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var n,r=0,i=e.length,o=new P(i,t);r<i;){if(255<(n=e.charCodeAt(r)))throw RangeError("illegal char code: "+n);o.view[r++]=n}return o.limit=i,o},O.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,i="",o="",a="";n<r;){if(-1!==n&&(i+=(t=this.view[n])<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(o+=32<t&&t<127?String.fromCharCode(t):".")),++n,e&&0<n&&n%16==0&&n!==r){for(;i.length<51;)i+=" ";a+=i+o+"\n",i=o=""}n===this.offset&&n===this.limit?i+=n===this.markedOffset?"!":"|":n===this.offset?i+=n===this.markedOffset?"[":"<":n===this.limit?i+=n===this.markedOffset?"]":">":i+=n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";a+=i+o+"\n"}return e?a:i},P.fromDebug=function(e,t,n){for(var r,i,o=e.length,a=new P((o+1)/3|0,t,n),u=0,l=0,c=!1,h=!1,f=!1,d=!1,p=!1;u<o;){switch(r=e.charAt(u++)){case"!":if(!n){if(h||f||d){p=!0;break}h=f=d=!0}a.offset=a.markedOffset=a.limit=l,c=!1;break;case"|":if(!n){if(h||d){p=!0;break}h=d=!0}a.offset=a.limit=l,c=!1;break;case"[":if(!n){if(h||f){p=!0;break}h=f=!0}a.offset=a.markedOffset=l,c=!1;break;case"<":if(!n){if(h){p=!0;break}h=!0}a.offset=l,c=!1;break;case"]":if(!n){if(d||f){p=!0;break}d=f=!0}a.limit=a.markedOffset=l,c=!1;break;case">":if(!n){if(d){p=!0;break}d=!0}a.limit=l,c=!1;break;case"'":if(!n){if(f){p=!0;break}f=!0}a.markedOffset=l,c=!1;break;case" ":c=!1;break;default:if(!n&&c){p=!0;break}if(i=(0,s.default)(r+e.charAt(u++),16),!n&&(isNaN(i)||i<0||255<i))throw TypeError("Illegal str: Not a debug encoded string");a.view[l++]=i,c=!0}if(p)throw TypeError("Illegal str: Invalid symbol at "+u)}if(!n){if(!h||!d)throw TypeError("Illegal str: Missing offset or limit");if(l<a.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+l+" < "+o)}return a},O.toHex=function(e,t){if(e=void 0===e?this.offset:e,t=void 0===t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);e<t;)(n=this.view[e++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},P.fromHex=function(e,t,n){if(!n){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var r,i=e.length,o=new P(i/2|0,t),a=0,u=0;a<i;a+=2){if(r=(0,s.default)(e.substring(a,a+2),16),!n&&(!isFinite(r)||r<0||255<r))throw TypeError("Illegal str: Contains non-hex characters");o.view[u++]=r}return o.limit=u,o};var H,j=(H={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):(n<2048?t(n>>6&31|192):(n<65536?t(n>>12&15|224):(t(n>>18&7|240),t(n>>12&63|128)),t(n>>6&63|128)),t(63&n|128)),n=null},decodeUTF8:function(e,t){for(var n,r,i,o,a=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0==(128&n))t(n);else if(192==(224&n))null===(r=e())&&a([n,r]),t((31&n)<<6|63&r);else if(224==(240&n))null!==(r=e())&&null!==(i=e())||a([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);null!==(r=e())&&null!==(i=e())&&null!==(o=e())||a([n,r,i,o]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},UTF16toUTF8:function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());)55296<=n&&n<=57343&&null!==(r=e())&&56320<=r&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)},UTF8toUTF16:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(55296+((n-=65536)>>10)),t(n%1024+56320)),n=null},encodeUTF16toUTF8:function(e,t){H.UTF16toUTF8(e,(function(e){H.encodeUTF8(e,t)}))},decodeUTF8toUTF16:function(e,t){H.decodeUTF8(e,(function(e){H.UTF8toUTF16(e,t)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t,n=0;null!==(t=e());)n+=t<128?1:t<2048?2:t<65536?3:4;return n},calculateUTF16asUTF8:function(e){var t=0,n=0;return H.UTF16toUTF8(e,(function(e){++t,n+=e<128?1:e<2048?2:e<65536?3:4})),[t,n]}},H);O.toUTF8=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||t<e||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n;try{j.decodeUTF8toUTF16(function(){return e<t?this.view[e++]:null}.bind(this),n=G())}catch(n){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return n()},P.fromUTF8=function(e,t,n){if(!n&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var r=new P(j.calculateUTF16asUTF8(B(e),!0)[1],t,n),i=0;return j.encodeUTF16toUTF8(B(e),(function(e){r.view[i++]=e})),r.limit=i,r};var W,Y,q,X,Z,J,K={};function Q(e){e.messages&&e.messages.forEach((function(t){t.syntax=e.syntax,Q(t)})),e.enums&&e.enums.forEach((function(t){t.syntax=e.syntax}))}function $(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}t.ProtoBuf=K,K.ByteBuffer=P,K.Long=P.Long||null,K.VERSION="5.0.1",K.WIRE_TYPES={},K.WIRE_TYPES.VARINT=0,K.WIRE_TYPES.BITS64=1,K.WIRE_TYPES.LDELIM=2,K.WIRE_TYPES.STARTGROUP=3,K.WIRE_TYPES.ENDGROUP=4,K.WIRE_TYPES.BITS32=5,K.PACKABLE_WIRE_TYPES=[K.WIRE_TYPES.VARINT,K.WIRE_TYPES.BITS64,K.WIRE_TYPES.BITS32],K.TYPES={int32:{name:"int32",wireType:K.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:K.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:K.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:K.WIRE_TYPES.VARINT,defaultValue:K.Long?K.Long.ZERO:void 0},uint64:{name:"uint64",wireType:K.WIRE_TYPES.VARINT,defaultValue:K.Long?K.Long.UZERO:void 0},sint64:{name:"sint64",wireType:K.WIRE_TYPES.VARINT,defaultValue:K.Long?K.Long.ZERO:void 0},bool:{name:"bool",wireType:K.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:K.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:K.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:K.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:K.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:K.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:K.WIRE_TYPES.BITS64,defaultValue:K.Long?K.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:K.WIRE_TYPES.BITS64,defaultValue:K.Long?K.Long.ZERO:void 0},float:{name:"float",wireType:K.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:K.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:K.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:K.WIRE_TYPES.STARTGROUP,defaultValue:null}},K.MAP_KEY_TYPES=[K.TYPES.int32,K.TYPES.sint32,K.TYPES.sfixed32,K.TYPES.uint32,K.TYPES.fixed32,K.TYPES.int64,K.TYPES.sint64,K.TYPES.sfixed64,K.TYPES.uint64,K.TYPES.fixed64,K.TYPES.bool,K.TYPES.string,K.TYPES.bytes],K.ID_MIN=1,K.ID_MAX=536870911,K.convertFieldsToCamelCase=!1,K.populateAccessors=!0,K.populateDefaults=!0,K.Util=((W={}).IS_NODE=!("object"!==(void 0===e?"undefined":(0,o.default)(e))||e+""!="[object process]"||e.browser),W.XHR=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=null,n=0;n<e.length;n++){try{t=e[n]()}catch(e){continue}break}if(!t)throw Error("XMLHttpRequest is not supported");return t},W.fetch=function(e,t){if(t&&"function"!=typeof t&&(t=null),W.IS_NODE){var r=n(264);if(t)r.readFile(e,(function(e,n){t(e?null:""+n)}));else try{return r.readFileSync(e)}catch(e){return null}}else{var i=W.XHR();if(i.open("GET",e,!!t),i.setRequestHeader("Accept","text/plain"),"function"==typeof i.overrideMimeType&&i.overrideMimeType("text/plain"),!t)return i.send(null),200==i.status||0==i.status&&"string"==typeof i.responseText?i.responseText:null;i.onreadystatechange=function(){4==i.readyState&&(200==i.status||0==i.status&&"string"==typeof i.responseText?t(i.responseText):t(null))},4!=i.readyState&&i.send(null)}},W.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,(function(e,t){return t.toUpperCase()}))},W),K.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},K.DotProto=function(e,t){var n={},r=function(e){this.source=e+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null};(i=r.prototype)._readString=function(){var e='"'===this._stringOpen?t.STRING_DQ:t.STRING_SQ;e.lastIndex=this.index-1;var n=e.exec(this.source);if(!n)throw Error("unterminated string");return this.index=e.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,n[1]},i.next=function(){if(0<this.stack.length)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();var e,n,r;do{for(e=!1;t.WHITESPACE.test(r=this.source.charAt(this.index));)if("\n"===r&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,e=!0}else{if("*"!==(r=this.source.charAt(this.index)))return"/";do{if("\n"===r&&++this.line,++this.index===this.source.length)return null}while(n=r,r=this.source.charAt(this.index),"*"!==n||"/"!==r);++this.index,e=!0}}while(e);if(this.index===this.source.length)return null;var i=this.index;t.DELIM.lastIndex=0;var o=t.DELIM.test(this.source.charAt(i++));if(!o)for(;i<this.source.length&&!t.DELIM.test(this.source.charAt(i));)++i;return'"'!==(o=this.source.substring(this.index,this.index=i))&&"'"!==o||(this._stringOpen=o),o},i.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},i.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},i.omit=function(e){return this.peek()===e&&(this.next(),!0)},i.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},n.Tokenizer=r;var i,o=function(e){this.tn=new r(e),this.proto3=!1};function a(e,n){var r=-1,i=1;if("-"==e.charAt(0)&&(i=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))r=(0,s.default)(e);else if(t.NUMBER_HEX.test(e))r=(0,s.default)(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("illegal id value: "+(i<0?"-":"")+e);r=(0,s.default)(e.substring(1),8)}if(r=i*r|0,!n&&r<0)throw Error("illegal id value: "+(i<0?"-":"")+e);return r}function c(e){var n=1;if("-"==e.charAt(0)&&(n=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return n*(0,s.default)(e,10);if(t.NUMBER_HEX.test(e))return n*(0,s.default)(e.substring(2),16);if(t.NUMBER_OCT.test(e))return n*(0,s.default)(e.substring(1),8);if("inf"===e)return n*(1/0);if("nan"===e)return NaN;if(t.NUMBER_FLT.test(e))return n*(0,u.default)(e);throw Error("illegal number value: "+(n<0?"-":"")+e)}function h(e,t,n){void 0===e[t]?e[t]=n:((0,l.default)(e[t])||(e[t]=[e[t]]),e[t].push(n))}return(i=o.prototype).parse=function(){var e,n,r={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},i=!0;try{for(;e=this.tn.next();)switch(e){case"package":if(!i||null!==r.package)throw Error("unexpected 'package'");if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("illegal package name: "+e);this.tn.skip(";"),r.package=e;break;case"import":if(!i)throw Error("unexpected 'import'");"public"!==(e=this.tn.peek())&&!(n="weak"===e)||this.tn.next(),e=this._readString(),this.tn.skip(";"),n||r.imports.push(e);break;case"syntax":if(!i)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(r.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(r,null),i=!1;break;case"enum":this._parseEnum(r),i=!1;break;case"option":this._parseOption(r);break;case"service":this._parseService(r);break;case"extend":this._parseExtend(r);break;default:throw Error("unexpected '"+e+"'")}}catch(e){throw e.message="Parse error at line "+this.tn.line+": "+e.message,e}return delete r.name,r},o.parse=function(e){return new o(e).parse()},i._readString=function(){var e,t="";do{if("'"!==(e=this.tn.next())&&'"'!==e)throw Error("illegal string delimiter: "+e)}while(t+=this.tn.next(),this.tn.skip(e),'"'===(e=this.tn.peek())||'"'===e);return t},i._readValue=function(e){var n=this.tn.peek();if('"'===n||"'"===n)return this._readString();if(this.tn.next(),t.NUMBER.test(n))return c(n);if(t.BOOL.test(n))return"true"===n.toLowerCase();if(e&&t.TYPEREF.test(n))return n;throw Error("illegal value: "+n)},i._parseOption=function(e,n){var r=this.tn.next(),i=!1;if("("===r&&(i=!0,r=this.tn.next()),!t.TYPEREF.test(r))throw Error("illegal option name: "+r);var o=r;i&&(this.tn.skip(")"),o="("+o+")",r=this.tn.peek(),t.FQTYPEREF.test(r)&&(o+=r,this.tn.next())),this.tn.skip("="),this._parseOptionValue(e,o),n||this.tn.skip(";")},i._parseOptionValue=function(e,n){var r=this.tn.peek();if("{"!==r)h(e.options,n,this._readValue(!0));else for(this.tn.skip("{");"}"!==(r=this.tn.next());){if(!t.NAME.test(r))throw Error("illegal option name: "+n+"."+r);this.tn.omit(":")?h(e.options,n+"."+r,this._readValue(!0)):this._parseOptionValue(e,n+"."+r)}},i._parseService=function(e){var n=this.tn.next();if(!t.NAME.test(n))throw Error("illegal service name at line "+this.tn.line+": "+n);var r={name:n,rpc:{},options:{}};for(this.tn.skip("{");"}"!==(n=this.tn.next());)if("option"===n)this._parseOption(r);else{if("rpc"!==n)throw Error("illegal service token: "+n);this._parseServiceRPC(r)}this.tn.omit(";"),e.services.push(r)},i._parseServiceRPC=function(e){var n="rpc",r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal rpc service method name: "+r);var i=r,o={request:null,response:null,request_stream:!1,response_stream:!1,options:{}};if(this.tn.skip("("),"stream"===(r=this.tn.next()).toLowerCase()&&(o.request_stream=!0,r=this.tn.next()),!t.TYPEREF.test(r))throw Error("illegal rpc service request type: "+r);if(o.request=r,this.tn.skip(")"),"returns"!==(r=this.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+r);if(this.tn.skip("("),"stream"===(r=this.tn.next()).toLowerCase()&&(o.response_stream=!0,r=this.tn.next()),o.response=r,this.tn.skip(")"),"{"===(r=this.tn.peek())){for(this.tn.next();"}"!==(r=this.tn.next());){if("option"!==r)throw Error("illegal rpc service token: "+r);this._parseOption(o)}this.tn.omit(";")}else this.tn.skip(";");void 0===e[n]&&(e[n]={}),e[n][i]=o},i._parseMessage=function(e,n){var r=!!n,i=this.tn.next(),o={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!t.NAME.test(i))throw Error("illegal "+(r?"group":"message")+" name: "+i);for(o.name=i,r&&(this.tn.skip("="),n.id=a(this.tn.next()),o.isGroup=!0),"["===(i=this.tn.peek())&&n&&this._parseFieldOptions(n),this.tn.skip("{");"}"!==(i=this.tn.next());)if(t.RULE.test(i))this._parseMessageField(o,i);else if("oneof"===i)this._parseMessageOneOf(o);else if("enum"===i)this._parseEnum(o);else if("message"===i)this._parseMessage(o);else if("option"===i)this._parseOption(o);else if("service"===i)this._parseService(o);else if("extensions"===i)o.extensions=this._parseExtensionRanges();else if("reserved"===i)this._parseIgnored();else if("extend"===i)this._parseExtend(o);else{if(!t.TYPEREF.test(i))throw Error("illegal message token: "+i);if(!this.proto3)throw Error("illegal field rule: "+i);this._parseMessageField(o,"optional",i)}return this.tn.omit(";"),e.messages.push(o),o},i._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},i._parseMessageField=function(e,n,r){if(!t.RULE.test(n))throw Error("illegal message field rule: "+n);var i,o={rule:n,type:"",name:"",options:{},id:0};if("map"===n){if(r)throw Error("illegal type: "+r);if(this.tn.skip("<"),i=this.tn.next(),!t.TYPE.test(i)&&!t.TYPEREF.test(i))throw Error("illegal message field type: "+i);if(o.keytype=i,this.tn.skip(","),i=this.tn.next(),!t.TYPE.test(i)&&!t.TYPEREF.test(i))throw Error("illegal message field: "+i);if(o.type=i,this.tn.skip(">"),i=this.tn.next(),!t.NAME.test(i))throw Error("illegal message field name: "+i);o.name=i,this.tn.skip("="),o.id=a(this.tn.next()),"["===(i=this.tn.peek())&&this._parseFieldOptions(o),this.tn.skip(";")}else if("group"===(r=void 0!==r?r:this.tn.next())){if(n=this._parseMessage(e,o),!/^[A-Z]/.test(n.name))throw Error("illegal group name: "+n.name);o.type=n.name,o.name=n.name.toLowerCase(),this.tn.omit(";")}else{if(!t.TYPE.test(r)&&!t.TYPEREF.test(r))throw Error("illegal message field type: "+r);if(o.type=r,i=this.tn.next(),!t.NAME.test(i))throw Error("illegal message field name: "+i);o.name=i,this.tn.skip("="),o.id=a(this.tn.next()),"["===(i=this.tn.peek())&&this._parseFieldOptions(o),this.tn.skip(";")}return e.fields.push(o),o},i._parseMessageOneOf=function(e){var n=this.tn.next();if(!t.NAME.test(n))throw Error("illegal oneof name: "+n);var r,i=n,o=[];for(this.tn.skip("{");"}"!==(n=this.tn.next());)(r=this._parseMessageField(e,"optional",n)).oneof=i,o.push(r.id);this.tn.omit(";"),e.oneofs[i]=o},i._parseFieldOptions=function(e){this.tn.skip("[");for(var t=!0;"]"!==this.tn.peek();)t||this.tn.skip(","),this._parseOption(e,!0),t=!1;this.tn.next()},i._parseEnum=function(e){var n={name:"",values:[],options:{}},r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal name: "+r);for(n.name=r,this.tn.skip("{");"}"!==(r=this.tn.next());)if("option"===r)this._parseOption(n);else{if(!t.NAME.test(r))throw Error("illegal name: "+r);this.tn.skip("=");var i={name:r,id:a(this.tn.next(),!0)};"["===(r=this.tn.peek())&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),n.values.push(i)}this.tn.omit(";"),e.enums.push(n)},i._parseExtensionRanges=function(){var t,n,r,i=[];do{for(n=[];;){switch(t=this.tn.next()){case"min":r=e.ID_MIN;break;case"max":r=e.ID_MAX;break;default:r=c(t)}if(n.push(r),2===n.length)break;if("to"!==this.tn.peek()){n.push(r);break}this.tn.next()}}while(i.push(n),this.tn.omit(","));return this.tn.skip(";"),i},i._parseExtend=function(e){var n=this.tn.next();if(!t.TYPEREF.test(n))throw Error("illegal extend reference: "+n);var r={ref:n,fields:[]};for(this.tn.skip("{");"}"!==(n=this.tn.next());)if(t.RULE.test(n))this._parseMessageField(r,n);else{if(!t.TYPEREF.test(n))throw Error("illegal extend token: "+n);if(!this.proto3)throw Error("illegal field rule: "+n);this._parseMessageField(r,"optional",n)}return this.tn.omit(";"),e.messages.push(r),r},i.toString=function(){return"Parser at line "+this.tn.line},n.Parser=o,n}(K,K.Lang),K.Reflect=function(e){var t={},n=function(e,t,n){this.builder=e,this.parent=t,this.name=n,this.className};(d=n.prototype).fqn=function(){for(var e=this.name,t=this;null!=(t=t.parent);)e=t.name+"."+e;return e},d.toString=function(e){return(e?this.className+" ":"")+this.fqn()},d.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},t.T=n;var r=function(e,t,r,i,o){n.call(this,e,t,r),this.className="Namespace",this.children=[],this.options=i||{},this.syntax=o||"proto2"},i=r.prototype=(0,c.default)(n.prototype);i.getChildren=function(e){if(null==(e=e||null))return this.children.slice();for(var t=[],n=0,r=this.children.length;n<r;++n)this.children[n]instanceof e&&t.push(this.children[n]);return t},i.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof g.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof g.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},i.getChild=function(e){for(var t="number"==typeof e?"id":"name",n=0,r=this.children.length;n<r;++n)if(this.children[n][t]===e)return this.children[n];return null},i.resolve=function(e,n){var r,i="string"==typeof e?e.split("."):e,o=this,a=0;if(""===i[a]){for(;null!==o.parent;)o=o.parent;a++}do{do{if(!(o instanceof t.Namespace)){o=null;break}if(!(r=o.getChild(i[a]))||!(r instanceof t.T)||n&&!(r instanceof t.Namespace)){o=null;break}}while(o=r,++a<i.length);if(null!=o)break;if(null!==this.parent)return this.parent.resolve(e,n)}while(null!=o);return o},i.qn=function(e){for(var n=[],r=e;n.unshift(r.name),null!==(r=r.parent););for(var i=1;i<=n.length;i++){var o=n.slice(n.length-i);if(e===this.resolve(o,e instanceof t.Namespace))return o.join(".")}return e.fqn()},i.build=function(){for(var e,t={},n=this.children,i=0,o=n.length;i<o;++i)(e=n[i])instanceof r&&(t[e.name]=e.build());return a.default&&(0,a.default)(t,"$options",{value:this.buildOpt()}),t},i.buildOpt=function(){for(var e={},t=(0,h.default)(this.options),n=0,r=t.length;n<r;++n){var i=t[n],o=this.options[t[n]];e[i]=o}return e},i.getOption=function(e){return void 0===e?this.options:void 0!==this.options[e]?this.options[e]:null},t.Namespace=r;var u=function(t,n,r,i){if(this.type=t,this.resolvedType=n,this.isMapKey=r,this.syntax=i,r&&e.MAP_KEY_TYPES.indexOf(t)<0)throw Error("Invalid map key type: "+t.name)},d=u.prototype;function p(t,n){if(t&&"number"==typeof t.low&&"number"==typeof t.high&&"boolean"==typeof t.unsigned&&t.low==t.low&&t.high==t.high)return new e.Long(t.low,t.high,void 0===n?t.unsigned:n);if("string"==typeof t)return e.Long.fromString(t,n||!1,10);if("number"==typeof t)return e.Long.fromNumber(t,n||!1);throw Error("not convertible to Long")}u.defaultFieldValue=function(t){if("string"==typeof t&&(t=e.TYPES[t]),void 0===t.defaultValue)throw Error("default value for type "+t.name+" is not supported");return t==e.TYPES.bytes?new P(0):t.defaultValue},d.verifyValue=function(t){var n=this;function r(e,t){throw Error("Illegal value for "+n.toString(!0)+" of type "+n.type.name+": "+e+" ("+t+")")}switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:return("number"!=typeof t||t==t&&t%1!=0)&&r((0,o.default)(t),"not an integer"),4294967295<t?0|t:t;case e.TYPES.uint32:case e.TYPES.fixed32:return("number"!=typeof t||t==t&&t%1!=0)&&r((0,o.default)(t),"not an integer"),t<0?t>>>0:t;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:if(e.Long)try{return p(t,!1)}catch(i){r((0,o.default)(t),i.message)}else r((0,o.default)(t),"requires Long.js");case e.TYPES.uint64:case e.TYPES.fixed64:if(e.Long)try{return p(t,!0)}catch(i){r((0,o.default)(t),i.message)}else r((0,o.default)(t),"requires Long.js");case e.TYPES.bool:return"boolean"!=typeof t&&r((0,o.default)(t),"not a boolean"),t;case e.TYPES.float:case e.TYPES.double:return"number"!=typeof t&&r((0,o.default)(t),"not a number"),t;case e.TYPES.string:return"string"==typeof t||t&&t instanceof String||r((0,o.default)(t),"not a string"),""+t;case e.TYPES.bytes:return P.isByteBuffer(t)?t:P.wrap(t,"base64");case e.TYPES.enum:for(var i=this.resolvedType.getChildren(e.Reflect.Enum.Value),a=0;a<i.length;a++){if(i[a].name==t)return i[a].id;if(i[a].id==t)return i[a].id}if("proto3"===this.syntax)return("number"!=typeof t||t==t&&t%1!=0)&&r((0,o.default)(t),"not an integer"),(4294967295<t||t<0)&&r((0,o.default)(t),"not in range for uint32"),t;r(t,"not a valid enum value");case e.TYPES.group:case e.TYPES.message:if(t&&"object"===(0,o.default)(t)||r((0,o.default)(t),"object expected"),t instanceof this.resolvedType.clazz)return t;if(t instanceof e.Builder.Message){var s={};for(a in t)t.hasOwnProperty(a)&&(s[a]=t[a]);t=s}return new this.resolvedType.clazz(t)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+t+" (undefined type "+this.type+")")},d.calculateLength=function(t,n){if(null===n)return 0;var r;switch(this.type){case e.TYPES.int32:return n<0?P.calculateVarint64(n):P.calculateVarint32(n);case e.TYPES.uint32:return P.calculateVarint32(n);case e.TYPES.sint32:return P.calculateVarint32(P.zigZagEncode32(n));case e.TYPES.fixed32:case e.TYPES.sfixed32:case e.TYPES.float:return 4;case e.TYPES.int64:case e.TYPES.uint64:return P.calculateVarint64(n);case e.TYPES.sint64:return P.calculateVarint64(P.zigZagEncode64(n));case e.TYPES.fixed64:case e.TYPES.sfixed64:return 8;case e.TYPES.bool:return 1;case e.TYPES.enum:return P.calculateVarint32(n);case e.TYPES.double:return 8;case e.TYPES.string:return r=P.calculateUTF8Bytes(n),P.calculateVarint32(r)+r;case e.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");return P.calculateVarint32(n.remaining())+n.remaining();case e.TYPES.message:return r=this.resolvedType.calculate(n),P.calculateVarint32(r)+r;case e.TYPES.group:return(r=this.resolvedType.calculate(n))+P.calculateVarint32(t<<3|e.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")},d.encodeValue=function(t,n,r){if(null===n)return r;switch(this.type){case e.TYPES.int32:n<0?r.writeVarint64(n):r.writeVarint32(n);break;case e.TYPES.uint32:r.writeVarint32(n);break;case e.TYPES.sint32:r.writeVarint32ZigZag(n);break;case e.TYPES.fixed32:r.writeUint32(n);break;case e.TYPES.sfixed32:r.writeInt32(n);break;case e.TYPES.int64:case e.TYPES.uint64:r.writeVarint64(n);break;case e.TYPES.sint64:r.writeVarint64ZigZag(n);break;case e.TYPES.fixed64:r.writeUint64(n);break;case e.TYPES.sfixed64:r.writeInt64(n);break;case e.TYPES.bool:"string"==typeof n?r.writeVarint32("false"===n.toLowerCase()?0:!!n):r.writeVarint32(n?1:0);break;case e.TYPES.enum:r.writeVarint32(n);break;case e.TYPES.float:r.writeFloat32(n);break;case e.TYPES.double:r.writeFloat64(n);break;case e.TYPES.string:r.writeVString(n);break;case e.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");var i=n.offset;r.writeVarint32(n.remaining()),r.append(n),n.offset=i;break;case e.TYPES.message:i=(new P).LE(),this.resolvedType.encode(n,i),r.writeVarint32(i.offset),r.append(i.flip());break;case e.TYPES.group:this.resolvedType.encode(n,r),r.writeVarint32(t<<3|e.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")}return r},d.decode=function(t,n,r){if(n!=this.type.wireType)throw Error("Unexpected wire type for element");var i,o;switch(this.type){case e.TYPES.int32:return 0|t.readVarint32();case e.TYPES.uint32:return t.readVarint32()>>>0;case e.TYPES.sint32:return 0|t.readVarint32ZigZag();case e.TYPES.fixed32:return t.readUint32()>>>0;case e.TYPES.sfixed32:return 0|t.readInt32();case e.TYPES.int64:return t.readVarint64();case e.TYPES.uint64:return t.readVarint64().toUnsigned();case e.TYPES.sint64:return t.readVarint64ZigZag();case e.TYPES.fixed64:return t.readUint64();case e.TYPES.sfixed64:return t.readInt64();case e.TYPES.bool:return!!t.readVarint32();case e.TYPES.enum:return t.readVarint32();case e.TYPES.float:return t.readFloat();case e.TYPES.double:return t.readDouble();case e.TYPES.string:return t.readVString();case e.TYPES.bytes:if(o=t.readVarint32(),t.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+t.remaining());return(i=t.clone()).limit=i.offset+o,t.offset+=o,i;case e.TYPES.message:return o=t.readVarint32(),this.resolvedType.decode(t,o);case e.TYPES.group:return this.resolvedType.decode(t,-1,r)}throw Error("[INTERNAL] Illegal decode type")},d.valueFromString=function(t){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:case e.TYPES.uint32:case e.TYPES.fixed32:return this.verifyValue((0,s.default)(t));case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:case e.TYPES.uint64:case e.TYPES.fixed64:return this.verifyValue(t);case e.TYPES.bool:return"true"===t;case e.TYPES.string:return this.verifyValue(t);case e.TYPES.bytes:return P.fromBinary(t)}},d.valueToString=function(t){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===e.TYPES.bytes?t.toString("binary"):t.toString()},t.Element=u;var g=function(e,t,n,i,o,a){r.call(this,e,t,n,i,a),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!o,this._fields=null,this._fieldsById=null,this._fieldsByName=null};function m(t,n){var r=n.readVarint32(),i=7&r,o=r>>>3;switch(i){case e.WIRE_TYPES.VARINT:for(;128==(128&(r=n.readUint8())););break;case e.WIRE_TYPES.BITS64:n.offset+=8;break;case e.WIRE_TYPES.LDELIM:r=n.readVarint32(),n.offset+=r;break;case e.WIRE_TYPES.STARTGROUP:m(o,n);break;case e.WIRE_TYPES.ENDGROUP:if(o===t)return!1;throw Error("Illegal GROUPEND after unknown group: "+o+" ("+t+" expected)");case e.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+t+": "+i)}return!0}(d=g.prototype=(0,c.default)(r.prototype)).build=function(t){if(this.clazz&&!t)return this.clazz;var n=function(e,t){var n=t.getChildren(e.Reflect.Message.Field),r=t.getChildren(e.Reflect.Message.OneOf),i=function i(a,s){e.Builder.Message.call(this);for(var u,c=0,h=r.length;c<h;++c)this[r[c].name]=null;for(c=0,h=n.length;c<h;++c){var f=n[c];this[f.name]=f.repeated?[]:f.map?new e.Map(f):null,!f.required&&"proto3"!==t.syntax||null===f.defaultValue||(this[f.name]=f.defaultValue)}if(0<arguments.length)if(1!==arguments.length||null===a||"object"!==(0,o.default)(a)||!("function"!=typeof a.encode||a instanceof i)||(0,l.default)(a)||a instanceof e.Map||P.isByteBuffer(a)||a instanceof ArrayBuffer||e.Long&&a instanceof e.Long)for(c=0,h=arguments.length;c<h;++c)void 0!==(u=arguments[c])&&this.$set(n[c].name,u);else this.$set(a)},s=i.prototype=(0,c.default)(e.Builder.Message.prototype);s.add=function(n,r,i){var o=t._fieldsByName[n];if(!i){if(!o)throw Error(this+"#"+n+" is undefined");if(!(o instanceof e.Reflect.Message.Field))throw Error(this+"#"+n+" is not a field: "+o.toString(!0));if(!o.repeated)throw Error(this+"#"+n+" is not a repeated field");r=o.verifyValue(r,!0)}return null===this[n]&&(this[n]=[]),this[n].push(r),this},s.$add=s.add,s.set=function(n,r,i){if(n&&"object"===(0,o.default)(n)){for(var a in i=r,n)n.hasOwnProperty(a)&&void 0!==(r=n[a])&&this.$set(a,r,i);return this}var s,u=t._fieldsByName[n];if(i)this[n]=r;else{if(!u)throw Error(this+"#"+n+" is not a field: undefined");if(!(u instanceof e.Reflect.Message.Field))throw Error(this+"#"+n+" is not a field: "+u.toString(!0));this[u.name]=r=u.verifyValue(r)}return u&&u.oneof&&(s=this[u.oneof.name],null!==r?(null!==s&&s!==u.name&&(this[s]=null),this[u.oneof.name]=u.name):s===n&&(this[u.oneof.name]=null)),this},s.$set=s.set,s.get=function(n,r){if(r)return this[n];if(!((r=t._fieldsByName[n])&&r instanceof e.Reflect.Message.Field))throw Error(this+"#"+n+" is not a field: undefined");if(!(r instanceof e.Reflect.Message.Field))throw Error(this+"#"+n+" is not a field: "+r.toString(!0));return this[r.name]},s.$get=s.get;for(var u=0;u<n.length;u++){var h=n[u];h instanceof e.Reflect.Message.ExtensionField||t.builder.options.populateAccessors&&function(e){var n=(n=e.originalName.replace(/(_[a-zA-Z])/g,(function(e){return e.toUpperCase().replace("_","")}))).substring(0,1).toUpperCase()+n.substring(1),r=e.originalName.replace(/([A-Z])/g,(function(e){return"_"+e})),i=function(t,n){return this[e.name]=n?t:e.verifyValue(t),this},o=function(){return this[e.name]};null===t.getChild("set"+n)&&(s["set"+n]=i),null===t.getChild("set_"+r)&&(s["set_"+r]=i),null===t.getChild("get"+n)&&(s["get"+n]=o),null===t.getChild("get_"+r)&&(s["get_"+r]=o)}(h)}function d(t,n,r,i){if(null===t||"object"!==(0,o.default)(t)){if(i&&i instanceof e.Reflect.Enum){var a=e.Reflect.Enum.getName(i.object,t);if(null!==a)return a}return t}if(P.isByteBuffer(t))return n?t.toBase64():t.toBuffer();if(e.Long.isLong(t))return r?t.toString():e.Long.fromValue(t);var s;if((0,l.default)(t))return s=[],t.forEach((function(e,t){s[t]=d(e,n,r,i)})),s;if(s={},t instanceof e.Map){for(var u=t.entries(),c=u.next();!c.done;c=u.next())s[t.keyElem.valueToString(c.value[0])]=d(c.value[1],n,r,t.valueElem.resolvedType);return s}var h,f=t.$type,p=void 0;for(h in t)t.hasOwnProperty(h)&&(f&&(p=f.getChild(h))?s[h]=d(t[h],n,r,p.resolvedType):s[h]=d(t[h],n,r));return s}return s.encode=function(e,n){"boolean"==typeof e&&(n=e,e=void 0);var r=!1;e||(e=new P,r=!0);var i=e.littleEndian;try{return t.encode(this,e.LE(),n),(r?e.flip():e).LE(i)}catch(n){throw e.LE(i),n}},i.encode=function(e,t,n){return new i(e).encode(t,n)},s.calculate=function(){return t.calculate(this)},s.encodeDelimited=function(e,n){var r=!1;e||(e=new P,r=!0);var i=(new P).LE();return t.encode(this,i,n).flip(),e.writeVarint32(i.remaining()),e.append(i),r?e.flip():e},s.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},s.toArrayBuffer=s.encodeAB,s.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},s.toBuffer=s.encodeNB,s.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},s.toBase64=s.encode64,s.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},s.toHex=s.encodeHex,s.toRaw=function(e,t){return d(this,!!e,!!t,this.$type)},s.encodeJSON=function(){return(0,f.default)(d(this,!0,!0,this.$type))},i.decode=function(e,n,r){"string"==typeof n&&(r=n,n=-1),"string"==typeof e&&(e=P.wrap(e,r||"base64")),r=(e=P.isByteBuffer(e)?e:P.wrap(e)).littleEndian;try{var i=t.decode(e.LE());return e.LE(r),i}catch(n){throw e.LE(r),n}},i.decodeDelimited=function(e,n){if("string"==typeof e&&(e=P.wrap(e,n||"base64")),(e=P.isByteBuffer(e)?e:P.wrap(e)).remaining()<1)return null;var r=e.offset;if(n=e.readVarint32(),e.remaining()<n)return e.offset=r,null;try{var i=t.decode(e.slice(e.offset,e.offset+n).LE());return e.offset+=n,i}catch(r){throw e.offset+=n,r}},i.decode64=function(e){return i.decode(e,"base64")},i.decodeHex=function(e){return i.decode(e,"hex")},i.decodeJSON=function(e){return new i(JSON.parse(e))},s.toString=function(){return t.toString()},a.default&&((0,a.default)(i,"$options",{value:t.buildOpt()}),(0,a.default)(s,"$options",{value:i.$options}),(0,a.default)(i,"$type",{value:t}),(0,a.default)(s,"$type",{value:t})),i}(e,this);this._fields=[],this._fieldsById={},this._fieldsByName={};for(var r,i=0,s=this.children.length;i<s;i++)if((r=this.children[i])instanceof y||r instanceof g||r instanceof x){if(n.hasOwnProperty(r.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+r.toString(!0)+" cannot override static property '"+r.name+"'");n[r.name]=r.build()}else if(r instanceof g.Field)r.build(),this._fields.push(r),this._fieldsById[r.id]=r,this._fieldsByName[r.name]=r;else if(!(r instanceof g.OneOf||r instanceof _))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[i].toString(!0));return this.clazz=n},d.encode=function(e,t,n){for(var r,i,o=null,a=0,s=this._fields.length;a<s;++a)i=e[(r=this._fields[a]).name],r.required&&null===i?null===o&&(o=r):r.encode(n?i:r.verifyValue(i),t,e);if(null===o)return t;var u=Error("Missing at least one required field for "+this.toString(!0)+": "+o);throw u.encoded=t,u},d.calculate=function(e){for(var t,n,r=0,i=0,o=this._fields.length;i<o;++i){if(n=e[(t=this._fields[i]).name],t.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);r+=t.calculate(n,e)}return r},d.decode=function(t,n,r){n="number"==typeof n?n:-1;for(var i,o,a,s,u,l=t.offset,c=new this.clazz;t.offset<l+n||-1===n&&0<t.remaining();){if(a=(i=t.readVarint32())>>>3,(o=7&i)===e.WIRE_TYPES.ENDGROUP){if(a!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(r?r+" expected":"not a group")+")");break}if(s=this._fieldsById[a])s.repeated&&!s.options.packed?c[s.name].push(s.decode(o,t)):s.map?(u=s.decode(o,t),c[s.name].set(u[0],u[1])):(c[s.name]=s.decode(o,t),s.oneof&&(null!==(u=c[s.oneof.name])&&u!==s.name&&(c[u]=null),c[s.oneof.name]=s.name));else switch(o){case e.WIRE_TYPES.VARINT:t.readVarint32();break;case e.WIRE_TYPES.BITS32:t.offset+=4;break;case e.WIRE_TYPES.BITS64:t.offset+=8;break;case e.WIRE_TYPES.LDELIM:var h=t.readVarint32();t.offset+=h;break;case e.WIRE_TYPES.STARTGROUP:for(;m(a,t););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+o)}}for(var f=0,d=this._fields.length;f<d;++f)if(null===c[(s=this._fields[f]).name])if("proto3"===this.syntax)c[s.name]=s.defaultValue;else{if(s.required){var p=Error("Missing at least one required field for "+this.toString(!0)+": "+s.name);throw p.decoded=c,p}e.populateDefaults&&null!==s.defaultValue&&(c[s.name]=s.defaultValue)}return c},t.Message=g;var v=function(t,r,i,o,a,s,u,l,c,h){n.call(this,t,r,s),this.className="Message.Field",this.required="required"===i,this.repeated="repeated"===i,this.map="map"===i,this.keyType=o||null,this.type=a,this.resolvedType=null,this.id=u,this.options=l||{},this.defaultValue=null,this.oneof=c||null,this.syntax=h||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof g.ExtensionField||(this.name=e.Util.toCamelCase(this.name))};(d=v.prototype=(0,c.default)(n.prototype)).build=function(){this.element=new u(this.type,this.resolvedType,!1,this.syntax),this.map&&(this.keyElement=new u(this.keyType,void 0,!0,this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=u.defaultFieldValue(this.type)},d.verifyValue=function(t,n){n=n||!1;var r=this;function i(e,t){throw Error("Illegal value for "+r.toString(!0)+" of type "+r.type.name+": "+e+" ("+t+")")}if(null===t)return this.required&&i((0,o.default)(t),"required"),"proto3"===this.syntax&&this.type!==e.TYPES.message&&i((0,o.default)(t),"proto3 field without field presence cannot be null"),null;if(!this.repeated||n)return this.map&&!n?t instanceof e.Map?t:(t instanceof Object||i((0,o.default)(t),"expected ProtoBuf.Map or raw object for map field"),new e.Map(this,t)):(!this.repeated&&(0,l.default)(t)&&i((0,o.default)(t),"no array expected"),this.element.verifyValue(t));(0,l.default)(t)||(t=[t]);for(var a=[],s=0;s<t.length;s++)a.push(this.element.verifyValue(t[s]));return a},d.hasWirePresence=function(t,n){if("proto3"!==this.syntax)return null!==t;if(this.oneof&&n[this.oneof.name]===this.name)return!0;switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:case e.TYPES.uint32:case e.TYPES.fixed32:return 0!==t;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:case e.TYPES.uint64:case e.TYPES.fixed64:return 0!==t.low||0!==t.high;case e.TYPES.bool:return t;case e.TYPES.float:case e.TYPES.double:return 0!==t;case e.TYPES.string:return 0<t.length;case e.TYPES.bytes:return 0<t.remaining();case e.TYPES.enum:return 0!==t;case e.TYPES.message:return null!==t;default:return!0}},d.encode=function(t,n,r){if(null===this.type||"object"!==(0,o.default)(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===t||this.repeated&&0==t.length)return n;try{if(this.repeated)if(this.options.packed&&0<=e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)){n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.ensureCapacity(n.offset+=1);for(var i=n.offset,a=0;a<t.length;a++)this.element.encodeValue(this.id,t[a],n);var s,u=n.offset-i,l=P.calculateVarint32(u);1<l&&(s=n.slice(i,n.offset),i+=l-1,n.offset=i,n.append(s)),n.writeVarint32(u,i-l)}else for(a=0;a<t.length;a++)n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,t[a],n);else this.map?t.forEach((function(t,r,i){var o=P.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,r)+P.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,t);n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.writeVarint32(o),n.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,r,n),n.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,t,n)}),this):this.hasWirePresence(t,r)&&(n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,t,n))}catch(r){throw Error("Illegal value for "+this.toString(!0)+": "+t+" ("+r+")")}return n},d.calculate=function(t,n){if(t=this.verifyValue(t),null===this.type||"object"!==(0,o.default)(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===t||this.repeated&&0==t.length)return 0;var r,i,a=0;try{if(this.repeated)if(this.options.packed&&0<=e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)){for(a+=P.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),i=0,r=0;r<t.length;r++)i+=this.element.calculateLength(this.id,t[r]);a+=P.calculateVarint32(i),a+=i}else for(r=0;r<t.length;r++)a+=P.calculateVarint32(this.id<<3|this.type.wireType),a+=this.element.calculateLength(this.id,t[r]);else this.map?t.forEach((function(t,n,r){t=P.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,n)+P.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,t),a+=P.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),a+=P.calculateVarint32(t),a+=t}),this):this.hasWirePresence(t,n)&&(a+=P.calculateVarint32(this.id<<3|this.type.wireType),a+=this.element.calculateLength(this.id,t))}catch(n){throw Error("Illegal value for "+this.toString(!0)+": "+t+" ("+n+")")}return a},d.decode=function(t,n,r){if(!(!this.map&&t==this.type.wireType||!r&&this.repeated&&this.options.packed&&t==e.WIRE_TYPES.LDELIM||this.map&&t==e.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+t+" ("+this.type.wireType+" expected)");if(t==e.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&0<=e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)&&!r){for(var i=n.readVarint32(),o=(i=n.offset+i,[]);n.offset<i;)o.push(this.decode(this.type.wireType,n,!0));return o}if(this.map){var a=u.defaultFieldValue(this.keyType),s=u.defaultFieldValue(this.type);if(i=n.readVarint32(),n.remaining()<i)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+i+" required but got only "+n.remaining());var l=n.clone();for(l.limit=l.offset+i,n.offset+=i;0<l.remaining();){var c=l.readVarint32();if(t=7&c,1==(c>>>=3))a=this.keyElement.decode(l,t,c);else{if(2!==c)throw Error("Unexpected tag in map field key/value submessage");s=this.element.decode(l,t,c)}}return[a,s]}return this.element.decode(n,t,this.id)},t.Message.Field=v,d=function(e){function t(t,n,r,i,o,a,s){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,r,i,o,a){v.call(this,e,t,n,null,r,i,o,a),this.extension})),d.prototype=(0,c.default)(v.prototype),t.Message.ExtensionField=d,d=function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,r){n.call(this,e,t,r),this.fields=[]})),t.Message.OneOf=d;var y=function(e,t,n,i,o){r.call(this,e,t,n,i,o),this.className="Enum",this.object=null};y.getName=function(e,t){for(var n,r=(0,h.default)(e),i=0;i<r.length;++i)if(e[n=r[i]]===t)return n;return null},(d=y.prototype=(0,c.default)(r.prototype)).build=function(t){if(this.object&&!t)return this.object;for(var n=new e.Builder.Enum,r=this.getChildren(y.Value),i=0,o=r.length;i<o;++i)n[r[i].name]=r[i].id;return a.default&&(0,a.default)(n,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=n},t.Enum=y,d=function(e){function t(t,n,r,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,r,i){n.call(this,e,t,r),this.className="Enum.Value",this.id=i})),d.prototype=(0,c.default)(n.prototype),t.Enum.Value=d;var _=function(e,t,r,i){n.call(this,e,t,r),this.field=i};_.prototype=(0,c.default)(n.prototype),t.Extension=_;var x=function(e,t,n,i){r.call(this,e,t,n,i),this.className="Service",this.clazz=null};(d=x.prototype=(0,c.default)(r.prototype)).build=function(t){return this.clazz&&!t?this.clazz:this.clazz=function(e,t){for(var n=function(t){e.Builder.Service.call(this),this.rpcImpl=t||function(e,t,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},r=n.prototype=(0,c.default)(e.Builder.Service.prototype),i=t.getChildren(e.Reflect.Service.RPCMethod),s=0;s<i.length;s++)!function(e){r[e.name]=function(n,r){try{try{n=e.resolvedRequestType.clazz.decode(P.wrap(n))}catch(n){if(!(n instanceof TypeError))throw n}if(null===n||"object"!==(0,o.default)(n))throw Error("Illegal arguments");n instanceof e.resolvedRequestType.clazz||(n=new e.resolvedRequestType.clazz(n)),this.rpcImpl(e.fqn(),n,(function(n,i){if(n)r(n);else{null===i&&(i="");try{i=e.resolvedResponseType.clazz.decode(i)}catch(n){}i&&i instanceof e.resolvedResponseType.clazz?r(null,i):r(Error("Illegal response type received in service method "+t.name+"#"+e.name))}}))}catch(n){setTimeout(r.bind(this,n),0)}},n[e.name]=function(t,r,i){new n(t)[e.name](r,i)},a.default&&((0,a.default)(n[e.name],"$options",{value:e.buildOpt()}),(0,a.default)(r[e.name],"$options",{value:n[e.name].$options}))}(i[s]);return a.default&&((0,a.default)(n,"$options",{value:t.buildOpt()}),(0,a.default)(r,"$options",{value:n.$options}),(0,a.default)(n,"$type",{value:t}),(0,a.default)(r,"$type",{value:t})),n}(e,this)},t.Service=x;var A=function(e,t,r,i){n.call(this,e,t,r),this.className="Service.Method",this.options=i||{}};return(d=A.prototype=(0,c.default)(n.prototype)).buildOpt=i.buildOpt,t.Service.Method=A,i=function(e,t,n,r,i,o,a,s){A.call(this,e,t,n,s),this.className="Service.RPCMethod",this.requestName=r,this.responseName=i,this.requestStream=o,this.responseStream=a,this.resolvedRequestType=null,this.resolvedResponseType=null},i.prototype=(0,c.default)(A.prototype),t.Service.RPCMethod=i,t}(K),K.Builder=(Y=K,q=K.Lang,X=K.Reflect,Z=function(e){this.ns=new X.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},i=Z.prototype,Z.isMessage=function(e){return"string"==typeof e.name&&void 0===e.values&&void 0===e.rpc},Z.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&void 0!==e.id},Z.isEnum=function(e){return"string"==typeof e.name&&!(void 0===e.values||!(0,l.default)(e.values)||0===e.values.length)},Z.isService=function(e){return!("string"!=typeof e.name||"object"!==(0,o.default)(e.rpc)||!e.rpc)},Z.isExtend=function(e){return"string"==typeof e.ref},i.reset=function(){return this.ptr=this.ns,this},i.define=function(e){if("string"!=typeof e||!q.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach((function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new X.Namespace(this,this.ptr,e)),this.ptr=t}),this),this},i.create=function(e){if(!e)return this;if((0,l.default)(e)){if(0===e.length)return this;e=e.slice()}else e=[e];for(var t=[e];0<t.length;){if(e=t.pop(),!(0,l.default)(e))throw Error("not a valid namespace: "+(0,f.default)(e));for(;0<e.length;){var n=e.shift();if(Z.isMessage(n)){var r=new X.Message(this,this.ptr,n.name,n.options,n.isGroup,n.syntax),i={};n.oneofs&&(0,h.default)(n.oneofs).forEach((function(e){r.addChild(i[e]=new X.Message.OneOf(this,r,e))}),this),n.fields&&n.fields.forEach((function(e){if(null!==r.getChild(0|e.id))throw Error("duplicate or invalid field id in "+r.name+": "+e.id);if(e.options&&"object"!==(0,o.default)(e.options))throw Error("illegal field options in "+r.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=i[e.oneof]))throw Error("illegal oneof in "+r.name+"#"+e.name+": "+e.oneof);e=new X.Message.Field(this,r,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,n.syntax),t&&t.fields.push(e),r.addChild(e)}),this);var a=[];if(n.enums&&n.enums.forEach((function(e){a.push(e)})),n.messages&&n.messages.forEach((function(e){a.push(e)})),n.services&&n.services.forEach((function(e){a.push(e)})),n.extensions&&("number"==typeof n.extensions[0]?r.extensions=[n.extensions]:r.extensions=n.extensions),this.ptr.addChild(r),0<a.length){t.push(e),e=a,a=null,this.ptr=r,r=null;continue}a=null}else if(Z.isEnum(n))r=new X.Enum(this,this.ptr,n.name,n.options,n.syntax),n.values.forEach((function(e){r.addChild(new X.Enum.Value(this,r,e.name,e.id))}),this),this.ptr.addChild(r);else if(Z.isService(n))r=new X.Service(this,this.ptr,n.name,n.options),(0,h.default)(n.rpc).forEach((function(e){var t=n.rpc[e];r.addChild(new X.Service.RPCMethod(this,r,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))}),this),this.ptr.addChild(r);else{if(!Z.isExtend(n))throw Error("not a valid definition: "+(0,f.default)(n));if(r=this.ptr.resolve(n.ref,!0))n.fields.forEach((function(e){if(null!==r.getChild(0|e.id))throw Error("duplicate extended field id in "+r.name+": "+e.id);if(r.extensions){var t=!1;if(r.extensions.forEach((function(n){e.id>=n[0]&&e.id<=n[1]&&(t=!0)})),!t)throw Error("illegal extended field id in "+r.name+": "+e.id+" (not within valid ranges)")}var n=e.name;this.options.convertFieldsToCamelCase&&(n=Y.Util.toCamelCase(n));var i=new X.Message.ExtensionField(this,r,e.rule,e.type,this.ptr.fqn()+"."+n,e.id,e.options);n=new X.Extension(this,this.ptr,e.name,i),i.extension=n,this.ptr.addChild(n),r.addChild(i)}),this);else if(!/\.?google\.protobuf\./.test(n.ref))throw Error("extended message "+n.ref+" is not defined")}n=null,r=null}e=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},i.import=function(e,t){var r="/";if("string"==typeof t){if(Y.Util.IS_NODE&&(t=n(146).resolve(t)),!0===this.files[t])return this.reset();this.files[t]=!0}else if("object"===(0,o.default)(t)){var i=t.root;if(Y.Util.IS_NODE&&(i=n(146).resolve(i)),(0<=i.indexOf("\\")||0<=t.file.indexOf("\\"))&&(r="\\"),i=i+r+t.file,!0===this.files[i])return this.reset();this.files[i]=!0}if(e.imports&&0<e.imports.length){var a;i=!1,"object"===(0,o.default)(t)?(this.importRoot=t.root,i=!0,a=this.importRoot,t=t.file,(0<=a.indexOf("\\")||0<=t.indexOf("\\"))&&(r="\\")):"string"==typeof t?this.importRoot?a=this.importRoot:0<=t.indexOf("/")?""===(a=t.replace(/\/[^\/]*$/,""))&&(a="/"):0<=t.indexOf("\\")?(a=t.replace(/\\[^\\]*$/,""),r="\\"):a=".":a=null;for(var s=0;s<e.imports.length;s++)if("string"==typeof e.imports[s]){if(!a)throw Error("cannot determine import root");var u=e.imports[s];if("google/protobuf/descriptor.proto"!==u&&(u=a+r+u,!0!==this.files[u])){/\.proto$/i.test(u)&&!Y.DotProto&&(u=u.replace(/\.proto$/,".json"));var l=Y.Util.fetch(u);if(null===l)throw Error("failed to import '"+u+"' in '"+t+"': file not found");/\.json$/i.test(u)?this.import(JSON.parse(l+""),u):this.import(Y.DotProto.Parser.parse(l),u)}}else t?/\.(\w+)$/.test(t)?this.import(e.imports[s],t.replace(/^(.+)\.(\w+)$/,(function(e,t,n){return t+"_import"+s+"."+n}))):this.import(e.imports[s],t+"_import"+s):this.import(e.imports[s]);i&&(this.importRoot=null)}e.package&&this.define(e.package),e.syntax&&Q(e);var c=this.ptr;return e.options&&(0,h.default)(e.options).forEach((function(t){c.options[t]=e.options[t]})),e.messages&&(this.create(e.messages),this.ptr=c),e.enums&&(this.create(e.enums),this.ptr=c),e.services&&(this.create(e.services),this.ptr=c),e.extends&&this.create(e.extends),this.reset()},i.resolveAll=function(){var e;if(null==this.ptr||"object"===(0,o.default)(this.ptr.type))return this;if(this.ptr instanceof X.Namespace)this.ptr.children.forEach((function(e){this.ptr=e,this.resolveAll()}),this);else if(this.ptr instanceof X.Message.Field){if(q.TYPE.test(this.ptr.type))this.ptr.type=Y.TYPES[this.ptr.type];else{if(!q.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(e=(this.ptr instanceof X.Message.ExtensionField?this.ptr.extension:this.ptr).parent.resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=e,e instanceof X.Enum){if(this.ptr.type=Y.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==e.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(e instanceof X.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=e.isGroup?Y.TYPES.group:Y.TYPES.message}}if(this.ptr.map){if(!q.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=Y.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof Y.Reflect.Service.Method){if(!(this.ptr instanceof Y.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((e=this.ptr.parent.resolve(this.ptr.requestName,!0))&&e instanceof Y.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=e,!((e=this.ptr.parent.resolve(this.ptr.responseName,!0))&&e instanceof Y.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=e}else if(!(this.ptr instanceof Y.Reflect.Message.OneOf||this.ptr instanceof Y.Reflect.Extension||this.ptr instanceof Y.Reflect.Enum.Value))throw Error("illegal object in namespace: "+(0,o.default)(this.ptr)+": "+this.ptr);return this.reset()},i.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(var t="string"==typeof e?e.split("."):e,n=this.result,r=0;r<t.length;r++){if(!n[t[r]]){n=null;break}n=n[t[r]]}return n},i.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},i.toString=function(){return"Builder"},Z.Message=function(){},Z.Enum=function(){},Z.Service=function(){},Z),K.Map=(J=K.Reflect,e=function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new J.Element(e.keyType,null,!0,e.syntax),this.valueElem=new J.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},(0,a.default)(this,"size",{get:function(){return(0,h.default)(this.map).length}}),t)for(var n=(0,h.default)(t),r=0;r<n.length;r++){var i=this.keyElem.valueFromString(n[r]),o=this.valueElem.verifyValue(t[n[r]]);this.map[this.keyElem.valueToString(i)]={key:i,value:o}}})),(i=e.prototype).clear=function(){this.map={}},i.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));return e=t in this.map,delete this.map[t],e},i.entries=function(){for(var e,t=[],n=(0,h.default)(this.map),r=0;r<n.length;r++)t.push([(e=this.map[n[r]]).key,e.value]);return $(t)},i.keys=function(){for(var e=[],t=(0,h.default)(this.map),n=0;n<t.length;n++)e.push(this.map[t[n]].key);return $(e)},i.values=function(){for(var e=[],t=(0,h.default)(this.map),n=0;n<t.length;n++)e.push(this.map[t[n]].value);return $(e)},i.forEach=function(e,t){for(var n,r=(0,h.default)(this.map),i=0;i<r.length;i++)e.call(t,(n=this.map[r[i]]).value,n.key,this)},i.set=function(e,t){return e=this.keyElem.verifyValue(e),t=this.valueElem.verifyValue(t),this.map[this.keyElem.valueToString(e)]={key:e,value:t},this},i.get=function(e){if((e=this.keyElem.valueToString(this.keyElem.verifyValue(e)))in this.map)return this.map[e].value},i.has=function(e){return(e=this.keyElem.valueToString(this.keyElem.verifyValue(e)))in this.map},e),K.loadProto=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=void 0),K.loadJson(K.DotProto.Parser.parse(e),t,n)},K.protoFromString=K.loadProto,K.loadProtoFile=function(e,t,n){if(t&&"object"===(0,o.default)(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return K.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,K.loadProto(r,n,e))}catch(r){t(r)}else t(Error("Failed to fetch file"))}));var r=K.Util.fetch("object"===(0,o.default)(e)?e.root+"/"+e.file:e);return null===r?null:K.loadProto(r,n,e)},K.protoFromFile=K.loadProtoFile,K.newBuilder=function(e){return void 0===(e=e||{}).convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=K.convertFieldsToCamelCase),void 0===e.populateAccessors&&(e.populateAccessors=K.populateAccessors),new K.Builder(e)},K.loadJson=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),t&&"object"===(0,o.default)(t)||(t=K.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t.import(e,n),t.resolveAll(),t},K.loadJsonFile=function(e,t,n){if(t&&"object"===(0,o.default)(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return K.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,K.loadJson(JSON.parse(r),n,e))}catch(r){t(r)}else t(Error("Failed to fetch file"))}));var r=K.Util.fetch("object"===(0,o.default)(e)?e.root+"/"+e.file:e);return null===r?null:K.loadJson(JSON.parse(r),n,e)}}).call(this,n(35))},function(e,t,n){"use strict";var r=n(33),i=n(42),o=n(10);e.exports=function(e){for(var t,n=r(this),a=o(n.length),s=i(1<(t=arguments.length)?arguments[1]:void 0,a),u=void 0===(t=2<t?arguments[2]:void 0)?a:i(t,a);s<u;)n[s++]=e;return n}},function(e,t,n){var r=n(15).f,i=n(25),o=n(4)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";var r=n(145),i=n(253),o=n(36),a=n(57);e.exports=n(254)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r="object"==("undefined"==typeof Reflect?"undefined":u(Reflect))?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},o=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}y(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&y(e,"error",t,{once:!0})}(e,i)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+u(e))}function h(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function f(e,t,n,r){var i,o;return c(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener||n),i=e._events),o=i[t]),void 0===o?(o=i[t]=n,++e._eventsCount):("function"==typeof o?o=i[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),0<(n=h(e))&&o.length>n&&!o.warned&&(o.warned=!0,(n=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=e,n.type=t,n.count=o.length,function(e){console&&console.warn&&console.warn(e)}(n))),e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){return e={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},(t=d.bind(e)).listener=n,e.wrapFn=t,t}function g(e,t,n){return void 0===(e=e._events)||void 0===(t=e[t])?[]:"function"==typeof t?n?[t.listener||t]:[t]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):v(t,t.length)}function m(e){var t=this._events;if(void 0!==t){if("function"==typeof(e=t[e]))return 1;if(void 0!==e)return e.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+u(e));e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return h(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r,o="error"===e,a=this._events;if(void 0!==a)o=o&&void 0===a.error;else if(!o)return!1;if(o){if(0<t.length&&(r=t[0]),r instanceof Error)throw r;throw(o=new Error("Unhandled error."+(r?" ("+r.message+")":""))).context=r,o}if(void 0===(e=a[e]))return!1;if("function"==typeof e)i(e,this,t);else{var s=e.length,u=v(e,s);for(n=0;n<s;++n)i(u[n],this,t)}return!0},s.prototype.addListener=function(e,t){return f(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return f(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,o,a;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;0<=o;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n=this._events;if(void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;0<=o;o--)this.removeListener(e,t[o]);return this},s.prototype.listeners=function(e){return g(this,e,!0)},s.prototype.rawListeners=function(e){return g(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return 0<this._eventsCount?o(this._events):[]}},function(e,t,n){(t=e.exports=n(147)).Stream=t,t.Readable=t,t.Writable=n(96),t.Duplex=n(27),t.Transform=n(151),t.PassThrough=n(282)},function(e,t,n){var r=n(95),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=a),o(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");return e=i(e),void 0!==t?"string"==typeof n?e.fill(t,n):e.fill(t):e.fill(0),e},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";(function(e){var r=n(272),i=n(273),o=n(274);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"!=typeof e)return l(this,e,t,n);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n);return(n=(e=s(e,r)).write(t,n))!==r&&(e=e.slice(0,n)),e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|d(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?s(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(c(t),e=s(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|d(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return L(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return S(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var o=1,a=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,s/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i)for(var l=-1,c=n;c<a;c++)if(u(e,c)===u(t,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===s)return l*o}else-1!==l&&(c-=c-l),l=-1;else for(a<n+s&&(n=a-s),c=n;0<=c;c--){for(var h=!0,f=0;f<s;f++)if(u(e,c+f)!==u(t,f)){h=!1;break}if(h)return c}return-1}function _(e,t,n,r){n=Number(n)||0;var i=e.length-n;if(r?i<(r=Number(r))&&(r=i):r=i,(i=t.length)%2!=0)throw new TypeError("Invalid hex string");i/2<r&&(r=i/2);for(var o=0;o<r;++o){var a=parseInt(t.substr(2*o,2),16);if(isNaN(a))return o;e[n+o]=a}return o}function x(e,t,n,r){return H(U(t,e.length-n),e,n,r)}function A(e,t,n,r){return H(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function I(e,t,n,r){return A(e,t,n,r)}function w(e,t,n,r){return H(V(t),e,n,r)}function b(e,t,n,r){return H(function(e,t){for(var n,r,i=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,r%=256,i.push(r),i.push(n);return i}(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,u,l=e[i],c=null,h=239<l?4:223<l?3:191<l?2:1;if(i+h<=n)switch(h){case 1:l<128&&(c=l);break;case 2:128==(192&(o=e[i+1]))&&127<(u=(31&l)<<6|63&o)&&(c=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&2047<(u=(15&l)<<12|(63&o)<<6|63&a)&&(u<55296||57343<u)&&(c=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)&&u<1114112&&(c=u)}null===c?(c=65533,h=1):65535<c&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=h}return function(e){var t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=E));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){return+e!=e&&(e=0),u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return l(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0||void 0===n?s(e,t):"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n)}(null,e,t,n)},u.allocUnsafe=function(e){return h(null,e)},u.allocUnsafeSlow=function(e){return h(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;for(var n=u.allocUnsafe(t),r=0,i=0;i<e.length;++i){var a=e[i];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,r),r+=a.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):g.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=t)return 0;if(i<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),l=this.slice(r,i),c=e.slice(t,n),h=0;h<s;++h)if(l[h]!==c[h]){o=l[h],a=c[h];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||i<n)&&(n=i),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var o=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return x(this,e,t,n);case"ascii":return A(this,e,t,n);case"latin1":case"binary":return I(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function S(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function L(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||r<n)&&(n=r);for(var i="",o=t;o<n;++o)i+=z(e[o]);return i}function k(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function R(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function P(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function O(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function D(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,o){return o||D(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,o){return o||D(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=u.prototype;else for(var r=t-e,i=new u(r,void 0),o=0;o<r;++o)i[o]=this[o+e];return i},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e+--t],i=1;0<t&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return(i*=128)<=r&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=t,i=1,o=this[e+--r];0<r&&(i*=256);)o+=this[e+--r]*i;return(i*=128)<=o&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){return t||R(e,2,this.length),32768&(e=this[e]|this[e+1]<<8)?4294901760|e:e},u.prototype.readInt16BE=function(e,t){return t||R(e,2,this.length),32768&(e=this[e+1]|this[e]<<8)?4294901760|e:e},u.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||N(this,e,t,n,r=Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||N(this,e,t,n,r=Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;0<=--i&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):O(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){e=+e,t|=0,r||N(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var i=0,o=1,a=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){e=+e,t|=0,r||N(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var i=n-1,o=1,a=0;for(this[t+i]=255&e;0<=--i&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):O(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),t=t||0,0<r&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;0<=i;--i)e[i+t]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){var i;if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length&&(i=e.charCodeAt(0))<256&&(e=i),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(s=t;s<n;++s)this[s]=e;else for(var o=u.isBuffer(e)?e:U(new u(e,r).toString()),a=o.length,s=0;s<n-t;++s)this[s+t]=o[s%a];return this};var G=/[^+\/0-9A-Za-z-_]/g;function z(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if(55295<(n=e.charCodeAt(a))&&n<57344){if(!i){if(56319<n){-1<(t-=3)&&o.push(239,191,189);continue}if(a+1===r){-1<(t-=3)&&o.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(t-=3)&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(t-=3)&&o.push(239,191,189);if(i=null,n<128){if(--t<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function V(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(G,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(38))},function(e,t,n){"use strict";(function(t,r,i){var o=n(61);function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(undefined),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=m;var s,u=!t.browser&&-1<["v0.10","v0.9."].indexOf(t.version.slice(0,5))?r:o.nextTick;m.WritableState=g,(r=Object.create(n(45))).inherits=n(37);var l,c={deprecate:n(280)},h=n(148),f=n(94).Buffer,d=i.Uint8Array||function(){};function p(){}function g(e,t){s=s||n(27),e=e||{};var r=t instanceof s;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,o=e.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(o||0===o)?o:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,u=!1===e.decodeStrings,this.decodeStrings=!u,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){_(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function m(e){if(s=s||n(27),!(l.call(m,this)||this instanceof s))return new m(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),h.call(this)}function v(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,n)),t}function y(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function _(e,t){var n=e._writableState,r=n.sync,i=n.writecb;(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0})(n),t?function(e,t,n,r,i){--t.pendingcb,n?(o.nextTick(i,r),o.nextTick(b,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),b(e,t))}(e,n,r,t,i):((t=I(n))||n.corked||n.bufferProcessing||!n.bufferedRequest||A(e,n),r?u(x,e,n,t,i):x(e,n,t,i))}function x(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),b(e,t)}function A(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r);(r=t.corkedRequestsFree).entry=n;for(var o=0,s=!0;n;)i[o]=n,n.isBuf||(s=!1),n=n.next,o+=1;i.allBuffers=s,y(e,t,!0,t.length,i,"",r.finish),t.pendingcb++,t.lastBufferedRequest=null,r.next?(t.corkedRequestsFree=r.next,r.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,c=n.callback;if(y(e,t,!1,t.objectMode?1:u.length,u,l,c),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),b(e,t)}))}function b(e,t){var n=I(t);return n&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,o.nextTick(w,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}i=n(149),r.inherits(m,h),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:c.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!l.call(this,e)||this===m&&e&&e._writableState instanceof g}})):l=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,n){var r=this._writableState,i=!1,a=!r.objectMode&&function(e){return f.isBuffer(e)||e instanceof d}(e);return a&&!f.isBuffer(e)&&(e=function(e){return f.from(e)}(e)),"function"==typeof t&&(n=t,t=null),t=a?"buffer":t||r.defaultEncoding,"function"!=typeof n&&(n=p),r.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),o.nextTick(t,n)}(this,n):(a||function(e,t,n,r){var i=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),o.nextTick(r,a),i=!1),i}(this,r,e,n))&&(r.pendingcb++,i=function(e,t,n,r,i,o){n||r!==(s=v(t,r,i))&&(n=!0,i="buffer",r=s);var a=t.objectMode?1:r.length;t.length+=a;var s,u=t.length<t.highWaterMark;return u||(t.needDrain=!0),t.writing||t.corked?(s=t.lastBufferedRequest,t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1):y(e,t,!1,a,r,i,o),u}(this,r,a,e,t,n)),i},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||A(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,b(e,t),n&&(t.finished?o.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,r,n)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=i.destroy,m.prototype._undestroy=i.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(35),n(278).setImmediate,n(38))},function(e,t,n){"use strict";n(0)(t,"__esModule",{value:!0}),t._Math=void 0,n(60),n(87);var r={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(i=e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&r|128]+e[r>>8&255]+"-"+e[r>>16&255]+e[r>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*r.DEG2RAD},radToDeg:function(e){return e*r.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};t._Math=r},function(e,t,n){e.exports=!n(14)&&!n(19)((function(){return 7!=Object.defineProperty(n(99)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(18),i=n(8).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(17),i=n(23),o=n(40);e.exports=n(14)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,u=0;u<s;)r.f(e,n=a[u++],t[n]);return e}},function(e,t,n){var r=n(24),i=n(29),o=n(162)(!1),a=n(67)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=a&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var r=n(65);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(66),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(3),i=n(47),o=n(19),a=n(72),s=(n="["+a+"]",RegExp("^"+n+n+"*")),u=RegExp(n+n+"*$"),l=(n=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()}));t=i[e]=s?t(l):a[e],n&&(i[n]=t),r(r.P+r.F*s,"String",i)},n.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(u,"")),e});e.exports=n},function(e,t,n){e.exports=!n(6)&&!n(7)((function(){return 7!=Object.defineProperty(n(106)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(21),i=n(5).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(56),i=n(109),o=n(33),a=n(10),s=n(178);e.exports=function(e,t){var n=1==e,u=2==e,l=3==e,c=4==e,h=6==e,f=5==e||h,d=t||s;return function(t,s,p){for(var g,m,v=o(t),y=i(v),_=r(s,p,3),x=a(y.length),A=0,I=n?d(t,x):u?d(t,0):void 0;A<x;A++)if((f||A in y)&&(m=_(g=y[A],A,v),e))if(n)I[A]=m;else if(m)switch(e){case 3:return!0;case 5:return g;case 6:return A;case 2:I.push(g)}else if(c)return!1;return h?-1:l||c?c:I}}},function(e,t,n){var r=n(32);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";var r=n(5),i=n(25),o=n(32),a=n(182),s=n(53),u=n(7),l=n(76).f,c=n(75).f,h=n(15).f,f=n(185).trim,d="Number",p=x=r[d],g=x.prototype,m=o(n(79)(g))==d,v="trim"in String.prototype,y=function(e){if("string"==typeof(r=s(e,!1))&&2<r.length){var t,n,r,i=(r=v?r.trim():f(r,3)).charCodeAt(0);if(43===i||45===i){if(88===(e=r.charCodeAt(2))||120===e)return NaN}else if(48===i){switch(r.charCodeAt(1)){case 66:case 98:t=2,n=49;break;case 79:case 111:t=8,n=55;break;default:return+r}for(var o,a=r.slice(2),u=0,l=a.length;u<l;u++)if((o=a.charCodeAt(u))<48||n<o)return NaN;return parseInt(a,t)}}return+r};if(!x(" 0o1")||!x("0b1")||x("+0x1")){for(var _,x=function(e){e=arguments.length<1?0:e;var t=this;return t instanceof x&&(m?u((function(){g.valueOf.call(t)})):o(t)!=d)?a(new p(y(e)),t,x):y(e)},A=n(6)?l(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),I=0;A.length>I;I++)i(p,_=A[I])&&!i(x,_)&&h(x,_,c(p,_));x.prototype=g,g.constructor=x,n(22)(r,d,x)}},function(e,t,n){var r=n(25),i=n(57),o=n(112)(!1),a=n(77)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=a&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var r=n(57),i=n(10),o=n(42);e.exports=function(e){return function(t,n,a){var s,u=r(t),l=i(u.length),c=o(a,l);if(e&&n!=n){for(;c<l;)if((s=u[c++])!=s)return!0}else for(;c<l;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(111),i=n(78);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){n=n(5).document,e.exports=n&&n.documentElement},function(e,t,n){var r=n(20),i=n(7),o=n(34),a=/"/g,s=function(e,t,n,r){var i=String(o(e));return e="<"+t,""!==n&&(e+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),e+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||3<t.split('"').length})),"String",n)}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(190)},function(e,t,n){e.exports=n(193)},function(e,t,n){var r=n(50),i=n(39),o=n(29),a=n(64),s=n(24),u=n(98),l=Object.getOwnPropertyDescriptor;t.f=n(14)?l:function(e,t){if(e=o(e),t=a(t,!0),u)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(121),i=n(125);function o(t){return e.exports=o="function"==typeof r&&"symbol"==u(i)?function(e){return u(e)}:function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":u(e)},e.exports.default=e.exports,e.exports.__esModule=!0,o(t)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(197)},function(e,t,n){e.exports=n(28)},function(e,t,n){var r=n(65);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(101),i=n(69).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){e.exports=n(205)},function(e,t,n){"use strict";var r=n(206)(!0);n(127)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e=this._t,t=this._i;return t>=e.length?{value:void 0,done:!0}:(t=r(e,t),this._i+=t.length,{value:t,done:!1})}))},function(e,t,n){"use strict";var r=n(48),i=n(3),o=n(122),a=n(28),s=n(44),u=n(207),l=n(80),c=n(128),h=n(13)("iterator"),f=!([].keys&&"next"in[].keys()),d="keys",p="values",g=function(){return this};e.exports=function(e,t,n,m,v,y,_){u(n,t,m);var x,A,I=function(e){if(!f&&e in M)return M[e];switch(e){case d:case p:return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",b=v==p,C=!1,M=e.prototype,E=M[h]||M["@@iterator"]||v&&M[v],T=E||I(v),S=v?b?I("entries"):T:void 0;if((m="Array"==t&&M.entries||E)&&(e=c(m.call(new e)))!==Object.prototype&&e.next&&(l(e,w,!0),r||"function"==typeof e[h]||a(e,h,g)),b&&E&&E.name!==p&&(C=!0,T=function(){return E.call(this)}),r&&!_||!f&&!C&&M[h]||a(M,h,T),s[t]=T,s[w]=g,v)if(x={values:b?T:I(p),keys:y?T:I(d),entries:S},_)for(A in x)A in M||o(M,A,x[A]);else i(i.P+i.F*(f||C),t,x);return x}},function(e,t,n){var r=n(24),i=n(31),o=n(67)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var r=n(3),i=n(1),o=n(19);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},function(e,t,n){var r=n(16),i=n(107),o=n(4)("species");e.exports=function(e,t){var n;return void 0===(e=r(e).constructor)||null==(n=r(e)[o])?t:i(n)}},function(e,t,n){"use strict";var r=n(227)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){"use strict";var r=n(59),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){if("object"!=u(n=n.call(e,t)))throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";n(228);var r,i=n(22),o=n(9),a=n(7),s=n(34),u=n(4),l=n(84),c=u("species"),h=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),f=(r=(n=/(?:)/).exec,n.exec=function(){return r.apply(this,arguments)},2===(n="ab".split(n)).length&&"a"===n[0]&&"b"===n[1]);e.exports=function(e,t,n){var r,d,p=u(e),g=!a((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),m=g?!a((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[c]=function(){return n}),n[p](""),!t})):void 0;g&&m&&("replace"!==e||h)&&("split"!==e||f)||(r=/./[p],m=n(s,p,""[e],(function(e,t,n,i,o){return t.exec===l?g&&!o?{done:!0,value:r.call(t,n,i)}:{done:!0,value:e.call(n,t,i)}:{done:!1}})),n=m[0],d=m[1],i(String.prototype,e,n),o(RegExp.prototype,p,2==t?function(e,t){return d.call(e,this,t)}:function(e){return d.call(e,this)}))}},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(51));n(86);var a=i(n(230)),s=i(n(232)),u=new((i=i(n(135))).default),l={check:(n=u.netArea)+"sdk/check",onlineCheck:n+"sdk/auth/web",fmFileServer:n+"sdk/auth/downMaps"},c=(i=function(e,t,n){return!(!e||"string"!=typeof t||32!=t.length||null!=e&&""!=e&&(t=a.default.decryption(t,"026685bf295f587b5dffc1f18d5dc27c"),n=s.default.encryption(n),t=a.default.decryption(t,n),t!=e))},function(e,t,n){return n=n||"fengmap.localhost:",t=s.default.encryption(n+t),a.default.decryption(e,t)}),h=(n=function(){var e,t=((e=new Date).getFullYear(),e.getMonth()+1),n=(e=e.getDate())%2==0?1:-1;return""+Math.max(Math.pow(e%10+ +n,2)+n*t,0)+Math.abs(2*e+n*t)},n(),function(e,t,n){c(e,t);var r=window.location.host,i=r.indexOf(":");return-1<i&&(r=r.slice(0,i)),{webURL:r=r||"0.0.0.0",appKey:e,mapId:n,appName:t}});i={checkOffLine:function(e,t,n,r){return(n=n||r)==c(e,t)},checkIsOnLine:function(e,t,n){u.getData(l.check,(function(t){e&&e()}),(function(e){t&&t()}))},checkOnLine:function(e,t,n,r,i,a){var s=l.onlineCheck;n=h(e,t,n),n=(0,o.default)(n),u.getData(s,(function(e){e?e.success?r&&r(e):i&&i(e):i&&i()}),(function(e){e?(e=JSON.parse(e),i&&i(e)):i&&i()}),a,n,{"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"})},checkLicense:i,getCerityData:h,ls:0},t.default=i},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.default=void 0,n(136);var o=i(n(11)),a=i(n(12)),s=i(n(233)),u=i(n(137));n=function(){function e(){(0,o.default)(this,e),this.netArea=u.default}return(0,a.default)(e,[{key:"getScene",value:function(e,t,n,r,i,o,a){var u=n?t+".scene":t,l=null===t?e:e+"/"+u+".fmap";u=new s.default,r&&(n||(l=e),u.setRequestHeader({"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"})),u.requestMethod=i||"GET",u.sendData=r,u.setResponseType("arraybuffer"),u.getFile(l,(function(e){o(e,t)}),(function(e){console.error("网络请求错误"),a&&a(e)}))}},{key:"getFloor",value:function(e,t,n,r,i,o,a){var u,l,c;a?this.getUrlFloor(e,t,n,r,i,o):(u=new s.default,"fengmap"==e&&(e=this.netArea+"sdk/authLayered/downMaps",u.requestMethod="POST",u.sendData=o,u.setRequestHeader({"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"})),l=e+"/"+n+"."+t+".biz.fmap",o=e+"/"+n+"."+t+".geo.fmap",c=e+"/"+n+"."+t+".navi.fmap",u.setResponseType("arraybuffer"),u.getFile(o,(function(e){u.getFile(l,(function(t){u.getFile(c,(function(n){i(e,t,n,r)}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")})))}},{key:"getUrlFloor",value:function(e,t,n,r,i,o){var a=new s.default;"fengmap"==e&&(e=this.netArea+"sdk/authLayered/obtainMapRoute",a.requestMethod="POST",a.sendData=o,a.setRequestHeader({"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"}));var u=e+"/"+n+"."+t+".biz.fmap",l=e+"/"+n+"."+t+".geo.fmap",c=e+"/"+n+"."+t+".navi.fmap",h=this;a.getFile(l,(function(e){a.getFile(u,(function(t){a.getFile(c,(function(n){var a=n.replace('"',"").replace('"',""),s=t.replace('"',"").replace('"',"");n=e.replace('"',"").replace('"',""),h.getUrlFloorData(s,n,a,r,o,i)}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")}))}},{key:"getUrlFloorData",value:function(e,t,n,r,i,o){var a=new s.default;a.sendData=null,a.requestMethod="GET",a.setRequestHeader({"X-Requested-With":"XMLHttpRequest"}),a.setResponseType("arraybuffer"),a.getFile(t,(function(t){a.getFile(e,(function(e){a.getFile(n,(function(n){o(t,e,n,r)}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")}))}),(function(){console.error("网络请求错误")}))}},{key:"getTheme",value:function(e,t){(new s.default).getFile(e,(function(e){e=JSON.parse(e),t(e)}),(function(){}))}},{key:"getData",value:function(e,t,n,r,i,o){var a=new s.default;a.requestMethod=r||"GET",a.sendData=i,a.setRequestHeader(o),a.getFile(e,(function(e){e=JSON.parse(e),t(e)}),(function(e){n(e)}))}},{key:"getUrl",value:function(e,t,n,r,i,o,a){var u=e+"/"+(l=n?t+".scene":t)+".fmap",l=new s.default;r&&(n||(u=e),l.setRequestHeader({"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"})),l.requestMethod=i||"GET",l.sendData=r,l.getFile(u,(function(e){o(e,t)}),(function(e){console.error("网络请求错误"),a&&a(e)}))}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(16),i=n(33),o=n(10),a=n(26),s=n(131),u=n(132),l=Math.max,c=Math.min,h=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g,p=function(e){return void 0===e?e:String(e)};n(133)("replace",2,(function(e,t,n,g){return[function(r,i){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(e,t){var i=g(n,e,this,t);if(i.done)return i.value;var h=r(e),f=String(this),d="function"==typeof t;d||(t=String(t));var v,y=h.global;y&&(v=h.unicode,h.lastIndex=0);for(var _=[];null!==(w=u(h,f))&&(_.push(w),y);)""===String(w[0])&&(h.lastIndex=s(f,o(h.lastIndex),v));for(var x="",A=0,I=0;I<_.length;I++){for(var w=_[I],b=String(w[0]),C=l(c(a(w.index),f.length),0),M=[],E=1;E<w.length;E++)M.push(p(w[E]));var T,S=w.groups;S=d?(T=[b].concat(M,C,f),void 0!==S&&T.push(S),String(t.apply(void 0,T))):m(b,f,C,M,S,t),A<=C&&(x+=f.slice(A,C)+S,A=C+b.length)}return x+f.slice(A)}];function m(e,t,r,o,a,s){var u=r+e.length,l=o.length,c=d;return void 0!==a&&(a=i(a),c=f),n.call(s,c,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(u);case"<":s=a[i.slice(1,-1)];break;default:var c=+i;if(0===c)return n;if(l<c){var f=h(c/10);return 0!==f&&f<=l?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):n}s=o[c-1]}return void 0===s?"":s}))}}))},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n="https://console.fengmap.com/api-s/",t.default=n},function(e,t,n){e.exports=n(245)},function(e,t,n){var r=n(15).f,i=Function.prototype,o=/^\s*function ([^ (]*)/,a="name";a in i||n(6)&&r(i,a,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,n){for(var r,i=n(5),o=n(9),a=(n=n(41))("typed_array"),s=n("view"),u=n=!(!i.ArrayBuffer||!i.DataView),l=0,c="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(r=i[c[l++]])?(o(r.prototype,a,!0),o(r.prototype,s,!0)):u=!1;e.exports={ABV:n,CONSTR:u,TYPED:a,VIEW:s}},function(e,t,n){var r=n(22);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(26),i=n(10);e.exports=function(e){if(void 0===e)return 0;var t=r(e);if(t!==(e=i(t)))throw RangeError("Wrong length!");return e}},function(e,t,n){var r=n(25),i=n(33),o=n(77)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var r=n(4)("unscopables"),i=Array.prototype;null==i[r]&&n(9)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;0<=r;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",i=!1,o=arguments.length-1;-1<=o&&!i;o--){var a=0<=o?arguments[o]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,i="/"===a.charAt(0))}return(i?"/":"")+(t=n(r(t.split("/"),(function(e){return!!e})),!i).join("/"))||"."},t.normalize=function(e){var o=t.isAbsolute(e),a="/"===i(e,-1);return(e=n(r(e.split("/"),(function(e){return!!e})),!o).join("/"))||o||(e="."),e&&a&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;0<=n&&""===e[n];n--);return n<t?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}var l=[];for(u=s;u<i.length;u++)l.push("..");return(l=l.concat(o.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,o=e.length-1;1<=o;--o)if(47===(t=e.charCodeAt(o))){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){return e=function(e){"string"!=typeof e&&(e+="");for(var t=0,n=-1,r=!0,i=e.length-1;0<=i;--i)if(47===e.charCodeAt(i)){if(!r){t=i+1;break}}else-1===n&&(r=!1,n=i+1);return-1===n?"":e.slice(t,n)}(e),t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,o=0,a=e.length-1;0<=a;--a){var s=e.charCodeAt(a);if(47===s){if(i)continue;n=a+1;break}-1===r&&(i=!1,r=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1)}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===n+1?"":e.slice(t,r)};var i=function(e,t,n){return e.substr(t,n)}}).call(this,n(35))},function(e,t,n){"use strict";(function(t,r){var i=n(61);e.exports=_;var o,a=n(271);_.ReadableState=y,n(92).EventEmitter;var s=function(e,t){return e.listeners(t).length},u=n(148),l=n(94).Buffer,c=t.Uint8Array||function(){};function h(e){return l.isBuffer(e)||e instanceof c}var f=Object.create(n(45));f.inherits=n(37),t=n(275);var d,p=void 0,g=(p=t&&t.debuglog?t.debuglog("stream"):function(){},n(276));t=n(149),f.inherits(_,u);var m=["error","close","destroy","pause","resume"];function v(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?a(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}function y(e,t){e=e||{};var r=t instanceof(o=o||n(27));this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,a=e.readableHighWaterMark;t=this.objectMode?16:16384,this.highWaterMark=i||0===i?i:r&&(a||0===a)?a:t,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(d=d||n(150).StringDecoder,this.decoder=new d(e.encoding),this.encoding=e.encoding)}function _(e){if(o=o||n(27),!(this instanceof _))return new _(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),u.call(this)}function x(e,t,n,r,i){var o,a=e._readableState;return null===t?(a.reading=!1,function(e,t){var n;t.ended||(t.decoder&&(n=t.decoder.end())&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length),t.ended=!0,C(e))}(e,a)):(i||(o=I(a,t)),o?e.emit("error",o):a.objectMode||t&&0<t.length?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),r?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):A(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?A(e,a,t,!1):E(e,a)):A(e,a,t,!1))):r||(a.reading=!1)),function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(a)}function A(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&C(e)),E(e,t)}function I(e,t){var n;return h(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=t.destroy,_.prototype._undestroy=t.undestroy,_.prototype._destroy=function(e,t){this.push(null),t(e)},_.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=""),n=!0),x(this,e,t,!1,n)},_.prototype.unshift=function(e){return x(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){return d=d||n(150).StringDecoder,this._readableState.decoder=new d(e),this._readableState.encoding=e,this};var w=8388608;function b(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?(t.flowing&&t.length?t.buffer.head.data:t).length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return w<=e?e=w:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function C(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(p("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(M,e):M(e))}function M(e){p("emit readable"),e.emit("readable"),k(e)}function E(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(T,e,t))}function T(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(p("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function S(e){p("readable nexttick read 0"),e.read(0)}function L(e,t){t.reading||(p("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),k(e),t.flowing&&!t.reading&&e.read(0)}function k(e){var t=e._readableState;for(p("flow",t.flowing);t.flowing&&null!==e.read(););}function R(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():(n?N:P)(e,t),r}(e,t.buffer,t.decoder),n);var n}function N(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0==(e-=a)){a===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++r}return t.length-=r,i}function P(e,t){var n=l.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,a),0==(e-=a)){a===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++i}return t.length-=i,n}function O(e){var t=e._readableState;if(0<t.length)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(D,t,e))}function D(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function F(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}_.prototype.read=function(e){p("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return p("read: emitReadable",t.length,t.ended),(0===t.length&&t.ended?O:C)(this),null;if(0===(e=b(e,t))&&t.ended)return 0===t.length&&O(this),null;var r=t.needReadable;return p("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&p("length less than watermark",r=!0),t.ended||t.reading?p("reading or ended",r=!1):r&&(p("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=b(n,t))),null===(r=0<e?R(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&O(this)),null!==r&&this.emit("data",r),r},_.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}function a(e,t){p("onunpipe"),e===n&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,h())}function u(){p("onend"),e.end()}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,t),t=(t=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr)?u:_,o.endEmitted?i.nextTick(t):n.once("end",t),e.on("unpipe",a);var l=function(e){return function(){var t=e._readableState;p("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,k(e))}}(n);e.on("drain",l);var c=!1;function h(){p("cleanup"),e.removeListener("close",m),e.removeListener("finish",y),e.removeListener("drain",l),e.removeListener("error",g),e.removeListener("unpipe",a),n.removeListener("end",u),n.removeListener("end",_),n.removeListener("data",d),c=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||l()}var f=!1;function d(t){p("ondata"),f=!1,!1!==(t=e.write(t))||f||((1===o.pipesCount&&o.pipes===e||1<o.pipesCount&&-1!==F(o.pipes,e))&&!c&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,f=!0),n.pause())}function g(t){p("onerror",t),_(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",y),_()}function y(){p("onfinish"),e.removeListener("close",m),_()}function _(){p("unpipe"),n.unpipe(e)}return n.on("data",d),v(e,"error",g),e.once("close",m),e.once("finish",y),e.emit("pipe",n),o.flowing||(p("pipe resume"),n.resume()),e},_.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var a=F(t.pipes,e);return-1===a||(t.pipes.splice(a,1),--t.pipesCount,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},_.prototype.on=function(e,t){return t=u.prototype.on.call(this,e,t),"data"===e?!1!==this._readableState.flowing&&this.resume():"readable"===e&&((e=this._readableState).endEmitted||e.readableListening||(e.readableListening=e.needReadable=!0,e.emittedReadable=!1,e.reading?e.length&&C(this):i.nextTick(S,this))),t},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var e=this._readableState;return e.flowing||(p("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(L,e,t))}(this,e)),this},_.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(e){var t,n=this,r=this._readableState,i=!1;for(t in e.on("end",(function(){var e;p("wrapped end"),r.decoder&&!r.ended&&(e=r.decoder.end())&&e.length&&n.push(e),n.push(null)})),e.on("data",(function(t){p("wrapped data"),r.decoder&&(t=r.decoder.write(t)),r.objectMode&&null==t||(r.objectMode||t&&t.length)&&((t=n.push(t))||(i=!0,e.pause()))})),e)void 0===this[t]&&"function"==typeof e[t]&&(this[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t));for(var o=0;o<m.length;o++)e.on(m[o],this.emit.bind(this,m[o]));return this._read=function(t){p("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=R}).call(this,n(38),n(35))},function(e,t,n){e.exports=n(92).EventEmitter},function(e,t,n){"use strict";var r=n(61);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(r.nextTick(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}))),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";var r=n(281).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=l,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=c,this.end=h,t=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){return 128!=(192&t[0])?(e.lastNeed=0,"�"):1<e.lastNeed&&1<t.length?128!=(192&t[1])?(e.lastNeed=1,"�"):2<e.lastNeed&&2<t.length&&128!=(192&t[2])?(e.lastNeed=2,"�"):void 0:void 0}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);var n=e.toString("utf16le",t);return n&&55296<=(t=n.charCodeAt(n.length-1))&&t<=56319?(this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)):n}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?(e=this.lastTotal-this.lastNeed,t+this.lastChar.toString("utf16le",0,e)):t}function c(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){return e=e&&e.length?this.write(e):"",this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){return e=e&&e.length?this.write(e):"",this.lastNeed?e+"�":e},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=a(t[r]);return 0<=i?(0<i&&(e.lastNeed=i-1),i):--r<n||-2===i?0:0<=(i=a(t[r]))?(0<i&&(e.lastNeed=i-2),i):--r<n||-2===i?0:0<=(i=a(t[r]))?(0<i&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);return this.lastNeed?(this.lastTotal=n,n=e.length-(n-this.lastNeed),e.copy(this.lastChar,0,n),e.toString("utf8",t,n)):e.toString("utf8",t)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";e.exports=o;var r=n(27);function i(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e),(e=this._readableState).reading=!1,(e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);r.call(this,e),this._transformState={afterTransform:i.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush((function(t,n){s(e,t,n)})):s(this,null,null)}function s(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}(e=Object.create(n(45))).inherits=n(37),e.inherits(o,r),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;r.writecb=n,r.writechunk=e,r.writeencoding=t,r.transforming||(t=this._readableState,(r.needTransform||t.needReadable||t.length<t.highWaterMark)&&this._read(t.highWaterMark))},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,(function(e){t(e),n.emit("close")}))}},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.Vector3=c,n(43),i=i(n(30));var o,a,s,u,l=n(97);function c(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}n=n(153),(0,i.default)(c.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(u=new n.Quaternion,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(u.setFromEuler(e))}),applyAxisAngle:(s=new n.Quaternion,function(e,t){return this.applyQuaternion(s.setFromAxisAngle(e,t))}),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z;return e=e.elements,this.x=e[0]*t+e[3]*n+e[6]*r,this.y=e[1]*t+e[4]*n+e[7]*r,this.z=e[2]*t+e[5]*n+e[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return e=1/(i[3]*t+i[7]*n+i[11]*r+i[15]),this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*e,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*e,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*e,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,u=s*t+o*r-a*n,l=s*n+a*t-i*r;return e=s*r+i*n-o*t,r=-i*t-o*n-a*r,this.x=u*s+r*-i+l*-a-e*-o,this.y=l*s+r*-o+e*-i-u*-a,this.z=e*s+r*-a+u*-o-l*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,r=this.z;return e=e.elements,this.x=e[0]*t+e[4]*n+e[8]*r,this.y=e[1]*t+e[5]*n+e[9]*r,this.z=e[2]*t+e[6]*n+e[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x;return e=t.y,t=t.z,this.x=r*t-i*e,this.y=i*o-n*t,this.z=n*e-r*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(a=new c,function(e){return a.copy(this).projectOnVector(e),this.sub(a)}),reflect:(o=new c,function(e){return this.sub(o.copy(e).multiplyScalar(2*this.dot(e)))}),angleTo:function(e){return e=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq()),Math.acos(l._Math.clamp(e,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n+(e=this.z-e.z)*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length();return e=this.setFromMatrixColumn(e,2).length(),this.x=t,this.y=n,this.z=e,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}})},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.Quaternion=s,t=i(n(30));var o=i(n(290)),a=(i=i(n(293)),n(97));function s(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}(0,t.default)(s,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,a,s){var u=n[r+0],l=n[r+1],c=n[r+2],h=n[r+3],f=i[a+0],d=i[a+1],p=i[a+2],g=i[a+3];h===g&&u===f&&l===d&&c===p||(n=1-s,i=0<=(r=u*f+l*d+c*p+h*g)?1:-1,(a=1-r*r)>o.default&&(a=Math.sqrt(a),r=Math.atan2(a,r*i),n=Math.sin(n*r)/a,s=Math.sin(s*r)/a),u=u*n+f*(i*=s),l=l*n+d*i,c=c*n+p*i,h=h*n+g*i,n===1-s&&(u*=s=1/Math.sqrt(u*u+l*l+c*c+h*h),l*=s,c*=s,h*=s)),e[t]=u,e[t+1]=l,e[t+2]=c,e[t+3]=h}}),(0,i.default)(s.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),(0,t.default)(s.prototype,{isQuaternion:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,u=a(n/2);return e=a(r/2),a=a(i/2),n=s(n/2),r=s(r/2),i=s(i/2),"XYZ"===o?(this._x=n*e*a+u*r*i,this._y=u*r*a-n*e*i,this._z=u*e*i+n*r*a,this._w=u*e*a-n*r*i):"YXZ"===o?(this._x=n*e*a+u*r*i,this._y=u*r*a-n*e*i,this._z=u*e*i-n*r*a,this._w=u*e*a+n*r*i):"ZXY"===o?(this._x=n*e*a-u*r*i,this._y=u*r*a+n*e*i,this._z=u*e*i+n*r*a,this._w=u*e*a-n*r*i):"ZYX"===o?(this._x=n*e*a-u*r*i,this._y=u*r*a+n*e*i,this._z=u*e*i-n*r*a,this._w=u*e*a+n*r*i):"YZX"===o?(this._x=n*e*a+u*r*i,this._y=u*r*a+n*e*i,this._z=u*e*i-n*r*a,this._w=u*e*a-n*r*i):"XZY"===o&&(this._x=n*e*a-u*r*i,this._y=u*r*a-n*e*i,this._z=u*e*i+n*r*a,this._w=u*e*a+n*r*i),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2;return t=Math.sin(n),this._x=e.x*t,this._y=e.y*t,this._z=e.z*t,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n,r=(n=e.elements)[0],i=n[4],o=n[8],a=n[1],s=n[5],u=n[9],l=n[2],c=n[6];return 0<(n=r+s+(e=n[10]))?(t=.5/Math.sqrt(n+1),this._w=.25/t,this._x=(c-u)*t,this._y=(o-l)*t,this._z=(a-i)*t):s<r&&e<r?(t=2*Math.sqrt(1+r-s-e),this._w=(c-u)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+l)/t):e<s?(t=2*Math.sqrt(1+s-r-e),this._w=(o-l)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(u+c)/t):(t=2*Math.sqrt(1+e-r-s),this._w=(a-i)/t,this._x=(o+l)/t,this._y=(u+c)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=n,this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(a._Math.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);return 0===n||(n=Math.min(1,t/n),this.slerp(e,n)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y;return e=t._z,t=t._w,this._x=n*t+o*a+r*e-i*s,this._y=r*t+o*s+i*a-n*e,this._z=i*t+o*e+n*s-r*a,this._w=o*t-n*a-r*s-i*e,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,s=a*e._w+n*e._x+r*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),1<=s)return this._w=a,this._x=n,this._y=r,this._z=i,this;if((e=1-s*s)<=o.default){var u=1-t;return this._w=u*a+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*i+t*this._z,this.normalize(),this._onChangeCallback(),this}return u=Math.sqrt(e),e=Math.atan2(u,s),s=Math.sin((1-t)*e)/u,u=Math.sin(t*e)/u,this._w=a*s+this._w*u,this._x=n*s+this._x*u,this._y=r*s+this._y*u,this._z=i*s+this._z*u,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}})},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.default=void 0;var o,a=i(n(157)),s=i(n(158)),u=i(n(288)),l=i(n(289)),c=n(152),h=(r=n(97),i=n(296),n=n(153),window.fengmap||{}),f={VERSION:a.default.VERSION,BUILD:a.default.BUILD,FMNavigation:s.default,FMNaviMode:u.default,FMNaviPriority:l.default};for(o in f)f.hasOwnProperty(o)&&(h[o]=f[o]);window.fengmap=h,window.Geo=window.Geo||{Vector3:c.Vector3,_Math:r._Math,Matrix4:i.Matrix4,Quaternion:n.Quaternion},n=h,t.default=n},function(e,t,n){n(156);var r=n(1).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(3);r(r.S+r.F*!n(14),"Object",{defineProperty:n(17).f})},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={VERSION:"2.7.3",BUILD:5},t.default=n},function(e,t,n){"use strict";var r=n(159),i=n(0),o=n(2);i(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(30)),s=o(n(170)),u=o(n(71)),l=o(n(51));n(73),n(110),n(188),n(43);var c,h,f,d,p,g,m,v,y,_,x,A=o(n(11)),I=o(n(12)),w=o(n(116)),b=o(n(189)),C=o(n(196)),M=o(n(212)),E=o(n(216)),T=o(n(229));n(270),n(287),window.fengmap&&(n={},window.fengmap,n=window.fengmap.inner||{},c=n.Graphics||{},h=n.FMSegment||{},f=n.FMNaviMode||{},d=n.FMNaviPriority||{},p=n.FMRouteCalcuResult||{},S=n.EventDispatcher||{},g=n.DataManager||{},m=n.FMUtil||{},v=n.FMImageMarker||{},y=n.FMLineMarker||{},_=n.FMLocationMarker||{},x=n.FMLanguageType||{});var S=function(e){(0,b.default)(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,M.default)(e);return i=t?(n=(0,M.default)(this).constructor,r(i,arguments,n)):i.apply(this,arguments),(0,C.default)(this,i)}}(n);function n(e){var r;return(0,A.default)(this,n),r=t.call(this),e.map&&e.scaleLevel&&!e.scale&&(e.scale=e.map.mapScaleLevels[e.scaleLevel]),e.map&&e.offsetHeight&&!e.lineMarkerHeight&&(e.lineMarkerHeight=e.offsetHeight),r.map=null,r.sceneData=null,r.speed=5,r.followSpeed=.2,r.followPosition=!0,r.followAngle=!1,r.locationMarkerFollowAngle=!0,r.isMultiGroups=!1,r.inTime=1.2,r.tiltAngle=80,r.changeGroupTiltAngle=30,r.scale=282,r.changeTiltAngle=!0,r.minScale=141,r.extendScale=1.3,r.locationMarkerUrl="",r.locationMarkerSize=100,r.locationMarkerHeight=3,r.lineMarkerHeight=1,r.imageMarkerHeight=6,r.directionAssert=10,r.combineAsset=5,r.completeDistance=0,r.naviLanguage=x.ZH,r.naviMode=f.MODULE_SHORTEST,r.naviPriority=d.PRIORITY_DEFAULT,r.autoRoute=!0,r.autoClearNaviLine=!0,r.lineStyle={lineWidth:10,radius:.5,dash:{size:4,gap:2}},r._passingPts={},r._passPtsEpson=1,r._failedInsertedPts={},(0,a.default)((0,w.default)(r),e),r._init(),r}return(0,I.default)(n,[{key:"_init",value:function(){var e,t,n=this;this.map&&(this.mapServerURL&&this.mapID?(e={key:this.map.MapOptions.key,appName:this.map.MapOptions.appName,tile:!1,mapServerURL:this.mapServerURL,mapID:this.mapID},(t=new T.default(e)).openMap((function(){var e=t.dataManager._sceneDecodeData[n.mapID];n._analyser=new fengmap.FMNaviAnalyser({}),n._analyser.initByScene(e),n.callback()}))):(this._analyser=new fengmap.FMNaviAnalyser,this._analyser.init(this.map)),this._naviDescriptionsCalculator=new E.default({map:this.map,directionAssert:this.directionAssert,combineAsset:this.combineAsset,naviLanguage:this.naviLanguage,completeDistance:this.completeDistance})),this._simulateParams=null,this._startData=null,this._endData=null,this._startMarker=null,this._endMarker=null,this._startMarkerLayer=null,this._endMarkerLayer=null,this._locationMarker=null,this._naviLineMarkers=[],this._naviResults=[],this._naviDescriptions=[],this._naviDescriptionsData=[],this._naviDistance=0,this._naviGroupsDistance=null,this._naviEntracesDistance=[null,null],this._timer=new fm.Clock,this._pause=!1,this._toPos=null,this._toRot=null,this._allLen=0,this._preGid=0,this._locateLastGroupID=null,this._changeGrouping=!1,this._animateFun=null,this._isSimulating=!1,this._isEnd=!1,this._groupPointsIndex=0,this._gpsData=null,this._tiltToAnimater=null,this._scaleToAnimater=null,this._moveToAnimater=null,this._focusGroupToAnimater=null,this._passingPts={},this._failedInsertedPts={}}},{key:"naviToDoor",get:function(){return this._analyser.naviToDoor},set:function(e){this._analyser.naviToDoor=e}},{key:"locationMarker",get:function(){return this._locationMarker||(this._locationMarker=new _({id:"location",map:this.map,url:this.locationMarkerUrl||"",size:this.locationMarkerSize}),this.map.addLocationMarker(this._locationMarker)),this._locationMarker},set:function(e){e instanceof _&&(this._locationMarker=e,this.map.addLocationMarker(this._locationMarker))}},{key:"startMarker",get:function(){return this._startMarker},set:function(e){this._startMarker=e}},{key:"endMarker",get:function(){return this._endMarker},set:function(e){this._endMarker=e}},{key:"naviDescriptions",get:function(){return this._naviDescriptions}},{key:"naviDescriptionsData",get:function(){return this._naviDescriptionsData}},{key:"naviDistance",get:function(){return this._naviDistance}},{key:"naviGroupsDistance",get:function(){return this._naviGroupsDistance}},{key:"naviEntrancesDistance",get:function(){return this._naviEntracesDistance}},{key:"on",value:function(e,t){this.addEventListener(e,t)}},{key:"off",value:function(e,t){this.removeEventListener(e,t)}},{key:"dispose",value:function(){this.stop(),this.map=null,this._analyser&&(this._analyser.dispose(),this._analyser=null),this._naviDescriptionsCalculator&&(this._naviDescriptionsCalculator.dispose(),this._naviDescriptionsCalculator=null)}},{key:"getRouteDescriptions",value:function(e,t){return e=e||this._naviResults,this._isNaviResultsValide(e)?((t=(0,a.default)({},t)).map||(t.map=this._map,t.analyser=this),{naviDescriptions:(e=(t=new E.default(t)).calculate(e))[0],naviDescriptionsData:e[1],naviDistance:e[2],naviGroupsDistance:e[3]}):{}}},{key:"setLineStyle",value:function(e){this._naviLineMarker&&this._naviLineMarker.updateStyle(e),this.lineStyle=e}},{key:"setNaviLanguage",value:function(e){return!(!e||"string"!=typeof e||(e=e.toLowerCase(),e!=x.ZH&&e!=x.EN||(this.naviLanguage!=e&&(this.naviLanguage=e,this._naviDescriptionsCalculator&&(this._naviDescriptionsCalculator.naviLanguage=e),0<this._naviResults.length&&(e=this._naviDescriptionsCalculator.calculate(this._naviResults),this._naviDescriptions=e[0],this._naviDescriptionsData=e[1])),0)))}},{key:"setStartPoint",value:function(e,t){this._startData=(0,a.default)({},this._startData,e,{x:e.x,y:e.y,groupID:e.groupID});var n=null;return e.url&&!t&&(n=this._createMarker(e,!0)),this.autoRoute&&(this._getNaviResult(),this._needDrawLines=!0),n}},{key:"setEndPoint",value:function(e,t){this._endData=e;var n=null;return!e.url||e.noMarker||t||(n=this._createMarker(e,!1)),this.autoRoute&&(this._getNaviResult(),this._needDrawLines=!0),n}},{key:"route",value:function(e,t){this._getNaviResult(e,t),this._needDrawLines=!0}},{key:"nearDist",get:function(){return this._passPtsEpson},set:function(e){this._passPtsEpson=e}},{key:"passingPts",get:function(){return this._passingPts},set:function(e){this._passingPts=e}},{key:"naviConstraint",value:function(e){if(this._startData&&this._endData){var t={index:-1,coord:{groupID:e.groupID},angle:null,distance:Number.MAX_VALUE,distanceToNext:Number.MAX_VALUE,remain:this._naviDistance},n=this._analyse(),r=n.map((function(e){return{x:e.x,y:e.z,z:0,groupID:e.gid,index:e._index}})),i=this._getNaviPoints(n).map((function(e){return{x:e.x,y:e.z,z:0,groupID:e.gid,index:e._index}})),o=this._analyser._navi._graphs.get(e.groupID);if(o){for(var s=o.queryContainExtentId(e),u={},l=1;l<i.length;l++){var h,f=i[l-1],d=i[l],p=this._naviDescriptionsData[f.index].endPoint;f.groupID===e.groupID&&d.groupID===e.groupID&&s==o.queryContainExtentId(f)&&(h=c.pointDistanceToLine(e,f,d,u))<t.distance&&(t.distance=h,(0,a.default)(t.coord,u),t.angle=this._getRouteAngle(f,d),t.index=f.index,t.distanceToNext=c.distanceOfTwoPoints(u,p))}if(-1==t.index)for(var g=0;g<i.length;g++){var m,v=i[g];v.groupID==e.groupID&&s==o.queryContainExtentId(v)&&(m=c.distanceOfTwoPoints(e,v))<t.distance&&(t.distance=m,(0,a.default)(t.coord,v),t.index=v.index,t.distanceToNext=0,r[v.index+1]&&i[v.index+1].groupID==e.groupID&&(t.distanceToNext=c.distanceOfTwoPoints(e,r[v.index+1])))}if(-1!=t.index){for(var y,_,x=0,A=r.length-1;A>t.index;A--)A-1>t.index&&(y=r[A],_=r[A-1],y.groupID==_.groupID&&(x+=c.distanceOfTwoPoints(y,_)));r[t.index+1]&&r[t.index+1].groupID==t.coord.groupID&&(x+=c.distanceOfTwoPoints(r[t.index+1],t.coord)),t.remain=x}return t}}}},{key:"pathConstraint",value:function(e,t){return this._analyser?this._analyser.pathConstraint(e,t):null}},{key:"locate",value:function(e,t){this._isSimulating&&this.stop(),e.groupID||e.groupId&&(e.groupID=e.groupId),e.groupID!=this._locateLastGroupID&&(this._locateLastGroupID=e.groupID),this.locateWalking(e,t)}},{key:"dropPtsByCicle",value:function(e){var t,n=[];for(t in this._passingPts)if(t==e.groupID)for(var r=0;r<this._passingPts[t].length;r++){var i=this._passingPts[t][r],o=Math.pow(i[0]-e.x,2),a=Math.pow(i[1]-e.y,2);(a=Math.sqrt(o+a))<this._passPtsEpson&&(n.push(i),this._passingPts[t].splice(r,1),r--)}return n}},{key:"locateWalking",value:function(e,t){var n=this.dropPtsByCicle(e),r=this.naviConstraint(e);if(r){if(this._naviLineMarker)if(this._naviLineMarker.passed)for(var i=0;i<this._naviLineMarker._lineNodes.length;i++)this._naviLineMarker._lineNodes[i].line.material.uniforms.miny.value=1-r.remain/this._naviDistance,this._naviLineMarker._lineNodes[i].line.material.uniforms.pcolor.value=new fm.Color(this._naviLineMarker.passedColor);else for(var o=0;o<this._naviLineMarker._lineNodes.length;o++)this._naviLineMarker._lineNodes[o].line.material.uniforms.miny.value=0;e={type:"walking",distance:r.distance,remain:r.remain,walk:this._naviDistance-r.remain,distanceToNext:r.distanceToNext,angle:r.angle,point:r.coord,groupID:e.groupID,index:r.index,isReal:!0,noArrivedPassingPts:this.passingPts},0<n.length&&(e.passing=n),this.dispatchEvent(e),this._locationMarker&&(r.coord.height=this.locationMarkerHeight,this._locationMarker.setPosition(r.coord),t?this._locationMarker.rotate(t):this._locationMarker.rotate(r.angle))}}},{key:"locateNoConstraint",value:function(e,t){this._isSimulating&&this.stop(),e.groupID||e.groupId&&(e.groupID=e.groupId),e.groupID!==this._locateLastGroupID&&(this._locateLastGroupID=e.groupID),this.locateWalkingNoConstraint(e,t)}},{key:"locateWalkingNoConstraint",value:function(e,t){var n=this.naviConstraint(e);n&&(this.dispatchEvent({type:"walking",distance:n.distance,remain:n.remain,walk:this._naviDistance-n.remain,distanceToNext:n.distanceToNext,angle:n.angle,point:n.coord,groupID:e.groupID,index:n.index,isReal:!0}),this._locationMarker&&(e.height=this.locationMarkerHeight,this._locationMarker.setPosition(e),t&&this._locationMarker.rotate(t)))}},{key:"clearLocationMarker",value:function(){this._locationMarker&&(this.map.removeLocationMarker(this._locationMarker),this._locationMarker=null)}},{key:"clearMarkers",value:function(){this._startMarker&&(this._startMarkerLayer.removeMarker(this._startMarker),this._startMarkerLayer=null,this._startMarker=null,this._startData=null),this._endMarker&&(this._endMarkerLayer.removeMarker(this._endMarker),this._endMarkerLayer=null,this._endMarker=null,this._endData=null)}},{key:"drawNaviLine",value:function(){if(this._startData&&this._endData)return this._needDrawLines=!1,this.autoClearNaviLine&&this.clearNaviLines(),this._naviLineMarker=this._drawLines(this._naviResults),this._naviLineMarker}},{key:"clearNaviLine",value:function(){this._naviLineMarker&&(this.map.removeLineMarker(this._naviLineMarker),this._naviLineMarker=null)}},{key:"clearNaviLines",value:function(){for(var e=0;e<this._naviLineMarkers.length;e++)this.map.removeLineMarker(this._naviLineMarkers[e]),this._naviLineMarkers[e]=null;this._naviLineMarkers=[]}},{key:"focusNaviLineSegment",value:function(e,t){var n,r=this,i=null,o=null,a=null;this._naviDescriptionsData&&e<this._naviDescriptionsData.length&&(n=this._naviDescriptionsData[e],o=n.startPoint,a=(a=n.endPoint)||o,e=n.startGID,n=n.endGID,o.z=this.map.getFMGroup(e).height,a.z=this.map.getFMGroup(n).height,i={x:(o.x+a.x)/2,y:(o.y+a.y)/2,z:a.z}),i&&((t=t||{}).rawLevel=!0,this._moveTo({x:i.x,y:i.y,groupID:n},this._getValueOrDefault(t,"time","duration",this.inTime),null,(function(){var e;o&&a&&(e=r.map.getScaleValueByVectics(o,a),!(0,s.default)(e)&&0<e&&(e*=t.extendScale||r.extendScale,r._scaleTo(e,r._getValueOrDefault(t,"time","duration",r.inTime),null,t.callback)))})))}},{key:"clearAll",value:function(){this.clearMarkers(),this.clearNaviLine(),this.clearLocationMarker()}},{key:"simulate",value:function(e){var t,n,r=this;this._startData&&this._endData&&0!=this._naviResults.length&&(t=e||{},this._simulateParams=(0,a.default)({},t),n=t.inTime||this.inTime,t.scale=t.scale||this.scale||0,this._locationMarker||this._initLocationMarker(),this._locationMarkerToStartPoint(),this._needDrawLines&&this.drawNaviLine(),this.followPosition?this._focusGroupToAnimater=this._focusGroupTo(this._startData.groupID,n,null,(function(){r._moveToAnimater=r._moveTo(r._startData,n,null,(function(){var e=t.scale<r.minScale?r.minScale:t.scale;r.changeTiltAngle?r._tiltToAnimater=r._tiltTo(r.tiltAngle,n,null,(function(){r._scaleToAnimater=r._scaleTo(e,n,null,(function(){r._works()}))})):r._scaleToAnimater=r._scaleTo(e,n,null,(function(){r._works()}))}))})):this._works())}},{key:"pause",value:function(){this._tiltToAnimater&&this._tiltToAnimater.pause(),this._scaleToAnimater&&this._scaleToAnimater.pause(),this._moveToAnimater&&this._moveToAnimater.pause(),this._focusGroupToAnimater&&this._focusGroupToAnimater.pause(),this._pause=!0}},{key:"resume",value:function(){this._tiltToAnimater&&this._tiltToAnimater.resume(),this._scaleToAnimater&&this._scaleToAnimater.resume(),this._moveToAnimater&&this._moveToAnimater.resume(),this._focusGroupToAnimater&&this._focusGroupToAnimater.resume(),this._pause=!1}},{key:"stop",value:function(){this._gpsStop=!0,this._timer.stop(),this._tiltToAnimater&&(this.map.removeAnimater(this._tiltToAnimater),this._tiltToAnimater=null),this._scaleToAnimater&&(this.map.removeAnimater(this._scaleToAnimater),this._scaleToAnimater=null),this._moveToAnimater&&(this.map.removeAnimater(this._moveToAnimater),this._moveToAnimater=null),this._focusGroupToAnimater&&(this.map.removeAnimater(this._focusGroupToAnimater),this._focusGroupToAnimater=null),this._animateFun&&this.map.off("update",this._animateFun),this._pause=!1,this._toPos=null,this._toRot=null,this._allLen=0,this._preGid=0,this._changeGrouping=!1,this._animateFun=null,this._isSimulating=!1,this._isEnd=!1,this._groupPointsIndex=0,this._gpsData=null}},{key:"_initLocationMarker",value:function(){this._locationMarker||(this._locationMarker=new _({id:"location",map:this.map,url:this.locationMarkerUrl||"",size:this.locationMarkerSize}),this.map.addLocationMarker(this._locationMarker))}},{key:"_getValueOrDefault",value:function(e){for(var t,n=arguments.length<=1?0:arguments.length-1,r=0;r<n;r++){var i=r+1<1||arguments.length<=r+1?void 0:arguments[r+1];if(e[i])return e[i]}return(t=(arguments.length<=1?0:arguments.length-1)-1+1)<1||arguments.length<=t?void 0:arguments[t]}},{key:"_isNaviGroup",value:function(e){if(this._startData&&this._endData)return e==this._startData.groupID||e==this._endData.groupID}},{key:"_createMarker",value:function(e,t){if(e.groupID){var n=e.url||(t?"image/small/marker/nav_location_start.png":"image/small/marker/nav_location_end.png"),r=t?this._startMarkerLayer:this._endMarkerLayer,i=t?this._startMarker:this._endMarker,o="number"==typeof e.height?e.height:this.imageMarkerHeight;return r&&i&&r.removeMarker(i),r&&r.groupID==e.groupID||(r=this.map.getFMGroup(e.groupID).getOrCreateLayer("imageMarker")),i=new v({x:e.x,y:e.y,map:this.map,url:n,height:o,size:e.size||64,anchor:e.anchor,callback:function(){e.callback&&e.callback(i)}}),r.addMarker(i),t?(this._startMarker=i,this._startMarkerLayer=r):(this._endMarker=i,this._endMarkerLayer=r),i}}},{key:"_getGroupsPoints",value:function(){for(var e=this._naviResults,t=[],n=null,r=null,i=0;i<e.length;i++){var o=e[i],a=n==o.groupId;0==o.length&&0!=i&&i!=e.length-1||(a||(n=o.groupId,r&&t.push(r),r={groupId:o.groupId,pointList:[]}),r.pointList=r.pointList.concat(o.pointList))}return r&&t.push(r),this._groupsPoints=t,t}},{key:"_addZeroResult",value:function(e){for(var t=0;t<e.length-1;t++){var n,r,i=e[t];i.length&&(n=i.pointList[i.pointList.length-1],r=e[t+1].pointList[0],.2<c.distanceOfTwoPoints(n,r)&&i.pointList.push((0,a.default)({},r)))}}},{key:"_getNaviResult",value:function(e,t){this._startData&&this._endData&&(this._naviResults=this._caculateLines(this._startData,this._endData,this._startData.groupID,this._endData.groupID,e,t),this._addZeroResult(this._naviResults),this._getGroupsPoints(),t=this._naviDescriptionsCalculator.calculate(this._naviResults),this._naviDescriptions=t[0],this._naviDescriptionsData=t[1],this._naviDistance=t[2],this._naviGroupsDistance=t[3],this._naviEntracesDistance[1]=this._calcEntraceDistance(this._naviResults,this._endData,!0),this._endData.url&&!this._endData.noMarker&&this._createMarker(this._endData,!1))}},{key:"_calcEntraceDistance",value:function(e,t,n){if(!this.map||!e||!t.groupID)return null;if(!this.map.getCurrDecodeData().floors[t.groupID])return null;var r,i=this.map.getCurrDecodeData().floors[t.groupID].geo[0].modelLayer,o=this.map.getFMGroup(t.groupID).getLayer("model")._models,a=null;for(r in o){var s=o[r];if(s&&s._data&&(a=s._data.vertices),null==a&&(s=i[r-1],a=1===this.map.dataManager.file_ver?g.convertGeo2Geometry(s.geo).vertices:g.convertArray2Geometry(s.idxs,s.pts)),c.pointInPolygonVector2d(a,t,a.length))break}if(!a)return null;for(var u=[],l=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE],h=0;h<a.length/2;h++){var f=a[d=2*h],d=a[d+1];l[0]>f&&(l[0]=f),l[1]<f&&(l[1]=f),l[2]>d&&(l[2]=d),l[3]<d&&(l[3]=d),u.push({x:f,y:d})}for(var p=[],m=0;m<e.length;m++)if(e[m].groupId==t.groupID){for(var v=[],y=0;y<e[m].pointList.length;y++)v.push(e[m].pointList[y]);p.push(v)}if(n){for(var _=0;_<p.length;_++)p[_].reverse();p.reverse()}for(var x=null,A=null,I=null,w=0;w<p.length;w++){for(var b=p[w],C=!1,M=0;M<b.length-1;M++){var E=b[M],T=b[M+1];if(T=c.calcLinePolygonCrossPoints2d(E,T,u,l)){A=b,I=M,x=T.crossPoints[M],C=!0;break}}if(C)break}if(!A)return null;for(var S=0,L=0;L<=I;L++){var k=A[L],R=A[L+1];S+=L!=I?c.distanceOfTwoPoints(k,R):c.distanceOfTwoPoints(k,x)}return S}},{key:"_drawLines",value:function(e){var t=this;if(0===e.length)return null;for(var n=new y,r=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(r){var i=e[r],o=i.getPointList();if(0===o.length)return"continue";r=i.groupId;var a=[];o.forEach((function(e){var n=(0,u.default)(""+e.x);e=(0,u.default)(""+e.y),a.push({x:n,y:e,z:t.lineMarkerHeight})})),o.length<2&&(i=(0,u.default)(""+o[0].x),s=(0,u.default)(""+o[0].y),a.push({x:i,y:s,z:t.lineMarkerHeight}));var s=new h;s.groupId=r,s.points=a,n.passed=t.passed,n.addSegment(s)})),i=0;i<e.length;i++)r(i);return this.map.drawLineMark(n,this.lineStyle),this._naviLineMarkers.push(n),n}},{key:"_caculateLines",value:function(e,t,n,r,i,o){return"{}"==(0,l.default)(this._passingPts)?this._analyser.analyzeNavi(n,e,r,t,i||this.naviMode,o||this.naviPriority)!=p.ROUTE_SUCCESS||0==(o=this._analyser.getNaviResults()).length?[]:(this.naviToDoor&&(this._endData.x=this._analyser._endDoor.x,this._endData.y=this._analyser._endDoor.y),o):(this._analyser.passPts=this._passingPts,this._analyser.routePassingPoints({x:e.x,y:e.y,groupID:n},{x:t.x,y:t.y,groupID:r}),r=this._analyser.getNaviResults(),this._failedInsertedPts=this._analyser.losedPoints,0==r.length?[]:(this.naviToDoor&&(this._endData.x=this._analyser._endDoor.x,this._endData.y=this._analyser._endDoor.y),r))}},{key:"losedPts",get:function(){return this._failedInsertedPts}},{key:"_locationMarkerToStartPoint",value:function(){this._startData&&this._locationMarker.setPosition({x:this._startData.x,y:this._startData.y,height:this.locationMarkerHeight,groupID:this._startData.groupID})}},{key:"_moveTo",value:function(e,t,n,r){return this.map._moveTo({x:e.x,y:e.y,time:"number"==typeof t?t:0,groupID:e.groupID,update:n,callback:r},!0)}},{key:"_tiltTo",value:function(e,t,n,r){return this.map.tiltTo({to:e,duration:"number"==typeof t?t:0,update:n,callback:r})}},{key:"_rotateTo",value:function(e,t,n,r){return this.map.rotateTo({to:e,duration:"number"==typeof t?t:0,update:n,callback:r})}},{key:"_scaleTo",value:function(e,t,n,r){return this.map.scaleTo({scale:e,duration:"number"==typeof t?t:0,update:n,callback:r},!0)}},{key:"_focusGroupTo",value:function(e,t,n,r){return this.map.visibleGroupIDs=[e],n&&n(),this.map.focusGroupID==e?(r&&r(),null):this.map.changeFocusToGroup({gid:e,duration:"number"==typeof t?t:0,update:n,callback:function(){r&&r()}})}},{key:"_getRouteAngle",value:function(e,t){var n=new Geo.Vector3(0,1,0);return e=new Geo.Vector3(e.x,e.y,0),e=(t=(t=new Geo.Vector3(t.x,t.y,0)).clone().sub(e).normalize()).angleTo(n)*Geo._Math.RAD2DEG,(n=t.cross(n).z<0)?360-e:e}},{key:"_getNaviPoints",value:function(e){var t=this._analyser.getNaviResults();if(0==t.length)return[];for(var n=[],r=0,i=0;i<t.length;i++){var o=t[i];if(!(o._pointList.length<=1))for(var a=o._groupId,s=0;s<o._pointList.length;s++){var u=o._pointList[s];(u=new Geo.Vector3(u.x,0,u.y)).gid=a;for(var l=-1,c=1;c<e.length;c++)if(r<e[c]._pointIndex){l=e[c-1]._index;break}u._index=-1!=l?l:e[e.length-1]._index,n.push(u),r++}}return n}},{key:"_getTransformByLength",value:function(e,t){if(0==t)return e[0];for(var n,r=0,i=0,o=e[0],a=1;a<e.length;a++)if((n=e[a]).gid==o.gid){if(t<=(r+=(s=n.clone().sub(o)).length())){s.normalize();var s=o.clone().add(s.clone().multiplyScalar(t-i));return s.gid=n.gid,s.index=n._index,s}(o=n.clone()).gid=n.gid,o.index=n._index,i=r}else o=n;var u=e[e.length-1];return u.index=u._index,u}},{key:"_analyse",value:function(){if(!this._startData||!this._endData||!this._naviDescriptionsData||0==this._naviDescriptionsData.length)return[];var e=-1,t=0,n=-1,r=this._naviDescriptionsData.map((function(r,i){var o=new Geo.Vector3(r.startPoint.x,0,r.startPoint.y);return o.gid=r.startGID,o._index=i,e=i,r.startGID!=r.endGID?(t+=n,o._pointIndex=t,t++):o._pointIndex=r.startIndex+t,n=r.endIndex,o})),i=this._naviDescriptionsData[this._naviDescriptionsData.length-1],o=new Geo.Vector3(i.endPoint.x,0,i.endPoint.y);return o.gid=i.endGID,o._index=e+1,o._pointIndex=i.endIndex+t,r.push(o),r}},{key:"_follow",value:function(e,t){var n=this,r=this._simulateParams,i=r.inTime||this.inTime;r.scale=r.scale||this.scale||0;var o=r.scale<this.minScale?this.minScale:r.scale;this.isMultiGroups||(r={x:this._locationMarker.x,y:this._locationMarker.y,height:this._locationMarker.height,groupID:e.gid},(e=this._groupsPoints[this._groupPointsIndex])&&e.pointList&&0<e.pointList.length&&(r=(0,a.default)(r,e.pointList[0])),this._locationMarker.setPosition(r),this._locationMarker._renderNode.visible=!0),this.changeTiltAngle&&(this._tiltToAnimater=this._tiltTo(this.tiltAngle,i,null,null)),this._moveToAnimater=this._moveTo(t,i,null,(function(){n._scaleToAnimater=n._scaleTo(o,i,null,(function(){n._changeGrouping=!1}))}))}},{key:"_gpsAnimate",value:function(e){var t,n,r,i,o,s,u,l=this;this._gpsStop||requestAnimationFrame(this._gpsAnimate.bind(this,e)),this._isEnd||(e.cnt++,e.cnt==e.step&&(e.cnt=0,n=this._timer.getDelta(),this._changeGrouping||this._pause||(this._allLen+=this.speed*n,0!=this._allLen&&(t=(0,a.default)({},this._getTransformByLength(e.ps,this._allLen)),s=this._naviDistance-this._allLen,n=t.y,t.y=t.z,t.z=n,t.groupID=t.gid,this._gpsData={distance:0,remain:s,walk:this._allLen,point:t,groupID:t.gid,index:t.index-1},this._toPos=(0,a.default)({},t),!t||s<=this._naviDescriptionsCalculator.tailLen?this._isEnd=!0:(this._preGid||(this._preGid=e.ps[0].gid),this._isSimulating&&(this._preGid!=t.gid&&(this._preGid=t.gid,this._groupPointsIndex++,r={x:t.x,y:t.y,groupID:t.gid},this.followPosition&&(u=this._simulateParams,i=u.inTime||this.inTime,u.scale=u.scale||this.scale||0,o=u.scale<this.minScale?this.minScale:u.scale,this._changeGrouping=!0,this.changeTiltAngle&&(this._tiltToAnimater=this._tiltTo(this.changeGroupTiltAngle,i,null,null)),this._focusGroupToAnimater=this._focusGroupTo(r.groupID,i,null,(function(){l._scaleToAnimater=l._scaleTo(o,i,null,(function(){l._locationMarker._renderNode.visible=!1,l.locationMarker.setPosition({x:r.x,y:r.y,height:l.locationMarkerHeight,groupID:r.groupID}),l._moveTo(r,i,null,(function(){l.changeTiltAngle?l._tiltToAnimater=l._tiltTo(l.tiltAngle,i,null,(function(){l._follow(t,r)})):l._follow(t,r)}))}))}))),this.dispatchEvent({type:"crossGroup",groupId:t.gid})),(s=m.toSceneCoord(this.map,this._toPos)).y=0,(e=this._locationMarker._renderNode.position.clone()).y=0,(u=new Geo.Matrix4).lookAt(e,s,this._locationMarker._renderNode.up),this._toRot=this.locationMarkerFollowAngle?(new Geo.Quaternion).setFromRotationMatrix(u):null))))))}},{key:"_gps",value:function(){this._gpsStop=!1;var e=this._getNaviPoints(this._analyse());this._timer.start(),this._isSimulating=!0,this._isEnd=!1,this._groupPointsIndex=0,e={step:2,cnt:0,ps:e},this._gpsAnimate(e)}},{key:"_animate",value:function(){if(!this._changeGrouping&&!this._pause){if(this._toPos){var e=new Geo.Vector3(this._locationMarker.x,this._locationMarker.y,0),t=e.lerp(this._toPos,this.followSpeed);t.groupID=this._toPos.gid;var n=c.distanceOfTwoPoints(t,this._toPos);this._locationMarker.setPosition({x:t.x,y:t.y,height:this.locationMarkerHeight,groupID:t.groupID});var r=this.naviConstraint(t);if(this._naviLineMarker)if(this._naviLineMarker.passed)for(var i=0;i<this._naviLineMarker._lineNodes.length;i++)this._naviLineMarker._lineNodes[i].line.material.uniforms.miny.value=1-r.remain/this._naviDistance,this._naviLineMarker._lineNodes[i].line.material.uniforms.pcolor.value=new fm.Color(this._naviLineMarker.passedColor);else for(var o=0;o<this._naviLineMarker._lineNodes.length;o++)this._naviLineMarker._lineNodes[o].line.material.uniforms.miny.value=0;if(this.dispatchEvent((0,a.default)({},this._gpsData,{type:"walking",distance:r.distance,remain:r.remain,walk:this._naviDistance-r.remain,distanceToNext:r.distanceToNext,angle:r.angle,point:r.coord,groupID:t.groupID,index:r.index,isReal:!1})),this.followPosition?(t.groupID=t.gid,this._moveToAnimater=this._moveTo(t)):this.map.updateCountDown_=0,this._isEnd&&n<.5)return this.stop(),void this.dispatchEvent({type:"complete"})}this._toRot&&(this._locationMarker._renderNode.quaternion.slerp(this._toRot,this.followSpeed),this.followAngle&&(t=(e=new Geo.Vector3(1,0,0)).clone(),(n=this._locationMarker._renderNode.matrix.clone()).setPosition(new Geo.Vector3),t.applyMatrix4(n),n=(n=t.clone().cross(e)).y<0?-1:1,t=e.angleTo(t),n=Math.PI-t*n,n+=Math.PI,this.map.controls.setUpdate(null,null,null,n)))}}},{key:"_works",value:function(){this._gps(),this._animateFun=this._animate.bind(this),this.map.on("update",this._animateFun)}},{key:"AdaptiveLineOverview",value:function(){for(var e=this.map,t=e.nodeManager._scenes[e._currentSceneId].groups[e.focusGroupID]._lineScene,n=new fm.Vector2,r=new fm.Vector2,i=new fm.Vector2,o=!0,a=0;a<t.children.length;a++)t.children[a].visible&&(o?(r.x=t.children[a].geometry.boundingBox.max.x,r.y=t.children[a].geometry.boundingBox.max.z,i.x=t.children[a].geometry.boundingBox.min.x,i.y=t.children[a].geometry.boundingBox.min.z,o=!1):(r.x<t.children[a].geometry.boundingBox.max.x&&(r.x=t.children[a].geometry.boundingBox.max.x),r.z<t.children[a].geometry.boundingBox.max.z&&(r.z=t.children[a].geometry.boundingBox.max.z),i.x>t.children[a].geometry.boundingBox.min.x&&(i.x=t.children[a].geometry.boundingBox.min.x),i.z>t.children[a].geometry.boundingBox.min.z&&(i.z=t.children[a].geometry.boundingBox.min.z)));n.x=(r.x+i.x)/2+e.center.x,n.y=-(r.x+i.y)/2+e.center.y,e.moveTo(n),e.rotateTo({to:0}),e.nodeManager._scenes[e._currentSceneId].groups[1]._layers.extent[0]._scene.children[5].geometry.computeBoundingBox();var s=e.nodeManager._scenes[e._currentSceneId].groups[1]._layers.extent[0]._scene.children[5].geometry.boundingBox;s=(n=new fm.Vector2(s.max.x-s.min.x,s.max.y-s.min.y)).length(),n=(n=new fm.Vector2(r.x-i.x,r.y-i.y)).length(),e.mapScale=564*n/s,e.controls.panAdd({x:0,y:e.groupSpace/2,z:0})}}]),n}(S);t.default=S},function(e,t,n){e.exports=n(160)},function(e,t,n){n(161),e.exports=n(1).Reflect.construct},function(e,t,n){var r=n(3),i=n(46),o=n(63),a=n(23),s=n(18),u=n(19),l=n(165),c=(n(8).Reflect||{}).construct,h=u((function(){function e(){}return!(c((function(){}),[],e)instanceof e)})),f=!u((function(){c((function(){}))}));r(r.S+r.F*(h||f),"Reflect",{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(f&&!h)return c(e,t,n);if(e!=n)return r=n.prototype,n=i(s(r)?r:Object.prototype),r=Function.apply.call(e,n,t),s(r)?r:n;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(l.apply(e,r))}})},function(e,t,n){var r=n(29),i=n(103),o=n(163);e.exports=function(e){return function(t,n,a){var s,u=r(t),l=i(u.length),c=o(a,l);if(e&&n!=n){for(;c<l;)if((s=u[c++])!=s)return!0}else for(;c<l;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(66),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){n=n(8).document,e.exports=n&&n.documentElement},function(e,t,n){"use strict";var r=n(63),i=n(18),o=n(166),a=[].slice,s={};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),u=function r(){var i=n.concat(a.call(arguments));return this instanceof r?function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)}(t,i.length,i):o(t,i,e)};return i(t.prototype)&&(u.prototype=t.prototype),u}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){n(168),e.exports=n(1).Object.assign},function(e,t,n){var r=n(3);r(r.S+r.F,"Object",{assign:n(169)})},function(e,t,n){"use strict";var r=n(14),i=n(40),o=n(70),a=n(50),s=n(31),u=n(102),l=Object.assign;e.exports=!l||n(19)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var n=s(e),l=arguments.length,c=1,h=o.f,f=a.f;c<l;)for(var d,p=u(arguments[c++]),g=h?i(p).concat(h(p)):i(p),m=g.length,v=0;v<m;)d=g[v++],r&&!f.call(p,d)||(n[d]=p[d]);return n}:l},function(e,t,n){e.exports=n(171)},function(e,t,n){n(172),e.exports=n(1).Number.isNaN},function(e,t,n){(n=n(3))(n.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){n(174),e.exports=n(1).parseFloat},function(e,t,n){var r=n(3);n=n(175),r(r.G+r.F*(parseFloat!=n),{parseFloat:n})},function(e,t,n){var r=n(8).parseFloat,i=n(104).trim;e.exports=1/r(n(72)+"-0")!=-1/0?function(e){var t=i(String(e),3);return 0===(e=r(t))&&"-"==t.charAt(0)?-0:e}:r},function(e,t,n){var r=(n=n(1)).JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},function(e,t,n){e.exports=n(74)("native-function-to-string",Function.toString)},function(e,t,n){var r=n(179);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(21),i=n(180),o=n(4)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(32);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r=n(7);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){var r=n(21),i=n(183).set;e.exports=function(e,t,n){var o;return(t=t.constructor)!==n&&"function"==typeof t&&(o=t.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){var r=n(21),i=n(16),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(56)(Function.call,n(75).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(20),i=n(34),o=n(7),a=n(186),s=(n="["+a+"]",RegExp("^"+n+n+"*")),u=RegExp(n+n+"*$"),l=(n=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()}));t=i[e]=s?t(l):a[e],n&&(i[n]=t),r(r.P+r.F*s,"String",i)},n.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(u,"")),e});e.exports=n},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(15),i=n(16),o=n(113);e.exports=n(6)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,u=0;u<s;)r.f(e,n=a[u++],t[n]);return e}},function(e,t,n){"use strict";n(115)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},function(e,t,n){var r=n(117),i=n(192);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=r(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){n(191);var r=n(1).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){var r=n(3);r(r.S,"Object",{create:n(46)})},function(e,t,n){var r=n(118);function i(t,n){return e.exports=i=r||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,i(t,n)}e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){n(194),e.exports=n(1).Object.setPrototypeOf},function(e,t,n){var r=n(3);r(r.S,"Object",{setPrototypeOf:n(195).set})},function(e,t,n){var r=n(18),i=n(23),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(62)(Function.call,n(119).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){var r=n(120).default,i=n(116);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){n(198),n(202),n(203),n(204),e.exports=n(1).Symbol},function(e,t,n){"use strict";var r=n(8),i=n(24),o=n(14),a=n(3),s=n(122),l=n(199).KEY,c=n(19),h=n(68),f=n(80),d=n(49),p=n(13),g=n(81),m=n(82),v=n(200),y=n(123),_=n(23),x=n(18),A=n(31),I=n(29),w=n(64),b=n(39),C=n(46),M=n(201),E=n(119),T=n(70),S=n(17),L=n(40),k=E.f,R=S.f,N=M.f,P=r.Symbol,O=r.JSON,D=O&&O.stringify,F="prototype",B=p("_hidden"),G=p("toPrimitive"),z={}.propertyIsEnumerable,U=h("symbol-registry"),V=h("symbols"),H=h("op-symbols"),j=Object[F],W="function"==typeof P&&!!T.f,Y=!(ee=r.QObject)||!ee[F]||!ee[F].findChild,q=o&&c((function(){return 7!=C(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=k(j,t);r&&delete j[t],R(e,t,n),r&&e!==j&&R(j,t,r)}:R,X=function(e){var t=V[e]=C(P[F]);return t._k=e,t},Z=W&&"symbol"==u(P.iterator)?function(e){return"symbol"==u(e)}:function(e){return e instanceof P},J=function e(t,n,r){return t===j&&e(H,n,r),_(t),n=w(n,!0),_(r),i(V,n)?(r.enumerable?(i(t,B)&&t[B][n]&&(t[B][n]=!1),r=C(r,{enumerable:b(0,!1)})):(i(t,B)||R(t,B,b(1,{})),t[B][n]=!0),q(t,n,r)):R(t,n,r)},K=function(e,t){_(e);for(var n,r=v(t=I(t)),i=0,o=r.length;i<o;)J(e,n=r[i++],t[n]);return e},Q=function(e){var t=z.call(this,e=w(e,!0));return!(this===j&&i(V,e)&&!i(H,e))&&(!(t||!i(this,e)||!i(V,e)||i(this,B)&&this[B][e])||t)},$=function(e,t){if(e=I(e),t=w(t,!0),e!==j||!i(V,t)||i(H,t)){var n=k(e,t);return!n||!i(V,t)||i(e,B)&&e[B][t]||(n.enumerable=!0),n}},ee=(h=function(e){for(var t,n=N(I(e)),r=[],o=0;n.length>o;)i(V,t=n[o++])||t==B||t==l||r.push(t);return r},function(e){for(var t,n=e===j,r=N(n?H:I(e)),o=[],a=0;r.length>a;)!i(V,t=r[a++])||n&&!i(j,t)||o.push(V[t]);return o});W||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=d(0<arguments.length?arguments[0]:void 0);return o&&Y&&q(j,e,{configurable:!0,set:function t(n){this===j&&t.call(H,n),i(this,B)&&i(this[B],e)&&(this[B][e]=!1),q(this,e,b(1,n))}}),X(e)},s(P[F],"toString",(function(){return this._k})),E.f=$,S.f=J,n(124).f=M.f=h,n(50).f=Q,T.f=ee,o&&!n(48)&&s(j,"propertyIsEnumerable",Q,!0),g.f=function(e){return X(p(e))}),a(a.G+a.W+a.F*!W,{Symbol:P});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)p(te[ne++]);for(var re=L(p.store),ie=0;re.length>ie;)m(re[ie++]);a(a.S+a.F*!W,"Symbol",{for:function(e){return i(U,e+="")?U[e]:U[e]=P(e)},keyFor:function(e){if(!Z(e))throw TypeError(e+" is not a symbol!");for(var t in U)if(U[t]===e)return t},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),a(a.S+a.F*!W,"Object",{create:function(e,t){return void 0===t?C(e):K(C(e),t)},defineProperty:J,defineProperties:K,getOwnPropertyDescriptor:$,getOwnPropertyNames:h,getOwnPropertySymbols:ee}),ee=c((function(){T.f(1)})),a(a.S+a.F*ee,"Object",{getOwnPropertySymbols:function(e){return T.f(A(e))}}),O&&a(a.S+a.F*(!W||c((function(){var e=P();return"[null]"!=D([e])||"{}"!=D({a:e})||"{}"!=D(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;i<arguments.length;)r.push(arguments[i++]);if(n=t=r[1],(x(t)||void 0!==e)&&!Z(e))return y(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Z(t))return t}),r[1]=t,D.apply(O,r)}}),P[F][G]||n(28)(P[F],G,P[F].valueOf),f(P,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(e,t,n){var r=n(49)("meta"),i=n(18),o=n(24),a=n(17).f,s=0,l=Object.isExtensible||function(){return!0},c=!n(19)((function(){return l(Object.preventExtensions({}))})),h=function(e){a(e,r,{value:{i:"O"+ ++s,w:{}}})},f=(n=function(e){return c&&f.NEED&&l(e)&&!o(e,r)&&h(e),e},e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==u(e)?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!l(e))return"F";if(!t)return"E";h(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!l(e))return!0;if(!t)return!1;h(e)}return e[r].w},onFreeze:n})},function(e,t,n){var r=n(40),i=n(70),o=n(50);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,s=n(e),u=o.f,l=0;s.length>l;)u.call(e,a=s[l++])&&t.push(a);return t}},function(e,t,n){var r=n(29),i=n(124).f,o={}.toString,a="object"==("undefined"==typeof window?"undefined":u(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t){},function(e,t,n){n(82)("asyncIterator")},function(e,t,n){n(82)("observable")},function(e,t,n){n(126),n(208),e.exports=n(81).f("iterator")},function(e,t,n){var r=n(66),i=n(47);e.exports=function(e){return function(t,n){var o,a=String(i(t)),s=r(n);return t=a.length,s<0||t<=s?e?"":void 0:(n=a.charCodeAt(s))<55296||56319<n||s+1===t||(o=a.charCodeAt(s+1))<56320||57343<o?e?a.charAt(s):n:e?a.slice(s,s+2):o-56320+(n-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(46),i=n(39),o=n(80),a={};n(28)(a,n(13)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){n(209);for(var r=n(8),i=n(28),o=n(44),a=n(13)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var l,c=s[u];(l=(l=r[c])&&l.prototype)&&!l[a]&&i(l,a,c),o[c]=o.Array}},function(e,t,n){"use strict";var r=n(210),i=n(211),o=n(44),a=n(29);e.exports=n(127)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(118),i=n(213);function o(t){return e.exports=o=r?i:function(e){return e.__proto__||i(e)},e.exports.default=e.exports,e.exports.__esModule=!0,o(t)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(214)},function(e,t,n){n(215),e.exports=n(1).Object.getPrototypeOf},function(e,t,n){var r=n(31),i=n(128);n(129)("getPrototypeOf",(function(){return function(e){return i(r(e))}}))},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(30)),a=i(n(58)),s=i(n(220));n(73),n(43);var u=i(n(11)),l=i(n(12)),c=i(n(223)),h=i(n(224)),f=i(n(225));n=function(){function e(t){(0,u.default)(this,e),this.directionAssert=10,this.combineAsset=5,this.naviLanguage=h.default.ZH,this.completeDistance=0,this.map=null,this.combinePoints=[],this.dirArr=["north","northeast","east","southeast","south","southwest","west","northwest","north"],this.dirArr2=["front_pure","right_front_pure","right_pure","right_back_pure","back_pure","left_back_pure","left_pure","left_front_pure","front_pure"],this.dirArr3=["still_go_straight","right_front","turn_right","turn_right_rear","back_to","turn_left_rear","turn_left","left_front","still_go_straight"],this._boo=!1,this._tailLen=0,(0,o.default)(this,t)}return(0,l.default)(e,[{key:"tailLen",get:function(){return this._tailLen}},{key:"dispose",value:function(){this.map=null}},{key:"calculate",value:function(e){return this._calculate(e)}},{key:"_getNs",value:function(e){for(var t=[],n=0;n<e.length;n++)t=t.concat(e[n]._nodeList);return t}},{key:"_getField",value:function(e,t){var n=Math.PI/4,r=e/n;return e=(0,a.default)(r),r=r%1*n,e%2==0?t<r&&(e+=1):n-t<=r&&(e+=1),e}},{key:"_getAngle",value:function(e,t){var n=t.angleTo(e);return(e=new Geo.Vector3(t.x,t.z,t.y).cross(new Geo.Vector3(e.x,e.z,e.y))).z<0&&(n=2*Math.PI-n),n}},{key:"_getDirection",value:function(e,t){if(t==e.length-1)return{index:e[e.length-1].index};var n=new Geo.Vector3(0,0,1),r=n;0!=t&&((r=e[t].clone().sub(e[t-1]).normalize()).y=0,r.z*=-1),(i=e[t+1].clone().sub(e[t])).y=0;var i,o=i.length();return(i=i.normalize()).z*=-1,n=this._getField(this._getAngle(n,i),22.5*Geo._Math.DEG2RAD),r=this._getAngle(r,i),{relField:i=this._getField(r,this.directionAssert*Geo._Math.DEG2RAD),relDesc:this._getDescribeWord(this.dirArr2[i]),relAngle:r*Geo._Math.RAD2DEG,absField:n,absDesc:this._getDescribeWord(this.dirArr[n]),distance:o,index:e[t].index}}},{key:"_regularPoints",value:function(e,t){for(var n=this,r=e.map((function(e,t){return(e=n.map?f.default.toSceneCoord(n.map,e):f.default.toSceneCoord({center:{x:n.analyser.sceneData.scene.x,y:n.analyser.sceneData.scene.y}},e)).index=t,e})),i=[],o=0;o<r.length;o++){var a=this._getDirection(r,o);a.point=e[o],a.groupID=t,i.push(a)}for(var s=[i[0]],u=1;u<i.length;u++)i[u].relAngle<=this.combineAsset||360-i[u].relAngle<=this.combineAsset?s[s.length-1].distance+=i[u].distance:s.push(i[u]);return s}},{key:"_getGroupDes",value:function(e){var t="";return null!=this.map.getFMGroup(e)&&(e=this.map.getFMGroup(e),""+(t=this.naviLanguage==h.default.ZH?e._groupMessage.desc:e._groupMessage.gname.toUpperCase())!="null"&&""+t!=""&&""+t!="undefined"||(t=e._groupMessage.gname.toUpperCase())),t}},{key:"_getDesc",value:function(e,t,n,r,i){var o,a=e[t],s=e[t+1],u=this._getDescribeWord(this.dirArr3[s.relField]);return this._boo=t==e.length-3&&s.distance<this.completeDistance,u&&!this._boo||(r?(this._boo=!1,u||(o=this._getLadderType(e[t+1].point,n,i),i=n<r?this._getDescribeWord("up_to"):this._getDescribeWord("down_to"),n=this._getGroupDes(r),u=this._getDescribeWord("take")+o+" "+i+" "+n)):(this._boo&&(this._tailLen=s.distance),u=this._getDescribeWord("arrived"))),0==t?2==e.length?this._getDescribeWord("face_to")+" "+a.absDesc+" "+this._getDescribeWord("straight")+" "+Math.ceil(a.distance)+" "+this._getDescribeWord("meter")+" "+u:this._getDescribeWord("face_to")+" "+a.absDesc+" "+this._getDescribeWord("straight")+" "+Math.ceil(a.distance)+" "+this._getDescribeWord("meter")+" "+this._getDescribeWord(this.dirArr3[e[t+1].relField]):this._getDescribeWord("straight")+" "+Math.ceil(a.distance+(this._boo&&!r?s.distance:0))+" "+this._getDescribeWord("meter")+" "+u}},{key:"_getDescData",value:function(e,t,n,r){var i=e[t],o=e[t+1];return(t=this._getDescribeWord(this.dirArr3[e[t+1].relField]))&&!this._boo||(r?(n=n<r?this._getDescribeWord("up"):this._getDescribeWord("down"),this._getGroupDes(r),o.relDesc=n):o.relDesc="终"),{startPoint:i.point,startGID:i.groupID,startIndex:i.index,endPoint:o.point,endGID:o.groupID,endIndex:o.index,startDirection:i.absDesc,endDirection:o.relDesc,distance:i.distance+(this._boo&&!r?o.distance:0)}}},{key:"_getLadderType",value:function(e,t,n){e.z=this.map.getFMGroup(t).height;for(var r,i=s.default,o=-1,a=0;a<n.length;a++)n[a]&&(r=Math.pow(n[a].point.x-e.x,2)+Math.pow(n[a].point.y-e.y,2))<i&&(i=r,o=n[a].liftType);if(-1!=o)switch(o){case 2:return" "+this._getDescribeWord("stair_pure");case 3:return" "+this._getDescribeWord("escalator_pure");case 1:return" "+this._getDescribeWord("lift_pure")}return this._getDescribeWord("stair")}},{key:"_getDescribeWord",value:function(e){return(e=c.default[this.naviLanguage][e])||""}},{key:"_calculate",value:function(e){this.combinePoints=[];for(var t=[],n=[],r=null,i=null,o=null,a=null,s=0,u=[],l=!1,c=null,h=null,f=this._getNs(e),d=0;d<e.length;d++){if(r=(o=e[d]).groupId,i=null,d<e.length-1)for(var p=d;p<e.length;p++)if(e[p].groupId!=r){i=e[p].groupId;break}a=o.pointList;var g,m,v=this._regularPoints(a,r);if(1<v.length&&(this.combinePoints=this.combinePoints.concat(v)),1==v.length)(i||l)&&(l?n.length&&(d==e.length-1&&(t[t.length-1]+=" "+this._getDescribeWord("arrived"),n[n.length-1].endDirection=this._getDescribeWord("end")),n[n.length-1].endPoint=a[0],n[n.length-1].endGID=r):c!=r&&null!=c||(g=r<i?this._getDescribeWord("up_to"):this._getDescribeWord("down_to"),m=this._getGroupDes(i),h=this._getDescribeWord("take_stair")+" "+g+" "+m,t.push(h),n.push({startPoint:a[0],startDirection:r<i?this._getDescribeWord("up"):this._getDescribeWord("down"),startGID:r})),l=!l);else{c=r;for(var y=0;y<v.length-1&&!this._boo;y++)t.push(this._getDesc(v,y,r,i,f)),n.push(this._getDescData(v,y,r,i))}1<v.length&&(m=v.reduce((function(e,t){return e+(t.distance||0)}),0),u.push({groupID:r,distance:m}),s+=m)}return[t,n,s,u]}}]),e}(),t.default=n},function(e,t,n){n(218),e.exports=n(1).parseInt},function(e,t,n){var r=n(3);n=n(219),r(r.G+r.F*(parseInt!=n),{parseInt:n})},function(e,t,n){var r=n(8).parseInt,i=n(104).trim,o=(n=n(72),/^[-+]?0[xX]/);e.exports=8!==r(n+"08")||22!==r(n+"0x16")?function(e,t){return e=i(String(e),3),r(e,t>>>0||(o.test(e)?16:10))}:r},function(e,t,n){e.exports=n(221)},function(e,t,n){n(222),e.exports=9007199254740991},function(e,t,n){(n=n(3))(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={zh:{straight:"直行",still_go_straight:"继续直行",back_to:"后退",turn_right:"右转",turn_left:"左转",right_front:"右前方 继续直行",left_front:"左前方 继续直行",turn_right_rear:"右后方转",turn_left_rear:"左后方转",up:"上",down:"下",up_to:"上行到达",down_to:"下行到达",meter:"米",arrived:"到达目的地",front:"前方",stair:"楼梯",stair_pure:"楼梯",escalator_pure:"扶梯",lift_pure:"直梯",take:"乘",take_stair:"乘梯",front_pure:"前",right_front_pure:"右前",right_pure:"右",right_back_pure:"右后",back_pure:"后",left_back_pure:"左后",left_pure:"左",left_front_pure:"左前",east:"东",west:"西",south:"南",north:"北",southeast:"东南",northeast:"东北",southwest:"西南",northwest:"西北",face_to:"向",start:"起",end:"终"},en:{straight:"go straight",still_go_straight:"go straight",back_to:"back to",turn_right:"turn right",turn_left:"turn left",right_front:"go straight right front ",left_front:"go straight left front ",turn_right_rear:"turn right rear",turn_left_rear:"turn left rear",up:"up",down:"up",up_to:"up to",down_to:"down to",meter:"meter",arrived:"arrived",front:"front",stair:"stair",stair_pure:"stair",escalator_pure:"escalator",lift_pure:"lift",take:"take",take_stair:"take stair",front_pure:"front",right_front_pure:"right front",right_pure:"right",right_back_pure:"right back",back_pure:"back",left_back_pure:"left back",left_pure:"left",left_front_pure:"left front",east:"east",west:"west",south:"south",north:"north",southeast:"southeast",northeast:"northeast",southwest:"southwest",northwest:"northwest",face_to:"face to",start:"start",end:"end"}},t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={ZH:"zh",EN:"en",CHN:"zh"},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(58));n(83);var a=i(n(11)),s=i(n(12));n=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,null,[{key:"toColor",value:function(e){if("number"==typeof e)return e;var t=e.split(",");return 3<=t.length?(0,o.default)(t[0])<<16|(0,o.default)(t[1])<<8|(0,o.default)(t[2]):(console.error("color format error",e),0)}},{key:"toRgba",value:function(e){if("number"==typeof e)return"rgba("+(0,o.default)(255*new fm.Color(e).r)+","+(0,o.default)(255*new fm.Color(e).g)+","+(0,o.default)(255*new fm.Color(e).b)+",1)";var t=e.split(",");return 3<=t.length?"rgba("+(0,o.default)(t[0])+","+(0,o.default)(t[1])+","+(0,o.default)(t[2])+",1)":e}},{key:"bindEvent",value:function(e,t,n,r){e.addEventListener(n,(function(e){var n,i=e||window.event,o=i.target||i.srcElement,a=i.currentTarget;for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;0<=--n&&t.item(n)!==this;);return-1<n});o!==a;)o.matches(t)&&(n=o,r.call(n,i)),o=o.parentNode}))}},{key:"toSceneCoord",value:function(e,t){var n=0;return t.groupID&&(n=e.getFMGroup(t.groupID).height),new fm.Vector3(t.x-e.center.x,e.center.y+n,-t.y+e.center.y)}},{key:"removeFormArray",value:function(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)}},{key:"scrollTopAnFun",value:function(){var e,t=!1;return function n(r){var i=r.el,o=r.to,a=r.form,s=(r.time,o<a?"up":"bottom"),u=(a<o?o-a:o==a?0:a-o)/10,l=0,c=function(){t=!1,e=!1,0==a&&(i.scrollTop=0)};t?(e=0,window.setTimeout((function(){var e=Object(r,{to:i.scrollTop});t=!1,n(e)}),11)):(t=!0,e=u,function t(){var n;--e<=0?c():(n=function(){!1!==e&&(l=function(e){var t=e.val,n=e.nbak,r=e.n;return e=e.elTop,"up"==s?e+(n-r)*t:e-(n-r)*t}({val:10,nbak:u,n:e,elTop:o,VDIRECTIONE:s}),l&&(i.scrollTop=l),t())},window.setTimeout(n,10))}())}}},{key:"toVector",value:function(e){return e.hasOwnProperty("z")?new fm.Vector3(e.x,e.y,e.z):new fm.Vector2(e.x,e.y)}},{key:"sleep",value:function(e){for(var t=(new Date).getTime(),n=0;n<1e7&&!((new Date).getTime()-t>e);n++);}}]),e}(),t.default=n},function(e,t,n){var r=n(21),i=n(32),o=n(4)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(26),i=n(34);e.exports=function(e){return function(t,n){var o,a=String(i(t)),s=r(n);return t=a.length,s<0||t<=s?e?"":void 0:(n=a.charCodeAt(s))<55296||56319<n||s+1===t||(o=a.charCodeAt(s+1))<56320||57343<o?e?a.charAt(s):n:e?a.slice(s,s+2):o-56320+(n-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(84);n(20)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.default=void 0;var o,a=i(n(11)),s=i(n(12)),u=i(n(51)),l=i(n(134)),c=i(n(135)),h=i(n(234)),f=i(n(137)),d=n(269);function p(e,t){var n,r=this,i=null,a=this.MapOptions.mapServerURL,s="GET";"fengmap"===this.MapOptions.mapServerURL&&(a=f.default+"sdk/auth/downMaps",this.MapOptions.tile&&(a=f.default+"sdk/authLayered/downMaps"),n={mapId:(n=l.default.getCerityData(this.MapOptions.key,this.MapOptions.appName,e)).mapId,keyValue:n.appKey,appName:n.appName,webUrl:n.webURL,keyType:3,isSeparate:!1},i=(0,u.default)(n),s="POST"),this.fmServer.getScene(a,e,this.MapOptions.tile,i,s,(function(n,i){r.dataManager.putRawScene(n,e),(n=r.dataManager.parseScene(e,r.MapOptions.tile,r.MapOptions.license))&&(r.dataManager.putDecodeScene(n,e),t(n))}),(function(e){o&&o(e)})),this._currentSceneId=e}n=function(){function e(t){(0,a.default)(this,e),this.MapOptions=t,this.fmServer=new c.default,this.dataManager=new h.default}return(0,s.default)(e,[{key:"openMap",value:function(e,t){var n,r=this.MapOptions.mapID;function i(){"fengmap"===n.MapOptions.mapServerURL?l.default.checkIsOnLine((function(){l.default.checkOnLine(n.MapOptions.key,n.MapOptions.appName,r,(function(t){p.call(n,r,e)}),(function(e){e?(console.warn(e.error_code,e.error_message),t&&t({msg:"线上验证失败!",data:e})):(console.warn("offLine 2"),p.call(n,r))}),"POST")}),(function(){console.warn("offLine 1"),p.call(n,r,e)}),1e3):p.call(n,r,e)}function a(){p.call(n,r)}o=t,r?this.MapOptions.key?/^[a-zA-z\d]{32}$/.test(this.MapOptions.key)?this.MapOptions.appName?(this._zopStep_=1,n=this,this.MapOptions.useCompatibleOnLineCheck?this.isOnLine(i,a):(navigator.onLine?i:a)()):console.warn(decodeURIComponent(d.cerityMessage.warn_noappname)):console.warn(decodeURIComponent(d.cerityMessage.warn_keynotright)):console.warn(decodeURIComponent(d.cerityMessage.warn_nokey)):console.warn(decodeURIComponent(d.cerityMessage.warn_nomapid))}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.default=void 0,n(60),n(87);var o,a,s,u,l,c,h,f,d,p,g,m=i(n(58));o=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],a=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],s=0,u=0,l=[2,0,0,0],c=function(e,t){var n=0,r=0,i=0;for(r=0;r<8;r++)1&t&&(n^=e),i=128&e,e<<=1,i&&(e^=27),t>>=1;return n},h=function(e,t,n){for(var r=0;r<4;r++)e[0+r]^=t[16*n+4*r],e[4+r]^=t[16*n+4*r+1],e[8+r]^=t[16*n+4*r+2],e[12+r]^=t[16*n+4*r+3]},f=function(e){for(var t,n,r,i=1;i<4;i++)for(n=0;n<i;){for(r=e[4*i+4-1],t=3;0<t;t--)e[4*i+t]=e[4*i+t-1];e[4*i+0]=r,n++}},d=function(e){for(var t,n,r,i=0;i<4;i++)for(t=0;t<4;t++)n=(240&e[4*i+t])>>4,r=15&e[4*i+t],e[4*i+t]=a[16*n+r]},p=function(e){for(var t=0;t<4;t++)e[t]=o[16*((240&e[t])>>4)+(15&e[t])]},g=function(e){return(0,m.default)(e,16)},n={decryption:function(e,t){for(var n=Array(16),r=0;r<16;r++)n[r]=16*g(t.substr(2*r,1))+g(t.substr(2*r+1,1));var i=Array(16);for(r=0;r<16;r++)i[r]=16*g(e.substr(2*r,1))+g(e.substr(2*r+1,1));var o=Array(16);switch(r=[],n.length){default:case 16:s=4,u=10;break;case 24:s=6,u=12;break;case 32:s=8,u=14}for(var a=r=Array(16*(u+1)),m=Array(4),v=4*(u+1),y=0;y<s;y++)a[4*y+0]=n[4*y+0],a[4*y+1]=n[4*y+1],a[4*y+2]=n[4*y+2],a[4*y+3]=n[4*y+3];for(y=s;y<v;y++){if(m[0]=a[4*(y-1)+0],m[1]=a[4*(y-1)+1],m[2]=a[4*(y-1)+2],m[3]=a[4*(y-1)+3],0==y%s){var _=void 0,x=void 0;for(_=(n=m)[0],x=0;x<3;x++)n[x]=n[x+1];if(n[3]=_,p(m),1==(n=y/s))l[0]=1;else if(1<n)for(l[0]=2,n--;0<n-1;)l[0]=c(l[0],2),n--;n=m,_=l,(x=m)[0]=n[0]^_[0],x[1]=n[1]^_[1],x[2]=n[2]^_[2],x[3]=n[3]^_[3]}else 6<s&&4==y%s&&p(m);a[4*y+0]=a[4*(y-s)+0]^m[0],a[4*y+1]=a[4*(y-s)+1]^m[1],a[4*y+2]=a[4*(y-s)+2]^m[2],a[4*y+3]=a[4*(y-s)+3]^m[3]}for(a=Array(16),m=0;m<4;m++)for(y=0;y<4;y++)a[4*m+y]=i[m+4*y];for(h(a,r,u),i=u-1;1<=i;i--)for(f(a),d(a),h(a,r,i),m=a,y=[14,9,13,11],v=x=void 0,n=Array(4),_=Array(4),v=0;v<4;v++){for(x=0;x<4;x++)n[x]=m[4*x+v];x=y;var A=n,I=_;for(I[0]=c(x[0],A[0])^c(x[3],A[1])^c(x[2],A[2])^c(x[1],A[3]),I[1]=c(x[1],A[0])^c(x[0],A[1])^c(x[3],A[2])^c(x[2],A[3]),I[2]=c(x[2],A[0])^c(x[1],A[1])^c(x[0],A[2])^c(x[3],A[3]),I[3]=c(x[3],A[0])^c(x[2],A[1])^c(x[1],A[2])^c(x[0],A[3]),x=0;x<4;x++)m[4*x+v]=_[x]}for(f(a),d(a),h(a,r,0),m=0;m<4;m++)for(y=0;y<4;y++)o[m+4*y]=a[4*m+y];for(i="",r=0;r<16;++r)(a=o[r].toString(16)).length<2&&(a="0"+a),i+=a;return i}},t.default=n},function(e,t,n){n(6)&&"g"!=/./g.flags&&n(15).f(RegExp.prototype,"flags",{configurable:!0,get:n(85)})},function(e,t,n){"use strict";var r;function i(e,t){var n=(65535&e)+(65535&t);return(t=(e>>16)+(t>>16)+(n>>16))<<16|65535&n}function o(e,t,n,r,o,a){return i(function(e,t){return e<<t|e>>>32-t}(i(i(t,e),i(r,a)),o),n)}function a(e,t,n,r,i,a,s){return o(t&n|~t&r,e,t,i,a,s)}function s(e,t,n,r,i,a,s){return o(t&r|n&~r,e,t,i,a,s)}function u(e,t,n,r,i,a,s){return o(t^n^r,e,t,i,a,s)}function l(e,t,n,r,i,a,s){return o(n^(t|~r),e,t,i,a,s)}function c(e,t){var n,r,o,c;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var h=1732584193,f=-271733879,d=-1732584194,p=271733878,g=0;g<e.length;g+=16)n=h,r=f,o=d,c=p,h=a(h,f,d,p,e[g],7,-680876936),p=a(p,h,f,d,e[g+1],12,-389564586),d=a(d,p,h,f,e[g+2],17,606105819),f=a(f,d,p,h,e[g+3],22,-1044525330),h=a(h,f,d,p,e[g+4],7,-176418897),p=a(p,h,f,d,e[g+5],12,1200080426),d=a(d,p,h,f,e[g+6],17,-1473231341),f=a(f,d,p,h,e[g+7],22,-45705983),h=a(h,f,d,p,e[g+8],7,1770035416),p=a(p,h,f,d,e[g+9],12,-1958414417),d=a(d,p,h,f,e[g+10],17,-42063),f=a(f,d,p,h,e[g+11],22,-1990404162),h=a(h,f,d,p,e[g+12],7,1804603682),p=a(p,h,f,d,e[g+13],12,-40341101),d=a(d,p,h,f,e[g+14],17,-1502002290),h=s(h,f=a(f,d,p,h,e[g+15],22,1236535329),d,p,e[g+1],5,-165796510),p=s(p,h,f,d,e[g+6],9,-1069501632),d=s(d,p,h,f,e[g+11],14,643717713),f=s(f,d,p,h,e[g],20,-373897302),h=s(h,f,d,p,e[g+5],5,-701558691),p=s(p,h,f,d,e[g+10],9,38016083),d=s(d,p,h,f,e[g+15],14,-660478335),f=s(f,d,p,h,e[g+4],20,-405537848),h=s(h,f,d,p,e[g+9],5,568446438),p=s(p,h,f,d,e[g+14],9,-1019803690),d=s(d,p,h,f,e[g+3],14,-187363961),f=s(f,d,p,h,e[g+8],20,1163531501),h=s(h,f,d,p,e[g+13],5,-1444681467),p=s(p,h,f,d,e[g+2],9,-51403784),d=s(d,p,h,f,e[g+7],14,1735328473),h=u(h,f=s(f,d,p,h,e[g+12],20,-1926607734),d,p,e[g+5],4,-378558),p=u(p,h,f,d,e[g+8],11,-2022574463),d=u(d,p,h,f,e[g+11],16,1839030562),f=u(f,d,p,h,e[g+14],23,-35309556),h=u(h,f,d,p,e[g+1],4,-1530992060),p=u(p,h,f,d,e[g+4],11,1272893353),d=u(d,p,h,f,e[g+7],16,-155497632),f=u(f,d,p,h,e[g+10],23,-1094730640),h=u(h,f,d,p,e[g+13],4,681279174),p=u(p,h,f,d,e[g],11,-358537222),d=u(d,p,h,f,e[g+3],16,-722521979),f=u(f,d,p,h,e[g+6],23,76029189),h=u(h,f,d,p,e[g+9],4,-640364487),p=u(p,h,f,d,e[g+12],11,-421815835),d=u(d,p,h,f,e[g+15],16,530742520),h=l(h,f=u(f,d,p,h,e[g+2],23,-995338651),d,p,e[g],6,-198630844),p=l(p,h,f,d,e[g+7],10,1126891415),d=l(d,p,h,f,e[g+14],15,-1416354905),f=l(f,d,p,h,e[g+5],21,-57434055),h=l(h,f,d,p,e[g+12],6,1700485571),p=l(p,h,f,d,e[g+3],10,-1894986606),d=l(d,p,h,f,e[g+10],15,-1051523),f=l(f,d,p,h,e[g+1],21,-2054922799),h=l(h,f,d,p,e[g+8],6,1873313359),p=l(p,h,f,d,e[g+15],10,-30611744),d=l(d,p,h,f,e[g+6],15,-1560198380),f=l(f,d,p,h,e[g+13],21,1309151649),h=l(h,f,d,p,e[g+4],6,-145523070),p=l(p,h,f,d,e[g+11],10,-1120210379),d=l(d,p,h,f,e[g+2],15,718787259),f=l(f,d,p,h,e[g+9],21,-343485551),h=i(h,n),f=i(f,r),d=i(d,o),p=i(p,c);return[h,f,d,p]}function h(e){for(var t="",n=32*e.length,r=0;r<n;r+=8)t+=String.fromCharCode(e[r>>5]>>>r%32&255);return t}function f(e){var t=[];for(t[(e.length>>2)-1]=void 0,r=0;r<t.length;r+=1)t[r]=0;for(var n=8*e.length,r=0;r<n;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t}function d(e){for(var t,n="0123456789abcdef",r="",i=0;i<e.length;i+=1)t=e.charCodeAt(i),r+=n.charAt(t>>>4&15)+n.charAt(15&t);return r}function p(e){return unescape(encodeURIComponent(e))}function g(e){return function(e){return h(c(f(e),8*e.length))}(p(e))}function m(e){return d(g(e))}(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,r=function(e){return function(e,t,n){return m(e)}(e)},n={encryption:function(e){return r(e)}},t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(11)),a=i(n(12));n=function(){function e(){(0,o.default)(this,e),this.requestMethod="GET",this._requestHeader={},this.sendData=null}return(0,a.default)(e,[{key:"getFile",value:function(e,t,n,r,i){void 0!==this._path&&(e=this._path+e);var o,a=new XMLHttpRequest;for(o in a.open(this.requestMethod,e,!0),a.addEventListener("load",(function(e){var r=this.response;200===this.status||0===this.status||201===this.status?(0===this.status&&console.warn("FMMap FileLoader: HTTP Status 0 received."),t(r)):n(r)}),!1),a.addEventListener("progress",(function(e){r&&r()}),!1),a.addEventListener("error",(function(e){n()}),!1),a.addEventListener("abort",(function(e){i&&i()}),!1),void 0!==this._responseType&&(a.responseType=this._responseType),void 0!==this._withCredentials&&(a.withCredentials=this._withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this._mimeType?this._mimeType:"text/plain"),this._requestHeader)a.setRequestHeader(o,this._requestHeader[o]);a.send(this.sendData)}},{key:"setPath",value:function(e){return this._path=e,this}},{key:"setResponseType",value:function(e){return this._responseType=e,this}},{key:"setWithCredentials",value:function(e){return this._withCredentials=e,this}},{key:"setMimeType",value:function(e){return this._mimeType=e,this}},{key:"setRequestHeader",value:function(e){return e&&(this._requestHeader=e),this}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(0),i=n(2);r(t,"__esModule",{value:!0}),t.default=void 0,n(110),n(43);var o=i(n(11)),a=i(n(12)),s=i(n(235)),u=i(n(267)),l=i(n(268));n=function(){function e(){(0,o.default)(this,e),this._sceneRawData={},this._sceneDecodeData={},this._reader=new s.default,this.file_ver=1}return(0,a.default)(e,[{key:"putRawScene",value:function(e,t){this.sceneRawData[t+""]=e}},{key:"removeRawScene",value:function(e){this.sceneRawData[e+""]=void 0}},{key:"parseScene",value:function(e,t,n,r){if(e=t?this._reader.sceneDecode(this.sceneRawData[e+""],n,e):this._reader.mapDecode(this.sceneRawData[e+""],n,e)){t&&(e={scene:e,floors:[]});for(var i=e.scene.layerGroups,o=0;o<i.length;o++){var a=i[o];a.elevation=a.height}return e}}},{key:"parseFloor",value:function(e,t,n){return[e=this._reader.floorGeoDecode(e),t=this._reader.floorBizDecode(t),n=this._reader.floorNaviDecode(n)]}},{key:"isSceneHasZone",value:function(e){if(!e)return!1;if(!(e=this._sceneDecodeData[e+""]))return!1;var t=!1;return e.floors.forEach((function(e){0<e.navi[0].naviZones.length&&(t=!0)})),t}},{key:"putDecodeScene",value:function(e,t){this.file_ver=e.scene.file_ver,this.sceneDecodeData[t+""]=e}},{key:"removeDecodeScene",value:function(e){this.sceneDecodeData[e+""]=void 0}},{key:"getRawScene",value:function(e){return this.sceneRawData[e+""]}},{key:"getDecodeScene",value:function(e){return this.sceneDecodeData[e+""]}},{key:"dispose",value:function(){for(var e in this._reader.dispose(),this.sceneRawData)this.sceneRawData[e]=void 0;for(var t in this.sceneDecodeData)this.sceneDecodeData[t]=void 0;this.sceneRawData=void 0,this.sceneDecodeData=void 0}},{key:"disposeById",value:function(e){this.sceneRawData[e]=void 0,this.sceneDecodeData[e]=void 0}},{key:"sceneRawData",get:function(){return this._sceneRawData},set:function(e){this._sceneRawData=e}},{key:"sceneDecodeData",get:function(){return this._sceneDecodeData},set:function(e){this._sceneDecodeData=e}}],[{key:"convertGeo2Geometry",value:function(e){var t=(new u.default).parse(e);return e={vertices:t.toStrip(!0)},t.hasHoles()&&(e.holes=t.toStripHoles(!0)),e}},{key:"convertArr2Geometry",value:function(e,t){for(var n=e[0].idxs[0],r=[],i=0;i<n-2;i+=2)r.push(t[i]),r.push(t[i+1]);var o={vertices:r};if(1<e.length){for(var a=[],s=1;s<e.length;s++){for(var u=e[s-1],l=e[s],c=[],h=u;h<l-2;h+=2)c.push(t[h]),c.push(t[h+1]);a.push(c)}o.holes=a}return o}},{key:"convertArray2Geometry",value:function(e,t){return t={vertices:(e=(new l.default).parseGeometry(e,t)).toStrip(!0)},e.hasHoles()&&(t.holes=e.toStripHoles(!0)),t}},{key:"convertGeo2Points",value:function(e){return{vertices:(e=(new u.default).parse(e)).points}}},{key:"convertArrayPoints",value:function(e,t){return{vertices:(t=(new l.default).parse(e,t)).points}}},{key:"checkClockwise",value:function(e){for(var t=Number.NEGATIVE_INFINITY,n=0,r=0,i=0,o=0;o<e.length;o+=2)e[o]>t&&(t=e[o],n=o);var a=new fm.Vector3(e[n],e[n+1],0);return r=0===n?e.length-2:n-2,i=n===e.length-2?0:n+2,r=new fm.Vector3(e[r],e[r+1],0),i=new fm.Vector3(e[i],e[i+1],0),r=(new fm.Vector3).copy(a).sub(r),a=(new fm.Vector3).copy(i).sub(a),0<(a=r.cross(a)).z}}]),e}(),t.default=n},function(e,t,n){"use strict";var r=n(236),i=n(121),o=n(125),a=n(138),s=n(0);n(60),n(139);var u=n(2);s(t,"__esModule",{value:!0}),t.default=void 0,n(86);var l=u(n(11)),c=u(n(12)),h=u(n(247)),f=u(n(265)),d=u(n(266)),p=u(n(134));function g(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n=function(){function e(){(0,l.default)(this,e)}return(0,c.default)(e,[{key:"mapDecode",value:function(e,t,n){var r=h.default.build("Map").decode(e);if(e="%E8%AF%B7%E8%BE%93%E5%85%A5%E6%AD%A3%E7%A1%AE%E7%9A%84license.",p.default.ls&&!p.default.checkLicense(r.key,t,n))return console.warn(decodeURIComponent(e)),null;for(var i={scene:null,floors:[]},o=0,a=r.buffers.length;o<a;o++){var s,u,l,c=r.buffers[o],g=c.len,m=c.data.offset,v=c.data.offset+g.low,y=c.data.buffer;1==c.btype?(u=d.default.build("Scene").decode(y.slice(m,v)),i.scene=u):(s=c.gid,u=(g=this.containsFloor(s,i.floors)).floor,g.index<0&&(u.gid=s,u.biz=[],u.navi=[],u.geo=[]),2==c.btype&&(l=f.default.build("FloorGeo").decode(y.slice(m,v)),u.geo.push(l)),3==c.btype&&(l=f.default.build("FloorBiz").decode(y.slice(m,v)),u.biz.push(l)),4==c.btype&&(v=f.default.build("FloorNavi").decode(y.slice(m,v)),u.navi.push(v)),g.index<0?i.floors.push(u):i.floors[g.index]=u)}return i}},{key:"containsFloor",value:function(e,t){for(var n=0,r=t.length;n<r;n++)if(t[n].gid==e)return{index:n,floor:t[n]};return{index:-1,floor:{}}}},{key:"sceneDecode",value:function(e,t,n){var r=d.default.build("Scene").decode(e);return e="%E8%AF%B7%E8%BE%93%E5%85%A5%E6%AD%A3%E7%A1%AE%E7%9A%84license.",p.default.ls&&!p.default.checkLicense(r.key,t,n)?(console.warn(decodeURIComponent(e)),null):r}},{key:"floorGeoDecode",value:function(e){return f.default.build("FloorGeo").decode(e)}},{key:"floorBizDecode",value:function(e){return f.default.build("FloorBiz").decode(e)}},{key:"floorNaviDecode",value:function(e){return f.default.build("FloorNavi").decode(e)}},{key:"disposeRoot",value:function(e){var t,n=e.ns,r=function(e,t){var n=void 0!==i&&e[o]||e["@@iterator"];if(!n){if(a(e)||(n=g(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){l=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw s}}}}(n.children);try{for(r.s();!(t=r.n()).done;){var s=t.value;s.builder=void 0,s.parent=void 0,s.children.length=0,s._fields.length=0,s._fieldsById=void 0,s._fieldsByName=void 0}}catch(e){r.e(e)}finally{r.f()}n.children.length=0,e.ns=void 0,e.ptr=void 0}},{key:"dispose",value:function(){}}]),e}(),t.default=n},function(e,t,n){e.exports=n(237)},function(e,t,n){n(126),n(238),e.exports=n(1).Array.from},function(e,t,n){"use strict";var r=n(62),i=n(3),o=n(31),a=n(239),s=n(240),u=n(103),l=n(241),c=n(242);i(i.S+i.F*!n(244)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,h,f=o(e),d="function"==typeof this?this:Array,p=arguments.length,g=1<p?arguments[1]:void 0,m=void 0!==g,v=0;if(e=c(f),m&&(g=r(g,2<p?arguments[2]:void 0,2)),null==e||d==Array&&s(e))for(n=new d(t=u(f.length));v<t;v++)l(n,v,m?g(f[v],v):f[v]);else for(h=e.call(f),n=new d;!(i=h.next()).done;v++)l(n,v,m?a(h,g,[i.value,v],!0):i.value);return n.length=v,n}})},function(e,t,n){var r=n(23);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){throw void 0!==(n=e.return)&&r(n.call(e)),t}}},function(e,t,n){var r=n(44),i=n(13)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){"use strict";var r=n(17),i=n(39);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(243),i=n(13)("iterator"),o=n(44);e.exports=n(1).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){var r=n(65),i=n(13)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?e:o?r(t):"Object"==(e=r(t))&&"function"==typeof t.callee?"Arguments":e}},function(e,t,n){var r=n(13)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){n(246),e.exports=n(1).Array.isArray},function(e,t,n){var r=n(3);r(r.S,"Array",{isArray:n(123)})},function(e,t,n){"use strict";n(0)(t,"__esModule",{value:!0}),t.default=void 0,n=(n=n(88)).ProtoBuf.newBuilder({}).import({messages:[{name:"Map",fields:[{rule:"required",type:"string",name:"mid",id:1},{rule:"required",type:"int32",name:"file_ver",id:2},{rule:"required",type:"uint64",name:"date_ver",id:3},{rule:"required",type:"string",name:"mname",id:4},{rule:"required",type:"string",name:"hash_code",id:5},{rule:"optional",type:"string",name:"key",id:6},{rule:"optional",type:"string",name:"file_date",id:7},{rule:"optional",type:"string",name:"desc",id:8},{rule:"optional",type:"bool",name:"read_only",id:9,options:{default:!1}},{rule:"repeated",type:"Buffer",name:"buffers",id:10}],messages:[{name:"Buffer",fields:[{rule:"required",type:"int32",name:"gid",id:1},{rule:"required",type:"int32",name:"file_ver",id:2},{rule:"required",type:"int32",name:"btype",id:3},{rule:"required",type:"uint64",name:"len",id:4},{rule:"required",type:"bytes",name:"data",id:5}]}]}]}),t.default=n},function(e,t,n){n(249)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){"use strict";var r,i,o,a,s,l,c,h,f,d,p,g,m,v,y,_,x,A,I,w,b,C,M,E,T,S,L,k,R,N,P,O,D,F,B,G,z,U,V,H,j,W,Y,q,X,Z,J,K,Q,$,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,he,fe,de,pe,ge,me,ve,ye,_e,xe,Ae,Ie,we,be,Ce,Me,Ee,Te,Se,Le,ke,Re,Ne,Pe,Oe,De,Fe,Be,Ge,ze,Ue,Ve;n(6)?(r=n(55),i=n(5),o=n(7),a=n(20),s=n(140),l=n(250),c=n(56),h=n(142),f=n(54),d=n(9),p=n(141),g=n(26),m=n(10),v=n(143),y=n(42),_=n(53),x=n(25),A=n(59),I=n(21),w=n(33),b=n(251),C=n(79),M=n(144),E=n(76).f,T=n(252),ze=n(41),Le=n(4),Ue=n(108),S=n(112),L=n(130),k=n(91),R=n(36),N=n(256),P=n(257),O=n(89),D=n(258),F=n(15),B=n(75),G=F.f,z=B.f,U=i.RangeError,V=i.TypeError,H=i.Uint8Array,W="Shared"+(j="ArrayBuffer"),Y="BYTES_PER_ELEMENT",q="prototype",n=Array[q],X=l.ArrayBuffer,Z=l.DataView,J=Ue(0),K=Ue(2),Q=Ue(3),$=Ue(4),ee=Ue(5),te=Ue(6),ne=S(!0),re=S(!1),ie=k.values,oe=k.keys,ae=k.entries,se=n.lastIndexOf,ue=n.reduce,le=n.reduceRight,ce=n.join,he=n.sort,fe=n.slice,de=n.toString,pe=n.toLocaleString,ge=Le("iterator"),me=Le("toStringTag"),ve=ze("typed_constructor"),ye=ze("def_constructor"),n=s.CONSTR,_e=s.TYPED,xe=s.VIEW,Ae="Wrong length!",Ie=Ue(1,(function(e,t){return Ee(L(e,e[ye]),t)})),we=o((function(){return 1===new H(new Uint16Array([1]).buffer)[0]})),be=!!H&&!!H[q].set&&o((function(){new H(1).set({})})),Ce=function(e,t){if((e=g(e))<0||e%t)throw U("Wrong offset!");return e},Me=function(e){if(I(e)&&_e in e)return e;throw V(e+" is not a typed array!")},Ee=function(e,t){if(!I(e)||!(ve in e))throw V("It is not a typed array constructor!");return new e(t)},Te=function(e,t){return Se(L(e,e[ye]),t)},Se=function(e,t){for(var n=0,r=t.length,i=Ee(e,r);n<r;)i[n]=t[n++];return i},Le=function(e,t,n){G(e,t,{get:function(){return this._d[n]}})},ke=function(e){var t,n,r,i,o,a,s=w(e),u=arguments.length,l=1<u?arguments[1]:void 0,h=void 0!==l;if(null!=(e=T(s))&&!b(e)){for(a=e.call(s),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);s=r}for(h&&2<u&&(l=c(l,arguments[2],2)),t=0,n=m(s.length),i=Ee(this,n);t<n;t++)i[t]=h?l(s[t],t):s[t];return i},Re=function(){for(var e=0,t=arguments.length,n=Ee(this,t);e<t;)n[e]=arguments[e++];return n},Ne=!!H&&o((function(){pe.call(new H(1))})),Pe=function(){return pe.apply(Ne?fe.call(Me(this)):Me(this),arguments)},Oe={copyWithin:function(e,t){return D.call(Me(this),e,t,2<arguments.length?arguments[2]:void 0)},every:function(e){return $(Me(this),e,1<arguments.length?arguments[1]:void 0)},fill:function(e){return O.apply(Me(this),arguments)},filter:function(e){return Te(this,K(Me(this),e,1<arguments.length?arguments[1]:void 0))},find:function(e){return ee(Me(this),e,1<arguments.length?arguments[1]:void 0)},findIndex:function(e){return te(Me(this),e,1<arguments.length?arguments[1]:void 0)},forEach:function(e){J(Me(this),e,1<arguments.length?arguments[1]:void 0)},indexOf:function(e){return re(Me(this),e,1<arguments.length?arguments[1]:void 0)},includes:function(e){return ne(Me(this),e,1<arguments.length?arguments[1]:void 0)},join:function(e){return ce.apply(Me(this),arguments)},lastIndexOf:function(e){return se.apply(Me(this),arguments)},map:function(e){return Ie(Me(this),e,1<arguments.length?arguments[1]:void 0)},reduce:function(e){return ue.apply(Me(this),arguments)},reduceRight:function(e){return le.apply(Me(this),arguments)},reverse:function(){for(var e,t=this,n=Me(t).length,r=Math.floor(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t},some:function(e){return Q(Me(this),e,1<arguments.length?arguments[1]:void 0)},sort:function(e){return he.call(Me(this),e)},subarray:function(e,t){var n=Me(this),r=n.length;return e=y(e,r),new(L(n,n[ye]))(n.buffer,n.byteOffset+e*n.BYTES_PER_ELEMENT,m((void 0===t?r:y(t,r))-e))}},De=function(e,t){return Te(this,fe.call(Me(this),e,t))},Fe=function(e){Me(this);var t=Ce(arguments[1],1),n=this.length,r=w(e),i=m(r.length),o=0;if(n<i+t)throw U(Ae);for(;o<i;)this[t+o]=r[o++]},Be={entries:function(){return ae.call(Me(this))},keys:function(){return oe.call(Me(this))},values:function(){return ie.call(Me(this))}},Ge=function(e,t){return I(e)&&e[_e]&&"symbol"!=u(t)&&t in e&&String(+t)==String(t)},ze=function(e,t){return Ge(e,t=_(t,!0))?f(2,e[t]):z(e,t)},Ue=function(e,t,n){return!(Ge(e,t=_(t,!0))&&I(n)&&x(n,"value"))||x(n,"get")||x(n,"set")||n.configurable||x(n,"writable")&&!n.writable||x(n,"enumerable")&&!n.enumerable?G(e,t,n):(e[t]=n.value,e)},n||(B.f=ze,F.f=Ue),a(a.S+a.F*!n,"Object",{getOwnPropertyDescriptor:ze,defineProperty:Ue}),o((function(){de.call({})}))&&(de=pe=function(){return ce.call(this)}),Ve=p({},Oe),p(Ve,Be),d(Ve,ge,Be.values),p(Ve,{slice:De,set:Fe,constructor:function(){},toString:de,toLocaleString:Pe}),Le(Ve,"buffer","b"),Le(Ve,"byteOffset","o"),Le(Ve,"byteLength","l"),Le(Ve,"length","e"),G(Ve,me,{get:function(){return this[_e]}}),e.exports=function(e,t,n,u){var l=e+((u=!!u)?"Clamped":"")+"Array",c="get"+e,f="set"+e,p=i[l],g=p||{},y=p&&M(p),_=!p||!s.ABV,x=(e={},p&&p[q]),w=function(e,n){G(e,n,{get:function(){return function(e,n){return(e=e._d).v[c](n*t+e.o,we)}(this,n)},set:function(e){return function(e,n,r){e=e._d,u&&(r=(r=Math.round(r))<0?0:255<r?255:255&r),e.v[f](n*t+e.o,r,we)}(this,n,e)},enumerable:!0})};_?(p=n((function(e,n,r,i){h(e,p,l,"_d");var o,a,s=0,u=0;if(I(n)){if(!(n instanceof X||(c=A(n))==j||c==W))return _e in n?Se(p,n):ke.call(p,n);var c=n;if(u=Ce(r,t),r=n.byteLength,void 0===i){if(r%t)throw U(Ae);if((o=r-u)<0)throw U(Ae)}else if(r<(o=m(i)*t)+u)throw U(Ae);a=o/t}else a=v(n),c=new X(o=a*t);for(d(e,"_d",{b:c,o:u,l:o,e:a,v:new Z(c)});s<a;)w(e,s++)})),x=p[q]=C(Ve),d(x,"constructor",p)):o((function(){p(1)}))&&o((function(){new p(-1)}))&&N((function(e){new p,new p(null),new p(1.5),new p(e)}),!0)||(p=n((function(e,n,r,i){var o;return h(e,p,l),I(n)?n instanceof X||(o=A(n))==j||o==W?void 0!==i?new g(n,Ce(r,t),i):void 0!==r?new g(n,Ce(r,t)):new g(n):_e in n?Se(p,n):ke.call(p,n):new g(v(n))})),J(y!==Function.prototype?E(g).concat(E(y)):E(g),(function(e){e in p||d(p,e,g[e])})),p[q]=x,r||(x.constructor=p)),n=!!(_=x[ge])&&("values"==_.name||null==_.name),y=Be.values,d(p,ve,!0),d(x,_e,l),d(x,xe,!0),d(x,ye,p),(u?new p(1)[me]==l:me in x)||G(x,me,{get:function(){return l}}),e[l]=p,a(a.G+a.W+a.F*(p!=g),e),a(a.S,l,{BYTES_PER_ELEMENT:t}),a(a.S+a.F*o((function(){g.of.call(p,1)})),l,{from:ke,of:Re}),Y in x||d(x,Y,t),a(a.P,l,Oe),P(l),a(a.P+a.F*be,l,{set:Fe}),a(a.P+a.F*!n,l,Be),r||x.toString==de||(x.toString=de),a(a.P+a.F*o((function(){new p(1).slice()})),l,{slice:De}),a(a.P+a.F*(o((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!o((function(){x.toLocaleString.call([1,2])}))),l,{toLocaleString:Pe}),R[l]=n?_:y,r||n||d(x,ge,y)}):e.exports=function(){}},function(e,t,n){"use strict";var r=n(5),i=n(6),o=n(55),a=n(140),s=n(9),u=n(141),l=n(7),c=n(142),h=n(26),f=n(10),d=n(143),p=n(76).f,g=n(15).f,m=n(89),v=n(90),y="ArrayBuffer",_="DataView",x="prototype",A="Wrong index!",I=r[y],w=r[_],b=r.Math,C=r.RangeError,M=r.Infinity,E=I,T=b.abs,S=b.pow,L=b.floor,k=b.log,R=b.LN2,N=(n="buffer",r="byteLength",b="byteOffset",i?"_b":n),P=i?"_l":r,O=i?"_o":b;function D(e,t,n){var r,i,o=new Array(n),a=8*n-t-1,s=(1<<a)-1,u=s>>1,l=23===t?S(2,-24)-S(2,-77):0,c=0,h=e<0||0===e&&1/e<0?1:0;for((e=T(e))!=e||e===M?(i=e!=e?1:0,r=s):(r=L(k(e)/R),e*(n=S(2,-r))<1&&(r--,n*=2),2<=(e+=1<=r+u?l/n:l*S(2,1-u))*n&&(r++,n/=2),s<=r+u?(i=0,r=s):1<=r+u?(i=(e*n-1)*S(2,t),r+=u):(i=e*S(2,u-1)*S(2,t),r=0));8<=t;o[c++]=255&i,i/=256,t-=8);for(r=r<<t|i,a+=t;0<a;o[c++]=255&r,r/=256,a-=8);return o[--c]|=128*h,o}function F(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,l=127&(n=e[u--]);for(n>>=7;0<s;l=256*l+e[u],u--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=t;0<s;r=256*r+e[u],u--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:n?-M:M;r+=S(2,t),l-=a}return(n?-1:1)*r*S(2,l-t)}function B(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function G(e){return[255&e]}function z(e){return[255&e,e>>8&255]}function U(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function V(e){return D(e,52,8)}function H(e){return D(e,23,4)}function j(e,t,n){g(e[x],t,{get:function(){return this[n]}})}function W(e,t,n,r){var i=+n;if((n=d(i))+t>e[P])throw C(A);return i=e[N]._b,e=n+e[O],t=i.slice(e,e+t),r?t:t.reverse()}function Y(e,t,n,r,i,o){if((n=d(n=+n))+t>e[P])throw C(A);for(var a=e[N]._b,s=n+e[O],u=r(+i),l=0;l<t;l++)a[s+l]=u[o?l:t-l-1]}if(a.ABV){if(!l((function(){I(1)}))||!l((function(){new I(-1)}))||l((function(){return new I,new I(1.5),new I(NaN),I.name!=y}))){I=function(e){return c(this,I),new E(d(e))};for(var q,X=I[x]=E[x],Z=p(E),J=0;Z.length>J;)(q=Z[J++])in I||s(I,q,E[q]);o||(X.constructor=I)}X=new w(new I(2));var K=w[x].setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||u(w[x],{setInt8:function(e,t){K.call(this,e,t<<24>>24)},setUint8:function(e,t){K.call(this,e,t<<24>>24)}},!0)}else I=function(e){c(this,I,y),e=d(e),this._b=m.call(new Array(e),0),this[P]=e},w=function(e,t,n){c(this,w,_),c(e,I,_);var r=e[P];if((t=h(t))<0||r<t)throw C("Wrong offset!");if(r<t+(n=void 0===n?r-t:f(n)))throw C("Wrong length!");this[N]=e,this[O]=t,this[P]=n},i&&(j(I,r,"_l"),j(w,n,"_b"),j(w,r,"_l"),j(w,b,"_o")),u(w[x],{getInt8:function(e){return W(this,1,e)[0]<<24>>24},getUint8:function(e){return W(this,1,e)[0]},getInt16:function(e){return((e=W(this,2,e,arguments[1]))[1]<<8|e[0])<<16>>16},getUint16:function(e){return(e=W(this,2,e,arguments[1]))[1]<<8|e[0]},getInt32:function(e){return B(W(this,4,e,arguments[1]))},getUint32:function(e){return B(W(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return F(W(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return F(W(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){Y(this,1,e,G,t)},setUint8:function(e,t){Y(this,1,e,G,t)},setInt16:function(e,t){Y(this,2,e,z,t,arguments[2])},setUint16:function(e,t){Y(this,2,e,z,t,arguments[2])},setInt32:function(e,t){Y(this,4,e,U,t,arguments[2])},setUint32:function(e,t){Y(this,4,e,U,t,arguments[2])},setFloat32:function(e,t){Y(this,4,e,H,t,arguments[2])},setFloat64:function(e,t){Y(this,8,e,V,t,arguments[2])}});v(I,y),v(w,_),s(w[x],a.VIEW,!0),t[y]=I,t[_]=w},function(e,t,n){var r=n(36),i=n(4)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){var r=n(59),i=n(4)("iterator"),o=n(36);e.exports=n(52).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(55),i=n(20),o=n(22),a=n(9),s=n(36),u=n(255),l=n(90),c=n(144),h=n(4)("iterator"),f=!([].keys&&"next"in[].keys()),d="keys",p="values",g=function(){return this};e.exports=function(e,t,n,m,v,y,_){u(n,t,m);var x,A,I=function(e){if(!f&&e in M)return M[e];switch(e){case d:case p:return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",b=v==p,C=!1,M=e.prototype,E=M[h]||M["@@iterator"]||v&&M[v],T=E||I(v),S=v?b?I("entries"):T:void 0;if((m="Array"==t&&M.entries||E)&&(e=c(m.call(new e)))!==Object.prototype&&e.next&&(l(e,w,!0),r||"function"==typeof e[h]||a(e,h,g)),b&&E&&E.name!==p&&(C=!0,T=function(){return E.call(this)}),r&&!_||!f&&!C&&M[h]||a(M,h,T),s[t]=T,s[w]=g,v)if(x={values:b?T:I(p),keys:y?T:I(d),entries:S},_)for(A in x)A in M||o(M,A,x[A]);else i(i.P+i.F*(f||C),t,x);return x}},function(e,t,n){"use strict";var r=n(79),i=n(54),o=n(90),a={};n(9)(a,n(4)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(4)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(5),i=n(15),o=n(6),a=n(4)("species");e.exports=function(e){e=r[e],o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=n(33),i=n(42),o=n(10);e.exports=[].copyWithin||function(e,t){var n=r(this),a=o(n.length),s=i(e,a),u=i(t,a),l=(t=2<arguments.length?arguments[2]:void 0,Math.min((void 0===t?a:i(t,a))-u,a-s)),c=1;for(u<s&&s<u+l&&(c=-1,u+=l-1,s+=l-1);0<l--;)u in n?n[s]=n[u]:delete n[s],s+=c,u+=c;return n}},function(e,t,n){var r=n(20);r(r.P,"Array",{fill:n(89)}),n(145)("fill")},function(e,t,n){for(var r=n(91),i=n(113),o=n(22),a=n(5),s=n(9),u=n(36),l=(n=n(4))("iterator"),c=n("toStringTag"),h=u.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(f),p=0;p<d.length;p++){var g,m=d[p],v=f[m],y=a[m],_=y&&y.prototype;if(_&&(_[l]||s(_,l,h),_[c]||s(_,c,m),u[m]=h,v))for(g in r)_[g]||o(_,g,r[g],!0)}},function(e,t,n){e.exports=n(262)},function(e,t,n){n(263),e.exports=n(1).Object.keys},function(e,t,n){var r=n(31),i=n(40);n(129)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t){},function(e,t,n){"use strict";n(0)(t,"__esModule",{value:!0}),t.default=void 0,n=(n=n(88)).ProtoBuf.newBuilder({}).import({messages:[{name:"FloorGeo",syntax:"proto2",fields:[{rule:"required",type:"string",name:"mid",id:1},{rule:"required",type:"int32",name:"gid",id:2},{rule:"optional",type:"float",name:"height",id:3},{rule:"repeated",type:"GeneralGeoInfo",name:"extentLayer",id:4},{rule:"repeated",type:"GeneralGeoInfo",name:"modelLayer",id:5},{rule:"repeated",type:"GeneralGeoInfo",name:"labelLayer",id:6},{rule:"repeated",type:"GeneralGeoInfo",name:"poiLayer",id:7},{rule:"repeated",type:"GeneralGeoInfo",name:"polygonLayer",id:8},{rule:"repeated",type:"GeneralGeoInfo",name:"polygonLabelLayer",id:9},{rule:"repeated",type:"GeneralGeoInfo",name:"liftLayer",id:10},{rule:"repeated",type:"GeneralGeoInfo",name:"stairLayer",id:11},{rule:"repeated",type:"GeneralGeoInfo",name:"escalatorLayer",id:12},{rule:"repeated",type:"GeneralGeoInfo",name:"externalModelLayer",id:13}],messages:[{name:"GeneralGeoInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"geo",id:2},{rule:"optional",type:"float",name:"height",id:3},{rule:"optional",type:"float",name:"area",id:4},{rule:"repeated",type:"Indexinfo",name:"idxs",id:5},{rule:"repeated",type:"double",name:"pts",id:6}],messages:[{name:"Indexinfo",syntax:"proto2",fields:[{rule:"repeated",type:"int32",name:"idxs",id:1}]}]}]},{name:"FloorBiz",syntax:"proto2",fields:[{rule:"required",type:"string",name:"mid",id:1},{rule:"required",type:"int32",name:"gid",id:2},{rule:"repeated",type:"ExtentBizInfo",name:"extentLayer",id:3},{rule:"repeated",type:"ModelBizInfo",name:"modelLayer",id:4},{rule:"repeated",type:"LabelBizInfo",name:"labelLayer",id:5},{rule:"repeated",type:"POIBizInfo",name:"poiLayer",id:6},{rule:"repeated",type:"PolygonBizInfo",name:"polygonLayer",id:7},{rule:"repeated",type:"LiftBizInfo",name:"liftLayer",id:8},{rule:"repeated",type:"StairBizInfo",name:"stairLayer",id:9},{rule:"repeated",type:"PolygonLabelBizInfo",name:"polygonLabelLayer",id:10},{rule:"repeated",type:"ExternalModelBizInfo",name:"externalModelLayer",id:11}],messages:[{name:"ExtentBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5}]},{name:"ModelBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5},{rule:"optional",type:"int32",name:"minlevel",id:6},{rule:"optional",type:"int32",name:"maxlevel",id:7},{rule:"optional",type:"int32",name:"pass",id:8},{rule:"optional",type:"string",name:"floorID",id:9}]},{name:"LabelBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5},{rule:"optional",type:"int32",name:"minlevel",id:6},{rule:"optional",type:"int32",name:"maxlevel",id:7}]},{name:"PolygonBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5}]},{name:"POIBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5},{rule:"optional",type:"int32",name:"minlevel",id:6},{rule:"optional",type:"int32",name:"maxlevel",id:7}]},{name:"LiftBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"int32",name:"flag",id:4},{rule:"optional",type:"string",name:"floor",id:5},{rule:"optional",type:"int32",name:"minlevel",id:6},{rule:"optional",type:"int32",name:"maxlevel",id:7}]},{name:"StairBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"int32",name:"flag",id:4},{rule:"optional",type:"int32",name:"minlevel",id:5},{rule:"optional",type:"int32",name:"maxlevel",id:6}]},{name:"PolygonLabelBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"float",name:"width",id:4},{rule:"optional",type:"string",name:"name",id:5},{rule:"optional",type:"string",name:"ename",id:6},{rule:"optional",type:"float",name:"angle",id:7}]},{name:"ExternalModelBizInfo",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"eid",id:1},{rule:"optional",type:"string",name:"fid",id:2},{rule:"optional",type:"int32",name:"type",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"optional",type:"string",name:"ename",id:5},{rule:"optional",type:"int32",name:"minlevel",id:6},{rule:"optional",type:"int32",name:"maxlevel",id:7}]}]},{name:"FloorNavi",syntax:"proto2",fields:[{rule:"required",type:"string",name:"mid",id:1},{rule:"required",type:"int32",name:"gid",id:2},{rule:"repeated",type:"NaviNode",name:"naviNodes",id:3},{rule:"repeated",type:"NaviSegment",name:"naviSegments",id:4},{rule:"repeated",type:"NaviZone",name:"naviZones",id:5},{rule:"repeated",type:"NaviModel",name:"naviModels",id:6},{rule:"repeated",type:"int32",name:"nextFloors",id:7}],messages:[{name:"NaviNode",syntax:"proto2",fields:[{rule:"optional",type:"int32",name:"nodeId",id:1},{rule:"optional",type:"int32",name:"nodeType",id:2},{rule:"optional",type:"int32",name:"liftType",id:3},{rule:"optional",type:"int32",name:"liftFlag",id:4},{rule:"optional",type:"int32",name:"liftEntry",id:5},{rule:"optional",type:"string",name:"liftFloor",id:6},{rule:"optional",type:"string",name:"linkSeg",id:7},{rule:"optional",type:"string",name:"geo",id:8},{rule:"optional",type:"int32",name:"entranceType",id:9},{rule:"optional",type:"string",name:"entranceFloor",id:10},{rule:"optional",type:"int32",name:"doortype",id:11},{rule:"repeated",type:"int32",name:"idxs",id:12},{rule:"repeated",type:"double",name:"pts",id:13}]},{name:"NaviSegment",syntax:"proto2",fields:[{rule:"optional",type:"int32",name:"segmentId",id:1},{rule:"optional",type:"int32",name:"snode",id:2},{rule:"optional",type:"int32",name:"enode",id:3},{rule:"optional",type:"double",name:"length",id:4},{rule:"optional",type:"int32",name:"rank",id:5},{rule:"optional",type:"string",name:"name",id:6},{rule:"optional",type:"int32",name:"entry",id:7},{rule:"optional",type:"string",name:"desc",id:8},{rule:"optional",type:"string",name:"geo",id:9},{rule:"optional",type:"int32",name:"through",id:10},{rule:"repeated",type:"int32",name:"idxs",id:11},{rule:"repeated",type:"double",name:"pts",id:12}]},{name:"NaviZone",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"id",id:1},{rule:"required",type:"int32",name:"type",id:2,options:{default:0}},{rule:"optional",type:"string",name:"geo",id:3},{rule:"repeated",type:"int32",name:"rejects",id:4},{rule:"repeated",type:"int32",name:"idxs",id:5},{rule:"repeated",type:"double",name:"pts",id:6}]},{name:"NaviModel",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"id",id:1},{rule:"repeated",type:"int32",name:"doorids",id:2},{rule:"repeated",type:"int32",name:"nodetypes",id:3},{rule:"repeated",type:"int32",name:"entrytypes",id:4}]}]}]}),t.default=n},function(e,t,n){"use strict";n(0)(t,"__esModule",{value:!0}),t.default=void 0,n=(n=n(88)).ProtoBuf.newBuilder({}).import({messages:[{name:"Scene",fields:[{rule:"required",type:"string",name:"mid",id:19},{rule:"required",type:"int32",name:"file_ver",id:20},{rule:"required",type:"uint64",name:"date_ver",id:21},{rule:"required",type:"string",name:"mname",id:22},{rule:"required",type:"string",name:"hash_code",id:23},{rule:"optional",type:"string",name:"key",id:24},{rule:"optional",type:"string",name:"desc",id:25},{rule:"optional",type:"bool",name:"read_only",id:26,options:{default:!1}},{rule:"optional",type:"float",name:"x",id:1},{rule:"optional",type:"float",name:"y",id:2},{rule:"optional",type:"float",name:"z",id:3},{rule:"optional",type:"float",name:"minX",id:4},{rule:"optional",type:"float",name:"minY",id:5},{rule:"optional",type:"float",name:"maxX",id:6},{rule:"optional",type:"float",name:"maxY",id:7},{rule:"optional",type:"string",name:"defGid",id:8},{rule:"optional",type:"float",name:"defCenX",id:9},{rule:"optional",type:"float",name:"defCenY",id:10},{rule:"optional",type:"float",name:"defCenZ",id:11},{rule:"optional",type:"float",name:"height",id:12},{rule:"optional",type:"float",name:"rotateAngleX",id:13},{rule:"optional",type:"float",name:"rotateAngleY",id:14},{rule:"optional",type:"float",name:"rotateAngleZ",id:15},{rule:"optional",type:"float",name:"scale",id:16},{rule:"optional",type:"string",name:"scaleLevel",id:17},{rule:"repeated",type:"LayerGroup",name:"layerGroups",id:18}],messages:[{name:"Layer",fields:[{rule:"optional",type:"int32",name:"lid",id:1},{rule:"optional",type:"string",name:"lname",id:2},{rule:"optional",type:"string",name:"alias",id:3},{rule:"optional",type:"Type",name:"ltype",id:4},{rule:"optional",type:"float",name:"offsetX",id:5},{rule:"optional",type:"float",name:"offsetY",id:6},{rule:"optional",type:"float",name:"height",id:7},{rule:"optional",type:"float",name:"rotateAngleX",id:8},{rule:"optional",type:"float",name:"rotateAngleY",id:9},{rule:"optional",type:"float",name:"rotateAngleZ",id:10},{rule:"optional",type:"float",name:"minScaleLevel",id:11},{rule:"optional",type:"float",name:"maxScaleLevel",id:12},{rule:"optional",type:"bool",name:"isVisible",id:13},{rule:"optional",type:"bool",name:"isSelectable",id:14},{rule:"optional",type:"bool",name:"isEditable",id:15},{rule:"optional",type:"string",name:"desc",id:16}],enums:[{name:"Type",values:[{name:"GEOPOINT",id:1},{name:"GEOPOINT_ESCALATOR",id:2},{name:"GEOPOINT_LIFT",id:3},{name:"GEOPOINT_STAIR",id:4},{name:"GEOPOINT_PANORAMA",id:5},{name:"GEOPOINT_POI",id:6},{name:"GEOPOINT_STORELABEL",id:7},{name:"GEOPOINT_NAVINODE",id:8},{name:"GEOPOINT_MODEL",id:9},{name:"GEOLINE",id:20},{name:"GEOLINE_NAVISEGMENT",id:21},{name:"GEOLINE_BORDER",id:22},{name:"GEOPOLYGON",id:30},{name:"GEOPOLYGON_EXTENT",id:31},{name:"GEOPOLYGON_STORE",id:32},{name:"GEOPOLYGON_LABEL",id:33},{name:"RASTERATA",id:40},{name:"OVERLAYDATA",id:50}]}]},{name:"LayerGroup",fields:[{rule:"optional",type:"int32",name:"gid",id:1},{rule:"optional",type:"string",name:"gname",id:2},{rule:"optional",type:"string",name:"alias",id:3},{rule:"optional",type:"float",name:"height",id:4},{rule:"optional",type:"string",name:"desc",id:5},{rule:"repeated",type:"Layer",name:"layers",id:6}]}]}]}),t.default=n},function(e,n,r){"use strict";var i=r(0),o=r(2);i(n,"__esModule",{value:!0}),n.default=void 0;var a=o(r(71));r(83);var s=o(r(11)),u=o(r(12)),l=l||{};l.GLEN1=15,l.GLEN2=6,l.GLEN3=17,r=function(){function e(){(0,s.default)(this,e),this._points,this._holes}return(0,u.default)(e,[{key:"parse",value:function(e){if(this._points=[],this._holes=[],0==e.indexOf("MULTIPOLYGON((("))for(var t=e.substring(l.GLEN1,e.length-3).split(/\),\(/),n=0;n<t.length;n++){var r=t[n].split(/,/);if(0==n)for(var i=0;i<r.length;i++){var o=r[i].split(" ");this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])})}else{var s=[];for(i=0;i<r.length;i++)o=r[i].split(" "),s.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});this._holes.push(s)}}else if(0==e.indexOf("POINT("))o=e.substring(l.GLEN2,e.length-1).split(" "),this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});else if(0==e.indexOf("MULTILINESTRING(("))for(r=e.substring(l.GLEN3,e.length-2).split(","),i=0;i<r.length;i++)o=r[i].split(" "),this._points.push({x:(0,a.default)(o[0]),y:(0,a.default)(o[1])});return this}},{key:"toFixed",value:function(e){return+e.toFixed(2)}},{key:"parsePnt",value:function(e){if(this._points=[],0==e.indexOf("MULTIPOLYGON((("))for(var t=e.substring(l.GLEN1,e.length-3).split(","),n=0;n<t.length;n++){var r=t[n].split(" ");this._points.push({x:(0,a.default)(r[0]),y:(0,a.default)(r[1])})}else if(0==e.indexOf("POINT("))r=e.substring(l.GLEN2,e.length-1).split(" "),this._points.push({x:(0,a.default)(r[0]),y:(0,a.default)(r[1])});else if(0==e.indexOf("MULTILINESTRING(("))for(t=e.substring(l.GLEN3,e.length-2).split(","),n=0;n<t.length;n++)r=t[n].split(" "),this._points.push({x:(0,a.default)(r[0]),y:(0,a.default)(r[1])});return this}},{key:"toPntStrip",value:function(e){var t=[],n=this._points.length;if(!0===e){if(1<=n)for(var r=0;r<n-1;r++){var i=this._points[r];t.push(i.x,i.y)}}else for(r=0;r<n;r++)i=this._points[r],t.push(i.x,i.y);return t}},{key:"mergePnts",value:function(e){for(var t=[],n=e.length,r=0;r<n;r++){for(var i=e[r],o={x:this.toFixed(i.x),y:this.toFixed(i.y)},a=t.length,s=!1,u=0;u<a;u++){var l=t[u];if(l.x==o.x&&l.y==o.y){s=!0;break}}s||t.push(o)}return t}},{key:"toStrip",value:function(e){var n=[];if((r=this._points.length)<=0)return n;for(var r=this._points.splice(r-1,1)[0],i=this.mergePnts(this._points),o=i.length,a=0;a<o;a++){var s=i[a];n.push(s.x,s.y)}return!0===e||(t={x:this.toFixed(r.x),y:this.toFixed(r.y)},n.push(t.x,t.y),this._points.push(r)),n}},{key:"hasHoles",value:function(){return null!=this._holes&&0<this._holes.length}},{key:"toStripHoles",value:function(e){for(var n=[],r=0;r<this._holes.length;r++){for(var i=this._holes[r],o=[],a=i.length,s=(a=i.splice(a-1,1)[0],this.mergePnts(i)),u=s.length,l=0;l<u;l++){var c=s[l];o.push(c.x,c.y)}!0===e||(t={x:this.toFixed(a.x),y:this.toFixed(a.y)},o.push(t.x,t.y)),n.push(o)}return n}},{key:"holes",get:function(){return this._holes},set:function(e){this._holes=e}},{key:"points",get:function(){return this._points},set:function(e){this._points=e}}]),e}(),n.default=r},function(e,n,r){"use strict";var i=r(0),o=r(2);i(n,"__esModule",{value:!0}),n.default=void 0;var a=o(r(11)),s=o(r(12));r=function(){function e(){(0,a.default)(this,e),this._points,this._holes}return(0,s.default)(e,[{key:"parse",value:function(e,t){this._points=[],this._holes=[];for(var n=0,r=0;r<e.length;r++){var i;if("number"==typeof(i=(i=e[r].idxs)||e[r]))for(;n<i;)this._points.push({x:t[n],y:t[n+1]}),n+=2;else for(var o=0;o<i.length;o++)for(var a=i[o];n<a;)this._points.push({x:t[n],y:t[n+1]}),n+=2}return this}},{key:"parseGeometry",value:function(e,t){this._points=[],this._holes=[];for(var n=0,r=0;r<e.length;r++){var i;if("number"==typeof(i=(i=e[r].idxs)||e[r]))for(;n<i;)this._points.push({x:t[n],y:t[n+1]}),n+=2;else for(var o=0;o<i.length;o++)if(0===o)for(var a=i[o];n<a;)this._points.push({x:t[n],y:t[n+1]}),n+=2;else{for(var s=[],u=i[o];n<u;)s.push({x:t[n],y:t[n+1]}),n+=2;this._holes.push(s)}}return this}},{key:"mergePnts",value:function(e){for(var t=[],n=e.length,r=0;r<n;r++){for(var i=e[r],o={x:this.toFixed(i.x),y:this.toFixed(i.y)},a=t.length,s=!1,u=0;u<a;u++){var l=t[u];if(l.x==o.x&&l.y==o.y){s=!0;break}}s||t.push(o)}return t}},{key:"toStrip",value:function(e){var n=[];if((r=this._points.length)<=0)return n;for(var r=this._points.splice(r-1,1)[0],i=this._points,o=i.length,a=0;a<o;a++){var s=i[a];n.push(s.x,s.y)}return!0===e||(t={x:this.toFixed(r.x),y:this.toFixed(r.y)},n.push(t.x,t.y),this._points.push(r)),n}},{key:"toFixed",value:function(e){return+e.toFixed(2)}},{key:"hasHoles",value:function(){return null!=this._holes&&0<this._holes.length}},{key:"toStripHoles",value:function(e){for(var n=[],r=0;r<this._holes.length;r++){for(var i=this._holes[r],o=[],a=i.length,s=(a=i.splice(a-1,1)[0],this.mergePnts(i)),u=s.length,l=0;l<u;l++){var c=s[l];o.push(c.x,c.y)}!0===e||(t={x:this.toFixed(a.x),y:this.toFixed(a.y)},o.push(t.x,t.y)),n.push(o)}return n}},{key:"holes",get:function(){return this._holes},set:function(e){this._holes=e}},{key:"points",get:function(){return this._points},set:function(e){this._points=e}}]),e}(),n.default=r},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.mapOptionMessage=t.tileMessage=t.cerityMessage=void 0,n={warn_nokey:"key%E5%80%BC%E6%9C%AA%E9%85%8D%E7%BD%AE%EF%BC%8C%E8%AF%B7%E8%AE%BF%E9%97%AE%E8%9C%82%E9%B8%9F%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%9F%A5%E7%9C%8B%E5%BA%94%E7%94%A8%E5%90%8D%E7%A7%B0%E3%80%82",warn_noappname:"%E5%BA%94%E7%94%A8%E5%90%8D%E7%A7%B0%EF%BC%88appname%EF%BC%89%E6%9C%AA%E9%85%8D%E7%BD%AE%EF%BC%8C%E8%AF%B7%E8%AE%BF%E9%97%AE%E8%9C%82%E9%B8%9F%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%9F%A5%E7%9C%8B%E5%BA%94%E7%94%A8%E5%90%8D%E7%A7%B0%E3%80%82",warn_nomapid:"%E5%9C%B0%E5%9B%BEID%E6%9C%AA%E9%85%8D%E7%BD%AE%EF%BC%8C%E8%AF%B7%E8%AE%BF%E9%97%AE%E8%9C%82%E9%B8%9F%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%9F%A5%E7%9C%8B%E5%9C%B0%E5%9B%BEID%E3%80%82",warn_keynotright:"%E6%82%A8%E9%85%8D%E7%BD%AE%E7%9A%84key%E5%80%BC%E4%B8%8D%E6%AD%A3%E7%A1%AE%EF%BC%8C%E8%AF%B7%E8%AE%BF%E9%97%AE%E8%9C%82%E9%B8%9F%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%A3%80%E6%9F%A5%E6%AD%A4%E5%BA%94%E7%94%A8%E4%B8%8B%E7%9A%84key%E5%80%BC%E3%80%82",warn_offline:"%E6%82%A8%E9%85%8D%E7%BD%AE%E7%9A%84%E5%BA%94%E7%94%A8%E5%90%8D%E7%A7%B0%EF%BC%88appname%EF%BC%89%E6%88%96key%E5%80%BC%E4%B8%8D%E6%AD%A3%E7%A1%AE%EF%BC%8C%E8%AF%B7%E8%AE%BF%E9%97%AE%E8%9C%82%E9%B8%9F%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%A3%80%E6%9F%A5%E6%82%A8%E7%9A%84%E5%BA%94%E7%94%A8%E3%80%82",warn_openerror:"%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E5%A4%B1%E8%B4%A5",warn_connecterror:"%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E5%88%B0%E8%9C%82%E9%B8%9F%E4%BA%91",warn_downloaderror:"%E4%BB%8E%E8%9C%82%E9%B8%9F%E4%BA%91%E4%B8%8A%E8%8E%B7%E5%BE%97%E5%9C%B0%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%A4%B1%E8%B4%A5",warn_local:"%E6%9C%AC%E5%9C%B0%E9%AA%8C%E8%AF%81%E5%A4%B1%E8%B4%A5"},t.cerityMessage=n,n={noGroup:"目标楼层未初始化，请检查楼层id是否越界，或者等待楼层加载！",noFocus:"焦点层不在可视楼层中，请检查焦点层和可视楼层的参数设置！"},t.tileMessage=n,n={defaultViewCenterError:"地图初始化中心位置错误，请检查fengmap.FMMap初始化参数defaultViewCenter的正确性"},t.mapOptionMessage=n},function(e,t,n){e.exports=i;var r=n(92).EventEmitter;function i(){r.call(this)}(e=n(37))(i,r),i.Readable=n(93),i.Writable=n(283),i.Duplex=n(284),i.Transform=n(285),i.PassThrough=n(286),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",u));var a=!1;function s(){a||(a=!0,e.end())}function u(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(c(),0===r.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",l),e.removeListener("error",l),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",l),e.on("error",l),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e);return 3*((e=t[0])+(t=t[1]))/4-t},t.toByteArray=function(e){for(var t,n=(r=u(e))[0],r=r[1],a=new o(function(e,t,n){return 3*(t+n)/4-n}(0,n,r)),s=0,l=0<r?n-4:n,c=0;c<l;c+=4)t=i[e.charCodeAt(c)]<<18|i[e.charCodeAt(c+1)]<<12|i[e.charCodeAt(c+2)]<<6|i[e.charCodeAt(c+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;return 2===r&&(t=i[e.charCodeAt(c)]<<2|i[e.charCodeAt(c+1)]>>4,a[s++]=255&t),1===r&&(t=i[e.charCodeAt(c)]<<10|i[e.charCodeAt(c+1)]<<4|i[e.charCodeAt(c+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t),a},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=16383,s=0,u=n-i;s<u;s+=a)o.push(c(e,s,u<s+a?u:s+a));return 1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return-1===(e=e.indexOf("="))&&(e=t),[e,t=e===t?0:4-e%4]}function l(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function c(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(l(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,h=n?i-1:0,f=n?-1:1;for(n=e[t+h],h+=f,o=n&(1<<-c)-1,n>>=-c,c+=s;0<c;o=256*o+e[t+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;0<c;a=256*a+e[t+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(n?-1:1);a+=Math.pow(2,r),o-=l}return(n?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,u=8*o-i-1,l=(1<<u)-1,c=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1;for(o=t<0||0===t&&1/t<0?1:0,t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-a))<1&&(a--,r*=2),2<=(t+=1<=a+c?h/r:h*Math.pow(2,1-c))*r&&(a++,r/=2),l<=a+c?(s=0,a=l):1<=a+c?(s=(t*r-1)*Math.pow(2,i),a+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));8<=i;e[n+f]=255&s,f+=d,s/=256,i-=8);for(a=a<<i|s,u+=i;0<u;e[n+f]=255&a,f+=d,a/=256,u-=8);e[n+f-d]|=128*o}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){},function(e,t,n){"use strict";var r=n(94).Buffer,i=n(277);function o(e,t,n){e.copy(t,n)}function a(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),this.head=null,this.tail=null,this.length=0}e.exports=(a.prototype.push=function(e){e={data:e,next:null},0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length},a.prototype.unshift=function(e){e={data:e,next:this.head},0===this.length&&(this.tail=e),this.head=e,++this.length},a.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},a.prototype.clear=function(){this.head=this.tail=null,this.length=0},a.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},a.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t=r.allocUnsafe(e>>>0),n=this.head,i=0;n;)o(n.data,t,i),i+=n.data.length,n=n.next;return t},a),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(279),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(38))},function(e,t,n){(function(e,t){!function(e,n){"use strict";var r,i,o,a,s,u;function l(e){delete i[e]}function c(e){if(o)setTimeout(c,0,e);else{var t=i[e];if(t){o=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(undefined,n)}}(t)}finally{l(e),o=!1}}}}e.setImmediate||(r=1,i={},o=!1,a=e.document,u=(u=Object.getPrototypeOf&&Object.getPrototypeOf(e))&&u.setTimeout?u:e,("[object process]"==={}.toString.call(e.process)?function(){s=function(e){t.nextTick((function(){c(e)}))}}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&c(+n.data.slice(t.length))}));e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),s=function(n){e.postMessage(t+n,"*")}}:e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){c(e=e.data)},s=function(t){e.port2.postMessage(t)}}:a&&"onreadystatechange"in a.createElement("script")?function(){var e=a.documentElement;s=function(t){var n=a.createElement("script");n.onreadystatechange=function(){c(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}:function(){s=function(e){setTimeout(c,0,e)}})(),u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];return e={callback:e,args:t},i[r]=e,s(r),r++},u.clearImmediate=l)}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(38),n(35))},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}return null!=(e=t.localStorage[e])&&"true"===String(e).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,n(38))},function(e,t,n){var r=n(95),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=a),a.prototype=Object.create(i.prototype),o(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");return e=i(e),void 0!==t?"string"==typeof n?e.fill(t,n):e.fill(t):e.fill(0),e},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";e.exports=i;var r=n(151);function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}(e=Object.create(n(45))).inherits=n(37),e.inherits(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(96)},function(e,t,n){e.exports=n(27)},function(e,t,n){e.exports=n(93).Transform},function(e,t,n){e.exports=n(93).PassThrough},function(e,t,n){"use strict";var r=n(0),i=n(2);function o(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}r(t,"__esModule",{value:!0}),t.default=void 0,(0,(n=i(n(30))).default)(o.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e,t=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(t=((e=("undefined"==typeof performance?Date:performance).now())-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t),t)}}),n=o,t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={MODULE_SHORTEST:1,MODULE_BEST:2},t.default=n},function(e,t,n){"use strict";(n=n(0))(t,"__esModule",{value:!0}),t.default=void 0,n={PRIORITY_DEFAULT:1,PRIORITY_LIFTFIRST:2,PRIORITY_ESCALATORFIRST:3,PRIORITY_STAIRFIRST:4,PRIORITY_LIFTONLY:5,PRIORITY_ESCALATORONLY:6,PRIORITY_STAIRONLY:7,PRIORITY_ACCESSIBLEONLY:8,PRIORITY_LIFTFIRST1:9,PRIORITY_ESCALATORFIRST1:10,PRIORITY_STAIRFIRST1:11},t.default=n},function(e,t,n){e.exports=n(291)},function(e,t,n){n(292),e.exports=Math.pow(2,-52)},function(e,t,n){(n=n(3))(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){e.exports=n(294)},function(e,t,n){n(295);var r=n(1).Object;e.exports=function(e,t){return r.defineProperties(e,t)}},function(e,t,n){var r=n(3);r(r.S+r.F*!n(14),"Object",{defineProperties:n(100)})},function(e,t,n){"use strict";var r,i,o,a,s,u,l,c,h,f=n(0),d=n(2);function p(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}f(t,"__esModule",{value:!0}),t.Matrix4=p,d=d(n(30)),n=n(152),(0,d.default)(p.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,o,a,s,u,l,c,h,f,d,p,g){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=o,m[9]=a,m[13]=s,m[2]=u,m[6]=l,m[10]=c,m[14]=h,m[3]=f,m[7]=d,m[11]=p,m[15]=g,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new p).fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this},copyPosition:function(e){var t=this.elements;return e=e.elements,t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:(h=new n.Vector3,function(e){var t=this.elements,n=e.elements,r=1/h.setFromMatrixColumn(e,0).length(),i=1/h.setFromMatrixColumn(e,1).length();return e=1/h.setFromMatrixColumn(e,2).length(),t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t,n,r,i,o,a,s,u,l,c,h,f,d=this.elements,p=e.x,g=e.y,m=e.z,v=Math.cos(p),y=Math.sin(p),_=Math.cos(g);return p=Math.sin(g),g=Math.cos(m),m=Math.sin(m),"XYZ"===e.order?(o=v*g,a=v*m,s=y*g,u=y*m,d[0]=_*g,d[4]=-_*m,d[8]=p,d[1]=a+s*p,d[5]=o-u*p,d[9]=-y*_,d[2]=u-o*p,d[6]=s+a*p,d[10]=v*_):"YXZ"===e.order?(t=_*g,n=_*m,r=p*g,i=p*m,d[0]=t+i*y,d[4]=r*y-n,d[8]=v*p,d[1]=v*m,d[5]=v*g,d[9]=-y,d[2]=n*y-r,d[6]=i+t*y,d[10]=v*_):"ZXY"===e.order?(t=_*g,n=_*m,r=p*g,i=p*m,d[0]=t-i*y,d[4]=-v*m,d[8]=r+n*y,d[1]=n+r*y,d[5]=v*g,d[9]=i-t*y,d[2]=-v*p,d[6]=y,d[10]=v*_):"ZYX"===e.order?(o=v*g,a=v*m,s=y*g,u=y*m,d[0]=_*g,d[4]=s*p-a,d[8]=o*p+u,d[1]=_*m,d[5]=u*p+o,d[9]=a*p-s,d[2]=-p,d[6]=y*_,d[10]=v*_):"YZX"===e.order?(l=v*_,c=v*p,h=y*_,f=y*p,d[0]=_*g,d[4]=f-l*m,d[8]=h*m+c,d[1]=m,d[5]=v*g,d[9]=-y*g,d[2]=-p*g,d[6]=c*m+h,d[10]=l-f*m):"XZY"===e.order&&(l=v*_,c=v*p,h=y*_,f=y*p,d[0]=_*g,d[4]=-m,d[8]=p*g,d[1]=l*m+f,d[5]=v*g,d[9]=c*m-h,d[2]=h*m-c,d[6]=y*g,d[10]=f*m+l),d[3]=0,d[7]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,this},makeRotationFromQuaternion:(l=new n.Vector3(0,0,0),c=new n.Vector3(1,1,1),function(e){return this.compose(l,e,c)}),lookAt:(a=new n.Vector3,s=new n.Vector3,u=new n.Vector3,function(e,t,n){var r=this.elements;return u.subVectors(e,t),0===u.lengthSq()&&(u.z=1),u.normalize(),a.crossVectors(n,u),0===a.lengthSq()&&(1===Math.abs(n.z)?u.x+=1e-4:u.z+=1e-4,u.normalize(),a.crossVectors(n,u)),a.normalize(),s.crossVectors(u,a),r[0]=a.x,r[4]=s.x,r[8]=u.x,r[1]=a.y,r[5]=s.y,r[9]=u.y,r[2]=a.z,r[6]=s.z,r[10]=u.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],l=n[1],c=n[5],h=n[9],f=n[13],d=n[2],p=n[6],g=n[10],m=n[14],v=n[3],y=n[7],_=n[11],x=n[15],A=r[0],I=r[4],w=r[8],b=r[12],C=r[1],M=r[5],E=r[9],T=r[13],S=r[2],L=r[6],k=r[10],R=r[14];return e=r[3],t=r[7],n=r[11],r=r[15],i[0]=o*A+a*C+s*S+u*e,i[4]=o*I+a*M+s*L+u*t,i[8]=o*w+a*E+s*k+u*n,i[12]=o*b+a*T+s*R+u*r,i[1]=l*A+c*C+h*S+f*e,i[5]=l*I+c*M+h*L+f*t,i[9]=l*w+c*E+h*k+f*n,i[13]=l*b+c*T+h*R+f*r,i[2]=d*A+p*C+g*S+m*e,i[6]=d*I+p*M+g*L+m*t,i[10]=d*w+p*E+g*k+m*n,i[14]=d*b+p*T+g*R+m*r,i[3]=v*A+y*C+_*S+x*e,i[7]=v*I+y*M+_*L+x*t,i[11]=v*w+y*E+_*k+x*n,i[15]=v*b+y*T+_*R+x*r,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:(o=new n.Vector3,function(e){for(var t=0,n=e.count;t<n;t++)o.x=e.getX(t),o.y=e.getY(t),o.z=e.getZ(t),o.applyMatrix4(this),e.setXYZ(t,o.x,o.y,o.z);return e}),determinant:function(){var e,t=(e=this.elements)[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],u=e[13],l=e[2],c=e[6],h=e[10],f=e[14];return e[3]*(+i*s*c-r*u*c-i*a*h+n*u*h+r*a*f-n*s*f)+e[7]*(+t*s*f-t*u*h+i*o*h-r*o*f+r*u*l-i*s*l)+e[11]*(+t*u*c-t*a*f-i*o*c+n*o*f+i*a*l-n*u*l)+(e=e[15])*(-r*a*l-t*s*c+t*a*h+r*o*c-n*o*h+n*s*l)},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],l=r[5],c=r[6],h=r[7],f=r[8],d=r[9],p=r[10],g=r[11],m=r[12],v=r[13],y=r[14],_=r[15],x=d*y*h-v*p*h+v*c*g-l*y*g-d*c*_+l*p*_,A=m*p*h-f*y*h-m*c*g+u*y*g+f*c*_-u*p*_,I=f*v*h-m*d*h+m*l*g-u*v*g-f*l*_+u*d*_,w=m*d*c-f*v*c-m*l*p+u*v*p+f*l*y-u*d*y;if(0!=(e=i*x+o*A+a*I+s*w))return e=1/e,n[0]=x*e,n[1]=(v*p*s-d*y*s-v*a*g+o*y*g+d*a*_-o*p*_)*e,n[2]=(l*y*s-v*c*s+v*a*h-o*y*h-l*a*_+o*c*_)*e,n[3]=(d*c*s-l*p*s-d*a*h+o*p*h+l*a*g-o*c*g)*e,n[4]=A*e,n[5]=(f*y*s-m*p*s+m*a*g-i*y*g-f*a*_+i*p*_)*e,n[6]=(m*c*s-u*y*s-m*a*h+i*y*h+u*a*_-i*c*_)*e,n[7]=(u*p*s-f*c*s+f*a*h-i*p*h-u*a*g+i*c*g)*e,n[8]=I*e,n[9]=(m*d*s-f*v*s-m*o*g+i*v*g+f*o*_-i*d*_)*e,n[10]=(u*v*s-m*l*s+m*o*h-i*v*h-u*o*_+i*l*_)*e,n[11]=(f*l*s-u*d*s-f*o*h+i*d*h+u*o*g-i*l*g)*e,n[12]=w*e,n[13]=(f*v*a-m*d*a+m*o*p-i*v*p-f*o*y+i*d*y)*e,n[14]=(m*l*a-u*v*a-m*o*c+i*v*c+u*o*y-i*l*y)*e,n[15]=(u*d*a-f*l*a+f*o*c-i*d*c-u*o*p+i*l*p)*e,this;if(r="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0",!0===t)throw new Error(r);return console.warn(r),this.identity()},scale:function(e){var t=this.elements,n=e.x,r=e.y;return e=e.z,t[0]*=n,t[4]*=r,t[8]*=e,t[1]*=n,t[5]*=r,t[9]*=e,t[2]*=n,t[6]*=r,t[10]*=e,t[3]*=n,t[7]*=r,t[11]*=e,this},getMaxScaleOnAxis:function(){var e=(n=this.elements)[0]*n[0]+n[1]*n[1]+n[2]*n[2],t=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],n=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(e,t,n))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z;return t=i*o,e=i*a,this.set(t*o+n,t*a-r*s,t*s+r*a,0,t*a+r*s,e*a+n,e*s-r*o,0,t*s-r*a,e*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,u=i*(h=i+i),l=i*(f=o+o),c=i*(d=a+a),h=(t=o*f,i=o*d,o=a*d,a=s*h,s*f),f=s*d,d=(s=n.x,n.y);return n=n.z,r[0]=(1-(t+o))*s,r[1]=(l+f)*s,r[2]=(c-h)*s,r[3]=0,r[4]=(l-f)*d,r[5]=(1-(u+o))*d,r[6]=(i+a)*d,r[7]=0,r[8]=(c+h)*n,r[9]=(i-a)*n,r[10]=(1-(u+t))*n,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:(r=new n.Vector3,i=new p,function(e,t,n){var o=this.elements,a=r.set(o[0],o[1],o[2]).length(),s=r.set(o[4],o[5],o[6]).length(),u=r.set(o[8],o[9],o[10]).length(),l=this.determinant();return l<0&&(a=-a),e.x=o[12],e.y=o[13],e.z=o[14],i.copy(this),l=1/a,e=1/s,o=1/u,i.elements[0]*=l,i.elements[1]*=l,i.elements[2]*=l,i.elements[4]*=e,i.elements[5]*=e,i.elements[6]*=e,i.elements[8]*=o,i.elements[9]*=o,i.elements[10]*=o,t.setFromRotationMatrix(i),n.x=a,n.y=s,n.z=u,this}),makePerspective:function(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),u=2*i/(n-r);return e=(t+e)/(t-e),n=(n+r)/(n-r),r=-(o+i)/(o-i),i=-2*o*i/(o-i),a[0]=s,a[4]=0,a[8]=e,a[12]=0,a[1]=0,a[5]=u,a[9]=n,a[13]=0,a[2]=0,a[6]=0,a[10]=r,a[14]=i,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),u=1/(n-r),l=1/(o-i);return e=(t+e)*s,r=(n+r)*u,i=(o+i)*l,a[0]=2*s,a[4]=0,a[8]=0,a[12]=-e,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-r,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-i,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}})}],r={},e.m=n,e.c=r,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==u(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(e){return t[e]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=154).default;function e(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return n[t].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n,r},"object"==u(n)&&"object"==u(e)?e.exports=s():(o=[],void 0===(a="function"==typeof(i=s)?i.apply(n,o):i)||(e.exports=a))}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var o=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";function e(e){return new Promise((function(t){navigator.geolocation.getCurrentPosition((function(n){e.innerHTML="".concat(n.coords.latitude,",").concat(n.coords.longitude),t(n.coords)}),(function(n){e.innerHTML=n.message,t({})}))}))}var t={appName:"tes",key:"2a63f2fe46b5606afec431d263fc484b",mapID:"1673491581458231298",themeID:"1673511068110753793",mapZoom:19};function n(e){var t={position:fengmap.FMControlPosition.LEFT_TOP,showBtnCount:1,offset:{x:120,y:120}};new fengmap.FMButtonGroupsControl(e,t)}function i(e,t,n){var r=e.getFMGroup(e.focusGroupID).getOrCreateLayer("textMarker"),i=new fengmap.FMTextMarker({x:t.x,y:t.y,name:n,fillcolor:"255,0,0",fontsize:20,strokecolor:"255,255,0",alpha:.5,callback:function(){i.alwaysShow()}});r.addMarker(i)}function o(e,t){var n=t.remain,r=e.naviDescriptions[t.index];if(n<2)document.getElementById("description").innerHTML="导航结束!";else{var i=n/80,o=parseInt(i),a=Math.floor(i%1*60),s=document.getElementById("description");s.innerHTML="<p>距终点："+n.toFixed(1)+" 米</p><p>大约需要：  "+o+"  分钟   "+a+"   秒</p><p>路线提示："+r+" </p>",s.style.display="block"}}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(){s=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function h(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new E(i||[]);return r(a,"_invoke",{value:w(e,n,s)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=h;var d={};function p(){}function g(){}function m(){}var v={};c(v,o,(function(){return this}));var y=Object.getPrototypeOf,_=y&&y(y(T([])));_&&_!==t&&n.call(_,o)&&(v=_);var x=m.prototype=p.prototype=Object.create(v);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function i(r,o,s,u){var l=f(e[r],e,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==a(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){i("next",e,s,u)}),(function(e){i("throw",e,s,u)})):t.resolve(h).then((function(e){c.value=e,s(c)}),(function(e){return i("throw",e,s,u)}))}u(l.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function w(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function b(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return g.prototype=m,r(x,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:g,configurable:!0}),g.displayName=c(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,l,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},A(I.prototype),c(I.prototype,u,(function(){return this})),e.AsyncIterator=I,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new I(h(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(x),c(x,l,"Generator"),c(x,o,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=T,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===a(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){h(o,r,i,a,s,"next",e)}function s(e){h(o,r,i,a,s,"throw",e)}a(void 0)}))}}var d=r(531);r(473),r(642),r(439),window.onload=f(s().mark((function r(){var a,u,c,h,p,g,m,v,y,_,x;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return _=function(e,t){t&&(u.rotateTo({to:-t,duration:.5}),g.rotateTo({to:t,time:.5})),g.focusGroupID!==e.groupID&&(floorControl.changeFocusGroup(e.groupID,!1),u.setPosition({x:e.x,y:e.y,groupID:e.groupID}));var n={x:e.x,y:e.y,groupID:e.groupID,time:.5};g.moveTo({x:e.x,y:e.y,groupID:e.groupID,time:1}),u.moveTo(n)},a=document.getElementById("cords"),r.next=4,e(a);case 4:u=null,c=l({container:document.getElementById("container")},t),h={lineStyle:{lineType:d.FMLineType.FMARROW,lineWidth:6},naviMode:d.FMNaviMode.MODULE_SHORTEST,naviPriority:d.FMNaviPriority.PRIORITY_DEFAULT,speed:7,followPosition:!1,followAngle:!1,changeTiltAngle:!1,zoom:21,maxZoom:22},p={x:13380302.92444209,y:3529653.7946467614},(g=new d.FMMap(c)).openMapById(c.mapID,(function(e){console.log(e)})),g.on("loadComplete",(function(){n(g)})),m={level:1,url:"https://developer.fengmap.com/fmAPI/images/start.png",size:32,height:.5},v={level:1,url:"https://developer.fengmap.com/fmAPI/images/end.png",size:32,height:.5},y=0,g.on("mapClickNode",(function(e){y++;var t=e.mapCoord,n=e.target;console.log(t),y%2!=0?(Object.assign(m,t,{groupID:n.groupID}),i(g,t,"起点")):(Object.assign(v,t,{groupID:n.groupID}),i(g,t,"终点"))})),x={setStart:function(){var t=f(s().mark((function t(){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("setStart"),t.next=3,e(a);case 3:n=t.sent,r=d.FMCalculator.WGS84ToWebMercator({x:n.longitude,y:n.latitude}),document.getElementById("transformer").innerHTML="".concat(JSON.stringify(r)),d.FMCalculator.CoordTransform({origon:[p],target:[{x:n.longitude,y:n.latitude}]}),u=new d.FMLocationMarker({x:r.x,y:r.y,url:"./person_first.png",groupID:g.focusGroupID,size:48,height:3,callback:function(){console.log("定位点marker加载完成！")}}),g.addLocationMarker(u),y++,Object.assign(m,r),i(g,m,"起点");case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),navigate:function(){var e=new d.FMNavigation(l({map:g},h));e.setStartPoint(m),e.setEndPoint(v),e.drawNaviLine(),e.on("walking",(function(t){console.log(t),o(e,t),_(t.point,t.angle)}))}},window.addEventListener("click",(function(e){var t=e.target;if("BUTTON"===t.nodeName){var n,r=t.dataset;r.type&&(null===(n=x[r.type])||void 0===n||n.call(x))}}));case 16:case"end":return r.stop()}}),r)})))})()})();